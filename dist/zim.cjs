"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }var pi=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(Tt,Pt)=>(typeof require<"u"?require:Tt)[Pt]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});require('@danzen/createjs');var j=window||{},Ge=j.createjs,Et=j.zns,pt=j.zon==null?!0:j.zon,gi,vi,dn,Wn=pt?console.log.bind(console):function(){},jn=" border:thin solid black; color: black",ri=pt?console.log.bind(console,"%c Z ","background: #acd241;"+jn):function(){},yi=pt?console.log.bind(console,"%c Z ","background: #e472c4;"+jn):function(){},Yr=pt?console.log.bind(console,"%c Z ","background: #50c4b7;"+jn):function(){},ii=pt?console.log.bind(console,"%c Z ","background: #fb4758;"+jn):function(){},tt=pt?console.log.bind(console,"%c Z ","background: #ebcb35;"+jn):function(){},li=pt?console.log.bind(console,"%c Z ","background: #f58e25;"+jn):function(){},Er=pt?console.log.bind(console,"%c Z ","background: #eeeeee;"+jn):function(){},Pr=pt?console.log.bind(console,"%c Z ","background: #444444; border:thin solid black; color: white"):function(){};function Cn(t){return De("1"),document.getElementById(t)}function xi(t){if(De("2"),document.getElementById(t))return document.getElementById(t).style;pt&&tt("zss(): id not found")}function ir(t,Tt,Pt,Ot,St,mt){if(De("3"),n(Tt)&&Tt!=""||Tt=="_self")j.location.href=t;else{var Dt="";return Pt&&(Dt+="width="+Pt+","),Ot&&(Dt+="height="+Ot+","),St&&(Dt+="fullscreen=yes,"),mt&&(Dt+="modal=yes,alwaysRaised=yes"),j.open(t,Tt,Dt)}}function Hn(t){if(De("4"),!n(t))return Number(String(t).replace(/[^\d.-]/g,""))}function n(t){return t==null}function wi(t){De("5"),!n(t)&&(t.stopImmediatePropagation&&t.stopImmediatePropagation(),j.event&&(j.event.cancelBubble=!0))}function Xr(){return De("6"),j.zilK&&(j.removeEventListener("keydown",j.zilK),j.removeEventListener("wheel",j.zilW),j.removeEventListener("DOMMouseScroll",j.zilS)),j.zilK=function(t){t||(t=event),t.keyCode&&t.keyCode>=32&&t.keyCode<=40&&t.preventDefault()},j.zilW=function(t){t||(t=event),t.preventDefault()},j.zilS=j.zilW,j.addEventListener("keydown",j.zilK,{passive:!1}),j.addEventListener("wheel",j.zilW,{passive:!1}),j.addEventListener("DOMMouseScroll",j.zilS,{passive:!1}),[j.zilK,j.zilW,j.zilS]}function cr(t,Tt){De("6.1");function Pt(){var Ot=this;this.on=function(St,mt){if(!(n(t)||n(St)||n(mt)))for(var Dt=Ot.tags,Zt=0;Zt<Dt.length;Zt++)Dt[Zt].addEventListener(St,mt)},this.off=function(St,mt){if(!(n(t)||n(St)||n(mt)))for(var Dt=Ot.tags,Zt=0;Zt<Dt.length;Zt++)Dt[Zt].removeEventListener(St,mt)},Object.defineProperty(Ot,"tags",{get:function(){return n(t)?[]:typeof t=="string"||t instanceof String?(Tt&&li(t,document.querySelector(t)),Tt?[document.querySelector(t)]:document.querySelectorAll(t)):typeof t.innerHTML=="string"?[t]:[]},set:function(){}}),this.css=function(St,mt){for(var Dt=Ot.tags,Zt=0;Zt<Dt.length;Zt++)if(arguments.length==1&&arguments[0].constructor==={}.constructor)for(var At in St)Dt[Zt].style[At]=St[At];else{if(arguments.length==1)return Ot.tags[0].style[St];Dt[Zt].style[St]=mt}},this.prop=function(St,mt){if(!n(St)){for(var Dt=Ot.tags,Zt=[],At=0;At<Dt.length;At++)if(n(mt))if(St.constructor==={}.constructor)for(var Nt in St)Dt[At][Nt]=St[Nt];else Zt.push(Dt[At][St]);else Dt[At][St]=mt;if(n(mt))return Zt}}}return new Pt}function hn(t){return t.length==1&&t[0]!=null&&t[0].constructor==={}.constructor}function st(t,Tt,Pt,Ot){var St=ye&&(ye.ZIMONON||ai);if(hn(Tt)){De("7");var mt=Tt[0],Dt;for(var Zt in mt)(Dt=Zt.match(/^(.+)gColor$/))&&(mt[Dt[1]+"ackgroundColor"]=mt[Zt],delete mt[Zt]);var At=n(Pt)?t.toString().split(/\n/,1)[0].match(/\((.*)\)/)[1].replace(/\s+/g,"").split(","):Pt.replace(/\s+/g,"").split(","),Nt=[],Ke,e;for(Ke=0;Ke<At.length;Ke++)e=At[Ke].split("=")[0],At[Ke]=e,Nt.push(mt[e]);for(Ke in mt)At.indexOf(Ke)<0&&pt&&tt(t,"bad argument "+Ke);var r;return(r=Object.prototype.isPrototypeOf.call(t.prototype,Ot)?new(t.bind.apply(t,[null].concat(Nt))):t.apply(null,Nt))?(St&&!r.arguments&&(r.arguments=[mt]),r):!0}else St&&Ot&&Tt&&n(Ot.arguments)&&(Ot.arguments=Array.prototype.slice.call(Tt))}function nt(t){if(De("7.5"),De("17.6"),!n(t))return ye.Pick.choose(t)}var Ci=console.table&&pt?console.table.bind(console):function(){},Ti=function(){for(var t=0;t<arguments.length;t++)if(!n(arguments[t]))return arguments[t]},ye=function(t){t.chop=function(e,r,i,l,a,s){if(De("7.8"),!n(e)){n(r)&&(r=3),n(i)&&(i=3),n(l)&&(l=!0),n(a)&&(a=0),n(s)&&(s=1),e.getBounds||(e=new t.Bitmap(e));var f=e.getBounds();n(f)&&tt("ZIM chop() - obj must have bounds");var c=f.width/r,x=f.height/i,k=a,v=[];return t.loop(i,function(g){t.loop(r,function(b){var E=new t.Bitmap(e,c+k*2,x+k*2,b*c-k,g*x-k,s);a!=0?(E.setBounds(k,k,c,x),E.regX=k,E.regY=k):E.setBounds(k,k,c,x),v.push(E)})}),l?new t.Tile(v,r,i,0,0,!0).sca(e.scaleX,e.scaleY):v}},t.shuffle=function(e,r){if(De("8"),!n(e)){Array.isArray(e)||(e=Object.values(arguments));var i=e.length,l,a;if(i==0)return e;if(r){for(var s=t.copy(e);t.arraysEqual(s,e);)t.shuffle(e);return e}else{for(;--i;)l=Math.floor(Math.random()*(i+1)),a=e[i],e[i]=e[l],e[l]=a;return e}}},t.pluck=function(e,r){if(De("9.26"),n(e)||e.length==0)return null;Array.isArray(e)||(e=Object.values(arguments));var i=Math.floor(Math.random()*e.length),l=e[i];return r&&e.splice(i,1),l},t.rand=function(e,r,i,l){if(De("9"),n(e)&&n(r))return Math.random();(n(e)||isNaN(e))&&(e=0),(n(r)||isNaN(r))&&(r=0),(e%1!=0||r%1!=0)&&(i=!1),n(i)&&(i=!0),l&&Math.random()>.5&&(e*=-1,r*=-1),i&&(e>r?e++:r>e&&r++);var a;return e==0&&r==0?0:(r==0?a=Math.random()*e:a=Math.min(e,r)+Math.random()*(Math.max(e,r)-Math.min(e,r)),i?Math.floor(a):a)},t.seedRandom=function(e){return De("9.01"),function(r,i,l,a,s,f,c,x,k){function v(O){var _,Y=O.length,m=this,$=0,I=m.i=m.j=0,X=m.S=[];for(Y||(O=[Y++]);a>$;)X[$]=$++;for($=0;a>$;$++)X[$]=X[I=y&I+O[$%Y]+(_=X[$])],X[I]=_;(m.g=function(R){for(var q,J=0,Z=m.i,ne=m.j,U=m.S;R--;)q=U[Z=y&Z+1],J=J*a+U[y&(U[Z]=U[ne=y&ne+q])+(U[ne]=q)];return m.i=Z,m.j=ne,J})(a)}function g(O,_){var Y,m=[],$=typeof O;if(_&&$=="object")for(Y in O)try{m.push(g(O[Y],_-1))}catch (e2){+function(){}()}return m.length?m:$=="string"?O:O+"\0"}function b(O,_){for(var Y,m=O+"",$=0;$<m.length;)_[y&$]=y&(Y^=19*_[y&$])+m.charCodeAt($++);return A(_)}function E(O){try{return T?A(T.randomBytes(a)):(r.crypto.getRandomValues(O=new Uint8Array(a)),A(O))}catch (e3){return[+new Date,r,(O=r.navigator)&&O.plugins,r.screen,A(i)]}}function A(O){return String.fromCharCode.apply(0,O)}var T,h=l.pow(a,s),w=l.pow(2,f),P=2*w,y=a-1,C=l["seed"+k]=function(O,_,Y){var m=[];_=_==1?{entropy:!0}:_||{};var $=b(g(_.entropy?[O,A(i)]:_nullishCoalesce(O, () => (E())),3),m),I=new v(m);return b(A(I.S),i),(_.pass||Y||function(X,R,q){return q?(l[k]=X,R):X})(function(){for(var X=I.g(s),R=h,q=0;w>X;)X=(X+q)*a,R*=a,q=I.g(1);for(;X>=P;)X/=2,R/=2,q>>>=1;return(X+q)/R},$,"global"in _?_.global:this==l)};if(b(l[k](),i),c&&c.exports){c.exports=C;try{T=pi("crypto")}catch (e4){}}else x&&x.amd&&x(function(){return C})}(this,[],Math,256,6,52,typeof module=="object"&&module,typeof define=="function"&&define,"random"),t.randomO||(t.randomO=Math.random),n(e)?Math.random=t.randomO:Math.seedrandom(e),e},t.odds=function(e){return De("9.1"),(n(e)||isNaN(e))&&(e=50),Math.random()<=e/100},t.rarity=function(e,r,i,l){if(De("9.2"),n(e)||e.constructor!={}.constructor)return[];n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!1);var a=[];return t.loop(e,function(s,f){var c=t.colors.indexOf(s);c!=-1&&(s=t.colorsHex[c]);var x;Array.isArray(f)?(+s==+s?s=new Number(s):s=new String(s),s._payload=f[1],s.dynamicPayload=l,Object.defineProperty(s,"payload",{get:function(){return!this.dynamicPayload&&this._lastPayload!=null?this._lastPayload:(this._lastPayload=t.Pick.choose(this._payload),this._lastPayload)},set:function(k){this._lastPayload=null,this._payload=k}}),x=f[0],t.loop(x,function(){a.push(s)})):(x=f,t.loop(x,function(){+s==+s&&(s=+s),a.push(s)}))}),r&&t.shuffle(a),a},t.repeats=function(e,r){if(De("9.25"),n(e)||!Array.isArray(e))return 0;var i={},l=0,a=0;return t.loop(e,function(s){i[s]!=null?(i[s]++,a++):i[s]=0,i[s]>l&&(l=i[s])}),r?a:l},t.series=function(){De("13.61");var e,r;if(arguments[0]==null)return null;if(arguments.length==0)return function(){};arguments.length==1&&Array.isArray(arguments[0])?e=arguments[0]:arguments.length==1&&arguments[0].constructor=={}.constructor?(r=arguments[0],n(r.min)&&(r.min=0),n(r.max)&&(r.max=1),n(r.step)&&(r.step=1),e=[],t.loop(Math.floor(Math.abs(r.max-r.min)+r.step),function(h){e.push(h+r.min)},null,null,r.step),r=null):e=Array.prototype.slice.call(arguments);var i=0,l=1,a=1,s=0,f=0,c=!1,x=!1,k=!1,v=!1,g=!1,b,E,A=function(h,w){if(s&&f%s!=0)return f++,E;f++;var P=e.length,y;if((v||g)&&i%P==0&&t.shuffle(e),y=e[(P*10+i)%P],i==0&&(b=y),g&&i%P==0&&P>1)for(;y==E;)t.shuffle(e),y=e[(P*10+i)%P];return c?l>0&&i+l*a>=P?(l=-1,i=P-1-(i+a-(P-1))):l<0&&i+l*a<0?(l=1,i=a-i):i+=l*a:x?l>0&&i+l*a>=P?(l=-1,i=P-1-(i+a-(P-1))+a):l<0&&i+l*a<0?(l=1,i=a-i-a):i+=l*a:k?l>0&&i+l*a>=P?i=P-1:l<0&&i+l*a<0?i=0:i+=l*a:i+=l*a,E=y,t.isPick(y)?y.noPick&&w?y:t.Pick.choose(y):y},T=A.original=t.copy(e);return A.array=e,A.type="series",Object.defineProperty(A,"index",{get:function(){var h=e.length;return(h*10+i)%h},set:function(h){i=h,f=0}}),Object.defineProperty(A,"length",{get:function(){return e.length},set:function(){}}),A.jump=function(h){return i=h,A},A.reverse=function(h){return n(h)&&(h=!0),h?l=-1:l=1,i=e.length-1,A},A.bounce=function(h){n(h)&&(h=!0);var w=e.length;return i=(w*10+i)%w,c=h,A},A.flip=function(h){n(h)&&(h=!0);var w=e.length;return i=(w*10+i)%w,x=h,A},A.step=function(h){return n(h)&&(h=1),a=Math.floor(h),A},A.every=function(h){return n(h)&&(h=1),s=Math.abs(h),f=0,A},A.constrain=function(h){return n(h)&&(h=!0),k=h,A},A.random=function(h){return n(h)&&(h=!0),h||(e=T),v=h==!0,A},A.mix=function(h){return n(h)&&(h=!0),h||(e=T),g=h==!0,A},A.shuffle=function(h){return n(h)&&(h=!0),h?t.shuffle(e):e=T,A},A},t.makeSeries=function(e){if(De("13.6"),n(e))return function(){};var r=0,i=function(){return e[r++%e.length]};return i.array=e,i},t.loop=function(e,r,i,l,a,s,f,c,x,k){var v="obj, call, reverse, interval, step, start, end, immediate, complete, completeParams",g;if(g=st(t.loop,arguments,v))return g;if(De("9.5"),n(e)||n(r))return;n(i)&&(i=!1),n(l)&&(l=0),(n(a)||a<=0)&&(a=1),n(c)&&(c=!0),e.constructor===Number&&(e=Number(e)),e.constructor===String&&(e=String(e));var b=l==0&&x&&typeof x=="function",E=typeof e=="number"?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":typeof e=="string"?"string":e instanceof NodeList?"nodelist":e instanceof HTMLCollection?"htmlcollection":e.type&&e.type=="Dictionary"?"Dictionary":"invalid";if(E=="invalid")return;var A,T,h,w;if(E=="number"||E=="string"||E=="array"||E=="nodelist"||E=="htmlcollection"||E=="Dictionary"){if(E=="Dictionary"){var P=t.copy(e.values);e=t.copy(e.objects)}if(A=E=="number"?e:e.length,T=C(A-1),T==0)return;if(i)if(l===0){for(h=s;h>=f;h-=a)if(E=="number"?w=r(h,T,s,f,e):E=="array"||E=="string"?w=r(e[h],h,T,s,f,e):E=="Dictionary"?w=r(e[h],P[h],h,T,s,f,e):w=r(e.item(h),h,T,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(h=O.count,c||h--,a&&(h*=a),h=s-h,E=="number"?w=r(h,T,s,f,e):E=="array"||E=="string"?w=r(e[h],h,T,s,f,e):E=="Dictionary"?w=r(e[h],P[h],h,T,s,f,e):w=r(e.item(h),h,T,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},T,c,null,null,x,k);else if(l===0){for(h=s;h<=f;h+=a)if(E=="number"?w=r(h,T,s,f,e):E=="array"||E=="string"?w=r(e[h],h,T,s,f,e):E=="Dictionary"?w=r(e[h],P[h],h,T,s,f,e):w=r(e.item(h),h,T,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(h=O.count,c||h--,a&&(h*=a),E=="number"?w=r(h,T,s,f,e,O):E=="array"||E=="string"?w=r(e[h],h,T,s,f,e,O):E=="Dictionary"?w=r(e[h],P[h],h,T,s,f,e):w=r(e.item(h),h,T,s,f,e,O),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},T,c,null,null,x,k);return b&&x(k),!0}else if(E=="object"){A=0;var y=[];for(h in e)A++,y.push(h);if(T=C(A-1),T==0)return;if(i)if(l===0){for(h=s;h>=f;h-=a)if(w=r(y[h],e[y[h]],h,T,s,f,e),typeof w<"u")return w}else t.interval(l,function(O){if(h=O.count,c||h--,a&&(h*=a),h=s-h,w=r(y[h],e[y[h]],h,T,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},T,c,null,null,x,k);else if(l===0){for(h=s;h<=f;h+=a)if(w=r(y[h],e[y[h]],h,T,s,f,e),typeof w<"u")return w}else t.interval(l,function(O){if(h=O.count,c||h--,a&&(h*=a),w=r(y[h],e[y[h]],h,T,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},T,c,null,null,x,k);return b&&x(k),!0}function C(O){return n(s)&&(s=i?O:0),n(f)&&(f=i?0:O),i&&f>s||!i&&s>f||(s<0&&f)<0||s>O&&f>O?0:(s=Math.max(0,Math.min(s,O)),f=Math.max(0,Math.min(f,O)),Math.floor((i?s-f:f-s)/a)+1)}};function Tt(e,r,i,l,a){t.timeCheck||(De("9.99"),t.timeCheck=!0);var s=n(j.TIME)?n(t.TIME)?"seconds":t.TIME:j.TIME;return s&&s.toLowerCase&&(s=s.toLowerCase()),s!="milliseconds"&&s!="ms"&&(s="seconds"),r&&r.toLowerCase&&(r=r.toLowerCase()),(r=="ms"||r=="milliseconds"||r=="seconds"||r=="s")&&(s=r),n(e)?s.charAt(0):(s=="ms"&&(s="milliseconds"),s=="s"&&(s="seconds"),s=s.charAt(0),a||Pt(e,s,i,l),s)}function Pt(e,r,i,l){n(i)&&(i=10),n(l)&&(l=9),!(!t.TIMECHECK&&!j.TIMECHECK)&&(r!="m"&&e>i||r=="m"&&e<l)&&pt&&tt("TIME - warning: time is in "+(r=="m"?"milliseconds":"seconds")+" ("+e+")")}if(t.timeout=function(e,r,i,l){var a="time, call, pauseOnBlur, timeUnit",s;if(s=st(t.timeout,arguments,a,this))return s;if(De("9.7"),!n(r)&&typeof r=="function"){var f=t.interval(e,r,1,!1,i,l);return f.type="timeoutObj",f}},t.interval=function(e,r,i,l,a,s,f,c){var x="time, call, total, immediate, pauseOnBlur, timeUnit, complete, completeParams",k;if(k=st(t.interval,arguments,x,this))return k;if(De("9.8"),n(r)||typeof r!="function")return;var v=Tt(e,s);if(n(e)&&(e=v=="s"?1:1e3),n(l)&&(l=!1),!n(i)&&(isNaN(i)||i<=0))return;n(i)&&(i=-1);var g={count:0,total:i,paused:!1,time:e,active:!0,timeUnit:s};a&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseOnBlur.push(g));function b(){g.startTime=Date.now(),g.interval=t.Pick.choose(g.time),g.id=setTimeout(function(){g.paused||g.active&&(g.count++,r(g),b(),E())},g.interval*(v=="s"?1e3:1))}l&&setTimeout(function(){r(g),E()},10);function E(){i!=-1&&g.count>=(l?g.total-1:g.total)&&(f&&typeof f=="function"&&f(c),g.clear())}var A;return g.type="intervalOjbect",g.pause=function(T,h,w){n(T)&&(T=!0),T?(clearTimeout(A),clearTimeout(g.id),cancelAnimationFrame(g.rid),g.pauseTimeLeft=g.interval-(Date.now()-g.startTime)/(v=="s"?1e3:1)):(g.paused||g.pause(!0),A=setTimeout(function(){g.count++,r(g),b(),E()},h?0:(w?g.interval:g.pauseTimeLeft)*(v=="s"?1e3:1)),g.pauseTimeLeft=null),g.paused=T},g.next=function(){g.count++,r(g),E()},g.clear=function(){g.active=!1,clearTimeout(A),cancelAnimationFrame(g.rid),clearTimeout(g.id);var T=g.count;for(var h in g)delete g[h];g.active=!1,g.count=T,g.pause=function(){},g.clear=function(){}},b(),g},t.async=function(e,r,i,l,a){if(De("29"),!n(e)){var s=document.createElement("script"),f=Tt(l);n(l)&&(l=f=="s"?2:2e3);var c;r?(i?c=i:c=r.toString().split(/\n/,1)[0].match(/^function\s?([^\s(]*)/)[1],t.asyncList||(t.asyncList={}),t.asyncList[c]||(t.asyncList[c]=[]),t.asyncList[c].push(r),t.async[c]=function(){var x=s,k=!1,v=setTimeout(function(){k=a,typeof r=="function"&&r("asyncError",a?"cancelled":"timeout")},l*(f=="s"?1e3:1));return function(g){clearTimeout(v),t.asyncList[c]&&(r=t.asyncList[c].shift()),typeof r=="function"&&!k&&r(g),x&&x.parentNode.removeChild(x),x=null}}()):(t.async.z_s&&t.async.z_s.parentNode&&t.async.z_s.parentNode.removeChild(t.async.z_s),t.async.z_s=s),e.match(/\?/)||(e+="?"),s.setAttribute("src",e+"&r="+Math.random()),document.getElementsByTagName("head")[0].appendChild(s)}},t.couple=function(e){if(De("29.2"),!t.isJSON(e))return e;var r=JSON.parse(e),i={};for(var l in r){var a=r[l];for(var s in a)i[l+"_"+s]=a[s]}return JSON.stringify(i)},t.decouple=function(e){if(De("29.3"),!t.isJSON(e))return e;var r=JSON.parse(e),i={};for(var l in r){var a=l.split("_",2);if(a.length!=2)return e;i[a[0]]||(i[a[0]]={}),i[a[0]][a[1]]=r[l]}return JSON.stringify(i)},t.convertColor=function(e,r,i){if(t.convertColorCheck||(De("27.5"),t.convertColorCheck=!0),n(r)&&(r="hex"),n(e)||!e.toLowerCase)return;e=nt(e),e=e.toLowerCase(),r=r.toLowerCase();var l=["black","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],a=["000000","f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"];if(r=="zim"){var s=t.colorsHex.indexOf(e);return s<0?e:t.colors[t.colorsHex.indexOf(e)]}r=="hsv"&&r=="hsl";var f,c;if(f=e.match(/rgba\((.*)\)/)){c=f[1].split(",");var x=c.pop();if(n(i)&&(i=x),r=="array")return c.push(x),c;if(e="rgb("+c.join(",")+")",r=="rgb")return e;if(r=="hsl")return g(c[0],c[1],c[2])}function k(P){var y=Number(P).toString(16);return y.length<2&&(y="0"+y),y}function v(P,y,C,O,_){return(_-O)*(P-y)/(C-y)+O}function g(P,y,C){P/=255,y/=255,C/=255;let O=Math.max(P,y,C),_=O-Math.min(P,y,C),Y=_?O===P?(y-C)/_:O===y?2+(C-P)/_:4+(P-y)/_:0;return[60*Y<0?60*Y+360:60*Y,100*(_?O<=.5?_/(2*O-_):_/(2-(2*O-_)):0),100*(2*O-_)/2]}function b(P){var y=P.split(","),C=k(y[0]),O=k(y[1]),_=k(y[2]),Y=n(Y)?"":k(Math.round(Number(y[3])*255));return[C,O,_,Y]}n(i)&&(i=1);var E,A,T;if(f=e.match(/rgb\((.*)\)/))return r=="rgba"?"rgba("+f[1]+","+i+")":r=="hex"?(E=i!=1?","+i:"",A=b(f[1]+E),"#"+A[0]+A[1]+A[2]+A[3]):r=="hexnumber"?(E=i!=1?","+i:0,A=b(f[1]+E),parseInt(A[0]+""+A[1]+A[2],16)):r=="string"?(e=b(f[1]).join("").toLowerCase(),T=a.indexOf(e),T==-1?"#"+e:l[T]):r=="array"?(E=i!=1?","+i:0,b(f[1]+E)):r=="hsl"?(c=f[1].split(","),g(c[0],c[1],c[2])):e;function h(P){var y;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(P)?(y=P.substring(1).split(""),y.length==3&&(y=[y[0],y[0],y[1],y[1],y[2],y[2]]),y="0x"+y.join(""),r=="rgb"?"rgb("+[y>>16&255,y>>8&255,y&255]+")":r=="array"?[y>>16&255,y>>8&255,y&255,i]:"rgba("+[y>>16&255,y>>8&255,y&255].join(",")+","+i+")"):/^#([A-Fa-f0-9]{4}){1,2}$/.test(P)?(y=P.substring(1).split(""),y.length==8&&(i=y.slice(-2).join(""),y=y.slice(0,6)),y.length==4&&(i=y[3]+""+y[3],y=[y[0],y[0],y[1],y[1],y[2],y[2]]),i=parseInt(i,16)/255,y="0x"+y.join(""),r=="rgb"?"rgb("+[y>>16&255,y>>8&255,y&255]+")":"rgba("+[y>>16&255,y>>8&255,y&255].join(",")+","+i+")"):r=="rgb"?"rgb(0,0,0)":"rgba(0,0,0,1)"}if(r=="hsl")return t.convertColor(t.convertColor(e,"rgb"),"hsl");if(r=="array"||r=="rgb"||r=="rgba")return e.charAt(0)=="#"?h(e):h(t.convertColor(e));if(r=="hex"){if(e.charAt(0)=="#")if(i!=1)if(E=k(Math.round(i*255)),e.length==4||e.length==5){var w=e.split("");return w[1]=w[1]+""+w[1],w[2]=w[2]+""+w[2],w[3]=w[3]+""+w[3],w[4]=E,w.join("")}else return e.length==9?e.substring(0,l.length-2)+E:e+E;else return e}else if(r=="hexnumber"){if(e.charAt(0)=="#")return parseInt(e.replace(/^#/,""),16)}else e.charAt(0)=="#"&&(e=e.replace("#",""),e.length==3&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)));return r=="string"?(T=a.indexOf(e),T==-1?"#"+e:l[T]):r=="hexnumber"?parseInt(a[l.indexOf(e.toLowerCase())!=-1?l.indexOf(e):0],16):(E=i!=1?k(Math.round(i*255)):"","#"+a[l.indexOf(e.toLowerCase())!=-1?l.indexOf(e):0]+E)},t.colorRange=function(e,r,i){t.colorRangeCheck||(De("27.6"),t.colorRangeCheck=!0),n(i)&&(i=.5),i=Math.max(0,Math.min(1,i)),n(e)&&(e="white"),n(r)&&(r="black");var l=e,a=r,s=t.convertColor(e,"rgb"),f=t.convertColor(r,"rgb");e=s.substring(4,s.length-1).split(","),r=f.substring(4,f.length-1).split(",");var c,x="#",k;if(i==0)x=l;else if(i==1)x=a;else for(var v=0;v<e.length;v++)c=r[v]-e[v],k=Math.floor(parseInt(e[v],10)+c*i).toString(16),k.length<2&&(k="0"+k),x+=k;return x},t.lighten=function(e,r){return t.lightenCheck||(De("27.65"),t.lightenCheck=!0),n(r)&&(r=.5),r>=0?t.colorRange(String(e),"#FFFFFF",r):t.colorRange(String(e),"#000000",-r)},t.darken=function(e,r){return n(r)&&(r=.5),t.darkenCheck||(De("27.66"),t.darkenCheck=!0),r>=0?t.colorRange(String(e),"#000000",r):t.colorRange(String(e),"#ffffff",-r)},t.toColor=function(e,r,i){return t.toColorCheck||(De("27.67"),t.toColorCheck=!0),n(i)&&(i=.5),t.colorRange(String(e),r,i)},t.toAlpha=function(e,r){return t.toAlphaCheck||(De("27.68"),t.toAlphaCheck=!0),n(r)&&(r=.5),t.convertColor(String(e),"rgba",r)},t.toBW=function(e){if(e.indexOf("#")===0&&(e=e.slice(1)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length!==6)return tt("ZIM toBW() - needs hex input"),e;var r=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);return r*.299+i*.587+l*.114>186?"#000000":"#FFFFFF"},t.invertColor=function(e){if(t.invertColorCheck||(De("27.86"),t.invertColorCheck=!0),e.indexOf("#")===0&&(e=e.slice(1)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length!==6)return tt("ZIM invertColor() - needs hex input"),e;var r=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);r=(255-r).toString(16),i=(255-i).toString(16),l=(255-l).toString(16);function a(s,f){f=f||2;var c=new Array(f).join("0");return(c+s).slice(-f)}return"#"+a(r)+a(i)+a(l)},t.zimEase=function(e,r,i,l,a){De("27.69");var s=!1;n(a)&&(a=!0);var f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y;if(e){if(Array.isArray(e[1])){s=!0,Y=e[1],e=e[0];var m=0,$=Y[0],I=Y[1],X=Y[2],R=Y[3],q=1,J=5*($-m),Z=10*(I-m)-4*J,ne=10*(X-m)+30*($-I),U=5*(R+m)-20*(X+$)+30*I,B=q-m-U-ne-Z-J}f=0,c=e[0],x=e[1],k=e[2],v=e[3],g=1,b=5*(c-f),E=10*(x-f)-4*b,A=10*(k-f)+30*(c-x),T=5*(v+f)-20*(k+c)+30*x,h=g-f-T-A-E-b}else r?(h=r[0],T=r[1],A=r[2],E=r[3],b=r[4],c=b/5,x=(E+4*b)/10,k=(A+6*b+3*E)/10,v=(T+4*b+3*E+2*A)/5):(h=0,T=0,A=0,E=0,b=1);return i?(O=function(){return t.zimEase(null,[h,T,A,E,b],!0)},_={reverse:O,points:[c,x,k,v],polynomials:[h,T,A,E,b]},_.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return d<.5?(d*=2,w=d*100,P=100,y=(w/=P)*w,C=y*w,(h*C*y+T*y*y+A*C+E*y+b*w)/2):(d=1-(d-.5)*2,w=d*100,P=100,y=(w/=P)*w,C=y*w,1-(h*C*y+T*y*y+A*C+E*y+b*w)/2)}):s?(O=function(){return pt&&tt("zimEase - multi array points cannot be reversed"),t.zimEase(null,[h,T,A,E,b])},_={reverse:O,points:[[c,x,k,v],[$,I,X,R]],polynomials:[[h,T,A,E,b],[B,U,ne,Z,J]]},_.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return d<.5?(d*=2,w=d*100,P=100,y=(w/=P)*w,C=y*w,(h*C*y+T*y*y+A*C+E*y+b*w)/2):(d=(d-.5)*2,w=d*100,P=100,y=(w/=P)*w,C=y*w,.5+(B*C*y+U*y*y+ne*C+Z*y+J*w)/2)}):(O=function(){return t.zimEase(null,[h,T,A,E,b],null,!0)},_={reverse:O,points:[c,x,k,v],polynomials:[h,T,A,E,b]},l?_.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return w=100-d*100,P=100,y=(w/=P)*w,C=y*w,1-(h*C*y+T*y*y+A*C+E*y+b*w)}:_.noPick=function(d){if(a){if(d<.025)return 0;if(d>.975)return 1}return w=d*100,P=100,y=(w/=P)*w,C=y*w,h*C*y+T*y*y+A*C+E*y+b*w}),_.noPick.reverse=O,_},t.spline=function(e,r,i,l,a){De("27.695"),n(e)&&(e=[]),n(r)&&(r=1),n(i)&&(i=!1),n(a)&&(a=i);var s;function f(R,q){if(!Array.isArray(R[0]))for(s=0;s<R.length;s++)R[s]=[R[s].x,R[s].y];if(q){var J=R[R.length-1],Z=R[R.length-2],ne=R[0],U=R[1];R.unshift(J),R.unshift(Z),R.push(ne),R.push(U)}var B=[];for(s=0;s<R.length;s++)B.push(R[s][0],R[s][1]);return B}e=f(e,i);var c=e.length,x=c-4,k=i?e[2]:e[0],v=i?e[3]:e[1],g="M"+[k,v];l&&l.mt(k,v);var b=i?2:0,E=i?c-4:c-2,A=2;for(s=b;s<E;s+=A){var T=s?e[s-2]:e[0],h=s?e[s-1]:e[1],w=e[s+0],P=e[s+1],y=e[s+2],C=e[s+3],O=s!==x?e[s+4]:y,_=s!==x?e[s+5]:C,Y=w+(y-T)/6*r,m=P+(C-h)/6*r,$=y-(O-w)/6*r,I=C-(_-P)/6*r;g+="C"+[Y,m,$,I,y,C],l&&l.bt(Y,m,$,I,y,C)}if(a){var X=g.split("C");X.pop(),g=X.join("C")}return g},t.pointAlongCurve=function(e,r,i,l){if(De("27.7"),!(!e||!e[0]||!e[1]||!e[2]||!e[3])){n(l)&&(l=!1);var a=new t.Bezier(e[0],e[1],e[2],e[3]),s,f,c,x,k,v;if(l?(s=a.mx(r),f=a.my(r)):(s=a.x(r),f=a.y(r)),i){var g=r-.05,b=r+.05;g<0&&(g=0),b>1&&(b=1),l?(c=a.mx(g),x=a.my(g),k=a.mx(b),v=a.my(b)):(c=a.x(g),x=a.y(g),k=a.x(b),v=a.y(b));var E=t.angle(c,x,k,v);return{x:s,y:f,angle:E}}return{x:s,y:f}}},t.distanceAlongCurve=function(e){De("27.8");var r=t.dist(e[0],e[3]),i=t.dist(e[0],e[1])+t.dist(e[1],e[2])+t.dist(e[2],e[3]);return(r+i)/2},t.closestPointAlongCurve=function(e,r,i,l,a){De("27.9");var s=1e7,f,c=0,x=0;return n(i)&&(i=10),t.loop(r,function(k,v){var g=new t.Bezier(k[0],k[1],k[2],k[3]);t.loop(i,function(b,E){var A={x:g.x(b/E),y:g.y(b/E)},T=t.dist(e,A);T<s&&(s=T,f=A,c=v,x=b)})}),a?(c*i+x)/(r.length*i)*100:l?f:c},t.transformPoints=function(e,r,i,l,a){if(De("27.95"),!(n(e)||!Array.isArray(e))){n(l)&&(l=0),n(a)&&(a=0),e=t.copy(e);var s=l,f=a;r=="rotation"&&(l!=0&&(e=t.transformPoints(e,"x",-s)),a!=0&&(e=t.transformPoints(e,"y",-f)));for(var c,x=0;x<e.length;x++)if(c=e[x],!!Array.isArray(c)){if(r=="x")c[0]+=i;else if(r=="y")c[1]+=i;else if(r=="scaleX")c[0]=(c[0]-l)*i+l,c[4]=c[4]*i,c[6]=c[6]*i;else if(r=="scaleY")c[1]=(c[1]-a)*i+a,c[5]=c[5]*i,c[7]=c[7]*i;else if(r=="scale")c[0]=(c[0]-l)*i+l,c[4]=c[4]*i,c[6]=c[6]*i,c[1]=(c[1]-a)*i+a,c[5]=c[5]*i,c[7]=c[7]*i;else if(r=="rotation"){var k=i*Math.PI/180,v=c[0],g=c[1];c[0]=v*Math.cos(k)-g*Math.sin(k),c[1]=g*Math.cos(k)+v*Math.sin(k),v=c[4],g=c[5],c[4]=v*Math.cos(k)-g*Math.sin(k),c[5]=g*Math.cos(k)+v*Math.sin(k),v=c[6],g=c[7],c[6]=v*Math.cos(k)-g*Math.sin(k),c[7]=g*Math.cos(k)+v*Math.sin(k)}}return r=="rotation"&&(l!=0&&(e=t.transformPoints(e,"x",s)),a!=0&&(e=t.transformPoints(e,"y",f))),e}},t.trimPointEnds=function(e){De("27.97"),e[0][4]=0,e[0][5]=0,e[0][8]="free",e[e.length-1][6]=0,e[e.length-1][7]=0,e[e.length-1][8]="free"},t.reversePoints=function(e){return De("27.975"),e.reverse(),t.loop(e,function(r){var i=r[6];r[6]=r[4],r[4]=i;var l=r[7];r[7]=r[5],r[5]=l}),e},t.appendPoints=function(e,r,i){return De("27.98"),n(e)&&n(r)?[]:n(e)?r:(n(r)||(e[e.length-1][6]=r[0][6],e[e.length-1][7]=r[0][7],i&&(e[e.length-1][8]=i),r.shift(),e=e.concat(r)),e)},t.prependPoints=function(e,r,i){return De("27.985"),n(e)&&n(r)?[]:n(e)?r:(n(r)||(r[r.length-1][6]=e[0][6],r[r.length-1][7]=e[0][7],i&&(e[e.length-1][8]=i),e.shift(),e=r.concat(e)),e)},t.splitPoints=function(e,r,i){if(De("27.99"),!n(e)&&(n(r)&&(r=Math.floor(e.length/2)),!(r<0||r>e.length-1))){n(i)&&(i=!0);var l=t.copy(e.slice(0,r+1)),a=t.copy(e.slice(r));return i&&(t.trimPointEnds(l),t.trimPointEnds(a)),[l,a]}},t.makeID=function(e,r,i){De("13.5"),n(e)&&(e="mixed"),n(r)&&(r=5),n(i)&&(i="uppercase");var l,a=[2,3,4,5,6,7,8,9],s="abcdefghjkmnpqrstuvwxyz".split("");e.constructor===Array?l=e:e=="numbers"?l=a:e=="letters"?l=s:l=a.concat(s);for(var f="",c,x,k=0;k<r;k++)c=l[Math.floor(Math.random()*l.length)],x=Math.random(),i=="uppercase"||i=="mixed"&&x>.5?c.toUpperCase&&(c=c.toUpperCase()):c.toLowerCase&&(c=c.toLowerCase()),f+=String(c);return f},t.makeSyllable=function(e,r){De("13.55");var i="bcdfghjklmnprstvwxz",l="aeiouaeiouaeiouy";n(e)&&(e=3),n(r)&&(r=t.rand()<.3);function a(c){var x=t.rand(c.length-1),k=c.substring(x,x+1);return k}var s="",f=r?l:i;return t.loop(e,function(){s+=a(f),f=f==l?i:l}),s},t.makePrimitive=function(e){De("13.56");function r(i){return Array.isArray(i)?(t.loop(i,function(l){l=r(l)}),i):i.constructor==={}.constructor?(t.loop(i,function(l,a){i[l]=r(a)}),i):i instanceof String?String(i):i instanceof Number?Number(i):i instanceof Boolean?!!i:i}return r(e)},t.makeMath=function(){De("13.565");for(var e=Object.getOwnPropertyNames(Math),r=0;r<e.length;r++)j[e[r]]=Math[e[r]]},t.swapProperties=function(e,r,i){if(De("17.1"),n(r)||n(i)||n(r[e])||n(i[e]))return!1;var l=i[e];return i[e]=r[e],r[e]=l,!0},t.mobile=function(e){return De("28"),!n(j.MOBILE)&&j.MOBILE!="default"?j.MOBILE:!n(t.MOBILE)&&t.MOBILE!="default"?t.MOBILE:(n(e)&&(e=!0),/ip(hone|od|ad)/i.test(navigator.userAgent)?"ios":/android|nexus/i.test(navigator.userAgent)?"android":/blackberry/i.test(navigator.userAgent)?"blackberry":/nokia|phone|mobile/i.test(navigator.userAgent)?"windows":/opera mini|webos/i.test(navigator.userAgent)?"other":e&&j.orientation!==void 0?/safari/i.test(navigator.userAgent)?"ios":!0:!1)},t.vee=function(e){return De("28.5"),!n(e)&&(e.type=="Pick"||Array.isArray(e)||e.constructor=={}.constructor&&(!n(e.max)||!n(e.noPick))||typeof e=="function")},t.extend=function(e,r,i,l,a){var s="subclass, superclass, override, prefix, prototype",f;if(f=st(t.extend,arguments,s))return f;if(n(e)||n(r)){pt&&e!=t.StageGL&&tt("zim.extend() - please supply a class and its superclass");return}n(l)&&(l="super"),n(i)&&(i=[]),Array.isArray(i)||(i=[i]),n(a)&&(a=!0);var c={};for(var x in e.prototype)Object.defineProperty(c,x,Object.getOwnPropertyDescriptor(e.prototype,x));function k(){this.constructor=e}k.prototype=r.prototype,e.prototype=new k;for(x in c)Object.defineProperty(e.prototype,x,Object.getOwnPropertyDescriptor(c,x));var v=e.prototype,g=Object.getPrototypeOf&&Object.getPrototypeOf(v)||v.__proto__;if(g){v[(l+="_")+"constructor"]=g.constructor;for(var b,E=0;E<i.length;E++)b=i[E],typeof g[b]=="function"&&(v[l+b]=g[b]);if(a)for(b in g)Object.prototype.hasOwnProperty.call(v,b)&&typeof g[b]=="function"&&(v[l+b]=g[b])}return e},t.copy=function(e,r,i){if(t.copyCheck||(De("10"),t.copyCheck=!0),n(r)&&(r=!1),n(i)&&(i=!0),e==null||!(e instanceof Array||e.constructor=={}.constructor))return r&&e!=null&&e.clone&&e.type&&(e.type!="Container"&&e.type!="Stage"&&e.type!="StageGL"||i)?e.clone():e;if(e instanceof Array){for(var l=[],a=0;a<e.length;a++)l[a]=t.copy(e[a],r,i);return l}if(e.constructor=={}.constructor){var s={};for(var f in e){var c=t.copy(e[f],r,i);Object.prototype.hasOwnProperty.call(e,f)&&(s[f]=c)}return s}},t.merge=function(){t.mergeCheck||(De("12"),t.mergeCheck=!0);var e={},r,i;for(r=0;r<arguments.length;r++)for(i in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],i)&&(e[i]=arguments[r][i]);return e},t.sortObject=function(e,r,i){De("12.1");var l=function(c){return c[r]},a=Object.entries(e).sort(function(c,x){return i?l(c[1])<l(x[1])?1:l(c[1])>l(x[1])?-1:0:l(c[1])>l(x[1])?1:l(c[1])<l(x[1])?-1:0}),s=new Map(a),f={};return s.forEach((c,x)=>{f[x]=c}),f},t.arraysEqual=function(e,r,i){if(De("11"),n(e)||n(r)||(n(i)&&(i=!0),e.length!=r.length))return!1;for(var l=0;l<e.length;l++)if(e[l]instanceof Array&&r[l]instanceof Array){if(!t.arraysEqual(e[l],r[l],i))return!1}else{if(i&&e[l]!=r[l])return!1;if(!i)return t.arraysEqual(e.sort(),r.sort(),!0)}return!0},t.arrayMinMax=function(e){if(De("11.2"),!Array.isArray(e))return{min:null,max:null};for(var r=e[0],i=e[0],l=e.length;l--;)r=e[l]<r?e[l]:r,i=e[l]>i?e[l]:i;return r=isNaN(r)?null:r,i=isNaN(i)?null:i,{min:r,max:i}},t.isEmpty=function(e){if(t.zimEmptyCheck||(De("11.5"),t.zimEmptyCheck=!0),!n(e)){var r=0;for(var i in e){r++;break}return r==0}},t.isJSON=function(e){if(De("11.6"),typeof e!="string")return!1;try{return JSON.parse(e),!0}catch (e5){return!1}},t.isPick=function(e){if(t.zimPickCheck||(De("11.7"),t.zimPickCheck=!0),!n(e))return Array.isArray(e)||e.constructor=={}.constructor&&(e.min!=null&&e.max!=null||e.noPick)||e.constructor===Function&&(e.array!=null||e()!=null)},t.zut=function(e){if(n(e)||typeof e=="object")return!0},t.decimals=function(e,r,i,l,a,s,f){if(t.zimDecimalCheck||(De("13"),t.zimDecimalCheck=!0),n(e))return 0;n(r)&&(r=1),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=!0),n(s)&&(s=!1);var c=Math.round(e*Math.pow(10,r))/Math.pow(10,r);if(s){var x=c-Math.floor(c);c=t.decimals(Math.floor(c)+x*60/100,2)}var k=t.sign(c),v,g,b;if(i>0)for(v=String(c).indexOf("."),g=String(c).length,v<0&&(v=g++,c+="."),b=0;b<i-(g-v-1);b++)c+="0";if(l>1){k==-1&&(c=c.substr(1,c.length-1)),v=String(c).indexOf("."),g=String(c).length;var E=v<0?g:v;for(b=0;b<l-E;b++)c="0"+c;k==-1&&(c="-"+c)}return l==0&&(c=c.toString().replace(/^0\./,".")),i+l>0&&!a&&Number(c)==0&&(c=0),s&&(c=String(c).replace(".",":")),t.zut(f)?c:null},t.countDecimals=function(e){return t.zimCountDecimalsCheck||(De("13.05"),t.zimCountDecimalsCheck=!0),e%1?e.toString().split(".")[1].length:0},t.sign=function(e){return t.zimSignCheck||(De("13.1"),t.zimSignCheck=!0),e?e<0?-1:1:0},t.constrain=function(e,r,i,l){if(De("13.2"),!n(e)){if(n(r)&&(r=0),n(i)&&(i=Number.MAX_VALUE),i<r){var a=r;i=r,r=a}return n(l)&&(l=!1),l&&e<0?Math.max(-i,Math.min(e,-r)):Math.max(r,Math.min(e,i))}},t.dist=function(e,r,i,l){if(t.zimDistCheck||(De("13.3"),t.zimDistCheck=!0),!(n(e)||n(r)))return!n(e.x)&&!n(r.x)?(l=r.y,i=r.x,r=e.y,e=e.x):(n(i)&&(i=0),n(l)&&(l=0)),Math.sqrt(Math.pow(i-e,2)+Math.pow(l-r,2))},t.rectIntersect=function(e,r,i){return t.zimRectIntersectCheck||(De("13.32"),t.zimRectIntersectCheck=!0),n(i)&&(i=0),!(e.x>=r.x+r.width+i||e.x+e.width+i<=r.x||e.y>=r.y+r.height+i||e.y+e.height+i<=r.y)},t.boundsAroundPoints=function(e){t.zimBoundsAroundPointsCheck||(De("13.34"),t.zimBoundsAroundPointsCheck=!0);for(var r=1e4,i=1e4,l=-1e4,a=-1e4,s=0;s<e.length;s++){var f=e[s];f.x<r&&(r=f.x),f.x>l&&(l=f.x),f.y<i&&(i=f.y),f.y>a&&(a=f.y)}return{x:r,y:i,width:l-r,height:a-i}},t.angle=function(e,r,i,l){if(t.angleCheck||(De("13.4"),t.angleCheck=!0),!(n(e)||n(r)))return n(i)&&(i=e,e=0),n(l)&&(l=r,r=0),(Math.atan2(l-r,i-e)*180/Math.PI+360)%360},t.TAU=Math.PI*2,t.DEG=180/Math.PI,t.RAD=Math.PI/180,t.PHI=Math.pow(5,.5)*.5+.5,t.smoothStep=function(e,r,i){De("13.7");var l=t.constrain((e-r)/(i-r),0,1);return l*l*l*(l*(l*6-15)+10)},t.unicodeToUTF=function(e){if(De("13.75"),!!e){e!=" "&&(e=e.replace(/^\s+/g,""));var r,i="",l="";return r=e.charCodeAt(0),i=r,l=e.charCodeAt(1),l>=56320&&l<=57343&&(r=(i-55296)*1024+(l-56320)+65536),i=i.toString(16),l=l.toString(16),r=r.toString(16),"\\u"+i+"\\u"+l}},t.capitalizeFirst=function(e){return De("13.78"),e.charAt(0).toUpperCase()+e.slice(1)},t.Ajax=function(e,r,i,l){De("13.8");var a=new XMLHttpRequest;this.master=e,this.couple=r,this.lock=i,this.unique=l;var s=this;this.get=function(f,c){var x=n(s.master)?"":"&master="+encodeURI(e),k=n(s.lock)?"":"&lock="+encodeURI(i),v=s.unique?"&unique=true":"";a.open("GET",f+x+k+v,!0),a.onload=function(){a.status==200?c(t.isJSON(a.responseText)?JSON.parse(a.responseText):a.responseText):c(null,"Error: "+a.status)},a.send()},this.post=function(f,c,x,k,v){var g="url, data, command, extra, callback",b;if(b=st(s.post,arguments,g))return b;if(!n(f)){a.open("POST",f,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onload=function(){var w=a.responseText;t.isJSON(w)&&(s.couple&&(w=t.decouple(w)),w=JSON.parse(w)),v(w)},t.isJSON(c)||(c=JSON.stringify(c)),s.couple&&(c=t.couple(c));var E=n(s.master)?"":"&master="+encodeURIComponent(s.master),A=n(s.lock)?"":"&lock="+encodeURIComponent(s.lock),T=n(x)?"":"&command="+encodeURIComponent(x),h=n(k)?"":"&extra="+encodeURIComponent(k);a.send("data="+encodeURIComponent(c)+E+A+T+h)}},this.put=function(f,c,x){a.open("PUT",f,!0),a.setRequestHeader("Content-type","application/json"),a.onload=function(){x(t.isJSON(a.responseText)?JSON.parse(a.responseText):s.http.responseText)},a.send(JSON.stringify(c))}},t.Noise=function(e){"use strict";De("13.9"),n(e)&&(e=Math.random()*1e6);var r=e;this.seed=e;var i=this,l={};l.NORM_2D=1/47,l.NORM_3D=1/103,l.NORM_4D=1/30,l.SQUISH_2D=(Math.sqrt(2+1)-1)/2,l.SQUISH_3D=(Math.sqrt(3+1)-1)/3,l.SQUISH_4D=(Math.sqrt(4+1)-1)/4,l.STRETCH_2D=(1/Math.sqrt(2+1)-1)/2,l.STRETCH_3D=(1/Math.sqrt(3+1)-1)/3,l.STRETCH_4D=(1/Math.sqrt(4+1)-1)/4,l.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],l.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],l.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],l.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],l.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],l.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],l.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],l.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],l.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],l.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],l.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],l.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];function a(P){var y=new Uint32Array(1);return y[0]=P[0]*1664525+1013904223,y}function s(P,y,C){this.dx=-y-P*l.SQUISH_2D,this.dy=-C-P*l.SQUISH_2D,this.xsb=y,this.ysb=C}function f(P,y,C,O){this.dx=-y-P*l.SQUISH_3D,this.dy=-C-P*l.SQUISH_3D,this.dz=-O-P*l.SQUISH_3D,this.xsb=y,this.ysb=C,this.zsb=O}function c(P,y,C,O,_){this.dx=-y-P*l.SQUISH_4D,this.dy=-C-P*l.SQUISH_4D,this.dz=-O-P*l.SQUISH_4D,this.dw=-_-P*l.SQUISH_4D,this.xsb=y,this.ysb=C,this.zsb=O,this.wsb=_}var x=[],k,v,g,b,E,A;for(k=0;k<l.p2D.length;k+=4){for(b=l.base2D[l.p2D[k]],E=null,A=null,v=0;v<b.length;v+=3)A=new s(b[v],b[v+1],b[v+2]),E===null?x[k/4]=A:E.next=A,E=A;A.next=new s(l.p2D[k+1],l.p2D[k+2],l.p2D[k+3])}for(this.lookup2D=[],k=0;k<l.lookupPairs2D.length;k+=2)this.lookup2D[l.lookupPairs2D[k]]=x[l.lookupPairs2D[k+1]];var T=[];for(k=0;k<l.p3D.length;k+=9){for(b=l.base3D[l.p3D[k]],E=null,A=null,v=0;v<b.length;v+=4)A=new f(b[v],b[v+1],b[v+2],b[v+3]),E===null?T[k/9]=A:E.next=A,E=A;A.next=new f(l.p3D[k+1],l.p3D[k+2],l.p3D[k+3],l.p3D[k+4]),A.next.next=new f(l.p3D[k+5],l.p3D[k+6],l.p3D[k+7],l.p3D[k+8])}for(this.lookup3D=[],k=0;k<l.lookupPairs3D.length;k+=2)this.lookup3D[l.lookupPairs3D[k]]=T[l.lookupPairs3D[k+1]];var h=[];for(k=0;k<l.p4D.length;k+=16){for(b=l.base4D[l.p4D[k]],E=null,A=null,v=0;v<b.length;v+=5)A=new c(b[v],b[v+1],b[v+2],b[v+3],b[v+4]),E===null?h[k/16]=A:E.next=A,E=A;A.next=new c(l.p4D[k+1],l.p4D[k+2],l.p4D[k+3],l.p4D[k+4],l.p4D[k+5]),A.next.next=new c(l.p4D[k+6],l.p4D[k+7],l.p4D[k+8],l.p4D[k+9],l.p4D[k+10]),A.next.next.next=new c(l.p4D[k+11],l.p4D[k+12],l.p4D[k+13],l.p4D[k+14],l.p4D[k+15])}for(this.lookup4D=[],k=0;k<l.lookupPairs4D.length;k+=2)this.lookup4D[l.lookupPairs4D[k]]=h[l.lookupPairs4D[k+1]];this.perm=new Uint8Array(256),this.perm2D=new Uint8Array(256),this.perm3D=new Uint8Array(256),this.perm4D=new Uint8Array(256);var w=new Uint8Array(256);for(k=0;k<256;k++)w[k]=k;for(e=new Uint32Array(1),e[0]=r,e=a(a(a(e))),k=255;k>=0;k--)e=a(e),g=new Uint32Array(1),g[0]=(e[0]+31)%(k+1),g[0]<0&&(g[0]+=k+1),this.perm[k]=w[g[0]],this.perm2D[k]=this.perm[k]&14,this.perm3D[k]=this.perm[k]%24*3,this.perm4D[k]=this.perm[k]&252,w[g[0]]=w[k];this.simplex1D=function(P){return i.simplex2D(P,1)},this.simplex2D=function(P,y){var C=(P+y)*l.STRETCH_2D,O=[P+C,y+C],_=O[0],Y=O[1],m=[Math.floor(_),Math.floor(Y)],$=m[0],I=m[1],X=($+I)*l.SQUISH_2D,R=[P-($+X),y-(I+X)],q=R[0],J=R[1],Z=[_-$,Y-I],ne=Z[0],U=Z[1],B=ne+U,d=new Uint32Array(4);d[0]=ne-U+1,d[1]=B,d[2]=B+U,d[3]=B+ne;for(var u=d[0]|d[1]<<1|d[2]<<2|d[3]<<4,o=i.lookup2D[u],S=0;typeof o<"u";){var F=[q+o.dx,J+o.dy],p=F[0],L=F[1],we=2-p*p-L*L;if(we>0){var D=[$+o.xsb,I+o.ysb],N=D[0],ue=D[1],fe=i.perm2D[i.perm[N&255]+ue&255],V=l.gradients2D[fe]*p+l.gradients2D[fe+1]*L;we*=we,S+=we*we*V}o=o.next}return S*l.NORM_2D},this.simplex3D=function(P,y,C){var O=(P+y+C)*l.STRETCH_3D,_=[P+O,y+O,C+O],Y=_[0],m=_[1],$=_[2],I=[Math.floor(Y),Math.floor(m),Math.floor($)],X=I[0],R=I[1],q=I[2],J=(X+R+q)*l.SQUISH_3D,Z=[P-(X+J),y-(R+J),C-(q+J)],ne=Z[0],U=Z[1],B=Z[2],d=[Y-X,m-R,$-q],u=d[0],o=d[1],S=d[2],F=u+o+S,p=new Uint32Array(7);p[0]=o-S+1,p[1]=u-o+1,p[2]=u-S+1,p[3]=F,p[4]=F+S,p[5]=F+o,p[6]=F+u;for(var L=p[0]|p[1]<<1|p[2]<<2|p[3]<<3|p[4]<<5|p[5]<<7|p[6]<<9,we=i.lookup3D[L],D=0;typeof we<"u";){var N=[ne+we.dx,U+we.dy,B+we.dz],ue=N[0],fe=N[1],V=N[2],z=2-ue*ue-fe*fe-V*V;if(z>0){var se=[X+we.xsb,R+we.ysb,q+we.zsb],Oe=se[0],K=se[1],ge=se[2],Q=i.perm3D[i.perm[i.perm[Oe&255]+K&255]+ge&255],ce=l.gradients3D[Q]*ue+l.gradients3D[Q+1]*fe+l.gradients3D[Q+2]*V;z*=z,D+=z*z*ce}we=we.next}return D*l.NORM_3D},this.simplex4D=function(P,y,C,O){var _=(P+y+C+O)*l.STRETCH_4D,Y=[P+_,y+_,C+_,O+_],m=Y[0],$=Y[1],I=Y[2],X=Y[3],R=[Math.floor(m),Math.floor($),Math.floor(I),Math.floor(X)],q=R[0],J=R[1],Z=R[2],ne=R[3],U=(q+J+Z+ne)*l.SQUISH_4D,B=P-(q+U),d=y-(J+U),u=C-(Z+U),o=O-(ne+U),S=[m-q,$-J,I-Z,X-ne],F=S[0],p=S[1],L=S[2],we=S[3],D=F+p+L+we,N=new Uint32Array(11);N[0]=L-we+1,N[1]=p-L+1,N[2]=p-we+1,N[3]=F-p+1,N[4]=F-L+1,N[5]=F-we+1,N[6]=D<<6,N[7]=D+we,N[8]=D+L,N[9]=D+p,N[10]=D+F;for(var ue=N[0]|N[1]<<1|N[2]<<2|N[3]<<3|N[4]<<4|N[5]<<5|N[6]<<6|N[7]<<8|N[8]<<11|N[9]<<14|N[10]<<17,fe=i.lookup4D[ue],V=0;typeof fe<"u";){var z=[B+fe.dx,d+fe.dy,u+fe.dz,o+fe.dw],se=z[0],Oe=z[1],K=z[2],ge=z[3],Q=2-se*se-Oe*Oe-K*K-ge*ge;if(Q>0){var ce=[q+fe.xsb,J+fe.ysb,Z+fe.zsb,ne+fe.wsb],G=ce[0],le=ce[1],Ae=ce[2],re=ce[3],xe=i.perm4D[i.perm[i.perm[i.perm[G&255]+le&255]+Ae&255]+re&255],ke=l.gradients4D[xe]*se+l.gradients4D[xe+1]*Oe+l.gradients4D[xe+2]*K+l.gradients4D[xe+3]*ge;Q*=Q,V+=Q*Q*ke}fe=fe.next}return V*l.NORM_4D}},typeof Ge<"u"&&(t.Point=function(e,r,i,l,a,s,f,c,x,k){De("13.45"),n(e)&&(e=0),n(r)&&(r=0),n(i)&&(i=0),n(l)&&(l=0),n(a)&&(a=0),n(s)&&(s=0),n(f)&&(f=0),n(c)&&(c=0),n(x)&&(x=0),n(k)&&(k=0),this.createjsPoint_constructor(e,r),this.type="Point",this.x=e,this.y=r,this.z=i,this.q=l,this.r=a,this.s=s,this.t=f,this.u=c,this.v=x,this.w=k,this.angle=function(v){return this.createjsPoint_angle(v)*180/Math.PI},this.project=function(v,g){return this.createjsPoint_project(v*Math.PI/180,g)}},t.extend(t.Point,Ge.Point,["angle","project"],"createjsPoint")),t.Bezier=function(r,i,l,a){De("13.47"),this.a=r,this.b=i,this.c=l,this.d=a,this.len=100,this.arcLengths=new Array(this.len+1),this.arcLengths[0]=0;for(var s=this.x(0),f=this.y(0),c=0,x=1;x<=this.len;x+=1){var k=this.x(x*.01),v=this.y(x*.01),g=s-k,b=f-v;c+=Math.sqrt(g*g+b*b),this.arcLengths[x]=c,s=k,f=v}this.length=c},t.Bezier.prototype={map:function(e){for(var r=e*this.arcLengths[this.len],i=0,l=this.len,a=0;i<l;)a=i+((l-i)/2|0),this.arcLengths[a]<r?i=a+1:l=a;this.arcLengths[a]>r&&a--;var s=this.arcLengths[a];return s===r?a/this.len:(a+(r-s)/(this.arcLengths[a+1]-s))/this.len},mx:function(e){return this.x(this.map(e))},my:function(e){return this.y(this.map(e))},x:function(e){return(1-e)*(1-e)*(1-e)*this.a.x+3*((1-e)*(1-e))*e*this.b.x+3*(1-e)*(e*e)*this.c.x+e*e*e*this.d.x},y:function(e){return(1-e)*(1-e)*(1-e)*this.a.y+3*((1-e)*(1-e))*e*this.b.y+3*(1-e)*(e*e)*this.c.y+e*e*e*this.d.y}},t.Boundary=function(e,r,i,l){De("13.46"),e.x&&(l=e.height,i=e.width,r=e.y,e=e.x),!(n(e)||n(r)||n(i)||n(l))&&(this.x=e,this.y=r,this.width=i,this.height=l,this.contract=function(a,s,f,c){return n(a)?this:(n(s)&&(s=a),n(f)?f=a*2:f=f+a,n(c)?c=s*2:c=c+s,this.x+=a,this.y+=s,this.width-=f,this.height-=c,this)})},t.GradientColor=function(e,r,i,l,a,s){if(De("13.465"),this.type="GradientColor",this.colors=n(e)?["black","white"]:e,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=n(r)?0:r,!Array.isArray(this.ratios)){this.angle=this.ratios,this.ratios=[];for(var f=0;f<this.colors.length;f++)this.ratios.push(f/(this.colors.length-1))}!n(i)&&(n(l)||n(a)||n(s))?(this.angle=i,i=null):n(this.angle)&&n(i)&&n(l)&&n(a)&&n(s)?this.angle=0:(this.x0=n(i)?0:i,this.y0=n(l)?0:l,this.x1=n(a)?0:a,this.y1=n(s)?100:s)},t.RadialColor=function(e,r,i,l,a,s,f,c){if(De("13.466"),this.type="RadialColor",this.colors=n(e)?["black","white"]:e,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=r,!Array.isArray(this.ratios)){this.ratios=[];for(var x=0;x<this.colors.length;x++)this.ratios.push(x/(this.colors.length-1))}this.x0=i,this.y0=l,this.r0=a,this.x1=s,this.y1=f,this.r1=c},t.BitmapColor=function(e,r,i){De("13.467"),this.type="BitmapColor",typeof e=="string"&&j.asset&&(e=j.asset(e)),e.type!="Bitmap"&&e.bitmap&&(e=e.bitmap),this.image=e.type=="Bitmap"?e.image:e,this.repetition=r,this.matrix=i},t.Damp=function(e,r){De("14");var i="startValue, damp",l;if(l=st(t.Damp,arguments,i,this))return l;this.lastValue=n(e)?0:e,this.damp=n(r)?.1:r},t.Damp.prototype.convert=function(e){return this.lastValue=this.lastValue+(e-this.lastValue)*this.damp},t.Damp.prototype.immediate=function(e){return this.lastValue=e,this},t.Proportion=function(e,r,i,l,a,s,f){var c="baseMin, baseMax, targetMin, targetMax, factor, targetRound, clamp",x;if(x=st(t.Proportion,arguments,c,this))return x;De("15"),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=1),n(s)&&(s=!1),n(f)&&(f=!0);var k,v;this.convert=function(g){if(n(g)&&(g=e),!(isNaN(g)||r-e==0))return f&&(g=Math.max(g,e),g=Math.min(g,r)),k=(g-e)/(r-e),a>0?v=i+(l-i)*k:v=l-(l-i)*k,s&&(v=Math.round(v)),v}},t.ProportionDamp=function(e,r,i,l,a,s,f,c){var x="baseMin, baseMax, targetMin, targetMax, damp, factor, targetRound, clamp",k;if(k=st(t.ProportionDamp,arguments,x,this))return k;De("16"),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=.1),n(s)&&(s=1),n(f)&&(f=!1),n(c)&&(c=!0),this.damp=a;var v=this,g,b,E,A,T,h=0,w=0;g=e,w=i;var P=setInterval(y,20);function y(){isNaN(g)||r-e==0||(c&&(g=Math.max(g,e),g=Math.min(g,r)),b=(g-e)/(r-e),E=l-i,s>0?A=i+E*b:A=l-E*b,h=A,T=h-w,w+=T*v.damp)}this.immediate=function(C){return v.convert(C),y(),w=A,f&&(w=Math.round(w)),v},this.immediateValue=function(C){return h=w=C,v},this.convert=function(C){return g=C,f?Math.round(w):w},this.dispose=function(){return clearInterval(P),!0}},t.Dictionary=function(e){De("17"),this.length=0,this.unique=e;var r=this.objects=[],i=this.values=[];this.type="Dictionary",this.add=function(l,a){n(l)||(n(a)&&(a=!0),this.unique&&this.remove(l),r.push(l),i.push(a),this.length++)},this.at=function(l){if(!n(l)){var a=r.indexOf(l);return a>-1?i[a]:null}},this.remove=function(l){if(n(l))return!1;var a=r.indexOf(l);return a>-1?(r.splice(a,1),i.splice(a,1),this.length--,!0):!1},this.clear=function(){return r=this.objects=[],i=this.values=[],this.length=null,this},this.dispose=function(){return r=null,i=null,this.length=null,!0}},t.Hierarchy=function(e,r){De("17.5");var i=this;if(n(e))return;n(r)&&(r=!1);var l;i.processSimple=function(c){var x=0,k={};function v(g,b,E,A){if(n(g)||(c=g),c.constructor=={}.constructor){var T;c.list&&(T=c,c=c.list),A&&T&&t.loop(T,function(h,w){h!="list"&&(A[h]=w)}),t.loop(c,function(h,w){var P={},y=b["id"+x]={obj:h,level:E,open:r,opened:!1,list:P};x++,v(w,P,E+1,y)})}else Array.isArray(c)&&t.loop(c,function(h){b["id"+x]={obj:h},x++})}return v(e,k,0),l=x,k},i.processComplex=function(c){var x=0;function k(v,g){t.loop(v,function(b,E){E.level=g,n(E.open)&&(E.open=r),n(E.opened)&&(E.opened=!1),E.list&&k(E.list,g+1),x++})}return k(c,0),l=x,c},n(e.id0)?i.data=i.processSimple(e):i.data=i.processComplex(e),i.getLinearList=function(c){return n(c)&&(c=i.data),a(c)[0]},i.getLinearIDs=function(c){return n(c)&&(c=i.data),a(c)[1]};function a(c){var x=[],k=[];function v(g,b){t.loop(g,function(E,A){x.push(A.obj),k.push(E),A.open&&v(A.list,b+1)})}return v(c,0),[x,k]}i.getData=function(c){var x;function k(v){t.loop(v,function(g,b){if(g==c)return x=b,x;k(b.list)})}return k(i.data),x},i.getNextSibling=function(c){var x,k;function v(g){t.loop(g,function(b,E){if(!k&&x)return k=b,k;b==c?x=E:v(E.list)})}return v(i.data),k},i.getPrevSibling=function(c){var x=[],k;function v(g,b){t.loop(g,function(E,A){if(E==c)return k=x[b]||x[b-1],k;x[b]=E,v(A.list,b+1)})}return v(i.data,0),k},i.insertBefore=function(c,x,k){return s("insertBefore",c,x,k)},i.insertAfter=function(c,x,k){return s("insertAfter",c,x,k)},i.removeItem=function(c){return s("removeItem",null,c)},i.replaceItem=function(c,x){var k=i.getData(x);return k.obj=c,s("replaceItem")};function s(c,x,k,v){var g=0,b={},E=i.data;function A(T,h,w,P){t.loop(T,function(y,C){if(!(c=="removeItem"&&y==k)){var O,_,Y;c=="insertBefore"&&y==k&&(g=f(h,g,w,x,v)),O={},_=C.list,C.list=O,C.opened=!1,C.open=!1,Y=h["id"+g]=C,Y.obj.type&&Y.obj.type=="TabsButton"&&(Y.obj=Y.obj.text),g++,A(_,O,w+1),c=="insertAfter"&&y==k&&(g=f(h,g,w,x,v))}})}return A(E,b,0),l=g,b}function f(c,x,k,v,g){if(g){var b={};Array.isArray(v)&&(v=v[0]),c["id"+x]={obj:v,level:k,open:!1,opened:!1,list:b},x++,Array.isArray(g)||(g=[g]),t.loop(g,function(E){b["id"+x]={obj:E,level:k+1,open:!1,opened:!1,list:{}},x++})}else Array.isArray(v)||(v=[v]),t.loop(v,function(E){c["id"+x]={obj:E,level:k,open:!1,opened:!1,list:{}},x++});return x}i.getParent=function(c){var x=i.data;function k(v,g){var b=t.loop(v,function(E,A){if(E==c)return l-=1,g;if(A.list&&!t.isEmpty(A.list))return k(A.list,E)});if(b!==!0)return b}return k(x)},Object.defineProperty(i,"length",{get:function(){return l},set:function(){pt&&tt("Hierarchy() - length is read only")}})},t.Pick=function(e){t.pickCheck||(De("17.6"),t.pickCheck=!0),this.choices=e,this.num=function(i){for(var l=[],a=0;a<i;a++)l.push(t.Pick.choose(this));return this.choices=t.Pick.series(l),this};var r=this;this.loop=function(i,l){for(var a,s=0;s<i;s++)if(a=l(t.Pick.choose(r),s,i),typeof a<"u")return a}},t.Pick.prototype.type="Pick",t.Pick.series=function(){return t.pickCheck||(De("17.6"),t.pickCheck=!0),t.series.apply(null,arguments)},t.Pick.rand=function(e,r,i,l){return t.pickCheck||(De("17.6"),t.pickCheck=!0),t.rand(e,r,i,l)},t.Pick.choose=function(e,r,i){if(t.pickCheck||(De("17.6"),t.pickCheck=!0),r==null&&(r=!0),e==null)return e;if(e.type=="Pick"||r){var l=e.choices||e,a;return Array.isArray(l)?(a=l[Math.floor(Math.random()*l.length)],t.Pick.choose(a)):l.constructor==={}.constructor?n(l.noPick)?n(l.max)?l:(n(l.integer)&&(l.integer=!1),a=t.Pick.rand(l.min,l.max,l.integer,l.negative),a):l.noPick:l instanceof Function?(l.count==null?l.count=0:l.count++,t.Pick.choose(l(i,!0))):e}else return e},t.Pick.getMinMax=function(e){return!n(e.min)&&!n(e.max)?e:Array.isArray(e)?t.arrayMinMax(e):e.type=="series"?t.arrayMinMax(e.array):{min:null,max:null}},t.scrollX=function(e,r){return De("18"),t.abstractScroll("X","Left",e,r)},t.scrollY=function(e,r){return De("19"),t.abstractScroll("Y","Top",e,r)},t.abstractScroll=function(e,r,i,l){De("20");var a=Tt(l),s=e=="X"?"Y":"X";if(n(i))return document.documentElement&&document.documentElement["scroll"+r]||document.body["scroll"+r];if(n(l))j.scrollTo(t["scroll"+s](),i);else{var f=50,c=l*(a=="s"?1e3:1);c<f&&(c=f);var x=c/f,k=t["scroll"+e](),v=i-k,g=v/x,b=0,E=setInterval(function(){b++,k+=g,j.scrollTo(t["scroll"+s](),k),b>=x&&(j.scrollTo(t["scroll"+s](),i),clearInterval(E))},f)}return i},t.windowWidth=function(){De("21");var e=isNaN(j.innerWidth)?j.clientWidth:j.innerWidth,r=isNaN(j.innerHeight)?j.clientHeight:j.innerHeight;if(t.mobile()&&!n(j.orientation)&&!j.parent&&(e>r&&Math.abs(j.orientation)!=90||r>e&&Math.abs(j.orientation)==90)){var i=e;e=r,r=i}return j.zdf&&j.zdf.swapRotation?r:e},t.windowHeight=function(){De("22");var e=isNaN(j.innerWidth)?j.clientWidth:j.innerWidth,r=isNaN(j.innerHeight)?j.clientHeight:j.innerHeight;if(t.mobile()&&!n(j.orientation)&&!j.parent&&(e>r&&Math.abs(j.orientation)!=90||r>e&&Math.abs(j.orientation)==90)){var i=e;e=r,r=i}return j.zdf&&j.zdf.swapRotation?e:r},t.browserZoom=function(){if(t.zimBZ)return n(t.zimBZA)?t.decimals((j.devicePixelRatio||1)/t.zimBZ1,2):t.zimBZA;if(De("22.2"),t.zimBZ=!0,typeof e>"u")if(j.zdf)var e=j.zdf;else return t.zimBZA=1,1;if(e.retina)t.zimBZ1=j.devicePixelRatio||1;else return t.zimBZA=1,1},t.getQueryString=function(e){if(De("22.5"),n(e)&&(e=location.search.replace("?","")),e=="")return{};for(var r=e.split("&"),i={},l=0;l<r.length;l++){var a=r[l].split("=");typeof i[a[0]]>"u"?i[a[0]]=decodeURIComponent((a[1]+"").replace(/\+/g,"%20")):typeof i[a[0]]=="string"?i[a[0]]=[i[a[0]],decodeURIComponent((a[1]+"").replace(/\+/g,"%20"))]:i[a[0]].push(decodeURIComponent((a[1]+"").replace(/\+/g,"%20")))}return i},t.swapHTML=function(e,r){return De("17.2"),t.swapProperties("innerHTML",Cn(e),Cn(r))},t.urlEncode=function(e){return De("23"),e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},t.urlDecode=function(e){return De("24"),decodeURIComponent((e+"").replace(/\+/g,"%20"))},t.setCookie=function(e,r,i){if(De("25"),!(n(e)||n(r))){var l;if(i){var a=new Date;a.setTime(a.getTime()+i*24*60*60*1e3),l="; expires="+a.toGMTString()}else l="";return document.cookie=e+"="+escape(r)+l+"; path=/",!0}},t.getCookie=function(e){De("26");for(var r=document.cookie.split(/;\s*/),i=new Array,l,a=0;a<r.length;a++)l=r[a].split("="),i[l[0]]=l[1];if(!(typeof i[e]>"u"))return unescape(i[e])},t.deleteCookie=function(e){return De("27"),n(t.getCookie(e))?!1:(t.setCookie(e,"",-1),!0)},Ge==null)return pt&&ii("ZIM >= 4.3.0 requires createjs namespace to be loaded (import createjs before zim)"),t;t.localToGlobal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null)){var s=a.call(l,r,i),f=l.stage;if(!j.zdf){if(!f)return s;j.zdf={stage:f,canvas:f.canvas}}return s.x/=t.scaX,s.y/=t.scaY,s}},t.globalToLocal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null)){var s=l.stage;if(!j.zdf){if(!s)return a.call(l,r,i);j.zdf={stage:s,canvas:s.canvas}}r*=t.scaX,i*=t.scaY;var f=a.call(l,r,i);return f}},t.localToLocal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null||l==null)){var s=a.localToGlobal(r,i),f=a.stage;if(!j.zdf){if(!f)return l.globalToLocal(s.x,s.y);j.zdf={stage:f,canvas:f.canvas}}if(f||(f=j.zdf.stage),l==f)return s;if(s)return l.globalToLocal(s.x,s.y)}},t.displayBase=function(e){t.zimDBCheck||(De("50.432"),t.zimDBCheck=!0);var r=e;if(Object.defineProperty(e,"width",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.width*this.scaleX)},set:function(c){if(e.scaleDimensions!==!1){var x=this.getBounds();if(n(x)||x.width==0){pt&&tt("DisplayObject() - width needs bounds set with setBounds()");return}var k=c/x.width;this.scaleX=this.scaleY=k}else{var v=e.width!=0?e.height/e.width:0;e.setWidth(c),e.setHeight(c*v),e.drawShape()}}}),Object.defineProperty(e,"height",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.height*this.scaleY)},set:function(c){if(e.scaleDimensions!==!1){var x=this.getBounds();if(n(x)||x.height==0){pt&&tt("DisplayObject() - height needs bounds set with setBounds()");return}var k=c/x.height;this.scaleX=this.scaleY=k}else{var v=e.height!=0?e.width/e.height:0;e.setHeight(c),e.setWidth(c*v),e.drawShape()}}}),Object.defineProperty(e,"widthOnly",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.width*this.scaleX)},set:function(c){if(e.scaleDimensions!==!1){var x=this.getBounds();if((n(x)||x.width==0)&&pt){tt("DisplayObject() - widthOnly needs bounds set with setBounds()");return}var k=c/x.width;this.scaleX=k}else e.setWidth(c),e.drawShape()}}),Object.defineProperty(e,"heightOnly",{enumerable:!0,get:function(){var c=this.getBounds();return n(c)?null:Math.abs(c.height*this.scaleY)},set:function(c){if(e.scaleDimensions!==!1){var x=this.getBounds();if((n(x)||x.height==0)&&pt){tt("DisplayObject() - heightOnly needs bounds set with setBounds()");return}var k=c/x.height;this.scaleY=k}else e.setHeight(c),e.drawShape()}}),Object.defineProperty(e,"level",{enumerable:!0,get:function(){return this.parent?this.parent.getChildIndex(this):null},set:function(c){this.parent&&this.parent.setChildIndex(this,Math.max(0,Math.min(c,this.parent.numChildren-1)))}}),Object.defineProperty(e,"depth",{enumerable:!0,get:function(){return this._depth},set:function(c){if(this._depth=c,!n(this.vrChannel)){var x=this.vrParallaxDistance?c*this.vrParallax*this.vrParallaxDistance:0;this.vrChannel=="left"?this.x=this.vrStartX+c+x:this.vrChannel=="right"&&(this.x=this.vrStartX-c+x)}}}),Object.defineProperty(e,"blendMode",{enumerable:!0,get:function(){return this.compositeOperation},set:function(c){this.compositeOperation=c}}),!r.name){var i;Object.defineProperty(r,"name",{get:function(){return i},set:function(c){i=c,t.zimObjectIDs[c]=r}})}r._draggable,Object.defineProperty(r,"draggable",{get:function(){return this._draggable},set:function(c){c!=this._draggable&&(this._draggable=c,this._draggable?this.drag():this.noDrag())}});var l,a;r.on("mousedown",function(c){c.target.stage&&(l=c.target.stage.frame,l.allowDefault&&(a=!0,l.allowDefault=!1))}),r.on("pressup",function(){l&&a&&(l.allowDefault=!0)});for(var s=["hue","saturation","brightness","contrast"],f=0;f<s.length;f++)-function(){for(var c=s[f],x=0;x<2;x++)-function(){var k=x==0?"":"Batch";Object.defineProperty(r,c+k,{get:function(){return r.effects&&r.effects.multi?r.effects.multi[c]:0},set:function(v){!r.effects||!r.effects.multi?r.effect(new t.MultiEffect(c=="hue"?v:0,c=="saturation"?v:0,c=="brightness"?v:0,c=="contrast"?v:0)):r.effects.multi[c]=v,k==""&&r.updateEffects()}})}()}()},t.gD=function(e){if(t.zimGDCheck||(De("50.435"),t.zimGDCheck=!0),!!e){if(e.z_bc){var r=e.z_bc;r.width=r.height=1,r.getContext&&r.getContext("2d").clearRect(0,0,1,1),delete e.z_bc}t.KEYFOCUS==e&&(t.KEYFOCUS=null),j.KEYFOCUS==e&&(j.KEYFOCUS=null),e.veeObj&&(e.veeObj=null),e.draggable&&e.noDrag(),e.zimTweens&&e.stopAnimate(),e.zimWire&&e.noWire(),e.zimWired&&e.noWired(),e.zimClickHoldDownEvent&&e.noHold(),e.transformControls&&e.transformControls.dispose(),e.zimClickDownEvent&&(e.zimClickDownEvent=null),e.zimClickUpEvent&&(e.zimClickUpEvent=null),e.physics&&e.removePhysics(),e.name&&t.zimObjectIDs[e.name]==e&&delete t.zimObjectIDs[e.name]}},t.Stage=function(e,r,i){if(De("50.44"),!n(e)){var l=e.tagName=="CANVAS"?e:Cn(e);n(l)||(this.cjsStage_constructor(e),this.setBounds(0,0,l.width,l.height),this.type="Stage",j.zdf||(j.zimDefaultFrame=j.zdf={stage:this}),i?Ge.Touch.enable(this,!0):r&&Ge.Touch.enable(this,!1),this.cache=function(a,s,f,c,x,k){if(n(f))if(n(a)){var v=this.getBounds();if(!n(v)){var g=this.borderWidth>0?this.borderWidth/2:0;a=v.x-g,s=v.y-g,f=v.width+g*2,c=v.height+g*2}}else f=a,c=s,a=0,s=0;return this.cjsStage_cache(a,s,f,c,x,k),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(a){var s=a.clone();s.type="pressdown",a.target.dispatchEvent(s)},void 0,!1,void 0,!0),this.loop=function(a,s,f,c,x,k){return t.loop(this,a,s,f,c,x,k)},this.hitTestGrid=function(a,s,f,c,x,k,v,g,b,E,A,T){return t.hitTestGrid(this,a,s,f,c,x,k,v,g,b,E,A,T)},this.disposeAllChildren=function(){for(var a=this.numChildren-1;a>=0;a--){var s=this.getChildAt(a);s.dispose&&s.dispose()}return this},this.frame=j.zdf,Ge&&!Ge.stageTransformable&&(j.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(a){this.cjsStage_scaleX=a,this.cjsStage_scaleY=a,t.scaX=Ge.stageTransformable?1:a,t.scaY=Ge.stageTransformable?1:a}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(a){this.cjsStage_scaleX=a,t.scaX=Ge.stageTransformable?1:a}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(a){this.cjsStage_scaleY=a,t.scaY=Ge.stageTransformable?1:a}}),this.localToGlobal=function(a,s){return t.localToGlobal(a,s,this,this.cjsStage_localToGlobal)},this.globalToLocal=function(a,s){return t.globalToLocal(a,s,this,this.cjsStage_globalToLocal)},this.localToLocal=function(a,s,f){return t.localToLocal(a,s,f,this)}))}},t.extend(t.Stage,Ge.Stage,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStage",!1),t.StageGL=function(e,r,i,l){if(De("50.45"),!n(e)){var a=e.tagName=="CANVAS"?e:Cn(e);n(a)||(this.cjsStageGL_constructor(e,r),this.setBounds(0,0,a.width,a.height),this.type="StageGL",j.zdf||(j.zdf={stage:this}),l?Ge.Touch.enable(this,!0):i&&Ge.Touch.enable(this,!1),this.cache=function(s,f,c,x,k,v){if(n(c))if(n(s)){var g=this.getBounds();if(!n(g)){var b=this.borderWidth>0?this.borderWidth/2:0;s=g.x-b,f=g.y-b,c=g.width+b*2,x=g.height+b*2}}else c=s,x=f,s=0,f=0;return this.cjsStageGL_cache(s,f,c,x,k,v),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(s){var f=s.clone();f.type="pressdown",s.target.dispatchEvent(f)},void 0,!1,void 0,!0),this.loop=function(s,f,c,x,k,v){return t.loop(this,s,f,c,x,k,v)},this.hitTestGrid=function(s,f,c,x,k,v,g,b,E,A,T,h){return t.hitTestGrid(this,s,f,c,x,k,v,g,b,E,A,T,h)},this.disposeAllChildren=function(){for(var s=this.numChildren-1;s>=0;s--){var f=this.getChildAt(s);f.dispose&&f.dispose()}return this},this.frame=j.zdf,Ge&&!Ge.stageTransformable&&(j.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(s){this.cjsStage_scaleX=s,this.cjsStage_scaleY=s,t.scaX=Ge.stageTransformable?1:s,t.scaY=Ge.stageTransformable?1:s}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(s){this.cjsStage_scaleX=s,t.scaX=Ge.stageTransformable?1:s}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(s){this.cjsStage_scaleY=s,t.scaY=Ge.stageTransformable?1:s}}),this.localToGlobal=function(s,f){return t.localToGlobal(s,f,this,this.cjsStageGL_localToGlobal)},this.globalToLocal=function(s,f){return t.globalToLocal(s,f,this,this.cjsStageGL_globalToLocal)},this.localToLocal=function(s,f,c){return t.localToLocal(s,f,c,this)}))}},t.extend(t.StageGL,Ge.StageGL,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStageGL",!1),t.Container=function(e,r,i,l,a,s,f){var c="a, b, c, d, style, group, inherit",x;if(x=st(t.Container,arguments,c,this))return x;t.containerCheck||(De("50.5"),De("50.435"),t.containerCheck=!0),this.cjsContainer_constructor(),this.type="Container",this.group=s;var k=this,v=a===!1?{}:t.getStyle(this.type,this.group,f);n(e)&&(e=v.a!=null?v.a:null),n(r)&&(r=v.b!=null?v.b:null),n(i)&&(i=v.c!=null?v.c:null),n(l)&&(l=v.d!=null?v.d:null);var g=b(e,r,i,l);function b(A,T,h,w){var P=[];return n(A)?P=[A,T,h,w]:n(T)?A.x?P=[A.x,A.y,A.width,A.height]:(P[0]=0,P[1]=0,P[2]=A,P[3]=A):n(h)?(P[0]=0,P[1]=0,P[2]=A,P[3]=T):(P[0]=A,P[1]=T,P[2]=h,P[3]=w),n(P[3])&&(P[3]=P[2]),P}n(e)||this.setBounds(g[0],g[1],g[2],g[3]),this.cache=function(A,T,h,w,P,y,C,O,_){if(k.type=="AC"&&j.zdf)return j.zdf.ac("cache",arguments,k),k;var Y="a,b,c,d,scale,options,margin,rtl,willReadFrequently",m;if(m=st(k.cache,arguments,Y))return m;var $=k.getBounds();if(n(h))if(n(A)){if(!n($)){var I=k.borderWidth>0?k.borderWidth/2:0;A=$.x-I,T=$.y-I,h=$.width+I*2,w=$.height+I*2}}else h=A,w=T,A=0,T=0;return k.type=="Triangle"&&(A-=k.borderWidth?k.borderWidth:0,h+=k.borderWidth?k.borderWidth*2:0,T-=k.borderWidth?k.borderWidth:0,w+=k.borderWidth?k.borderWidth*2:0),n(C)&&(C=0),k.cjsContainer_cache(A-C,T-C,h+C*2,w+C*2,P,y,O,_),$&&k.setBounds($.x,$.y,$.width,$.height),k.z_bc=k.canvas=k.cacheCanvas,k},this.uncache=function(){return k.cjsContainer_uncache(),k},this.childrenToBitmap=function(){var A=this.cacheCanvas,T=new t.Bitmap(this.cache().cacheCanvas);return A||this.uncache(),this.removeAllChildren(),T.addTo(this),this};var E=j.zdf||1;Ge&&!Ge.stageTransformable&&E.retina&&(this.localToGlobal=function(A,T){return t.localToGlobal(A,T,this,this.cjsContainer_localToGlobal)},this.globalToLocal=function(A,T){return t.globalToLocal(A,T,this,this.cjsContainer_globalToLocal)},this.localToLocal=function(A,T,h){return t.localToLocal(A,T,h,this)}),this.setBounds=function(A,T,h,w){var P=b(A,T,h,w);return k.cjsContainer_setBounds(P[0],P[1],P[2],P[3]),k},this.getBounds=function(A){return A?k.boundsToGlobal(null,null,null,A):k.cjsContainer_getBounds()},this.disposeAllChildren=function(){for(var A=this.numChildren-1;A>=0;A--){var T=this.getChildAt(A);T.dispose&&T.dispose()}return this},t.displayBase(k),a!==!1&&t.styleTransforms(this,v),this.clone=function(A){if(this.type=="AC"&&j.zdf)return pt&&tt("ZIM asset() - cannot clone lazy-loaded asset - use Frame() assets parameter or loadAssets() method"),j.zdf.ac("clone",arguments,this),this;var T=this.getBounds();return n(T)&&(T={x:null,y:null,width:null,height:null}),this.cloneChildren(this.cloneProps(new t.Container(T.x,T.y,T.width,T.height,a,this.group,f)),A)},this.hasProp=function(A){return!n(this[A])||Object.prototype.hasOwnProperty.call(this,A)}},t.Container.prototype.dispose=function(e){return Ot(this,e),!0},t.Container.prototype.specialColor=function(e,r,i){if(r.type=="GradientColor"){if(!n(r.angle))if(i.width){var l=i.getBounds();if(r.angle+=360*1e5,r.angle%=360,i.type=="Circle"){var a=l.width/2*Math.cos(r.angle*RAD),s=l.width/2*Math.sin(r.angle*RAD);r.x0=-a,r.y0=-s,r.x1=a,r.y1=s}else{var f=r.angle%90,c=l.width*Math.sin(f*RAD),x=c*Math.sin(f*RAD),k=-c*Math.cos(f*RAD),v=l.height*Math.sin(f*RAD),g=l.width+v*Math.cos(f*RAD),b=v*Math.sin(f*RAD),E=l.height*Math.sin(f*RAD),A=-E*Math.cos(f*RAD),T=l.height-E*Math.sin(f*RAD);r.angle>=0&&r.angle<90?(r.x0=l.x+x,r.y0=l.y+k,r.x1=l.x+g,r.y1=l.y+b):r.angle>=90&&r.angle<180?(r.x0=l.x+x,r.y0=l.y+k,r.x1=l.x+A,r.y1=l.y+T):r.angle>=180&&r.angle<270?(r.x0=l.x+g,r.y0=l.y+b,r.x1=l.x+x,r.y1=l.y+k):(r.x0=l.x+A,r.y0=l.y+T,r.x1=l.x+x,r.y1=l.y+k)}}else{e.style=r.colors[0];return}e.linearGradient(r.colors,r.ratios,r.x0,r.y0,r.x1,r.y1)}else if(r.type=="RadialColor"){if(n(r.x0))if(i.width){var l=i.getBounds();r.r0=0,i.type=="Circle"?(r.x0=0,r.y0=0,r.r1=l.width/2):(r.x0=l.x+l.width/2,r.y0=l.y+l.height/2,r.r1=Math.sqrt(Math.pow(l.width/2,2)+Math.pow(l.height/2,2))),r.x1=r.x0,r.y1=r.y0}else{e.style=r.colors[0];return}e.radialGradient(r.colors,r.ratios,r.x0,r.y0,r.r0,r.x1,r.y1,r.r1)}else r.type=="BitmapColor"&&e.bitmap(r.image,r.repetition,r.matrix)};function Ot(e,r){if(e&&t.gD(e),!r&&e&&e.dispose&&e.dispose!==t.Container.prototype.dispose&&e.dispose(null,null,!0),e&&e.addChild&&(e.dispatchEvent("removed"),e.removeAllEventListeners(),e.numChildren))for(var i=e.numChildren-1;i>=0;i--)Ot(e.getChildAt(i));e&&e.parent&&e.parent.removeChild(e)}t.extend(t.Container,Ge.Container,["cache","uncache","setBounds","getBounds","clone","localToLocal","localToGlobal","globalToLocal"],"cjsContainer",!1),Un(t.Container.prototype),t.Shape=function(e,r,i,l,a,s,f,c,x){var k="a, b, c, d, graphics, optimize, style, group, inherit",v;if(v=st(t.Shape,arguments,k,this))return v;De("50.6"),this.cjsShape_constructor(a),this.type="Shape",this.group=c;var g=f===!1?{}:t.getStyle(this.type,this.group,x),b=this;n(e)&&(e=g.a!=null?g.a:null),n(r)&&(r=g.b!=null?g.b:null),n(i)&&(i=g.c!=null?g.c:null),n(l)&&(l=g.d!=null?g.d:null),n(a)&&(a=g.graphics!=null?g.graphics:null),n(s)&&(s=g.optimize!=null?g.optimize:!1);var E=A(e,r,i,l);function A(P,y,C,O){var _=[];return n(P)?_=[P,y,C,O]:n(y)?P.x?_=[P.x,P.y,P.width,P.height]:(_[0]=0,_[1]=0,_[2]=P,_[3]=P):n(C)?(_[0]=0,_[1]=0,_[2]=P,_[3]=y):(_[0]=P,_[1]=y,_[2]=C,_[3]=O),n(_[3])&&(_[3]=_[2]),_}if(n(e)||this.setBounds(E[0],E[1],E[2],E[3]),!s)for(var T=["mt","lt","a","at","bt","ct","qt","cp","c","f","lf","rf","bf","ef","ss","sd","s","ls","rs","bs","es","dr","rr","rc","dc","de","dp","pg","p"],h=0;h<T.length;h++)~function(){var P=h;b[T[P]]=function(){return T[P]=="ct"?b.graphics.curveTo.apply(b.graphics,arguments):b.graphics[T[P]].apply(b.graphics,arguments),b}}();Object.defineProperty(b,"command",{get:function(){return b.graphics.command},set:function(){}}),this.cache=function(P,y,C,O,_,Y,m,$,I){var X="a,b,c,d,scale,options,margin,rtl,willReadFrequently",R;if(R=st(b.cache,arguments,X))return R;var q=b.getBounds();if(n(C))if(n(P)){if(!n(q)){var J=b.borderWidth>0?b.borderWidth/2:0;P=q.x-J,y=q.y-J,C=q.width+J*2,O=q.height+J*2}}else C=P,O=y,P=0,y=0;return n(m)&&(m=0),b.cjsShape_cache(P-m,y-m,C+m*2,O+m*2,_,Y,$,I),b.z_bc=b.canvas=b.cacheCanvas,b},this.setBounds=function(P,y,C,O){var _=A(P,y,C,O);return this.cjsShape_setBounds(_[0],_[1],_[2],_[3]),this},this.getBounds=function(P){return P?b.boundsToGlobal(null,null,null,P):b.cjsShape_getBounds()},f!==!1&&t.styleTransforms(this,g),this.clone=function(P){n(P)&&(P=!0);var y=this.getBounds();n(y)&&(y={x:null,y:null,width:null,height:null});var C=b.cloneProps(new t.Shape(y.x,y.y,y.width,y.height,a,f,c,x));return P?C.graphics=b.graphics.clone():C.graphics=b.graphics,C};var w=j.zdf||1;Ge&&!Ge.stageTransformable&&w.retina&&(this.localToGlobal=function(P,y){return t.localToGlobal(P,y,this,this.cjsShape_localToGlobal)},this.globalToLocal=function(P,y){return t.globalToLocal(P,y,this,this.cjsShape_globalToLocal)},this.localToLocal=function(P,y,C){return t.localToLocal(P,y,C,this)}),this.hasProp=function(P){return!n(this[P])||Object.prototype.hasOwnProperty.call(this,P)},t.displayBase(b),this.dispose=function(){t.gD(this),this.graphics.c(),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.Shape,Ge.Shape,["cache","clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsShape",!1),Un(t.Shape.prototype),t.Bitmap=function(e,r,i,l,a,s,f,c,x){var k="image, width, height, left, top, scale, style, group, inherit",v;if(v=st(t.Bitmap,arguments,k,this))return v;De("50.7"),this.group=c;var g=f===!1?{}:t.getStyle("Bitmap",this.group,x);n(s)&&(s=g.scale!=null?g.scale:1),n(r)&&(r=g.width!=null?g.width:e?e.width:100),n(i)&&(i=g.height!=null?g.height:e?e.height:100),n(l)&&(l=g.left!=null?g.left:0),n(a)&&(a=g.top!=null?g.top:0);var b=!1,E=e;if(!n(e)&&e.uncache){b=!0;var A=e.cacheCanvas,T=e;e.cache(l,a,r,i,s),this.z_bc=e=e.cacheCanvas}this.cjsBitmap_constructor(e),T&&!A&&T.uncache();var h=this;this.type="Bitmap",!n(r)&&!n(i)&&this.setBounds(0,0,r,i),this.drawImageData=function(C,O,_,Y,m,$){if(n(C)&&(C=0),n(O)&&(O=0),n(_)&&(_=0),n(Y)&&(Y=0),n(m)&&(m=r),n($)&&($=i),!h.proxyCanvas){var I=h.proxyCanvas=document.createElement("canvas");I.setAttribute("width",r),I.setAttribute("height",i),h.proxyContext=I.getContext("2d"),e=E=h.image=I}h.proxyContext&&h.proxyContext.putImageData(h.imageData,C,O,_,Y,m,$)},j.zdf&&(j.zdf.canvas.getContext("2d")?this.imageData=j.zdf.canvas.getContext("2d").createImageData(r,i):this.imageData=document.createElement("canvas").getContext("2d").createImageData(r,i),n(e)&&h.drawImageData(),e&&e.match&&e.match(/data:image/i)&&setTimeout(function(){h.stage&&h.stage.update(),setTimeout(function(){h.stage&&h.stage.update()},50)},50)),e&&e.nodeName&&e.nodeName.toLowerCase()!="video"&&(b?h.sourceRect={x:0,y:0,width:r*s,height:i*s}:h.sourceRect={x:l,y:a,width:r,height:i});function w(C,O,_,Y){var m=[];return n(C)?m=[C,O,_,Y]:n(O)?C.x?m=[C.x,C.y,C.width,C.height]:(m[0]=0,m[1]=0,m[2]=C,m[3]=C):n(_)?(m[0]=0,m[1]=0,m[2]=C,m[3]=O):(m[0]=C,m[1]=O,m[2]=_,m[3]=Y),n(m[3])&&(m[3]=m[2]),m}this.setBounds=function(C,O,_,Y){var m=w(C,O,_,Y);return h.cjsBitmap_setBounds(m[0],m[1],m[2],m[3]),h},this.getBounds=function(C){return C?h.boundsToGlobal(null,null,null,C):h.cjsBitmap_getBounds()},this.cache=function(C,O,_,Y,m,$,I,X){var R="a,b,c,d,scale,options,rtl,willReadFrequently",q;if(q=st(h.cache,arguments,R))return q;var J;if(n(_))if(n(C)){if(J=this.getBounds(),!n(J)){var Z=this.borderWidth>0?this.borderWidth/2:0;C=J.x-Z,O=J.y-Z,_=J.width+Z*2,Y=J.height+Z*2}}else _=C,Y=O,C=0,O=0;return J=h.getBounds(),h.cjsBitmap_cache(C,O,_,Y,m,$,I,X),h.setBounds(J.x,J.y,J.width,J.height),h.z_bc=h.canvas=h.cacheCanvas,h},this.clone=function(){var C=this.cloneProps(new t.Bitmap(E,r,i,l,a,s,f,this.group,x));return C.cloned=!0,C.src=h.src,C.file=h.file,C.image=h.image,C.svg=h.svg,C.item=h.item,C};var P=j.zdf||1;Ge&&!Ge.stageTransformable&&P.retina&&(this.localToGlobal=function(C,O){return t.localToGlobal(C,O,this,this.cjsBitmap_localToGlobal)},this.globalToLocal=function(C,O){return t.globalToLocal(C,O,this,this.cjsBitmap_globalToLocal)},this.localToLocal=function(C,O,_){return t.localToLocal(C,O,_,this)}),this.hasProp=function(C){return!n(this[C])||Object.prototype.hasOwnProperty.call(this,C)};var y;this.getColorAt=function(C,O,_){y||(h.cache(null,null,null,null,null,null,null,!0),y=h.cacheCanvas.getContext("2d"),h.uncache());var Y=y.getImageData(C,O,1,1).data;return Y[3]/=255,_?Y:"rgba("+Y[0]+","+Y[1]+","+Y[2]+","+Y[3]+")"},this.keyOut=function(C,O,_){n(C)&&(C="#389b26"),n(O)&&(O=.1),Array.isArray(C)||(C=[C]),Array.isArray(O)||(O=[O]),!n(_)&&!Array.isArray(_)&&(_=[_]);var Y,m,$=[],I=[],X=[];for(Y=0;Y<C.length;Y++)$[Y]=t.convertColor(C[Y],"array"),O[Y]!=null?I[Y]=O[Y]*255:I[Y]=O[0]*255,_&&(_[Y]!=null?(X[Y]=t.convertColor(_[Y],"array"),X[Y][3]*=255):(X[Y]=t.convertColor(_[0],"array"),X[Y][3]*=255));h.cacheCanvas&&h.updateCache(),y||(h.cache(null,null,null,null,null,null,null,!0),y=h.cacheCanvas.getContext("2d"));var R=y.getImageData(l,a,r,i),q=R.data,J=q.length/4;if(_)for(Y=0;Y<J;Y++){var Z=q[Y*4+0],ne=q[Y*4+1],U=q[Y*4+2];for(m=0;m<C.length;m++)Z>$[m][0]-I[m]&&Z<$[m][0]+I[m]&&ne>$[m][1]-I[m]&&ne<$[m][1]+I[m]&&U>$[m][2]-I[m]&&U<$[m][2]+I[m]&&(q[Y*4+0]=X[m][0],q[Y*4+1]=X[m][1],q[Y*4+2]=X[m][2],q[Y*4+3]=X[m][3])}else for(Y=0;Y<J;Y++){var Z=q[Y*4+0],ne=q[Y*4+1],U=q[Y*4+2];for(m=0;m<C.length;m++)Z>$[m][0]-I[m]&&Z<$[m][0]+I[m]&&ne>$[m][1]-I[m]&&ne<$[m][1]+I[m]&&U>$[m][2]-I[m]&&U<$[m][2]+I[m]&&(q[Y*4+3]=0)}return y.putImageData(R,a,l),this},t.displayBase(h),f!==!1&&t.styleTransforms(this,g),this.doDispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.cloned||this.id&&(this.stage&&this.stage.frame?P=this.stage.frame:P=j.zdf,P&&P.assets&&P.assets[this.id]&&delete P.assets[this.id],t.assets[this.id]&&delete t.assets[this.id]),this.parent&&this.parent.removeChild(this)}},t.Bitmap.fromData=function(e,r){var i=100,l=100,a=new Image;a.onload=function(){i=a.naturalWidth,l=a.naturalHeight,n(i)&&(i=a.width),n(l)&&(l=a.height);var s=new t.Bitmap(e,i,l);setTimeout(function(){r(s)},50)},a.src=e},t.extend(t.Bitmap,Ge.Bitmap,["cache","clone","dispose","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsBitmap",!1),t.Bitmap.prototype.dispose=function(){return this.doDispose()},Un(t.Bitmap.prototype),t.Sprite=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y){var C="image, cols, rows, count, offsetX, offsetY, spacingX, spacingY, width, height, animations, json, id, globalControl, spriteSheet, label, frame, style, group, inherit",O;if(O=st(t.Sprite,arguments,C,this))return O;De("50.8"),this.type="Sprite",this.group=P;var _=w===!1?{}:t.getStyle(this.type,this.group,y),Y=this,m;if(n(h)&&(h=_.frame!=null?_.frame:j.zdf),e&&typeof e=="string"&&(e=h.asset(e)),n(g)&&!n(e)){n(r)&&(r=_.cols!=null?_.cols:1),n(i)&&(i=_.rows!=null?_.rows:1),n(l)&&(l=_.count!=null?_.count:r*i),n(a)&&(a=_.offsetX!=null?_.offsetX:0),n(s)&&(s=_.offsetY!=null?_.offsetY:0),n(f)&&(f=_.spacingX!=null?_.spacingX:0),n(c)&&(c=_.spacingY!=null?_.spacingY:0),n(x)&&(x=_.width!=null?_.width:e.width),n(k)&&(k=_.height!=null?_.height:e.height),e.bitmap&&(e=e.bitmap);var $=(x-a+f)/r-f,I=(k-s+c)/i-c,X=[],R=0;e:for(var q=0;q<i;q++)for(var J=0;J<r;J++){if(++R>l)break e;X.push([a+J*($+f),s+q*(I+c),$,I])}u(e,X,v)}else if(A)m=A,v=m.animations;else if(g){var h=Y.stage?Y.stage.frame:j.zdf;typeof g=="string"&&(g=h.asset(g));var Z,ne,U;if(g.frames&&!Array.isArray(g.frames)){Z=[];for(ne in g.frames)U=g.frames[ne].frame,Z.push([U.x,U.y,U.w,U.h]);g.frames=Z}if(g.frames&&!Array.isArray(g.frames[0])){for(Z=[],ne=0;ne<g.frames.length;ne++){var U=g.frames[ne].frame;Z.push([U.x,U.y,U.w,U.h])}g.frames=Z}if(!g.images&&g.meta&&g.meta.image&&(g.images=[g.meta.image]),X=g.frames,v=g.animations,!n(e))u(e,X,v);else{var B=g.images?g.images[0]:null;if(!B||!B.split)m=new Ge.SpriteSheet(g);else{var d=[];t.loop(g.images,function(L){var we=L.split("/").pop();h.asset(we)&&h.asset(we).type!="EmptyAsset"?d.push(h.asset(we)):h.asset(L)&&h.asset(L).type!="EmptyAsset"||h.asset(L).type!="EmptyAsset"?d.push(h.asset(L)):pt&&tt("Sprite() - please preload Sprite in Frame or with loadAssets")}),u(d,X,v)}}}else return;function u(p,L,we){Array.isArray(p)||(p=[p]),t.loop(p,function(N,ue){p[ue]=N.image});var D={images:p,frames:L,animations:we||[]};m=new Ge.SpriteSheet(D)}this.animations=v,this.cjsSprite_constructor(m,T),n(T)||this.stop(),n(b)&&(b=t.makeID()),this.id=b,n(E)&&(E=!0),Y.globalControl=E;var o=0,S;this.parseFrames=function(p,L,we,D){var N=[],ue=Number.MAX_VALUE,fe=0;if(n(p))n(L)&&(L=0),n(we)&&(we=Y.totalFrames-1),K(L,we);else{if(n(Y.animations)||n(Y.animations[p]))return[];var V=Y.animations[p];z(V)}function z(Ae){Array.isArray(Ae)?se(Ae):Ae.constructor=={}.constructor?Oe(Ae):isNaN(Ae)||N.push({f:Math.floor(Ae),s:1})}function se(Ae){K(Ae[0],Ae[1],Ae[3]),Ae[2]&&!n(Y.animations[Ae[2]])&&z(Y.animations[Ae[2]])}function Oe(Ae){if(!n(Ae.frames)){n(Ae.speed)&&(Ae.speed=1);for(var re=0;re<Ae.frames.length;re++)Ae.speed<ue&&(ue=Ae.speed),Ae.speed>fe&&(fe=Ae.speed),N.push({f:Ae.frames[re],s:Ae.speed});Ae.next&&!n(Y.animations[Ae.next])&&z(Y.animations[Ae.next])}}function K(Ae,re,xe){n(xe)&&(xe=1);var ke;if(re>Ae)for(ke=Ae;ke<=re;ke++)te(ke);else for(ke=re;ke<=Ae;ke++)te(Ae-(ke-re));function te(pe){xe<ue&&(ue=xe),xe>fe&&(fe=xe),N.push({f:pe,s:xe})}}if(D)return N;ue=t.constrain(t.decimals(ue),.1),fe=t.constrain(t.decimals(fe),.1);for(var ge=[],Q=ue!=fe,ce,G=0;G<N.length;G++)if(ce=N[G],Q)for(var le=0;le<t.constrain(Math.round(ue<1?ce.s/ue:ce.s),.1);le++)ge.push(ce.f);else ge.push(ce.f);return ge},this.run=function(p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le,Ae,re,xe,ke,te,pe,he,ae,Ee,ie,Se,Le){var Ce="time, label, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startFrame, endFrame, tweek, id, globalControl, pauseOnBlur",ee;if(ee=st(Y.run,arguments,Ce))return ee;var Me=Tt(),_e;n(Ee)&&(Ee=1),n(ie)||(Y.id=ie),n(Se)||(Y.globalControl=Se);var Ye;if(Array.isArray(L)){var je,it;_e=[],Ye=0;for(var Be,qe=0;qe<L.length;qe++){je=L[qe],je.lookup=Y.parseFrames(je.label,je.startFrame,je.endFrame),qe==0&&(Be=je.lookup[0]),delete je.startFrame,delete je.endFrame,je.obj=t.merge(je.obj,{normalizedFrame:je.lookup.length-1}),je.set=t.merge(je.set,{normalizedFrames:{noPick:je.lookup},normalizedFrame:0}),n(je.wait)&&(je.wait=Ye*Ee),it=je.label,delete je.label,_e.push(je),Ye=0;var et=n(je.time)?p:je.time;ae-he>0&&(Ye=et/(ae-he)/2)}if(_e.length==0)return this;_e.length==1?(p=_e[0].time,L=it,ve()):Y.gotoAndStop(Be)}else ve();function ve(){S=Y.parseFrames(L,he,ae),o=0,Y.gotoAndStop(S[o]),he=ae=null,_e={normalizedFrame:S.length-1}}n(p)&&(p=Me=="s"?1:1e3),Y.running&&Y.stopAnimate(Y.id),Y.running=!0,Array.isArray(_e)||(Ye=0,ae-he>0&&(Ye=p/Math.abs(ae-he)/2),S&&S.length>0&&(Ye=p/S.length/2),!n(V)&&n(se)&&(se=Ye*Ee),!n(G)&&n(le)&&(le=Ye*Ee));var Pe=function(){Y.running=!1,Y.stop(),we&&typeof we=="function"&&we(D||Y)};return t.animate({target:Y,obj:_e,time:p,ease:"linear",call:Pe,params:D,wait:N,waitedCall:ue,waitedParams:fe,loop:V,loopCount:z,loopWait:se,loopCall:Oe,loopParams:K,loopWaitCall:ge,loopWaitParams:Q,rewind:G,rewindWait:le,rewindCall:Ae,rewindParams:re,rewindWaitCall:xe,rewindWaitParams:ke,rewindTime:te,rewindEase:pe,override:!1,pauseOnBlur:Le,id:Y.id}),Y.runPaused=!1,Y},this.runPaused=!0,this.pauseRun=function(p){return n(p)&&(p=!0),Y.runPaused=p,Y.globalControl?t.pauseAnimate(p,Y.id):Y.pauseAnimate(p,Y.id),Y},this.stopRun=function(){return Y.runPaused=!0,Y.running=!1,Y.globalControl?t.stopAnimate(Y.id):Y.stopAnimate(Y.id),Y},Object.defineProperty(this,"frame",{get:function(){return this.currentFrame},set:function(p){p=Math.round(p),this.paused?this.gotoAndStop(p):this.gotoAndPlay(p)}}),Object.defineProperty(this,"normalizedFrame",{get:function(){return o},set:function(p){o=Math.round(p),this.gotoAndStop(S[o])}}),Object.defineProperty(this,"normalizedFrames",{get:function(){return S},set:function(p){S=p}}),Object.defineProperty(this,"totalFrames",{get:function(){return m.getNumFrames()},set:function(){tt("zim.Sprite - totalFrames is read only")}}),w!==!1&&t.styleTransforms(this,_),this.clone=function(){var p=this.cloneProps(new t.Sprite(e,r,i,l,a,s,f,c,x,k,v,g,null,E,A,T,h,w,this.group,y));return Y.frame>=0&&p.run({startFrame:Y.frame,endFrame:Y.frame}),p},Ge&&!Ge.stageTransformable&&h.retina&&(this.localToGlobal=function(p,L){return t.localToGlobal(p,L,this,this.cjsSprite_localToGlobal)},this.globalToLocal=function(p,L){return t.globalToLocal(p,L,this,this.cjsSprite_globalToLocal)},this.localToLocal=function(p,L,we){return t.localToLocal(p,L,we,this)}),this.hasProp=function(p){return!n(this[p])||Object.prototype.hasOwnProperty.call(this,p)},t.displayBase(Y);function F(p,L,we,D){var N=[];return n(p)?N=[p,L,we,D]:n(L)?p.x?N=[p.x,p.y,p.width,p.height]:(N[0]=0,N[1]=0,N[2]=p,N[3]=p):n(we)?(N[0]=0,N[1]=0,N[2]=p,N[3]=L):(N[0]=p,N[1]=L,N[2]=we,N[3]=D),n(N[3])&&(N[3]=N[2]),N}this.setBounds=function(p,L,we,D){var N=F(p,L,we,D);return Y.cjsSprite_setBounds(N[0],N[1],N[2],N[3]),Y},this.getBounds=function(p){return p?Y.boundsToGlobal(null,null,null,p):Y.cjsSprite_getBounds()},this.dispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.Sprite,Ge.Sprite,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsSprite",!1),Un(t.Sprite.prototype),t.MovieClip=function(e,r,i,l,a,s,f){var c="mode, startPosition, loop, labels, style, group, inherit",x;if(x=st(t.MovieClip,arguments,c,this))return x;De("50.9"),this.type="MovieClip",this.group=s;var k=a===!1?{}:t.getStyle(this.type,this.group,f);n(e)&&(e=k.mode!=null?k.mode:null),n(r)&&(r=k.startPosition!=null?k.startPosition:null),n(i)&&(i=k.loop!=null?k.loop:null),n(l)&&(l=k.labels!=null?k.labels:null),this.cjsMovieClip_constructor(e,r,i,l),a!==!1&&t.styleTransforms(this,k),this.clone=function(){return this.cloneProps(new t.MovieClip(e,r,i,l,a,this.group,f))},this.hasProp=function(b){return!n(this[b])||Object.prototype.hasOwnProperty.call(this,b)};var v=j.zdf||1;Ge&&!Ge.stageTransformable&&v.retina&&(this.localToGlobal=function(b,E){return t.localToGlobal(b,E,this,this.cjsMovieClip_localToGlobal)},this.globalToLocal=function(b,E){return t.globalToLocal(b,E,this,this.cjsMovieClip_globalToLocal)},this.localToLocal=function(b,E,A){return t.localToLocal(b,E,A,this)}),t.displayBase(this);function g(b,E,A,T){var h=[];return n(b)?h=[b,E,A,T]:n(E)?b.x?h=[b.x,b.y,b.width,b.height]:(h[0]=0,h[1]=0,h[2]=b,h[3]=b):n(A)?(h[0]=0,h[1]=0,h[2]=b,h[3]=E):(h[0]=b,h[1]=E,h[2]=A,h[3]=T),n(h[3])&&(h[3]=h[2]),h}this.setBounds=function(b,E,A,T){var h=g(b,E,A,T);return that.cjsMovieClip_setBounds(h[0],h[1],h[2],h[3]),that},this.getBounds=function(b){return b?that.boundsToGlobal(null,null,null,b):that.cjsMovieClip_getBounds()},this.dispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.MovieClip,Ge.MovieClip,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsMovieClip",!1),Un(t.MovieClip.prototype),t.SVGContainer=function(e,r,i,l,a,s,f,c){var x="svg, splitTypes, geometric, showControls, interactive, style, group, inherit",k;if(k=st(t.SVGContainer,arguments,x,this))return k;De("50.95"),this.group=f;var v=s===!1?{}:t.getStyle("SVGContainer",this.group,c);e&&e.type=="Bitmap"&&(e=e.svg);var g=this,b=new t.Point(0,0),E;function A(){function F(Oe,K){return N(Oe)||D(Oe,K)||L(Oe,K)||p()}function p(){throw new TypeError("Invalid")}function L(Oe,K){if(Oe){if(typeof Oe=="string")return we(Oe,K);var ge=Object.prototype.toString.call(Oe).slice(8,-1);if(ge==="Object"&&Oe.constructor&&(ge=Oe.constructor.name),ge==="Map"||ge==="Set")return Array.from(Oe);if(ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge))return we(Oe,K)}}function we(Oe,K){(K==null||K>Oe.length)&&(K=Oe.length);for(var ge=0,Q=new Array(K);ge<K;ge++)Q[ge]=Oe[ge];return Q}function D(Oe,K){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Oe)))){var ge=[],Q=!0,ce=!1,G=void 0;try{for(var le=Oe[Symbol.iterator](),Ae;!(Q=(Ae=le.next()).done)&&(ge.push(Ae.value),!(K&&ge.length===K));Q=!0);}catch(re){ce=!0,G=re}finally{try{!Q&&le.return!=null&&le.return()}finally{if(ce)throw G}}return ge}}function N(Oe){if(Array.isArray(Oe))return Oe}var ue=Math.PI*2,fe=function(K,ge,Q,ce,G,le,Ae){var re=K.x,xe=K.y;re*=ge,xe*=Q;var ke=ce*re-G*xe,te=G*re+ce*xe;return{x:ke+le,y:te+Ae}},V=function(K,ge){var Q=ge===1.5707963267948966?.551915024494:ge===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(ge/4),ce=Math.cos(K),G=Math.sin(K),le=Math.cos(K+ge),Ae=Math.sin(K+ge);return[{x:ce-G*Q,y:G+ce*Q},{x:le+Ae*Q,y:Ae-le*Q},{x:le,y:Ae}]},z=function(K,ge,Q,ce){var G=K*ce-ge*Q<0?-1:1,le=K*Q+ge*ce;return le>1&&(le=1),le<-1&&(le=-1),G*Math.acos(le)},se=function(K,ge,Q,ce,G,le,Ae,re,xe,ke,te,pe){var he=Math.pow(G,2),ae=Math.pow(le,2),Ee=Math.pow(te,2),ie=Math.pow(pe,2),Se=he*ae-he*ie-ae*Ee;Se<0&&(Se=0),Se/=he*ie+ae*Ee,Se=Math.sqrt(Se)*(Ae===re?-1:1);var Le=Se*G/le*pe,Ce=Se*-le/G*te,ee=ke*Le-xe*Ce+(K+Q)/2,Me=xe*Le+ke*Ce+(ge+ce)/2,_e=(te-Le)/G,Ye=(pe-Ce)/le,je=(-te-Le)/G,it=(-pe-Ce)/le,Be=z(1,0,_e,Ye),qe=z(_e,Ye,je,it);return re===0&&qe>0&&(qe-=ue),re===1&&qe<0&&(qe+=ue),[ee,Me,Be,qe]};return function(K){var ge=K.px,Q=K.py,ce=K.cx,G=K.cy,le=K.rx,Ae=K.ry,re=K.xAxisRotation,xe=re===void 0?0:re,ke=K.largeArcFlag,te=ke===void 0?0:ke,pe=K.sweepFlag,he=pe===void 0?0:pe,ae=[];if(le===0||Ae===0)return[];var Ee=Math.sin(xe*ue/360),ie=Math.cos(xe*ue/360),Se=ie*(ge-ce)/2+Ee*(Q-G)/2,Le=-Ee*(ge-ce)/2+ie*(Q-G)/2;if(Se===0&&Le===0)return[];le=Math.abs(le),Ae=Math.abs(Ae);var Ce=Math.pow(Se,2)/Math.pow(le,2)+Math.pow(Le,2)/Math.pow(Ae,2);Ce>1&&(le*=Math.sqrt(Ce),Ae*=Math.sqrt(Ce));var ee=se(ge,Q,ce,G,le,Ae,te,he,Ee,ie,Se,Le),Me=F(ee,4),_e=Me[0],Ye=Me[1],je=Me[2],it=Me[3],Be=Math.abs(it)/(ue/4);Math.abs(1-Be)<1e-7&&(Be=1);var qe=Math.max(Math.ceil(Be),1);it/=qe;for(var et=0;et<qe;et++)ae.push(V(je,it)),je+=it;return ae.map(function(ve){var Pe=fe(ve[0],le,Ae,ie,Ee,_e,Ye),oe=Pe.x,Fe=Pe.y,Ze=fe(ve[1],le,Ae,ie,Ee,_e,Ye),Xe=Ze.x,We=Ze.y,de=fe(ve[2],le,Ae,ie,Ee,_e,Ye),Ve=de.x,be=de.y;return{x1:oe,y1:Fe,x2:Xe,y2:We,x:Ve,y:be}})}}n(r)&&(r=!1),n(i)&&(i=!0);var T,h;function w(F){t.loop(F,function(p){var L=p.tagName.toLowerCase();if(L=="path"&&S(p),L=="circle"&&y("circle",p),L=="rect"&&y("rect",p),L=="ellipse"&&y("ellipse",p),L=="line"&&y("line",p),L=="polygon"&&y("polygon",p),L=="polyline"&&y("polyline",p),L=="g"){var we=p.getAttribute("style"),D,N,ue,fe,V;if(we){var z=P(we);D=z[0],N=z[1],ue=z[2],fe=z[3],V=z[4]}d=p.getAttribute("transform"),I=p.getAttribute("fill")?p.getAttribute("fill"):n(D)?$:D,R=p.getAttribute("stroke")?p.getAttribute("stroke"):n(N)?X:N,J=p.getAttribute("stroke-width")?p.getAttribute("stroke-width"):n(ue)?q:ue,ne=p.getAttribute("fill-opacity")?p.getAttribute("fill-opacity"):n(fe)?Z:fe,B=p.getAttribute("stroke-opacity")?p.getAttribute("stroke-opacity"):n(V)?U:V}w(p.children),p.tagName.toLowerCase()=="g"&&(I=$,R=X,J=q,ne=Z,B=U,d=null)})}function P(F){var p=F.split(";"),L,we,D,N,ue;return t.loop(p,function(fe){fe=fe.replace(/,/g,"");var V=fe.split(":"),z=V[0].trim().toLowerCase(),se=V[1].trim().toLowerCase().replace("px","");z=="fill"&&(L=se),z=="stroke"&&(we=se),z=="stroke-width"&&(D=se),z=="opacity"&&(N=se,ue=se),z=="fill-opacity"&&(N=se),z=="stroke-opacity"&&(ue=se)}),[L,we,D,N,ue]}function y(F,p){var L,we=o(p),D=we[0],N=we[1],ue=we[2],fe=we[5],V=we[6];if(F=="circle"){var z=Number(p.getAttribute("r").trim()),se=z*.5523;i?L=new t.Circle(Number(p.getAttribute("r")),D,N,ue):L=new t.Blob(D,N,ue,4,z,se,"mirror",null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else if(F=="rect")if(i)L=new t.Rectangle(Number(p.getAttribute("width")),Number(p.getAttribute("height")),D,N,ue,Number(p.getAttribute("rx")));else{var Oe=Number(p.getAttribute("width")),K=Number(p.getAttribute("height")),ge=Number(p.getAttribute("rx")),Q=Number(p.getAttribute("ry"));if(ge&&Q){var ce=ge*.5523,G=Q*.5523;L=new t.Blob(D,N,ue,[[ge,0,0,0,-ce,0,0,0,"free"],[Oe-ge,0,0,0,0,0,ce,0,"free"],[Oe,Q,0,0,0,-G,0,0,"free"],[Oe,K-Q,0,0,0,0,0,G,"free"],[Oe-ge,K,0,0,ce,0,0,0,"free"],[ge,K,0,0,0,0,-ce,0,"free"],[0,K-Q,0,0,0,G,0,0,"free"],[0,Q,0,0,0,0,0,-G,"free"]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else L=new t.Blob(D,N,ue,[[0,0],[Oe,0],[Oe,K],[0,K]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else if(F=="line")L=new t.Squiggle(N,ue,[[Number(p.getAttribute("x1")),Number(p.getAttribute("y1"))],[Number(p.getAttribute("x2")),Number(p.getAttribute("y2"))]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a);else if(F=="polygon"||F=="polyline"){var le=p.getAttribute("points");le=le.replace(/-/g," -"),le=le.replace(/\s+/g," ");var Ae=[];if(le.indexOf(",")!=-1)t.loop(le.split(" "),function(ke){var te=ke.split(",");Ae.push([Number(te[0].trim()),Number(te[1].trim())])});else{var re;t.loop(le.split(" "),function(ke,te){(te+1)%2==0&&Ae.push([re,ke.trim()]),re=ke.trim()})}F=="polygon"?L=new Blob(D,N,ue,Ae):L=new t.Squiggle(N,ue,Ae,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else F=="ellipse"&&(L=new t.Blob(D,N,ue,O(0,0,Number(p.getAttribute("rx")),Number(p.getAttribute("ry"))),null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a));L.loc(fe,V,g);var xe=p.getAttribute("transform");(xe||d)&&C(L,xe||d),a&&(L.type=="Rectangle"||L.type=="Circle")&&L.transform({showReg:!1,visible:l})}function C(F,p){var L=p.split(")");t.loop(L,function(we){if(we!=""){var D=we.trim().split("("),N=D[0].trim().toLowerCase(),ue=D[1].trim().toLowerCase().replace("px","").replace("deg","");if(N=="translate"){var fe=ue.split(",");F.mov(Number(fe[0].trim()),fe[1]?Number(fe[1].trim()):0)}if(N=="scale"){var V=ue.split(",");F.type=="Blob"||F.type=="Squiggle"?V.length==1?F.transformPoints("scale",Number(V[0].trim())):V.length==2&&(F.transformPoints("scaleX",Number(V[0].trim())),F.transformPoints("scaleY",Number(V[1].trim()))):V.length==1?F.sca(Number(V[0].trim())):V.length==2&&F.sca(Number(V[0].trim()),Number(V[1].trim()))}if(N=="rotate"){var z=ue.split(",");z.length==1?z.push(0,0):z.length==2&&z.push(0),F.rot(Number(z[0].trim()),Number(z[1].trim()),Number(z[2].trim()))}N=="skewX"&&(F.skewX=ue),N=="skewY"&&(F.skewY=ue)}})}function O(F,p,L,we){var D=.5522848,N=L*D,ue=we*D,fe=F+L,V=p+we,z=[[F-L,p,0,0,F,V+ue-we,F,p-ue,"mirror"],[F,p-we,0,0,F-N,p,fe+N-L,p,"mirror"],[fe,p,0,0,F,p-ue,F+N-N,V+ue-we,"mirror"],[F,V,0,0,fe-L+N,p,F-N,p,"mirror"]];return z}if(!n(e)){if(e.replace&&(e=e.replace(/style\s?=[^"]*"[^"]*"/ig,"")),n(e.draggable))e.getAttribute||(T=new DOMParser,e=T.parseFromString(e,"image/svg+xml").documentElement),h=this.svg=e;else{T=new DOMParser,e=e.innerHTML?T.parseFromString(e.innerHTML,"text/xml"):e;var _=e.getElementsByTagName("svg");h=this.svg=_?e.getElementsByTagName("svg")[0]:null}var Y,m;if(n(h)||(Y=h.getAttribute("width"),m=h.getAttribute("height")),Y&&(Y=Number(Y.trim())),m&&(m=Number(m.trim())),this.zimContainer_constructor(Y,m),this.type="SVGContainer",n(h))return;var $=t.black,I=t.black,X=t.black,R=t.black,q=2,J=2,Z=1,ne=1,U=1,B=1,d,u=e.getElementsByTagName("svg");u.length==0&&(u=[e]),w(u)}function o(F){var p,L,we,D,N,ue=F.getAttribute("style");if(ue){var fe=P(ue);p=fe[0],L=fe[1],we=fe[2],D=fe[3],N=fe[4]}p=F.getAttribute("fill")?F.getAttribute("fill"):n(p)?I:p,L=F.getAttribute("stroke")?F.getAttribute("stroke"):n(L)?R:L,we=F.getAttribute("stroke-width")?F.getAttribute("stroke-width"):n(we)?J:we,D=F.getAttribute("fill-opacity")?F.getAttribute("fill-opacity"):n(D)?ne:D,N=F.getAttribute("stroke-opacity")?F.getAttribute("stroke-opacity"):n(N)?B:N;var V=F.getAttribute("x")?F.getAttribute("x"):0;V=F.getAttribute("cx")?F.getAttribute("cx"):V;var z=F.getAttribute("y")?F.getAttribute("y"):0;return z=F.getAttribute("cy")?F.getAttribute("cy"):z,!n(D)&&!n(p)&&(p=t.convertColor(p,"rgba",Number(D))),!n(N)&&!n(L)&&(L=t.convertColor(L,"rgba",Number(N))),[p,L,Number(we),Number(D),Number(N),Number(V),Number(z)]}function S(F,p){n(p)&&(p=!0);var L=["M","m","L","l","H","h","V","v","C","c","S","s","Q","q","T","t","A","a","z","Z"],we=["m","l","h","v","c","s","q","t","a","z"],D=new t.Point(0,0),N;if(n(F.getAttribute)?N=F:N=F.getAttribute("d"),N=N.replace(/,/g," "),N=N.replace(/([a-zA-Z])/g," $1 "),N=N.replace(/-/g," -"),N=N.replace(/\s+/g," "),N=N.replace(/\.(\d*)\./g,".$1 ."),p)var ue=o(F),fe=ue[0],V=ue[1],z=ue[2];var se,Oe,K=[],ge=[0,0],Q=new t.Point(0,0),ce=new t.Point(0,0,0,0),G=new t.Point(0,0,0,0,0,0),le=new t.Point(0,0,0,0,0,0,0),Ae=N.split(" "),re=Ae.slice(1,Ae.length),xe=[],ke=!1,te,pe,he=!1,ae,Ee="squiggle",ie=null;t.loop(re,function(Le,Ce){if(Ce==0&&(b.x=0,b.y=0,ge=[0,0],te="",pe=""),L.indexOf(Le)==-1){ae=="lxo"&&(ae="lx",xe.push("l"),ke=!0),ae=="lyo"&&(ae="ly",ke=!0),ae=="Lxo"&&(ae="Lx",xe.push("L"),ke=!0),ae=="Lyo"&&(ae="Ly",ke=!0),Oe=Number(Le),Oe=Math.round(Oe*100)/100,ae=="X"?(b.x=Oe,ae="Y"):ae=="Y"?(b.y=Oe,ae="Lxo",K.push([b.x,b.y])):ae=="x"?(b.x=b.x+Oe,ae="y"):ae=="y"&&(b.y=b.y+Oe,ae="lxo",K.push([b.x,b.y])),ae=="H"||ae=="h"?(D.x=K[K.length-1][0],D.y=K[K.length-1][1],D.x=D.x+(ae=="h"?Oe:Oe-b.x),K.push([D.x,D.y]),ae="Lx"):(ae=="V"||ae=="v")&&(D.x=K[K.length-1][0],D.y=K[K.length-1][1],D.y=D.y+(ae=="v"?Oe:Oe-b.y),K.push([D.x,D.y]),ae="lx"),ae=="Lx"?(Q.x=Oe,ae="Ly"):ae=="Ly"?(Q.y=Oe,D.x=Q.x,D.y=Q.y,K.push([D.x,D.y]),ae="Lx"):ae=="lx"?(xe.length>0&&(D.x!=0&&D.y!=0?(b.x=D.x,b.y=D.y):(b.x=D.x+b.x,b.y=D.y+b.y)),Q.x=b.x+Oe,ke?ae="lyo":ae="ly"):ae=="ly"&&(Q.y=b.y+Oe,D.x=Q.x,D.y=Q.y,K.push([D.x,D.y]),ae="lx");var ee;if(ae=="qx"||ae=="Qx"?(K.length>0?(b.x=K[K.length-1][0],b.y=K[K.length-1][1]):(b.x=0,b.y=0),ce.x=ae=="qx"?b.x+Oe:Oe,ae=ae=="qx"?"qy":"Qy"):ae=="qy"||ae=="Qy"?(ce.y=ae=="qy"?b.y+Oe:Oe,ae=ae=="qy"?"qz":"Qz",he&&(he=!1,ee=K[K.length-1],ee[6]=-ee[4],ee[7]=-ee[5],ee[8]="mirror",D.x=ce.x,D.y=ce.y,K[K.length]=[D.x,D.y,0,0,-ee[6],ee[7],0,0,"free"],ae=ae=="qy"?"qx":"Qx")):ae=="qz"||ae=="Qz"?(ce.z=ae=="qz"?b.x+Oe:Oe,ae=ae=="qz"?"qq":"Qq"):(ae=="qq"||ae=="Qq")&&(ce.w=ae=="qq"?b.y+Oe:Oe,ee=K[K.length-1],D.x=ee[0],D.y=ee[1],K.length==1?(ee[2]=0,ee[3]=0,ee[4]=0,ee[5]=0,ee[6]=2/3*(ce.x-D.x),ee[7]=2/3*(ce.y-D.y),ee[8]="free"):K[K.length]=[D.x,D.y,0,0,0,0,2/3*(ce.x-D.x),2/3*(ce.y-D.y),"free"],D.x=ce.z,D.y=ce.w,K[K.length]=[D.x,D.y,0,0,2/3*(ce.x-D.x),2/3*(ce.y-D.y),0,0,"free"],ae=ae=="qq"?"qx":"Qx"),ae=="cx"||ae=="Cx")K.length>0?(b.x=K[K.length-1][0],b.y=K[K.length-1][1]):(b.x=0,b.y=0),G.x=ae=="cx"?b.x+Oe:Oe,ae=ae=="cx"?"cy":"Cy";else if(ae=="cy"||ae=="Cy")G.y=ae=="cy"?b.y+Oe:Oe,ae=ae=="cy"?"cz":"Cz";else if(ae=="cz"||ae=="Cz")G.z=ae=="cz"?b.x+Oe:Oe,ae=ae=="cz"?"cq":"Cq";else if(ae=="cq"||ae=="Cq")G.q=ae=="cq"?b.y+Oe:Oe,ae=ae=="cq"?"cr":"Cr",he&&(te=="s"?pe="s":pe="S",ee=K[K.length-1],ee[2]=0,ee[3]=0,n(ee[4])&&(ee[4]=0),n(ee[5])&&(ee[5]=0),ee[6]=-ee[4],ee[7]=-ee[5],ee[8]="mirror",D.x=G.z,D.y=G.q,K[K.length]=[D.x,D.y,0,0,G.x-D.x,G.y-D.y,0,0,"free"],ae=ae=="cr"?"cx":"Cx");else if(ae=="cr"||ae=="Cr")G.r=ae=="cr"?b.x+Oe:Oe,ae=ae=="cr"?"cs":"Cs";else if(ae=="cs"||ae=="Cs")G.s=ae=="cs"?b.y+Oe:Oe,ee=K[K.length-1],K.length==1&&(ee[2]=0,ee[3]=0,ee[4]=0,ee[5]=0),ee[6]=G.x-ee[0],ee[7]=G.y-ee[1],ee[8]="free",D.x=G.r,D.y=G.s,K[K.length]=[D.x,D.y,0,0,G.z-D.x,G.q-D.y,0,0,"free"],ae=ae=="cs"?"cx":"Cx";else if(ae=="ax"||ae=="Ax")K.length>0?(b.x=K[K.length-1][0],b.y=K[K.length-1][1]):(b.x=0,b.y=0),le.x=Oe,ae=ae=="ax"?"ay":"Ay";else if(ae=="ay"||ae=="Ay")le.y=Oe,ae=ae=="ay"?"az":"Az";else if(ae=="az"||ae=="Az")le.z=Oe,ae=ae=="az"?"aq":"Aq";else if(ae=="aq"||ae=="Aq")le.q=Oe,ae=ae=="aq"?"ar":"Ar";else if(ae=="ar"||ae=="Ar")le.r=Oe,ae=ae=="ar"?"as":"As";else if(ae=="as"||ae=="As")le.s=ae=="as"?b.x+Oe:Oe,ae=ae=="as"?"at":"At";else if(ae=="at"||ae=="At"){le.t=ae=="at"?b.y+Oe:Oe,E||(E=A());var Me=E({px:b.x,py:b.y,cx:le.s,cy:le.t,rx:le.x,ry:le.y,xAxisRotation:le.z,largeArcFlag:le.q,sweepFlag:le.r});t.loop(Me,function(_e,Ye){ee=K[K.length-1],K.length==1&&(ee[2]=0,ee[3]=0,ee[4]=0,ee[5]=0),Ye==0&&K.length==1?(ee[6]=_e.x1-D.x-b.x,ee[7]=_e.y1-D.y-b.y):(ee[6]=_e.x1-D.x,ee[7]=_e.y1-D.y),ee[8]="free",D.x=_e.x,D.y=_e.y,K[K.length]=[D.x,D.y,0,0,_e.x2-D.x,_e.y2-D.y,0,0,"free"]}),ae=ae=="at"?"ax":"Ax"}}else xe.push(Le),Le!="s"&&(he=!1),xe.length>1&&(Le=="M"||Le=="m")&&(Se(xe),Le=="M"?(b.x=0,b.y=0):(b.x=K[K.length-1][0],b.y=K[K.length-1][1]),K=[],xe=[],xe.push(Le)),Le=="M"?ae="X":Le=="m"?ae="x":Le=="L"?(ae="Lx",r&&ie&&ie!="l"&&Se(xe),ie="l"):Le=="l"?(ae="lx",r&&ie&&ie!="l"&&Se(xe),ie="l"):Le=="H"?(ae="H",r&&ie&&ie!="l"&&Se(xe),ie="l"):Le=="h"?(ae="h",r&&ie&&ie!="l"&&Se(xe),ie="l"):Le=="V"?(ae="V",r&&ie&&ie!="l"&&Se(xe),ie="l"):Le=="v"?(ae="v",r&&ie&&ie!="l"&&Se(xe),ie="l"):Le=="C"?(ae="Cx",r&&ie&&ie!="c"&&Se(xe),ie="c"):Le=="c"?(ae="cx",r&&ie&&ie!="c"&&Se(xe),ie="c"):Le=="S"?(he=!0,ae="Cx",r&&ie&&ie!="c"&&Se(xe),ie="c"):Le=="s"?(he=!0,ae="cx",r&&ie&&ie!="c"&&Se(xe),ie="c"):Le=="Q"?(ae="Qx",r&&ie&&ie!="q"&&Se(xe),ie="q"):Le=="q"?(ae="qx",r&&ie&&ie!="q"&&Se(xe),ie="q"):Le=="T"?(he=!0,ae="Qx",r&&ie&&ie!="q"&&Se(xe),ie="q"):Le=="t"?(he=!0,ae="qx",r&&ie&&ie!="q"&&Se(xe),ie="q"):Le=="A"?(ae="Ax",r&&ie&&ie!="a"&&Se(),ie="a"):Le=="a"?(ae="ax",r&&ie&&ie!="a"&&Se(),ie="a"):(Le=="z"||Le=="Z")&&(Ee="blob")});function Se(){te=xe[xe.length-1],K.length>=2&&(te=="z"||te=="Z")&&(Ee="blob"),Ee=="squiggle"?se=new t.Squiggle(V,z,K,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a):se=new t.Blob(fe,V,z,K,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a),se.loc(0,0,g),te=xe[xe.length-1],pe=xe[xe.length-2],we.indexOf(te)>=0?(ge[0]=K[K.length-1][0],ge[1]=K[K.length-1][1],b.x=K[K.length-1][0],b.y=K[K.length-1][1],K=[],K.push([ge[0],ge[1]])):(ge=[0,0],K=[[0,0]]),xe=[],te!="z"&&te!="Z"&&xe.push(te),D.x=0,D.y=0;var Le=F.getAttribute("transform");(Le||d)&&C(se,Le||d)}return p&&Se(),K}g.processPath=function(F){return S(F,!1)},s!==!1&&t.styleTransforms(this,v),this.clone=function(){return g.cloneProps(new t.SVGContainer(e,r,i,l,a,s,this.group,c))}},t.extend(t.SVGContainer,t.Container,"clone","zimContainer",!1),t.CustomShape=function(e,r,i,l){t.zimCustomShapeCheck||(De("50.97"),t.zimCustomShapeCheck=!0),this.zimContainer_constructor(e,r,i,l,!1);var a=this;this.mouseChildren=!1,a._dashedOffset=5,Object.defineProperty(a,"color",{get:function(){return a._color},set:function(s){n(s)&&(s="black"),a._color=s,s&&s.type?a.specialColor(a.colorCommand,s,a):a.colorCommand.style=s}}),this.setColorRange=function(s,f){return n(f)?(a.startColor=a.color,a.endColor=s):n(s)?(a.startColor=a.color,a.endColor=f):(a.startColor=s,a.endColor=f),a},a._colorRange=0,Object.defineProperty(a,"colorRange",{get:function(){return a._colorRange},set:function(s){a._colorRange=s,!n(a.startColor)&&!n(a.endColor)&&(a.color=t.colorRange(a.startColor,a.endColor,s))}}),Object.defineProperty(a,"borderColor",{get:function(){return a._borderColor},set:function(s){a._borderColor=s,s&&!a.borderWidth&&(a.borderWidth=1),a.borderColorCommand?s&&s.type?a.specialColor(a.borderColorCommand,s,a):a.borderColorCommand.style=s:a.drawShape()}}),Object.defineProperty(a,"borderWidth",{get:function(){return a._borderWidth},set:function(s){s>0||(s=0),a._borderWidth=s,!a.borderWidthCommand||a._borderWidth==0?(a.borderWidthCommand=null,a.drawShape()):(a.borderWidthCommand.width=a._borderWidth,a._dashed&&(a.borderDashedCommand.segments=a._dashed,a.borderDashedCommand.offset=a._dashedOffset))}}),Object.defineProperty(a,"thickness",{get:function(){return a._thickness},set:function(s){s>0||(s=0),a._thickness=s,!a.thicknessCommand||a._thickness==0?a.drawShape():(a.thicknessCommand.width=a._thickness,a._dashed&&(a.dashedCommand.segments=a._dashed,a.dashedCommand.offset=a._dashedOffset))}}),Object.defineProperty(a,"dashed",{get:function(){return a._dashed},set:function(s){a._dashed=s,s&&!Array.isArray(a._dashed)&&(a.dashed=[10,10]);var f;if(a.type=="Squiggle"||a.type=="Line"){if(!a.thicknessCommand||a._thickness==0)return;f=a.dashedCommand}else{if(!a.borderWidthCommand||a._borderWidth==0)return;f=a.borderDashedCommand}f?a._dashed?(f.segments=a._dashed,f.offset=a._dashedOffset):(f.segments=null,f.offset=null):a.drawShape()}}),Object.defineProperty(a,"dashedOffset",{get:function(){return a._dashedOffset},set:function(s){isNaN(s)&&(s=5),a._dashedOffset=s;var f;if(a.type=="Squiggle"||a.type=="Line"){if(!a.thicknessCommand||a._thickness==0)return;f=a.dashedCommand}else{if(!a.borderWidthCommand||a._borderWidth==0)return;f=a.borderDashedCommand}f?a._dashed?(f.segments=a._dashed,f.offset=a._dashedOffset):(f.segments=null,f.offset=null):a.drawShape()}}),Object.defineProperty(a,"corner",{get:function(){return a._corner},set:function(s){a._corner=s,a.drawShape()}}),this.linearGradient=function(s,f,c,x,k,v){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(s,f,c,x,k,v),this},this.radialGradient=function(s,f,c,x,k,v,g,b){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(s,f,c,x,k,v,g,b),this},this.cloneAll=function(s,f,c,x){var k=this.getBounds();n(k)&&(k={x:null,y:null,width:null,height:null});var v=this.cloneChildren(this.cloneProps(new t.Container(k.x,k.y,k.width,k.height,f,c,x)),s);return v.mouseChildren=!1,v.type=this.type,v}},t.extend(t.CustomShape,t.Container,null,"zimContainer",!1),t.Circle=function(e,r,i,l,a,s,f,c,x,k,v){var g="radius, color, borderColor, borderWidth, dashed, percent, percentClose, strokeObj, style, group, inherit",b;if(b=st(t.Circle,arguments,g,this))return b;De("51"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Circle",this.group=k;var E=x===!1?{}:t.getStyle(this.type,this.group,v);n(e)&&(e=E.radius!=null?E.radius:50),n(a)&&(a=E.dashed!=null?E.dashed:!1),n(i)&&(i=E.borderColor!=null?E.borderColor:null),n(l)&&(l=E.borderWidth!=null?E.borderWidth:null),i<0||l<0?i=l=null:i!=null&&l==null&&(l=1),n(r)&&(r=E.color!=null?E.color:l>0?"rgba(0,0,0,0)":t.black),n(s)&&(s=E.percent!=null?E.percent:100),n(f)&&(f=E.percentClose!=null?E.percentClose:!0),n(c)&&(c=E.strokeObj!=null?E.strokeObj:{});var A=T(e,r,i,l,s);this.veeObj={radius:A[0],color:A[1],borderColor:A[2],borderWidth:A[3],percent:A[4]};function T(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),s=t.Pick.choose(s);var h=this;h._radius=e,h._color=r,h._borderColor=i,h._borderWidth=l,h._dashed=a,h._dashed&&!Array.isArray(h._dashed)&&(h._dashed=[10,10]);var w=this.shape=new Ge.Shape;this.addChild(w);var P=w.graphics;h.drawShape=function(){P.c(),h.colorCommand=P.f(h._color).command,h._color&&h._color.type&&h.specialColor(h.colorCommand,h._color,h),(n(h._borderWidth)||h._borderWidth>0)&&(!n(h._borderColor)||!n(h._borderWidth))&&(n(h._borderColor)&&(h._borderColor=t.black),h.borderColorCommand=P.s(h._borderColor).command,h._borderColor&&h._borderColor.type&&h.specialColor(h.borderColorCommand,h._borderColor,h),h.borderWidthCommand=P.ss(h._borderWidth,c.caps,c.joints,c.miterLimit,c.ignoreScale).command,h._dashed&&(h.borderDashedCommand=P.sd(Array.isArray(h._dashed)?h._dashed:[10,10],h._dashedOffset).command));var y=h._radius*2;if(typeof s=="number"&&s>=0&&s<100){var C=360*s/100/2;P.arc(0,0,h._radius,(-C-90)*Math.PI/180,(C-90)*Math.PI/180,!1),f&&P.cp(),y=h._radius-Math.cos(C*Math.PI/180)*h._radius}else P.dc(0,0,h._radius);h.setBounds(-h._radius,-h._radius,h._radius*2,y)},h.drawShape(),r.type&&(h.color=r),Object.defineProperty(h,"radius",{get:function(){return h._radius},set:function(y){h._radius=y,h.drawShape()}}),Object.defineProperty(h,"percentage",{get:function(){return s},set:function(y){s=y,h.drawShape()}}),Object.defineProperty(h,"percentClose",{get:function(){return f},set:function(y){f=y,h.drawShape()}}),x!==!1&&t.styleTransforms(this,E),this.clone=function(y){var C=h.cloneProps(new t.Circle(y||!t.isPick(A[0])?h.radius:A[0],y||!t.isPick(A[1])?h.color:A[1],y||!t.isPick(A[2])?h.borderColor:A[2],y||!t.isPick(A[3])?h.borderWidth:A[3],h.dashed,y||!t.isPick(A[4])?s:A[4],f,c,x,this.group,v));return h.linearGradientParams&&C.linearGradient.apply(C,h.linearGradientParams),h.radialGradientParams&&C.radialGradient.apply(C,h.radialGradientParams),C}},t.extend(t.Circle,t.CustomShape,"clone","zimCustomShape",!1),t.Rectangle=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="width, height, color, borderColor, borderWidth, corner, dashed, strokeObj, scaleDimensions, style, group, inherit",E;if(E=st(t.Rectangle,arguments,b,this))return E;De("52"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Rectangle",this.group=v;var A=k===!1?v!=null?t.getStyle(null,null,g,this.group):{}:t.getStyle(this.type,this.group,g);n(e)&&(e=A.width!=null?A.width:null),n(r)&&(r=A.height!=null?A.height:n(e)?100:e),n(e)&&(e=r),n(s)&&(s=A.corner!=null?A.corner:0),n(f)&&(f=A.dashed!=null?A.dashed:!1),n(l)&&(l=A.borderColor!=null?A.borderColor:null),n(a)&&(a=A.borderWidth!=null?A.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(i)&&(i=A.color!=null?A.color:a>0?"rgba(0,0,0,0)":t.black),n(c)&&(c=A.strokeObj!=null?A.strokeObj:{}),n(x)&&(x=A.scaleDimensions!=null?A.scaleDimensions:!0);var T=h(e,r,i,l,a);this.veeObj={width:T[0],height:T[1],color:T[2],borderColor:T[3],borderWidth:T[4]};function h(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),a=t.Pick.choose(a);var w=this;w._color=i,w._borderColor=l,w._borderWidth=a,w._dashed=f,w._dashed&&!Array.isArray(w._dashed)&&(w._dashed=[10,10]),w._corner=s,w.scaleDimensions=x,w.setWidth=function(C){e=C},w.setHeight=function(C){r=C};var P=this.shape=new Ge.Shape;this.addChild(P);var y=P.graphics;w.drawShape=function(){if(y.c(),w.colorCommand=y.f(w._color).command,i&&i.type&&w.specialColor(w.colorCommand,i,w),(n(w._borderWidth)||w._borderWidth>0)&&(!n(w._borderColor)||!n(w._borderWidth))&&(n(w._borderColor)&&(w._borderColor=t.black),w.borderColorCommand=y.s(w._borderColor).command,w._borderColor&&w._borderColor.type&&w.specialColor(w.borderColorCommand,w._borderColor,w),w.borderWidthCommand=y.ss(w._borderWidth,c.caps,c.joints,c.miterLimit,c.ignoreScale).command,w._dashed&&(w.borderDashedCommand=y.sd(Array.isArray(w._dashed)?w._dashed:[10,10],w._dashedOffset).command)),Array.isArray(w._corner)){var C=w._corner;Array.isArray(C)&&C.length==2&&(C=[C,C,C,C]);for(var O=[],_=!1,Y=0;Y<C.length;Y++)Array.isArray(C[Y])?(_=!0,O.push(C[Y])):O.push([C[Y],C[Y]]);C=O,_?y.mt(0,C[0][1]).curveTo(0,0,C[0][0],0).lt(e-C[1][0],0).curveTo(e,0,e,C[1][1]).lt(e,r-C[2][1]).curveTo(e,r,e-C[2][0],r).lt(C[3][0],r).curveTo(0,r,0,r-C[3][1]).cp():y.rc(0,0,e,r,w._corner[0],w._corner[1],w._corner[2],w._corner[3])}else w._corner>0?y.rr(0,0,e,r,w._corner):y.r(0,0,e,r);w.setBounds(0,0,e,r),i.type&&(w.color=i)},w.drawShape(),(k!==!1||v!=null)&&t.styleTransforms(this,A),this.clone=function(C,O){var _=n(O)?k:O,Y=w.cloneProps(new t.Rectangle(C||!t.isPick(T[0])?e:T[0],C||!t.isPick(T[1])?r:T[1],C||!t.isPick(T[2])?w.color:T[2],C||!t.isPick(T[3])?w.borderColor:T[3],C||!t.isPick(T[4])?w.borderWidth:T[4],s,w._dashed,c,w.scaleDimensions,_,this.group,g));return Y}},t.extend(t.Rectangle,t.CustomShape,"clone","zimCustomShape",!1),t.Triangle=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E){var A="a, b, c, color, borderColor, borderWidth, corner, center, adjust, dashed, strokeObj, style, group, inherit",T;if(T=st(t.Triangle,arguments,A,this))return T;De("53"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Triangle",this.group=b;var h=g===!1?{}:t.getStyle(this.type,this.group,E);n(e)&&(e=h.a!=null?h.a:100),n(r)&&(r=h.b!=null?h.b:e),n(i)&&(i=h.c!=null?h.c:e),r==-1&&(r=Math.sqrt(Math.pow(e,2)+Math.pow(i,2))),i==-1&&(i=Math.sqrt(Math.pow(e,2)+Math.pow(r,2))),n(f)&&(f=h.corner!=null?h.corner:0),n(c)&&(c=h.center!=null?h.center:!0),n(x)&&(x=h.adjust!=null?h.adjust:0),n(a)&&(a=h.borderColor!=null?h.borderColor:null),n(s)&&(s=h.borderWidth!=null?h.borderWidth:null),a<0||s<0?a=s=null:a!=null&&s==null&&(s=1),n(l)&&(l=h.color!=null?h.color:s>0?"rgba(0,0,0,0)":t.black),n(x)&&(x=h.adjust!=null?h.adjust:0),n(v)&&(v=h.strokeObj!=null?h.strokeObj:{});var w=P(e,r,i,l,a,s);this.veeObj={a:w[0],b:w[1],c:w[2],color:w[3],borderColor:w[4],borderWidth:w[5]};function P(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),this.a=e,this.b=r,this.c=i,l=t.Pick.choose(l),a=t.Pick.choose(a),s=t.Pick.choose(s);var y=this;y._color=l,y._borderColor=a,y._borderWidth=s,y._dashed=k,y._dashed&&!Array.isArray(y._dashed)&&(y._dashed=[10,10]),y._corner=f;var C=[e,r,i];C.sort(function(X,R){return R-X});var O=C[0],_=C[1],Y=C[2],m=[C.indexOf(e),C.indexOf(r),C.indexOf(i)];if(O>_+Y){tt("zim display - Triangle(): invalid triangle lengths");return}var $=this.shape=new Ge.Shape;this.adjusted=x,this.addChild($);var I=$.graphics;y.drawShape=function(){var X=[];Array.isArray(y._corner)?X=y._corner:X.push(y._corner,y._corner,y._corner);for(var R=0;R<3;R++)(X[R]<0||typeof X[R]!="number")&&(X[R]=0);I.c(),y.colorCommand=I.f(y._color).command,y._color&&y._color.type&&y.specialColor(y.colorCommand,y._color,y),(n(y._borderWidth)||y._borderWidth>0)&&(!n(y._borderColor)||!n(y._borderWidth))&&(n(y._borderColor)&&(y._borderColor=t.black),y.borderColorCommand=I.s(y._borderColor).command,y._borderColor&&y._borderColor.type&&y.specialColor(y.borderColorCommand,y._borderColor,y),y.borderWidthCommand=I.ss(y._borderWidth,v.caps,v.joints,v.miterLimit,v.ignoreScale).command,y._dashed&&(y.borderDashedCommand=I.sd(Array.isArray(y._dashed)?y._dashed:[10,10],y._dashedOffset).command)),y.one={x:0,y:0},y.two={x:e,y:0};var q=Math.acos((Math.pow(_,2)+Math.pow(Y,2)-Math.pow(O,2))/(2*_*Y))*180/Math.PI,J=Math.asin(_*Math.sin(q*Math.PI/180)/O)*180/Math.PI,Z=180-q-J,ne=[q,J,Z];y.angles=[ne[m[1]],ne[m[2]],ne[m[0]]];var U=y.angles[1],B=Math.cos(U*Math.PI/180)*r,d=Math.sin(U*Math.PI/180)*r,u=Math.max(e,e-B),o=d;y.setBounds(0,x,u,o),$.y=o,y.three={x:e-B,y:0-d};var S=e*X[0]/(X[0]+X[1]||1);I.mt(S,0).at(e,0,e-B,0-d,X[1]).at(e-B,0-d,0,0,X[2]).at(0,0,e,0,X[0]).lt(S,0),I.cp(),c&&(y.regX=u/2,y.regY=o/2),x&&(y.shape.y+=x)},y.drawShape(),l.type&&(y.color=l),g!==!1&&t.styleTransforms(this,h),this.clone=function(X,R){var q=n(R)?g:R,J=y.cloneProps(new t.Triangle(X||!t.isPick(w[0])?e:w[0],X||!t.isPick(w[1])?r:w[1],X||!t.isPick(w[2])?i:w[2],X||!t.isPick(w[3])?y.color:w[3],X||!t.isPick(w[4])?y.borderColor:w[4],X||!t.isPick(w[5])?y.borderWidth:w[5],f,c,x,k,v,q,this.group,E));return y.linearGradientParams&&J.linearGradient.apply(J,y.linearGradientParams),y.radialGradientParams&&J.radialGradient.apply(J,y.radialGradientParams),J}},t.extend(t.Triangle,t.CustomShape,"clone","zimCustomShape"),t.Poly=function(e,r,i,l,a,s,f,c,x,k,v){var g="radius, sides, pointSize, color, borderColor, borderWidth, dashed, strokeObj, style, group, inherit",b;if(b=st(t.Poly,arguments,g,this))return b;De("53.1"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Poly",this.group=k;var E=x===!1?{}:t.getStyle(this.type,this.group,v);n(e)&&(e=E.radius!=null?E.radius:50),n(r)&&(r=E.sides!=null?E.sides:5),n(i)&&(i=E.pointSize!=null?E.pointSize:0),n(f)&&(f=E.dashed!=null?E.dashed:!1),n(a)&&(a=E.borderColor!=null?E.borderColor:null),n(s)&&(s=E.borderWidth!=null?E.borderWidth:null),a<0||s<0?a=s=null:a!=null&&s==null&&(s=1),n(l)&&(l=E.color!=null?E.color:s>0?"rgba(0,0,0,0)":t.black),n(c)&&(c=E.strokeObj!=null?E.strokeObj:{});var A=T(e,r,i,l,a,s);this.veeObj={radius:A[0],sides:A[1],pointSize:A[2],color:A[3],borderColor:A[4],borderWidth:A[5]};function T(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),a=t.Pick.choose(a),s=t.Pick.choose(s);var h=this;h._radius=e,h._color=l,h._sides=r,h._pointSize=i,h._borderColor=a,h._borderWidth=s,h._dashed=f,h._dashed&&!Array.isArray(h._dashed)&&(h._dashed=[10,10]);var w=this.shape=new Ge.Shape;this.addChild(w),w.rotation=-90;var P=w.graphics;h.drawShape=function(){P.c(),h.colorCommand=P.f(h._color).command,h._color&&h._color.type&&h.specialColor(h.colorCommand,h._color,h),(n(h._borderWidth)||h._borderWidth>0)&&(!n(h._borderColor)||!n(h._borderWidth))&&(n(h._borderColor)&&(h._borderColor=t.black),h.borderColorCommand=P.s(h._borderColor).command,h._borderColor&&h._borderColor.type&&h.specialColor(h.borderColorCommand,h._borderColor,h),h.borderWidthCommand=P.ss(h._borderWidth,c.caps,c.joints,c.miterLimit,c.ignoreScale).command,h._dashed&&(h.borderDashedCommand=P.sd(Array.isArray(h._dashed)?h._dashed:[10,10],h._dashedOffset).command)),P.dp(0,0,h._radius,h._sides,h._pointSize),h.setBounds(-h._radius,-h._radius,h._radius*2,h._radius*2)},h.drawShape(),l.type&&(h.color=l),Object.defineProperty(h,"radius",{get:function(){return h._radius},set:function(y){h._radius=y,h.drawShape()}}),Object.defineProperty(h,"sides",{get:function(){return h._sides},set:function(y){h._sides=y,h.drawShape()}}),Object.defineProperty(h,"pointSize",{get:function(){return h._pointSize},set:function(y){h._pointSize=y,h.drawShape()}}),x!==!1&&t.styleTransforms(this,E),this.clone=function(y){var C=h.cloneProps(new t.Poly(y||!t.isPick(A[0])?h.radius:A[0],y||!t.isPick(A[1])?h.sides:A[1],y||!t.isPick(A[2])?h.pointSize:A[2],y||!t.isPick(A[3])?h.color:A[3],y||!t.isPick(A[4])?h.borderColor:A[4],y||!t.isPick(A[5])?h.borderWidth:A[5],h.dashed,c,x,this.group,v));return h.linearGradientParams&&C.linearGradient.apply(C,h.linearGradientParams),h.radialGradientParams&&C.radialGradient.apply(C,h.radialGradientParams),C}},t.extend(t.Poly,t.CustomShape,"clone","zimCustomShape",!1),t.Line=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A){var T="length, thickness, color, startHead, endHead, dashed, strokeObj, lineType, lineOrientation, curveH, curveV, points, style, group, inherit",h;if(h=st(t.Line,arguments,T,this))return h;De("53.15"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Line",this.group=E;var w=b===!1?{}:t.getStyle(this.type,this.group,A);n(e)&&(e=w.length!=null?w.length:100),n(s)&&(s=w.dashed!=null?w.dashed:!1),n(r)&&(r=w.thickness!=null?w.thickness:3),n(i)&&(i=w.color!=null?w.color:t.black),n(l)&&(l=w.startHead!=null?w.startHead:null),n(a)&&(a=w.endHead!=null?w.endHead:null),n(f)&&(f=w.strokeObj!=null?w.strokeObj:{}),n(c)&&(c=w.lineType!=null?w.lineType:"straight"),c!=="corner"&&c!="curve"&&(c="straight"),n(x)&&(x=w.lineOrientation!=null?w.lineOrientation:"auto"),x!=="vertical"&&x!="horizontal"&&(x="auto"),n(k)&&(k=w.curveH!=null?w.curveH:20),n(v)&&(v=w.curveV!=null?w.curveV:20),n(f)&&(f=w.strokeObj!=null?w.strokeObj:{});var P=y(e,i,r,l,a);this.veeObj={length:P[0],color:P[1],thickness:P[2],startHead:P[3],endHead:P[4]};function y(){return arguments}e=t.Pick.choose(e),i=t.Pick.choose(i),r=t.Pick.choose(r),l=t.Pick.choose(l),a=t.Pick.choose(a),l&&l.clone&&(l=l.clone()),a&&a.clone&&(a=a.clone());var C=this;C._length=e,C._color=i,C._thickness=r,C._dashed=s,C._dashed&&!Array.isArray(C._dashed)&&(C._dashed=[10,10]),C._startX=0,C._startY=0,C._endX=e,C._endY=0,C._startHead=l,C._endHead=a,C._points=g,C._lineOrientation=x,C.angle=0,C.lineType=c,C._startHead&&O("start",C._startHead),C._endHead&&O("end",C._endHead);function O(m,$){if($=="triangle"||$=="arrow"){var I=C["_"+m+"Head"]=new t.Triangle(r*4,r*4,r*4,i);I.rotation=90}else $=="circle"&&(C["_"+m+"Head"]=new t.Circle(r*2.2,i));n(C["_"+m+"Head"].startAngle)&&(C["_"+m+"Head"].startAngle=C["_"+m+"Head"].rotation)}l=C._startHead,a=C._endHead,l&&l.type=="Triangle"&&(l.startRegY=l.regY),a&&a.type=="Triangle"&&(a.startRegY=a.regY);var _=this.shape=new Ge.Shape;this.addChild(_);var Y=_.graphics;C.drawShape=function(m,$){Y.c(),C.colorCommand=Y.s(C._color).command,i&&i.type&&C.specialColor(C.colorCommand,i,C),C.thicknessCommand=Y.ss(C._thickness,f.caps,f.joints,f.miterLimit,f.ignoreScale).command,C._dashed&&(C.dashedCommand=Y.sd(Array.isArray(C._dashed)?C._dashed:[10,10],C._dashedOffset).command);var I,X;if(C._points){var R=C._points[0];C._startX=R[0],C._startY=R[1];var q=C._points[C._points.length-1],J=[q[q.length-2],q[q.length-1]];C._endX=J[0],C._endY=J[1],Y.mt(R[0],R[1]);for(var Z=1;Z<C._points.length;Z++){var ne=C._points[Z];Z==1&&(I=[C._startX,C._startY,ne[0],ne[1]]),ne.length==2?Y.lt(ne[0],ne[1]):ne.length==4?Y.qt(ne[0],ne[1],ne[2],ne[3]):ne.length==6&&Y.bt(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}if(ne.length>=4)X=[ne[ne.length-4],ne[ne.length-3],C._endX,C._endY];else{var U=C._points[C._points.length-2];X=[U[U.lenth-2],U[U.lenth-1],C._endX,C._endY]}}else{var B=C._startX,d=C._startY,u=C._endX,o=C._endY,S;if(C.lineType=="straight"?(l&&l.type=="Triangle"&&(l.regY=0,S=t.dist(B,d,u,o),S!=0&&(B=B+C._startHead.height/2*(u-B)/S),S!=0&&(d=d+C._startHead.height/2*(o-d)/S)),a&&a.type=="Triangle"&&(a.regY=0,S=t.dist(B,d,u,o),S!=0&&(u=u-C._endHead.height/2*(u-B)/S),S!=0&&(o=o-C._endHead.height/2*(o-d)/S))):(m?C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?l&&l.type=="Triangle"&&(l.regY=0,u>B?B=Math.min(u,B+C._startHead.height/2):B=Math.max(u,B-C._startHead.height/2)):l&&l.type=="Triangle"&&(l.regY=0,o>d?d=Math.min(o,d+C._startHead.height/2):d=Math.max(o,d-C._startHead.height/2)):l&&l.type=="Triangle"&&(l.regY=l.startRegY),$?C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?a&&a.type=="Triangle"&&(a.regY=0,u>B?u-=C._endHead.height/2:u+=C._endHead.height/2):a&&a.type=="Triangle"&&(a.regY=0,o>d?o-=C._endHead.height/2:o+=C._endHead.height/2):a&&a.type=="Triangle"&&(a.regY=a.startRegY)),C.lineType=="straight")Y.mt(B,d).lt(u,o),I=X=[B,d,u,o];else if(C.lineType=="corner"){var F=B+(u-B)*.4,p=d+(o-d)*.4;C._lineOrientation=="auto"&&(C.autoOrientation=Math.abs(B-u)>Math.abs(d-o)?"horizontal":"vertical"),C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?(I=X=[B,d,F,d],Y.mt(B,d).lt(F,d).lt(F,o).lt(u,o)):(I=X=[B,d,B,p],Y.mt(B,d).lt(B,p).lt(u,p).lt(u,o))}else{var L=B>u?-1:1,we=d>o?-1:1,D=B,N=d,ue=Math.abs(B-u),fe=Math.abs(d-o),V=Math.min(k,ue*.5),z=Math.min(v,fe*.5);C._lineOrientation=="auto"&&(C.autoOrientation=Math.abs(B-u)>Math.abs(d-o)?"horizontal":"vertical");var se,Oe,K,ge;C._lineOrientation=="horizontal"||C.autoOrientation=="horizontal"?(se=fe-z*2,Oe=(ue-V*2)/2,Y.mt(D,N),Oe>0&&(D=D+Oe*L,Y.lt(D,N)),ge=N,N=N+z*we,D=D+V*L,Y.qt(D,ge,D,N),I=X=[B,d,D,d],se>0&&(N=N+se*we,Y.lt(D,N)),N=N+z*we,K=D,D=D+V*L,Y.qt(K,N,D,N),Oe>0&&(D=D+Oe*L,Y.lt(D,N))):(se=ue-V*2,Oe=(fe-z*2)/2,Y.mt(D,N),Oe>0&&(N=N+Oe*we,Y.lt(D,N)),K=D,D=D+V*L,N=N+z*we,Y.qt(K,N,D,N),I=X=[B,d,B,N],se>0&&(D=D+se*L,Y.lt(D,N)),D=D+V*L,ge=N,N=N+z*we,Y.qt(D,ge,D,N),Oe>0&&(N=N+Oe*we,Y.lt(D,N)))}}if(C.setBounds(Math.min(C._startX,C._endX),Math.min(C._startY,C._endY),Math.abs(C._startX-C._endX),Math.abs(C._startY-C._endY)),C._length=Math.sqrt(Math.pow(C._startX-C._endX,2)+Math.pow(C._startY-C._endY,2)),C.angle=Math.atan2(C._endY-C._startY,C._endX-C._startX)*180/Math.PI,C._startHead&&C._startHead.loc){C._startHead.loc(C._startX,C._startY,C);var Q=Math.atan2(I[3]-I[1],I[2]-I[0])*180/Math.PI;C._startHead.rotation=Q-180+C._startHead.startAngle}if(C._endHead&&C._endHead.loc){C._endHead.loc(C._endX,C._endY,C);var ce=Math.atan2(X[3]-X[1],X[2]-X[0])*180/Math.PI;C._endHead.rotation=ce+C._endHead.startAngle}},C.drawShape(),i.type&&(C.color=i),this.setPoints=function(m,$,I,X,R,q){return Array.isArray(m)&&n($)?(C.points=m,C):(m&&!n(m.x)?(C._startX=n(m.x)?C._startX:m.x,C._startY=n(m.y)?C._startY:m.y,$&&(C._endX=n($.x)?C._endX:$.x,C._endY=n($.y)?C._endY:$.y)):(C._startX=n(m)?C._startX:m,C._startY=n($)?C._startY:$,C._endX=n(I)?C._endX:I,C._endY=n(X)?C._endY:X),C.drawShape(R,q),C)},this.from=function(m,$,I){n(I)&&(I=!0);var X,R;if(m&&m.parent&&C.parent&&I){var q=m.parent.localToLocal(m.x,m.y,C.parent);X=q.x,R=q.y}return m&&!n(m.x)?(C._startX=n(X)?n(m.x)?C._startX:m.x:X,C._startY=n(R)?n(m.y)?C._startY:m.y:R):(C._startX=n(m)?C._startX:m,C._startY=n($)?C._startY:$),C.drawShape(),C},this.to=function(m,$,I){n(I)&&(I=!0);var X,R;if(m&&m.parent&&C.parent&&I){var q=m.parent.localToLocal(m.x,m.y,C.parent);X=q.x,R=q.y}return m&&!n(m.x)?(C._endX=n(X)?n(m.x)?C._endX:m.x:X,C._endY=n(R)?n(m.y)?C._endY:m.y:R):(C._endX=n(m)?C._endX:m,C._endY=n($)?C._endY:$),C.drawShape(),C},Object.defineProperty(C,"length",{get:function(){return C._length},set:function(m){var $=C.length!=0?m/C.length:0;if(!isNaN($)){var I=C.scaleX,X=C.scaleY;C.scaleX*=$,C.scaleY*=$;var R=C.localToGlobal(C._startX,C._startY),q=C.localToGlobal(C._endX,C._endY);C.scaleX=I,C.scaleY=X;var J=C.globalToLocal(R.x,R.y),Z=C.globalToLocal(q.x,q.y);C.setPoints(J,Z)}}}),Object.defineProperty(C,"startPoint",{get:function(){return new t.Point(C._startX,C._startY)},set:function(m){C._startX=n(m.x)?C._startX:m.x,C._startY=n(m.y)?C._startY:m.y,C.drawShape()}}),Object.defineProperty(C,"endPoint",{get:function(){return new t.Point(C._endX,C._endY)},set:function(m){C._endX=n(m.x)?C._endX:m.x,C._endY=n(m.y)?C._endY:m.y,C.drawShape()}}),Object.defineProperty(C,"startHead",{get:function(){return C._startHead},set:function(m){C._startHead=m,C.drawShape()}}),Object.defineProperty(C,"endHead",{get:function(){return C._endHead},set:function(m){C._endHead=m,C.drawShape()}}),Object.defineProperty(C,"startX",{get:function(){return C._startX},set:function(m){C._startX=m||0,C.drawShape()}}),Object.defineProperty(C,"startY",{get:function(){return C._startY},set:function(m){C._startY=m||0,C.drawShape()}}),Object.defineProperty(C,"endX",{get:function(){return C._endX},set:function(m){C._endX=m||0,C.drawShape()}}),Object.defineProperty(C,"endY",{get:function(){return C._endY},set:function(m){C._endY=m||0,C.drawShape()}}),Object.defineProperty(C,"points",{get:function(){return C._points},set:function(m){m&&(C._points=m,C.drawShape())}}),Object.defineProperty(C,"lineOrientation",{get:function(){return C._lineOrientation},set:function(m){m&&(C._lineOrientation=m,C.drawShape())}}),b!==!1&&t.styleTransforms(this,w),this.clone=function(m){var $=m||!t.isPick(P[3])?C._startHead:P[3];$&&$.clone&&($=$.clone(),$.rotation=C._startHead.startAngle);var I=m||!t.isPick(P[4])?C._endHead:P[4];I&&I.clone&&(I=I.clone(),I.rotation=C._endHead.startAngle);var X=C.cloneProps(new t.Line(m||!t.isPick(P[0])?C.length:P[0],m||!t.isPick(P[2])?C.thickness:P[2],m||!t.isPick(P[1])?C.color:P[1],$,I,C.dashed,f,c,C._lineOrientation,k,v,t.copy(g),b,this.group,A));return C.points?X.setPoints(C.points):X.setPoints(C._startX,C._startY,C._endX,C._endY),C.linearGradientParams&&X.linearGradient.apply(X,C.linearGradientParams),C.radialGradientParams&&X.radialGradient.apply(X,C.radialGradientParams),X}},t.extend(t.Line,t.CustomShape,"clone","zimCustomShape",!1),t.Squiggle=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$){var I="color, thickness, points, length, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",X;if(X=st(t.Squiggle,arguments,I,this))return X;De("53.2"),this.group=m;var R=Y===!1?{}:t.getStyle("Squiggle",this.group,$);if(n(r)&&(r=R.thickness!=null?R.thickness:6),n(l)&&(l=R.length!=null?R.length:300),n(i)&&(i=R.points!=null?R.points:5),typeof i=="string"){var q=new t.SVGContainer;i=q.processPath(i)}var J=typeof i!="number",Z=typeof i=="number"?i:i.length;if(Z==0)return;n(a)&&(a=R.controlLength!=null?R.controlLength:l/Z),this.zimCustomShape_constructor(l,a,null,null,!1),this.type="Squiggle",this.mouseChildren=!0,n(b)&&(b=R.dashed!=null?R.dashed:!1),n(e)&&(e=R.color!=null?R.color:t.blue),e.style&&(this.colorCommand=e,e=t.black),n(s)&&(s=R.controlType!=null?R.controlType:null);var ne=s;n(s)&&(s="mirror"),n(f)&&(f=R.lockControlType!=null?R.lockControlType:!1),n(O)&&(O=R.interactive!=null?R.interactive:!0),n(c)&&(c=R.showControls!=null?R.showControls:O);var U=c;n(x)&&(x=R.lockControls!=null?R.lockControls:!O),n(k)&&(k=R.handleSize!=null?R.handleSize:t.mobile()?20:10),n(v)&&(v=R.allowToggle!=null?R.allowToggle:O),n(g)&&(g=R.move!=null?R.move:O),n(A)&&(A=R.circleColor!=null?R.circleColor:t.light),n(T)&&(T=R.circleBorderColor!=null?R.circleBorderColor:t.dark),n(h)&&(h=R.stickColor!=null?R.stickColor:t.darker),n(w)&&(w=R.stickThickness!=null?R.stickThickness:1),n(P)&&(P=R.selectColor!=null?R.selectColor:t.white),n(y)&&(y=R.selectPoints!=null?R.selectPoints:O),this.circleColor=A,this.circleBorderColor=T,this.stickColor=h,this.stickThickness=w,n(E)&&(E=R.onTop!=null?R.onTop:!0),n(C)&&(C=R.editPoints!=null?R.editPoints:O),n(_)&&(_=R.strokeObj!=null?R.strokeObj:{});var B=d(e);this.veeObj={color:B[0]};function d(){return arguments}e=t.Pick.choose(e);var u=this,o;this.types=["mirror","straight","free","none"],this.interactive=O,this.num=Z,this.onTop=E,this.move=g,this.editPoints=C,this.allowToggle=v,this.lockControlType=f,this.selectPoints=y,this.lockControls=x;var S,F,p;u._color=e,u._thickness=r,u._dashed=b,u._dashed&&!Array.isArray(u._dashed)&&(u._dashed=[10,10]);var L,we,D,N,ue=u.move,fe=2,V,z;ne&&typeof i!="number"&&t.loop(i,function(re){re[8]=ne,ne=="none"&&(re[4]=re[5]=re[6]=re[7]=0)}),se();function se(){z&&z.removeAllEventListeners(),u.num=Z=typeof i=="number"?i:i.length,Z=Math.max(2,Z),a=l/Z,L=u.shape=new t.Shape({style:!1}).addTo(u);var re=u.sticks=new t.Shape({style:!1}).addTo(u);k<=0&&re.removeFrom();var xe=L.graphics;xe.c();var ke=re.graphics;ke.c();var te=k/10*8,pe=k;u.selectPoints?(u.selectedBalls=new t.SelectionSet,u.selectedRect1s=new t.SelectionSet,u.selectedRect2s=new t.SelectionSet,u.selectionManager=new t.SelectionManager([u.selectedBalls,u.selectedRect1s,u.selectedRect2s],"ctrl",!1)):u.selectionManager=new t.SelectionManager(null,"ctrl");var he=t.mobile();z=u.controls=new t.Container({style:!1}).addTo(u),u.interactive&&z.drag({onTop:!he}),S=[],p=[],F=[];var ae,Ee,ie,Se,Le,Ce,ee,Me,_e;for(ae=0;ae<Z;ae++){if(Se=new t.Container({style:!1}).addTo(z),Se.num=ae,typeof i=="number"){var Ye=t.Pick.choose(a);ie=new t.Container(Ye,r,null,null,!1).addTo(u).loc({x:ae*l/(Z-1)-Ye/2,y:ae%2*Ye}),ee=new t.Circle(te,u.selectPoints&&u.selectedBalls.isSelected(ae)?P:u.circleColor,u.circleBorderColor,2,null,null,null,null,!1).centerReg(ie).loc({x:Ye/2,y:0}),Le=new t.Rectangle(pe,pe,u.selectPoints&&u.selectedRect1s.isSelected(ae)?P:Pe(s),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg(ie).loc({x:0,y:0}),Ce=new t.Rectangle(pe,pe,u.selectPoints&&u.selectedRect2s.isSelected(ae)?P:Pe(s),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg(ie).loc({x:Ye,y:0});var je=ie.localToLocal(ee.x,ee.y,z);ee.x=je.x,ee.y=je.y,ee.addTo(Se,null,!1);var it=ie.localToLocal(Le.x,Le.y,z);Le.x=s=="none"?0:it.x-ee.x,Le.y=s=="none"?0:it.y-ee.y,Le.addTo(Se,null,!1);var Be=ie.localToLocal(Ce.x,Ce.y,z);Ce.x=s=="none"?0:Be.x-ee.x,Ce.y=s=="none"?0:Be.y-ee.y,Ce.addTo(Se,null,!1),Se.x=ee.x,Se.y=ee.y,ee.x=0,ee.y=0,s=="none"&&ee.addTo(Se,null,!1)}else _e=i[ae],Me=_e[8]?_e[8]:s,Se.loc({x:_e[0],y:_e[1]}),ee=new t.Circle(te,u.circleColor,u.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(Se).loc({x:_e[2],y:_e[3]}),Le=new t.Rectangle(pe,pe,Pe(Me),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(Se,0).loc({x:_e[4],y:_e[5]}),Ce=new t.Rectangle(pe,pe,Pe(Me),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(Se,0).loc({x:_e[6],y:_e[7]});ee.mySet=Se,ee.rect1=Le,ee.rect2=Ce,ee.index=ae,he?ee.on("mousedown",et):ee.on("dblclick",ve),Le.ball=ee,Le.other=Ce,Ce.ball=ee,Ce.other=Le,k==0&&(ee.expand(10),Le.expand(10),Ce.expand(10)),he&&(ee.expand(),Le.expand(),Ce.expand()),Ee=[Se,ee,Le,Ce,_e?_e[8]:s],S.push(Ee),F.push(ee),p.push(Se)}var qe=!1;function et(de){qe?(de.preventDefault(),ve(de)):(qe=!0,setTimeout(function(){qe=!1},300))}function ve(de){if(!u.lockControlType){var Ve=de.target,be=S[Ve.index][4]?S[Ve.index][4]:s;Math.abs(Ve.rect1.x)<=2&&Math.abs(Ve.rect1.y)<=2&&Math.abs(Ve.rect2.x)<=2&&Math.abs(Ve.rect2.y)<=2&&(be="none"),be=="none"&&Ve.parent.addChildAt(Ve,0),be=u.types[(u.types.indexOf(be)+(u.shiftKey?-1:1)+u.types.length)%u.types.length],be=="none"&&(Ve.rect1.x=Ve.rect1.y=Ve.rect2.x=Ve.rect2.y=0,Ve.parent.addChild(Ve),de.stopImmediatePropagation()),S[Ve.index][4]=be,Ve.rect1.color=Pe(be),Ve.rect2.color=Pe(be),u.drawShape(),e.type&&(u.color=e);var Te=new Ge.Event("change");Te.controlType="bezierSwitch",u.dispatchEvent(Te),Ve.stage.update()}}function Pe(de){var Ve={straight:"#e472c4",free:"#ebcb35",none:"#50c4b7"};return Ve[de]?Ve[de]:"#993399"}var oe=t.mobile();u.drawShape=function(){xe.c();var de=oe?10:6,Ve,be,Te,Re,Ne,Ue,rt,me,He,at,Qe,ct,ot,dt,$e;if(r<de)for(xe.s("rgba(0,0,0,.01)").ss(de),Re=S[0][0],He=Re.localToLocal(S[0][1].x,S[0][1].y,L),xe.mt(He.x,He.y),Ve=0;Ve<S.length;Ve++)be=Ve,Te=(Ve+1)%S.length,Re=S[be][0],Ne=S[be][1],Ue=S[be][2],rt=S[be][3],me=S[Te][0],at=S[Te][1],Qe=S[Te][2],ot=Re.localToLocal(rt.x,rt.y,L),dt=me.localToLocal(Qe.x,Qe.y,L),$e=me.localToLocal(at.x,at.y,L),Ve!=S.length-1&&xe.bt(ot.x,ot.y,dt.x,dt.y,$e.x,$e.y);for(u.colorCommand||(u.colorCommand=xe.s(u._color).command,e&&e.type&&u.specialColor(u.colorCommand,e,u)),u.thicknessCommand||(u.thicknessCommand=xe.ss(u._thickness,_.caps,_.joints,_.miterLimit,_.ignoreScale).command),u._dashed&&(u.dashedCommand||(u.dashedCommand=xe.sd(Array.isArray(u._dashed)?u._dashed:[10,10],u._dashedOffset).command)),Re=S[0][0],He=Re.localToLocal(S[0][1].x,S[0][1].y,L),xe.mt(He.x,He.y),ke.c().s(u.stickColor).ss(u.stickThickness),Ve=0;Ve<S.length;Ve++)be=Ve,Te=(Ve+1)%S.length,Re=S[be][0],Ne=S[be][1],Ue=S[be][2],rt=S[be][3],me=S[Te][0],at=S[Te][1],Qe=S[Te][2],ot=Re.localToLocal(rt.x,rt.y,L),dt=me.localToLocal(Qe.x,Qe.y,L),$e=me.localToLocal(at.x,at.y,L),Ve!=S.length-1&&xe.bt(ot.x,ot.y,dt.x,dt.y,$e.x,$e.y),He=Re.localToLocal(Ne.x,Ne.y,L),ct=Re.localToLocal(Ue.x,Ue.y,L),Ve==0&&(Ue.visible=0),Ve!=0&&ke.mt(He.x,He.y).lt(ct.x,ct.y),Ve!=S.length-1&&ke.mt(He.x,He.y).lt(ot.x,ot.y),Ve==S.length-1&&(rt.visible=0);u._dashed&&xe.append(u.dashedCommand),xe.append(u.thicknessCommand),xe.append(u.colorCommand)},u.drawShape(),e.type&&(u.color=e);var Fe;z.on("mousedown",function(de){if(o=de.target.stage,!u.lockControls){if(u.selectPoints&&(u.keyFocus=!0),Fe={x:de.target.x,y:de.target.y},de.target.rect1)ee=de.target,ee.startX=ee.x,ee.startY=ee.y,ee.rect1.startX=ee.rect1.x,ee.rect1.startY=ee.rect1.y,ee.rect2.startX=ee.rect2.x,ee.rect2.startY=ee.rect2.y;else{var Ve=de.target;Ve.startX=Ve.x,Ve.startY=Ve.y,ee=Ve.ball;var be=ee.index,Te=s;if(n(S[be][4])||(Te=S[be][4]),Te=="straight"){var Re=Ve.other,Ne=Re.x-ee.x,Ue=Re.y-ee.y;Re.stickLength=Math.sqrt(Math.pow(Ne,2)+Math.pow(Ue,2))}}if(u.selectPoints){var rt=u.selectionManager.currentSet;if(rt&&rt.selections&&rt.selections.length>0)for(ae=0;ae<rt.selections.length;ae++){var me=u.pointObjects[rt.selections[ae]];me[1].startX=me[1].x,me[1].startY=me[1].y,me[2].startX=me[2].x,me[2].startY=me[2].y,me[3].startX=me[3].x,me[3].startY=me[3].y}}}}),u.selectPoints&&z.tap(function(de){if(de.target.rect1){var Ve=de.target;u.selectedBalls.toggle(Ve.parent.num)}else{var be=de.target;be.color="white",Ve=be.ball,Ve.rect1==be?u.selectedRect1s.toggle(Ve.parent.num):u.selectedRect2s.toggle(Ve.parent.num)}for(ae=0;ae<u.pointObjects.length;ae++){var Te=u.pointObjects[ae];Te[1].color=u.selectedBalls.isSelected(ae)?P:u.circleColor,Te[2].color=u.selectedRect1s.isSelected(ae)?P:Pe(Te[4]),Te[3].color=u.selectedRect2s.isSelected(ae)?P:Pe(Te[4])}o.update()}),z.on("pressmove",function(de){if(!u.lockControls)if(u.selectPoints){var Ve=Oe();if(Ve.indexOf(de.target)==-1)V(de.target),u.drawShape();else if(Ve.length>0){for(var be=de.target.x-de.target.startX,Te=de.target.y-de.target.startY,Re=0;Re<Ve.length;Re++){var Ne=Ve[Re];Ne.x=Ne.startX+be,Ne.y=Ne.startY+Te,V(Ne)}u.drawShape()}}else V(de.target),u.drawShape()}),z.on("pressup",function(de){if(!u.lockControls){var Ve=de.target.x!=Fe.x||de.target.y!=Fe.y,be=new Ge.Event("change");de.target.rect1?(be.controlType="bezierPoint",Ze(de.target)):be.controlType="bezierHandle",Ve&&u.dispatchEvent(be)}});function Ze(de){if(u.selectPoints){var Ve=Oe();if(Ve&&Ve.indexOf(de)==-1)K(de);else if(Ve&&Ve.length>0)for(var be=0;be<Ve.length;be++)K(Ve[be]);else K(de)}else K(de)}u.changeControl=function(de,Ve,be,Te,Re,Ne,Ue,rt,me){var He="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",at;if(at=st(u.changeControl,arguments,He))return at;if(n(de)){for(ae=0;ae<S.length;ae++)u.changeControl(ae,Ve,be,Te,Re,Ne,Ue,rt);return}var Qe=S[de];Qe[4]=Ve,Ve=="none"?(n(Ue)||(Qe[2].x=Ue),n(rt)||(Qe[2].y=rt),Qe[2].x=Qe[1].x,Qe[2].y=Qe[1].y,Qe[3].x=Qe[1].x,Qe[3].y=Qe[1].y,Qe[1].parent.addChild(Qe[1])):(n(be)||(Qe[2].x=be),n(Te)||(Qe[2].y=Te),n(Re)||(Qe[3].x=Re),n(Ne)||(Qe[3].y=Ne),n(Ue)||(Qe[1].x=Ue),n(rt)||(Qe[1].y=rt),Qe[1].parent.addChildAt(Qe[1],0)),me&&(u.update(),o&&o.update())},u.transformPoints=function(de,Ve,be,Te,Re){return n(Re)&&(Re=!0),u.points=t.transformPoints(u.points,de,Ve,be,Te),Re&&u.approximateBounds(),u},u.traverse=function(de,Ve,be,Te,Re){var Ne=t.copy(u.segmentRatios);Ne.unshift(0),n(be)&&(be=Ve+1);var Ue=Ne[Ve]*100,rt=Ne[be]*100,me;!Re&&Ue>rt?me=100-Ue+rt:!Re&&Ue<rt?me=rt-Ue:Re&&Ue>rt?me=-(Ue-rt):Re&&Ue<rt&&(me=-(100-rt+Ue));var He=new Ge.Event("traversed");return He.obj=de,de.animate({ease:"linear",props:{path:u,startPercent:Ue,percent:me},time:Te,call:function(){u.dispatchEvent(He)}}),u},u.reversePoints=function(){return i=t.copy(u.points),u.points=t.reversePoints(t.copy(u.points)),u.update(),u},u.appendPoints=function(de,Ve){var be=t.copy(u.points);return u.points=t.appendPoints(be,de,Ve),u.update(),u},u.prependPoints=function(de,Ve){var be=t.copy(u.points);return u.points=t.rependPoints(be,i,Ve),u.update(),u},u.splitPoints=function(de){var Ve=t.copy(u.points);if(!(de<1||de>Ve.length-1)){var be=t.splitPoints(Ve,de),Te=be[0],Re=be[1],Ne=u.clone();return u.points=Te,u.update(),Ne.points=Re,u.parent&&Ne.addTo(u.parent),Ne}},u.makeBlob=function(de,Ve){n(de)&&(de="mirror"),n(Ve)&&(Ve=5);var be=t.copy(u.points);t.loop(be,function(Re,Ne,Ue){Re[8]||(Re[8]="mirror"),Ne==0&&(de=="free"&&(Re[4]=Re[5]=0),Re[8]=de),Ne==Ue-1&&(de=="free"&&(Re[6]=Re[7]=0),Re[8]=de)}),Math.abs(be[0][0]-be[be.length-1][0])<Ve&&Math.abs(be[0][1]-be[be.length-1][1])<Ve&&(be[0][4]=be[be.length-1][4],be[0][5]=be[be.length-1][5],be.pop());var Te=new t.Blob({points:be,borderColor:u.color,borderWidth:u.thickness,showControls:u.controlsVisible,interactive:u.interactive,onTop:u.onTop,dashed:u.dashed,stickColor:u.stickColor,stickThickness:u.stickThickness});return Te},u.update=function(de){return de?u.points=u.pointsAdjusted:u.drawShape(),u.zimAnimateChanged=!0,u},u.interactive&&(g&&L.drag({onTop:!1}),we=L.on("mousedown",function(de){o=de.target.stage,Fe={x:L.x,y:L.y},u.selectPoints&&(u.keyFocus=!0),Xe()}),D=L.on("pressmove",function(){z.x=L.x,z.y=L.y,re.x=L.x,re.y=L.y}),N=L.on("pressup",function(){var de=L.x!=Fe.x||L.y!=Fe.y,Ve=L.localToLocal(u.regX,u.regY,u.parent);if(u.x=Ve.x,u.y=Ve.y,z.x=z.y=re.x=re.y=L.x=L.y=0,de){var be=new Ge.Event("change");be.controlType="move",u.dispatchEvent(be)}o&&o.update()}),u.move||Q(!0));function Xe(){if(u.onTop){var de=u.parent.numChildren-1;u.parent.getChildAt(de).type=="Keyboard"&&de--,u.parent.setChildIndex(u,de)}}u.toggleEvent=u.on("mousedown",function(){u.allowToggle&&(U||(u.showControls(),u.dispatchEvent("controlsshow")))}),u.added(function(){o=u.stage,u.toggleStageEvent&&o.off("stagemousedown",u.toggleStageEvent),u.toggleStageEvent=o.on("stagemousedown",function(de){!u.allowToggle||!u.stage||U&&!u.hitTestPoint(de.stageX/t.scaX,de.stageY/t.scaY,!1)&&(u.hideControls(),u.dispatchEvent("controlshide"))})}),u.clickEvent=u.on("click",function(){u.ctrlKey&&setTimeout(function(){u.clone(!0).addTo(u.stage).mov(0,100),u.allowToggle&&(u.hideControls(),u.dispatchEvent("controlshide"));var de=new Ge.Event("change");de.controlType="move",u.dispatchEvent(de),u.stage.update()},50)}),u.hideControls=function(){return u.toggled=!1,z.visible=!1,re.visible=!1,U=!1,u.stage&&u.stage.update(),!u.allowToggle&&u.move&&Q(),u},c||u.hideControls(),u.showControls=function(){return u.toggled=!0,z.visible=!0,re.visible=!0,U=!0,z.x=L.x,z.y=L.y,re.x=L.x,re.y=L.y,u.addChildAt(L,0),u.move&&!u.allowToggle&&ge(),u.stage&&u.stage.update(),u},u.toggle=function(de){return de===!0?u.showControls():de===!1||U?u.hideControls():u.showControls(),u},u.recordData=function(de){n(de)&&(de=!1);var Ve={type:"Squiggle",index:u.parent?u.parent.getChildIndex(u):-1,x:u.x,y:u.y,points:u.getPoints(),color:u.color,thickness:u.thickness,move:u.move,allowToggle:u.allowToggle,controlsVisible:U};return de?JSON.stringify(Ve):Ve},u.setData=function(de,Ve){if(!n(de)){if(Ve)try{de=JSON.parse(de)}catch (e6){return}var be=de.index;n(be)&&(be=-1),delete de.index;var Te=de.points;n(Te)||u.setPoints(Te),delete de.points,u.num=Te.length;for(var Re in de)u[Re]=de[Re];return u.parent&&u.parent.setChildIndex(u,be),u.update(),u}},u.getPoints=function(de){n(de)&&(de=!1);var Ve=u.points;if(de){if(!u.pane){var be=u.pane=new t.Pane({container:u.stage,width:Math.min(500,u.stage.width-20),height:Math.min(500,u.stage.height-20),draggable:!0}),Te=u.textArea=new t.TextArea(Math.min(400,u.stage.width-70),Math.min(400,u.stage.height-70));Te.centerReg(be)}u.textArea.text=JSON.stringify(Ve),u.pane.show()}return Ve},u.recordPoints=u.getPoints,u.setPoints=function(de){for(var Ve,be,Te=0;Te<de.length;Te++)Ve=S[Te],be=de[Te],!n(Ve)&&(Ve[0].x=be[0],Ve[0].y=be[1],Ve[1].x=be[2],Ve[1].y=be[3],Ve[2].x=be[4],Ve[2].y=be[5],Ve[3].x=be[6],Ve[3].y=be[7],Ve[4]=be[8]);return u.update(),u},Y!==!1&&t.styleTransforms(u,R),u.clone=function(de,Ve){var be=[],Te=!1;t.loop(u.pointControls,function(Ne){Ne.scaleX+Ne.scaleY+Ne.regX+Ne.regY+Ne.rotation!=2&&(Te=!0),be.push([Ne.scaleX,Ne.scaleY,Ne.regX,Ne.regY,Ne.rotation])});var Re=u.cloneProps(new t.Squiggle(Ve?u.colorCommand:de||!t.isPick(B[0])?u.color:B[0],u.thickness,u.getPoints(),l,a,s,f,z.visible,x,k,u.allowToggle,u.move,b,E,u.circleColor,u.circleBorderColor,u.stickColor,u.stickThickness,P,y,u.editPoints,O,_,Y,u.group,$));return Te&&(t.loop(Re.pointControls,function(Ne,Ue){Ne.scaleX=be[Ue][0],Ne.scaleY=be[Ue][1],Ne.regX=be[Ue][2],Ne.regY=be[Ue][3],Ne.rotation=be[Ue][4]}),Re.update()),u.linearGradientParams&&Re.linearGradient.apply(Re,u.linearGradientParams),u.radialGradientParams&&Re.radialGradient.apply(Re,u.radialGradientParams),Re},u.shape.on("mousedown",function(de){o=de.target.stage,u.editPoints&&(u.controlsVisible?(u.pressX=de.stageX/t.scaX,u.pressY=de.stageY/t.scaX):(u.pressX=null,u.pressY=null))}),u.addPointFactor=10,u.addMinDistance=15,u.shape.on("pressup",function(de){if(u.editPoints&&u.pressX&&Math.abs(u.pressX-de.stageX/t.scaX)<fe&&Math.abs(u.pressY-de.stageY/t.scaY)<fe){u.selectPoints&&(u.lastPoints=t.copy(u.points));var Ve=u.points,be=u.globalToLocal(de.stageX/t.scaX,de.stageY/t.scaY),Te=t.closestPointAlongCurve(be,u.segmentPoints);if(u.editPoints=="anywhere")Ve.splice(Te+1,0,[be.x,be.y,0,0,0,0,0,0]),u.points=Ve,u.changeControl({index:Te+1,type:"mirror",update:!0});else{var Re=u.pointsAdjusted,Ne=u.getSegmentPoint(Re[Te],Re[(Te+1)%Re.length]),Ue=t.distanceAlongCurve(Ne),rt=Math.round(Ue/u.addPointFactor),me=u.interpolate(rt,Te,!1,Ve),He=1e4,at;if(t.loop(me,function(dt,$e){var Mt=t.dist(dt,be);Mt<He&&(He=Mt,at=$e)}),He<u.addMinDistance){var Qe=u.segmentRatios,ct=Qe[Te],ot=Te>0?Qe[Te-1]:0;u.addPoint(100*(ot+(ct-ot)*(at/(rt+1))))}}u.lastSelectedIndex=Te+1,u.lastSelected=u.controls.getChildAt(u.lastSelectedIndex),u.stage.update()}}),u.controls.on("click",function(de){u.lastSelected=de.target.parent,u.lastSelectedIndex=u.controls.getChildIndex(de.target.parent),u.editPoints&&u.selectionManager.shiftKey&&We(de)});function We(de){if(de.target.type=="Circle"){var Ve=u.lastSelectedIndex=u.controls.getChildIndex(de.target.parent);if(u.controls.numChildren<=2)return;var be=u.points;u.selectPoints&&(u.lastPoints=t.copy(be)),be.splice(Ve,1),u.points=be,u.stage.update(),u.lastSelected=u.lastSelectedIndex=null}}u.controls.hold(We),U||u.hideControls(),u.dispatchEvent("update")}function Oe(){var re=[],xe=u.selectionManager.currentSet;if(xe&&xe.selections&&xe.selections.length>0)for(var ke=0;ke<xe.selections.length;ke++){var te=u.pointObjects[xe.selections[ke]];if(xe==u.selectedBalls)re.push(te[1]);else if(xe==u.selectedRect1s)re.push(te[2]);else if(xe==u.selectedRect2s)re.push(te[3]);else continue}return re}function K(re){if(re.type=="Circle"){var xe=re,ke=xe.mySet,te=xe.rect1,pe=xe.rect2;te.x-=xe.x,te.y-=xe.y,pe.x-=xe.x,pe.y-=xe.y,ke.x+=xe.x,ke.y+=xe.y,xe.x=0,xe.y=0}}u.selectionManager.on("keydown",function(re){if(u.selectPoints&&u.keyFocus&&re.keyCode>=37&&re.keyCode<=40){var xe=Oe();if(xe.length>0){for(var ke=0;ke<xe.length;ke++){var te=xe[ke];re.keyCode==37?te.x-=u.selectionManager.shiftKey?10:1:re.keyCode==39?te.x+=u.selectionManager.shiftKey?10:1:re.keyCode==38?te.y-=u.selectionManager.shiftKey?10:1:re.keyCode==40&&(te.y+=u.selectionManager.shiftKey?10:1),V(te)}u.drawShape(),u.dispatchEvent("update"),u.stage&&u.stage.update()}}}),u.selectionManager.on("keyup",function(re){if(u.selectPoints&&u.keyFocus&&re.keyCode>=37&&re.keyCode<=40){var xe=Oe();if(xe.length>0)for(var ke=0;ke<xe.length;ke++)K(xe[ke])}}),u.selectionManager.on("undo",function(){if(u.selectPoints&&u.keyFocus&&u.lastPoints){var re=t.copy(u.lastPoints);u.lastPoints=t.copy(u.points),u.points=re,u.stage&&u.stage.update()}}),V=function(re){if(!u.lockControls){var xe;if(re.rect1){xe=re;var ke=xe.x-xe.startX,te=xe.y-xe.startY;xe.rect1.x=xe.rect1.startX+ke,xe.rect1.y=xe.rect1.startY+te,xe.rect2.x=xe.rect2.startX+ke,xe.rect2.y=xe.rect2.startY+te}else{var pe=re,he=pe.other;xe=pe.ball;var ae=xe.index,Ee=s;if(n(S[ae][4])||(Ee=S[ae][4]),Ee=="straight"||Ee=="mirror"){var ie=pe.x-xe.x,Se=pe.y-xe.y;if(Ee=="mirror")he.x=xe.x-ie,he.y=xe.y-Se;else{var Le=Math.atan2(Se,ie),Ce=-he.stickLength*Math.cos(Le+Math.PI),ee=-he.stickLength*Math.sin(Le+Math.PI);he.x=xe.x-Ce,he.y=xe.y-ee}}}}},Object.defineProperty(u,"move",{get:function(){return g},set:function(re){g!=re&&(g=re,re?ge():Q())}}),Object.defineProperty(u,"interactive",{get:function(){return O},set:function(re){O=re,U=O,u.allowToggle=O,u.editPoints=O,u.lockControls=!O,u.selectPoints=O,u.move=O;var xe=u.points;u.points=xe}}),Object.defineProperty(u,"allowToggle",{get:function(){return v},set:function(re){v!=re&&(v=re,v?u.move&&ge():!U&&u.move&&Q())}});function ge(){u.move!="always"&&(ue||(ue=!0,L.drag({onTop:!1}),we=L.on("mousedown",we),D=L.on("pressmove",D),N=L.on("pressup",N)))}function Q(re){u.move!="always"&&(!re&&!ue||(ue=!1,L.noDrag(),L.off("mousedown",we),L.off("pressmove",D),L.off("pressup",N)))}var ce=x;Object.defineProperty(u,"lockControls",{get:function(){return ce},set:function(re){ce=re,re?(u.controls.mouseChildren=!1,u.controls.mouseEnabled=!1):(u.controls.mouseChildren=!0,u.controls.mouseEnabled=!0)}}),u.lockControls=ce,Object.defineProperty(u,"controlsVisible",{get:function(){return U},set:function(re){U=re,re?u.showControls():u.hideControls()}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==u},set:function(){t.KEYFOCUS=u}}),t.KEYFOCUS||G();function G(){if(u.selectPoints){u.keyFocus=!0;var re=document.activeElement;re&&re.blur()}}Object.defineProperty(u,"points",{get:function(){for(var re=[],xe,ke,te=0;te<S.length;te++)ke=S[te],xe=[t.decimals(ke[0].x),t.decimals(ke[0].y),t.decimals(ke[1].x),t.decimals(ke[1].y),t.decimals(ke[2].x),t.decimals(ke[2].y),t.decimals(ke[3].x),t.decimals(ke[3].y)],ke[4]&&ke[4]!=="mirror"&&xe.push(ke[4]),re.push(xe);return re},set:function(re){var xe=u.x,ke=u.y,te=u.visible,pe=[],he=!1;t.loop(u.pointControls,function(ae){ae.scaleX+ae.scaleY+ae.regX+ae.regY+ae.rotation!=2&&(he=!0),pe.push([ae.scaleX,ae.scaleY,ae.regX,ae.regY,ae.rotation])}),u.dispose(!0),i=re,se(),u.lockControls=ce,u.x=xe,u.y=ke,u.visible=te,he&&(t.loop(u.pointControls,function(ae,Ee){ae.scaleX=pe[Ee][0],ae.scaleY=pe[Ee][1],ae.regX=pe[Ee][2],ae.regY=pe[Ee][3],ae.rotation=pe[Ee][4]}),u.update())}}),Object.defineProperty(u,"pointsAdjusted",{get:function(){var re=[],xe,ke,te,pe=u.pointObjects;return t.loop(pe.length,function(he){if(te=pe[he],ke=S[he],te[0].rotation==0&&te[0].scaleX==0&&te[0].scaleY==0)xe=[t.decimals(ke[0].x),t.decimals(ke[0].y),t.decimals(ke[1].x),t.decimals(ke[1].y),t.decimals(ke[2].x),t.decimals(ke[2].y),t.decimals(ke[3].x),t.decimals(ke[3].y)];else{var ae=te[0].localToLocal(te[2].x,te[2].y,te[0].parent),Ee=te[0].localToLocal(te[3].x,te[3].y,te[0].parent);xe=[t.decimals(ke[0].x),t.decimals(ke[0].y),t.decimals(ke[1].x),t.decimals(ke[1].y),t.decimals(ae.x-ke[0].x),t.decimals(ae.y-ke[0].y),t.decimals(Ee.x-ke[0].x),t.decimals(Ee.y-ke[0].y)]}ke[4]&&ke[4]!=="mirror"&&xe.push(ke[4]),re.push(xe)}),re},set:function(){pt&&tt("Squiggle() - pointsAdjusted is read only")}}),Object.defineProperty(u,"pointObjects",{get:function(){return S},set:function(){pt&&tt("Squiggle() - pointObjects is read only - but its contents can be manipulated - use squiggle.update() after changes")}}),Object.defineProperty(u,"pointControls",{get:function(){return p},set:function(){pt&&tt("Squiggle() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(u,"pointCircles",{get:function(){return F},set:function(){pt&&tt("Squiggle() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(u,"segmentPoints",{get:function(){var re=[],xe=u.pointsAdjusted;return t.loop(xe.length-1,function(ke){var te=u.getSegmentPoint(xe[ke],xe[ke+1]);re.push(te)}),re},set:function(){pt&&tt("Squiggle() - segmentPoints is read only")}}),Object.defineProperty(u,"segmentRatios",{get:function(){var re=[],xe=0;t.loop(u.segmentPoints,function(pe){var he=t.distanceAlongCurve(pe);re.push(he),xe+=he});var ke=[],te=0;return t.loop(re,function(pe){var he=pe/xe;te+=he,ke.push(te)}),ke},set:function(){pt&&tt("Squiggle() - segmentRatios is read only")}}),u.approximateBounds=function(re,xe,ke){n(re)&&(re=80),n(ke)&&(ke=0),re/=u.num;var te=u.interpolate(re,null,!0,null,!0),pe=t.boundsAroundPoints(te);if(u.setBounds(pe.x-ke,pe.y-ke,pe.width+ke*2,pe.height+ke*2),xe){if(!u.parent)return pt&&tt("approximateBounds() - add to stage to first to see points"),u;u.hitPathPoints?u.hitPathPoints.removeAllChildren():u.hitPathPoints=new t.Container().addTo(),u.hitPathPoints.top();for(var he=0;he<te.length;he++){var ae=te[he];ae=u.localToGlobal(ae.x,ae.y),new t.Circle(3).loc(ae.x,ae.y,u.hitPathPoints)}}return u},u.getPointAngle=function(re){var xe=u.pointObjects[re][0],ke=u.pointObjects[re][2],te=u.pointObjects[re][3],pe,he;return xe==u.stage?(pe=new t.Point(ke.x,ke.y),he=new t.Point(te.x,te.y)):(pe=xe.localToGlobal(ke.x,ke.y),he=xe.localToGlobal(te.x,te.y)),t.angle(pe.x,pe.y,he.x,he.y)},u.getSegmentPoint=function(re,xe){if(!(n(re)||n(xe))){(re[2]!=0||re[3]!=0)&&(re[4]-=re[2],re[5]-=re[3],re[6]-=re[2],re[7]-=re[3],re[0]+=re[2],re[1]+=re[3],re[2]=0,re[3]=0),(xe[2]!=0||xe[3]!=0)&&(xe[4]-=xe[2],xe[5]-=xe[3],xe[6]-=xe[2],xe[7]-=xe[3],xe[0]+=xe[2],xe[1]+=xe[3],xe[2]=0,xe[3]=0);var ke={x:re[0],y:re[1]},te={x:re[0]+re[6],y:re[1]+re[7]},pe={x:xe[0]+xe[4],y:xe[1]+xe[5]},he={x:xe[0],y:xe[1]};return(z.x!=0||z.y!=0)&&(ke.x+=z.x,te.x+=z.x,pe.x+=z.x,he.x+=z.x,ke.y+=z.y,te.y+=z.y,pe.y+=z.y,he.y+=z.y),[ke,te,pe,he]}},u.getAdjacentSegmentData=function(re){n(re)&&(re=0);var xe=u.pointsAdjusted;return u.num==2?[[u.getSegmentPoint(xe[0],xe[1])],[0]]:re==0?[[u.getSegmentPoint(xe[0],xe[1]),u.getSegmentPoint(xe[1],xe[2])],[0,1]]:re>=u.num-2?[[u.getSegmentPoint(xe[u.num-3],xe[u.num-2]),u.getSegmentPoint(xe[u.num-2],xe[u.num-1])],[u.num-3,u.num-2]]:[[u.getSegmentPoint(xe[re-1],xe[re]),u.getSegmentPoint(xe[re],xe[re+1]),u.getSegmentPoint(xe[re+1],xe[re+2])],[re-1,re,re+1]]},u.getCurvePoint=function(re,xe,ke,te,pe){(n(re)||isNaN(re))&&(re=0),n(xe)&&(xe=u.segmentRatios),n(ke)&&(ke=u.segmentPoints),n(te)&&(te=!1),n(pe)&&(pe=!1);var he=xe,ae=ke,Ee=t.loop(he,function(Me,_e){if(Me>=re)return _e}),ie=Ee>0?he[Ee-1]:0,Se=Ee>0?he[Ee]-he[Ee-1]:he[Ee];if(Se){var Le=(re-ie)/Se,Ce=t.pointAlongCurve(ae[Ee],Le,te,!0),ee=u.localToGlobal(Ce.x,Ce.y);return ee.angle=Ce.angle,ee.z=Ee,n(ee)?void 0:ee}};function le(re,xe,ke){return{x:re.x+(xe.x-re.x)*ke,y:re.y+(xe.y-re.y)*ke}}function Ae(re,xe,ke,te,pe,he,ae,Ee){var ie=re.length-1,Se=0,Le=0;te==100&&u.type=="Squiggle"&&(te=99.99),te=(te+1e5)%100,t.loop(ke,function(Pe,oe){if(te/100<Pe)return ie=oe,Le=Pe,!0;Se=Pe});var Ce=u.segmentPoints[ie],ee=Le>0?(te/100-Se)/(Le-Se):0,Me=t.pointAlongCurve(Ce,ee,null,Ee),_e=[Me.x,Me.y,0,0];if(!he){if(ae){u.interpolatedPoints.push({x:Me.x,y:Me.y,r:te/100});return}if(pe!="none"){var Ye=le(Ce[0],Ce[1],ee),je=le(Ce[1],Ce[2],ee),it=le(Ce[2],Ce[3],ee),Be=le(Ye,je,ee),qe=le(je,it,ee);_e[4]=Be.x-Me.x,_e[5]=Be.y-Me.y,_e[6]=qe.x-Me.x,_e[7]=qe.y-Me.y;var et=u.localToLocal(Ye.x,Ye.y,xe[ie]);re[ie][6]=et.x,re[ie][7]=et.y;var ve=u.localToLocal(it.x,it.y,xe[(ie+1)%re.length]);re[(ie+1)%re.length][4]=ve.x,re[(ie+1)%re.length][5]=ve.y}pe&&(_e[8]=pe),re.splice(ie+1,0,_e)}}this.addPoint=function(re,xe){n(re)&&(re=100);var ke=u.points,te=u.segmentRatios,pe=u.pointControls;return xe=xe||ne,Ae(ke,pe,te,re,xe),u.points=ke,u.num=ke.length,u},this.removePoint=function(re){if(!(n(re)||re<0)){var xe=t.copy(u.points);return xe.splice(re,1),u.points=xe,u.stage&&u.stage.update(),u}},this.addPoints=function(re,xe,ke,te,pe,he,ae){n(he)&&(he=t.copy(u.points));var Ee=t.copy(u.segmentRatios),ie=0;if(pe&&(u.interpolatedPoints=[]),te)var Se=Ee.length*re;return t.loop(Ee,function(Le,Ce){pe&&Ae(he,u.pointControls,u.segmentRatios,ie*100,xe,!n(ke)&&Ce!=ke,pe,ae);var ee=te?Math.round(Se*(Le-ie)):re,Me=1/(ee+1);t.loop(ee,function(_e){var Ye=ie+(Le-ie)*Me*(_e+1);Ae(he,u.pointControls,u.segmentRatios,Ye*100,xe,!n(ke)&&Ce!=ke,pe,ae),!pe&&re>0&&(u.points=he)}),ie=Le}),pe&&u.type=="Squiggle"&&Ae(he,u.pointControls,u.segmentRatios,100,xe,!1,pe,ae),u.stage&&u.stage.update(),u.num=he.length,u},this.interpolate=function(re,xe,ke,te,pe){return n(re)&&(re=1),u.addPoints(re,"none",xe,ke,!0,te,pe),u.interpolatedPoints},J&&u.approximateBounds(),this.dispose=function(re,xe,ke){if(u.shape){if(t.gD(u),o&&u.toggleStageEvent&&o.off("stagemousedown",u.toggleStageEvent),u.controls.noDrag(),u.controls.removeAllEventListeners(),u.selectPoints&&u.selectionManager&&u.selectionManager.dispose(),u.selectedBalls=null,u.selectedRect1s=null,u.selectedRect2s=null,u.selectionManager=null,u.off("mousedown",u.toggleEvent),u.off("click",u.clickEvent),re){u.shape.dispose(),u.shape=null;for(var te=0;te<u.points.length;te++)u.pointObjects[te][0].removeAllEventListeners(),u.pointObjects[te][1].removeAllEventListeners(),u.pointObjects[te][2].removeAllEventListeners(),u.pointObjects[te][3].removeAllEventListeners();u.controls.removeFrom(u),u.sticks.dispose(),S=null,F=null}else u.removeAllEventListeners(),S=null,F=null,ke||this.zimCustomShape_dispose(!0);return!0}}},t.extend(t.Squiggle,t.CustomShape,["clone","dispose"],"zimCustomShape",!1),t.Blob=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I){var X="color, borderColor, borderWidth, points, radius, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",R;if(R=st(t.Blob,arguments,X,this))return R;De("53.5"),this.group=$;var q=m===!1?{}:t.getStyle("Blob",this.group,I);n(a)&&(a=q.radius!=null?q.radius:100),this.zimCustomShape_constructor(-a,-a,a*2,a*2,!1),this.type="Blob",this.mouseChildren=!0,n(E)&&(E=q.dashed!=null?q.dashed:!1),n(r)&&(r=q.borderColor!=null?q.borderColor:null),n(i)&&(i=q.borderWidth!=null?q.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(e)&&(e=q.color!=null?q.color:i>0?"rgba(0,0,0,0)":t.green),e.style&&(this.colorCommand=e,e=t.black),r&&r.style&&(this.borderColorCommand=r,r=t.black),n(l)&&(l=q.points!=null?q.points:4);var J=typeof l!="number",Z=typeof l=="number"?l:l.length,ne=s;n(s)&&(s=q.controlLength!=null?q.controlLength:a*4/Z),n(f)&&(f=q.controlType!=null?q.controlType:null);var U=f;n(f)&&(f="straight"),n(c)&&(c=q.lockControlType!=null?q.lockControlType:!1),n(_)&&(_=q.interactive!=null?q.interactive:!0),n(x)&&(x=q.showControls!=null?q.showControls:_);var B=x;n(k)&&(k=q.lockControls!=null?q.lockControls:!_),n(v)&&(v=q.handleSize!=null?q.handleSize:t.mobile()?20:10),n(g)&&(g=q.allowToggle!=null?q.allowToggle:_),n(b)&&(b=q.move!=null?q.move:_),n(T)&&(T=q.circleColor!=null?q.circleColor:t.light),n(h)&&(h=q.circleBorderColor!=null?q.circleBorderColor:t.dark),n(w)&&(w=q.stickColor!=null?q.stickColor:t.darker),n(P)&&(P=q.stickThickness!=null?q.stickThickness:1),n(y)&&(y=q.selectColor!=null?q.selectColor:t.white),n(C)&&(C=q.selectPoints!=null?q.selectPoints:_),this.circleColor=T,this.circleBorderColor=h,this.stickColor=w,this.stickThickness=P,n(A)&&(A=q.onTop!=null?q.onTop:!0),n(O)&&(O=q.editPoints!=null?q.editPoints:_),n(Y)&&(Y=q.strokeObj!=null?q.strokeObj:{});var d=u(e,r);this.veeObj={color:d[0],borderColor:d[1]};function u(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r);var o=this;this.interactive=_,this.num=Z,this.editPoints=O,this.selectPoints=C,this.lockControls=k,this.onTop=A,this.move=b,this.allowToggle=g,this.lockControlType=c,this.types=["mirror","straight","free","none"];var S,F,p;o._color=e,o._borderColor=r,o._borderWidth=i,o._dashed=E,o._dashed&&!Array.isArray(o._dashed)&&(o._dashed=[10,10]);var L,we,D,N,ue,fe=o.move,V=2,z,se;l=Oe(l);function Oe(te){(te=="circle"||te=="rectangle"||te=="triangle")&&(te=="circle"&&(te=new t.Circle(a)),te=="rectangle"&&(te=new t.Rectangle(a*2,a*2).centerReg({add:!1})),te=="triangle"&&(te=new t.Triangle(a*2,a*2,a*2)));var pe;if(te.type=="Circle"||te.type=="Rectangle"||te.type=="Triangle"||te.type=="Flare"){var he=te.getBounds();if(te.type=="Circle")pe=4,ne=s=a*2*.5523;else if(te.type=="Rectangle")te.centerReg({add:!1}),pe=[[he.x-he.width/2,he.y-he.height/2],[he.x+he.width/2,he.y-he.height/2],[he.x+he.width/2,he.y+he.height/2],[he.x-he.width/2,he.y+he.height/2]],o.setBounds(he.x-he.width/2,he.y-he.height/2,he.width,he.height),o.regX=te.regX-he.width/2,o.regY=te.regY-he.height/2;else if(te.type=="Triangle")pe=[[te.three.x-te.width/2,te.three.y+te.height/2+te.adjusted],[te.two.x-te.width/2,te.two.y+te.height/2+te.adjusted],[te.one.x-te.width/2,te.one.y+te.height/2+te.adjusted]],o.setBounds(he.x-he.width/2,he.y-he.height/2,he.width,he.height);else if(te.type=="Flare"){var ae=he.width/2+he.x,Ee=he.height/2+he.y;pe=[];var ie=t.copy(te.points),Se={x:null,y:null};t.loop(ie,(Le,Ce)=>{var ee=Math.round(Le.x),Me=Math.round(Le.y);ee==Se.x&&Me==Se.y||(Se={x:ee,y:Me},pe.push([ee-ae,Le.y-Ee]))}),o.setBounds(-te.width/2,-te.height/2,te.width,te.height)}return pe}else return te}if(typeof l=="string"){var K=new t.SVGContainer;l=K.processPath(l),l[0][0]==l[l.length-1][0]&&l[0][1]==l[l.length-1][1]&&(l[0][4]=l[l.length-1][4],l[0][5]=l[l.length-1][5],l.pop())}U&&typeof l!="number"&&t.loop(l,function(te){te[8]=U,U=="none"&&(te[4]=te[5]=te[6]=te[7]=0)}),ge();function ge(){if(se&&se.removeAllEventListeners(),o.selectPoints?(o.selectedBalls=new t.SelectionSet,o.selectedRect1s=new t.SelectionSet,o.selectedRect2s=new t.SelectionSet,o.selectionManager=new t.SelectionManager([o.selectedBalls,o.selectedRect1s,o.selectedRect2s],"ctrl",!1)):o.selectionManager=new t.SelectionManager(null,"ctrl"),Z=typeof l=="number"?l:l.length,Z<=0)return;n(ne)&&(s=a*4/Z),L=o.shape=new t.Shape({style:!1}).addTo(o);var te=o.sticks=new t.Shape({style:!1}).addTo(o);v<=0&&te.removeFrom();var pe=L.graphics;pe.c();var he=te.graphics;he.c();var ae=v/10*8,Ee=v,ie=t.mobile();se=o.controls=new t.Container({style:!1}).addTo(o),o.interactive&&se.drag({onTop:!ie}),S=[],p=[],F=[];var Se,Le,Ce,ee,Me,_e,Ye,je,it;for(Se=0;Se<Z;Se++){if(ee=new t.Container({style:!1}).addTo(se),ee.num=Se,typeof l=="number"){var Be=t.Pick.choose(s);Ce=new t.Container(Be,a,null,null,!1).reg(Be/2,a).addTo(o),Ce.rotation=Se/Z*360,Ye=new t.Circle(ae,o.selectPoints&&o.selectedBalls.isSelected(Se)?y:o.circleColor,o.circleBorderColor,2,null,null,null,null,!1).centerReg(Ce).loc({x:Be/2,y:0}),Me=new t.Rectangle(Ee,Ee,o.selectPoints&&o.selectedRect1s.isSelected(Se)?y:Ze(f),v==0?null:t.dark,v==0?null:2,null,null,null,null,!1).centerReg(Ce).loc({x:0,y:0}),_e=new t.Rectangle(Ee,Ee,o.selectPoints&&o.selectedRect2s.isSelected(Se)?y:Ze(f),v==0?null:t.dark,v==0?null:2,null,null,null,null,!1).centerReg(Ce).loc({x:Be,y:0});var qe=Ce.localToLocal(Ye.x,Ye.y,se);Ye.x=qe.x,Ye.y=qe.y,Ye.addTo(ee,null,!1);var et=Ce.localToLocal(Me.x,Me.y,se);Me.x=f=="none"?0:et.x-Ye.x,Me.y=f=="none"?0:et.y-Ye.y,Me.addTo(ee,null,!1);var ve=Ce.localToLocal(_e.x,_e.y,se);_e.x=f=="none"?0:ve.x-Ye.x,_e.y=f=="none"?0:ve.y-Ye.y,_e.addTo(ee,null,!1),ee.x=Ye.x,ee.y=Ye.y,Ye.x=0,Ye.y=0,f=="none"&&Ye.addTo(ee,null,!1)}else it=l[Se],je=it[8]?it[8]:f,ee.loc({x:it[0],y:it[1]}),Ye=new t.Circle(ae,o.circleColor,o.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(ee).loc({x:it[2],y:it[3]}),Me=new t.Rectangle(Ee,Ee,Ze(je),v==0?null:t.dark,v==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(ee,0).loc({x:it[4],y:it[5]}),_e=new t.Rectangle(Ee,Ee,Ze(je),v==0?null:t.dark,v==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(ee,0).loc({x:it[6],y:it[7]});Ye.mySet=ee,Ye.rect1=Me,Ye.rect2=_e,Ye.index=Se,v==0&&(Ye.expand(10),Me.expand(10),_e.expand(10)),ie?Ye.on("mousedown",oe):Ye.on("dblclick",Fe),Me.ball=Ye,Me.other=_e,_e.ball=Ye,_e.other=Me,ie&&(Ye.expand(),Me.expand(),_e.expand()),Le=[ee,Ye,Me,_e,it?it[8]:f],S.push(Le),F.push(Ye),p.push(ee)}var Pe=!1;function oe(be){Pe?(be.preventDefault(),Fe(be)):(Pe=!0,setTimeout(function(){Pe=!1},300))}function Fe(be){if(!o.lockControlType){var Te=be.target,Re=S[Te.index][4]?S[Te.index][4]:f;Math.abs(Te.rect1.x)<=2&&Math.abs(Te.rect1.y)<=2&&Math.abs(Te.rect2.x)<=2&&Math.abs(Te.rect2.y)<=2&&(Re="none"),Re=="none"&&Te.parent.addChildAt(Te,0),Re=o.types[(o.types.indexOf(Re)+(o.shiftKey?-1:1)+o.types.length)%o.types.length],Re=="none"&&(Te.rect1.x=Te.rect1.y=Te.rect2.x=Te.rect2.y=0,Te.parent.addChild(Te),be.stopImmediatePropagation()),S[Te.index][4]=Re,Te.rect1.color=Ze(Re),Te.rect2.color=Ze(Re),o.drawShape();var Ne=new Ge.Event("change");Ne.controlType="bezierSwitch",o.dispatchEvent(Ne),Te.stage.update()}}function Ze(be){var Te={mirror:"#993399",free:"#ebcb35",none:"#50c4b7"};return Te[be]?Te[be]:"#e472c4"}o.drawShape=function(){var be,Te,Re,Ne,Ue,rt,me,He,at,Qe,ct,ot,dt;pe.c(),o.colorCommand||(o.colorCommand=pe.f(o._color).command,e&&e.type&&o.specialColor(o.colorCommand,e,o)),(n(o._borderWidth)||o._borderWidth>0)&&(!n(o._borderColor)||!n(o._borderWidth))&&(n(o._borderColor)&&(o._borderColor=t.black),o.borderColorCommand||(o.borderColorCommand=pe.s(o._borderColor).command,o._borderColor&&o._borderColor.type&&o.specialColor(o.borderColorCommand,o._borderColor,o)),o.borderWidthCommand||(o.borderWidthCommand=pe.ss(o._borderWidth,Y.caps,Y.joints,Y.miterLimit,Y.ignoreScale).command),o._dashed&&(o.borderDashedCommand||(o.borderDashedCommand=pe.sd(Array.isArray(o._dashed)?o._dashed:[10,10],o._dashedOffset).command))),Re=S[0][0],me=Re.localToLocal(S[0][1].x,S[0][1].y,L),pe.mt(me.x,me.y),he.c().s(o.stickColor).ss(o.stickThickness);for(var $e=0;$e<S.length;$e++)be=$e,Te=($e+1)%S.length,Re=S[be][0],Ye=S[be][1],Ne=S[be][2],Ue=S[be][3],rt=S[Te][0],He=S[Te][1],at=S[Te][2],ct=Re.localToLocal(Ue.x,Ue.y,L),ot=rt.localToLocal(at.x,at.y,L),dt=rt.localToLocal(He.x,He.y,L),pe.bt(ct.x,ct.y,ot.x,ot.y,dt.x,dt.y),me=Re.localToLocal(Ye.x,Ye.y,L),Qe=Re.localToLocal(Ne.x,Ne.y,L),he.mt(me.x,me.y).lt(Qe.x,Qe.y),he.mt(me.x,me.y).lt(ct.x,ct.y);pe.cp(),pe.append(o.colorCommand),o._dashed&&pe.append(o.borderDashedCommand),o.borderWidthCommand&&pe.append(o.borderWidthCommand),o.borderColorCommand&&pe.append(o.borderColorCommand)},o.drawShape(),e.type&&(o.color=e);var Xe;se.on("mousedown",function(be){if(!o.lockControls){o.selectPoints&&(o.keyFocus=!0),Xe={x:be.target.x,y:be.target.y};var Te;if(be.target.rect1)Te=be.target,Te.startX=Te.x,Te.startY=Te.y,Te.rect1.startX=Te.rect1.x,Te.rect1.startY=Te.rect1.y,Te.rect2.startX=Te.rect2.x,Te.rect2.startY=Te.rect2.y;else{var Re=be.target;Re.startX=Re.x,Re.startY=Re.y,Te=Re.ball;var Ne=Te.index,Ue=f;if(n(S[Ne][4])||(Ue=S[Ne][4]),Ue=="straight"){var rt=Re.other,me=rt.x-Te.x,He=rt.y-Te.y;rt.stickLength=Math.sqrt(Math.pow(me,2)+Math.pow(He,2))}}if(o.selectPoints){var at=o.selectionManager.currentSet;if(at&&at.selections&&at.selections.length>0)for(var Qe=0;Qe<at.selections.length;Qe++){var ct=o.pointObjects[at.selections[Qe]];ct[1].startX=ct[1].x,ct[1].startY=ct[1].y,ct[2].startX=ct[2].x,ct[2].startY=ct[2].y,ct[3].startX=ct[3].x,ct[3].startY=ct[3].y}}}}),o.selectPoints&&se.tap(function(be){var Te;if(be.target.rect1)Te=be.target,o.selectedBalls.toggle(Te.parent.num);else{var Re=be.target;Re.color="white",Te=Re.ball,Te.rect1==Re?o.selectedRect1s.toggle(Te.parent.num):o.selectedRect2s.toggle(Te.parent.num)}for(var Ne=0;Ne<o.pointObjects.length;Ne++){var Ue=o.pointObjects[Ne];Ue[1].color=o.selectedBalls.isSelected(Ne)?y:o.circleColor,Ue[2].color=o.selectedRect1s.isSelected(Ne)?y:Ze(Ue[4]),Ue[3].color=o.selectedRect2s.isSelected(Ne)?y:Ze(Ue[4])}be.target.stage.update()}),se.on("pressmove",function(be){if(!o.lockControls)if(o.selectPoints){var Te=Q();if(Te.indexOf(be.target)==-1)z(be.target),o.drawShape();else if(Te.length>0){for(var Re=be.target.x-be.target.startX,Ne=be.target.y-be.target.startY,Ue=0;Ue<Te.length;Ue++){var rt=Te[Ue];rt.x=rt.startX+Re,rt.y=rt.startY+Ne,z(rt)}o.drawShape()}}else z(be.target),o.drawShape()}),se.on("pressup",function(be){if(!o.lockControls){var Te=be.target.x!=Xe.x||be.target.y!=Xe.y,Re=new Ge.Event("change");be.target.rect1?(Re.controlType="bezierPoint",We(be.target)):Re.controlType="bezierHandle",Te&&o.dispatchEvent(Re)}});function We(be){if(o.selectPoints){var Te=Q();if(Te&&Te.indexOf(be)==-1)ce(be);else if(Te&&Te.length>0)for(var Re=0;Re<Te.length;Re++)ce(Te[Re]);else ce(be)}else ce(be)}o.changeControl=function(be,Te,Re,Ne,Ue,rt,me,He,at){var Qe="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",ct;if(ct=st(o.changeControl,arguments,Qe))return ct;if(n(be)){for(var ot=0;ot<S.length;ot++)o.changeControl(ot,Te,Re,Ne,Ue,rt,me,He);return o}var dt=S[be];return dt[4]=Te,Te=="none"?(n(me)||(dt[1].x=me),n(He)||(dt[1].y=He),dt[2].x=dt[1].x,dt[2].y=dt[1].y,dt[3].x=dt[1].x,dt[3].y=dt[1].y,dt[1].parent.addChild(dt[1])):(n(me)||(dt[1].x=me),n(He)||(dt[1].y=He),n(Re)||(dt[2].x=Re),n(Ne)||(dt[2].y=Ne),n(Ue)||(dt[3].x=Ue),n(rt)||(dt[3].y=rt),dt[1].parent.addChildAt(dt[1],0)),dt[2].color=Ze(Te),dt[3].color=Ze(Te),at&&(o.update(),o.stage&&o.stage.update()),o},o.transformPoints=function(be,Te,Re,Ne,Ue){return n(Ue)&&(Ue=!0),o.points=t.transformPoints(o.points,be,Te,Re,Ne),Ue&&o.approximateBounds(),o},o.traverse=function(be,Te,Re,Ne,Ue){var rt=t.copy(o.segmentRatios);rt.unshift(0),n(Re)&&(Re=Te+1);var me=rt[Te]*100,He=rt[Re]*100,at;!Ue&&me>He?at=100-me+He:!Ue&&me<He?at=He-me:Ue&&me>He?at=-(me-He):Ue&&me<He&&(at=-(100-He+me));var Qe=new Ge.Event("traversed");return Qe.obj=be,be.animate({ease:"linear",props:{path:o,startPercent:me,percent:at},time:Ne,call:function(){o.dispatchEvent(Qe)}}),o},o.reversePoints=function(be){return n(be)&&(be=!0),l=t.copy(o.points),l.reverse(),be&&l.unshift(l.pop()),t.loop(l,function(Te){var Re=Te[6];Te[6]=Te[4],Te[4]=Re;var Ne=Te[7];Te[7]=Te[5],Te[5]=Ne}),o.points=l,o.update(),o},o.splitPoints=function(be){var Te=t.copy(o.points);if(!(be<1||be>Te.length-1)){var Re=t.copy(Te.slice(0,be+1)),Ne=t.copy(Te.slice(be));t.trimPointEnds(Re),t.trimPointEnds(Ne);var Ue=o.clone();return o.points=Re,o.update(),Ue.points=Ne,o.parent&&Ue.addTo(o.parent),Ue}},o.makeSquiggle=function(be){var Te=t.copy(o.points);n(be)&&(be=0),be=(be+Te.length*1e3)%Te.length;var Re=t.copy(Te.slice(be)),Ne=t.copy(Te.slice(0,be+1));Te=Re.concat(Ne),t.trimPointEnds(Te);var Ue=new t.Squiggle({points:Te,color:o.borderColor,thickness:o.borderWidth,showControls:o.controlsVisible,interactive:o.interactive,onTop:o.onTop,dashed:o.dashed,stickColor:o.stickColor,stickThickness:o.stickThickness});return Ue},o.update=function(be){return be?o.points=o.pointsAdjusted:o.drawShape(),o.zimAnimateChanged=!0,o},o.move&&o.interactive&&L.drag({onTop:!1}),we=L.on("mousedown",function(be){ue=be.target.stage,Xe={x:L.x,y:L.y},o.selectPoints&&(o.keyFocus=!0),de()}),D=L.on("pressmove",function(){se.x=L.x,se.y=L.y,te.x=L.x,te.y=L.y}),N=L.on("pressup",function(){var be=L.x!=Xe.x||L.y!=Xe.y,Te=L.localToLocal(o.regX,o.regY,o.parent);if(o.x=Te.x,o.y=Te.y,se.x=se.y=te.x=te.y=L.x=L.y=0,be){var Re=new Ge.Event("change");Re.controlType="move",o.dispatchEvent(Re)}ue.update()}),b||le(!0);function de(){if(o.onTop){var be=o.parent.numChildren-1;o.parent.getChildAt(be).type=="Keyboard"&&be--,o.parent.setChildIndex(o,be)}}o.toggleEvent=o.on("mousedown",function(){o.allowToggle&&(B||(o.showControls(),o.dispatchEvent("controlsshow")))}),o.added(function(){ue=o.stage,o.toggleStageEvent&&o.stage.off("stagemousedown",o.toggleStageEvent),o.toggleStageEvent=o.stage.on("stagemousedown",function(be){!o.allowToggle||!o.stage||B&&!o.hitTestPoint(be.stageX/t.scaX,be.stageY/t.scaY,!1)&&(o.hideControls(),o.dispatchEvent("controlshide"))})}),o.clickEvent=o.on("click",function(){o.ctrlKey&&setTimeout(function(){o.clone(!0).addTo(o.stage).mov(100),o.allowToggle&&(o.hideControls(),o.dispatchEvent("controlshide"));var be=new Ge.Event("change");be.controlType="move",o.dispatchEvent(be),o.stage.update()},50)}),o.hideControls=function(){return o.toggled=!1,se.visible=!1,te.visible=!1,B=!1,o.stage&&o.stage.update(),!o.allowToggle&&o.move&&le(),o},B||o.hideControls(),o.showControls=function(){return o.toggled=!0,se.visible=!0,te.visible=!0,B=!0,se.x=L.x,se.y=L.y,te.x=L.x,te.y=L.y,o.addChildAt(L,0),o.move&&!o.allowToggle&&G(),o.stage&&o.stage.update(),o},o.toggle=function(be){return be===!0?o.showControls():be===!1||B?o.hideControls():o.showControls(),o},o.recordData=function(be){n(be)&&(be=!1);var Te={type:"Blob",index:o.parent?o.parent.getChildIndex(o):-1,x:o.x,y:o.y,points:o.getPoints(),color:o.color,borderColor:o.borderColor,borderWidth:o.borderWidth,move:o.move,allowToggle:o.allowToggle,controlsVisible:B};return be?JSON.stringify(Te):Te},o.setData=function(be,Te){if(!n(be)){if(Te)try{be=JSON.parse(be)}catch (e7){return}var Re=be.index;n(Re)&&(Re=-1),delete be.index;var Ne=be.points;n(Ne)||o.setPoints(Ne),delete be.points,this.num=Ne.length;for(var Ue in be)o[Ue]=be[Ue];return o.parent&&o.parent.setChildIndex(o,Re),o}},o.getPoints=function(be){n(be)&&(be=!1);var Te=o.points;if(be){if(!Re){var Re=o.pane=new t.Pane({displayClose:!1,container:o.stage,width:Math.min(500,o.stage.width-20),height:Math.min(500,o.stage.height-20),draggable:!0}),Ne=o.textArea=new t.TextArea(Math.min(400,o.stage.width-70),Math.min(400,o.stage.height-70));Ne.centerReg(Re)}Re.show(),Ne.text=JSON.stringify(Te)}return Te},o.recordPoints=o.getPoints,o.setPoints=function(be){for(var Te,Re,Ne=0;Ne<be.length;Ne++)Te=S[Ne],Re=be[Ne],!n(Te)&&(Te[0].x=Re[0],Te[0].y=Re[1],Te[1].x=Re[2],Te[1].y=Re[3],Te[2].x=Re[4],Te[2].y=Re[5],Te[3].x=Re[6],Te[3].y=Re[7],Te[4]=Re[8],Te[2].color=Ze(Te[4]),Te[3].color=Ze(Te[4]));return o.update(),o},m!==!1&&t.styleTransforms(o,q),o.clone=function(be,Te){var Re=[],Ne=!1;t.loop(o.pointControls,function(rt){rt.scaleX+rt.scaleY+rt.regX+rt.regY+rt.rotation!=2&&(Ne=!0),Re.push([rt.scaleX,rt.scaleY,rt.regX,rt.regY,rt.rotation])});var Ue=o.cloneProps(new t.Blob(Te?o.colorCommand:be||!t.isPick(d[0])?o.color:d[0],Te?o.borderColorCommand:be||!t.isPick(d[1])?o.borderColor:d[1],o.borderWidth,o.getPoints(),a,s,f,c,se.visible,k,v,o.allowToggle,o.move,E,A,o.circleColor,o.circleBorderColor,o.stickColor,o.stickThickness,y,C,o.editPoints,_,Y,m,o.group,I));return Ne&&(t.loop(Ue.pointControls,function(rt,me){rt.scaleX=Re[me][0],rt.scaleY=Re[me][1],rt.regX=Re[me][2],rt.regY=Re[me][3],rt.rotation=Re[me][4]}),Ue.update()),o.linearGradientParams&&Ue.linearGradient.apply(Ue,o.linearGradientParams),o.radialGradientParams&&Ue.radialGradient.apply(Ue,o.radialGradientParams),Ue},o.shapeMousedownEvent=o.shape.on("mousedown",function(be){ue=be.target.stage,o.editPoints&&(o.controlsVisible?(o.pressX=be.stageX/t.scaX,o.pressY=be.stageY/t.scaY):(o.pressX=null,o.pressY=null))}),o.addPointFactor=10,o.addMinDistance=15,o.shapePressupEvent=o.shape.on("pressup",function(be){if(o.editPoints&&o.pressX&&Math.abs(o.pressX-be.stageX/t.scaX)<V&&Math.abs(o.pressY-be.stageY/t.scaY)<V){o.selectPoints&&(o.lastPoints=t.copy(o.points));var Te=o.points,Re=o.globalToLocal(be.stageX/t.scaX,be.stageY/t.scaY),Ne=t.closestPointAlongCurve(Re,o.segmentPoints);if(o.editPoints=="anywhere")Te.splice(Ne+1,0,[Re.x,Re.y,0,0,0,0,0,0]),o.points=Te,o.changeControl({index:Ne+1,type:"mirror",update:!0});else{var Ue=o.pointsAdjusted,rt=o.getSegmentPoint(Ue[Ne],Ue[(Ne+1)%Ue.length]),me=t.distanceAlongCurve(rt),He=Math.round(me/o.addPointFactor),at=o.interpolate(He,Ne,!1,Te),Qe=1e4,ct;if(t.loop(at,function(Mt,Ct){if(Ct!=0){var xt=t.dist(Mt,Re);xt<Qe&&(Qe=xt,ct=Ct)}}),Qe<o.addMinDistance){var ot=o.segmentRatios,dt=ot[Ne],$e=Ne>0?ot[Ne-1]:0;o.addPoint(100*($e+(dt-$e)*(ct/(He+1))))}}o.lastSelectedIndex=Ne+1,o.lastSelected=o.controls.getChildAt(o.lastSelectedIndex),o.stage.update()}}),o.controlsClickEvent=o.controls.on("click",function(be){o.lastSelected=be.target.parent,o.lastSelectedIndex=o.controls.getChildIndex(be.target.parent),o.editPoints&&o.selectionManager.shiftKey&&Ve(be)});function Ve(be){if(be.target.type=="Circle"){var Te=o.lastSelectedIndex=o.controls.getChildIndex(be.target.parent);if(o.controls.numChildren<=2)return;var Re=o.points;o.selectPoints&&(o.lastPoints=t.copy(Re)),Re.splice(Te,1),o.points=Re,o.stage.update(),o.lastSelected=o.lastSelectedIndex=null}}o.controls.hold(Ve),B||o.hideControls(),o.dispatchEvent("update")}function Q(){var te=[],pe=o.selectionManager.currentSet;if(pe&&pe.selections&&pe.selections.length>0)for(var he=0;he<pe.selections.length;he++){var ae=o.pointObjects[pe.selections[he]];if(pe==o.selectedBalls)te.push(ae[1]);else if(pe==o.selectedRect1s)te.push(ae[2]);else if(pe==o.selectedRect2s)te.push(ae[3]);else continue}return te}function ce(te){if(o.selectPoints&&te.type=="Circle"){var pe=te,he=pe.mySet,ae=pe.rect1,Ee=pe.rect2;ae.x-=pe.x,ae.y-=pe.y,Ee.x-=pe.x,Ee.y-=pe.y,he.x+=pe.x,he.y+=pe.y,pe.x=0,pe.y=0}}o.selectionManager.on("keydown",function(te){if(o.selectPoints&&o.keyFocus&&te.keyCode>=37&&te.keyCode<=40){var pe=Q();if(pe.length>0){for(var he=0;he<pe.length;he++){var ae=pe[he];te.keyCode==37?ae.x-=o.selectionManager.shiftKey?10:1:te.keyCode==39?ae.x+=o.selectionManager.shiftKey?10:1:te.keyCode==38?ae.y-=o.selectionManager.shiftKey?10:1:te.keyCode==40&&(ae.y+=o.selectionManager.shiftKey?10:1),z(ae)}o.drawShape(),o.dispatchEvent("update"),o.stage&&o.stage.update()}}}),o.selectionManager.on("keyup",function(te){if(o.selectPoints&&o.keyFocus&&te.keyCode>=37&&te.keyCode<=40){var pe=Q();if(pe.length>0)for(var he=0;he<pe.length;he++)ce(pe[he])}}),o.selectionManager.on("undo",function(){if(o.selectPoints&&o.keyFocus&&o.lastPoints){var te=t.copy(o.lastPoints);o.lastPoints=t.copy(o.points),o.points=te,o.stage&&o.stage.update()}}),z=function(te){if(!o.lockControls){var pe;if(te.rect1){pe=te;var he=pe.x-pe.startX,ae=pe.y-pe.startY;pe.rect1.x=pe.rect1.startX+he,pe.rect1.y=pe.rect1.startY+ae,pe.rect2.x=pe.rect2.startX+he,pe.rect2.y=pe.rect2.startY+ae}else{var Ee=te,ie=Ee.other;pe=Ee.ball;var Se=pe.index,Le=f;if(n(S[Se][4])||(Le=S[Se][4]),Le=="straight"||Le=="mirror"){var Ce=Ee.x-pe.x,ee=Ee.y-pe.y;if(Le=="mirror")ie.x=pe.x-Ce,ie.y=pe.y-ee;else{var Me=Math.atan2(ee,Ce),_e=-ie.stickLength*Math.cos(Me+Math.PI),Ye=-ie.stickLength*Math.sin(Me+Math.PI);ie.x=pe.x-_e,ie.y=pe.y-Ye}}}}},Object.defineProperty(o,"move",{get:function(){return b},set:function(te){b!=te&&(b=te,te?G():le())}}),Object.defineProperty(o,"interactive",{get:function(){return _},set:function(te){_=te,B=_,o.allowToggle=_,o.editPoints=_,o.lockControls=!_,o.selectPoints=_,o.move=_;var pe=o.points;o.points=pe}}),Object.defineProperty(o,"allowToggle",{get:function(){return g},set:function(te){g!=te&&(g=te,g?o.move&&G():!B&&o.move&&le())}});function G(){o.move!="always"&&(fe||(fe=!0,L.drag({onTop:!1}),we=L.on("mousedown",we),D=L.on("pressmove",D),N=L.on("pressup",N)))}function le(te){o.move!="always"&&(!te&&!fe||(fe=!1,L.noDrag(),L.off("mousedown",we),L.off("pressmove",D),L.off("pressup",N)))}Object.defineProperty(o,"controlsVisible",{get:function(){return B},set:function(te){B=te,te?o.showControls():o.hideControls()}});var Ae=k;Object.defineProperty(o,"lockControls",{get:function(){return Ae},set:function(te){Ae=te,te?(o.controls.mouseChildren=!1,o.controls.mouseEnabled=!1):(o.controls.mouseChildren=!0,o.controls.mouseEnabled=!0)}}),o.lockControls=Ae,j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==o},set:function(){t.KEYFOCUS=o}}),o.selectPoints&&!t.KEYFOCUS&&re();function re(){o.keyFocus=!0;var te=document.activeElement;te&&te.blur()}Object.defineProperty(o,"points",{get:function(){for(var te=[],pe,he,ae=0;ae<S.length;ae++)he=S[ae],pe=[t.decimals(he[0].x),t.decimals(he[0].y),t.decimals(he[1].x),t.decimals(he[1].y),t.decimals(he[2].x),t.decimals(he[2].y),t.decimals(he[3].x),t.decimals(he[3].y)],he[4]&&he[4]!=="straight"&&pe.push(he[4]),te.push(pe);return te},set:function(te){var pe=o.x,he=o.y,ae=o.visible,Ee=[],ie=!1;t.loop(o.pointControls,function(Se){Se.scaleX+Se.scaleY+Se.regX+Se.regY+Se.rotation!=2&&(ie=!0),Ee.push([Se.scaleX,Se.scaleY,Se.regX,Se.regY,Se.rotation])}),o.dispose(!0),l=Oe(te),o.shape&&(o.shape.graphics.clear(),o.sticks.graphics.clear(),o.controls.noDrag(),o.removeAllChildren(),delete o.shape,delete o.sticks,delete o.controls),o.visible=!1,ge(),o.lockControls=Ae,o.x=pe,o.y=he,o.visible=ae,ie&&(t.loop(o.pointControls,function(Se,Le){Se.scaleX=Ee[Le][0],Se.scaleY=Ee[Le][1],Se.regX=Ee[Le][2],Se.regY=Ee[Le][3],Se.rotation=Ee[Le][4]}),o.update())}}),Object.defineProperty(o,"pointsAdjusted",{get:function(){var te=[],pe,he,ae,Ee=o.pointObjects;return t.loop(Ee.length,function(ie){if(ae=Ee[ie],he=S[ie],ae[0].rotation==0&&ae[0].scaleX==0&&ae[0].scaleY==0)pe=[t.decimals(he[0].x),t.decimals(he[0].y),t.decimals(he[1].x),t.decimals(he[1].y),t.decimals(he[2].x),t.decimals(he[2].y),t.decimals(he[3].x),t.decimals(he[3].y)];else{var Se=ae[0].localToLocal(ae[2].x,ae[2].y,ae[0].parent),Le=ae[0].localToLocal(ae[3].x,ae[3].y,ae[0].parent);pe=[t.decimals(he[0].x),t.decimals(he[0].y),t.decimals(he[1].x),t.decimals(he[1].y),t.decimals(Se.x-he[0].x),t.decimals(Se.y-he[0].y),t.decimals(Le.x-he[0].x),t.decimals(Le.y-he[0].y)]}he[4]&&he[4]!=="mirror"&&pe.push(he[4]),te.push(pe)}),te},set:function(){pt&&tt("Blob() - pointsAdjusted is read only")}}),Object.defineProperty(o,"pointObjects",{get:function(){return S},set:function(){pt&&tt("Blob() - pointObjects is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"pointControls",{get:function(){return p},set:function(){pt&&tt("Blob() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"pointCircles",{get:function(){return F},set:function(){pt&&tt("Blob() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"segmentPoints",{get:function(){var te=o.pointsAdjusted,pe=[];return t.loop(te.length,function(he,ae){var Ee=o.getSegmentPoint(te[he],te[he<ae-1?he+1:0]);pe.push(Ee)}),pe},set:function(){pt&&tt("Blob() - segmentPoints is read only")}}),Object.defineProperty(o,"segmentRatios",{get:function(){var te=[],pe=0;t.loop(o.segmentPoints,function(Ee){var ie=t.distanceAlongCurve(Ee);te.push(ie),pe+=ie});var he=[],ae=0;return t.loop(te,function(Ee){var ie=Ee/pe;ae+=ie,he.push(ae)}),he},set:function(){pt&&tt("Blob() - segmentRatios is read only")}}),o.approximateBounds=function(te,pe){n(te)&&(te=80),te/=o.num;var he=o.interpolate(te,null,!0,null,!0),ae=t.boundsAroundPoints(he);if(o.setBounds(ae.x,ae.y,ae.width,ae.height),pe){if(!o.parent)return pt&&tt("approximateBounds() - add to stage to first to see points"),o;o.hitPathPoints?o.hitPathPoints.removeAllChildren():o.hitPathPoints=new t.Container().addTo(),o.hitPathPoints.top();for(var Ee=0;Ee<he.length;Ee++){var ie=he[Ee];ie=o.localToGlobal(ie.x,ie.y),new t.Circle(3).loc(ie.x,ie.y,o.hitPathPoints)}}return o},o.getPointAngle=function(te){var pe=o.pointObjects[te][0],he=o.pointObjects[te][2],ae=o.pointObjects[te][3],Ee,ie;return pe==o.stage?(Ee=new t.Point(he.x,he.y),ie=new t.Point(ae.x,ae.y)):(Ee=pe.localToGlobal(he.x,he.y),ie=pe.localToGlobal(ae.x,ae.y)),t.angle(Ee.x,Ee.y,ie.x,ie.y)},o.getSegmentPoint=function(te,pe){if(!(n(te)||n(pe))){(te[2]!=0||te[3]!=0)&&(te[4]-=te[2],te[5]-=te[3],te[6]-=te[2],te[7]-=te[3],te[0]+=te[2],te[1]+=te[3],te[2]=0,te[3]=0),(pe[2]!=0||pe[3]!=0)&&(pe[4]-=pe[2],pe[5]-=pe[3],pe[6]-=pe[2],pe[7]-=pe[3],pe[0]+=pe[2],pe[1]+=pe[3],pe[2]=0,pe[3]=0);var he={x:te[0],y:te[1]},ae={x:te[0]+te[6],y:te[1]+te[7]},Ee={x:pe[0]+pe[4],y:pe[1]+pe[5]},ie={x:pe[0],y:pe[1]};return(se.x!=0||se.y!=0)&&(he.x+=se.x,ae.x+=se.x,Ee.x+=se.x,ie.x+=se.x,he.y+=se.y,ae.y+=se.y,Ee.y+=se.y,ie.y+=se.y),[he,ae,Ee,ie]}},o.getAdjacentSegmentData=function(te){n(te)&&(te=0);var pe=o.pointsAdjusted;if(o.num==2)return[[o.getSegmentPoint(pe[0],pe[1]),o.getSegmentPoint(pe[1],pe[0])],[0,1]];if(te==0)return[[o.getSegmentPoint(pe[o.num-1],pe[0]),o.getSegmentPoint(pe[0],pe[1]),o.getSegmentPoint(pe[1],pe[2])],[o.num-1,0,1]];if(te>=o.num-1)return[[o.getSegmentPoint(pe[o.num-2],pe[o.num-1]),o.getSegmentPoint(pe[o.num-1],pe[0]),o.getSegmentPoint(pe[0],pe[1])],[o.num-2,o.num-1,0]];var he=te+2>=o.num?0:te+2;return[[o.getSegmentPoint(pe[te-1],pe[te]),o.getSegmentPoint(pe[te],pe[te+1]),o.getSegmentPoint(pe[te+1],pe[he])],[te-1,te,te+1]]},o.getCurvePoint=function(te,pe,he,ae){n(pe)&&(pe=o.segmentRatios),n(he)&&(he=o.segmentPoints),n(ae)&&(ae=!1);var Ee=pe,ie=he,Se=t.loop(Ee,function(Ye,je){if(Ye>=te)return je}),Le=Se>0?Ee[Se-1]:0,Ce=Se>0?Ee[Se]-Ee[Se-1]:Ee[Se],ee=(te-Le)/Ce,Me=t.pointAlongCurve(ie[Se],ee,ae,!0);if(!n(Me)){var _e=o.localToGlobal(Me.x,Me.y);return _e.angle=Me.angle,_e.z=Se,n(_e)?void 0:_e}};function xe(te,pe,he){return{x:te.x+(pe.x-te.x)*he,y:te.y+(pe.y-te.y)*he}}function ke(te,pe,he,ae,Ee,ie,Se,Le){var Ce=te.length-1,ee=0,Me=0;ae==100&&o.type=="Squiggle"&&(ae=99.99),ae=(ae+1e5)%100,t.loop(he,function(Ze,Xe){if(ae/100<Ze)return Ce=Xe,Me=Ze,!0;ee=Ze});var _e=o.segmentPoints[Ce],Ye=Me>0?(ae/100-ee)/(Me-ee):0,je=t.pointAlongCurve(_e,Ye,null,Le),it=[je.x,je.y,0,0];if(!ie){if(Se){o.interpolatedPoints.push({x:je.x,y:je.y,r:ae/100});return}if(Ee!="none"){var Be=xe(_e[0],_e[1],Ye),qe=xe(_e[1],_e[2],Ye),et=xe(_e[2],_e[3],Ye),ve=xe(Be,qe,Ye),Pe=xe(qe,et,Ye);it[4]=ve.x-je.x,it[5]=ve.y-je.y,it[6]=Pe.x-je.x,it[7]=Pe.y-je.y;var oe=o.localToLocal(Be.x,Be.y,pe[Ce]);te[Ce][6]=oe.x,te[Ce][7]=oe.y;var Fe=o.localToLocal(et.x,et.y,pe[(Ce+1)%te.length]);te[(Ce+1)%te.length][4]=Fe.x,te[(Ce+1)%te.length][5]=Fe.y}Ee&&(it[8]=Ee),te.splice(Ce+1,0,it)}}this.addPoint=function(te,pe){n(te)&&(te=100);var he=o.points,ae=o.segmentRatios,Ee=o.pointControls;return pe=pe||U,ke(he,Ee,ae,te,pe),o.points=he,o.num=he.length,o},this.removePoint=function(te){if(!(n(te)||te<0)){var pe=t.copy(o.points);return pe.splice(te,1),o.points=pe,o.stage&&o.stage.update(),o}},this.addPoints=function(te,pe,he,ae,Ee,ie,Se){n(ie)&&(ie=t.copy(o.points));var Le=t.copy(o.segmentRatios),Ce=0;if(Ee&&(o.interpolatedPoints=[]),ae)var ee=Le.length*te;return t.loop(Le,function(Me,_e){Ee&&ke(ie,o.pointControls,o.segmentRatios,Ce*100,pe,!n(he)&&_e!=he,Ee,Se);var Ye=ae?Math.round(ee*(Me-Ce)):te,je=1/(Ye+1);t.loop(Ye,function(it){var Be=Ce+(Me-Ce)*je*(it+1);ke(ie,o.pointControls,o.segmentRatios,Be*100,pe,!n(he)&&_e!=he,Ee,Se),!Ee&&te>0&&(o.points=ie)}),Ce=Me}),Ee&&o.type=="Squiggle"&&ke(ie,o.pointControls,o.segmentRatios,100,pe,null,Ee,Se),o.stage&&o.stage.update(),o.num=ie.length,o},this.interpolate=function(te,pe,he,ae,Ee){return n(te)&&(te=1),o.addPoints(te,"none",pe,he,!0,ae,Ee),o.interpolatedPoints},J&&o.approximateBounds(),this.dispose=function(te,pe,he){if(o.shape){if(t.gD(o),ue&&o.toggleStageEvent&&ue.off("stagemousedown",o.toggleStageEvent),o.controls.noDrag(),o.controls.removeAllEventListeners(),o.selectPoints&&o.selectionManager&&o.selectionManager.dispose(),o.selectedBalls=null,o.selectedRect1s=null,o.selectedRect2s=null,o.selectionManager=null,o.off("mousedown",o.toggleEvent),o.off("click",o.clickEvent),te){o.shape.dispose(),o.shape=null;for(var ae=0;ae<o.points.length;ae++)o.pointObjects[ae][0].removeAllEventListeners(),o.pointObjects[ae][1].removeAllEventListeners(),o.pointObjects[ae][2].removeAllEventListeners(),o.pointObjects[ae][3].removeAllEventListeners();o.controls.removeFrom(o),o.sticks.dispose(),S=null,F=null}else o.removeAllEventListeners(),S=null,F=null,he||this.zimCustomShape_dispose(!0);return!0}}},t.extend(t.Blob,t.CustomShape,["clone","dispose"],"zimCustomShape",!1),gi= exports.Blob =t.Blob,t.Flare=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne){var U="color, borderColor, borderWidth, crossAngle, thickness, thicknessA, thicknessB, pin, startX, startY, lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close, dashed, strokeObj, spineColor, spineBorderWidth, spineBorderColor, spineDashed, spineStrokeObj, closeColor, closeBorderWidth, closeBorderColor, closeDashed, closeStrokeObj, style, group, inherit",B;if(B=st(t.Flare,arguments,U,this))return B;De("53.6"),this.zimContainer_constructor(),this.type="Flare",this.group=Z;var d=J===!1?{}:t.getStyle(this.type,this.group,ne),u=this;n(r)&&(r=d.borderColor!=null?d.borderColor:null),n(i)&&(i=d.borderWidth!=null?d.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(e)&&(e=d.color!=null?d.color:i>0?"rgba(0,0,0,0)":t.black),(n(i)||i>0)&&(!n(r)||!n(i))&&n(r)&&(r=t.black),n(l)&&(l=d.crossAngle!=null?d.crossAngle:0);var o=l;l-=90,n(a)&&(a=d.thickness!=null?d.thickness:null),n(s)&&(s=d.thicknessA!=null?d.thicknessA:null),n(f)&&(f=d.thicknessB!=null?d.thicknessB:null),n(a)?n(f)&&!n(s)?f=s:n(s)&&!n(f)?s=f:f=s=10:n(f)&&!n(s)?f=a-s:n(s)&&!n(f)?s=a-f:f=s=a/2,u.thickness=s+f,n(T)&&(T=d.cross!=null?d.cross:!0),n(h)&&(h=d.crossColors!=null?d.crossColors:null),!n(h)&&!Array.isArray(h)&&(h=[h]),n(w)&&(w=d.close!=null?d.close:!1),n(x)&&(x=d.startX!=null?d.startX:0),n(k)&&(k=d.startY!=null?d.startY:0),n(v)&&(v=d.lengths!=null?d.lengths:[200]),Array.isArray(v)||(v=[v]),n(g)&&(g=d.angles!=null?d.angles:[0]),Array.isArray(g)||(g=[g]),n(b)&&(b=d.anglesA!=null?d.anglesA:[10]),Array.isArray(b)||(b=[b]),n(E)&&(E=d.anglesB!=null?d.anglesB:t.copy(b)),Array.isArray(E)||(E=[E]),n(A)&&(A=d.anglesEnd!=null?d.anglesEnd:[0]),Array.isArray(A)||(A=[A]),n(y)&&(y=d.strokeObj!=null?d.strokeObj:{miterLimit:2}),n(_)&&(_=d.spineBorderColor!=null?d.spineBorderColor:null),n(O)&&(O=d.spineBorderWidth!=null?d.spineBorderWidth:null),_<0||O<0?_=O=null:_!=null&&O==null&&(O=1),n(C)&&(C=d.spineColor!=null?d.spineColor:O>0?"rgba(0,0,0,0)":t.black),n(Y)&&(Y=d.spineDashed!=null?d.spineDashed:null),n(m)&&(m=d.spineStrokeObj!=null?d.spineStrokeObj:{miterLimit:2}),(n(O)||O>0)&&(!n(_)||!n(O))&&n(_)&&(_=r||t.black),n(X)&&(X=d.closeBorderColor!=null?d.closeBorderColor:null),n(I)&&(I=d.closeBorderWidth!=null?d.closeBorderWidth:null),X<0||I<0?X=I=null:X!=null&&I==null&&(I=1),n($)&&($=d.closeColor!=null?d.closeColor:I>0?"rgba(0,0,0,0)":null),n(R)&&(R=d.closeDashed!=null?d.closeDashed:null),n(q)&&(q=d.closeStrokeObj!=null?d.closeStrokeObj:{miterLimit:2}),(n(I)||I>0)&&(!n(X)||!n(I))&&n(X)&&(X=r||t.black),this.thicknessA=s,this.thicknessB=f,this.cross=T,this.close=w,this.lengths=v,this.angles=g,this.anglesA=b,this.anglesB=E,this.anglesEnd=A,this.crossColors=h,S(v,g,b,E,A,T,h,w),e.type&&(u.color=e);function S(D,N,ue,fe,V,z,se,Oe){u.removeAllChildren();var K=u.shape=new t.Shape().addTo(u);if(u.colorCommand=K.c().f(e).command,e&&e.type&&u.specialColor(u.colorCommand,e,u),(n(i)||i>0)&&(!n(r)||!n(i))&&(n(r)&&(r=t.black),u.borderColorCommand=K.s(r).command,r&&r.type&&u.specialColor(u.borderColorCommand,r,u),u.borderWidthCommand=K.ss(i,y.caps,y.joints,y.miterLimit,y.ignoreScale).command,P&&(u.borderDashedCommand=K.sd([10,10],5).command)),K.mt(0,0),O>0){var ge=u.spineShape=new t.Shape().addTo(u);u.spineColorCommand=ge.c().f(C).command,C&&C.type&&u.specialColor(u.spineColorCommand,C,u),(n(O)||O>0)&&(!n(_)||!n(O))&&(n(_)&&(_=t.black),u.spineBorderColorCommand=ge.s(_).command,_&&_.type&&u.specialColor(u.spineBorderColorCommand,_,u),u.spineBorderWidthCommand=ge.ss(O,m.caps,m.joints,m.miterLimit,m.ignoreScale).command,Y&&(u.spineBorderDashedCommand=ge.sd([10,10],5).command))}if(!n($)){var Q=u.closeShape=new t.Shape().addTo(u);u.closeColorCommand=Q.c().f($).command,$&&$.type&&u.specialColor(u.closeColorCommand,$,u),(n(I)||I>0)&&(!n(X)||!n(I))&&(n(X)&&(X=t.black),u.closeBorderColorCommand=Q.s(X).command,X&&X.type&&u.specialColor(u.closeBorderColorCommand,X,u),u.closeBorderWidthCommand=Q.ss(I,q.caps,q.joints,q.miterLimit,q.ignoreScale).command,R&&(u.closeBorderDashedCommand=Q.sd([10,10],5).command)),K.mt(0,0)}var ce=x,G=k,le=l,Ae=le-180,re=s,xe=f,ke=Math.max(D.length,N.length,ue.length,fe.length,V.length),te,pe,he=Ae,ae=[],Ee=[],ie=[];u.points=[];var Se=u.pinPoints=[];t.loop(ke,function(ee){var Me=Le(ee),_e=Math.cos(Me.a*t.RAD),Ye=Math.sin(Me.a*t.RAD),je=new t.Point(ce+Me.A.x*_e-Me.A.y*Ye,G+Me.A.x*Ye+Me.A.y*_e),it=new t.Point(ce+Me.B.x*_e-Me.B.y*Ye,G+Me.B.x*Ye+Me.B.y*_e),Be=new t.Point(ce+Me.C.x*_e-Me.C.y*Ye,G+Me.C.x*Ye+Me.C.y*_e),qe=new t.Point(ce+Me.D.x*_e-Me.D.y*Ye,G+Me.D.x*Ye+Me.D.y*_e);ae.push(je,it),Ee.unshift(Be,qe),ie.push([je,it,Be,qe]);var et=new t.Point(ce+Me.F.x*_e-Me.F.y*Ye,G+Me.F.x*Ye+Me.F.y*_e),ve=new t.Point(ce+Me.E.x*_e-Me.E.y*Ye,G+Me.E.x*Ye+Me.E.y*_e);ee==0&&u.pinPoints.push(et),u.pinPoints.push(ve),ce=ve.x,G=ve.y,re=Me.tA,xe=Me.tB}),u.points=ae.concat(Ee),z?(u.crossCommands=[],t.loop(ie,function(ee,Me){K.mt(ee[0].x,ee[0].y),!n(se)&&!n(se[Me])&&(K.f(se[Me]),u.crossCommands[Me]=K.f(se[Me]).command,se[Me]&&se[Me].type&&u.specialColor(u.crossCommands[Me],se[Me],u),K.mt(ee[0].x,ee[0].y)),K.lt(ee[1].x,ee[1].y).lt(ee[2].x,ee[2].y).lt(ee[3].x,ee[3].y).cp()}),Oe&&K.mt(ie[ie.length-1][1].x,ie[ie.length-1][1].y).lt(ie[ie.length-1][2].x,ie[ie.length-1][2].y).lt(ie[0][3].x,ie[0][3].y).lt(ie[0][0].x,ie[0][0].y).cp()):(t.loop(ae,function(ee,Me){Me==0?K.mt(ee.x,ee.y):K.lt(ee.x,ee.y)}),Oe&&(K.lt(ae[0].x,ae[0].y),K.cp()),t.loop(Ee,function(ee,Me){Me==0&&Oe?K.mt(ee.x,ee.y):K.lt(ee.x,ee.y)}),Oe&&K.lt(Ee[0].x,Ee[0].y),K.cp()),ge&&(t.loop(Se,function(ee,Me){Me==0?ge.mt(ee.x,ee.y):ge.lt(ee.x,ee.y)}),Oe&&ge.lt(Se[0].x,Se[0].y).cp()),n($)||(t.loop(Ee,function(ee,Me){Me==0?Q.mt(ee.x,ee.y):Q.lt(ee.x,ee.y)}),Oe&&Q.lt(Ee[0].x,Ee[0].y).cp());function Le(ee){var Me=N[ee],_e=D[ee],Ye=ue[ee],je=fe[ee],it=V[ee];if(se)var Be=se[ee];n(Me)&&(Me=he,u.angles[ee]=Me),n(_e)&&(_e=200,u.lengths[ee]=_e),n(Ye)&&(Ye=0,u.anglesA[ee]=Ye),n(je)&&(je=0,u.anglesB[ee]=je),n(it)&&(it=0,u.anglesEnd[ee]=it),se&&n(Be)&&(Be=e,u.crossColors[ee]=Be),it=it+90;var qe=180-it,et=Math.cos((he-Me)*t.RAD),ve=Math.sin((he-Me)*t.RAD),Pe=new t.Point(0,0),oe=new t.Point(_e,0);if(n(te))var Fe=new t.Point(Math.cos(le*t.RAD)*re,Math.sin(le*t.RAD)*re);else Fe=new t.Point(te.x*et-te.y*ve,te.x*ve+te.y*et);var Ze=Ce(_e,Fe.x,Fe.y,Ye,qe),Xe=new t.Point(_e-Ze.x,-Ze.y),We;n(pe)?We=new t.Point(Math.cos(Ae*t.RAD)*re,Math.sin(Ae*t.RAD)*xe):We=new t.Point(pe.x*et-pe.y*ve,pe.x*ve+pe.y*et);var de=Ce(_e,We.x,We.y,je,it),Ve=new t.Point(_e-de.x,de.y);return te=new t.Point(Xe.x-_e,Xe.y),pe=new t.Point(Ve.x-_e,Ve.y),he=Me,{a:Me,A:Fe,B:Xe,C:Ve,D:We,E:oe,F:Pe,tA:Ze.t,tB:de.t}}function Ce(ee,Me,_e,Ye,je){var it=je-90,Be=90-it,qe=180-Ye-Be,et=Math.tan(it*t.RAD)*_e,ve=ee-Me-et,Pe=ve/Math.sin(qe*t.RAD)*Math.sin(Ye*t.RAD),oe=Math.sqrt(Math.pow(_e,2)+Math.pow(et,2)),Fe=Pe+oe,Ze=Fe*Math.sin(it*t.RAD),Xe=Fe*Math.cos(it*t.RAD);return{x:Ze,y:Xe,t:Fe}}}this.add=function(D,N,ue,fe,V,z,se,Oe){var K="lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close",ge;return(ge=st(u.add,arguments,K))?ge:(n(z)||(u.cross=z),n(Oe)||(u.close=Oe),n(D)||(Array.isArray(D)||(D=[D]),n(u.lengths)?u.lengths=D:u.lengths=u.lengths.concat(D)),n(N)||(Array.isArray(N)||(N=[N]),n(u.angles)?u.angles=N:u.angles=u.angles.concat(N)),n(ue)||(Array.isArray(ue)||(ue=[ue]),n(u.anglesA)?u.anglesA=ue:u.anglesA=u.anglesA.concat(ue)),n(fe)||(Array.isArray(fe)||(fe=[fe]),n(u.anglesB)?u.anglesB=fe:u.anglesB=u.anglesB.concat(fe)),n(V)||(Array.isArray(V)||(V=[V]),n(u.anglesEnd)?u.anglesEnd=V:u.anglesEnd=u.anglesEnd.concat(V)),n(se)||(n(u.crossColors)?pt&&tt("Flare() - must set crossColor for original object parameters"):(Array.isArray(se)||(se=[se]),n(u.crossColors)?u.crossColors=se:u.crossColors=u.crossColors.concat(se))),u.remake(),u)},this.remake=function(){return s=this.thicknessA,f=this.thicknessB,S(u.lengths,u.angles,u.anglesA,u.anglesB,u.anglesEnd,u.cross,u.crossColors,u.close),u},Object.defineProperty(u,"color",{get:function(){return e},set:function(D){n(D)&&(D=t.black),e=D,D&&D.type?u.specialColor(u.colorCommand,D,u):u.colorCommand.style=D}});var F,p;this.setColorRange=function(D,N){return n(N)?(F=u.color,p=D):n(D)?(F=u.color,p=N):(F=D,p=N),u};var L=0;Object.defineProperty(u,"colorRange",{get:function(){return L},set:function(D){L=D,!n(F)&&!n(p)&&(u.color=t.colorRange(F,p,D))}}),Object.defineProperty(u,"borderColor",{get:function(){return r},set:function(D){r=D,u.borderColorCommand?D&&D.type?u.specialColor(u.borderColorCommand,D,u):u.borderColorCommand.style=D:S()}}),Object.defineProperty(u,"borderWidth",{get:function(){return i},set:function(D){D>0||(D=0),i=D,!u.borderWidthCommand||i==0?S():(u.borderWidthCommand.width=i,P&&(u.borderDashedCommand.segments=[20,10],u.borderDashedCommand.offset=5))}}),Object.defineProperty(u,"spineColor",{get:function(){return C},set:function(D){n(D)&&(D=t.black),C=D,u.spineColorCommand?D&&D.type?u.specialColor(u.spineColorCommand,D,u):u.spineColorCommand.style=D:S()}}),Object.defineProperty(u,"spineBorderColor",{get:function(){return _},set:function(D){_=D,u.spineBorderColorCommand?D&&D.type?u.specialColor(u.spineBorderColorCommand,D,u):u.spineBorderColorCommand.style=D:S()}}),Object.defineProperty(u,"spineBorderWidth",{get:function(){return O},set:function(D){D>0||(D=0),O=D,!u.spineBorderWidthCommand||O==0?S():(u.spineBorderWidthCommand.width=O,Y&&(u.spineBorderDashedCommand.segments=[20,10],u.spineBorderDashedCommand.offset=5))}}),Object.defineProperty(u,"closeColor",{get:function(){return $},set:function(D){n(D)&&(D=t.black),$=D,u.closeColorCommand?D&&D.type?u.specialColor(u.closeColorCommand,D,u):u.closeColorCommand.style=D:S()}}),Object.defineProperty(u,"closeBorderColor",{get:function(){return X},set:function(D){X=D,u.closeBorderColorCommand?D&&D.type?u.specialColor(u.closeBorderColorCommand,D,u):u.closeBorderColorCommand.style=D:S()}}),Object.defineProperty(u,"closeBorderWidth",{get:function(){return I},set:function(D){D>0||(D=0),I=D,!u.closeBorderWidthCommand||I==0?S():(u.closeBorderWidthCommand.width=I,R&&(u.closeBorderDashedCommand.segments=[20,10],u.closeBorderDashedCommand.offset=5))}}),Object.defineProperty(u,"pin",{get:function(){return c},set:function(D){D>0||(D=0),D>u.pinPoints.length-1&&(c=0),c=D;var N=u.pinPoints[c];N&&(u.regX=N.x,u.regY=N.y)}});var we=t.boundsAroundPoints(u.points);this.setBounds(we.x,we.y,we.width,we.height),n(c)||(u.pin=c),this.mouseChildren=!1,J!==!1&&t.styleTransforms(this,d),this.clone=function(){return u.cloneProps(new t.Flare(e,r,i,o,t.copy(a),t.copy(s),t.copy(f),c,x,k,t.copy(v),t.copy(g),t.copy(b),t.copy(E),t.copy(A),T,t.copy(h),w,P,y,C,O,_,Y,m,$,I,X,R,q,J,this.group,ne))}},t.extend(t.Flare,t.Container,["clone"],"zimContainer",!1),t.MultiFlare=function(e,r,i,l,a,s,f){var c="flares, pins, angles, endToEnd, style, group, inherit",x;if(x=st(t.MultiFlare,arguments,c,this))return x;De("53.7"),this.zimContainer_constructor(),this.type="MultiFlare",this.group=s;var k=a===!1?{}:t.getStyle(this.type,this.group,f),v=this;n(e)&&(e=k.flares!=null?k.flares:[]),Array.isArray(e)||(e=[e]),n(r)&&(r=k.pins!=null?k.pins:null),n(i)&&(i=k.angles!=null?k.angles:null),n(l)&&(l=k.endToEnd!=null?k.endToEnd:!1),v.flares=e,v.pins=r,v.angles=i,v.endToEnd=l,v.mouseChildren=!1,v.add=function(g,b){return n(g)||(n(b)&&(b=!0),Array.isArray(g)||(g=[g]),t.loop(g,function(E){b?v.flares.push(E.clone()):v.flares.push(E)}),v.remake(),v.stage&&v.stage.update()),v},v.remove=function(g){return n(g)||(Array.isArray(g)||(g=[g]),t.loop(g,function(b){var E=v.flares.indexOf(b);E>=0&&v.flares.splice(E,1)}),v.remake(),v.stage&&v.stage.update()),v},v.remake=function(){v.removeAllChildren(),t.loop(v.flares,function(g,b){if(r&&!n(r[b])&&(g.pin=r[b]),i&&!n(i[b])&&(g.rotation=i[b]),g.addTo(v),v.flares.push(g),l&&b>0){var E=e[b-1],A=E.pinPoints[E.pinPoints.length-1],T=E.localToLocal(A.x,A.y,v),h=g.pinPoints[0],w=g.localToLocal(h.x,h.y,v);g.mov(T.x-w.x,T.y-w.y)}})},v.remake(),a!==!1&&t.styleTransforms(this,k),this.clone=function(){return v.cloneProps(new t.MultiFlare(t.copy(e,!0),t.copy(r),t.copy(i),l,a,this.group,f))}},t.extend(t.MultiFlare,t.Container,["clone"],"zimContainer",!1),t.FlareBox=function(e,r,i,l,a,s,f,c,x,k,v){var g="width, height, color, borderColor, borderWidth, flares, corners, pins, style, group, inherit",b;if(b=st(t.FlareBox,arguments,g,this))return b;De("53.8"),this.group=k;var E=x===!1?{}:t.getStyle("FlareBox",this.group,v);n(e)&&(e=E.width!=null?E.width:220),n(r)&&(r=E.height!=null?E.height:80),this.zimContainer_constructor(e,r),this.type="FlareBox";var A=this;if(this.mouseChildren=!1,n(l)&&(l=E.borderColor!=null?E.borderColor:null),n(a)&&(a=E.borderWidth!=null?E.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(i)&&(i=E.color!=null?E.color:a>0?"rgba(0,0,0,0)":t.black),(n(a)||a>0)&&(!n(l)||!n(a))&&n(l)&&(l=t.black),n(s)&&(s=E.flares!=null?E.flares:null),n(f)&&(f=E.corners!=null?E.corners:null),n(c)&&(c=E.pins!=null?E.pins:null),A.backing=new t.Rectangle(e,r,i,l,a).addTo(this),!n(s)){if(s.type!="MultiFlare"){if(!Array.isArray(s)){if(s.type!="Flare")return;s=[s]}s=new t.MultiFlare(s,c)}s.addTo(A),A.multiFlare=s,A.flares=A.multiFlare.flares,s.loop(function(T,h){c&&!n(c[h])?T.pin=c[h]:n(T.pin)&&(T.pin=0),f&&!n(f[h])?T.corner=f[h]:n(T.corner)&&(T.corner=0),T.corner==1?T.loc(e,0):T.corner==2?T.loc(e,r):T.corner==3?T.loc(0,r):T.loc(0,0),T.rot((T.corner-T.pin)*90)}),x!==!1&&t.styleTransforms(this,E),this.clone=function(){return A.cloneProps(new t.FlareBox(e,r,i,l,a,t.copy(s,!0),t.copy(f),t.copy(c),x,this.group,v))}}},t.extend(t.FlareBox,t.Container,["clone"],"zimContainer",!1),t.Label=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B){var d="text, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, bold, italic, variant, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, splitWords, style, group, inherit",u;if(u=st(t.Label,arguments,d,this))return u;De("54"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Label",this.group=U;var o=ne===!1?{}:t.getStyle(this.type,this.group,B);n(e)&&(e=o.text!=null?o.text:"LABEL"),n(r)&&(r=o.size!=null?o.size:36),n(i)&&(i=o.font!=null?o.font:"arial"),n(l)&&(l=o.color!=null?o.color:t.black),n(k)&&(k=o.bold!=null?o.bold:!1),n(v)&&(v=o.italic!=null?o.italic:!1);var S=F(e,r,i,l,k,v);this.veeObj={text:S[0],size:S[1],font:S[2],color:S[3],bold:S[4],italic:S[5]};function F(){return arguments}e=t.Pick.choose(e);var p=!1;e===""&&(e=" ",p=!0),r=t.Pick.choose(r),i=t.Pick.choose(i),i=i.replace("+"," ");var L=["ttf","otf","woff2","woff","fnt"],we=i.split(".");we.length>0&&L.indexOf(we[1])!=-1&&(i=we[0]),l=t.Pick.choose(l),k=t.Pick.choose(k),v=t.Pick.choose(v),n(a)&&(a=o.rollColor!=null?o.rollColor:null),(n(s)||s=="ignore")&&(s=o.shadowColor!=null&&s!="ignore"?o.shadowColor:-1),(n(f)||f=="ignore")&&(f=o.shadowBlur!=null&&f!="ignore"?o.shadowBlur:14),n(c)&&(c=o.align!=null?o.align:"left"),n(x)&&(x=o.valign!=null?o.valign:"top"),(!n(T)||!n(o.outlineColor))&&n(h)&&(h=o.outlineWidth!=null?o.outlineWidth:Math.round(r*.2)),(!n(h)||!n(o.outlineWidth))&&n(T)&&(T=o.outlineColor!=null?o.outlineColor:t.black),n(h)&&(h=o.outlineWidth!=null?o.outlineWidth:0),(n(w)||w=="ignore")&&(w=o.backgroundColor!=null&&w!="ignore"?o.backgroundColor:null),n(P)&&(P=o.backgroundBorderColor!=null&&P!="ignore"?o.backgroundBorderColor:null),n(y)&&(y=o.backgroundBorderWidth!=null&&y!="ignore"?o.backgroundBorderWidth:null),(n(_)||_=="ignore")&&(_=o.padding!=null&&_!="ignore"?o.padding:10),n(Y)&&(Y=o.paddingH!=null?o.paddingH:_),n(m)&&(m=o.paddingV!=null?o.paddingV:_),n($)&&($=o.shiftH!=null?o.shiftH:0),n(I)&&(I=o.shiftV!=null?o.shiftV:0),n(g)&&(g=o.variant!=null?o.variant:!1),n(b)&&(b=o.lineWidth!=null?o.lineWidth:null),n(E)&&(E=o.lineHeight!=null?o.lineHeight:null),(n(A)||A=="ignore")&&(A=o.backing!=null&&A!="ignore"?o.backing.clone():null),n(X)&&(X=o.rollPersist!=null?o.rollPersist:!1),o.labelWidth!=null&&(b=o.labelWidth),n(R)||(b=R),c=="middle"&&(c="center"),n(q)&&(q=o.labelHeight!=null?o.labelHeight:null),n(J)&&(J=o.maxSize!=null?o.maxSize:null),r=J?Math.min(r,J):r,n(Z)&&(Z=o.splitWords!=null?o.splitWords:!1);var D=j.zdf&&j.zdf.retina,N=this;this.mouseChildren=!1,this.paddingV=m,this.paddingH=Y,j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?c=="start"?c="right":c=="end"&&(c="left"):c=="start"?c="left":c=="end"&&(c="right");var ue=[];ue[0]=v?"italic":"normal",ue[1]=g?"small-caps":"normal",ue[2]=k?"bold":"normal",ue[3]=r+"px",ue[4]=i;var fe=ue.join(" ");e=String(e);var V,z=!1,se=b,Oe=q;if(n(A)&&n(w)){var K=new Ge.Shape;N.hitArea=K}else se&&(se=se-Y*2),Oe&&(Oe=Oe-m*2);function ge(ee){var Me=new Ge.Text(ee,fe,l);return Me.lineWidth=se,Me.lineHeight=E,Me}V=ge(e);function Q(ee,Me,_e){var Ye=Math.ceil(se/Me*_e.length),je=_e.substr(0,Ye),it=ge(je),Be=it.getMeasuredWidth();if(Be>se)for(;Be>se;)Ye--,je=_e.substr(0,Ye),it=ge(je),Be=it.getMeasuredWidth();else if(Be<se){for(;Be<se;)Ye++,je=_e.substr(0,Ye),it=ge(je),Be=it.getMeasuredWidth();Ye--,je=_e.substr(0,Ye)}var qe=_e.substr(Ye,_e.length);return{endIndex:Ye,start:je,end:qe}}if(Z&&se>r*1.2)for(var ce=V.getMetrics(),G=0;ce.width>se&&G<1e3;)G++,t.loop(ce.lines,function(ee,Me){ee=ee.replace(/^[\s\t]+/,"");var _e=ge(ee),Ye=_e.getMeasuredWidth();if(Ye>se){var je=Q(_e,Ye,ee);return ce.lines[Me]=je.start,ce.lines.length>Me+1?(je.end.trim(),ce.lines[Me+1]=je.end+" "+ce.lines[Me+1]):ce.lines.push(je.end),V=ge(ce.lines.join(" ")),ce=V.getMetrics(),!1}});if(this.label=V,V.textAlign=c,V.textBaseline="alphabetic",h>0){var le=this.outlineLabel=V.clone();le.color=T,le.outline=h}s!=-1&&f>0&&(V.shadow=new Ge.Shadow(s,3,3,f)),this.addChild(V);function Ae(){N.removeChild(N.background),N.background=new t.Rectangle(N.getBounds().width+Y*2,N.getBounds().height+m*2,w,P,y,C,O,null,null,!1),t.center(N.background,N,0),N.setBounds(N.background.x,N.background.y,N.background.width,N.background.height)}function re(){var ee=V.getBounds(),Me=ee.y,_e=ee.height;if(se&&!Oe){var Ye=ee.x,je=se;c=="right"?Ye=ee.x-se+ee.width:c=="center"&&(Ye=-se/2),V.setBounds(Ye,Me,je,_e),ee=V.getBounds()}var it;x=="baseline"?it=ee.y:x=="top"?(V.y=r-r/6,it=0):x=="center"||x=="middle"?(it=-ee.height/2,V.y=r*.3):it=-ee.height,N.setBounds(ee.x,it,o.width?o.width-_*2:ee.width,o.height?o.height-_*2:ee.height),N.hitArea&&N.hitArea.graphics.c().f("black").r(N.getBounds().x,N.getBounds().y,N.getBounds().width,N.getBounds().height),(x=="center"||x=="middle")&&(t.pos(V,null,0),t.mov(V,0,1)),q||(A?z&&te():n(w)||Ae()),x!="baseline"&&!D&&(V.y+=r/32),pe()}if(re(),!n(A)){if(A.type=="Pattern"){if(N.backing=new t.Container(N.width+Y*2,N.height+m*2,null,null,!1).centerReg(null,null,!1),s!=-1&&f>0){var xe=new t.Rectangle(N.width+Y*2-2,N.height+m-2,"#666",null,null,C,null,null,null,!1).center(N.backing);xe.shadow=new Ge.Shadow(s,3,3,f)}var ke=new t.Rectangle(N.width+Y*2,N.height+m*2,w,null,null,C,null,null,null,!1).addTo(N.backing);A.centerReg(ke),A.setMask(ke),N.backing.pattern=A}else N.backing=A;N.backing.center(N,0),A=N.backing,te(),z=!0}function te(){var ee=A.boundsToGlobal(),Me=N.boundsToGlobal(ee,!0);N.setBounds(Me.x,Me.y,Me.width,Me.height)}function pe(){t.pos(V,c=="left"||c=="right"?A||N.background?Y:0:null,x=="top"||x=="baseline"||x=="bottom"?A||N.background?m:0:null,c=="right",x=="bottom"),V.x+=$,V.y+=I}pe();function he(){le&&(le.x=V.x,le.y=V.y,N.addChildAt(le,N.background||N.backing?1:0))}he(),Object.defineProperty(N,"text",{get:function(){var ee=V.text==" "&&p?"":V.text;return ee},set:function(ee){p=!1,ee===""&&(ee=" ",p=!0),V.text=String(ee),V.setBounds(null),N.setBounds(null),re(),le&&(le.text=String(ee)),!n(b)&&!n(q)&&(Ce(),le&&he())}}),Object.defineProperty(N,"size",{get:function(){return r},set:function(ee){r=J?Math.min(ee,J):ee,ue[3]=r+"px",this.label.font=ue.join(" "),le&&(le.font=ue.join(" ")),V.setBounds(null),N.setBounds(null),re(),he()}}),Object.defineProperty(N,"bold",{get:function(){return!!this.label.font.match("bold")},set:function(ee){k=ee,ue[2]=ee?"bold":"normal",this.label.font=ue.join(" "),le&&(le.font=ue.join(" "))}}),Object.defineProperty(N,"italic",{get:function(){return!!this.label.font.match("italic")},set:function(ee){v=ee,ue[0]=ee?"italic":"normal",this.label.font=ue.join(" "),le&&(le.font=ue.join(" "))}}),Object.defineProperty(N,"variant",{get:function(){return!!this.label.font.match("small-caps")},set:function(ee){g=ee,ue[1]=ee?"small-caps":"normal",this.label.font=ue.join(" "),le&&(le.font=ue.join(" "))}}),Object.defineProperty(N,"font",{get:function(){return ue[4]},set:function(ee){n(ee)||(i=ee,ue[4]=ee,this.label.font=ue.join(" "),le&&(le.font=ue.join(" ")))}}),Object.defineProperty(N,"align",{get:function(){return c},set:function(ee){n(ee)||(c=ee,this.label.textAlign=c,le&&(le.textAlign=c),re(),he())}}),Object.defineProperty(N,"valign",{get:function(){return x},set:function(ee){n(ee)||(x=ee,re(),he())}}),Object.defineProperty(N,"color",{get:function(){return l},set:function(ee){a==l&&(a=ee),l=ee,V.color=l,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),Object.defineProperty(N,"colorOnly",{get:function(){return l},set:function(ee){l=ee,V.color=l,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&N.stage&&N.stage.update()}});var ae,Ee;this.setColorRange=function(ee,Me){return n(Me)?(ae=N.color,Ee=ee):n(ee)?(ae=N.color,Ee=Me):(ae=ee,Ee=Me),N};var ie=0;Object.defineProperty(N,"colorRange",{get:function(){return ie},set:function(ee){ie=ee,!n(ae)&&!n(Ee)&&(N.color=t.colorRange(ae,Ee,ee))}}),Object.defineProperty(N,"backgroundColor",{get:function(){return w},set:function(ee){w=ee,N.background?N.background.color=ee:N.backing?N.backing.color=ee:Ae(),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),Object.defineProperty(N,"outlineColor",{get:function(){return T},set:function(ee){T=ee,le&&(le.color=T),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),Object.defineProperty(N,"rollColor",{get:function(){return a},set:function(ee){!N.mouseoverEvent&&ee&&Se(),ee==null&&N.mouseoverEvent&&Le(),a=ee}}),this._enabled=!0,Object.defineProperty(N,"enabled",{get:function(){return N._enabled},set:function(ee){St(N,ee),V.color=l,N.mouseChildren=!1,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&N.stage&&N.stage.update()}}),this.showRollColor=function(ee){return n(ee)&&(ee=!0),ee?V.color=a:V.color=l,N.stage&&N.stage.update(),N};function Se(){N.mouseoverEvent=N.on("mouseover",function(){N.showRollColor&&N.showRollColor()}),N.mouseoutEvent=N.on("mouseout",function(){N.rollPersist||N.showRollColor(!1)}),N.pressupEvent=N.on("pressup",function(){N.rollPersist&&N.showRollColor(!1)})}function Le(){N.off("mouseover",N.mouseoverEvent),N.off("mouseout",N.mouseoutEvent),N.off("pressup",N.pressupEvent)}a&&Se(),Object.defineProperty(N,"labelWidth",{get:function(){return b},set:function(ee){ee>0&&(b=ee,se=b,(!n(A)||!n(w))&&se&&(se=se-Y*2),N.label.lineWidth=se,le&&(le.lineWidth=se),V.setBounds(null),N.setBounds(null),re(),q&&Ce(),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&N.stage&&N.stage.update())}}),Object.defineProperty(N,"labelHeight",{get:function(){return q},set:function(ee){ee>0&&(q=ee,Oe=q,(!n(A)||!n(w))&&Oe&&(Oe=Oe-m*2),b&&Ce(),N.setBounds(null),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&N.stage&&N.stage.update())}}),!n(b)&&!n(q)&&Ce();function Ce(){N.size=J||200;for(var ee=0;E<Oe/2&&(N.height>Oe||N.width>se)&&(ee++,N.size=N.size/2,!(ee>50)););for(ee=0;N.height<=Oe&&N.width<=se&&(ee++,N.size=Math.ceil(N.size+1),!(ee>50)););N.size=N.size-1,he(),V.setBounds(null);var Me=V.getBounds(),_e=Me.y,Ye=Me.height;Oe&&(x=="bottom"?_e=_e-Oe+Ye:(x=="center"||x=="middle")&&(_e=(_e+_e-Oe+Ye)/2),Ye=Oe),V.setBounds(Me.x,_e,Me.width,Ye),N.setBounds(null),Me=N.getBounds(),N.setBounds(Me.x,Me.y,Me.width,Me.height),A?z&&te():n(w)||Ae()}ne!==!1&&t.styleTransforms(this,o),this.clone=function(ee){return N.cloneProps(new t.Label(ee||!t.isPick(S[0])?N.text:S[0],ee||!t.isPick(S[1])?r:S[1],ee||!t.isPick(S[2])?i:S[2],ee||!t.isPick(S[3])?l:S[3],a,s,f,c,x,ee||!t.isPick(S[4])?k:S[4],ee||!t.isPick(S[5])?v:S[5],g,b,E,n(A)?null:A.clone(ee),T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,this.group,B))}},t.extend(t.Label,t.Container,"clone","zimContainer"),t.LabelOnPath=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="label, path, percentAngle, percents, showPath, allowToggle, interactive, onTop, rtl, style, group, inherit",E;if(E=st(t.LabelOnPath,arguments,b,this))return E;De("54.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelOnPath",this.group=v;var A=k===!1?{}:t.getStyle(this.type,this.group,g);n(e)&&(e=A.label!=null?A.label:new t.Label("Label on Path")),n(r)&&(r=A.path!=null?A.path:new t.Squiggle({points:[[0,0,0,0,-86,57,86,-57],[300,150,0,0,-133,21,133,-21]]})),n(i)&&(i=A.percentAngle!=null?A.percentAngle:100),n(l)&&(l=A.percents!=null?A.percents:null),n(a)&&(a=A.showPath!=null?A.showPath:!0),n(s)&&(s=A.allowToggle!=null?A.allowToggle:!0),n(f)&&(f=A.interactive!=null?A.interactive:!0),n(c)&&(c=A.onTop!=null?A.onTop:!1),n(x)&&(x=A.rtl!=null?A.rtl:j.DIR=="rtl"||t.DIR=="rtl"),x&&r.reversePoints();var T=e.color;r.addTo(this);var h=this;this.path=r,this.allowToggle=s,r.interactive=f,typeof e=="string"&&(e=new t.Label(e));var w=r.alpha;a||r.alp(0),r.onTop=c;var P=this.letters=new t.Container().addTo(this);if(!l){l=[];for(var y=0;y<e.text.length;y++)l.push(t.decimals(1/(e.text.length-(r.type=="Blob"?0:1))*100*y))}this.percents=l;function C(){var _;for(_=P.numChildren-1;_>=0;_--)P.getChildAt(_).dispose();for(h.numLetters=e.text.length,_=0;_<h.numLetters;_++){var Y=e.clone();Y.text=e.text[_],Y.centerReg(P).reg(null,Y.height),Y.text!=""&&Y.text!=" "&&Y.expand(0),h.allowToggle&&Y.cur("pointer"),Y.on("mousedown",function(){h.allowToggle&&h.toggle()})}h.resize()}this.resize=function(){for(var _=r.segmentRatios,Y=r.segmentPoints,m=0;m<this.numLetters;m++){var $=r.getCurvePoint(l[m]/100,_,Y,!0);if($){var I=this.globalToLocal($.x,$.y);I&&(P.getChildAt(m).loc(I).rot(($.angle>180?$.angle-360:$.angle)*i/100),x&&(P.getChildAt(m).rotation+=180))}}return this},C(),this.showPath=function(_){return this.toggle(!0),r.toggle(_),this},this.hidePath=function(){return this.toggle(!1),this},Object.defineProperty(h,"text",{get:function(){return e.text},set:function(_){e.text=_,l=[];for(var Y=0;Y<e.text.length;Y++)l.push(t.decimals(1/(e.text.length-(r.type=="Blob"?0:1))*100*Y));C()}}),Object.defineProperty(this,"color",{get:function(){return T},set:function(_){T=_;for(var Y=0;Y<h.letters.numChildren;Y++)h.letters.getChildAt(Y).color=T;h.stage&&h.stage.update()}}),Object.defineProperty(h,"interactive",{get:function(){return f},set:function(_){f=_,r.interactive=_,this.ticker&&t.Ticker.remove(this.ticker),f&&(this.ticker=t.Ticker.add(function(){h.resize()}))}}),this.interactive&&(this.ticker=t.Ticker.add(function(){h.resize()}));var O=h.toggled=a;this.toggle=function(_){if(this.allowToggle)return n(_)?O=!O:_?O=!0:O=!1,O?(r.alp(w),this.interactive&&(r.showControls(),P.mouseEnabled=!1,P.mouseChildren=!1,P.cur("default"),this.controlHideEvent&&r.off("controlshide",this.controlHideEvent),this.controlHideEvent=r.on("controlshide",function(){P.mouseEnabled=!0,P.mouseChildren=!0,P.cur("pointer"),w=r.alpha,r.alp(0),O=!1,h.toggled=O,h.stage&&h.stage.update()},null,!0))):(w=r.alpha,r.alp(0),P.mouseEnabled=!0,P.mouseChildren=!0,P.cur("pointer")),h.toggled=O,h.stage&&h.stage.update(),h},h.toggle(!0),k!==!1&&t.styleTransforms(this,A),this.clone=function(){return h.cloneProps(new t.LabelOnPath(h.label.clone(),h.path.clone(),i,t.copy(l),a,s,f,c,x,k,this.group,g))},this.dispose=function(_,Y,m){return this.ticker&&t.Ticker.remove(this.ticker),m||this.zimContainer_dispose(!0),!0}},t.extend(t.LabelOnPath,t.Container,["clone","dispose"],"zimContainer",!1),t.LabelOnArc=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w){var P="label, size, font, color, radius, flip, spacing, letterSpacing, angles, showCircle, arcColor, arcBorderColor, arcBorderWidth, radiusSpread, rtl, style, group, inherit",y;if(y=st(t.LabelOnArc,arguments,P,this))return y;De("54.55"),this.group=h;var C=T===!1?{}:t.getStyle("LabelOnArc",this.group,w);n(r)&&(r=C.size!=null?C.size:30),n(e)&&(e=C.label!=null?C.label:new t.Label("Label on Arc",r)),n(i)&&(i=C.font!=null?C.font:"verdana"),n(l)&&(l=C.color!=null?C.color:t.white),n(a)&&(a=C.radius!=null?C.radius:100),n(s)&&(s=C.flip!=null?C.flip:!1),n(f)&&(f=C.spacing!=null?C.spacing:0),n(c)&&(c=C.letterSpacing!=null?C.letterSpacing:5),n(x)&&(x=C.angles!=null?C.angles:null);var O=!n(x),_=t.copy(x);n(k)&&(k=C.showCircle!=null?C.showCircle:!1),n(v)&&(v=C.arcColor!=null?C.arcColor:null),n(g)&&(g=C.arcBorderColor!=null?C.arcBorderColor:null),n(b)&&(b=C.arcBorderWidth!=null?C.arcBorderWidth:null),n(E)&&(E=C.radiusSpread!=null?C.radiusSpread:!1),n(A)&&(A=C.rtl!=null?C.rtl:j.DIR=="rtl"||t.DIR=="rtl");var Y=this.outerRadius=a+f+e.height;this.innerRadius=a+f,this.zimContainer_constructor(-Y,-Y,Y*2,Y*2,!1),this.type="LabelOnArc";var m=this;e.type!="Label"&&(e=new t.Label(e,r,i,l)),e.text;var $,I,X,R,q,J;function Z(){if(m.disposeAllChildren(),s){var B=e.text.split("").reverse().join("");e.text=B}$=m.letters=new t.Container(m.width,m.height).centerReg(m),m.numLetters=e.text.length,m.letterHeight=e.height,I=m.labels=[];var d;for(d=0;d<m.numLetters;d++){var u=e.clone();I.push(u),u.text=e.text[d],u.letterHolder=new t.Container(u.width,u.height),u.centerReg(u.letterHolder).rot(s?180:0)}if(A&&I.reverse(),R=m.circle=new t.Circle(a),k&&R.addTo(m),X=m.arc=new t.Shape().addTo(m),ne(),x){for(q=0,d=0;d<x.length;d++)q+=x[d];q+=x[x.length-1]/2}U()}Z();function ne(){q=0,J=[0];for(var B=0;B<m.numLetters;B++){var d=I[B],u=Math.atan((d.width+c)/2/(a+f))*180/Math.PI*2;J.push(u),q+=u,d.letterHolder.centerReg($).reg(null,a+f+d.height+(s?d.height*.13:0))}m.circle.radius=a,(v||g||b)&&(b>0&&n(g)?g=t.black:n(b)&&!n(g)&&(b=2),X.graphics.c().f(null).s(g).ss(b).arc(0,0,a,(m.startAngle-90)*Math.PI/180,(m.startAngle-90+q)*Math.PI/180))}function U(){var B;if(!O)for(x=[],B=0;B<J.length-1;B++)x[B]=Math.round((J[B]+J[B+1])/2*100)/100;m.angles=x,m.startAngle=-q/2;var d=m.startAngle;for(B=0;B<$.numChildren;B++){var u=$.getChildAt(B);d=u.rotation=d+x[B]}}Object.defineProperty(this,"radius",{get:function(){return a},set:function(B){a=B,ne(),!O&&!E&&U()}}),Object.defineProperty(this,"color",{get:function(){return l},set:function(B){l=B;for(var d=0;d<m.labels.length;d++)m.labels[d].color=l;m.stage&&m.stage.update()}}),Object.defineProperty(m,"text",{get:function(){return e.text},set:function(B){e.text=B,_?x=t.copy(_):x=null,Z()}}),T!==!1&&t.styleTransforms(this,C),this.clone=function(){return m.cloneProps(new t.LabelOnArc(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,this.group,w))}},t.extend(t.LabelOnArc,t.Container,"clone","zimContainer",!1),t.LabelLetters=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A){var T="label, align, valign, letterSpacing, letterSpacings, lineSpacing, lineSpacings, lineHeight, lineAlign, lineValign, cache, rtl, style, group, inherit",h;if(h=st(t.LabelLetters,arguments,T,this))return h;De("54.57"),this.group=E;var w=b===!1?{}:t.getStyle("LabelLetters",this.group,A);n(e)&&(e=w.label!=null?w.label:new t.Label("Label Letters")),n(r)&&(r=w.align!=null?w.align:"center"),n(i)&&(i=w.valign!=null?w.valign:"center"),n(l)&&(l=w.letterSpacing!=null?w.letterSpacing:5),n(a)&&(a=w.letterSpacings!=null?w.letterSpacings:null),n(c)&&(c=w.lineHeight!=null?w.lineHeight:null),n(s)&&(s=w.lineSpacing!=null?w.lineSpacing:5),n(f)&&(f=w.lineSpacings!=null?w.lineSpacings:null),n(g)&&(g=w.rtl!=null?w.rtl:!1),n(x)&&(x=w.lineAlign!=null?w.lineAlign:g?"right":"left"),n(k)&&(k=w.lineValign!=null?w.lineValign:"bottom"),n(v)&&(v=w.cache!=null?w.cache:!1),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelLetters";var P=this,y=P.letterData=[],C,O;e.type!="Label"?(O=_(e),y=O.data,e=new t.Label(O.text)):(O=_(e.text),y=O.data,e.text=O.text),P.text=O.original,P._color=e.color,j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?x=="start"?x="right":x=="end"&&(x="left"):x=="start"?x="left":x=="end"&&(x="right");function _(le){var Ae=[];function re(Ee){return Ee.split("").reverse().join("")}if(g){Oe=-1,le=le.replace(/[\u0591-\u07FF]+/ig,re),le=le.replace(/([^\u0591-\u07FF ])([\u0591-\u07FF])/ig,"$1-!!-$2"),le=le.replace(/([\u0591-\u07FF])([^\u0591-\u07FF ])/ig,"$1-!!-$2"),le=le.replace(/([^\u0591-\u07FF]) ([\u0591-\u07FF])/ig,"$1-!!- -!!-$2"),le=le.replace(/([\u0591-\u07FF]) ([^\u0591-\u07FF])/ig,"$1-!!- -!!-$2");var xe=le.split(/-!!-/g);t.loop(xe,function(Ee,ie){Ee.match(/[\u0591-\u07FF]/i)&&(xe[ie]=Ee.split(" ").reverse().join(" "))}),le=xe.join("")}le=le.replace(/\n|\r/g,"<br>"),le=le.replace(/<strong>|<strong \/>|<strong\/>/gi,"<b>"),le=le.replace(/<\/strong>/gi,"</b>"),le=le.replace(/<em>|<em \/>|<em\/>/gi,"<i>"),le=le.replace(/<\/em>/gi,"</i>"),le=le.replace(/\\n|\\r/g,"<br>"),le=le.replace(/<br>|<br \/>|<br\/>(<\/br>)?/gi,"<br>"),le=le.replace(/<b/gi,"<b"),le=le.replace(/<i/gi,"<i"),le=le.replace(/<u/gi,"<u"),le=le.replace(/<br/gi,"<br"),le=le.replace(/<a/gi,"<a"),le=le.replace(/<font/gi,"<font");var ke=[/<(a|i|u|f|br|\/a|\/i|\/u|\/f|\/b)[^>]*>/g,/<(a|i|u|f|br|\/a|\/i|\/u|\/f|b)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|\/a)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|a)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|\/i)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|i)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|\/u)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|u)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|f)[^>]*>/g],te=["b","a","i","u","font"],pe;t.loop(te,function(Ee,ie){pe=le.replace(ke[ie*2],"");var Se;Ee=="font"?Se=pe.split("<font "):Ee=="a"?Se=pe.split("<a "):Se=pe.split("<"+Ee+">"),ae(Se,Ee,0),pe=le.replace(ke[ie*2+1],""),Se=pe.split("</"+Ee+">"),ae(Se,Ee,1)}),pe=le.replace(/<br>/gi,"@^#"),pe=pe.replace(/<(b|a|i|u|f|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,"");var he=pe.split("@^#");C=he.join(`
`),pe=he.join(""),ae(he,"br",0);function ae(Ee,ie,Se){if(Ee.length>1)if((ie=="font"||ie=="a")&&Se==0){var Le=Ee[0].length;t.loop(Ee,function(ee,Me){if(Me!=0){var _e=Ae[Le];_e||(Ae[Le]=[]),_e=Ae[Le];var Ye=ee.split(">");_e[Se]?_e[Se].push(ie+" "+Ye[0]):_e[Se]=[ie+" "+Ye[0]],Le+=Ye[1].length}})}else{Ee.pop();var Ce=0;t.loop(Ee,function(ee){Ce+=ee.length;var Me=Ae[Ce];Me||(Ae[Ce]=[]),Me=Ae[Ce],Me[Se]?Me[Se].push(ie):Me[Se]=[ie]})}}return{text:pe,data:Ae,original:C}}P.numLetters=e.text.length;var Y=!n(a);a&&!Array.isArray(a)&&(a=null);var m;if(a)for(m=0;m<P.numLetters;m++)n(a[m])&&(a[m]=l);else for(a=[],m=0;m<P.numLetters;m++)a.push(l);if(P.letterSpacings=a,f&&!Array.isArray(f)&&(f=null),f)for(m=0;m<P.numLetters-1;m++)n(f[m])&&(f[m]=s);else for(f=[],m=0;m<P.numLetters-1;m++)f.push(s);P.lineSpacings=f,P.labels=[],P.lines=[[]];var $=[],I=[],X=[0],R=0,q=0,J=0,Z=0,ne=0,U=y,B=!1,d=!1,u=!1,o=!1,S=!1,F=!1,p=!1,L=!1,we=!1,D=!1,N=!1,ue=!1;for(P.rolls=[[]],m=0;m<P.numLetters;m++){o=!1,U[m]&&(U[m][1]&&(U[m][1].indexOf("b")>=0&&(B=!1),U[m][1].indexOf("i")>=0&&(d=!1),U[m][1].indexOf("u")>=0&&(u=!1),t.loop(U[m][1],function(le){if(le.match(/^font/i)){S=!1,N=!1,ue&&P.rolls.push([]),ue=!1,F=!1,L=!1,p=!1;return}if(le.match(/^a/i)){we=!1,D=!1;return}})),U[m][0]&&(U[m][0].indexOf("b")>=0&&(B=!0),U[m][0].indexOf("i")>=0&&(d=!0),U[m][0].indexOf("u")>=0&&(u=!0),o=0,t.loop(U[m][0],function(le){le=="br"&&o++}),t.loop(U[m][0],function(le){var Ae,re;if(le.match(/^font/i)){Ae=le.match(/ color\s?=\s?(\S*)/i),Ae&&(S=Ae[1],re=t.colors.indexOf(S),re>=0&&(S=t.colorsHex[re]),S=S.replace(/'/g,"")),Ae=le.match(/size\s?=\s?(\S*)/i),Ae&&(F=Ae[1]),Ae=le.match(/backgroundColor\s?=\s?(\S*)/i),Ae&&(N=Ae[1],re=t.colors.indexOf(N),re>=0&&(N=t.colorsHex[re]),N=N.replace(/'/g,"")),Ae=le.match(/rollBackgroundColor\s?=\s?(\S*)/i),Ae&&(ue=Ae[1],re=t.colors.indexOf(ue),re>=0&&(ue=t.colorsHex[re]),ue=ue.replace(/'/g,"")),Ae=le.match(/group\s?=\s?(\S*)/i),Ae&&(p=Ae[1]),Ae=le.match(/family\s?=\s?(.*)/i),Ae&&(L=Ae[1],L=L.split(/\ssize\s?=|\scolor\s?=|\sgroup\s?=/i)[0]);return}if(le.match(/^a/i)){Ae=le.match(/href\s?=\s?(\S*)/i),Ae&&(we=Ae[1]),Ae=le.match(/target\s?=\s?(\S*)/i),Ae&&(D=Ae[1]);return}})));var fe;p?fe=new t.Label({text:e.text[m],group:p}):(fe=e.clone(),fe.text=e.text[m]),P.labels.push(fe),B&&(fe.bold=!0),d&&(fe.italic=!0),S&&(fe.color=S),N&&(fe.backgroundColor=N);var V=Y||n(fe.backgroundColor)?a[m]:-.5;ue&&(fe.rollIndex=P.rolls.length-1,fe.zrbc=ue,fe.zobc=fe.backgroundColor,P.rolls[fe.rollIndex].push(fe),fe.expand(0),fe.on("mouseover",z),fe.on("mouseout",se)),we&&(fe.expand(V,0),fe.zurl=we,fe.ztar=D,fe.cur(),fe.on("click",function(le){var Ae=le.currentTarget;se(le),Ae.ztar||(Ae.ztar="_self"),ir(Ae.zurl,Ae.ztar)})),L&&(fe.font=L),F&&(fe.size=F),o&&(R+=(n(c)?J:c)+f[Z],X.push(R),I.push(n(c)?J:c),$.push(q),ne=Math.max(ne,q)),o&&(o>1&&t.loop(o-1,function(){P.lines.push([]),R+=(n(c)?J:c)+f[Z],X.push(R),I.push(n(c)?J:c),$.push(0),Z++}),J=0,q=0,P.lines.push([]),Z++),q+=fe.width+V,J=Math.max(J,fe.height),m==P.numLetters-1&&($.push(q),I.push(J),ne=Math.max(ne,q)),P.lines[Z].push(fe),u&&(fe.underline=new t.Line(fe.width+V+1,1,fe.color).center(fe,this).mov(0,fe.height/2))}function z(le){var Ae=le.currentTarget,re=P.rolls[Ae.rollIndex];t.loop(re,function(xe){xe.backgroundColor=Ae.zrbc}),Ae.stage&&Ae.stage.update()}function se(le){var Ae=le.currentTarget,re=P.rolls[Ae.rollIndex];t.loop(re,function(xe){xe.backgroundColor=Ae.zobc}),Ae.stage&&Ae.stage.update()}for(var Oe=0,K=0;K<P.lines.length;K++){var ge=P.lines[K];q=$[K],J=I[K],R=X[K];var Q,ce;for(x=="left"?Q=0:x=="right"?Q=ne-q:Q=(ne-q)/2,ce=R,m=0;m<ge.length;m++){Oe++,v&&fe.cache(),fe=ge[m],fe.regX=r=="left"?0:r=="right"?fe.width:fe.width/2,fe.regY=i=="top"?0:i=="bottom"?fe.height:fe.height/2;var G=ce+(i=="top"?0:i=="bottom"?fe.height:fe.height/2);k=="center"||k=="middle"?G+=(I[K]-fe.height)/2:k=="bottom"&&(G+=I[K]-fe.height),V=Y||n(fe.backgroundColor)?a[Oe-1]:-.5,r=="left"?(fe.loc(Q,G,this),Q=fe.x+fe.width+V):r=="right"?(fe.loc(Q+fe.width,G,this),Q=fe.x+V):(fe.loc(Q+fe.width/2,G,this),Q=fe.x+fe.width/2+V)}}this.getBounds()||this.setBounds(0,0,0,0),this.regX=this.getBounds().x,this.regY=this.getBounds().y,Object.defineProperty(this,"color",{get:function(){return this._color},set:function(le){this._color=le;for(var Ae=0;Ae<P.numChildren;Ae++)P.getChildAt(Ae).color=this._color;P.stage&&P.stage.update()}}),this.dispose=function(){t.gD(this),t.loop(P.labels,function(le){le.removeFrom(),le.dispose()}),P.removeFrom()},b!==!1&&t.styleTransforms(this,w),this.clone=function(){return P.cloneProps(new t.LabelLetters(e,r,i,l,a,s,f,c,x,k,v,g,b,this.group,A))}},t.extend(t.LabelLetters,t.Container,"clone","zimContainer",!1),t.Emoji=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h){var w="code, size, monochrome, italic, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backing, padding, paddingH, paddingV, shiftH, shiftV, style, group, inherit",P;if(P=st(t.Emoji,arguments,w,this))return P;De("54.58"),this.group=T;var y=A===!1?{}:t.getStyle("Emoji",this.group,h);n(e)&&(e=y.code!=null?y.code:"\u{1F642}"),n(r)&&(r=y.size!=null?y.size:30),n(i)&&(i=y.monochrome!=null?y.monochrome:!1),n(l)&&(l=y.italic!=null?y.italic:!1),(n(a)||a=="ignore")&&(a=y.backgroundColor!=null&&a!="ignore"?y.backgroundColor:null),n(s)&&(s=y.backgroundBorderColor!=null&&s!="ignore"?y.backgroundBorderColor:null),n(f)&&(f=y.backgroundBorderWidth!=null&&f!="ignore"?y.backgroundBorderWidth:null),(n(k)||k=="ignore")&&(k=y.padding!=null&&k!="ignore"?y.padding:10),n(v)&&(v=y.paddingH!=null?y.paddingH:k),n(g)&&(g=y.paddingV!=null?y.paddingV:k),n(b)&&(b=y.shiftH!=null?y.shiftH:0),n(E)&&(E=y.shiftV!=null?y.shiftV:0);var C=O(e,r);this.veeObj={code:C[0],size:C[1]};function O(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),e.substring(0,2)=="U+"&&(e=t.unicodeToUTF(e)),this.zimLabel_constructor(e,r,null,null,null,null,null,null,null,null,l,null,null,null,x,null,null,a,null,null,c,null,k,v,g,b,E),this.type="Emoji",this.code=e,this.size=r;var _=this,Y=this.getBounds(),m=5,$=3;this.bounds=this.setBounds(Y.x+$,Y.y-m+1,Y.width-$*2,Y.height+m),i&&(this.saturation=-100);var I=i;Object.defineProperty(_,"monochrome",{get:function(){return I},set:function(X){X!=I&&(I=X,X&&(this.saturation=X?-100:0))}}),this.cache=function(X,R,q,J){return n(X)?(R=this.getBounds(),this.zimLabel_cache(R.x-20,R.y-20,R.width+40,R.height+40)):this.zimLabel_cache(X,R,q,J),_.z_bc=_.canvas=_.cacheCanvas,this},A!==!1&&t.styleTransforms(this,y),this.clone=function(X){return _.cloneProps(new t.Emoji(X||!t.isPick(C[0])?e:C[0],X||!t.isPick(C[1])?_.size:C[1],i,l,a,s,f,c,x,k,v,g,b,E,A,_.group,h))}},t.extend(t.Emoji,t.Label,["clone","cache"],"zimLabel",!1),t.Button=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le,Ae,re,xe,ke,te,pe,he,ae,Ee,ie,Se){var Le="width, height, label, backgroundColor, rollBackgroundColor, downBackgroundColor, color, rollColor, downColor, borderColor, borderWidth, rollBorderColor, downBorderColor, backing, rollBacking, downBacking, icon, rollIcon, downIcon, corner, dashed, shadowColor, shadowBlur, gradient, gloss, align, valign, indent, indentH, indentV, hitPadding, autoPadding, autoPaddingH, autoPaddingV, rollPersist, toggle, toggleBackgroundColor, rollToggleBackgroundColor, downToggleBackgroundColor, toggleColor, rollToggleColor, downToggleColor, toggleBacking, rollToggleBacking, downToggleBacking, toggleIcon, rollToggleIcon, downToggleIcon, toggleEvent, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, downWaitBackgroundColor, waitColor, rollWaitColor, downWaitColor, waitBacking, rollWaitBacking, downWaitBacking, waitIcon, rollWaitIcon, downWaitIcon, waitModal, waitEnabled, style, group, inherit",Ce;if(Ce=st(t.Button,arguments,Le,this))return Ce;De("55"),this.group=ie;var ee=Ee===!1?{}:t.getStyle("Button",ie,Se);n(e)&&(e=ee.width!=null?ee.width:200),n(r)&&(r=ee.height!=null?ee.height:60),n(j.M)&&(j.M=t.mobile());var Me=f,_e=c,Ye=x;n(f)&&(f=ee.color!=null?ee.color:t.white),n(c)&&(c=ee.rollColor!=null?ee.rollColor:t.white),n(Z)&&(Z=ee.autoPadding!=null?ee.autoPadding:20),n(ne)&&(ne=ee.autoPaddingH!=null?ee.autoPaddingH:Z),n(U)&&(U=ee.autoPaddingV!=null?ee.autoPaddingV:Z),n($)&&($=ee.align!=null?ee.align:"center"),n(I)&&(I=ee.valign!=null?ee.valign:"center"),n(i)&&(n(h)?i=ee.label!=null?ee.label:"PRESS":i=""),typeof i=="string"||typeof i=="number"?i=new t.Label({text:i,size:ee.size!=null?ee.size:36,font:ee.font!=null?ee.font:"arial",color:ee.color!=null&&Me==null?ee.color:f,rollColor:ee.rollColor&&_e==null!=null?ee.rollColor:c,align:$,valign:I,rollPersist:ee.rollPersist!=null?ee.rollPersist:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",shiftV:ee.shiftV!=null?ee.shiftV:0,shiftH:ee.shiftH!=null?ee.shiftH:0,style:!1,group:this.group}):(n(Me)||(i.color=Me),f=i.color,(n(i.rollColor)||!n(_e))&&(i.rollColor=c),c=i.rollColor),n(x)&&(x=ee.downColor!=null?ee.downColor:c),e=="auto"&&(e=i.width+ne*2),r=="auto"&&(r=i.height+U*2),this.zimContainer_constructor(e,r,null,null,!1),this.type="Button",n(l)&&(l=ee.backgroundColor!=null?ee.backgroundColor:t.purple),n(a)&&(a=ee.rollBackgroundColor!=null?ee.rollBackgroundColor:l.lighten(.2)),n(s)&&(s=ee.downBackgroundColor!=null?ee.downBackgroundColor:a);var je=it(l,a,s,f,c,x);this.veeObj={backgroundColor:je[0],rollBackgroundColor:je[1],downBackgroundColor:je[2],color:je[3],rollColor:je[4],downColor:je[5]};function it(){return arguments}l=nt(l),a=nt(a),s=nt(s),f=nt(f),c=nt(c),x=nt(x);var Be=k,qe=v;n(k)&&(k=ee.borderColor!=null?ee.borderColor:null),n(v)&&(v=ee.borderWidth!=null?ee.borderWidth:null),k<0||v<0?k=v=null:k!=null&&v==null&&(v=1),n(g)&&(g=ee.rollBorderColor!=null?ee.rollBorderColor:k),n(b)&&(b=ee.downBorderColor!=null?ee.downBorderColor:g),n(y)&&(y=ee.corner!=null?ee.corner:10),n(O)&&(O=ee.shadowColor!=null?ee.shadowColor:"rgba(0,0,0,.3)"),n(_)&&(_=ee.shadowBlur!=null?ee.shadowBlur:14),n(J)&&(J=ee.hitPadding!=null?ee.hitPadding:0),n(X)&&(X=ee.indent!=null?ee.indent:10),n(R)&&(R=ee.indentH!=null?ee.indentH:X),n(q)&&(q=ee.indentV!=null?ee.indentV:X),n(Y)&&(Y=ee.gradient!=null?ee.gradient:0),n(m)&&(m=ee.gloss!=null?ee.gloss:0);var et=(!n(d)||!n(we)||!n(D)||!n(N)||!n(ue)||!n(fe)||!n(V))&&n(se)&&n(Ae)&&n(re);et&&n(z)&&(z=j.M?"mousedown":"click"),n(B)&&(B=ee.rollPersist!=null?ee.rollPersist:!1),this.rollPersist=B,n(C)&&(C=ee.dashed!=null?ee.dashed:!1),!n(d)&&d.type=="Label"&&pt&&tt("Button() - do not pass Label to toggle parameter - just pass a String"),n(u)&&(u=ee.toggleBackgroundColor!=null?ee.toggleBackgroundColor:l),n(o)&&(o=ee.rollToggleBackgroundColor!=null?ee.rollToggleBackgroundColor:a),n(S)&&(S=ee.downToggleBackgroundColor!=null?ee.downToggleBackgroundColor:o),n(F)&&(F=ee.toggleColor!=null?ee.toggleColor:i.color),n(p)&&(p=ee.rollToggleColor!=null?ee.rollToggleColor:i.rollColor),n(L)&&(L=ee.downToggleColor!=null?ee.downToggleColor:i.rollToggleColor),n(K)&&(K=ee.waitBackgroundColor!=null?ee.waitBackgroundColor:l),n(ge)&&(ge=ee.rollWaitBackgroundColor!=null?ee.rollWaitBackgroundColor:a),n(Q)&&(Q=ee.downWaitBackgroundColor!=null?ee.downWaitBackgroundColor:a),n(ce)&&(ce=ee.waitColor!=null?ee.waitColor:i.color),n(G)&&(G=ee.rollWaitColor!=null?ee.rollWaitColor:i.rollColor),n(le)&&(le=ee.downWaitColor!=null?ee.downWaitColor:G);var ve=this;this.mouseChildren=!1,this.cur("pointer"),ve.focus=!1,ve.rolled=!1;var Pe=Tt(Oe);n(E)&&(E=ee.backing!=null?ee.backing.clone():null),n(E)?ve.backing=new t.Rectangle(e,r,l,null,null,y,C,null,null,!1).centerReg(null,null,!1):ve.backing=E,ve.rollBacking=n(A)?ee.rollBacking!=null?ee.rollBacking.clone():null:A,ve.downBacking=n(T)?ee.downBacking!=null?ee.downBacking.clone():null:T,ve.waitBacking=n(Ae)?ee.waitBacking!=null?ee.waitBacking.clone():null:Ae,ve.rollWaitBacking=n(re)?ee.rollWaitBacking!=null?ee.rollWaitBacking.clone():null:re,ve.downWaitBacking=n(xe)?ee.downWaitBacking!=null?ee.downWaitBacking.clone():null:xe,ve.toggleBacking=n(we)?ee.toggleBacking!=null?ee.toggleBacking.clone():null:we,ve.rollToggleBacking=n(D)?ee.rollToggleBacking!=null?ee.rollToggleBacking.clone():null:D,ve.downToggleBacking=n(N)?ee.downToggleBacking!=null?ee.downToggleBacking.clone():null:N;var oe=["backing","rollBacking","downBacking","toggleBacking","rollToggleBacking","downToggleBacking","waitBacking","rollWaitBacking","downWaitBacking"],Fe,Ze,Xe;for(Xe=0;Xe<oe.length;Xe++)Fe=oe[Xe],Ze=ve[Fe],Ze&&(Ze.type=="Pattern"?Ze=We(Fe,Ze):O!=-1&&_>0&&(Ze.shadow=new Ge.Shadow(O,3,3,_)),Ze.x=e/2,Ze.y=r/2);ve.addChild(ve.backing),v&&(ve.border=new t.Rectangle(e,r,"rgba(0,0,0,0)",k,v,y,C,null,null,!1),ve.addChild(ve.border));function We(ft,bt){if(ve[ft]=new t.Container(e,r,null,null,!1).centerReg(null,null,!1),O!=-1&&_>0){var Gt=new t.Rectangle(e-2,r-2,"#666",null,null,y,null,null,null,!1).center(ve[ft]);Gt.shadow=new Ge.Shadow(O,3,3,_)}var Kt=ve[ft].mask=new t.Rectangle(e,r,ft.indexOf("roll")>=0?a:l,null,null,y,null,null,null,!1).addTo(ve[ft]);return bt.centerReg(Kt),bt.setMask(Kt.shape),ve[ft].pattern=bt,ve[ft]}ve.icon=n(h)?ee.icon!=null?ee.icon.clone():null:h,ve.rollIcon=n(w)?ee.rollIcon!=null?ee.rollIcon.clone():null:w,ve.downIcon=n(P)?ee.downIcon!=null?ee.downIcon.clone():null:P,ve.waitIcon=n(ke)?ee.waitIcon!=null?ee.waitIcon.clone():null:ke,ve.rollWaitIcon=n(te)?ee.rollWaitIcon!=null?ee.rollWaitIcon.clone():null:te,ve.downWaitIcon=n(pe)?ee.downWaitIcon!=null?ee.downWaitIcon.clone():null:pe,ve.toggleIcon=n(ue)?ee.toggleIcon!=null?ee.toggleIcon.clone():null:ue,ve.rollToggleIcon=n(fe)?ee.rollToggleIcon!=null?ee.rollToggleIcon.clone():null:fe,ve.downToggleIcon=n(V)?ee.downToggleIcon!=null?ee.downToggleIcon.clone():null:V;var de=["icon","rollIcon","downIcon","toggleIcon","rollToggleIcon","downToggleIcon","waitIcon","rollWaitIcon","downWaitIcon"];for(Xe=0;Xe<de.length;Xe++){var Ve=de[Xe],be=ve[Ve];be&&(be.x=e/2,be.y=r/2)}if(ve.icon&&ve.addChild(ve.icon),Array.isArray(y)||(y=[y,y,y,y]),Y>0){var Te=new Ge.Shape;Te.graphics.lf(["rgba(255,255,255,"+Y+")","rgba(0,0,0,"+Y+")"],[0,1],0,0,0,r-v),Te.graphics.rc(v/2,v/2,e-v,r-v,y[0],y[1],y[2],y[3]),this.addChild(Te)}if(m>0){var Re=new Ge.Shape;Re.graphics.f("rgba(255,255,255,"+m+")"),Re.graphics.rc(v/2,v/2,e-v,(r-v)/2,y[0],y[1],0,0),Re.graphics.f("rgba(0,0,0,"+m+")"),Re.graphics.rc(v/2,r/2,e-v,(r-v)/2,0,0,y[2],y[3]),this.addChild(Re)}var Ne,Ue;J>0&&rt();function rt(){Ue=new Ge.Shape,Ue.graphics.f("#000").r(-J,-J,e+J*2,r+J*2),ve.hitArea=Ne=Ue}this.addChild(i),i.center(this),i.y+=1,this.label=i,t.pos(i,$=="left"||$=="right"?R:null,I=="top"||I=="bottom"?q:null,$=="right",I=="bottom");var me=i.color;if(this.toggled=!1,et){var He=i.text,at=i.color,Qe=i.rollColor;this.on(z,function(){ve.toggled=!ve.toggled,ct()})}function ct(){ve.toggled?(n(d)||(ve.label.text=d===!0?He:d),n(F)||(ve.label.colorOnly=me=F),n(p)||(ve.label.rollColor=p),ve.rolled?(ve.rollToggleBacking?kt("rollToggleBacking"):ve.toggleBacking&&kt("toggleBacking"),ve.rollToggleIcon?kt("rollToggleIcon"):ve.toggleIcon&&kt("toggleIcon"),n(E)&&n(ve.rollToggleBacking)&&(ve.backing.color=o)):(ve.toggleBacking&&kt("toggleBacking"),ve.toggleIcon&&kt("toggleIcon"),n(E)&&(ve.backing.color=u))):(ve.label.colorOnly=me=at,ve.label.rollColor=Qe,ve.rolled&&ve.label.showRollColor(!0),ve.label.text=He,ot()),ve.stage&&ve.stage.update()}function ot(){ve.pressed?(n(E)&&ve.backing&&!ve.downBacking&&(ve.backing.color=s),ve.downBacking?kt("downBacking"):ve.rollBacking?kt("rollBacking"):ve.backing&&kt("backing"),ve.downIcon?kt("downIcon"):ve.rollIcon?kt("rollIcon"):ve.icon?kt("icon"):kt("icon",null)):ve.rolled?(n(E)&&ve.backing&&!ve.rollBacking&&(ve.backing.color=a),ve.rollBacking?kt("rollBacking"):ve.backing&&kt("backing"),ve.rollIcon?kt("rollIcon"):ve.icon?kt("icon"):kt("icon",null)):(n(E)&&ve.backing&&(ve.backing.color=l),ve.backing&&kt("backing"),ve.icon,kt("icon"))}this.toggle=function(ft){return et?(n(ft)?ve.toggled=!ve.toggled:ve.toggled=ft,ct(),ve):(pt&&tt("Button() - can't toggle with wait parameters provided"),ve)};var dt=!1;ve.waiting=!1;var $e=!1,Mt,Ct,xt=ve.label.color,Bt=ve.label.rollColor,Rt,Ht,nn=this.on("mousedown",function(){dt=!0,en()});function en(){(!n(se)||!n(Ae)||!n(re))&&!ve.waiting&&($e=!0,n(ae)&&(ae=!0),he&&(Ht=ve.stage.on("stagemousedown",function(ft){ve.hitTestPoint(ft.stageX/t.scaX,ft.stageY/t.scaY)||ve.clearWait()},null,!0)),setTimeout(function(){ve.waiting=!0},50),Ct=i.text,n(ce)||(ve.label.colorOnly=me=ce),n(G)||(ve.label.rollColor=G),Rt=ve.enabled,!ae&&ve.enabled&&(ve.enabled=!1),n(se)||(ve.label.text=se),ve.rolled?(n(E)&&!ve.rollWaitBacking&&(ve.backing.color=ge),ve.rollWaitBacking?kt("rollWaitBacking"):ve.waitBacking&&kt("waitBacking"),ve.rollWaitIcon?kt("rollWaitIcon"):ve.waitIcon&&kt("waitIcon")):(n(E)&&!ve.waitBacking&&(ve.backing.color=K),ve.waitBacking&&kt("waitBacking"),ve.waitIcon&&kt("waitIcon")),n(Oe)&&(Oe=Pe=="s"?5:5e3),Mt&&Mt.clear(),Mt=t.timeout(Oe,function(){ve.enabled||(ve.enabled=Rt),ve.clearWait(),ve.dispatchEvent("waited")}),ve.stage&&ve.stage.update())}this.wait=en,this.clearWait=function(){return Mt&&(Ht&&ve.stage.off("stagemousedown",Ht),Mt.clear(),ve.label.text=Ct,ot(),ve.label.colorOnly=me=xt,ve.label.rollColor=Bt,setTimeout(function(){ve.waiting=!1},55),$e=!1,ve.stage&&ve.stage.update()),ve},this.removeWait=function(){return ve.clearWait(),se=null,ve.waitBacking=null,ve.rollWaitBacking=null,ve.off("mousedown",nn),ve};function kt(ft,bt){var Gt;if(ft.indexOf("con")>=0){for(Gt=0;Gt<de.length;Gt++){var Kt=de[Gt],fn=ve[Kt];ve.removeChild(fn)}ve[ft]&&ve.addChildAt(ve[ft],1)}else{if(!ve[ft]&&!bt)return;for(Gt=0;Gt<oe.length;Gt++){var Jt=oe[Gt],rn=ve[Jt];ve.removeChild(rn)}ve[ft]&&ve.addChildAt(ve[ft],0)}}var Qt=!1;this.on("mouseover",function(ft){ve.stage&&ve.stage.frame.leftMouseDown&&!gt||Je()});function Je(){ve.rolled=!0,Qt=!0,$e?(ve.pressed&&ve.downWaitBacking?kt("downWaitBacking"):ve.pressed&&ve.downBacking?kt("downBacking"):ve.rollWaitBacking?kt("rollWaitBacking"):ve.waitBacking?kt("waitBacking"):ve.rollBacking?kt("rollBacking"):kt("backing"),ve.pressed&&ve.downWaitIcon?kt("downWaitIcon"):ve.rollWaitIcon?kt("rollWaitIcon"):ve.waitIcon?kt("waitIcon"):ve.rollIcon?kt("rollIcon"):kt("icon",!0)):et&&ve.toggled?(ve.pressed&&ve.downToggleBacking?kt("downToggleBacking"):ve.pressed&&ve.downBacking?kt("downBacking"):ve.rollToggleBacking?kt("rollToggleBacking"):ve.toggleBacking?kt("toggleBacking"):ve.rollBacking?kt("rollBacking"):kt("backing"),ve.pressed&&ve.downToggleIcon?kt("downToggleIcon"):ve.rollToggleIcon?kt("rollToggleIcon"):ve.toggleIcon?kt("toggleIcon"):ve.rollIcon?kt("rollIcon"):kt("icon",!0)):(ve.pressed&&ve.downBacking?kt("downBacking"):ve.rollBacking?kt("rollBacking"):kt("backing"),ve.pressed&&ve.downIcon?kt("downIcon"):ve.rollIcon?kt("rollIcon"):kt("icon",!0)),ve.pressed?n(E)&&ve.backing?ve.backing.color=s:E&&!n(E.mask)&&ve.backing&&(ve.backing.mask.color=s):n(E)&&ve.backing?ve.backing.color=a:E&&!n(E.mask)&&ve.backing&&(ve.backing.mask.color=a),ve.border&&(ve.border.borderColor=ve.pressed?b:g),ve.pressed?ve.label.colorOnly=x:ve.label.showRollColor?ve.label.showRollColor():ve.label.colorOnly=me,ve.stage&&ve.stage.update()}var gt=!1;this.on("mousedown",function(){ve.pressed=gt=!0,Je(),ve.rolled}),this.on("pressup",function(){ve.pressed=gt=dt=!1,Qt?Je():ve.rollPersist&&Xt(),j.M&&It()}),this.on("pressmove",function(){var ft=ve.stage?ve.stage.frame:j.zdf,bt=ve.hitTestPoint(ft.mouseX,ft.mouseY);gt&&!bt?(It(),gt=!1):!gt&&bt&&(Je(),gt=!0)}),this.on("mouseout",It);function It(){Qt=!1,ve.rollPersist&&dt||Xt()}function Xt(){ve.rolled=!1,$e||ve.waiting?(n(E)&&ve.backing&&n(ve.waitBacking)&&(ve.backing.color=n(K)?l:K),ve.waitBacking?kt("waitBacking"):ve.backing&&kt("backing"),ve.waitIcon?kt("waitIcon"):ve.icon?kt("icon"):kt("icon",null)):ve.toggled&&et?(n(E)&&ve.backing&&n(ve.toggleBacking)&&(ve.backing.color=u),ve.toggleBacking?kt("toggleBacking"):ve.backing&&kt("backing"),ve.toggleIcon?kt("toggleIcon"):ve.icon?kt("icon"):kt("icon",null)):(n(E)&&ve.backing?ve.backing.color=l:E&&!n(E.mask)&&ve.backing&&(ve.backing.mask.color=l),ve.backing&&kt("backing"),ve.icon?kt("icon"):kt("icon",null)),ve.border&&(ve.border.borderColor=k),ve.label.colorOnly=me,ve.label.showRollColor&&ve.label.showRollColor(!1),ve.stage&&ve.stage.update()}ve.removeRoll=Xt,ve.rollBacking&&ve.rollBacking.removeFrom(),Object.defineProperty(ve,"text",{get:function(){var ft=i.text==" "?"":i.text;return ft},set:function(ft){i.text=ft,He&&(He=ft),i.center(this),i.y+=1,t.pos(i,$=="left"||$=="right"?R:null,I=="top"||I=="bottom"?q:null,$=="right",I=="bottom")}}),Object.defineProperty(ve,"color",{get:function(){return f},set:function(ft){f=ft,at&&(at=f),ve.label&&!n(ve.label.color)&&(ve.label.color=me=f),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&ve.stage&&ve.stage.update()}}),Object.defineProperty(ve,"rollColor",{get:function(){return c},set:function(ft){c=ft,Qe&&(Qe=c),ve.label&&(ve.label.rollColor=c)}}),Object.defineProperty(ve,"downColor",{get:function(){return x},set:function(ft){x=ft,originalDownColor&&(originalDownColor=x),ve.label&&(ve.label.downColor=x)}}),Object.defineProperty(ve,"backgroundColor",{get:function(){return l},set:function(ft){l=ft,ve.backing.color?ve.backing.color=l:ve.backing.mask&&(ve.backing.mask.color=l),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&ve.stage&&ve.stage.update()}}),Object.defineProperty(ve,"rollBackgroundColor",{get:function(){return a},set:function(ft){a=ft,ve.rollBacking&&ve.rollBacking.color?ve.rollBacking.color=a:ve.rollBacking&&ve.rollBacking.mask&&(ve.rollBacking.mask.color=a)}}),Object.defineProperty(ve,"toggleBackgroundColor",{get:function(){return u},set:function(ft){u=ft,ve.toggleBacking&&ve.toggleBacking.color?ve.toggleBacking.color=u:ve.toggleBacking&&ve.toggleBacking.mask&&(ve.toggleBacking.mask.color=u)}}),Object.defineProperty(ve,"rollToggleBackgroundColor",{get:function(){return o},set:function(ft){o=ft,ve.rollToggleBacking&&ve.rollToggleBacking.color?ve.rollToggleBacking.color=o:ve.rollToggleBacking&&ve.rollToggleBacking.mask&&(ve.rollToggleBacking.mask.color=o)}}),Object.defineProperty(ve,"downBackgroundColor",{get:function(){return s},set:function(ft){s=ft,ve.downBacking&&ve.downBacking.color?ve.downBacking.color=s:ve.downBacking&&ve.downBacking.mask&&(ve.downBacking.mask.color=s)}}),Object.defineProperty(ve,"borderColor",{get:function(){return k},set:function(ft){k=ft,ve.rolled||(ve.backing&&ve.backing.borderColor&&(ve.backing.borderColor=ft),ve.border&&(ve.border.borderColor=ft))}}),Object.defineProperty(ve,"rollBorderColor",{get:function(){return g},set:function(ft){g=ft,ve.rolled&&(ve.backing&&ve.backing.borderColor&&(ve.backing.borderColor=ft),ve.border&&(ve.border.borderColor=ft))}}),Object.defineProperty(ve,"hitPadding",{get:function(){return J},set:function(ft){J=ft,J==0?Ne&&(this.hitArea=null):rt()}}),this._enabled=!0,this.startMouseChildren=this.mouseChildren,Object.defineProperty(ve,"enabled",{get:function(){return ve._enabled},set:function(ft){ve._enabled&&(ve.startMouseChildren=ve.mouseChildren),ft?(St(ve,ft),ve.mouseChildren=ve.startMouseChildren):(Xt(),St(ve,ft));var bt=i.color;i.color=me=bt,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&ve.stage&&ve.stage.update()}}),this.setBacking=function(ft,bt){Yt(ft,bt)},this.setIcon=function(ft,bt){Yt(ft,bt)};function Yt(ft,bt){return n(ft)||(ve.contains(ve[ft])&&(ve.removeChild(ve[ft]),bt&&ve.addChildAt(bt,ft.indexOf("con")>=0?ve.numChildren-1:0),ve.stage&&ve.stage.update()),bt?(n(E)&&ft=="backing"&&(E=bt),bt.type=="Pattern"&&(bt=We(ft,bt)),ve[ft]=bt,ve[ft].x=e/2,ve[ft].y=r/2):ve[ft]=null,ot()),ve}Ee!==!1&&t.styleTransforms(this,ee),this.clone=function(ft){var bt=new t.Button(e,r,i.clone(),ft||!t.isPick(je[0])?l:je[0],ft||!t.isPick(je[1])?a:je[1],ft||!t.isPick(je[2])?s:je[2],ft||!t.isPick(je[3])?f:je[3],ft||!t.isPick(je[4])?c:je[4],ft||!t.isPick(je[5])?x:je[5],Be,qe,g,b,n(E)?null:ve.backing.clone(),n(A)?null:ve.rollBacking.clone(),n(T)?null:ve.downBacking.clone(),n(h)?null:h.clone(),n(w)?null:w.clone(),n(P)?null:P.clone(),y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,n(we)?null:we.clone(),n(D)?null:D.clone(),n(N)?null:N.clone(),n(ue)?null:ue.clone(),n(fe)?null:fe.clone(),n(V)?null:V.clone(),z,se,Oe,K,ge,Q,ce,G,le,n(Ae)?null:Ae.clone(),n(re)?null:re.clone(),n(xe)?null:xe.clone(),n(ke)?null:ke.clone(),n(te)?null:te.clone(),n(pe)?null:pe.clone(),he,ae,Ee,this.group,Se);return ve.cloneProps(bt)},this.doDispose=function(ft,bt,Gt){return ve.icon&&ve.icon.dispose(),ve.rollIcon&&ve.rollIcon.dispose(),ve.downIcon&&ve.downIcon.dispose(),ve.waitIcon&&ve.waitIcon.dispose(),ve.rollWaitIcon&&ve.rollWaitIcon.dispose(),ve.downWaitIcon&&ve.downWaitIcon.dispose(),ve.toggleIcon&&ve.toggleIcon.dispose(),ve.rollToggleIcon&&ve.rollToggleIcon.dispose(),ve.downToggleIcon&&ve.downToggleIcon.dispose(),ve.icon=ve.rollIcon=ve.downIcon=ve.waitIcon=ve.rollWaitIcon=ve.downWaitIcon=ve.toggleIcon=ve.rollToggleIcon=ve.downToggleIcon=null,Gt||this.zimContainer_dispose(!0),!0}},t.extend(t.Button,t.Container,["clone","dispose"],"zimContainer",!1),t.Button.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.CheckBox=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T){var h="size, label, startChecked, color, backgroundColor, borderColor, borderWidth, corner, margin, indicatorType, indicatorColor, tap, rtl, style, group, inherit",w;if(w=st(t.CheckBox,arguments,h,this))return w;De("56"),this.zimContainer_constructor(null,null,null,null,!1),this.type="CheckBox",this.group=A;var P=E===!1?{}:t.getStyle(this.type,this.group,T);n(e)&&(e=P.size!=null?P.size:60),n(r)&&(r=P.label!=null?P.label:null),n(i)&&(i=P.startChecked!=null?P.startChecked:!1),n(l)&&(l=P.color!=null?P.color:t.darker),n(a)&&(a=P.backgroundColor!=null?P.backgroundColor:t.white.toAlpha(.8)),n(s)&&(s=P.borderColor!=null?P.borderColor:t.darker),n(f)&&(f=P.borderWidth!=null?P.borderWidth:e/10),s<0||f<0?s=f=null:s!=null&&f==null&&(f=e/10),n(c)&&(c=P.corner!=null?P.corner:0),n(x)&&(x=P.margin!=null?P.margin:e/5),k!="box"&&k!="square"&&k!="x"&&(k=P.indicatorType!=null?P.indicatorType:"check"),n(v)&&(v=P.indicatorColor!=null?P.indicatorColor:f>0?s:t.black),this.setBounds(-x,-x,e+x*2,e+x*2),n(g)&&(g=P.tap!=null?P.tap:!1),n(b)&&(b=P.rtl!=null?P.rtl:j.DIR=="rtl");var y=this;this.cur("pointer");var C=O(r,i);this.veeObj={label:C[0],startChecked:C[1]};function O(){return arguments}r=t.Pick.choose(r),i=t.Pick.choose(i);var _=i;(typeof r=="string"||typeof r=="number")&&(r=new t.Label({text:r,size:e*5/6,color:l,valign:"center",align:b?"right":"left",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:E,group:this.group}));var Y=this.box=new t.Rectangle(e,e,a,null,null,c),m=this.box2=new t.Rectangle(e*5/7,e*5/7,"rgba(0,0,0,0)",s,f,c);m.x=e/7,m.y=e/7,this.addChild(Y,m);var $=e;r&&(r.center(y),this.label=r,b?(r.x=-x,this.setBounds(-r.width-x*2,-x,e+x*3+r.getBounds().width,Math.max(e+x*2,r.getBounds().height)),$=e+r.width+x,this.regX=e):(r.x=y.getBounds().width,this.setBounds(-x,-x,e+x*4+r.getBounds().width,Math.max(e+x*2,r.getBounds().height)),$=r.x+r.width));var I=new t.Shape({style:!1}),X=I.graphics;X.f("rgba(0,0,0,.01)").r(this.getBounds().x,this.getBounds().y,$+x*2,this.getBounds().height),this.hitArea=I;var R=new t.Shape({style:!1}),q=R.graphics;k=="check"?q.f(v).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"):k=="box"||k=="square"?q.f(v).dr(-35,-35,70,70):q.f(v).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg");var J=95;R.setBounds(-J/2,-J/2,J,J);var Z=e/(J+66);R.scaleX=R.scaleY=Z,R.alpha=.9,R.x=e/2,R.y=e/2,_&&this.addChild(R),g?this.tap(ne):this.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",ne),Object.defineProperty(y,"checked",{get:function(){return _},set:function(U){y.setChecked(U)}}),this.toggle=function(U){n(U)&&(U=!_),y.setChecked(U)},Object.defineProperty(y,"toggled",{get:function(){return _},set:function(U){y.setChecked(U)}}),Object.defineProperty(y,"text",{get:function(){return r?r.text:null},set:function(U){r&&(r.text=U,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&y.stage&&y.stage.update())}}),Object.defineProperty(R,"indicatorColor",{get:function(){return v},set:function(U){_&&y.removeChild(R),R=new Ge.Shape,q=R.graphics,v=U,q.f(v).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"),R.scaleX=R.scaleY=Z,R.alpha=.9,R.x=e/2,R.y=e/2,_&&y.addChild(R),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&y.stage&&y.stage.update()}}),Object.defineProperty(y,"indicator",{get:function(){return R},set:function(){tt("ZIM CheckBox - check is read only")}}),this._enabled=!0,Object.defineProperty(y,"enabled",{get:function(){return y._enabled},set:function(U){St(y,U)}});function ne(){_=!_,y.setChecked(_),y.dispatchEvent("change")}this.setChecked=function(U){return n(U)&&(U=!0),_=U,_?y.addChild(R):y.removeChild(R),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&y.stage&&y.stage.update(),y},E!==!1&&t.styleTransforms(this,P),this.clone=function(U){return y.cloneProps(new t.CheckBox(e,U||!t.isPick(C[0])?r?r.clone():null:C[0],U||!t.isPick(C[1])?i:C[1],l,a,s,f,c,x,k,v,g,b,E,this.group,T))}},t.extend(t.CheckBox,t.Container,"clone","zimContainer",!1),t.RadioButtons=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T){var h="size, buttons, vertical, color, backgroundColor, borderColor, borderWidth, spacing, margin, always, indicatorColor, selectedIndex, rtl, style, group, inherit",w;if(w=st(t.RadioButtons,arguments,h,this))return w;De("57"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadioButtons",this.group=A;var P=E===!1?{}:t.getStyle(this.type,this.group,T);n(e)&&(e=P.size!=null?P.size:60),e=Math.max(5,e),n(r)&&(r=P.buttons!=null?P.buttons:["A","B","C"]),n(i)&&(i=P.vertical!=null?P.vertical:!0),n(l)&&(l=P.color!=null?P.color:t.darker),n(a)&&(a=P.backgroundColor!=null?P.backgroundColor:"rgba(255,255,255,.8)"),n(s)&&(s=P.borderColor!=null?P.borderColor:t.darker),n(f)&&(f=P.borderWidth!=null?P.borderWidth:e/9),s<0||f<0?s=f=null:s!=null&&f==null&&(f=e/10),n(c)&&(c=i?P.spacing!=null?P.spacing:e*.2:P.spacing!=null?P.spacing:e),n(x)&&(x=P.margin!=null?P.margin:e/5),n(k)&&(k=P.always!=null?P.always:!1),n(v)&&(v=P.indicatorColor!=null?P.indicatorColor:f>0?s:t.black),n(b)&&(b=P.rtl!=null?P.rtl:j.DIR=="rtl");var y=this;this.cur("pointer"),this.labels=[],this.indicators=[];var C=0,O;if(typeof r=="string"){var _=r;r=[];for(var Y=0;Y<_.length;Y++)r.push({label:_[Y]})}var m=new t.Container({style:!1});this.addChild(m);function $(J){var Z=m.getChildIndex(J.target);k&&y.selectedIndex==Z||(y.setSelected(Z),y.dispatchEvent("change"))}R();for(var I,X=0;X<m.numChildren;X++)I=m.getChildAt(X),I.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",$);function R(){var J,Z=!1,ne;for(ne=r.length-1;ne>=0;ne--)J=r[ne],J.selected&&J.selected===!0&&(Z?J.selected="false":(Z=!0,y.id=J.id));m.removeAllChildren(),y.buttons=[];var U,B=0;for(ne=0;ne<r.length;ne++){if(J=r[ne],typeof J=="string"||typeof J=="number"){var d={selected:!1,label:new t.Label({text:J,size:e*5/6,color:P.color!=null?P.color:l,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:E,group:y.group})};J=d}(J.label&&typeof J.label=="string"||typeof J.label=="number")&&(J.label=new t.Label({text:J.label,size:P.size!=null?P.size:e*5/6,color:P.color!=null?P.color:l,valign:"center",style:E})),y.labels.push(J.label),J.index=ne,r[ne]=J,U=q(J.selected,J.label),U.type="RadioButton",U.obj=J,J.selected&&(O=U.obj),m.addChild(U),i?(U.y=B,B+=U.getBounds().height+c):(U.x=B,B+=U.getBounds().width+c)}}function q(J,Z){var ne=new t.Container({style:!1});y.buttons.push(ne),ne.mouseChildren=!1,ne.setBounds(-x,-x,e+x*2,e+x*2);var U=new t.Shape({style:!1}),B=U.graphics;B.f(a).dc(e/2,e/2,e/1.85),B.s(s).ss(f).dc(e/2,e/2,e/2-e/2/5),ne.addChild(U);var d=ne.check=new t.Circle(e/5.2,v,null,null,null,null,null,null,!1);y.indicators.push(d),d.mouseEnabled=!1,d.alpha=.95,d.regX=d.regY=-e/2;var u=e;Z&&(C==0&&(C=Z.width),ne.addChild(Z),Z.y=e/2,ne.text=Z.text,b?(Z.x=-Z.width-x,ne.setBounds(-Z.width-x,-x,e+x*2+Z.getBounds().width,Math.max(e+x*2,Z.getBounds().height)),u=Z.width+x+e):(Z.x=ne.getBounds().width,ne.setBounds(-x,-x,e+x*2+Z.getBounds().width,Math.max(e+x*2,Z.getBounds().height)),u=Z.x+Z.width)),J&&(ne.addChild(d),y.label=Z,y.label&&(y.text=Z.text));var o=new t.Shape({style:!1});return B=o.graphics,B.f("rgba(0,0,0,.01)").r(ne.getBounds().x,ne.getBounds().y,u+x*2,ne.getBounds().height),ne.hitArea=o,ne}this.getBounds()||this.setBounds(0,0,e,e),b?(this.setBounds(-x*2-C,-x,this.getBounds().width+x*2,this.getBounds().height),this.regX=i?e+x:this.getBounds().width-C-x*3):this.setBounds(-x,-x,this.getBounds().width+x*2,this.getBounds().height),this.setSelected=function(J){if(n(J)&&(J=-1),!(J!=-1&&!m.getChildAt(J))){for(var Z,ne=0;ne<m.numChildren;ne++)Z=m.getChildAt(ne),Z.removeChild(Z.check);if(J>=0){Z=m.getChildAt(J);var U=-2;O&&(U=O.index),O=Z.obj}return J==-1||U==O.index?(O=null,y.id=null,y.label=null,y.text=""):(Z.addChild(Z.check),y.id=O.id,y.label=O.label,y.label&&(y.text=y.label.text)),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&y.stage&&y.stage.update(),y}},Object.defineProperty(y,"selected",{get:function(){return O},set:function(){tt("ZIM RadioButton - selected is read only")}}),Object.defineProperty(y,"selectedIndex",{get:function(){return O?O.index:-1},set:function(J){var Z=J;y.selectedIndex!=J&&y.setSelected(Z)}}),this._enabled=!0,Object.defineProperty(y,"enabled",{get:function(){return y._enabled},set:function(J){St(y,J)}}),n(g)&&(g=P.selectedIndex!=null?P.selectedIndex:0),y.selectedIndex=g,E!==!1&&t.styleTransforms(this,P),this.clone=function(){for(var J=t.copy(r),Z=0;Z<J.length;Z++)J[Z].label=J[Z].label.clone();return y.cloneProps(new t.RadioButtons(e,J,i,l,a,s,f,c,x,k,v,g,b,E,this.group,T))}},t.extend(t.RadioButtons,t.Container,"clone","zimContainer",!1),t.Toggle=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O){var _="width, height, label, startToggled, backgroundColor, margin, indicatorType, indicatorColor, tap, toggleBackgroundColor, color, borderColor, borderWidth, corner, indicatorCorner, shadowColor, shadowBlur, time, labelLeft, style, group, inherit",Y;if(Y=st(t.Toggle,arguments,_,this))return Y;De("57.5"),this.group=C;var m=y===!1?{}:t.getStyle("Toggle",this.group,O);n(e)&&(e=m.width!=null?m.width:80),n(r)&&(r=m.height!=null?m.height:50),this.zimContainer_constructor(e,r,null,null,!1),this.type="Toggle",n(a)&&(a=m.backgroundColor!=null?m.backgroundColor:t.purple),n(s)&&(s=m.margin!=null?m.margin:10),n(f)&&(f=m.indicatorType!=null?m.indicatorType:"circle"),n(c)&&(c=m.indicatorColor!=null?m.indicatorColor:t.white),n(k)&&(k=m.toggleBackgroundColor!=null?m.toggleBackgroundColor:a.lighten(.3)),n(v)&&(v=m.color!=null?m.color:t.darker),n(g)&&(g=m.borderColor!=null?m.borderColor:null),n(b)&&(b=m.borderWidth!=null?m.borderWidth:null),g<0||b<0?g=b=null:g!=null&&b==null&&(b=1),n(E)&&(E=m.corner!=null?m.corner:f!="circle"?0:25),n(A)&&(A=m.indicatorCorner!=null?m.indicatorCorner:0),n(T)&&(T=m.shadowColor!=null?m.shadowColor:"rgba(0,0,0,.3)"),n(h)&&(h=m.shadowBlur!=null?m.shadowBlur:14),n(l)&&(l=m.startToggled!=null?m.startToggled:!1);var $=Tt(w);n(w)&&(w=m.time!=null?m.time:$=="s"?.1:100),n(i)&&(i=m.label!=null?m.label:null),n(P)&&(P=m.labelLeft!=null?m.labelLeft:null);var I=this;I.cur("pointer"),(typeof i=="string"||typeof i=="number")&&(i=this.label=new t.Label({text:i,size:m.size||r*5/6,color:v,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),(typeof P=="string"||typeof P=="number")&&(P=this.labelLeft=new t.Label({text:P,size:m.size||r*5/6,color:v,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),this.background=new t.Rectangle(e,r,a,g,b,E).addTo(this),f=="rectangle"||f=="square"?this.indicator=new t.Rectangle(r*.65,r*.65,c,null,null,A).center(this.background).pos(r*.2,null,l):this.indicator=new t.Circle(r*.35,c).center(this.background).pos(r*.175,null,l);var X=l;I.background.color=X?k:a,T!=-1&&h>0&&(this.background.shadow=new Ge.Shadow(T,3,3,h)),i&&(this.addChild(i),i.x=e+2+s+b,i.y=r/2,this.label=i,this.setBounds(-s,-s,e+s*3+b+i.getBounds().width,Math.max(r+s*2,i.getBounds().height))),P&&(this.addChild(P),P.x=0,I.background.x+=P.width+3+s+b,I.label.x+=P.width+3+s+b,P.y=r/2,this.labelLeft=P,this.setBounds(-s,-s,I.getBounds().width+P.width+3+s+b,I.getBounds().height)),this.expand(t.mobile()?20:10),this.tap(function(J){if(P){var Z=I.localToGlobal(P.width+3+s+b+e/2,0);if(J.stageX/t.scaX<Z.x-e/2&&!X||J.stageX/t.scaX>=Z.x+e/2&&X)return}X=!X,q(),I.dispatchEvent("change")},t.mobile()?20:10);var R=new t.Swipe(this,20,$=="s"?.2:200);R.on("swipe",function(J){if(J.swipeX!=0){{if(J.swipeX==1&&X)return;if(J.swipeX==-1&&!X)return}X=!X,q(),I.dispatchEvent("change")}});function q(J){var Z=I.indicator.x,ne=w;if(J===!0&&(ne=0),f=="rectangle"||f=="square"?(I.indicator.pos(r*.2,null,X),w>0&&I.indicator.animate({props:{x:Z},from:!0,time:ne})):(I.indicator.pos(r*.175,null,X),w>0&&I.indicator.animate({props:{x:Z},from:!0,time:ne})),I.background.color=X?k:a,I.text=X?I.label?I.label.text:"on":I.labelLeft?I.labelLeft.text:"off",I.zimAccessibility){var U="Toggle set to "+(X?I.label?I.label.text+".":"on.":I.labelLeft?I.labelLeft.text+".":"off.");setTimeout(function(){I.zimAccessibility.talk(U)},50)}}Object.defineProperty(I,"textLeft",{get:function(){return P?P.text:null},set:function(J){P&&(P.text=J,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&I.stage&&I.stage.update())}}),I.toggle=function(J,Z){var ne=X;return n(J)&&(J=!0),X=J,ne!=X&&q(Z),I},I.text=X?I.label?I.label.text:"on":I.labelLeft?I.labelLeft.text:"off",Object.defineProperty(I,"toggled",{get:function(){return X},set:function(J){I.toggle(J)}}),this._enabled=!0,Object.defineProperty(I,"enabled",{get:function(){return I._enabled},set:function(J){St(I,J)}}),y!==!1&&t.styleTransforms(this,m),this.clone=function(){return I.cloneProps(new t.Toggle(e,r,i?i.clone():"",l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P?P.clone():"",y,this.group,O))}},t.extend(t.Toggle,t.Container,"clone","zimContainer",!1),t.Tip=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N){var ue="text, tipAlign, tipValign, margin, marginH, marginV, outside, target, delay, time, mouseClose, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, bold, italic, variant, splitWords, style, group, inherit",fe;if(fe=st(t.Tip,arguments,ue,this))return fe;De("57.6"),this.group=D;var V=we===!1?{}:t.getStyle("Tip",this.group,N);n(e)&&(e=V.text!=null?V.text:"Here's a tip!"),n(l)&&(l=V.margin!=null?V.margin:40),n(a)&&(a=V.marginH!=null?V.marginH:l),n(s)&&(s=V.marginV!=null?V.marginV:l),n(r)&&(r=V.tipAlign!=null?V.tipAlign:"right"),n(i)&&(i=V.tipValign!=null?V.tipValign:"bottom"),n(f)&&(f=V.outside!=null?V.outside:!1),n(m)&&(m=V.backgroundColor!=null?V.backgroundColor:t.blue),n(E)&&(E=V.color!=null?V.color:t.white),n(X)&&(X=V.corner!=null?V.corner:25),n(R)&&(R=V.backgroundDashed!=null?V.backgroundDashed:null),n(q)&&(q=V.padding!=null?V.padding:10),n(J)&&(J=V.paddingH!=null?V.paddingH:q),n(Z)&&(Z=V.paddingV!=null?V.paddingV:q),(n(T)||T=="ignore")&&(T=V.shadowColor!=null&&T!="ignore"?V.shadowColor:"rgba(0,0,0,.3)"),(n(h)||h=="ignore")&&(h=V.shadowBlur!=null&&h!="ignore"?V.shadowBlur:1),n(x)&&(x=V.delay!=null?V.delay:0);var z=Tt(k);n(k)&&(k=V.time!=null?V.time:z=="s"?2:2e3),n(v)&&(v=V.mouseClose!=null?V.mouseClose:!0),this.zimLabel_constructor(e,g,b,E,A,null,null,w,P,S,F,p,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,L,we,D,t.copy(V)),this.type="Tip",f&&(a=-a,s=-s);var se=this;se.tipAlign=r,se.tipValign=i,this.background.sha(T,3,5,h),this.show=function(Oe,K){var ge=Tt(K);if(n(Oe)&&(Oe=x),n(K)&&(K=k),n(c))if(j.zdf)c=j.zdf.stage;else return se;else if(c.getBounds){if(n(c.stage))return tt("zim display - Waiter(): The container must have a stage property"),se}else return tt("zim Tip(): Please pass in a reference to a container with bounds set as parameter to Tip"),se;Oe>0?se.showID=t.timeout(Oe,Q):Q();function Q(){var ce;c.boundsToGlobal?ce=c.boundsToGlobal():ce=c.getBounds();var G=new t.Container(ce.x,ce.y,ce.width,ce.height);G.zimTemp=!0,G.loc(0,0,c.stage),se.pos(a,s,se.tipAlign,se.tipValign,G),f&&(se.tipAlign=="right"?se.x+=se.width:se.tipAlign=="left"&&(se.x-=se.width),se.tipValign=="bottom"?se.y+=se.height:se.tipValign=="top"&&(se.y-=se.height)),se.addTo(G.stage),G.zimTemp&&G.removeFrom&&(G.removeFrom(),G=null),G=se.stage,se.timeoutID&&se.timeoutID.clear(),se.timeoutID=t.timeout(K,function(){se.hide(),G.stage.update()}),v&&(se.upID&&G.stage.off("stagemouseup",se.upID),se.upID=G.stage.on("stagemouseup",function(){se.hide(),G.stage&&G.stage.update()})),G.stage&&G.stage.update()}return se},this.hide=function(){return this.removeFrom(),this.timeoutID&&this.timeoutID.clear(),this.upID&&c.stage&&c.stage.off("stagemouseup",this.upID),se},this.clear=function(){se.showID&&se.showID.clear(),se.hide()},this.dispose=function(Oe,K,ge){se.upID&&se.stage&&se.stage.off("stagemouseup",se.upID),ge||this.zimLabel_dispose(!0)},we!==!1&&t.styleTransforms(this,V),this.clone=function(){return se.cloneProps(new t.Tip(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,L,we,this.group,N))}},t.extend(t.Tip,t.Label,["dispose","clone"],"zimLabel",!1),t.Pane=function(F,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q){var J="content, backgroundColor, color, width, height, draggable, resets, modal, corner, backdropColor, shadowColor, shadowBlur, center, displayClose, backdropClose, backing, fadeTime, container, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, close, closeColor, autoPadding, autoPaddingH, autoPaddingV, style, group, inherit";if(F&&!F.header&&!F.message&&!F.display&&!F.buttons){var Z;if(Z=st(t.Pane,arguments,J,this))return Z}De("58"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pane";var ne="zim display - Pane(): Please pass in a reference to a container with bounds set as first parameter";if(n(w))if(j.zdf)w=j.zdf.stage;else{tt(ne);return}else if(w.getBounds){if(n(w.getStage)){tt("zim display - Pane(): The container must have a stage property");return}}else{tt(ne);return}this.group=R;var U=X===!1?{}:t.getStyle(this.type,this.group,q);n(l)&&(l=U.width!=null?U.width:"auto"),n(a)&&(a=U.height!=null?U.height:"auto"),n(F)&&(F=U.content!=null?U.content:" "),(typeof F=="string"||typeof F=="number")&&(F=new t.Label({text:F,size:U.size!=null?U.size:40,align:U.align!=null?U.align:"center",valign:U.valign!=null?U.valign:"center",color:U.color!=null?U.color:i,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).noMouse());var B=this.content=F;n(r)&&(r=U.backgroundColor!=null?U.backgroundColor:t.white),n(s)&&(s=U.draggable!=null?U.draggable:!1),n(f)&&(f=U.resets!=null?U.resets:!0),n(c)&&(c=U.modal!=null?U.modal:!0),n(x)&&(x=U.corner!=null?U.corner:20),n(P)&&(P=U.titleBar!=null?U.titleBar:null),n(y)&&(y=U.titleBarColor!=null?U.titleBarColor:null),n(C)&&(C=U.titleBarBackgroundColor!=null?U.titleBarBackgroundColor:null),n(O)&&(O=U.titleBarHeight!=null?U.titleBarHeight:null),n(k)&&(k=U.backdropColor!=null?U.backdropColor:"rgba(0,0,0,.2)"),n(v)&&(v=U.shadowColor!=null?U.shadowColor:"rgba(0,0,0,.3)"),n(g)&&(g=U.shadowBlur!=null?U.shadowBlur:20),n(b)&&(b=U.center!=null?U.center:!0),n(E)&&(E=U.displayClose!=null?U.displayClose:!0),s&&(E=!1),n(A)&&(A=U.backdropClose!=null?U.backdropClose:!0),n(h)&&(h=U.fadeTime!=null?U.fadeTime:0),n(_)&&(_=U.close!=null?U.close:!1),n(Y)&&(Y=U.closeColor!=null?U.closeColor:t.grey),n(m)&&(m=U.autoPadding!=null?U.autoPadding:70),n($)&&($=U.autoPaddingH!=null?U.autoPaddingH:m),n(I)&&(I=U.autoPaddingV!=null?U.autoPaddingV:m);var d=this.backdrop=new t.Shape({style:!1}),u=d.graphics;u.f(k),u.drawRect(-5e3,-5e3,1e4,1e4);var o=this;if(this.add=function(Q,ce,G,le){var Ae="obj, index, center, replace",re;return(re=st(o.add,arguments,Ae,o))?re:(n(G)&&(G=!0),n(le)&&(le=!0),typeof Q=="string"&&(Q=new ti(Q,null,null,i).noMouse()),le&&o.contentContainer.removeAllChildren(),G?Q.center(o.contentContainer,ce):Q.addTo(o.contentContainer,ce),o)},B){var S=t.makeContent(B,l,t.dark),p=["header","message","text","display","buttons","config"];p.forEach(function(ce){S[ce]&&(o[ce]=S[ce])}),o.label=o.message,l=="auto"&&(l=S.width+$*2),a=="auto"&&(a=S.height+I*2)}var F=o.contentContainer=new t.Container(l,a);S&&o.add(S,null,!0),this.setBounds(-l/2,-a/2,l,a);var p=["header","message","text","display","buttons","config"];F&&p.forEach(function(Q){F[Q]&&(o[Q]=F[Q])}),o.label=o.message,o.container=w,d.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",A?we:function(Q){Q.stopImmediatePropagation()});var L=new t.Dictionary(!0);function we(Q){o.dispatchEvent("closing"),setTimeout(function(){se(),o.dispatchEvent("close")},10),Q.stopImmediatePropagation()}d.on("mousedown",function(Q){Q.stopImmediatePropagation()}),this.addChild(d),c||d.noMouse();var D;if(n(T))D=this.backing=new t.Rectangle({width:l,height:a,color:r,corner:x,style:!1});else{if(T.type=="Pattern"){var N=T;D=new t.Rectangle(l,a,r,null,null,x,null,null,null,!1),N.centerReg(D),N.setMask(D.shape)}else D=T;o.display=o.backing=D}if(E&&(D.cur("pointer"),D.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",we)),v!=-1&&g>0&&(D.shadow=new Ge.Shadow(v,8,8,g)),D.on("click",function(Q){Q.stopImmediatePropagation()}),this.resetX,this.resetY,s){D.cur("pointer");var ue,fe;D.on("mousedown",function(Q){isNaN(o.resetX)&&(o.resetX=o.x),isNaN(o.resetY)&&(o.resetY=o.y),ue=Q.stageX/t.scaX-o.x,fe=Q.stageY/t.scaY-o.y,D.cur("pointer")}),D.on("pressmove",function(Q){var ce=ge(Q.stageX/t.scaX-ue,Q.stageY/t.scaY-fe);o.x=ce.x,o.y=ce.y;for(var G,le=0;le<o.numChildren;le++)G=o.getChildAt(le),(G.type=="TextArea"||G.type=="Loader"||G.type=="Tag")&&G.resize();o.stage.update()}),this.on("pressup",function(){D.cur("pointer"),o.stage&&o.stage.update()})}if(D.centerReg(this),F&&F.center(this),!n(P)){typeof P=="string"&&(P=new t.Label(P,null,null,y));var V=o.titleBarLabel=P;n(O)&&(O=V.height*1.5),n(y)&&(y=t.black),n(C)&&(C="rgba(0,0,0,.2)"),o.titleBar=P=new t.Container(l,O,null,null,!1).centerReg(o).mov(0,-a/2+O/2),P.mouseEnabled=!1,P.mouseChildren=!1,o.titleBar.backing=new t.Rectangle(l,O,C,null,null,[x*.95,x*.95,0,0],null,null,null,!1).addTo(P),V.center(P).pos({x:Math.max(x/2,10),reg:!0})}_&&(_=o.close=new t.Shape(-40,-40,80,80,null,!1),_.graphics.f(Y).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),P?_.addTo(o).scaleTo(P,null,50).mov(l/2-Math.max(x/2,10)-_.width/2,-a/2+O/2).expand(40):_.addTo(o).sca(.3).mov(l/2-_.width-3,-a/2+_.height).expand(40),_.cur("pointer"),_.expand(),_.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",we)),Object.defineProperty(o,"text",{get:function(){if(o.message){var Q=o.message.text==" "?"":o.message.text;return Q}else if(o.content.text){var Q=o.content.text==" "?"":o.content.text;return Q}},set:function(Q){o.message?o.message.text=Q:o.content.text&&(o.content.text=Q)}}),this._enabled=!0,Object.defineProperty(o,"enabled",{get:function(){return o._enabled},set:function(Q){St(o,Q)}}),this.hide=function(Q,ce){return n(Q)||(o.closeParams=Q),se(),ce&&(o.dispatchEvent("close"),o.dispatchEvent("change")),o},this.on("removed",z);function z(){o.toggled=!1;var Q,ce;for(ce=0;ce<o.numChildren;ce++)if(Q=o.getChildAt(ce),Q.type=="TextArea"||Q.type=="Loader"||Q.type=="Tag"){var G={obj:Q,depth:o.getChildIndex(Q)};L.add(Q,G)}for(ce=o.numChildren-1;ce>=0;ce--)Q=o.getChildAt(ce),(Q.type=="TextArea"||Q.type=="Loader"||Q.type=="Tag")&&o.removeChild(Q);if(!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&o.container.stage.update(),f&&(isNaN(o.resetX)||(o.x=o.resetX),isNaN(o.resetY)||(o.y=o.resetY)),o.zimAccessibility){var le=o.zimAccessibility;le.resize(o),Oe?Oe.focus():o.zimTabTag.nextSibling.focus(),setTimeout(function(){le.talk("Pane has been closed.")},50)}}function se(){h>0?o.animate({obj:{alpha:0},time:h,call:function(){Q(),o.dispatchEvent("fadedout")}}):Q();function Q(){o.container.removeChild(o),o.closeCall&&o.closeCall(o.closeParams),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&o.container.stage.update(),f&&(isNaN(o.resetX)||(o.x=o.resetX),isNaN(o.resetY)||(o.y=o.resetY))}}var Oe;this.show=function(Q,ce){return n(Q)||(o.closeCall=Q),n(ce)||(o.closeParams=ce),b&&isNaN(o.resetX)&&(o.x=o.container.getBounds().width/2,o.y=o.container.getBounds().height/2),o.container.addChild(o),h>0?(o.alpha=0,o.animate({props:{alpha:1},time:h,call:function(){o.dispatchEvent("fadedin")}})):setTimeout(function(){o.container.stage&&o.container.stage.update()},10),o},this.on("added",K);function K(){for(var Q=0;Q<L.length;Q++)o.addChildAt(L.values[Q].obj,L.values[Q].depth);if(o.zimAccessibility){var ce=o.zimAccessibility;setTimeout(function(){ce.activatedObject&&(Oe=ce.activatedObject.zimTabTag)},50),ce.resize(o),ce.tabIndex=o.zimTabIndex}o.toggled=!0}function ge(Q,ce){return Q=Math.max(l/2,Math.min(o.container.getBounds().width-l/2,Q)),ce=Math.max(a/2,Math.min(o.container.getBounds().height-a/2,ce)),{x:Q,y:ce}}this.toggle=function(Q){return Q===!0?o.show():Q===!1||o.container.contains(o)?o.hide():o.show(),o},X!==!1&&t.styleTransforms(this,U),this.clone=function(){var Q=o.contentContainer.x,ce=o.contentContainer.y,G=o.cloneProps(new t.Pane(t.copy(F),r,i,l,a,s,f,c,x,k,v,g,b,E,A,n(T)?null:T.clone(),h,o.container,P,y,C,O,_,Y,m,$,I,X,this.group,q));return G.contentContainer.x=Q,G.contentContainer.y=ce,G}},t.extend(t.Pane,t.Container,"clone","zimContainer",!1),t.Panel=function(e,r,o,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I){var X="width, height, content, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, close, closeColor, next, nextColor, extraButton, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",R;if(R=st(t.Panel,arguments,X,this))return R;De("57.7"),this.group=$;var q=m===!1?{}:t.getStyle("Panel",this.group,I);n(e)&&(e=q.width!=null?q.width:250),n(r)&&(r=q.height!=null?q.height:300),this.zimContainer_constructor(e,r,null,null,!1),this.type="Panel",n(o)&&(o=q.content!=null?q.content:null);var J=this.content=o;n(l)&&(l=q.titleBar!=null?q.titleBar:"PANEL"),n(a)&&(a=q.titleBarColor!=null?q.titleBarColor:t.white),n(s)&&(s=q.titleBarBackgroundColor!=null?q.titleBarBackgroundColor:t.grey),n(f)&&(f=q.titleBarHeight!=null?q.titleBarHeight:30),n(c)&&(c=q.backgroundColor!=null?q.backgroundColor:t.lighter),n(x)&&(x=q.borderColor!=null?q.borderColor:t.pewter),n(k)&&(k=q.borderWidth!=null?q.borderWidth:null),x<0||k<0?x=k=null:x!=null&&k==null&&(k=1),n(v)&&(v=q.corner!=null?q.corner:5),n(y)&&(y=q.align!=null?q.align:"left"),n(C)&&(C=q.shadowColor!=null?q.shadowColor:"rgba(0,0,0,.3)"),n(O)&&(O=q.shadowBlur!=null?q.shadowBlur:14),n(_)&&(_=q.draggable!=null?q.draggable:!1),n(Y)&&(Y=q.boundary!=null?q.boundary:null),n(g)&&(g=q.close!=null?q.close:!1),n(b)&&(b=q.closeColor!=null?q.closeColor:n(a)?t.grey:a),n(E)&&(E=q.next!=null?q.next:t.vee(l)),n(A)&&(A=q.nextColor!=null?q.nextColor:n(a)?t.grey:a),Array.isArray(v)||(v=[v,v,v,v]),n(h)&&(h=q.collapse!=null?q.collapse:!1),n(w)&&(w=q.collapseColor!=null?q.collapseColor:n(a)?t.grey:a),n(P)&&(P=q.collapsed!=null?q.collapsed:!1);var Z=this,ne=this.background=new t.Rectangle(e,r,c,x,k,v).addTo(this);C!=-1&&O>0&&(this.background.shadow=new Ge.Shadow(C,3,3,O));var U=l,B=t.Pick.choose(U),d=t.Pick.choose(a),u=t.Pick.choose(s),o=Z.contentContainer=new t.Container(e,r-f).addTo(Z).mov(0,f);typeof B=="string"&&(B=new t.Label({text:B,color:d,size:q.size!=null?q.size:20,bold:q.bold!=null?q.bold:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var S=Z.titleBarLabel=B;n(u)&&(u="rgba(0,0,0,.2)"),Z.titleBar=l=new t.Container(e,f,null,null,!1).loc(0,0,Z);var F=Z.titleBar.backing=new t.Rectangle(e+k,f,u,null,null,[v[0]*.95,v[1]*.95,0,0],!0,null,null,!1).center(l);if(l&&D(),Z.label=B,Z.text=B.text,g){var p=Z.closeIcon=new t.Shape(-40,-40,80,80,null,!1);p.graphics.f(b).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),l?(p.centerReg(l).scaleTo(l,null,50),p.pos(Math.max(v[1]/2,15),null,!0)):p.addTo(Z).sca(.3).mov(e/2-p.width-3,-r/2+g.height),p.expand(40),p.cur("pointer"),p.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var V=Z.stage;Z.removeFrom(),Z.dispatchEvent("close"),V.update()})}if(this.add=function(V,z,se,Oe){var K="obj, index, center, replace",ge;return(ge=st(Z.add,arguments,K,Z))?ge:(Oe&&Z.contentContainer.removeAllChildren(),se?V.center(Z.contentContainer,z):V.addTo(Z.contentContainer,z),Z)},J){var L=t.makeContent(J,e),we=["header","message","text","display","buttons","config"];we.forEach(function(V){L[V]&&(Z[V]=L[V])}),Z.label=Z.message,Z.add(L,null,!0)}this.nextPanel=function(V,z){var se=n(V)||n(U.array)?t.Pick.choose(U):U.array[V],Oe=n(V)||n(a.array)?t.Pick.choose(a):a.array[V],K=n(V)||n(s.array)?t.Pick.choose(s):s.array[V],ge=n(V)||n(c.array)?t.Pick.choose(c):c.array[V],Q=n(V)||n(x.array)?t.Pick.choose(x):x.array[V];typeof se=="string"&&(se=new t.Label({text:se,color:Oe,size:q.size!=null?q.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),Z.label=se,Z.text=se.text,S.removeFrom(),S=Z.titleBarLabel=se,D(),F.color=K,Z.background.color=ge,Z.background.borderColor=Q,z&&Z.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()};function D(){y=="right"?S.center(l).pos(Math.max(v[0]/2,10),null,!0):y=="center"||y=="middle"?S.center(l):S.center(l).loc(Math.max(v[0]/2,10)),S.mov(0,2)}if(_&&(l.cur("pointer"),l.on("mousedown",function(){Z.drag({rect:Y,currentTarget:!0})}),l.on("pressup",function(){Z.noDrag(!1)})),E>0){var N=Z.nextIcon=new t.Shape(-20,-20,40,40,null,!1);N.graphics.f(a).p("AiJieIETCeIkTCfg"),N.centerReg(l).scaleTo(l,null,70).alp(.8).hov(1).expand(),N.pos(Math.max(v[1]/2,15),null,!0),p&&N.mov(-p.width-8),N.cur("pointer"),N.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){Z.nextPanel(),Z.dispatchEvent("change")})}if(n(T)||(T=Z.extraButton=new t.Button({label:"R",width:50,height:50,corner:5,group:"PanelExtra"}).scaleTo(l,null,70).centerReg(l).expand(),T.pos(Math.max(v[1]/2,15),null,!0),p&&T.mov(-p.width-8),N&&T.mov(-N.width-8)),h){fe=P,Z.collapse=function(V){if(n(V)&&(V=!0),V==fe)return Z;V?(ue.rot(180),ne.visible=!1,o.visible=!1,fe=!0,Z.dispatchEvent("collapse")):(ue.rot(0),ne.visible=!0,o.visible=!0,fe=!1,Z.dispatchEvent("expand")),Z.stage&&Z.stage.update()},Z.collapseEvent=Z.titleBar.on("dblclick",function(){Z.collapsed=!Z.collapsed}),n(w)&&(w=t.grey);var ue=Z.collapseIcon=new t.Triangle(90,90,90,t.faint,w,16);ue.centerReg(Z).scaleTo(l,null,41).pos({x:e-Math.max(v[1]/2,15)-ue.width/2-4,y:f/2,reg:!0}).expand(40),T&&ue.mov(-T.width-8),p&&ue.mov(-p.width-8),N&&ue.mov(-N.width-8),ue.cur("pointer"),ue.expand();var fe=!1;ue.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){fe?Z.collapse(!1):Z.collapse(!0)})}Z.overlay=new t.Rectangle(e,r,null,null,null,v).alp(.3),Object.defineProperty(Z,"panelHeight",{get:function(){return Z.background.height},set:function(V){ne.removeFrom(),ne=this.background=new t.Rectangle(e,V,c,x,k,v).addTo(this).bot(),C!=-1&&O>0&&(this.background.shadow=new Ge.Shadow(C,3,3,O)),Z.setBounds(e,V),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}),Object.defineProperty(Z,"collapsed",{get:function(){return fe},set:function(V){Z.collapse&&Z.collapse(V)}}),this._enabled=!0,Object.defineProperty(Z,"enabled",{get:function(){return Z._enabled},set:function(V){St(Z,V),V?Z.overlay.removeFrom():Z.overlay.addTo(Z),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Z.stage&&Z.stage.update()}}),P&&(P=!1,Z.collapsed=!0),m!==!1&&t.styleTransforms(this,q),this.clone=function(){return Z.cloneProps(new t.Toggle(e,r,l?l.clone():"",a,s,f,c,x,k,v,g,b,E,A,T,h,w,Z.collapsed,y,C,O,_,Y,m,this.group,I))},this.doDispose=function(V,z,se){return h&&this.titleBar.off("dblclick",this.collapseEvent),se||this.zimContainer_dispose(!0),!0}},t.extend(t.Panel,t.Container,["clone","dispose"],"zimContainer",!1),t.Panel.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.Window=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se){var Oe="width, height, content, backgroundColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, slide, slideFactor, slideSnap, slideSnapDamp, interactive, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, cancelCurrentDrag, fullSize, fullSizeColor, resizeHandle, collapse, collapseColor, collapsed, optimize, resizeBoundary, resizeVisible, continuous, style, group, inherit",K;if(K=st(t.Window,arguments,Oe,this))return K;De("58.1"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Window",this.group=z;var ge=V===!1?{}:t.getStyle(this.type,this.group,se);n(e)&&(e=ge.width!=null?ge.width:300),n(r)&&(r=ge.height!=null?ge.height:200),n(l)&&(l=ge.backgroundColor!=null?ge.backgroundColor:t.dark);var Q=a,ce=s;n(a)&&(a=ge.borderColor!=null?ge.borderColor:t.silver),n(s)&&(s=ge.borderWidth!=null?ge.borderWidth:1),n(f)&&(f=ge.padding!=null?ge.padding:0),n(c)&&(c=ge.corner!=null?ge.corner:0),n(x)&&(x=ge.swipe!=null?ge.swipe:!0),n(k)&&(k=ge.scrollBarActive!=null?ge.scrollBarActive:!0),n(v)&&(v=ge.scrollBarDrag!=null?ge.scrollBarDrag:!1),n(g)&&(g=ge.scrollBarColor!=null?ge.scrollBarColor:a),n(b)&&(b=ge.scrollBarAlpha!=null?ge.scrollBarAlpha:.3),n(E)&&(E=ge.scrollBarFade!=null?ge.scrollBarFade:!0),n(A)&&(A=ge.scrollBarH!=null?ge.scrollBarH:!0),n(T)&&(T=ge.scrollBarV!=null?ge.scrollBarV:!0),v&&(E=ge.scrollBarFade!=null?ge.scrollBarFade:!1),n(h)&&(h=ge.slide!=null?ge.slide:!0),n(w)&&(w=ge.slideFactor!=null?ge.slideFactor:.9),n(P)&&(P=ge.slideSnap!=null?ge.slideSnap:"vertical"),n(C)&&(C=ge.interactive!=null?ge.interactive:!0),n(O)&&(O=ge.shadowColor!=null?ge.shadowColor:"rgba(0,0,0,.3)"),n(_)&&(_=ge.shadowBlur!=null?ge.shadowBlur:20),n(m)&&(m=ge.paddingV!=null?ge.paddingV:f),n(Y)&&(Y=ge.paddingH!=null?ge.paddingH:f),n($)&&($=ge.scrollWheel!=null?ge.scrollWheel:!0),n(I)&&(I=ge.damp!=null?ge.damp:null),n(X)&&(X=ge.titleBar!=null?ge.titleBar:null),n(R)&&(R=ge.titleBarColor!=null?ge.titleBarColor:null),n(q)&&(q=ge.titleBarBackgroundColor!=null?ge.titleBarBackgroundColor:null),n(J)&&(J=ge.titleBarHeight!=null?ge.titleBarHeight:null),n(Z)&&(Z=ge.draggable!=null?ge.draggable:null),n(ne)&&(ne=ge.boundary!=null?ge.boundary:null),n(U)&&(U=ge.onTop!=null?ge.onTop:null),n(B)&&(B=ge.close!=null?ge.close:null),n(d)&&(d=ge.closeColor!=null?ge.closeColor:null),n(u)&&(u=ge.cancelCurrentDrag!=null?ge.cancelCurrentDrag:!1),n(o)&&(o=ge.fullSize!=null?ge.fullSize:null),n(S)&&(S=ge.fullSizeColor!=null?ge.fullSizeColor:null),n(F)&&(F=ge.resizeHandle!=null?ge.resizeHandle:null),n(p)&&(p=ge.collapse!=null?ge.collapse:!1),n(L)&&(L=ge.collapseColor!=null?ge.collapseColor:null),n(we)&&(we=ge.collapsed!=null?ge.collapsed:!1),n(D)&&(D=ge.optimize!=null?ge.optimize:!0),n(N)&&(N=ge.resizeBoundary!=null?ge.resizeBoundary:null),n(ue)&&(ue=ge.resizeVisible!=null?ge.resizeVisible:!1),n(fe)&&(fe=ge.continuous!=null?ge.continuous:!1),fe!="horizontal"&&fe!="vertical"&&(fe=!1),this.continuous=fe,X===!1&&(X=null),n(X)||(n(J)&&(J=30),r=r-J);var G=this;G.optimize=D,this.scrollX=this.scrollY=this.scrollXMax=this.scrollYMax=0;var le=this.backing=new t.Shape({style:!1});this.addChild(le);var Ae=new Ge.Shape;Ae.type="WindowBacking";var re=Ae.graphics;if(this.addChild(Ae),i)var xe=G.content=i;i=this.contentContainer=new t.Container({style:!1}),this.addChild(i),i.mask=Ae;var ke;if(!C)var te=new Ge.Shape;if(s>0){var pe=new Ge.Shape;this.addChild(pe)}var he=X?0:c,ae=0;function Ee(){G.setBounds(0,0,e,r),le.graphics.c().f(l).rc(0,0,e,r,he,he,c,c),O!=-1&&_>0&&(le.shadow=new Ge.Shadow(O,4,4,_)),s>0&&(c?pe.graphics.c().s(a).ss(s,"square","miter").rc(0,0,e,r,he,he,c,c):pe.graphics.c().s(a).ss(s,"square","miter").dr(0,0,e,r)),n(Ze)||(Ze.widthOnly=G.width+s,Fe.widthOnly=G.width+s-1,G.setBounds(0,-J,G.width,r+J)),Xe&&(X?(Xe.pos({x:e-Math.max(c/2,10)-Xe.width/2,y:J/2,reg:!0}),Fe.widthOnly=Xe.x-15,ae=G.width-Fe.width):Xe.pos(Math.max(c/2,10)/2,Xe.height/2,!0,!1,G)),Ne&&(Ne.pos({x:e-Math.max(c/2,10)-Ne.width/2,y:J/2,reg:!0}),Xe&&Ne.mov(-Xe.width-10),X&&(Fe.widthOnly=Ne.x-15),ae=G.width-Fe.width),me&&(me.pos({x:e-Math.max(c/2,10)-me.width/2,y:J/2,reg:!0}),Xe&&me.mov(-Xe.width-10),Ne&&me.mov(-Ne.width-10),X&&(Fe.widthOnly=me.x-15),ae=G.width-Fe.width)}Ee();var ie=this.scrollBar={};if(ie.color=g,ie.size=6,ie.minSize=ie.size*2,ie.spacing=3.5+s/2,ie.margin=0,ie.corner=ie.size/2,ie.showTime=.5,ie.fadeTime=3,k){var Se=ie.horizontal=new t.Shape({style:!1}),Le=Se.graphics;Se.alpha=b,this.addChild(Se),v&&Se.drag({localBoundary:!0});var Ce=ie.vertical=new t.Shape({style:!1}),ee=Ce.graphics;Ce.alpha=b,this.addChild(Ce),v&&Ce.drag({localBoundary:!0})}var Me,_e,Ye,je,it,Be,qe,et,ve,Pe=!1;if(this.update=function(){k&&(Le.clear(),ee.clear()),it=k?ie.size+ie.spacing*2:0,Be=i.getBounds()?i.getBounds().width:0,qe=i.getBounds()?i.getBounds().height:0,Ye=A&&Be>e-Y&&(k||x===!0||x=="auto"||x=="horizontal"),je=T&&qe>r-m&&(k||x===!0||x=="auto"||x=="vertical"),G.scrollXMax=Be+Y*2-e+(je?it+ie.margin:0),G.scrollYMax=qe+m*2-r+(Ye?it+ie.margin:0),re.clear();var vt=s/2,ze=s/2,wt=e-(je&&k?ie.size+ie.spacing*2:0)-(je?0:s),Wt=r-(Ye&&k?ie.size+ie.spacing*2:0)-(Ye?0:s),_t=c*(.1+c/100);re.f("rgba(0,0,0,0)").rc(vt,ze,wt,Wt,Ye&&k&&!X?_t:he,je&&k&&!X?_t:he,je&&k?_t:Math.max(_t,c-s/2),Ye&&k?_t:Math.max(_t,c-s/2)),Ae.setBounds(G.getBounds().x,G.getBounds().y,G.getBounds().width,G.getBounds().height),t.expand(Ae,0),C||(te.graphics.c().f("red").dr(vt,ze,wt,Wt),i.hitArea=te);var tn=Math.max(c,Math.min(ie.corner,ie.spacing)),Ut=tn+s/2,yt=tn+(je?it:0)+s/2,Vt=tn+s/2,yn=tn+(Ye?it:0)+s/2,$t,an;Ye&&k&&($t=Math.max(ie.minSize,(e-Ut-yt)*(e-Ut-yt)/(Be+Y+ie.margin)),Le.f(ie.color).rr(0,0,$t,ie.size,ie.corner),Se.x=Ut,Se.y=r-ie.size-ie.spacing,Me=new t.Proportion(-G.scrollXMax,0,Ut,e-$t-yt,-1),v&&(Se.setBounds(0,0,$t,ie.size),an=new Ge.Rectangle(Ut,Se.y,e-$t-Ut-yt,0),Se.dragBoundary(an),Se.proportion=new t.Proportion(an.x,an.x+an.width,0,-G.scrollXMax),Se.off("pressmove",et),et=Se.on("pressmove",function(){G.dispatchEvent("scrolling"),te&&(te.x=-i.x,te.y=-i.y),i.x=Se.proportion.convert(Se.x),xt()}))),je&&k&&($t=Math.max(ie.minSize,(r-Vt-yn)*(r-Vt-yn)/(qe+m+ie.margin)),ee.f(ie.color).rr(0,0,ie.size,$t,ie.corner),Ce.x=e-ie.size-ie.spacing,Ce.y=Vt,_e=new t.Proportion(-G.scrollYMax,0,Vt,r-$t-yn,-1),v&&(Ce.setBounds(0,0,ie.size,$t),an=new Ge.Rectangle(Ce.x,Vt,0,r-$t-Vt-yn),Ce.dragBoundary(an),Ce.proportion=new t.Proportion(an.y,an.y+an.height,0,-G.scrollYMax),Ce.off("pressmove",ve),ve=Ce.on("pressmove",function(){I&&(Pe=!0),G.dispatchEvent("scrolling"),te&&(te.x=-i.x,te.y=-i.y),I?Jt=Ce.proportion.convert(Ce.y):i.y=Ce.proportion.convert(Ce.y),xt()}))),Bt(),clearTimeout(G.d2Timeout),G.d2Timeout=setTimeout(function(){Se&&Se.proportion&&(i.x=Se.proportion.convert(Se.x)),Ce&&Ce.proportion&&(i.y=Ce.proportion.convert(Ce.y))},50),clearTimeout(G.dTimeout),G.dTimeout=setTimeout(function(){$e()},300),$e(),xt()},this.resize=function(vt,ze){n(vt)&&(vt=e),n(ze)&&(ze=r);var wt=Math.max(20,c*2);X&&(wt=Math.max(ae,wt)),vt<wt&&(vt=wt),ze<20&&(ze=20),e=vt,r=ze,Ee();for(var Wt=0;Wt<i.numChildren;Wt++){var _t=i.getChildAt(Wt);_t.type=="Wrapper"&&ct(_t)}return F&&Qe(),G.update(),Jt=i.y,I&&jt.immediate(Jt),G.dispatchEvent("resize"),G},!n(X)){n(Z)&&(Z=!0),typeof X=="string"&&(X=new t.Label({text:X,color:R,size:ge.size!=null?ge.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var oe=G.titleBarLabel=X;oe.noMouse(),n(q)&&(q="rgba(0,0,0,.2)"),G.titleBar=X=new t.Container(e,J,null,null,!1).centerReg(G).mov(0,-r/2-J/2);var Fe=new t.Rectangle(X.width-1,X.height,red).alp(0).addTo(X);oe.setMask(Fe,!0);var Ze=G.titleBar.backing=new t.Rectangle(e+s,J,q,null,null,[c*.95,c*.95,0,0],!0,null,!1,!1).center(X);oe.center(X).pos({x:Math.max(c/2,Math.max(10,f)),reg:!0}),G.regX=0,G.regY=-J,G.setBounds(0,-J,e,r+J),Z?(X.cur("pointer"),X.on("mousedown",function(){G.drag({rect:ne,currentTarget:!0,onTop:U})}),X.on("pressup",function(){G.noDrag(!1)})):X.on("mousedown",function(){})}if(B){n(d)&&(d=t.grey);var Xe=G.closeIcon=new t.Shape(-40,-40,80,80,null,!1);Xe.graphics.f(d).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),X?Xe.centerReg(G).scaleTo(X,null,50).pos({x:e-Math.max(c/2,10)-Xe.width/2,y:J/2,reg:!0}).expand(40):Xe.sca(.3).pos(Math.max(c/2,10)/2,Xe.height/2,!0,!1,G).expand(40),Xe.cur("pointer"),Xe.expand(),Xe.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var vt=G.stage;G.removeFrom(),G.dispatchEvent("close"),vt&&vt.update()})}var We,de,Ve,be,Te,Re;if(!n(X)){if(o){G.fullSize=function(vt){if(n(vt)&&(vt=!0),vt==de||!G.parent)return G;vt?(Ve=G.width,be=G.height,Te=G.x,Re=G.y,G.resize(G.parent.width,G.parent.height),G.x=0,G.y=0,de=!0,Ue.alpha=1,Ne.getChildAt(0).alpha=.01,G.dispatchEvent("fullsize")):(G.resize(Ve,be-X.height),G.x=Te,G.y=Re,de=!1,Ue.alpha=0,Ne.getChildAt(0).alpha=1,G.dispatchEvent("originalsize")),G.stage&&G.stage.update()},n(S)&&(S=t.grey);var Ne=G.fullSizeIcon=new t.Rectangle(80,80,t.faint,S,16),Ue=new t.Shape().s(S).ss(16).mt(-19.6,-20.6).lt(-19.6,-40).lt(40,-40).lt(40,20.7).lt(19.6,20.7).lt(19.6,40).lt(-40,40).lt(-40,-20.6).lt(-19.6,-20.6).lt(19.6,-20.6).lt(19.6,20.7).addTo(Ne).mov(40,40).alp(0);Ne.centerReg(G).scaleTo(X,null,42).pos({x:e-Math.max(c/2,10)-Ne.width/2,y:J/2,reg:!0}).expand(40),Xe&&Ne.mov(-Xe.width-10),Ne.cur("pointer"),Ne.expand(),de=!1,Ve=e,be=r,Te=G.x,Re=G.y,Ne.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){de?G.fullSize(!1):G.fullSize(!0)})}var rt=t.copy(G.getBounds(),!0);if(p){We=we,G.collapse=function(vt){if(n(vt)&&(vt=!0),vt==We)return G;vt?(me.rot(180),G.backing.visible=!1,G.contentContainer.visible=!1,Ae.visible=!1,Se&&(Se.visible=!1),Se&&(Ce.visible=!1),pe&&(pe.visible=!1),We=!0,Ze.sha(O,5,5,_),F&&(G.resizeHandle.visible=!1),G.setBounds(rt.x,rt.y,rt.width,X.height),G.dispatchEvent("collapse")):(me.rot(0),G.backing.visible=!0,G.contentContainer.visible=!0,Ae.visible=!0,Se&&(Se.visible=!0),Se&&(Ce.visible=!0),pe&&(pe.visible=!0),We=!1,Ze.sha(null),F&&(G.resizeHandle.visible=!0),G.setBounds(rt.x,rt.y,rt.width,rt.height),G.dispatchEvent("expand")),G.stage&&G.stage.update()},n(L)&&(L=t.grey);var me=G.collapseIcon=new t.Triangle(90,90,90,t.faint,L,16);me.centerReg(G).scaleTo(X,null,42).pos({x:e-Math.max(c/2,10)-me.width/2,y:J/2,reg:!0}).expand(40),Xe&&me.mov(-Xe.width-10),Ne&&me.mov(-Ne.width-10),me.cur("pointer"),me.expand(),We=!1,Ve=e,be=r,Te=G.x,Re=G.y,me.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){We?G.collapse(!1):G.collapse(!0)})}}if(F){var He=new ei().loc(0,0,G).mov(G.width,G.height-(G.titleBar?G.titleBar.height:0)),at=G.resizeHandle=new t.Rectangle(25,25,t.grey,t.white).alp(ue?.5:.01).centerReg().rot(45).loc(0,0,He).drag({boundary:N,localBoundary:!0});at.on("mouseover",function(){at.alp(.5),at.stage&&at.stage.update()}),at.on("mousedown",function(){at.pressing=!0}),at.on("mouseout",function(){at.pressing||(ue||at.alp(.01),at.stage&&at.stage.update())}),at.on("pressmove",function(){G.resize(Math.max(50,He.x+at.x),Math.max(50,He.y+at.y))}),at.on("pressup",function(){at.pressing=!1,ue||at.alp(.01),Qe(),at.stage&&at.stage.update()}),G.titleBar&&G.titleBar.on("pressup",Qe)}function Qe(vt){G.resizeHandle.loc(0,0,He).top().mov(-He.x+G.width,-He.y+G.height-(G.titleBar?G.titleBar.height:0))}function ct(vt){vt.align=="right"?(vt.x=Y,vt.resize(G.width-(je?ie.size+ie.spacing*2:Y)-Y*2)):(vt.align=="center"||vt.align=="middle",vt.resize(G.width-(je?ie.size+ie.spacing*2:0)-Y*2)),vt.alpha=vt.wrapperLastAlpha}if(Ee(),this.add=function(vt,ze,wt,Wt){var _t="obj, index, center, replace",tn;if(tn=st(G.add,arguments,_t,G))return tn;var Ut=vt;if(!Ut.getBounds()){tt("Window.add() - please add content with bounds set");return}return gn(Ut),n(ze)&&(ze=i.numChildren),Wt&&(ze=0,G.removeAll()),wt?(Ut.center(G).addTo(i,ze).mov(0,J?J/2:0),i.height>G.height-(J||0)&&Ut.loc(null,0),i.width>G.width&&Ut.loc(0)):Ut.addTo(i,ze),Ut.type=="Wrapper"&&(Ce.alpha=0,A=!1,Ut.wrapperLastAlpha=Ut.alpha,Ut.alpha=0,this.added(function(){ct(Ut),G.resize(),Se.alpha=1,Ce.alpha=1})),Ut.x==0&&(Ut.x=Y),Ut.y==0&&(Ut.y=m),G.update(),G},xe){var ot=t.makeContent(xe,e),dt=["header","message","text","display","buttons","config"];dt.forEach(function(vt){ot[vt]&&(G[vt]=ot[vt])}),G.label=G.message,G.add(ot,0,!0)}this.remove=function(vt){return i.removeChild(vt),G.update(),G},this.removeAll=function(){return i.removeAllChildren(),G.update(),G};function $e(vt){fe||(n(ke)&&(ke=G.stage||j.zdf.stage),n(vt)&&(vt=!0),vt?t.dragBoundary(i,new Ge.Rectangle(0,0,Ye?-G.scrollXMax:0,je?-G.scrollYMax:0)):t.dragBoundary(i,new Ge.Rectangle(-1e3,-1e3,ke.width+2e3,ke.height+2e3)))}var Mt=!1;x&&i.on("mousedown",function(){Mt||t.Ticker.add(Ct,i.stage),Mt=!0,Ye&&k&&E&&t.animate(Se,{alpha:b},ie.showTime),je&&k&&E&&t.animate(Ce,{alpha:b},ie.showTime)});function Ct(){Jt=i.y,I&&jt.immediate(Jt),k?Bt():G.dispatchEvent("scrolling")}function xt(){G.optimize&&(ke=G.stage,i.loop(function(vt){!vt.hitTestBounds||!vt.stage||(vt.hitTestBounds(G,300)?(vt.visible=!0,vt.loop&&vt.loop(function(ze){ze.hitTestBounds&&(ze.hitTestBounds(G,300)?ze.visible=!0:ze.visible=!1)})):vt.visible=!1)}))}function Bt(){xt(),G.dispatchEvent("scrolling"),te&&(te.x=-i.x,te.y=-i.y),Ye&&k&&(Se.x=Me.convert(i.x)),je&&k&&(Ce.y=_e.convert(i.y))}this.on("added",function(){Rt(50)},null,!0);function Rt(vt){n(vt)&&(vt=100),gn(G),x&&setTimeout(function(){i&&(t.drag({obj:i,currentTarget:!0,axis:fe,localBoundary:!0,slide:h,slideFactor:w,slideSnap:A&&(x===!0||x=="auto"||x=="horizontal")||T&&(x===!0||x=="auto"||x=="vertical")?P:!1}),i.removeAllEventListeners("slidestart"),i.on("slidestart",function(){G.dispatchEvent("slidestart")}),i.removeAllEventListeners("slidestop"),!k&&D&&(G.zDE&&i.off(G.zDE),G.zDE=i.on("mousedown",()=>{G.zTI&&t.Ticker.remove(xt)}),G.zME&&i.off(G.zME),G.zME=i.on("pressmove",xt),G.zSTA&&i.off(G.zSTA),G.zSTA=i.on("slidestart",function(){G.zTI=t.Ticker.add(xt)}),G.zSTO&&i.off(G.zSTO),G.zSTO=i.on("slidestop",function(ze){G.zTI&&t.Ticker.remove(G.zTI)})),i.on("slidestop",function(ze){h&&nn(ze),G.dispatchEvent("slidestop")}),i.getBounds()&&i.getBounds().width>0&&$e())},vt)}this.cancelCurrentDrag=function(){G.contentContainer&&G.contentContainer.noDrag(!1),setTimeout(function(){i&&(t.drag({obj:i,currentTarget:!0,localBoundary:!0,slide:h,slideFactor:w,slideSnap:A&&(x===!0||x=="auto"||x=="horizontal")||T&&(x===!0||x=="auto"||x=="vertical")?P:!1}),i.getBounds()&&i.getBounds().width>0&&$e())},300)};var Ht;this.added(function(vt){ke=vt,Ht=ke.on("stagemousemove",function(ze){G.windowMouseX=ze.stageX/t.scaX,G.windowMouseY=ze.stageY/t.scaY})}),h?i.on("slidestop",nn):i.on("mousedown",function(){i.stage.on("stagemouseup",nn,null,!0)}),u&&(G.blurEvent=function(){G.cancelCurrentDrag(),nn()},document.WW.addEventListener("blur",G.blurEvent));function nn(){t.Ticker.remove(Ct),Mt=!1,Ye&&E&&k&&t.animate(Se,{alpha:0},ie.fadeTime),je&&E&&k&&t.animate(Ce,{alpha:0},ie.fadeTime)}var en=!1,kt,Qt=0,Je=0,gt=0,It=0,Xt=300,Yt=2;function ft(){kt=Date.now(),t.Ticker.add(Gt,i.stage)}function bt(){en||(G.dispatchEvent("hoverout"),en=!0),t.Ticker.remove(Gt)}function Gt(){if(!i.stage){en||(G.dispatchEvent("hoverout"),en=!0),t.Ticker.remove(Gt);return}Math.abs(Qt-G.windowMouseX)>Yt||Math.abs(Je-G.windowMouseY)>Yt?(en||(G.dispatchEvent("hoverout"),en=!0),kt=Date.now(),Qt=G.windowMouseX,Je=G.windowMouseY):Date.now()-kt>Xt&&((Math.abs(gt-G.windowMouseX)>Yt||Math.abs(It-G.windowMouseY)>Yt)&&(G.contentMouse=i.globalToLocal(G.windowMouseX,G.windowMouseY),G.dispatchEvent("hoverover"),gt=G.windowMouseX,It=G.windowMouseY,en=!1),kt=Date.now())}if(C){var Kt,fn;i.on("mousedown",function(vt){ke=vt.target.stage,Kt=vt.stageX/t.scaX,fn=Date.now()}),i.on("click",function(vt){Date.now()-fn<600&&Math.abs(vt.stageX/t.scaX-Kt)<5&&(G.contentMouse=i.globalToLocal(vt.stageX/t.scaX,vt.stageY/t.scaY),G.dispatchEvent("select"))}),i.on("mouseover",ft),i.on("mouseout",bt)}var Jt=G.scrollY;G.scrollWindow=function(ze){if(je&&G.stage&&G.hitTestPoint(G.windowMouseX,G.windowMouseY)&&G.contains(G.stage.getObjectUnderPoint(G.windowMouseX*t.scaX,G.windowMouseY*t.scaY))){n(ze)&&(ze=event);var wt=ze.detail?ze.detail*-19:ze.wheelDelta;n(wt)&&(wt=ze.deltaY*-19),Jt+=wt,Jt=Math.max(-G.scrollYMax,Math.min(0,Jt)),I||(G.scrollY=Jt,i.stage.update()),Pe=!1}D&&xt()},$&&(j.addEventListener("mousewheel",G.scrollWindow),j.addEventListener("wheel",G.scrollWindow),j.addEventListener("DOMMouseScroll",G.scrollWindow));var rn=!1,jt;function gn(vt){I&&!rn&&vt.stage&&(rn=!0,jt=new t.Damp(G.scrollY,I),G.dampTicker=t.Ticker.add(function(){if(!Mt){if(G.scrollY!=null&&Jt!=null&&G.scrollY!=Jt&&Math.round(G.scrollY)==Math.round(Jt)){Pe=!1;return}n(Jt)||(i.y=jt.convert(Jt)),Pe||Bt()}},vt.stage))}this._enabled=!0,Object.defineProperty(G,"enabled",{get:function(){return G._enabled},set:function(vt){vt?Rt():(clearTimeout(G.dTimeout),t.noDrag(i)),St(G,vt)}}),this._scrollEnabled=!0,Object.defineProperty(G,"scrollEnabled",{get:function(){return G._scrollEnabled},set:function(vt){vt?(Rt(),v&&(et&&(Se.mouseEnabled=!0),ve&&(Ce.mouseEnabled=!0)),j.addEventListener("mousewheel",G.scrollWindow),j.addEventListener("wheel",G.scrollWindow),j.addEventListener("DOMMouseScroll",G.scrollWindow)):(clearTimeout(G.dTimeout),t.noDrag(i),v&&(et&&(Se.mouseEnabled=!1),ve&&(Ce.mouseEnabled=!1)),j.removeEventListener("mousewheel",G.scrollWindow),j.removeEventListener("wheel",G.scrollWindow),j.removeEventListener("DOMMouseScroll",G.scrollWindow)),G._scrollEnabled=vt}}),Object.defineProperty(G,"scrollX",{get:function(){return i.x},set:function(vt){i.x=vt,clearTimeout(G.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Bt()}}),Object.defineProperty(G,"scrollY",{get:function(){return i.y},set:function(vt){i.y=vt,i.y=Jt=vt,I&&jt.immediate(Jt),clearTimeout(G.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Bt()}}),Object.defineProperty(G,"backgroundColor",{get:function(){return l},set:function(vt){l=vt,Ee()}}),Object.defineProperty(G,"borderColor",{get:function(){return a},set:function(vt){a=vt,Ee()}}),Object.defineProperty(G,"borderWidth",{get:function(){return s},set:function(vt){s=vt,Ee()}}),Object.defineProperty(G,"fullSized",{get:function(){return de},set:function(vt){G.fullSize&&G.fullSize(vt)}}),Object.defineProperty(G,"collapsed",{get:function(){return We},set:function(vt){G.collapse&&G.collapse(vt)}}),we&&(We=!1,G.collapsed=!0),G.titleBar&&(G.collapseEvent=G.titleBar.on("dblclick",function(){G.collapsed=!G.collapsed})),V!==!1&&t.styleTransforms(this,ge),this.clone=function(vt){n(vt)&&(vt=!0);var ze=G.cloneProps(new t.Window(e,r,null,l,Q,ce,f,c,x,k,v,ie.color,b,E,A,T,h,w,P,y,C,O,_,Y,m,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se));return vt&&(G.contentContainer.cloneChildren(ze.contentContainer),ze.update()),ze},this.doDispose=function(vt,ze,wt){return $&&(j.removeEventListener("mousewheel",G.scrollWindow),j.removeEventListener("wheel",G.scrollWindow),j.removeEventListener("DOMMouseScroll",G.scrollWindow)),i&&(G.zDE&&i.off(G.zDE),G.zME&&i.off(G.zME),G.zSTA&&i.off(G.zSTA),G.zSTO&&i.off(G.zSTO),G.zTI&&t.Ticker.remove(G.zTI)),G.titleBar&&G.titleBar.removeAllEventListeners(),Ht&&ke&&ke.off("stagemousemove",Ht),G.resizeHandle&&G.resizeHandle.removeAllEventListeners(),G.blurEvent&&j.removeEventListener("blur",G.blurEvent),typeof Gt<"u"&&t.Ticker.remove(Gt),n(Ct)||t.Ticker.remove(Ct),wt||this.zimContainer_dispose(!0),i=G.contentContainer=null,!0}},t.extend(t.Window,t.Container,["clone","dispose"],"zimContainer",!1),t.Window.prototype.dispose=function(e){return this.doDispose(null,null,e)},vi= exports.Window =t.Window,t.Page=function(e,r,i,l,a,s,f,c,x,k,v){var g="width, height, color, color2, angle, pattern, scalePattern, cache, style, group, inherit",b;if(b=st(t.Page,arguments,g,this))return b;De("58.3"),this.group=k;var E=x===!1?{}:t.getStyle("Page",this.group,v);n(e)&&(e=E.width!=null?E.width:j.zdf.width),n(r)&&(r=E.height!=null?E.height:j.zdf.height),this.zimContainer_constructor(0,0,e,r,!1),this.type="Page";var A=this;n(a)&&(a=E.angle!=null?E.angle:90),n(i)&&(i=E.color!=null?E.color:t.light),n(l)&&(l=E.color2!=null?E.color2:null),n(s)&&(s=E.pattern!=null?E.pattern:null),n(f)&&(f=E.scalePattern!=null?E.scalePattern:"fill"),n(c)&&(c=E.cache!=null?E.cache:!1),n(l)||(i=new t.GradientColor([i,l],[0,1],a),l=null);var T=this.backing=new t.Rectangle({width:e,height:r,color:i,scaleDimensions:!1,style:!1}).addTo(this);n(c)&&(!n(l)||!n(s))&&(c=!0),c&&T.cache(),n(s)||(this.pattern=s.addTo(this),f&&s.scaleTo(this,100,100,f).center(this),c&&s.cache()),Object.defineProperty(A,"color",{get:function(){return i},set:function(h){n(h)&&(h=t.black),i=h,A.backing.color=h}}),x!==!1&&t.styleTransforms(this,E),this.clone=function(h){n(h)&&(h=!1),i.type&&(l=null);var w=A.cloneProps(new t.Page(e,r,i,l,vertical,s,f,c,x,k,v));return h&&A.cloneChildren(w),w}},t.extend(t.Page,t.Container,["clone"],"zimContainer",!1),t.Central=function(e,r,i,l,a){De("58.4"),this.group=l;var s=i===!1?{}:t.getStyle("Central",this.group,a);n(e)&&(e=s.width!=null?s.width:1024),n(r)&&(r=s.height!=null?s.height:768),this.zimContainer_constructor(-e/2,-r/2,e,r);var f=this,c=zimDefaultFrame;f.resizeEvent=c.on("resize",function(){f.scale=c.height/r,f.parent&&f.centerReg(f.parent)}),f.added(function(){f.parent&&f.centerReg(f.parent)}),f.dispose=function(x,k,v){return c.off("resize",f.resizeEvent),f.zimContainer_dispose(x,k,v)},i!==!1&&t.styleTransforms(this,s)},t.extend(t.Central,t.Container,["dispose"],"zimContainer",!1),t.Layer=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q){var J="width, height, titleBar, titleBarContainer, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, borderWidth, borderColor, dashed, transformObject, titleBarWidth, titleBarHeight, titleBarX, titleBarY, titleBarDraggable, close, closeColor, closeBackgroundColor, closeIndicatorColor, anchor, onTop, style, group, inherit",Z;if(Z=st(t.Layer,arguments,J,this))return Z;De("58.5"),this.group=R;var ne=X===!1?{}:t.getStyle("Layer",this.group,q);n(e)&&(e=ne.width!=null?ne.width:500),n(r)&&(r=ne.height!=null?ne.height:500),this.zimContainer_constructor(0,0,e,r,!1),this.type="Layer";var U=this;U.distX=40,U.distY=0,n(i)&&(i=ne.titleBar!=null?ne.titleBar:"LAYER");var B=i,d=i,u=!0;n(a)&&(a=ne.backgroundColor!=null?ne.backgroundColor:t.lighter),n(s)&&(s=ne.rollBackgroundColor!=null?ne.rollBackgroundColor:t.white),n(f)&&(f=ne.selectedBackgroundColor!=null?ne.selectedBackgroundColor:t.granite),n(x)&&(x=ne.color!=null?ne.color:t.granite),n(k)&&(k=ne.rollColor!=null?ne.rollColor:t.granite),n(v)&&(v=ne.selectedColor!=null?ne.selectedColor:t.moon),n(b)&&(b=ne.borderWidth!=null?ne.borderWidth:1),n(E)&&(E=ne.borderColor!=null?ne.borderColor:a),(E<0||b<0)&&(E=b=null),n(A)&&(A=ne.dashed!=null?ne.dashed:!0),n(T)&&(T=ne.titleBar!=null?ne.titleBar:null),n(h)&&(h=ne.titleBarWidth!=null?ne.titleBarWidth:100);var o=h;if(n(w)&&(w=ne.titleBarHeight!=null?ne.titleBarHeight:40),n(P)&&(P=ne.titleBarX!=null?ne.titleBarX:null),n(y)&&(y=ne.titleBarY!=null?ne.titleBarY:null),n(C)&&(C=ne.titleBarDraggable!=null?ne.titleBarDraggable:!0),n(O)&&(O=ne.close!=null?ne.close:!0),n(_)&&(_=ne.closeColor!=null?ne.closeColor:f),n(Y)&&(Y=ne.closeBackgroundColor!=null?ne.closeBackgroundColor:f),n(m)&&(m=ne.closeIndicatorColor!=null?ne.closeIndicatorColor:v),n($)&&($=ne.anchor!=null?ne.anchor:!0),n(I)&&(I=ne.onTop!=null?ne.onTop:!0),C||($=!1),U.anchor=$,O&&(h+=30),T=t.merge({borderColor:f},T,{onTop:I,events:!0,visible:!1,ghostColor:E,ghostWidth:b,ghostDashed:A,ghostHidden:!0}),n(l)&&(l=ne.titleBarContainer!=null?ne.titleBarContainer:null),n(l))if(j.zdf)l=j.zdf.stage;else{tt("zim Layer(): Please pass in a reference to a container with bounds set.");return}U.active=!1,U.turnOff=function(){U.active=!1,O&&(U.checkBox.visible=!1),U.transformControls.remove(),U.mouseChildren=!0,U.button.backgroundColor=a,U.button.rollBackgroundColor=s,U.button.color=x,U.button.rollColor=x,U.transformControls.allowToggleOff(),U.resizeChildren&&U.resizeChildren()},U.turnOn=function(){U.active=!0,O&&(U.checkBox.visible=!0,U.checkBox.checked=!0),U.button.backgroundColor=f,U.button.rollBackgroundColor=f,U.button.color=v,U.button.rollColor=v,U.mouseChildren=!1,U.transformControls.add(),U.transformControls.allowToggleOn()};var S;U.titleBarPos=function(L,we){if(U.titleBar)return U.titleBar.pos?(U.titleBar.pos(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]),S.update()):(U.distX=L,U.distY=we),u=!1,U};var F=U.visible;U.visible=!1;var p=Tt();this.added(function(L){S=L,U.transform(T),b>=0&&U.transformControls.hideGhost(),setTimeout(function(){function we(){return U.localToLocal(0,0,l)}U.visible=F,b>=0&&setTimeout(function(){U.transformControls.showGhost(),U.stage&&U.stage.update()},200),S=L;var D=U.titleBar=new t.Container(h,w).reg(0,w).loc(U,null,l).mov(U.distX,U.distY);C&&D.drag({all:!0,boundary:new t.Boundary(0,w,l.width-h,l.height-w),localBoundary:!0}),(U.distX!=40||U.distY!=0)&&D.pos(U.distX,U.distY),O&&(U.checkBox=new t.CheckBox({borderColor:_,backgroundColor:Y,indicatorColor:m,size:20,startChecked:!0}).center(D).pos(0,null,!0).change(function(){U.turnOff(),U.dispatchEvent("transformhide")}),U.checkBox.visible=!1),D.mouseChildren=!0,D.layer=U,U.resetTitleBar=function(){U.distX=40,U.distY=0,u=!0,U.move(!0),U.stage&&U.stage.update()},(typeof d=="string"||typeof d=="number")&&(d=new t.Label({text:d,color:x,rollColor:k,size:ne.size!=null?ne.size:18,group:this.group})),U.label=d,U.label.center(D),U.button=new t.Button({shadowBlur:-1,width:o,height:w-1,label:U.label,color:x,rollColor:k,backgroundColor:a,rollBackgroundColor:s,corner:ne.corner!=null?ne.corner:0,inherit:t.copy(ne)}).addTo(D),U.button.on("mousedown",function(){l.loop(function(K){K&&K!=D&&K.layer&&K.layer.turnOff&&K.layer.active&&K.layer.turnOff()}),U.active||(U.turnOn(),U.dispatchEvent("transformshow")),D.top()}),U.button.on("pressmove",function(){N()}),U.button.on("pressup",function(){N(!0);var K=U.localToLocal(0,0,l);U.distX=D.x-K.x,U.distY=D.y-K.y,D.top(),!fe()&&C&&(K=U.localToGlobal(0,0),U.button.hitTestPoint(K.x,K.y)&&U.resetTitleBar())});function N(K){if(u&&C){var ge=l.localToLocal(D.x-U.distX,D.y-U.distY,U.parent),Q=U.localToLocal(U.regX,U.regY,U.parent),ce=U.localToLocal(0,0,U.parent);U.x=ge.x+(Q.x-ce.x),U.y=ge.y+(Q.y-ce.y),U.transformControls.resize(K),ue(U),U.stage&&U.stage.update()}}function ue(K){K.loop(function(ge){ge.type=="Layer"&&(U.titleBarDraggable&&ge.move(),ge.transformControls.ghost&&ge.transformControls.resize(),ue(ge))})}U.button.on("dblclick",function(){C&&U.resetTitleBar()}),U.turnOff(),U.on("transformed",function(K){(K.transformType=="move"||K.transformType=="size"||K.transformType=="stretch"||K.transformType=="rotate")&&(C&&U.move(),ue(U))});function fe(){if(D.x==0||D.y==D.height||D.x==l.width-D.width||D.y==l.height)return!0}U.move=function(K){!K&&!u&&U.anchor&&fe()||(D.loc(we()).mov(U.distX,U.distY),D.x<0&&(u=!1,D.x=0),D.y<D.height&&(u=!1,D.y=D.height),D.x>l.width-D.width&&(u=!1,D.x=l.width-D.width),D.y>l.height&&(u=!1,D.y=l.height),U.anchor||(u=!0))},U.on("transformhide",function(){U.turnOff(),l.loop(function(K){K&&K!=D&&K.layer&&K.layer.turnOff&&K.layer.active&&K.layer.turnOff()})}),U.resizeChildren=function(K){U.transformControls.resize(K),U.loop(function(ge){ge.transformControls&&(ge.transformControls.visible&&ge.transformControls.hide(),ge.type=="Layer"?ge.resizeChildren():ge.transformControls.resize())})},U.resize=function(K){return U.move(),U.resizeChildren(K),U},U.toggled=!1;function V(){U.toggled?(l.loop(function(K){K&&K!=D&&K.layer&&K.layer.turnOff&&K.layer.active&&K.layer.turnOff()}),U.turnOn(),U.dispatchEvent("transformshow")):(D.top(),U.turnOff(),l.loop(function(K){K&&K!=D&&K.layer&&K.layer.turnOff&&K.layer.active&&K.layer.turnOff()}),U.dispatchEvent("transformhide")),U.stage&&U.stage.update()}if(U.toggle=function(K){return n(K)?U.toggled=!U.toggled:U.toggled=K,V(),U},Object.defineProperty(U,"titleBarDraggable",{get:function(){return C},set:function(K){C=K,C?D.drag({all:!0,boundary:t.Boundary(0,40,l.width-h,l.height-w),localBoundary:!0}):D.noDrag(!1)}}),U.stageUpEvent=S.on("stagemouseup",function(){U.transformControls.visible&&D.top()}),!n(P)||!n(y)){u=!1;var z=n(P)?D.x:P,se=n(y)?D.y-w:y;U.titleBarStartX=P,U.titleBarStartY=y,U.titleBarPos(z,se);var Oe=U.parent.localToLocal(U.x,U.y,l);U.distX=D.x-Oe.x,U.distY=D.y-Oe.y}},50)},p=="s"?.05:50),X!==!1&&t.styleTransforms(this,ne),this.clone=function(){return U.cloneProps(new t.Layer(e,r,B,l,a,s,f,c,x,k,v,g,b,E,A,T,o,w,P,y,C,O,_,Y,m,$,I,X,this.group,q))},this.dispose=function(L,we,D){return U.stageUpEvent&&S.off("stagemouseup",U.stageUpEvent),l&&l.loop(function(N){N.layer=null}),U.transformControls.dispose(),U.transformControls=null,D||this.zimContainer_dispose(!0),U.titleBar.layer=null,U.titleBar.dispose(),U.checkBox=U.button=null,i=U.titleBar=T=null,!0}},t.extend(t.Layer,t.Container,["clone","dispose"],"zimContainer",!1),t.Waiter=function(e,r,i,l,a,s,f,c,x,k,v){var g="container, speed, foregroundColor, backgroundColor, corner, shadowColor, shadowBlur, fadeTime, style, group, inherit",b;if(b=st(t.Waiter,arguments,g,this))return b;De("59"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Waiter",this.group=k;var E=x===!1?{}:t.getStyle(this.type,this.group,v),A=Tt(r);n(r)&&(r=E.speed!=null?E.speed:A=="s"?.6:600),n(i)&&(i=E.foregroundColor!=null?E.foregroundColor:t.white),n(l)&&(l=E.backgroundColor!=null?E.backgroundColor:"orange"),n(a)&&(a=E.corner!=null?E.corner:16),n(s)&&(s=E.shadowColor!=null?E.shadowColor:"rgba(0,0,0,.3)"),n(f)&&(f=E.shadowBlur!=null?E.shadowBlur:14),n(c)&&(c=E.fadeTime!=null?E.fadeTime:0);var T=40,h=3,w=T*.6/2,P=(T-w*2)/2,y=h*(w*2+P)+P;this.setBounds(-y/2,-T/2,y,T);var C=this,O,_=this.display=new t.Shape({style:!1});this.addChild(_),_.setBounds(0,0,y,T),_.regX=y/2,_.regY=T/2;var Y=_.graphics;Y.f(l);var m=a;Array.isArray(m)||(m=[a,a,a,a]),Y.rc(0,0,y,T,m[0],m[1],m[2],m[3]),s!=-1&&f>0&&(_.shadow=new Ge.Shadow(s,3,3,f)),_.on("click",function(J){J.stopImmediatePropagation()});var $=new t.Container({style:!1});this.addChild($);for(var I,X=0;X<h;X++)I=new Ge.Shape,I.graphics.f(i).dc(0,0,w),I.x=(X-(h-1)/2)*(w*2+P),$.addChild(I),I.cache(-w,-w,w*2,w*2),I.alpha=0;this.hide=function(){c>0?C.animate({obj:{alpha:0},time:c,call:J}):J();function J(){if(C.parent&&C.parent.removeChild(C),O=C.stage,O&&O.update(),C.zimAccessibility){var Z=C.zimAccessibility;Z.resize(C),R?R.focus():C.zimTabTag.nextSibling.focus(),setTimeout(function(){Z.talk("Waiter has finished.")},50)}}return C.toggled=!1,C};var R,q=[];this.show=function(){var J="zim display - Waiter(): Please pass in a reference to a container with bounds set as first parameter to Waiter";if(n(e))if(j.zdf)e=j.zdf.stage;else{tt(J);return}else if(e.getBounds){if(n(e.stage)){tt("zim display - Waiter(): The container must have a stage property");return}}else{tt(J);return}for(var Z,ne=0,U=r*(A=="s"?1e3:1),B=0;B<$.numChildren;B++)$&&q.push(setTimeout(function(){Z=$.getChildAt(ne),Ge.Tween.get(Z,{loop:!0}).to({alpha:1},U/h/2).wait(U/h).to({alpha:0},U/h).wait(U-U/h-U/h/2),ne++},B*U/h));if(C.ticker=Ge.Ticker.on("tick",function(){e.stage.update()}),C.x=e.getBounds().width/2,C.y=e.getBounds().height/2,e.addChild(C),c>0&&(C.alpha=0,C.animate({alpha:1},c)),C.zimAccessibility){var d=C.zimAccessibility;setTimeout(function(){d.activatedObject&&(R=d.activatedObject.zimTabTag)},50),d.resize(C),d.talk(C.zimTabTag.getAttribute("aria-label"))}return C.toggled=!0,C},C.toggle=function(J){return J===!0?C.show():J===!1||C.parent?C.hide():C.show(),C},x!==!1&&t.styleTransforms(this,E),this.clone=function(){return C.cloneProps(new t.Waiter(e,r,i,l,a,s,f,c,x,this.group,v))},this.dispose=function(J,Z,ne){C.ticker&&Ge.Ticker.off("tick",C.ticker),Ge.Tween.removeTweens(C),C.removeFrom();for(var U=0;U<$.numChildren;U++){var B=$.getChildAt(U);clearInterval(q[U]),Ge.Tween.removeTweens(B)}return ne||this.zimContainer_dispose(!0),!0}},t.extend(t.Waiter,t.Container,["clone","dispose"],"zimContainer",!1),t.ProgressBar=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O){var _="barType, foregroundColor, backgroundColor, borderColor, borderWidth, padding, label, color, labelPosition, percentage, corner, shadowColor, shadowBlur, backing, delay, fastClose, container, autoHide, width, style, group, inherit",Y;if(Y=st(t.ProgressBar,arguments,_,this))return Y;De("59.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ProgressBar",this.group=C;var m=y===!1?{}:t.getStyle(this.type,this.group,O);n(r)&&(r=m.foregroundColor!=null?m.foregroundColor:t.green),n(i)&&(i=m.backgroundColor!=null?m.backgroundColor:t.charcoal),n(l)&&(l=m.borderColor!=null?m.borderColor:i),n(a)&&(a=m.borderWidth!=null?m.borderWidth:null),n(x)&&(x=m.labelPosition!=null?m.labelPosition:"bottom"),n(e)&&(e=m.barType!=null?m.barType:"circle"),n(s)&&(s=m.padding!=null?m.padding:e=="circle"?2:-.5),n(v)&&(v=m.corner!=null?m.corner:15),n(g)&&(g=m.shadowColor!=null?m.shadowColor:"rgba(0,0,0,.3)"),n(b)&&(b=m.shadowBlur!=null?m.shadowBlur:14),n(E)&&(E=m.backing!=null?m.backing.clone():null),n(T)&&(T=m.fastClose!=null?m.fastClose:!0),l<0||a<0?l=a=null:l!=null&&a==null&&(e=="circle"?a=10:a=2);var $=Tt(A);n(A)&&(A=m.delay!=null?m.delay:$=="s"?.1:100),n(w)&&(w=m.autoHide!=null?m.autoHide:!0),n(f)&&(f=m.label!=null?m.label:null),n(c)&&(c=m.color!=null?m.color:r),n(P)&&(P=m.width!=null?m.width:e=="circle"?40:200),(typeof f=="string"||typeof f=="number")&&(f=new t.Label({text:f,color:c,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),!n(k)&&n(f)&&(f=new t.Label("")),this.label=f;var I=30,X=this,R=0;X.visible=!1,setTimeout(function(){X.visible=!0,X.stage&&X.stage.update()},A);var q;if(e=="circle")P=P/2,E=this.backing=new t.Circle(P,"rgba(0,0,0,0)",i,a,null,null,null,null,!1).addTo(X),q=this.bar=new t.Shape({style:!1}).addTo(X).loc(E.x,E.y).rot(-90);else{if(g!=-1&&b>0){var J=new t.Rectangle(P-2,I-2,i,null,null,v,null,null,null,!1).addTo(this);J.shadow=new Ge.Shadow(g,3,3,b)}E=B(E);var Z=v;Array.isArray(Z)||(Z=[v,v,v,v]);var ne=(s+a/2)*1.2;q=this.bar=new t.Rectangle(P-(s+a/2)*1.8,I-(s+a/2)*1.8,r,null,null,[Z[0]-ne,Z[1]-ne,Z[2]-ne,Z[3]-ne],null,null,null,!1).center(this);var U=this.mask=new t.Rectangle(P-(s+a/2)*1.8,I-(s+a/2)*1.8,null,null,null,null,null,null,null,!1).center(this).alp(0).sca(0,1);q.setMask(U)}function B(S){var F;if(X.backing?(F=X.getChildIndex(X.backing),X.removeChild(X.backing)):F=X.numChildren,X.border&&X.removeChild(X.border),!n(S)&&S.type=="Pattern"){var p=S;S=X.backing=new t.Rectangle(P,I,i,null,null,v,null,null,null,!1).addTo(X,F),S.pattern=p,p.center(S),p.setMask(S.shape),a&&(X.border=new t.Rectangle(P,I,"rgba(0,0,0,0)",l,a,v,null,null,null,!1).addTo(X,F+1))}else S=X.backing=n(S)?new t.Rectangle(P,I,i,l,a,v,null,null,null,!1).addTo(X,F):E.addTo(X,F);return S}X.setBacking=function(S){B(S),X.stage&&X.stage.update()},E.on("click",function(S){S.stopImmediatePropagation()}),n(f)||(f.scaleX=f.scaleY=.8,f.startText=f.text,n(k)||(f.text=f.startText+"  0%"),f.center(X),x=="above"?f.y-=60:f.y+=60,f.alpha=.8),this.hide=function(){var S=X.stage;if(X.parent&&X.parent.removeChild(X),X.backing.type=="Pattern"&&X.backing.pauseInterval&&X.backing.pauseInterval(),S&&S.update(),X.zimAccessibility){var F=X.zimAccessibility;F.resize(X),d?d.focus():X.zimTabTag.nextSibling.focus(),setTimeout(function(){F.talk("Progress Bar has finished.")},50)}return X.toggled=!1,X};var d;this.show=function(){var S="zim display - ProgressBar(): Please pass in a reference to a container with bounds set as first parameter of the ProgressBar";if(n(h))if(j.zdf)h=j.zdf.stage;else{tt(S);return}else if(h.getBounds){if(n(h.stage)){tt("zim display - Waiter(): The container must have a stage property");return}}else{tt(S);return}if(X.timeOut&&clearTimeout(X.timeOut),u(0),X.zimActiveLoader&&X.zimActiveLoader.on("progress",function(p){R=p.progress*100,u(R)}),X.center(h),X.backing.type=="Pattern"&&X.backing.pauseInterval&&X.backing.pauseInterval(!1),X.zimAccessibility){var F=X.zimAccessibility;setTimeout(function(){F.activatedObject&&(d=F.activatedObject.zimTabTag)},50),F.resize(X),F.talk(X.zimTabTag.getAttribute("aria-label"))}return X.toggled=!0,X},X.toggle=function(S){return S===!0?X.show():S===!1||X.parent?X.hide():X.show(),X},X.run=function(S,F){n(F)||(w=F),n(S)&&(S=$=="s"?3:3e3),Pt(S,$);var p=S*($=="s"?1e3:1);X.runInterval&&clearInterval(X.runInterval),X.percent=0;var L=Date.now();return X.runInterval=setInterval(function(){X.percent=(Date.now()-L)/p*100,X.percent>=100&&(X.percent=100,clearInterval(X.runInterval))},30),X},X.dispatched=!1;function u(S){e=="circle"?q.graphics.c().mt(0,0).s(r).ss(a-s*2+.5).a(0,0,P,0,360*S/100*Math.PI/180):(U.sca(S/100,1),q.setMask(U)),n(k)||(f.text=f.startText+" "+Math.min(Math.round(S),100)+"%"),w&&T&&Math.round(S)>=100&&(X.timeOut=setTimeout(function(){X.hide()},200)),!X.dispatched&&Math.round(S)>=100&&(X.dispatchEvent("complete"),X.dispatched=!0,setTimeout(function(){X&&(X.dispatched=!1)},100)),X.stage&&X.stage.update()}Object.defineProperty(X,"percent",{get:function(){return R},set:function(S){R=S,u(S)}});var o=X.getBounds();X.setBounds(o.x-5,o.y-5,o.width+10,o.height+10),y!==!1&&t.styleTransforms(this,m),this.clone=function(){return X.cloneProps(new t.ProgressBar(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,this.group,O))},this.dispose=function(S,F,p){return X.backing.type=="Pattern"&&X.backing.clearInterval&&X.backing.clearInterval(),X.runInterval&&clearInterval(X.runInterval),p||this.zimContainer_dispose(!0),!0}},t.extend(t.ProgressBar,t.Container,["clone","dispose"],"zimContainer",!1),t.Indicator=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C){var O="width, height, num, foregroundColor, backgroundColor, borderColor, borderWidth, backdropColor, corner, indicatorType, fill, scale, lightScale, interactive, shadowColor, shadowBlur, selectedIndex, backgroundAlpha, style, group, inherit",_;if(_=st(t.Indicator,arguments,O,this))return _;De("60"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Indicator",this.group=y;var Y=P===!1?{}:t.getStyle(this.type,this.group,C);n(e)&&(e=Y.width!=null?Y.width:300),n(r)&&(r=Y.height!=null?Y.height:50),n(i)&&(i=Y.num!=null?Y.num:6),n(k)&&(k=Y.indicatorType!=null?Y.indicatorType:"dot"),n(l)&&(l=Y.foregroundColor!=null?Y.foregroundColor:k=="star"?t.yellow:k=="heart"?t.red:t.orange),n(a)&&(a=Y.backgroundColor!=null?Y.backgroundColor:t.granite),a<0&&(a=Y.backgroundColor!=null?Y.backgroundColor:"rgba(0,0,0,.01)"),n(s)&&(s=Y.borderColor!=null?Y.borderColor:null),n(f)&&(f=Y.borderWidth!=null?Y.borderWidth:null),s<0||f<0?s=f=null:s!=null&&f==null&&(f=1),n(c)&&(c=Y.backdropColor!=null?Y.backdropColor:-1),n(x)&&(x=Y.corner!=null?Y.corner:0),n(v)&&(v=Y.fill!=null?Y.fill:!1),n(g)&&(g=Y.scale!=null?Y.scale:1),n(b)&&(b=Y.lightScale!=null?Y.lightScale:1),n(E)&&(E=Y.interactive!=null?Y.interactive:!1),n(A)&&(A=Y.shadowColor!=null?Y.shadowColor:"rgba(0,0,0,.3)"),n(T)&&(T=Y.shadowBlur!=null?Y.shadowBlur:5),n(w)&&(w=Y.backgroundAlpha!=null?Y.backgroundAlpha:.2);var m=(Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",$=this;this.lights=[];var I;if(c!=-1){var X=$.backdrop=new t.Rectangle(e,r,c,s,f,x,null,null,null,!1);this.addChild(X)}var R=this.lightsContainer=new t.Container({style:!1});this.addChild(R);var q,J=r*.5,Z=e/(i+1),ne=new Ge.Shape,U=!1;k=="square"||k=="box"||k.type=="Emoji"?ne.graphics.f("black").dr(-Z/2/b+J/2,-r/2+J/2,Z/b,r):ne.graphics.f("black").dr(-Z/2/b,-r/2,Z/b,r);for(var B=0;B<i;B++)k=="square"||k=="box"?(q=new t.Rectangle(J,J,a,s,f,null,null,null,null,!1),q.regX=q.width/2,q.regY=q.height/2):k=="star"?q=new t.Poly(J*.6,5,.5,a,s,f,null,null,!1):k=="heart"?q=new t.Blob({points:[[0,-40.7,0,0,-57.3,-76.6,41.8,-80.3,"mirror"],[100,0,0,0,23.7,-45.4,-23.7,45.4,"mirror"],[0,100,0,0,0,0,0,0,"mirror"],[-100,0,0,0,21.9,48.2,-21.9,-48.2,"mirror"]],color:a,interactive:!1}).transformPoints("scale",.15):k.type=="Emoji"?(U=!0,q=k.clone().reg("center","center"),q.myCache=!1):q=new t.Circle(J/2,a,s,f,null,null,null,null,!1),this.lights.push(q),q.znum=B,q.scaleX=q.scaleY=b,q.hitArea=ne,q.x=Z+Z*B,q.y=r/2,R.addChild(q);R.setBounds(0,0,e,r),R.regX=R.x=e/2,R.regY=R.y=r/2,this.addChild(R),A!=-1&&T>0&&(R.shadow=new Ge.Shadow(A,2,2,T)),E&&(R.cur("pointer"),$.lightsEvent=R.on(m,function(u){if(I==u.target.znum){if(I>0)return;if(I==0){I=-1,d(I),$.dispatchEvent("change");return}}I=u.target.znum,d(I),$.dispatchEvent("change")})),R.scaleX=R.scaleY=g;function d(u){u>=i&&(u=-1);for(var o,S=0;S<i;S++){v&&S<u?o=l:o=a,S==u&&(o=l);var F=R.getChildAt(S);U&&(F.alpha=o==l?1:w),F.color=o}$.zimAccessibility&&$.zimAccessibility.changeTitle($),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&$.stage&&$.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return I},set:function(u){I=Math.floor(u),I=t.constrain(I,-1,i-1),d(I)}}),Object.defineProperty(this,"num",{get:function(){return i},set:function(){pt&&tt("Indicator() - num is read only")}}),this._enabled=!0,Object.defineProperty($,"enabled",{get:function(){return $._enabled},set:function(u){St($,u)}}),n(h)&&(h=Y.selectedIndex!=null?Y.selectedIndex:0),$.selectedIndex=h,P!==!1&&t.styleTransforms(this,Y),this.dispose=function(u,o,S){S||($.lightsEvent&&R.off(m,$.lightsEvent),this.zimContainer_dispose())},this.clone=function(){return $.cloneProps(new t.Indicator(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,this.group,C))}},t.extend(t.Indicator,t.Container,["clone","dispose"],"zimContainer",!1),t.TextInput=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p){var L="width, height, placeholder, text, size, font, color, backgroundColor, borderColor, borderWidth, maxLength, password, selectionColor, selectionAlpha, cursorColor, cursorSpeed, shadowColor, shadowBlur, align, corner, padding, paddingH, paddingV, shiftH, shiftV, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, readOnly, inputType, rtl, uppercase, placeholderInstant, keyboardShift, style, group, inherit",we;if(we=st(t.TextInput,arguments,L,this))return we;De("54.2"),this.group=F;var D=S===!1?{}:t.getStyle("TextInput",this.group,p);n(a)&&(a=D.size!=null?D.size:36),(n(C)||C=="ignore")&&(C=D.padding!=null&&C!="ignore"?D.padding:5),n(O)&&(O=D.paddingH!=null?D.paddingH:C),n(_)&&(_=D.paddingV!=null?D.paddingV:C),n(e)&&(e=D.width!=null?D.width:300),n(r)&&(r=D.height!=null?D.height:a+_*2),n(i)&&(i=D.placeholder!=null?D.placeholder:null),n(l)&&(l=D.text!=null?D.text:""),n(s)&&(s=D.font!=null?D.font:"arial"),n(f)&&(f=D.color!=null?D.color:t.dark),n(c)&&(c=D.backgroundColor!=null?D.backgroundColor:t.lighter),n(x)&&(x=D.borderColor!=null?D.borderColor:null),n(k)&&(k=D.borderWidth!=null?D.borderWidth:null);var N=ue(e,r,i,l,f,c,x);this.veeObj={width:N[0],height:N[1],placeholder:N[2],text:N[3],color:N[4],backgroundColor:N[5],borderColor:N[6]};function ue(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),f=t.Pick.choose(f),c=t.Pick.choose(c),x=t.Pick.choose(x),n(b)&&(b=D.selectionColor!=null?D.selectionColor:f),n(E)&&(E=D.selectionAlpha!=null?D.selectionAlpha:.2),n(A)&&(A=D.cursorColor!=null?D.cursorColor:f),n(T)&&(T=D.cursorSpeed!=null?D.cursorSpeed:.5),n(h)&&(h=D.shadowColor!=null?D.shadowColor:"rgba(0,0,0,.3)"),n(w)&&(w=D.shadowBlur!=null?D.shadowBlur:20),n(P)&&(P=D.align!=null?D.align:"left"),n(y)&&(y=D.corner!=null?D.corner:0),n(Y)&&(Y=D.shiftH!=null?D.shiftH:0),n(g)&&(g=D.password!=null?D.password:!1),n(m)&&(m=D.shiftV!=null?D.shiftV:g?a*.25:0),n(v)&&(v=D.maxLength!=null?D.maxLength:P=="center"?Math.floor(e/a)*1.8:null),n($)&&($=D.scrollBarActive!=null?D.scrollBarActive:!1),n(I)&&(I=D.scrollBarDrag!=null?D.scrollBarDrag:!1),n(X)&&(X=D.scrollBarColor!=null?D.scrollBarColor:x),n(R)&&(R=D.scrollBarAlpha!=null?D.scrollBarAlpha:.3),n(q)&&(q=D.scrollBarFade!=null?D.scrollBarFade:!0),n(J)&&(J=D.scrollBarH!=null?D.scrollBarH:!0),n(Z)&&(Z=D.scrollBarV!=null?D.scrollBarV:!0),n(ne)&&(ne=D.readOnly!=null?D.readOnly:!1),n(U)&&(U=D.inputType!=null?D.inputType:"text"),I&&(q=D.scrollBarFade!=null?D.scrollBarFade:!1),n(B)&&(B=D.rtl!=null?D.rtl:j.DIR=="rtl"||t.DIR=="rtl"?"rtl":null),n(d)&&(d=D.uppercase!=null?D.uppercase:null),n(o)&&(o=D.keyboardShift!=null?D.keyboardShift:null),d&&(l&&(l=l.toUpperCase()),i&&(i=i.toUpperCase())),n(u)&&(u=D.placeholderInstant!=null?D.placeholderInstant:!0);function fe(){return j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?P=="start"?P="right":P=="end"&&(P="left"):P=="start"?P="left":P=="end"&&(P="right"),P}P=fe(P),this.zimWindow_constructor(e,r,null,c,x,k,C,y,!1,$,I,X,R,q,J,Z,!1,null,null,!1,!0,h,w,O,_,!0,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,null,null,null,null,S,F,t.copy(D)),this.type="TextInput";var V=this;this.placeholderLabel=new t.Label({text:i||"",size:a,color:f,font:s,shiftH:Y,shiftV:m,valign:"top"}).alp(.5),l==""&&this.add(this.placeholderLabel);var z=new t.Rectangle({width:e-C*2,height:r-C*2,color:t.clear,style:!1}).center(this);this.cur("text");var se=this.label=new t.TextInput.LabelInput(l,a,v,g,b,E,A,T,s,f,null,null,null,P,"top",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,Y,m,null,null,null,null,U,B,d,u,S,F,p);this.add(se),se.setMask(z),this.htmlTag=this.label.hiddenInput,this.selection=this.label.selection,this.blinker=this.label.blinker,P=="right"?(se.x=e-O,this.placeholderLabel.x=e-this.placeholderLabel.width-O):P=="center"&&(se.x=e/2,this.placeholderLabel.x=(e-this.placeholderLabel.width)/2),se.ogx=se.x,V.placeholderLabel.x=se.x,V.placeholderLabel.align=P;var Oe=new t.Rectangle({width:C,height:r,color:t.clear,style:!1}).addTo(this).expand(0);Oe.on("mousedown",function(le){se.onMousedown(le),le.stopImmediatePropagation()}),Oe.on("pressmove",function(le){se.onPressmove(le),le.stopImmediatePropagation()}),Oe.on("dblclick",function(le){se.onDblclick(le),le.stopImmediatePropagation()});var K=new t.Rectangle({width:C,height:r,color:t.clear,style:!1}).pos(0,0,t.RIGHT,t.TOP,this).expand(0);K.on("mousedown",function(le){se.onMousedown(le),le.stopImmediatePropagation()}),K.on("pressmove",function(le){se.onPressmove(le),le.stopImmediatePropagation()}),K.on("dblclick",function(le){se.onDblclick(le),le.stopImmediatePropagation()});var ge=se.text;this.on("mousedown",function(le){se.onMousedown(le),ge=se.text}),this.on("pressmove",function(le){se.onPressmove(le),le.stopImmediatePropagation()}),this.on("dblclick",function(le){se.onDblclick(le),le.stopImmediatePropagation()}),this.added(function(le){le.on("stagemousedown",function(Ae){V.hitTestPoint(Ae.stageX,Ae.stageY)||(se.focus=!1,se.text!=ge&&V.dispatchEvent("change"),ge=se.text)})});var Q=V.stage?stage.y:0;this.label.on("focus",function(){if(j.M&&o){V.re&&V.stage.frame.off("resize",V.re),V.re=V.stage.frame.on("resize",function(){V.stage&&le>V.stage.height/4&&(V.stage.y=V.stage.scaleY*(V.stage.height/4-le),V.stage.update())});var le=V.label.localToGlobal(0,0).y;V.stage&&le>V.stage.height/4&&(V.stage.y=V.stage.scaleY*(V.stage.height/4-le),V.stage.update())}u&&V.placeholderLabel.parent&&(V.placeholderLabel.removeFrom(),V.stage&&V.stage.update()),V.dispatchEvent("focus")}),this.label.on("blur",function(){j.M&&o&&V.stage&&(V.re&&V.stage.frame.off("resize",V.re),V.stage.y=Q,V.stage.update()),u&&se.text==""&&!V.placeholderLabel.parent&&(V.add(V.placeholderLabel),V.stage&&V.stage.update()),V.dispatchEvent("blur")});function ce(){se.text!=""&&V.placeholderLabel.parent&&(V.placeholderLabel.removeFrom(),V.stage&&V.stage.update()),se.text==""&&!V.placeholderLabel.parent&&(V.add(V.placeholderLabel),V.stage&&V.stage.update())}this.label.on("input",function(){ce(),V.dispatchEvent("input")}),this.label.on("keydown",function(le){this.label.deleteKey=le.detail==46,V.dispatchEvent("keydown")}),this.label.on("blinker",function(){var le=V.localToGlobal(0,0).x,Ae=le+e-O-se.blinker.width,re=se.blinker,xe=re.localToGlobal(0,0).x,ke=se.localToGlobal(0,0).x-1,te=se.x+se.blinker.x,pe=t.constrain(te,O,e-O-se.blinker.width);if(te!=pe&&(se.x-=te-pe),P=="left")se.width<V.width?se.x=se.ogx:Ae<xe||se.oldWidth==se.width?se.x-=te-pe:se.oldWidth>se.width&&this.label.deleteKey!=!0&&(se.x+=Math.abs(re.oldX-xe)+se.blinker.width+O);else if(P=="right")se.width<V.width?se.x=se.ogx:Ae<xe||se.oldWidth==se.width?se.x-=te-pe:se.oldWidth>se.width&&this.label.deleteKey==!0&&xe<ke-V.width&&(se.x-=Math.abs(re.oldX-xe)+se.blinker.width+O);else if(P=="center"){if(se.width<V.width)se.x=se.ogx;else if(Ae<xe)se.x-=te-pe;else if(se.oldWidth==se.width)se.x-=te-pe;else if(se.oldWidth>se.width&&Ae>xe){var he=le+V.width*.5;this.label.deleteKey!=!0?se.x+=se.blinker.width+O:se.x-=se.blinker.width+O}}se.oldWidth=se.width,re.oldX=xe,V.stage&&V.stage.update()}),Object.defineProperty(V,"text",{get:function(){return se.hiddenInput.value},set:function(le){ge=le,se.setText(le),ce(),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&V.stage&&V.stage.update()}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==V},set:function(){t.KEYFOCUS=V}}),t.KEYFOCUS||G(),this.on("mousedown",function(){G()});function G(){V.keyFocus=!0}Object.defineProperty(V,"readOnly",{get:function(){return ne},set:function(le){ne=le,V.htmlTag.setAttribute("readonly",ne)}}),ne&&(V.readOnly=!0),Object.defineProperty(V,"focus",{get:function(){return se.focus},set:function(le){se.focus=le}}),Object.defineProperty(V,"color",{get:function(){return se.color},set:function(le){se.color=latestColor=le,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&V.stage&&V.stage.update()}}),Object.defineProperty(V,"size",{get:function(){return se.size},set:function(le){se.size=le,se.hiddenInput.style.fontSize=le+"px",!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&V.stage&&V.stage.update()}}),Object.defineProperty(V,"align",{get:function(){return se.align},set:function(le){se.align=P=fe(le),P=="right"?se.x=e-se.width:P=="center"?se.x=e/2:se.x=0,V.placeholderLabel.x=se.x,V.placeholderLabel.align=P,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&V.stage&&V.stage.update()}}),Object.defineProperty(V,"font",{get:function(){return se.font},set:function(le){se.font=le,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&V.stage&&V.stage.update()}}),Object.defineProperty(V,"selectionAlpha",{get:function(){return se.selectionAlpha},set:function(le){se.selectionAlpha=le,se.selection.alpha!=0&&(se.selection.alpha=le),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&V.stage&&V.stage.update()}}),S!==!1&&t.styleTransforms(this,D),this.clone=function(le){return V.cloneProps(new t.TextInput(le||!t.isPick(N[0])?e:N[0],le||!t.isPick(N[1])?r:N[1],le||!t.isPick(N[2])?i:N[2],le||!t.isPick(N[3])?l:N[3],a,s,le||!t.isPick(N[4])?f:N[4],le||!t.isPick(N[5])?c:N[5],le||!t.isPick(N[6])?x:N[6],k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,this.group,p))}},t.extend(t.TextInput,t.Window,"clone","zimWindow",!1),t.TextInput.LabelInput=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we){this.zimLabel_constructor(e,r,x,k,null,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,null,B,d,null,u,p,L,we),this.type="LabelInput",n(k)&&(k=t.dark),n(a)&&(a=k),n(s)&&(s=.2),this.selectionAlpha=s,n(f)&&(f=k),n(c)&&(c=.5),this.hiddenInput=document.createElement("INPUT"),this.hiddenInput.setAttribute("id",t.makeID()),this.hiddenInput.value=e,o=="text"&&l&&(o="password"),this.hiddenInput.type=o,o=="number"&&(this.hiddenInput.pattern="[^(0-9).-+*/%$]*",this.hiddenInput.inputmode="numeric"),i>0&&(this.hiddenInput.maxLength=i),this.hiddenInput.autocapitalize="off",this.hiddenInput.autocorrect="off",this.hiddenInput.autocomplete="off",this.hiddenInput.spellcheck=!1,this.hiddenInput.style.position="absolute",this.hiddenInput.style.overflow="hidden",this.hiddenInput.style.touchAction="none",this.hiddenInput.style.left="-99999px",this.hiddenInput.style.top="-99999px",this.hiddenInput.style.zIndex=-999,this.hiddenInput.style.opacity=0,this.hiddenInput.style.width="1px",this.hiddenInput.style.height="1px",this.hiddenInput.style.fontSize="1px",this.onFocus=function(){this.stage&&(N=this.stage.frame),N.zil&&j.removeEventListener("keydown",N.zil[0]),this.blinker.alp(1).replayTween(),this.selection.alp(.2),this.positionBlinkerAndSelection(),this.dispatchEvent("focus")},this.onBlur=function(){this.stage&&(N=this.stage.frame),N.zil&&j.addEventListener("keydown",N.zil[0]),this.positionBlinkerAndSelection(),this.blinker.pauseAnimate(!0).alp(0),this.selection.alp(0),this.hiddenInput.type=o,this.dispatchEvent("blur")},this.onInput=function(){F&&(this.hiddenInput.value=this.hiddenInput.value.toUpperCase());var ue=this.hiddenInput.value;o=="number"&&(ue=ue.replace(/[^(0-9).\-+*/%$]*/g,""),this.hiddenInput.value=ue),this.text=this.hiddenInput.type=="password"?ue.replace(/./g,"*"):ue,this.measureText(),this.dispatchEvent("input")},this.onSelect=function(){this.positionBlinkerAndSelection(),this.focus&&this.blinker.replayTween()};var D=this;this.onKeydown=function(ue){this.deleteKey=ue.code=="Backspace"||ue.code=="Delete",this.blinker.replayTween(),setTimeout(function(){let fe=new CustomEvent("keydown",{detail:ue.keyCode});D.positionBlinkerAndSelection.call(D),D.dispatchEvent(fe)},10)},this.onMousedown=function(ue){var fe=this.text.length,V=this.eventPositionGlobalToLocal(ue);this.focus||(this.hiddenInput.focus(),(o=="number"||o=="email")&&(this.hiddenInput.type="text"));var z=this.mapPointToIndex(V);S?this.hiddenInput.setSelectionRange(fe-z,fe-z):this.hiddenInput.setSelectionRange(z,z),this.positionBlinkerAndSelection()},this.onPressmove=function(ue){var fe=this.text.length;this.focus||this.hiddenInput.focus();var V=this.eventPositionGlobalToLocal(ue),z;S?z=fe-this.mapPointToIndex(V):z=this.mapPointToIndex(V),this.hiddenInput.selectionStart===this.hiddenInput.selectionEnd?this.hiddenInput.selectionStart<=z?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,z,S?"backward":"forward"):this.hiddenInput.setSelectionRange(z,this.hiddenInput.selectionEnd,S?"forward":"backward"):this.hiddenInput.selectionDirection===(S?"backward":"forward")?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,z,S?"backward":"forward"):this.hiddenInput.setSelectionRange(z,this.hiddenInput.selectionEnd,S?"forward":"backward"),this.positionBlinkerAndSelection()},this.onDblclick=function(){this.hiddenInput.select(),this.positionBlinkerAndSelection()},this.positionBlinkerAndSelection=function(){var ue=this.text.length;if(this.focus){var fe=this.backing||this.background?this.paddingH:0,V=this.backing||this.background?this.paddingV:0;if(this.hiddenInput.selectionStart!==this.hiddenInput.selectionEnd){var z,se;S?(z=this.textWidthArray[ue-this.hiddenInput.selectionStart],se=this.textWidthArray[ue-this.hiddenInput.selectionEnd],this.selection.widthOnly=se-z,this.selection.pos(se+fe-1+Z,V+ne)):(z=this.textWidthArray[this.hiddenInput.selectionStart],se=this.textWidthArray[this.hiddenInput.selectionEnd],this.selection.widthOnly=se-z,this.selection.pos(z+fe-1+Z,V+ne)),this.selection.heightOnly=this.textHeight,this.selection.alp(this.selectionAlpha)}else this.selection.alp(0);this.blinker.heightOnly=this.textHeight;var Oe=this.hiddenInput.selectionDirection==="backward"?this.hiddenInput.selectionStart:this.hiddenInput.selectionEnd;Oe||(Oe=0),S&&(Oe=ue-Oe),this.blinker.pos(this.textWidthArray[Oe]+fe-1+(E=="right"&&this.text==""?this.width:E=="center"&&this.text==""?this.width/2:0)+Z,V+ne),this.dispatchEvent("blinker")}this.stage&&this.stage.update()},this.eventPositionGlobalToLocal=function(ue){var fe=this.globalToLocal(ue.stageX/t.scaX,ue.stageY/t.scaY);return E=="right"?fe.x-=this.label.x-this.width:E=="center"?fe.x-=(this.label.x-this.width)/2:fe.x-=this.label.x,fe.y-=this.label.y,fe},this.mapPointToIndex=function(ue){for(var fe=this.textWidthArray.length-1,V=0;V<this.textWidthArray.length-1;V++){var z=(this.textWidthArray[V]+this.textWidthArray[V+1])/2;if(ue.x<=z){fe=V;break}}return fe},this.measureText=function(){var ue=this.label.clone(),fe=this.text;S&&(fe=fe.split("").reverse().join(""));for(var V=0;V<fe.length&&V<this.previousMeasuredText.length&&fe[V]===this.previousMeasuredText[V];)V++;for(this.textWidthArray=this.textWidthArray.slice(0,V+1),V++;V<=fe.length;V++)ue.text=fe.slice(0,V),this.textWidthArray.push(ue.getMeasuredWidth());this.previousMeasuredText=fe,this.textHeight=ue.getMeasuredLineHeight()},this.setText=function(ue){F&&(ue=ue.toUpperCase()),this.hiddenInput.value=ue,this.onInput()},Object.defineProperty(this,"focus",{get:function(){return document.activeElement===D.hiddenInput},set:function(ue){ue===!0?D.hiddenInput.focus():D.hiddenInput.blur()}});var N;this.added(function(ue){N=ue.frame,D.hiddenInput.addEventListener("focus",D.onFocus.bind(D)),D.hiddenInput.addEventListener("blur",D.onBlur.bind(D))}),this.hiddenInput.addEventListener("input",this.onInput.bind(this)),this.hiddenInput.addEventListener("select",this.onSelect.bind(this)),this.hiddenInput.addEventListener("keydown",this.onKeydown.bind(this)),document.body.appendChild(this.hiddenInput),this.on("mousedown",this.onMousedown.bind(this)),this.on("pressmove",this.onPressmove.bind(this)),this.on("dblclick",this.onDblclick.bind(this)),this.cur("text"),this.blinker=new t.Rectangle({width:2,height:1,color:f,style:!1}).animate({obj:{alpha:0},wait:c,time:.1,rewind:!0,rewindWait:c,loop:!0,loopWait:c}).pauseAnimate(!0).alp(0).addTo(this),this.selection=new t.Rectangle({width:1,height:1,color:a,style:!1}).alp(0).addTo(this),this.textWidthArray=[0],this.previousMeasuredText="",this.textHeight=null,this.measureText()},t.extend(t.TextInput.LabelInput,t.Label,null,"zimLabel",!1),t.List=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le,Ae,re,xe,ke,te,pe,he,ae,Ee,ie,Se,Le,Ce,ee,Me,_e,Ye,je,it,Be,qe,et){var ve="width, height, list, viewNum, vertical, currentSelected, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, spacing, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, downColor, selectedColor, selectedRollColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, scrollBarOverlay, slide, slideFactor, slideSnap, slideSnapDamp, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, collapse, collapseColor, collapsed, excludeCustomTap, organizer, checkBox, pulldown, clone, cancelCurrentDrag, selectedIndex, noScale, pulldownToggle, optimize, keyEnabled, resizeHandle, resizeBoundary, resizeVisible, continuous, style, group, inherit",Pe;if(Pe=st(t.List,arguments,ve,this))return Pe;De("60.5"),this.group=qe;var oe=Be===!1?{}:t.getStyle("List",this.group,et);n(e)&&(e=oe.width!=null?oe.width:300);var Fe=r;n(r)&&(r=oe.height!=null?oe.height:n(pe)?200:200+pe.height),n(i)&&(i=i=oe.list!=null?oe.list:["Option 1","Option 2","Option 3","Option 4","Option 5","Option 6","Option 7","Option 8","Option 9","Option 10"]),i.length==0&&(i=["%-&"]),this.originalList=i,n(l)&&(l=oe.viewNum!=null?oe.viewNum:5),n(a)&&(a=oe.vertical!=null?oe.vertical:!0),n(s)&&(s=oe.currentSelected!=null?oe.currentSelected:!0);var Ze=!n(f)||!n(x);n(he)&&(he=oe.checkBox!=null?oe.checkBox:!1),n(f)&&(f=oe.align!=null?oe.align:he?"left":"center"),n(c)&&(c=oe.valign!=null?oe.valign:"center"),n(x)&&(x=oe.labelAlign!=null?oe.labelAlign:f),n(k)&&(k=oe.labelValign!=null?oe.labelValign:c),n(E)&&(E=oe.indent!=null?oe.indent:he?0:10),n(v)&&(v=oe.labelIndent!=null?oe.labelIndent:E),n(g)&&(g=oe.labelIndentH!=null?oe.labelIndentH:v),n(b)&&(b=oe.labelIndentV!=null?oe.labelIndentV:v),n(A)&&(A=oe.spacing!=null?oe.spacing:2),n(C)&&(C=oe.backdropColor!=null?oe.backdropColor:t.dark),n(T)&&(T=oe.backgroundColor!=null?oe.backgroundColor:t.tin),n(h)&&(h=oe.rollBackgroundColor!=null?oe.rollBackgroundColor:t.grey),n(w)&&(w=oe.downBackgroundColor!=null?oe.downBackgroundColor:h),n(P)&&(P=oe.selectedBackgroundColor!=null?oe.selectedBackgroundColor:t.charcoal),n(y)&&(y=oe.selectedRollBackgroundColor!=null?oe.selectedRollBackgroundColor:t.grey),n(O)&&(O=oe.color!=null?oe.color:t.white),n(_)&&(_=oe.rollColor!=null?oe.rollColor:O),n(Y)&&(Y=oe.downColor!=null?oe.downColor:_),n(m)&&(m=oe.selectedColor!=null?oe.selectedColor:O),n($)&&($=oe.selectedRollColor!=null?oe.selectedRollColor:_),n(C)&&(C=oe.backdropColor!=null?oe.backdropColor:C);var Xe=I,We=X;n(I)&&(I=oe.borderColor!=null?oe.borderColor:t.silver),n(X)&&(X=oe.borderWidth!=null?oe.borderWidth:1),n(R)&&(R=oe.padding!=null?oe.padding:A),n(q)&&(q=oe.corner!=null?oe.corner:0),n(J)&&(J=oe.swipe!=null?oe.swipe:!0),n(Z)&&(Z=oe.scrollBarActive!=null?oe.scrollBarActive:!0),n(ne)&&(ne=oe.scrollBarDrag!=null?oe.scrollBarDrag:!0),n(U)&&(U=oe.scrollBarColor!=null?oe.scrollBarColor:I),n(B)&&(B=oe.scrollBarAlpha!=null?oe.scrollBarAlpha:.3),n(d)&&(d=oe.scrollBarFade!=null?oe.scrollBarFade:!0),n(u)&&(u=oe.scrollBarH!=null?oe.scrollBarH:!a),n(o)&&(o=oe.scrollBarV!=null?oe.scrollBarV:a),ne&&(d=oe.scrollBarFade!=null?oe.scrollBarFade:!1),n(S)&&(S=oe.scrollBarOverlay!=null?oe.scrollBarOverlay:!0),n(F)&&(F=oe.slide!=null?oe.slide:!0),n(p)&&(p=oe.slideFactor!=null?oe.slideFactor:.95),n(L)&&(L=oe.slideSnap!=null?oe.slideSnap:a?"vertical":"horizontal"),n(D)&&(D=oe.shadowColor!=null?oe.shadowColor:"rgba(0,0,0,.3)"),n(N)&&(N=oe.shadowBlur!=null?oe.shadowBlur:20),n(fe)&&(fe=oe.paddingV!=null?oe.paddingV:R),n(ue)&&(ue=oe.paddingH!=null?oe.paddingH:R),n(V)&&(V=oe.scrollWheel!=null?oe.scrollWheel:!0),n(se)&&(se=oe.titleBar!=null?oe.titleBar:null),n(Oe)&&(Oe=oe.titleBarColor!=null?oe.titleBarColor:null),n(K)&&(K=oe.titleBarBackgroundColor!=null?oe.titleBarBackgroundColor:null),n(ge)&&(ge=oe.titleBarHeight!=null?oe.titleBarHeight:35),n(Q)&&(Q=oe.draggable!=null?oe.draggable:null),n(ce)&&(ce=oe.boundary!=null?oe.boundary:null),n(G)&&(G=oe.onTop!=null?oe.onTop:null),n(le)&&(le=oe.close!=null?oe.close:null),n(Ae)&&(Ae=oe.closeColor!=null?oe.closeColor:null),n(re)&&(re=oe.collapse!=null?oe.collapse:null),n(xe)&&(xe=oe.collapseColor!=null?oe.collapseColor:null),n(te)&&(te=oe.excludeCustomTap!=null?oe.excludeCustomTap:!1),n(he)&&(he=oe.checkBox!=null?oe.checkBox:!1),n(ae)&&(ae=oe.pulldown!=null?oe.pulldown:!1),n(Ce)&&(Ce=oe.pulldownToggle!=null?oe.pulldownToggle:!1),n(Le)&&(Le=oe.noScale!=null?oe.noScale:!1),n(Ee)&&(Ee=oe.clone!=null?oe.clone:!1),n(ee)&&(ee=oe.optimize!=null?oe.optimize:!0),n(Me)&&(Me=oe.keyEnabled!=null?oe.keyEnabled:null),n(_e)&&(_e=oe.resizeHandle!=null?oe.resizeHandle:null),n(Ye)&&(Ye=oe.resizeBoundary!=null?oe.resizeBoundary:null),n(je)&&(je=oe.resizeVisible!=null?oe.resizeVisible:!1),n(it)&&(it=oe.continuous!=null?oe.continuous:!1),se===!1&&(se=null),this.vertical=a;var de=this,Ve=r;j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?f=="start"?f="right":f=="end"&&(f="left"):f=="start"?f="left":f=="end"&&(f="right");var be;it?(de.continuous=!0,be=t.copy(i),t.loop(i.length,function(Je){i[Je].clone?be.push(i[Je].clone()):be.push(i[Je])})):be=i,he&&t.loop(be,function(Je,gt){be[gt]!="%-&"&&(be[gt]=t.List.checkItem(Je,null,e,"left",10,10,A,O,_,m,$,T,h,P,y))});var Te=Tt(),Re;if(be.constructor=={}.constructor){var Ne=n(be.shade)?n(oe.shade)?.2:oe.shade:be.shade,Ue=n(be.dim)?n(oe.dim)?.1:oe.dim:be.dim,rt=n(be.shift)?n(oe.shift)?15:oe.shift:be.shift,me=n(be.bloom)?n(oe.bloom)?!1:oe.bloom:be.bloom,He=n(be.whither)?n(oe.whither)?!1:oe.whither:be.whither,at=n(be.open)?n(oe.open)?!1:oe.open:be.open,Qe=n(be.expander)?n(oe.expander)?"plus":oe.expander:be.expander;Qe=Qe.toLowerCase(),Qe=="arrows"&&(Qe="arrow"),Qe!="none"&&Qe!="arrow"&&(Qe="plus"),me===!0&&(me=Te=="s"?.01:10),He===!0&&(He=Te=="s"?.01:10),Pt(me),Pt(He),rt===!0&&(rt=15),Ne===!0&&(Ne=.2),Ue===!0&&(Ue=.1);var ct=n(be.subStyles)?n(oe.subStyles)?{}:oe.subStyles:be.subStyles;n(be.menu)||(be=be.menu),Re=de.tree=new t.Hierarchy(be),be=Re.getLinearList(),Ze||(f=x="left")}ae&&(l=n(Re)?be.length:Re.length,n(Fe)&&(r=l*e/620*100+(l+1)*A+(n(se)?0:ge)),X=0,P=T,C=t.clear,J=!1);var ot=0,dt=0;t.loop(be,function(Je){Je.type=="ListItem"&&(Je.width=e-A*2),Le&&(Je.width&&(ot+=Je.width),Je.height&&(dt+=Je.height))}),ot&&(ot+=A*(be.length-1)),dt&&(dt+=A*(be.length-1)),this.align=f,this.valign=c,this.indent=E,n(pe)||(r=r-pe.height,pe.list=de,de.organizer=pe,pe.setButtons(),ge+=pe.height),it&&(Z=!1),this.zimWindow_constructor(e,r,null,C,I,X,R,q,J,Z,ne,U,B,d,u,o,F,p,L,we,!0,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le,Ae,ie,!1,null,_e,re,xe,ke,ee,Ye,je,it?a?"vertical":"horizontal":null,Be,qe,t.copy(oe)),this.type="List",n(se)||(this.titleBarLabel.pos(null,ge-30,null,!0),n(ge)&&(ge=30),r=r-ge),n(pe)||pe.addTo(de).loc(0,-pe.height),ot&&Le?(de.itemWidth=a?e-(Z?S?0:6:0):ot/be.length,de.itemHeight=a?dt/be.length:r-(Z?S?0:6:0)):(de.itemWidth=a?e-(Z?S?0:6:0):e/l,de.itemHeight=a?r/l:r-(Z?S?0:6:0));var $e,Mt=t.copy(oe);delete Mt.borderWidth,delete Mt.borderColor;function Ct(Je){$e=de.tabs=new t.Tabs({width:a?de.itemWidth:de.itemWidth*be.length,height:a?de.itemHeight*be.length:de.itemHeight,tabs:Je,spacing:A,vertical:a,backgroundColor:T,rollBackgroundColor:h,downBackgroundColor:w,selectedBackgroundColor:P,selectedRollBackgroundColor:y,color:O,rollColor:_,downColor:Y,selectedColor:m,selectedRollColor:$,backdropColor:C,currentEnabled:!0,currentSelected:s,align:f,valign:c,labelAlign:x,labelValign:k,labelIndent:v,labelIndentH:g,labelIndentV:b,indent:E,useTap:!0,excludeCustomTap:te,keyWrap:!1,keyEnabled:Me,style:Be,group:qe,inherit:Mt}).siz(a?e-ue*2:null,a?null:r-fe*2).mov(a?0:ue,a?fe:0),de.add($e),t.loop($e.labels,function(gt){gt&&(gt.backgroundColor=t.clear)})}Ct(t.copy(be,Ee)),it&&de.on("scrolling",function(){var Je=de.tabs.localToLocal(0,0,de);a&&(Je.y>=-de.tabs.buttons[0].height&&(de.tabs.y-=de.tabs.height/2+A/2),Je.y-de.tabs.buttons[de.tabs.buttons.length-1].height<=r-de.tabs.height&&(de.tabs.y+=de.tabs.height/2+A/2))});function xt(Je,gt,It){Je.listZID=gt,Je.label&&(Ne&&new t.Rectangle(rt*(It.level+1),Je.height).alp(Ne).pos(0,0,de.align=="right",!1,Je),Ue&&new t.Rectangle(Je.width,Je.height).alp((It.level+1)*Ue).addTo(Je).bot().ord(1),rt&&de.align!="center"&&(Je.label.x+=(de.align=="right"?-1:1)*rt*(It.level+1)));var Xt=Re.getData(gt);Xt.obj=Je,Xt.list&&!t.isEmpty(Xt.list)&&(Je.expander=new t.Label({size:Qe=="arrow"?22:36,text:Xt.open?Qe=="arrow"?"\u25B2":"-":Qe=="arrow"?"\u25BC":"+",align:"center",color:t.convertColor(O,"rgba",.6)}).center(Je).alp(Qe=="none"?0:.7).pos(15,null,de.align!="right").mov(0,Xt.open?-3:0))}function Bt(){if(!(!de.selected||!de.selected.expander)){var Je=Re.getData(de.selected.listZID),gt;if(Je.open){de.selected.expander&&(de.selected.expander.text=Qe=="arrow"?"\u25BC":"+",de.selected.expander.mov(0,3)),Je.open=!1;var It=Re.getNextSibling(de.selected.listZID),Xt;n(It)?Xt=de.items.length-1:Xt=t.loop(de.items,function(Kt,fn){if(Kt.listZID==It)return fn-1}),He?(gt=0,de.enabled=!1,t.interval(He,function(Kt){de.removeAt(1,de.selectedIndex+Xt-de.selectedIndex-gt),gt++,Kt.total==Kt.count+1&&(de.enabled=!0,de.dispatchEvent("collapsed"))},Xt-de.selectedIndex,!0)):(de.removeAt(Xt-de.selectedIndex,de.selectedIndex+1),de.dispatchEvent("collapsed"))}else{Je.open=!0,de.selected.expander&&(de.selected.expander.text=Qe=="arrow"?"\u25B2":"-",de.selected.expander.mov(0,-3));var Yt=Re.getLinearList(Je.list),ft=Re.getLinearIDs(Je.list),bt;if(Je.opened)Array.isArray(Yt)&&(me?(gt=0,de.enabled=!1,t.interval(me,function(Kt){de.addAt(Yt[gt],de.selectedIndex+1+gt),bt=new Ge.Event("bloom"),bt.item=Yt[gt],de.dispatchEvent(bt),Kt.total==Kt.count+1&&(de.enabled=!0,bt=new Ge.Event("expanded"),bt.items=Yt,de.dispatchEvent(bt)),gt++},Yt.length,!0)):(de.addAt(Yt,de.selectedIndex+1),bt=new Ge.Event("expanded"),bt.items=Yt,de.dispatchEvent(bt)));else{Je.opened=!0;var Gt=ct[Je.level];n(Gt)&&(Gt={}),Array.isArray(Yt)&&(me?(gt=0,de.enabled=!1,t.interval(me,function(Kt){de.addAt(Yt[gt],de.selectedIndex+1+gt,{backgroundColor:Gt.backgroundColor,color:Gt.color,rollBackgroundColor:Gt.rollBackgroundColor,rollColor:Gt.rollColor,selectedBackgroundColor:Gt.selectedBackgroundColor,selectedColor:Gt.selectedColor,selectedRollBackgroundColor:Gt.selectedRollBackgroundColor,selectedRollColor:Gt.selectedRollColor});var fn=ft[gt],Jt=de.items[de.selectedIndex+1+gt];Gt.borderColor&&(Jt.borderColor=Gt.borderColor),xt(Jt,fn,Je),Jt.label&&(Jt.label.backgroundColor=t.clear),bt=new Ge.Event("bloom"),bt.item=Jt,de.dispatchEvent(bt),Kt.total==Kt.count+1&&(de.enabled=!0,bt=new Ge.Event("expanded"),bt.items=Yt,de.dispatchEvent(bt)),gt++,de.stage&&de.stage.update()},Yt.length,!0)):(de.addAt(Yt,de.selectedIndex+1,{backgroundColor:Gt.backgroundColor,color:Gt.color,rollBackgroundColor:Gt.rollBackgroundColor,rollColor:Gt.rollColor,selectedBackgroundColor:Gt.selectedBackgroundColor,selectedColor:Gt.selectedColor,selectedRollBackgroundColor:Gt.selectedRollBackgroundColor,selectedRollColor:Gt.selectedRollColor}),t.loop(ft,function(Kt,fn){var Jt=de.items[de.selectedIndex+1+fn];xt(Jt,Kt,Je),Jt.label&&(Jt.label.backgroundColor=t.clear)}),bt=new Ge.Event("expanded"),bt.items=Yt,de.dispatchEvent(bt)))}}}}de.expandList=function(Je){return de.selectedIndex=Je,de.selected&&Bt(),de.selected};var Rt;if(Re){Ce&&de.added(function(Je){Rt=Je,de.stageToggleEvent=Rt.on("stagemousedown",function(){var gt=Rt.getObjectUnderPoint(Rt.frame.mouseX,Rt.frame.mouseY);if(!(gt&&de.contains(gt))&&!(!de.enabled||!de.selected)){var It=Re.getData(de.selected.listZID);It.open&&Bt()}})});var Ht=Re.getLinearIDs();t.loop(Ht,function(Je,gt){de.tabs.buttons[gt].listZID=Je}),t.loop(de.tabs.buttons,function(Je){var gt=Re.getData(Je.listZID);t.isEmpty(gt.list)||(Je.expander=new t.Label({size:Qe=="arrow"?22:36,text:Qe=="arrow"?"\u25BC":"+",align:"center",color:t.convertColor(O,"rgba",.6)}).center(Je).alp(Qe=="none"?0:.7).pos(15,null,de.align!="right"))});var nn=at;de.toggle=function(Je){if(n(Je))Je=!nn;else if(Je==nn)return;de.selectedIndex=0,nn=Je,Bt()},Object.defineProperty(de,"toggled",{get:function(){return nn},set:function(Je){nn!=Je&&de.toggle()}}),de.tap(Bt)}var en;$e.tap(function(Je){Je.target.selectedIndex!=de.selectedIndex&&(de.selectedIndex=$e.selectedIndex,de.dispatchEvent("change"),Ce&&(de.selectedIndex=0),Je.preventDefault())}),$e.on("keychange",function(Je){if(Je.target.selectedIndex!=de.selectedIndex){de.selectedIndex=$e.selectedIndex;var gt;setTimeout(function(){a?(gt=de.selected.y+de.scrollY,(gt<0||gt>de.height-de.selected.height)&&de.animateTo(de.selectedIndex,Te=="ms"?100:.1)):(gt=de.selected.x+de.scrollX,(gt<0||gt>de.width-de.selected.width)&&de.animateTo(de.selectedIndex,Te=="ms"?100:.1))},100),de.dispatchEvent("change")}}),this.getItemIndex=function(Je){return de.items.indexOf(Je)},this.animateTo=function(Je,gt){n(Je)&&(Je=0),n(gt)&&(gt=.05);var It=Tt(gt);de.selectedIndex=Je;var Xt=kt(Je),Yt;return a?(Yt=Math.abs(de.scrollY-Xt)/de.itemHeight,de.animate({scrollY:Xt},Yt*gt/(It=="s"?1:1e3))):(Yt=Math.abs(de.scrollX-Xt)/de.itemWidth,de.animate({scrollX:Xt},Yt*gt/(It=="s"?1:1e3))),de},this.addAt=function(Je,gt,It,Xt){if(n(Je))return de;if(de.tabs.loop(function(ft){ft.visible=!0}),Je.type=="ListItem"?Je.width=e-A*2:Array.isArray(Je)&&t.loop(Je,function(ft){ft.type=="ListItem"&&(ft.width=e-A*2)}),Xt)if(Array.isArray(Je)){var Yt=[];t.loop(Je,function(ft){ft.clone?Yt.push(Je.clone()):Yt.push(t.copy(Je,Xt))}),de.tabs.addAt(Yt,gt,It)}else Je.clone?de.tabs.addAt(Je.clone(),gt,It):de.tabs.addAt(t.copy(Je,Xt),gt,It);else he&&(Array.isArray(Je)||(Je=[Je]),t.loop(Je,function(ft,bt){typeof ft=="string"&&(Je[bt]=t.List.checkItem(ft,null,e,"left",10,10,A,O,_,m,$,T,h,P,y))})),de.tabs.addAt(Je,gt,It);return de.update(),de},this.removeAt=function(Je,gt){it&&de.tabs.removeAt(Je,gt+i.length),de.tabs.removeAt(Je,gt),de.tabs.loop(function(Xt){Xt.visible=!0}),en=de.tabs.selectedIndex;var It=$e.getBounds();return $e.setBounds(0,0,It.width,It.height),It.height<r&&(de.scrollY=0),de.update(),de},be[0]=="%-&"&&be.length==1&&de.removeAt(1,0),this.clear=function(){return de.tabs.removeAt(de.length,0),de.contentContainer.x=0,de.contentContainer.y=0,de.update(),de},this.setCheck=function(Je,gt){n(Je)&&(Je=0),n(gt)&&(gt=!0),de.items[Je].checkBox.checked=gt,de.items[Je].content.zimOut()},this.getCheck=function(Je){return n(Je)&&(Je=0),de.items[Je].checkBox.checked},this.setChecks=function(Je){return t.loop(de.items,function(gt){gt.checkBox.checked=Je,gt.content.zimOut()}),de},Object.defineProperty(de,"items",{get:function(){return de.tabs.buttons},set:function(){pt&&tt("List() - items is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(de,"list",{get:function(){return de.tabs.buttons},set:function(){pt&&tt("List() - list is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(de,"length",{get:function(){return de.tabs.buttons.length},set:function(){pt&&tt("List() - length is read only")}}),Object.defineProperty(de,"selectedIndex",{get:function(){return it?(en+i.length)%i.length:en},set:function(Je){$e.selectedIndex=Je,de.label=$e.label,de.selected=$e.selected,en=Je,!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&de.stage&&de.stage.update()}}),s&&(de.selectedIndex=0),Object.defineProperty(de,"selectedIndexPlusPosition",{get:function(){return it?(en+i.length)%i.length:en},set:function(Je){de.selectedIndex=Je,en=Je,a?de.scrollY=kt(Je)-2:de.scrollX=kt(Je),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&de.stage&&de.stage.update()}});function kt(Je){if(a){var gt=-(de.itemHeight+A)*Je+r/2-de.itemHeight/2;return(de.itemHeight+A)*de.length<r&&(gt=0),gt>0&&(gt=0),(de.itemHeight+A)*de.length>r&&gt<-de.tabs.height+r-fe*2&&(gt=-de.tabs.height+r-fe*2),gt}else{var It=-(de.itemWidth+A)*Je+e/2-de.itemWidth/2;return(de.itemWidth+A)*de.length<e&&(It=0),It>0&&(It=0),(de.itemWidth+A)*de.length>e&&It<-de.tabs.width+e-ue*2&&(It=-de.tabs.width+e-ue*2),It}}Object.defineProperty(de,"text",{get:function(){return de.label?de.label.text:null},set:function(Je){de.label&&(de.label.text=Je)}}),Object.defineProperty(de,"bloom",{get:function(){return me},set:function(Je){me=Je}}),Object.defineProperty(de,"currentValue",{get:function(){return de.label?de.label.text:null},set:function(Je){var gt=t.loop(de.list,function(It,Xt){var Yt;It.label&&(Yt=It.label.text),It.type=="Label"&&(Yt=It.text);var ft=new RegExp(Je,"i");if(Yt&&Yt.match(ft))return Xt});gt!==!0&&(de.selectedIndexPlusPosition=gt)}}),Object.defineProperty(de,"itemDown",{get:function(){return de.tabs.buttonDown},set:function(){}}),Object.defineProperty(de,"itemsText",{get:function(){for(var Je=[],gt=0;gt<de.tabs.buttons.length;gt++){var It=de.tabs.buttons[gt].label;It&&!n(It.text)?Je.push(It.text):Je.push(null)}return Je},set:function(){pt&&tt("List() - itemsText is read only")}}),s&&(de.selectedIndex=0),Object.defineProperty(de,"checkBoxes",{get:function(){for(var Je=[],gt=0;gt<de.tabs.buttons.length;gt++){var It=de.tabs.buttons[gt].checkBox;Je.push(It)}return Je},set:function(){pt&&tt("List() - checkBoxes is read only")}}),Object.defineProperty(de,"accordionIndex",{get:function(){var Je=de.selected.listZID;return Je?Number(Je.split("id")[1]):null},set:function(){pt&&tt("List() - accordionIndex is read only")}}),this.last=function(){return this.selectedIndexPlusPosition=this.length-1,this},this.first=function(){return this.selectedIndexPlusPosition=0,this},this.openAtLevel=function(Je){if(!n(Je)){var gt=[];t.loop(Je,function(Xt){gt.push(Xt)});var It=de.bloom;de.bloom=!1,t.interval(.01,function(Xt){var Yt=de.items[Xt.count];Yt?gt.indexOf(de.tree.getData(Yt.listZID).level)!=-1&&de.expandList(Xt.count):(Xt.clear(),de.bloom=It)},null,!0,!1,"s")}};var Qt;this.openAtNum=function(Je){if(!n(Je)){if(!Qt){let Kt=function(fn,Jt){for(gt in fn)Qt[gt]=Jt,Kt(fn[gt].list,gt)};var gt;Qt={},Kt(de.tree.data);var It={};for(var Xt in Qt){It[Xt]||(It[Xt]=[]);for(var Yt=Qt[Xt];Yt;)It[Xt].unshift(Yt),Yt=Qt[Yt];It[Xt].push(Xt)}}var ft="id"+Je,bt=It[ft],Gt=de.bloom;de.bloom=!1,ki(.01,function(Kt){var fn=de.items[Kt.count];fn?bt.indexOf(fn.listZID)!=-1&&de.expandList(Kt.count):(Kt.clear(),de.bloom=Gt)},null,!0,!1,"s")}},at&&Bt&&de.openAtLevel(1e4),n(Se)&&(Se=oe.selectedIndex!=null?oe.selectedIndex:0),de.selectedIndex=Se,Be!==!1&&t.styleTransforms(this,oe),this.clone=function(){return de.cloneProps(new t.List(e,Ve,t.copy(de.originalList,!0),l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,Xe,We,R,t.copy(q),J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le,Ae,re,xe,ke,te,pe,he,ae,Ee,ie,Se,Le,Ce,ee,Me,_e,Ye,je,it,Be,this.group,et))},this.dispose=function(Je,gt,It){return It||(de.stageToggleEvent&&Rt.off("stagemousedown",de.stageToggleEvent),de.organizer&&de.organizer.dispose(),this.zimWindow_dispose()),!0}},t.extend(t.List,t.Window,["clone","dispose"],"zimWindow",!1),t.List.makeBase=function(e,r,i,l){n(l)&&(l=t.dark),e.backing=new t.Rectangle(e.width,e.height,l).center(e),r.type=="Label"?e.label=r:e.label=new t.Label(r,null,null,t.white),e.text=e.label.text,e.label.center(e).loc(i)},t.List.slider=function(e,r,i,l,a,s,f,c,x,k,v,g,b){var E="label, min, max, val, call, step, obj, property, paddingLeft, paddingRight, factor, offset, backgroundColor",A;if(A=st(t.List.slider,arguments,E))return A;var T=new t.Container(620,100);return T.type="ListItem",T.listItem="Slider",n(x)&&(x=20),n(k)&&(k=30),n(v)&&(v=1),n(g)&&(g=0),t.List.makeBase(T,e,x,b),T.slider=new t.Slider({inside:!0,barWidth:40,barLength:150,barColor:t.blue,min:r,max:i,step:s}).sca(1.5).center(T).mov(20).change(function(){T.stepper.currentValue=g+Math.round(T.slider.currentValue*v*1e3)/1e3,f&&c&&(f[c]=T.slider.currentValue),a&&typeof a=="function"&&a(T.slider.currentValue,T.parent),T.slider.stage&&T.slider.stage.update()}),n(l)||(T.slider.currentValue=l),T.stepper=new t.Stepper({corner:0,arrows:!1,stepperType:"number",min:g+r*v,max:g+i*v,step:s}).center(T).pos(k,null,!0).change(function(){}),n(l)||(T.stepper.currentValue=g+l*v),T},t.List.checkBox=function(e,r,i,l,a,s,f,c){var x="label, checked, call, obj, property, paddingLeft, paddingRight, backgroundColor",k;if(k=st(t.List.checkBox,arguments,x))return k;var v=new t.Container(620,100);return v.type="ListItem",v.listItem="CheckBox",n(s)&&(s=20),n(f)&&(f=30),t.List.makeBase(v,e,s,c),v.checkBox=new t.CheckBox({startChecked:r,label:""}).sca(1.2).center(v).pos(256+f,null,!0).change(function(){l&&a&&(l[a]=v.checkBox.checked),i&&typeof i=="function"&&i(v.checkBox.checked,v.parent),v.checkBox.stage&&v.checkBox.stage.update()}),v},t.List.colorPicker=function(e,r,i,l,a,s,f,c,x){var k="label, color, picker, call, obj, property, paddingLeft, paddingRight, backgroundColor",v;if(v=st(t.List.colorPicker,arguments,k))return v;var g=new t.Container(620,100);return g.type="ListItem",g.listItem="ColorPicker",n(f)&&(f=20),n(c)&&(c=30),t.List.makeBase(g,e,f,x),n(r)&&(r=t.pink),g.colorPicker=i||new t.ColorPicker({alphaPicker:!1,selectedColor:r}),g.swatch=new t.Rectangle(132,66,r,t.lighter,5).center(g).pos(270,null,!0).cur(),g.swatch.on("mousedown",function(){g.colorPicker.selectedColor=g.swatch.color,g.colorPicker.show()}),g.colorLabel=new t.Label(g.swatch.color.toUpperCase(),40,null,t.light).center(g).pos(c,null,!0),g.colorPicker.on("close",function(){var b=g.colorPicker.stage;g.colorPicker.hide(),b&&b.update()}),g.colorPicker.on("change",function(){var b=g.colorPicker.stage;g.swatch.color=g.colorPicker.selectedColor,g.colorLabel.text=g.swatch.color.toUpperCase(),g.colorPicker.hide(),a&&s&&(a[s]=g.colorPicker.selectedColor),l&&typeof l=="function"&&l(g.colorPicker.selectedColor,g.parent),b&&b.update()}),g},t.List.checkItem=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h){var w="label, size, width, align, paddingH, paddingV, spacing, color, rollColor, selectedColor, selectedRollColor, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, group, inherit",P;if(P=st(t.List.checkItem,arguments,w))return P;var y=t.getStyle("CheckBox",T,h);n(r)&&(r=y.size!=null?y.size:20);var C=t.getStyle("List",T,h);n(i)&&(i=300),n(a)&&(a=10),n(s)&&(s=10),n(l)&&(l=C.align!=null?C.align:"center"),n(f)&&(f=C.spacing!=null?C.spacing:2),n(g)&&(g=C.backgroundColor!=null?C.backgroundColor:t.tin),n(b)&&(b=C.rollBackgroundColor!=null?C.rollBackgroundColor:t.grey),n(E)&&(E=C.selectedBackgroundColor!=null?C.selectedBackgroundColor:t.charcoal),n(A)&&(A=C.selectedRollBackgroundColor!=null?C.selectedRollBackgroundColor:t.grey),n(c)&&(c=C.color!=null?C.color:t.white),n(x)&&(x=C.rollColor!=null?C.rollColor:c),n(k)&&(k=C.selectedColor!=null?C.selectedColor:c),n(v)&&(v=C.selectedRollColor!=null?C.selectedRollColor:x);var O=new t.Container;return O.type="CheckItem",O.checkBox=new t.CheckBox({size:r,label:e,color:c,tap:!0}),O.backing=new t.Rectangle(i-f*2,O.checkBox.height+s*2,g).addTo(O),O.checkBox.center(O),l!="center"&&l!="middle"&&O.checkBox.pos(a,null,l=="right"),O.backing.tap(function(){O.checkBox.toggle(),O.zimOut()}),O.checkBox.change(function(){O.zimOut()}),O.zimOver=function(){O.backing.color=O.checkBox.checked?A:b,O.checkBox.label.color=O.checkBox.checked?v:x,O.stage&&O.stage.update()},O.zimOut=function(){O.backing.color=O.checkBox.checked?E:g,O.checkBox.label.color=O.checkBox.checked?k:c,O.stage&&O.stage.update()},O.backing.on("mouseover",O.zimOver),O.checkBox.on("mouseover",O.zimOver),O.backing.on("mouseout",O.zimOut),O.checkBox.on("mouseout",O.zimOut),O},t.Stepper=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S){var F="list, width, backgroundColor, borderColor, borderWidth, label, color, vertical, arrows, corner, shadowColor, shadowBlur, continuous, display, press, hold, holdDelay, holdSpeed, draggable, dragSensitivity, dragRange, stepperType, min, max, step, step2, arrows2, arrows2Scale, keyEnabled, keyArrows, rightForward, downForward, selectedIndex, currentValue, arrowColor, arrowScale, style, group, inherit",p;if(p=st(t.Stepper,arguments,F,this))return p;De("61"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Stepper",this.group=o;var L=u===!1?{}:t.getStyle(this.type,this.group,S);n(e)&&(e=L.list!=null?L.list:[]),n(r)&&(r=L.width!=null?L.width:100),n(i)&&(i=L.backgroundColor!=null?L.backgroundColor:t.white),n(l)&&(l=L.borderColor!=null?L.borderColor:null),n(a)&&(a=L.borderWidth!=null?L.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(f)&&(f=L.color!=null?L.color:t.grey),n(s)&&(s=L.label!=null?L.label:""),(typeof s=="string"||typeof s=="number")&&(s=new t.Label({text:s,size:L.size!=null?L.size*2:40,color:f,align:L.align!=null?L.align:"center",valign:L.valign!=null?L.valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).loc(0,0)),n(c)&&(c=L.vertical!=null?L.vertical:!1),n(x)&&(x=L.arrows!=null?L.arrows:!0),n(k)&&(k=L.corner!=null?L.corner:16),n(v)&&(v=L.shadowColor!=null?L.shadowColor:"rgba(0,0,0,.3)"),n(g)&&(g=L.shadowBlur!=null?L.shadowBlur:14),n(b)&&(b=L.continuous!=null?L.continuous:!1),n(E)&&(E=L.display!=null?L.display:!0),n(A)&&(A=L.press!=null?L.press:!0),n(T)&&(T=L.hold!=null?L.hold:!0);var we=Tt(h);n(h)&&(h=L.holdDelay!=null?L.holdDelay:we=="s"?.4:400),n(w)&&(w=L.holdSpeed!=null?L.holdSpeed:we=="s"?.2:200),Pt(w,we),n(P)&&(P=L.draggable!=null?L.draggable:!0),(n(y)||y<=0)&&(y=L.dragSensitivity!=null?L.dragSensitivity:.1),n(C)&&(C=L.dragRange!=null?L.dragRange:200),n(O)&&(O=L.stepperType!=null?L.stepperType:e.length>0?"list":"number"),n(_)&&(_=L.min!=null?L.min:0),n(Y)&&(Y=L.max!=null?L.max:10),n(m)&&(m=L.step!=null?L.step:1),n($)&&($=L.step2!=null?L.step2:m),n(I)&&$!=m&&O=="number"&&(I=L.arrows2!=null?L.arrows2:!0),n(X)&&(X=L.arrows2Scale!=null?L.arrows2Scale:.5),n(R)&&(R=L.keyEnabled!=null?L.keyEnabled:!0),n(q)&&(q=L.keyArrows!=null?L.keyArrows:!0),n(J)&&(J=L.rightForward!=null?L.rightForward:!0),n(Z)&&(Z=L.downForward!=null?L.downForward:O!="number"),n(B)&&(B=L.arrowColor!=null?L.arrowColor:i),n(d)&&(d=L.arrowScale!=null?L.arrowScale:1);var D=this,N,ue=60,fe=ue/4;i=nt(i);var V=m,z,se=1,Oe;if(O=="number"){if(_=Number(_),Y=Number(Y),isNaN(_)&&(_=0),isNaN(Y)&&(Y=100),Y<_){se=-1;var K=Y;Y=_,_=K,z=Y}else z=_;this.min=_,this.max=Y,0>_&&0<Y&&(z=0),m=Math.abs(m),Oe=Math.max(ce(m),ce($))}else if(O=="letter"){e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),typeof _!="string"&&(_="A"),typeof Y!="string"&&(Y="Z"),_=_.substr(0,1).toUpperCase(),Y=Y.substr(0,1).toUpperCase();var ge=e.indexOf(_);ge<0&&(_="A",ge=0);var Q=e.indexOf(Y);Q<0&&(Y="Z",Q=e.length),Q<ge&&(e.reverse(),ge=e.length-1-ge,Q=e.length-1-Q),e=e.splice(ge,Q-ge+1)}else O="list";function ce(Xe){var We=String(Xe).split(".")[1];return We?We=We.length:We=0,We}var G,le=0,Ae=0;P&&this.on("mousedown",function(Xe){D.zimAccessibility&&D.zimAccessibility.aria||(this.stage.mouseMoveOutside=!0,le=Xe.rawX/t.scaX,Ae=Xe.rawY/t.scaY,G=this.stage.on("stagemousemove",function(We){le=We.rawX/t.scaX,Ae=We.rawY/t.scaY}))},null,!0),this.label=s,s.mouseChildren=!1,s.mouseEnabled=!1;var re,xe,ke,te,pe,he,ae,Ee,ie,Se,Le,Ce,ee;if(x&&(ke=this.containerPrev=new t.Container({style:!1}),this.addChild(ke),te=this.arrowPrev=new t.Triangle(ue,ue*.8,ue*.8,B,null,null,null,null,null,null,null,!1).sca(d),v!=-1&&g>0&&(ke.shadow=new Ge.Shadow(v,3,3,g)),ke.addChild(te),ke.expand(),ke.cur("pointer"),ke.on("mousedown",function(Xe){if(!(D.zimAccessibility&&D.zimAccessibility.aria)){V=m;var We=c?Z?1:-1:J?-1:1;it(We),Ye(We,null,null,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),T&&ke.on("pressup",je),c?(ke.rotation=180,ke.x=r/2,E?ke.y=ke.height+fe+ue+ke.height/2+fe:ke.y=ke.height*2):(ke.rotation=-90,ke.x=ke.height/2,ke.y=ue/2)),E){var Me=this.textBox=new t.Rectangle(r,ue,i,l,a,k,null,null,null,!1);Me.cur("pointer"),this.addChild(Me),v!=-1&&g>0&&(Me.shadow=new Ge.Shadow(v,3,3,g)),x&&(c?x&&(Me.y=te.height+fe):x&&(Me.x=te.height+fe)),this.addChild(s),e.length>0&&(N=0,s.text=e[N]),s.center(D);var _e;Me.on("mousedown",function(Xe){D.zimAccessibility&&D.zimAccessibility.aria||(_e=D.currentValue,A&&it(1),Ye(1,!0,null,Xe.stageX/t.scaX,Xe.stageY/t.scaY))}),Me.on("pressup",function(){D.zimAccessibility&&D.zimAccessibility.aria})}else e.length>0&&(N=0);x&&(pe=this.containerNext=new t.Container({style:!1}),this.addChild(pe),he=this.arrowNext=new t.Triangle(ue,ue*.8,ue*.8,B,null,null,null,null,null,null,null,!1).sca(d),v!=-1&&g>0&&(pe.shadow=new Ge.Shadow(v,3,3,g)),pe.addChild(he),pe.expand(),pe.cur("pointer"),pe.on("mousedown",function(Xe){if(!(D.zimAccessibility&&D.zimAccessibility.aria)){V=m;var We=c?Z?-1:1:J?1:-1;it(We),Ye(We,null,null,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),T&&pe.on("pressup",je),c?(pe.rotation=0,pe.x=r/2,pe.y=pe.getBounds().height/2):(pe.rotation=90,E?pe.x=Me.x+Me.getBounds().width+pe.getBounds().height/2+fe:pe.x=ke.x+ke.getBounds().width,pe.y=ue/2));function Ye(Xe,We,de,Ve,be){if(T){Le=Ve,Ce=be,Le==0&&(Le=1),Ce==0&&(Ce=1),P||(y=1);var Te=w*(we=="s"?1e3:1),Re=h*(we=="s"?1e3:1),Ne=Te;ee=new t.Proportion(0,C,Te,Te*y),re=setTimeout(function(){function Ue(){xe=setTimeout(function(){var rt=Xe;if(P){var me=Math.abs(le-Le),He=Math.abs(Ae-Ce);c?(!We&&!de&&(me=0),de&&(He=0)):(!We&&!de&&(He=0),de&&(me=0)),(me>=10||He>=10)&&(me>He?(V=c?$:m,rt=le-Le>0?1:-1,J||rt*-1,Ne=ee.convert(Math.abs(Le-le))):(V=c?m:$,rt=Ae-Ce>0?1:-1,(O=="number"||!Z)&&(rt*=-1),Ne=ee.convert(Math.abs(Ce-Ae))))}it(rt),Ue()},Ne)}Ue()},Re)}}T&&E&&Me.on("pressup",je);function je(){D.zimAccessibility&&D.zimAccessibility.aria||(clearTimeout(re),clearTimeout(xe))}I&&(ae=this.prev2=new t.Container({style:!1}),Ee=this.arrowPrev2=new t.Triangle(ue,ue*.8,ue*.8,"rgba(0,0,0,.2)",B,2,null,null,null,null,null,!1),ae.addChild(Ee),ae.expand(),ae.cur("pointer"),ae.sca(X),ae.alpha=.5,ae.on("mousedown",function(Xe){if(!(D.zimAccessibility&&D.zimAccessibility.aria)){V=$;var We=c?J?-1:1:Z?1:-1;it(We),Ye(We,null,!0,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),T&&ae.on("pressup",je),ie=this.next2=new t.Container({style:!1}),Se=this.arrowNext2=new t.Triangle(ue,ue*.8,ue*.8,"rgba(0,0,0,.2)",B,2,null,null,null,null,null,!1),ie.addChild(Se),ie.expand(),ie.cur("pointer"),ie.sca(X),ie.alpha=.5,ie.on("mousedown",function(Xe){if(!(D.zimAccessibility&&D.zimAccessibility.aria)){V=$;var We=c?J?1:-1:Z?-1:1;it(We),Ye(We,null,!0,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),T&&ie.on("pressup",je),c?(ae.y=this.height/2,ae.x=-ae.width/2-fe*Math.max(.2,Math.min(1,X)),ae.rotation=270,ie.y=this.height/2,ie.x=this.width+ie.width/2+fe*Math.max(.2,Math.min(1,X)),ie.rotation=90):(ie.x=this.width/2,ie.y=-ie.height/2-fe*Math.max(.2,Math.min(1,X)),ie.rotation=0,ae.x=this.width/2,ae.y=this.height+ae.height/2+fe*Math.max(.2,Math.min(1,X)),ae.rotation=180),this.addChild(ae,ie)),Object.defineProperty(this,"stepperArray",{get:function(){if(O=="number"){e=[];for(var Xe=D.min;Xe<=D.max;Xe+=Math.min(m,$))e.push(Number(t.decimals(Xe,Oe,null,!1)));e.push(Y)}return e},set:function(Xe){e=Xe;var We=D.selectedIndex;D.selectedIndex=We}}),Object.defineProperty(this,"min",{get:function(){return _},set:function(Xe){if(O=="number"){D.currentValue<Xe&&(D.currentValue=Xe),_=Xe;var We=D.selectedIndex;D.selectedIndex=We}else _=Xe}}),Object.defineProperty(this,"max",{get:function(){return Y},set:function(Xe){if(O=="number"){D.currentValue>Xe&&(D.currentValue=Xe),Y=Xe;var We=D.selectedIndex;D.selectedIndex=We}else Y=Xe}}),et(O=="number"?z:e[N],O=="number"?z:N);function it(Xe){var We;if(O=="number"){z=Number(z);var de=z;z+=Number(V*Xe*se),z=t.decimals(z,Oe),b?z>D.max?z=D.min:z<D.min&&(z=D.max):(z>D.max?(z=m==1?D.max:de,E&&Me.cur("default")):E&&Me.cur("pointer"),z<D.min&&(z=m==1?D.min:de))}else{if(We=N+Xe,b)We>e.length-1&&(We=0),We<0&&(We=e.length-1);else{if(We>e.length-1){E&&Me.cur("default");return}else E&&Me.cur("pointer");if(We<0)return}N=We}et(O=="number"?z:e[N],O=="number"?z:N),D.currentValue!=_e&&D.dispatchEvent("change"),_e=D.currentValue}Object.defineProperty(this,"selectedIndex",{get:function(){return O=="number"?D.stepperArray.indexOf(D.currentValue):N},set:function(Xe){n(Xe)||(O=="number"?(N=Math.min(D.stepperArray.length-1,Math.max(0,Xe)),z=D.stepperArray[N],et(z,z)):(Xe=Math.min(e.length-1,Math.max(0,Xe)),N=Xe,et(e[N],N)))}}),Object.defineProperty(this,"currentValue",{get:function(){return O=="number"?Number(z):e[N]},set:function(Xe){if(!n(Xe))if(O=="number"){if(Xe=Number(Xe),D.max>D.min){if(Xe>D.max||Xe<D.min)return}else if(Xe<D.max||Xe>D.min)return;var We=D.stepperArray.indexOf(Xe);if(We<0)return;N=We,z=Number(D.stepperArray[N]),et(z,z)}else{if(e.indexOf(Xe)>-1)Xe=e.indexOf(Xe);else return;if(Xe==D.selectedIndex)return;N=Xe,et(e[N],N)}}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return D.currentValue},set:function(Xe){String(Xe)!=String(D.currentValue)&&(D.currentValue=Xe,D.dispatchEvent("change"))}}),Object.defineProperty(this,"continuous",{get:function(){return b},set:function(Xe){b=Xe,O=="number"?et(z,z):et(e[D.selectedIndex],D.selectedIndex)}}),this._enabled=!0,Object.defineProperty(D,"enabled",{get:function(){return D._enabled},set:function(Xe){St(D,Xe),Xe?(O=="number"?et(z,z):et(e[D.selectedIndex],D.selectedIndex),j.addEventListener("keydown",D.keyDownEvent)):(ve(),Pe(),j.removeEventListener("keydown",D.keyDownEvent),E&&(s.mouseChildren=!1),E&&(s.mouseEnabled=!1)),pe&&!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&pe.stage?pe.stage.update():s&&!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&s.stage&&s.stage.update()}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==D},set:function(){t.KEYFOCUS=D}}),t.KEYFOCUS||Be(),this.on("mousedown",function(){Be()});function Be(){D.keyFocus=!0;var Xe=document.activeElement;Xe&&Xe.blur()}function qe(){ke.alpha=1,te.color=B,ke.cur("pointer"),pe.alpha=1,he.color=B,pe.cur("pointer"),b||(O=="number"?(N==D.min&&(se>0?ve():Pe()),N==D.max&&(se>0?Pe():ve())):(N==0&&(c?Pe():ve()),N==e.length-1&&(c?ve():Pe())))}function et(Xe,We){N=We,E&&(O=="number"&&Xe!=0&&Oe>0&&(Xe=t.decimals(Xe,Oe,!0)),s.text=Xe,s.center(D)),x&&qe(),pe&&!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&pe.stage?pe.stage.update():s&&!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&s.stage&&s.stage.update(),D.zimAccessibility&&D.zimAccessibility.changeTitle(D,null,!0)}function ve(){x&&(ke.alpha=.8,te.color=t.fog,ke.cur("default"))}function Pe(){x&&(pe.alpha=.8,he.color=t.fog,pe.cur("default"))}var oe,Fe=!0,Ze="";this.on("mousedown",function(){Fe=!0,Ze="",!(D.zimAccessibility&&D.zimAccessibility.aria)&&(D.focus=!0,oe=!1)}),this.keyDownEvent=function(Xe){if(D.stage&&(D.zimAccessibility&&D.focus||!D.zimAccessibility&&D.keyFocus)){Xe||(Xe=event);var We=Xe.keyCode;if(q&&We>=37&&We<=40){var de=Z?40:38,Ve=J?39:37,be=Z?38:40,Te=J?37:39;We==de||We==Ve?(c&&We==de||!c&&We==Ve?V=m:V=$,it(1)):(We==be||We==Te)&&(c&&We==be||!c&&We==Te?V=m:V=$,it(-1))}if(R)if(O=="number"){var Re=null,Ne=null;if(We==8){var Ue=String(Ze).split("");Ue.pop(),Re=Ue.pop(),Ze=Ue.join("")}if(!Xe.shiftKey&&We>=48&&We<=57?Re=We-48:We>=96&&We<=105?Re=We-96:We==190?(Ze=String(Ze)+".",Ne=!0):We==173||We==189?(D.currentValue=D.currentValue*-1,D.currentValue!=_e&&D.dispatchEvent("change"),_e=D.currentValue,oe=!oe):We==46&&(Fe=!0,Ze=""),n(Re)&&n(Ne)){Fe=!0,Ze="";return}if(n(Re)||(Fe?(Fe=!1,Ze=Re):Ze=Re=+(Ze+""+Re),Re<_||Re>Y))return;D.currentValue=Re,D.currentValue!=_e&&D.dispatchEvent("change"),_e=D.currentValue}else Fe=!0,Ze="",D.currentValue=String.fromCharCode(Xe.keyCode),D.currentValue!=_e&&D.dispatchEvent("change"),_e=D.currentValue}},j.addEventListener("keydown",this.keyDownEvent),this.next=function(){it(1)},this.prev=function(){it(-1)},n(ne)&&(ne=L.selectedIndex!=null?L.selectedIndex:0),D.selectedIndex=ne,n(U)&&(U=L.currentValue!=null?L.currentValue:null),n(U)||(D.currentValue=U),u!==!1&&t.styleTransforms(this,L),this.clone=function(){return D.cloneProps(new t.Stepper(e,r,i,l,a,s.clone(),f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,this.group,S))},this.dispose=function(Xe,We,de){return j.removeEventListener("keydown",D.keyDownEvent),D.removeAllEventListeners(),D.stage&&D.stage.off(G),de||this.zimContainer_dispose(!0),ke=this.containerPrev=te=this.arrowPrev=null,pe=this.containerNext=he=this.arrowNext=null,Me=this.textBox=s=this.label=null,!0}},t["zut"]=function(e){if(!n(e)&&e["key"])t.async("https://zimjs.com/gamdata.php?id="+e["key"]+"&player="+e["player"]+"&score="+e["score"]+"&reverse="+e["info"]["reverse"]+"&total="+e["info"]["total"]+"&allowZero="+e["info"]["allowZero"],e["info"]["type"]);else return!0},t.extend(t.Stepper,t.Container,["clone","dispose"],"zimContainer",!1),t.Slider=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u){var o="min, max, step, button, barLength, barWidth, barColor, vertical, useTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, inside, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, damp, currentValue, expand, expandVertical, expandBar, expandBarVertical, useLabels, labelMargin, labelColor, style, group, inherit",S;if(S=st(t.Slider,arguments,o,this))return S;De("62"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Slider",this.group=d;var F=B===!1?{}:t.getStyle(this.type,this.group,u);if(n(e)&&(e=F.min!=null?F.min:0),n(r)&&(r=F.max!=null?F.max:10),r-e==0){tt("ZIM Slider range must not be 0");return}n(y)&&(y=F.sound!=null?F.sound:!1),n(i)&&(i=F.step!=null?F.step:0),n(l)&&(l=F.button!=null?F.button:y?"aztec":null),l&&l.type=="Button"&&(l=l.clone()),n(a)&&(a=F.barLength!=null?F.barLength:300),n(s)&&(s=F.barWidth!=null?F.barWidth:3),n(f)&&(f=F.barColor!=null?F.barColor:y?t.lighter:t.granite),n(c)&&(c=F.vertical!=null?F.vertical:!!y),n(x)&&(x=F.useTicks!=null?F.useTicks:!!y),n(v)&&(v=F.tickStep!=null?F.tickStep:i||(x||y?(r-e)/40:0)),n(g)&&(g=F.semiTicks!=null?F.semiTicks:v?3:0),n(k)&&(k=F.tickColor!=null?F.tickColor:y?t.tin:f),n(b)&&(b=F.tickScale!=null?F.tickScale:y?1.25:1),n(E)&&(E=F.semiTickScale!=null?F.semiTickScale:1),n(A)&&(A=F.accentSize!=null?F.accentSize:y?10:0),n(T)&&(T=F.accentOffset!=null?F.accentOffset:y?-(A+s)/2:0),n(h)&&(h=F.accentColor!=null?F.accentColor:t.pink),n(w)&&(w=F.accentBackgroundColor!=null?F.accentBackgroundColor:y?t.blue:t.clear),n(P)&&(P=F.accentDifference!=null?F.accentDifference:-.5),n(C)&&(C=F.inside!=null?F.inside:!1),n(O)&&(O=F.keyArrows!=null?F.keyArrows:!0),n(Y)&&(Y=F.keyArrowsH!=null?F.keyArrowsH:!0),n(m)&&(m=F.keyArrowsV!=null?F.keyArrowsV:!0),n(_)&&(_=F.keyArrowsStep!=null?F.keyArrowsStep:(r-e)/100),n($)&&($=F.damp!=null?F.damp:!1),n(I)&&(I=F.currentValue!=null?F.currentValue:!1),n(X)&&(X=F.expand!=null?F.expand:t.mobile()?10:null),n(R)&&(R=F.expandVertical!=null?F.expandVertical:X),n(q)&&(q=F.expandBar!=null?F.expandBar:null),n(J)&&(J=F.expandBarVertical!=null?F.expandBarVertical:X),n(Z)&&(Z=F.useLabels!=null?F.useLabels:!1),n(ne)&&(ne=F.labelMargin!=null?F.labelMargin:20),n(U)&&(U=F.labelColor!=null?F.labelColor:t.dark);var p,L=this,we=D(e,r,i,I);this.veeObj={min:we[0],max:we[1],step:we[2],currentValue:we[3]};function D(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i);var N=i;I=t.Pick.choose(I);var ue;A&&(L.accentBacking=new t.Rectangle(a-.25,A+P,w).addTo(this).rot(c?90:0).mov(c?-T-s/2+P/2:.25,c?0:T+s/2-P/2),ue=L.accent=new t.Rectangle(a,A,h).sca(0,1).rot(c?-90:0).mov(c?-T-A-s/2:0,c?a:T+s/2).addTo(this));function fe(){ue.sca((L.currentValue-L.min)/Math.abs(L.max-L.min),1)}var V=!(!n(F.backing)&&F.backing.type!="Pattern");function z(Ne,Ue,rt){var me=new t.Shape(Ue,rt);return me.f(Ne).s(F.borderColor!=null?F.borderColor:t.tin).ss(F.borderWidth!=null?F.borderWidth:3).mt(2,0).lt(Ue+2,rt*.2).lt(Ue+2,rt*.8).lt(2,rt).cp().centerReg({add:!1}),me}if(n(l)||typeof l=="string"){var se=30,Oe=40;c&&(se=50,Oe=40);var K;if(l=="pill"||l=="aztec"||l=="circle"||l=="grip"){if(l=="pill")K={width:c?40:18,height:c?18:40,borderColor:t.tin,borderWidth:3,corner:8};else if(l=="aztec"){se=F.width!=null?F.width:Math.max(se,Oe)*.9,Oe=F.height!=null?F.height:Math.min(se,Oe)*.6;var ge=z(F.backgroundColor!=null?F.backgroundColor:t.lighter,se,Oe).rot(c?0:-90),Q=z(F.rollBackgroundColor!=null?F.rollBackgroundColor:t.white,se,Oe).rot(c?0:-90);K={width:se,height:Oe,backing:ge,rollBacking:Q},F.borderWidth=0,F.borderColor=0}else l=="circle"&&(se=F.width!=null?F.width:30,Oe=F.height!=null?F.height:30,K={width:se,height:se,corner:F.corner!=null?F.corner:se/2});L.buttonType=l}var ce=F.borderColor!=null?F.borderColor:K?K.borderColor:V?t.granite:null;if(l=new t.Button({width:F.width!=null?F.width:K?K.width:se,height:F.height!=null?F.height:K?K.height:Oe,label:"",backgroundColor:F.backgroundColor!=null?F.backgroundColor:t.white,rollBackgroundColor:F.rollBackgroundColor!=null?F.rollBackgroundColor:n(F.backgroundColor)||F.backgroundColor==t.white?t.moon:F.backgroundColor.lighten(.2),borderColor:ce,rollBorderColor:F.rollBorderColor!=null?F.rollBorderColor:ce,borderWidth:F.borderWidth!=null?F.borderWidth:K?K.borderWidth:V?1:null,corner:F.corner!=null?F.corner:K?K.corner:0,backing:F.backing!=null?F.backing.clone():K?K.backing:null,rollBacking:F.rollBacking!=null?F.rollBacking.clone():K?K.rollBacking:null,shadowColor:F.shadowColor!=null?F.shadowColor:null,shadowBlur:F.shadowBlur!=null?F.shadowBlur:null,hitPadding:30,style:!1}),L.buttonType=="circle")l.scaleY=Oe/se,c||l.rot(-90);else if(L.buttonType=="grip"){var G=[1,1,1],le=.4;t.loop(G,function(Ne,Ue,rt){c?new t.Line(l.width*.62,Ne,l.borderColor?l.borderColor:t.grey).pos(0,l.height*le/2+(Ue+1)*(l.height*(1-le))/(rt+1),t.CENTER,t.TOP,l):new t.Line(l.height*.62,Ne,l.borderColor?l.borderColor:t.grey).rot(90).pos(l.width*le/2+(Ue+1)*(l.width*(1-le))/(rt+1),0,t.LEFT,t.CENTER,l)})}}l.rollPersist=!0,(!n(X)||!n(R))&&l.expand(X,R);var Ae,re;c?(Ae=l.width,C?(re=a,this.setBounds(0,0,Ae,re)):(re=a+l.height,this.setBounds(-l.width/2,-l.height/2,Ae,re))):(re=Math.max(l.height,s),C?(Ae=a,this.setBounds(0,0,Ae,re)):(Ae=a+l.width,this.setBounds(-l.width/2,-l.height/2,Ae,re)));var xe=e,ke=0;this.button=l,this.cur("pointer");var te,pe,he,ae,Ee;if(x){ae=this.ticks=new t.Shape({style:!1}),this.addChild(ae),Ee=ae.graphics,Ee.ss(1).s(k);var ie=Math.round((r-e)/(v||i)),Se=(r-e)/ie;v?(Se!=v&&pt&&tt("Slider() - non-divisible step ("+v+") adjusted to "+Se),v=Se):(Se!=i&&pt&&tt("Slider() - non-divisible step ("+i+") adjusted to "+Se),i=Se);var Le;C?Le=(a-(c?l.height:l.width))/Math.abs(ie):Le=a/Math.abs(ie)}var Ce,ee,Me,_e,Ye,je,it;if(c){if(Ce=C?l.height/2:0,te=this.bar=new t.Rectangle(s,a,f,null,null,null,null,null,null,!1),q?te.expand(q,J):te.expand(20,0),te.centerReg(this),l.centerReg(this),he=te.getBounds(),pe=new Ge.Rectangle(te.x,he.y+Ce,0,he.height-Ce*2),x){for(Z&&(ee=L.labels=new t.Container().addTo(L)),Me=0;Me<=Math.abs(ie);Me++)_e=Me%(g+1)==0,Ye=_e?25*b:15*E,je=Ce+Le*Me,Ee.mt(0,je).lt(Ye,je),Z&&(g&&_e||!g)&&(it=Math.max(t.countDecimals(N),t.countDecimals(e),t.countDecimals(r)),new t.Label({text:t.decimals(r-(r-e)/Math.abs(ie)*Me,it+1),size:F.size?F.size:10,color:U,align:"left",valign:"center"}).centerReg({add:!1}).reg(0).loc(Ye+ne+2,je-1,ee));ae.x=te.x+15}}else if(Ce=C?l.width/2:0,te=this.bar=new t.Rectangle(a,s,f,null,null,null,null,null,null,!1),q?te.expand(q,J):te.expand(0,20),te.centerReg(this),l.centerReg(this),he=te.getBounds(),pe=new Ge.Rectangle(he.x+Ce,te.y,he.width-Ce*2,0),x){for(Z&&(ee=L.labels=new t.Container().addTo(L)),Me=0;Me<=Math.abs(ie);Me++)_e=Me%(g+1)==0,Ye=Ce+Le*Me,je=-(_e?25*b:15*E),Ee.mt(Ye,0).lt(Ye,je),Z&&(g&&_e||!g)&&(it=Math.max(t.countDecimals(N),t.countDecimals(e),t.countDecimals(r)),new t.Label({text:t.decimals(e+(r-e)/Math.abs(ie)*Me,it+1),size:F.size?F.size:10,color:U,align:"center",valign:"center"}).centerReg({add:!1}).loc(Ye,je-ne,ee));ae.y=te.y-10}l.x=pe.x,l.y=pe.y;function Be(Ne){return i==0?Ne:Math.round(Ne/i)*i}var qe,et;l.on("mousedown",function(Ne){p=Ne.target.stage,L.focus=!0;var Ue=L.globalToLocal(Ne.stageX/t.scaX,Ne.stageY/t.scaY);qe=Ue.x-l.x,et=Ue.y-l.y,p&&(p.mouseMoveOutside=!0)}),l.on("pressmove",function(Ne){ve(Ne)});function ve(Ne){var Ue=L.globalToLocal(Ne.stageX/t.scaX,Ne.stageY/t.scaY),rt=Fe(Ue.x-qe,Ue.y-et,pe);c?(l.x=rt.x,xe=Be((rt.y-pe.y)/pe.height*(e-r)),l.y=pe.y+xe*pe.height/(e-r),xe+=r,l.y!=ke&&L.dispatchEvent("change"),ke=l.y):(xe=Be((rt.x-pe.x)/pe.width*(r-e)),l.x=pe.x+xe*pe.width/(r-e),xe+=e,l.y=rt.y,l.x!=ke&&L.dispatchEvent("change"),ke=l.x),ue&&fe(),oe(),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&L.stage&&L.stage.update()}function Pe(Ne){return Ne>0?1:-1}function oe(){L.zimAccessibility&&L.zimAccessibility.changeTitle(L,null,!0)}function Fe(Ne,Ue,rt){return Ne=Math.max(rt.x,Math.min(rt.x+rt.width,Ne)),Ue=Math.max(rt.y,Math.min(rt.y+rt.height,Ue)),{x:Ne,y:Ue}}te.on("mousedown",function(Ne){p=Ne.target.stage,qe=0,et=0,!(L.zimAccessibility&&L.zimAccessibility.aria)&&ve(Ne)});var Ze,Xe;$&&(Ze=e,Xe=new t.Damp(Ze,$),L.ticker=t.Ticker.add(function(){Ze=Xe.convert(xe)})),Object.defineProperty(this,"currentValue",{get:function(){return $?Ze:xe},set:function(Ne){n(Ne)||(e<r?(Ne<e&&(Ne=e),Ne>r&&(Ne=r)):(Ne>e&&(Ne=e),Ne<r&&(Ne=r)),xe=Ne=Be(Ne),Xe&&Xe.immediate(xe),c?(l.y=(Ne-r)/(e-r)*pe.height+Ce,ke=l.y):(l.x=(Ne-e)/(r-e)*pe.width+Ce,ke=l.x),ue&&fe(),oe(),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&L.stage&&L.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return $?Ze:xe},set:function(Ne){Ne!=L.currentValue&&(L.currentValue=Ne,L.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return e},set:function(){pt&&tt("Slider() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(){pt&&tt("Slider() - max is read only")}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){pt&&tt("Slider() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return Y},set:function(Ne){Y=Ne}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return m},set:function(Ne){m=Ne}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==L},set:function(){t.KEYFOCUS=L}}),O&&!t.KEYFOCUS&&We(),this.on("mousedown",function(){O&&We()});function We(){L.keyFocus=!0;var Ne=document.activeElement;Ne&&Ne.blur()}var de=!1,Ve=!1,be=!1,Te=!1;this.keyDownEvent=function(Ne){L.stage&&(L.zimAccessibility&&L.focus||!L.zimAccessibility&&L.keyFocus)&&(Ne.keyCode==37&&Y?de=!0:Ne.keyCode==40&&m?Ve=!0:Ne.keyCode==39&&Y?be=!0:Ne.keyCode==38&&m&&(Te=!0),L.keyInterval==null&&(de||Ve||be||Te)&&(Re(),L.keyTimeout=setTimeout(function(){L.keyInterval==null&&(de||Ve||be||Te)&&(L.keyInterval=setInterval(Re,40))},140)))};function Re(){(de||Ve)&&(i>0?L.currentValueEvent-=i*Pe(r-e):L.currentValueEvent-=_*Pe(r-e)),(be||Te)&&(i>0?L.currentValueEvent+=i*Pe(r-e):L.currentValueEvent+=_*Pe(r-e))}j.addEventListener("keydown",this.keyDownEvent),L.keyUpEvent=function(Ne){Ne.keyCode==37?de=!1:Ne.keyCode==40?Ve=!1:Ne.keyCode==39?be=!1:Ne.keyCode==38&&(Te=!1),L.keyInterval!=null&&!de&&!Ve&&!be&&!Te&&(clearInterval(L.keyInterval),L.keyInterval=null)},j.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(L,"enabled",{get:function(){return L._enabled},set:function(Ne){St(L,Ne),Ne?(j.addEventListener("keydown",L.keyDownEvent),j.addEventListener("keyup",L.keyUpEvent)):(j.removeEventListener("keydown",L.keyDownEvent),j.removeEventListener("keyup",L.keyUpEvent))}}),n(I)||(L.currentValue=I),t.setSwipe(this,!1),B!==!1&&t.styleTransforms(this,F),this.clone=function(Ne){return L.cloneProps(new t.Slider(Ne||!t.isPick(we[0])?L.min:we[0],Ne||!t.isPick(we[1])?L.max:we[1],Ne||!t.isPick(we[2])?L.step:we[2],l.clone(),a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,Ne||!t.isPick(we[3])?L.currentValue:we[3],X,R,q,J,Z,ne,U,B,this.group,u))},this.dispose=function(Ne,Ue,rt){return j.removeEventListener("keydown",L.keyDownEvent),j.removeEventListener("keyup",L.keyUpEvent),rt||this.zimContainer_dispose(!0),!0}},t.extend(t.Slider,t.Container,["clone","dispose"],"zimContainer",!1),t.Selector=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y){var C="tile, borderColor, borderWidth, backgroundColor, corner, dashed, paddingH, paddingV, speed, diagonal, dim, multi, keyArrows, behind, resizeScale, selectedIndex, liveIndex, style, group, inherit",O;if(O=st(t.Selector,arguments,C,this))return O;De("62.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Selector",this.group=P;var _=w===!1?{}:t.getStyle(this.type,this.group,y),Y=Tt();n(e)&&(e=_.tile!=null?_.tile:new t.Tile(new t.Circle(20,t.red),4,4,10,10)),n(r)&&(r=_.borderColor!=null?_.borderColor:t.white),n(i)&&(i=_.borderWidth!=null?_.borderWidth:2),n(l)&&(l=_.backgroundColor!=null?_.backgroundColor:"rgba(0,0,0,.1)"),n(a)&&(a=_.corner!=null?_.corner:10),n(s)&&(s=_.dashed!=null?_.dashed:!1),n(f)&&(f=_.padding!=null?_.padding:e.spacingH/2),n(c)&&(c=_.paddingV!=null?_.paddingV:e.spacingV/2),n(x)&&(x=_.speed!=null?_.speed:2),n(k)&&(k=_.diagonal!=null?_.diagonal:!1),n(v)&&(v=_.dim!=null?_.dim:!1),n(g)&&(g=_.multi!=null?_.multi:!1),g&&(x=0),n(b)&&(b=_.keyArrows!=null?_.keyArrows:!0),n(E)&&(E=_.behind!=null?_.behind:!1),n(A)&&(A=_.resizeScale!=null?_.resizeScale:!1),n(T)&&(T=_.selectedIndex!=null?_.selectedIndex:null),n(h)&&(h=_.liveIndex!=null?_.liveIndex:!1),this.liveIndex=h;var m=[],$=[];t.loop(e.items.length,function(){m.push(nt(r)),$.push(nt(l))});var I=this;if(!(n(T)&&g)){var X=T,R=n(T)||T<0?0:T,q=e.getChildAt(R);I.currentItem=e.getChildAt(R),T=X,n(T)&&(T=_.selectedIndex!=null?_.selectedIndex:0)}var J,Z,ne;J=q||e.getChildAt(0),J&&(Z=J.width+f*2,ne=J.height+c*2),I.tile=e.addTo(I).cur();var U;if(g){var B=this.selectors=[];t.loop(10,function(){U=new t.Rectangle(Z,ne,t.faint,t.faint,i,a,s,{ignoreScale:!A}).centerReg(I,E?0:1),U.visible=!1,B.push(U),U.mouseEnabled=!1}),this.selector=U}else U=this.selector=new t.Rectangle(Z,ne,t.faint,t.faint,i,a,s,{ignoreScale:!A}).centerReg(I),U.loc(e.width/2,J.y+c,I,E?0:1),U.visible=!1;T<0||n(q)||(U.loc(J.x+f,J.y+c,I,E?0:1),U.color=$[T],U.borderColor=m[T],U.visible=!0),e.mov(f,c),this.setBounds(e.width+f*2,e.height+c*2);var d={};this.tileDown=e.on("mousedown",function(S){var F=U;if(!(g&&(F=B.shift(),n(F)))){F.visible=!0;for(var p=S.target,L=0;p.parent!=e&&L<10;)p=p.parent,L++;if(p.parent==e&&u(p,null,F),g){var we="id"+Math.abs(S.pointerID+1);d[we]={index:T,item:q,selector:F}}}}),g&&(this.tileMove=e.on("pressmove",function(S){var F="id"+Math.abs(S.pointerID+1),p=d[F];if(!n(p)){var L=e.itemUnderPoint(S.stageX/t.scaX,S.stageY/t.scaY);if(p.item!=L){if(I.upItem=p.item,I.upIndex=p.index,I.downItem=p.item=L,I.downIndex=p.index=L?L.tileNum:null,I.dispatchEvent("change"),n(L))p.selector.visible=!1;else{var we=e.localToLocal(L.x,L.y,I);p.selector.loc(we.x,we.y).siz(L.width+f*2,L.height+c*2),p.selector.color=$[p.index],p.selector.borderColor=m[p.index],p.selector.visible=!0}I.stage.update()}}}),this.tileUp=e.on("pressup",function(S){var F="id"+Math.abs(S.pointerID+1),p=d[F];n(p)||(I.downIndex=I.downItem=null,I.upIndex=p.index,I.upItem=p.item,B.push(p.selector),p.selector.visible=!1,I.dispatchEvent("change"),I.stage&&!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&I.stage.update(),delete d[F])})),I.noAnimate=!1;function u(S,F,p,L){n(p)&&(p=U),q=S,T=S.tileNum,p.color=$[T],p.borderColor=m[T],g&&(I.upItem=I.upIndex=null,I.downItem=q,I.downIndex=T),I.animating=!0;var we=e.localToLocal(S.x,S.y,I),D=Math.abs(we.x-U.x),N=Math.abs(we.y-U.y),ue=I.noAnimate||F?0:x;if(I.noAnimate=!1,ue==0)p.loc(we.x,we.y).siz(S.width+f*2,S.height+c*2),I.animating=!1,I.dispatchEvent("change");else{if(k||(D+N)*ue<=0?p.animate({x:we.x,y:we.y},(N+D)*ue):(p.stopAnimate(),D>=N?p.animate([{props:{x:we.x},time:Math.max(Y=="s"?.1:100,D*ue/(Y=="s"?1e3:1))},{props:{y:we.y},time:Math.max(Y=="s"?.1:100,N*ue/(Y=="s"?1e3:1))}]):p.animate([{props:{y:we.y},time:Math.max(Y=="s"?.1:100,N*ue/(Y=="s"?1e3:1))},{props:{x:we.x},time:Math.max(Y=="s"?.1:100,D*ue/(Y=="s"?1e3:1))}])),p.animate({props:{widthOnly:S.width+f*2,heightOnly:S.height+c*2},time:Math.max(Y=="s"?.2:200,(N+D)*ue/(Y=="s"?1e3:1)),events:I.liveIndex,call:function(){I.animating=!1,L?I.dispatchEvent("changeset"):I.dispatchEvent("change")}}),I.liveIndex){var fe=null;p.on("animation",function(){var z=p.parent.localToGlobal(p.x,p.y),se=e.itemUnderPoint(z.x,z.y);se.tileNum!=fe&&(T=se.tileNum,L?I.dispatchEvent("changeset"):I.dispatchEvent("change"),fe=se.tileNum)})}if(v){if(v===!0)var V=.7;else V=t.constrain(v,0,1);e.animate({props:{alpha:V},rewind:!0,time:(N+D)*x*.7/(Y=="s"?1e3:1)})}}e.stage&&e.stage.update()}b&&I.added(function(){I.keyEvent=I.stage.frame.on("keydown",function(S){if(I.stage&&I.enabled&&!I.animating&&(I.zimAccessibility&&I.focus||!I.zimAccessibility&&I.keyFocus)){var F=t.loop(e.items2D,function(D,N){var ue=t.loop(D,function(fe,V){if(fe==q)return[V,N]});if(Array.isArray(ue))return ue});F===!0&&(F=[0,0]);var p=e.items2D[F[1]].length,L=e.items2D.length,we;S.keyCode=="39"?(we=(F[0]+1)%p,u(e.items2D[F[1]][we],we<F[0])):S.keyCode=="37"?(we=(F[0]-1+p)%p,u(e.items2D[F[1]][we],we>F[0])):S.keyCode=="38"?(we=(F[1]-1+L)%L,u(e.items2D[we][F[0]],we>F[1])):S.keyCode=="40"&&(we=(F[1]+1)%L,u(e.items2D[we][F[0]],we<F[1]))}})}),Object.defineProperty(this,"selectedIndex",{get:function(){return T},set:function(S){n(S)&&(I.currentItem=null),I.currentItem=e.items[Math.round(S)]}}),Object.defineProperty(this,"text",{get:function(){return q.text},set:function(){pt&&tt("Selector() - text is read only")}}),Object.defineProperty(this,"currentItem",{get:function(){return q},set:function(S){if(n(S)){q=null,T=null,U.visible=!1,I.selectedCol=null,I.selectedRow=null;return}U.visible=!0,I.lastItem=q,I.lastIndex=T,I.lastCol=I.selectedCol,I.lastRow=I.selectedRow,I.selectedCol=S.tileCol,I.selectedRow=S.tileRow,T=S.tileNum,q=S,u(q,null,null,!0)}}),this._enabled=!0,Object.defineProperty(I,"enabled",{get:function(){return I._enabled},set:function(S){S?I.mouse():I.noMouse(),I._enabled=S}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==I},set:function(){t.KEYFOCUS=I}}),t.KEYFOCUS||o(),this.on("mousedown",function(){o()});function o(){I.keyFocus=!0;var S=document.activeElement;S&&S.blur()}w!==!1&&t.styleTransforms(this,_),this.clone=function(S){if(S)for(var F=[],p=0;p<I.tile.items.length;p++)F.push(I.tile.items[p].clone(!0));return I.cloneProps(new t.Selector(S?t.series(F):e.clone?e.clone():e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,this.style,this.group))},this.dispose=function(S,F,p){I.keyEvent&&I.stage&&I.stage.frame.off("keydown",I.keyEvent),e.off(I.tileDown),e.dispose(),g&&(e.off(I.tileMove),e.off(I.tileUp)),p||this.zimContainer_dispose(!0)}},t.extend(t.Selector,t.Container,["clone","dispose"],"zimContainer",!1),t.Dial=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L){var we="min, max, step, width, backgroundColor, indicatorColor, indicatorScale, indicatorType, useTicks, innerTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, innerCircle, innerScale, innerColor, inner2Color, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, linear, gap, limit, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, continuous, continuousMin, continuousMax, damp, currentValue, useLabels, labelMargin, style, group, inherit",D;if(D=st(t.Dial,arguments,we,this))return D;De("63"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Dial",this.group=p;var N=F===!1?{}:t.getStyle(this.type,this.group,L);if(n(e)&&(e=N.min!=null?N.min:0),n(r)&&(r=N.max!=null?N.max:10),r-e==0){tt("ZIM Dial range must not be 0");return}n(m)&&(m=N.sound!=null?N.sound:!1),n(i)&&(i=N.step!=null?N.step:m?0:1),n(l)&&(l=N.width!=null?N.width:100),n(a)&&(a=N.backgroundColor!=null?N.backgroundColor:t.granite),n(s)&&(s=N.indicatorColor!=null?N.indicatorColor:m?t.white:t.licorice),n(f)&&(f=N.indicatorScale!=null?N.indicatorScale:1),n(c)&&(c=N.indicatorType!=null?N.indicatorType:m?"aztec":"arrow"),n(x)&&(x=N.useTicks!=null?N.useTicks:i!=0),n(k)&&(k=N.innerTicks!=null?N.innerTicks:!1),n(g)&&(g=N.tickStep!=null?N.tickStep:i||(x?.25:0)),n(b)&&(b=N.semiTicks!=null?N.semiTicks:m?3:0),n(v)&&(v=N.tickColor!=null?N.tickColor:m?t.tin:a),n(E)&&(E=N.tickScale!=null?N.tickScale:m?1.25:1),n(A)&&(A=N.semiTickScale!=null?N.semiTickScale:1.25),n(T)&&(T=N.innerCircle!=null?N.innerCircle:!0),n(w)&&(w=N.innerColor!=null?N.innerColor:m?t.pink:"rgba(0,0,0,.2)"),n(P)&&(P=N.inner2Color!=null?N.inner2Color:m?t.light:"rgba(0,0,0,.1)"),n(h)&&(h=N.innerScale!=null?N.innerScale:m?.4:.5),n(y)&&(y=N.accentSize!=null?N.accentSize:m?l/2*.15:0),n(C)&&(C=N.accentOffset!=null?N.accentOffset:l/2*.45),n(Y)&&(Y=N.accentDifference!=null?N.accentDifference:-.25),n(O)&&(O=N.accentColor!=null?N.accentColor:t.pink),n(_)&&(_=N.accentBackgroundColor!=null?N.accentBackgroundColor:m?t.blue:t.clear),n(I)&&(I=N.gap!=null?N.gap:m?.25:0),n($)&&($=N.linear!=null?N.linear:m),I&&($=!0,ne=!1),n(X)&&(X=N.limit!=null?N.limit:!0),n(R)&&(R=N.keyArrows!=null?N.keyArrows:!0),n(q)&&(q=N.keyArrowsStep!=null?N.keyArrowsStep:(r-e)/100),n(J)&&(J=N.keyArrowsH!=null?N.keyArrowsH:!0),n(Z)&&(Z=N.keyArrowsV!=null?N.keyArrowsV:!0),n(ne)&&(ne=N.continuous!=null?N.continuous:!1),ne&&(X=N.limit!=null?N.limit:!1),n(d)&&(d=N.damp!=null?N.damp:!1),n(u)&&(u=N.currentValue!=null?N.currentValue:!1),n(o)&&(o=N.useLabels!=null?N.useLabels:!1),n(S)&&(S=N.labelMargin!=null?N.labelMargin:10),X==!1&&(d=null);var ue=this;this.cur("pointer");var fe=V(e,r,i,u);this.veeObj={min:fe[0],max:fe[1],step:fe[2],currentValue:fe[3]};function V(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i);var z=i;u=t.Pick.choose(u);var se=l/2,Oe=l,K=e,ge=0,Q;if(y){var ce=l/2+C+y/2,G=360*I/2;ue.accentBacking=new t.Shape(-se,-se,se*2,se*2).addTo(this).s(_).ss(y+Y).a(0,0,ce,(G-90)*t.RAD,(360-G-90)*t.RAD),Q=ue.accent=new t.Shape(-se,-se,se*2,se*2).addTo(this)}function le(){Q.c().s(O).ss(y),$?Q.a(0,0,ce,(G-90)*t.RAD,(Le.rotation-G*2)*t.RAD):Q.a(0,0,ce,(G-90)*t.RAD,(Le.rotation-90)*t.RAD)}var Ae=this.backing=new t.Circle(se,a,null,null,null,null,null,null,!1);if(y?Ae.center(this):this.addChild(Ae),T){var re=this.inner=new t.Circle(se*h,w,null,null,null,null,null,null,!1);this.addChild(re);var xe=this.inner2=new t.Circle(se*(h-.1),P,null,null,null,null,null,null,!1);this.addChild(xe)}m&&(ue.rotation=180);var ke=Math.abs(r-e)/(g||i)+(I?1:0),te=i?Math.abs(r-e)/i:0;if(x){var pe=this.ticks=new t.Container({style:!1});if(this.addChild(pe),o)var he=ue.labels=new t.Container(l*2,Oe*2).centerReg(ue);for(var ae=0;ae<ke;ae++){var Ee=ae%(b+1)==0,ie=new t.Rectangle(1,se*(Ee?.2*E:.1*A),v,null,null,null,null,null,null,!1);if(ie.regY=se+(k?h-.05:ie.height+se*.1),ie.regX=.5,ie.rotation=(360-360*I)/(ke-(I?1:0))*ae+360*I/2,pe.addChild(ie),o&&(b&&Ee||!b)){var Se=Math.max(t.countDecimals(z),t.countDecimals(e),t.countDecimals(r));new t.Label({text:t.decimals(e+(r-e)/Math.abs(te)*ae,Se+1),size:N.size?N.size:10,align:"center",valign:"center"}).centerReg({add:!1}).loc(0,-S-1,ie).addTo(he)}}ue.expand(ie.height)}this.setBounds(-se,-se,l,l);var Le,Ce;if(c=="dot"||c=="circle")Le=this.indicator=new t.Container({style:!1}),Ce=this.indicatorShape=new t.Circle(se*.19,s,null,null,null,null,null,null,!1),Le.addChild(Ce),t.sca(Le,f),Le.regY=se-Le.getBounds().width*f/2-se*.07;else if(c=="line"||c=="rectangle")Le=this.indicator=new t.Container({style:!1}),Ce=this.indicatorShape=new t.Rectangle(se*.1,se*.3,s,null,null,null,null,null,null,null,null,!1),Le.addChild(Ce),t.sca(Le,f),Le.regY=se-Le.getBounds().width*f/2-se*.07,Le.regX=se*.05;else if(c=="aztec"){Le=this.indicator=new t.Container({style:!1});var ee=se*.05,Me=se*.1,_e=se*.42;Ce=this.indicatorShape=new t.Shape(-Me,0,Me*2,_e).f(s).mt(-ee,0).lt(ee,0).lt(Me,_e).lt(-Me,_e).cp(),Le.addChild(Ce),t.sca(Le,f),Le.regY=se-Le.getBounds().width*f/2-se*.04}else Le=this.indicator=new t.Container({style:!1}),Ce=this.indicatorShape=new t.Triangle(se*.4,se*.4,se*.4,s,null,null,null,null,null,null,null,!1),Le.addChild(Ce),t.sca(Le,f),Le.regY=se-Le.getBounds().height*f*(k?.85:.75),k&&(Ce.rotation=180);Le.regY/=f,this.addChild(Le);function Ye(Qe){return i==0?Qe:Math.round(Qe/i)*i}var je,it,Be,qe,et=0;if(ne)var ve=0,Pe=0,oe=0,Fe=!1,Ze=!1,Xe=!0;if($)this.on("mousedown",function(Qe){if(!(ue.zimAccessibility&&ue.zimAccessibility.aria)){var ct=je=Le.rotation,ot=ue.parent.globalToLocal(Qe.stageX/t.scaX,Qe.stageY/t.scaY);Be=ue.on("pressmove",function(dt){var $e=ue.parent.globalToLocal(dt.rawX/t.scaX,dt.rawY/t.scaY);Le.rotation=ct=je+(ot.y-$e.y)*100/(this.width||1),X&&(ct>360-360*I/2||ct<0+360*I/2)&&(ct=t.constrain(ct,360*I/2,360-360*I/2),ot=ue.parent.globalToLocal(dt.rawX/t.scaX,dt.rawY/t.scaY),je=ct),be(ct)}),qe=this.on("pressup",function(){ue.off("pressmove",Be),ue.off("pressup",qe)})}});else{var We=!0;this.on("mousedown",function(Qe){if(!(ue.zimAccessibility&&ue.zimAccessibility.aria)){je=Le.rotation;var ct=ue.parent.globalToLocal(Qe.stageX/t.scaX,Qe.stageY/t.scaY),ot=ct.x-ue.x,dt=ue.y-ct.y;it=Math.atan2(ot,dt)*180/Math.PI;var $e=new Date().getTime();Be=ue.on("pressmove",function(Mt){if(Fe){var Ct=ue.parent.globalToLocal(Mt.rawX/t.scaX,Mt.rawY/t.scaY),xt=Ct.x-ue.x,Bt=ue.y-Ct.y;it=Math.atan2(xt,Bt)*180/Math.PI,je=Le.rotation}Ct=ue.parent.globalToLocal(Mt.rawX/t.scaX,Mt.rawY/t.scaY),xt=Ct.x-ue.x,Bt=ue.y-Ct.y;var Rt=Math.atan2(xt,Bt)*180/Math.PI,Ht=je+Rt-it;Ht=(Ht+360*1e4)%360,X&&We&&(Ht-et>180&&ue.currentValue!=r?Ht=0:Ht-et<-180&&(Ht=359)),We=!0,be(Ht),et=Ht}),qe=this.on("pressup",function(Mt){ue.currentValue!=ue.min&&ue.currentValue!=ue.max&&(We=!1);var Ct=new Date().getTime()-$e;if(Ct<200){ct=ue.parent.globalToLocal(Mt.rawX/t.scaX,Mt.rawY/t.scaY),ot=ct.x-ue.x,dt=ue.y-ct.y;var xt=Math.atan2(ot,dt)*180/Math.PI-ue.rotation;be(xt)}je=Le.rotation,ue.off("pressmove",Be),ue.off("pressup",qe)})}})}function de(Qe){return Qe>0?1:-1}function Ve(){ue.zimAccessibility&&ue.zimAccessibility.changeTitle(ue,null,!0)}function be(Qe){if(ne){Ze&&(ve=Qe,Ze=!1),Qe>ve+180?oe-=360:Qe<ve-180&&(oe+=360),Pe=oe+Qe,Xe=!1;var ct=ue.currentValue;return ue.currentValue=Ye(Pe*(r-e)/360),ct!=ue.currentValue&&ue.dispatchEvent("change"),ve=Qe,Xe=!0,Q&&le(),!0}var ot;Qe<0&&(Qe+=360),Qe=Qe%360,i!=0?(Qe=Math.min(Qe,360),ot=Ye((Qe-360*I/2)/(360-360*I)*(r-e)),Le.rotation=360*I/2+ot*(360-360*I)/(r-e)):(Le.rotation=Qe,ot=(Qe-360*I/2)/(360-360*I)*(r-e)),ot!=ge&&(ge=ot,K=ot+e,Q&&le(),ue.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&ue.stage&&ue.stage.update()),Ve()}var Te,Re;d&&(Te=e,Re=new t.Damp(Te,d),ue.ticker=t.Ticker.add(function(){Te=Re.convert(K)})),Object.defineProperty(this,"currentValue",{get:function(){return d?Te:K},set:function(Qe){n(Qe)||(ne?(Fe=!1,!n(U)&&!n(B)?U<B?(Qe<U&&(Qe=U,Fe=!0),Qe>B&&(Qe=B,Fe=!0)):(Qe>U&&(Qe=U,Fe=!0),Qe<B&&(Qe=B,Fe=!0)):n(U)?n(B)||Qe>B&&(Qe=B,Fe=!0):Qe<U&&(Qe=U,Fe=!0),Xe&&(Ze=!0,oe=Math.floor(Qe/(r-e))*360)):e<r?(Qe<e&&(Qe=X?e:r),Qe>r&&(Qe=X?r:e)):(Qe>e&&(Qe=X?e:r),Qe<r&&(Qe=X?r:e)),K=Qe,Qe=Ye(Qe),d&&d.immediate(K),Le.rotation=I*360/2+(Qe-e)*(360-I*360)/(r-e),Le.rotation=(Le.rotation+360*1e4)%360,ge=Qe-e,et=Le.rotation,Q&&le(),Ve(),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&ue.stage&&ue.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return d?Te:K},set:function(Qe){Qe!=ue.currentValue&&(ue.currentValue=Qe,ue.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return e},set:function(Qe){ne?e=Qe:pt&&tt("Dial() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(Qe){ne?r=Qe:pt&&tt("Dial() - max is read only")}}),Object.defineProperty(this,"continuous",{get:function(){return ne},set:function(){pt&&tt("Dial() - continuous is read only")}}),Object.defineProperty(this,"continuousMin",{get:function(){return U},set:function(Qe){U=Qe,ue.currentValue<U&&(ue.currentValue=U)}}),Object.defineProperty(this,"continuousMax",{get:function(){return B},set:function(Qe){B=Qe,ue.currentValue>B&&(ue.currentValue=B)}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){pt&&tt("Dial() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return J},set:function(Qe){J=Qe}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return Z},set:function(Qe){Z=Qe}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==ue},set:function(){t.KEYFOCUS=ue}}),R&&!t.KEYFOCUS&&Ne(),this.on("mousedown",function(){R&&Ne()});function Ne(){ue.keyFocus=!0;var Qe=document.activeElement;Qe&&Qe.blur()}var Ue=!1,rt=!1,me=!1,He=!1;this.keyDownEvent=function(Qe){ue.stage&&(ue.zimAccessibility&&ue.focus||!ue.zimAccessibility&&ue.keyFocus)&&(Qe.keyCode==37&&J?Ue=!0:Qe.keyCode==40&&Z?rt=!0:Qe.keyCode==39&&J?me=!0:Qe.keyCode==38&&Z&&(He=!0),ue.keyInterval==null&&(Ue||rt||me||He)&&(at(),ue.keyTimeout=setTimeout(function(){ue.keyInterval==null&&(Ue||rt||me||He)&&(ue.keyInterval=setInterval(at,40))},140)))};function at(){(Ue||rt)&&(i>0?ue.currentValueEvent-=i*de(r-e):ue.currentValueEvent-=q*de(r-e)),(me||He)&&(i>0?ue.currentValueEvent+=i*de(r-e):ue.currentValueEvent+=q*de(r-e))}j.addEventListener("keydown",this.keyDownEvent),ue.keyUpEvent=function(Qe){Qe.keyCode==37?Ue=!1:Qe.keyCode==40?rt=!1:Qe.keyCode==39?me=!1:Qe.keyCode==38&&(He=!1),ue.keyInterval!=null&&!Ue&&!rt&&!me&&!He&&(clearInterval(ue.keyInterval),ue.keyInterval=null)},j.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(ue,"enabled",{get:function(){return ue._enabled},set:function(Qe){Qe?(j.addEventListener("keydown",ue.keyDownEvent),j.addEventListener("keyup",ue.keyUpEvent)):(j.removeEventListener("keydown",ue.keyDownEvent),j.removeEventListener("keyup",ue.keyUpEvent)),ue._enabled=Qe}}),n(u)&&(u=N.currentValue!=null?N.currentValue:e),ue.currentValue=u,F!==!1&&t.styleTransforms(this,N),this.clone=function(Qe){return ue.cloneProps(new t.Dial(Qe||!t.isPick(fe[0])?ue.min:fe[0],Qe||!t.isPick(fe[1])?ue.max:fe[1],Qe||!t.isPick(fe[2])?ue.step:fe[2],l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,Qe||!t.isPick(fe[3])?ue.currentValue:fe[3],o,S,F,this.group,L))},this.dispose=function(Qe,ct,ot){return j.removeEventListener("keydown",ue.keyDownEvent),j.removeEventListener("keyup",ue.keyUpEvent),ot||this.zimContainer_dispose(!0),!0}},t.extend(t.Dial,t.Container,["clone","dispose"],"zimContainer",!1),t.Tabs=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z){var se="width, height, tabs, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, vertical, spacing, currentEnabled, currentSelected, corner, base, keyEnabled, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, backdropColor, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, useTap, excludeCustomTap, selectedIndex, styleLabels, keyWrap, style, group, inherit",Oe;if(Oe=st(t.Tabs,arguments,se,this))return Oe;De("65");var K=fe===!1?{}:t.getStyle("Tabs",V,z);n(E)&&(E=K.vertical!=null?K.vertical:!1),n(e)&&(e=K.width!=null?K.width:null);var ge=!n(e);if(n(e)&&(e=E?60:240),n(r)&&(r=K.height!=null?K.height:E?240:60),this.zimContainer_constructor(null,null,null,null,!0),this.type="Tabs",this.group=V,(n(i)||i.length<=0)&&(i=K.tabs!=null?K.tabs:[1,2,3,4]),n(l)&&(l=K.backgroundColor!=null?K.backgroundColor:t.tin),n(a)&&(a=K.rollBackgroundColor!=null?K.rollBackgroundColor:t.grey),n(s)&&(s=K.downBackgroundColor!=null?K.downBackgroundColor:a),n(f)&&(f=K.selectedBackgroundColor!=null?K.selectedBackgroundColor:t.dark),n(c)&&(c=K.selectedRollBackgroundColor!=null?K.selectedRollBackgroundColor:a),n(x)&&(x=K.color!=null?K.color:t.white),n(k)&&(k=K.rollColor!=null?K.rollColor:x),n(v)&&(v=K.downColor!=null?K.downColor:k),n(g)&&(g=K.selectedColor!=null?K.selectedColor:x),n(b)&&(b=K.selectedRollColor!=null?K.selectedRollColor:k),n(_)&&(_=K.backing!=null?K.backing.clone():null),n(Y)&&(Y=K.rollBacking!=null?K.rollBacking.clone():null),n(U)&&(U=K.align!=null?K.align:"center"),n(B)&&(B=K.valign!=null?K.valign:"center"),n(d)&&(d=K.labelAlign!=null?K.labelAlign:U),n(u)&&(u=K.labelValign!=null?K.labelValign:B),n(p)&&(p=K.indent!=null?K.indent:10),n(o)&&(o=K.labelIndent!=null?K.labelIndent:p),n(S)&&(S=K.labelIndentH!=null?K.labelIndentH:o),n(F)&&(F=K.labelIndentV!=null?K.labelIndentV:o),n(T)&&(T=K.currentEnabled!=null?K.currentEnabled:!1),n(h)&&(h=K.currentSelected!=null?K.currentSelected:!0),h||(T=!0),n(A)&&(A=K.spacing!=null?K.spacing:1),n(w)&&(w=K.corner!=null?K.corner:0),n(C)&&(C=K.gradient!=null?K.gradient:null),n(O)&&(O=K.gloss!=null?K.gloss:null),n(P)&&(P=K.base!=null?K.base:w==0&&!Array.isArray(w)?"none":E?"left":"bottom"),n(y)&&(y=K.keyEnabled!=null?K.keyEnabled:!0),n(L)&&(L=K.useTap!=null?K.useTap:!1),n(we)&&(we=K.excludeCustomTap!=null?K.excludeCustomTap:!1),n(ne)&&(ne=K.backdropColor!=null?K.backdropColor:null),n(N)&&(N=K.styleLabels!=null?K.styleLabels:!1),n(ue)&&(ue=K.keyWrap!=null?K.keyWrap:!0),P!="none"&&w!=0&&!Array.isArray(w))switch(P){case"bottom":w=[w,w,0,0];break;case"left":w=[0,w,w,0];break;case"top":w=[0,0,w,w];break;case"right":w=[w,0,0,w];break}else Array.isArray(w)||(w=[w,w,w,w]);var Q=this;this.keyEnabled=y;var ce=0,G=[],le=[],Ae,re,xe=i.length,ke=(e-A*(xe-1))/xe,te=(r-A*(xe-1)-2)/xe;if(!n(ne)){var pe=this.backdrop=new t.Rectangle(e,r,ne,null,null,null,null,null,null,!1);this.addChild(pe)}var he=!1,ae;function Ee(Pe){for(var oe=0;oe<Pe.length;oe++){var Fe=Pe[oe];if(Fe.constructor==={}.constructor){ae&&ae!="TabObject"&&(he=!0),ae="TabObject",Fe.type="TabObject";continue}typeof Fe=="string"||typeof Fe=="number"||Fe.type=="Label"?(Pe[oe]={type:"TabObject",label:String(Fe!=null)||Fe.type=="Label"?Fe:"1"},ae&&ae!="TabObject"&&(he=!0),ae="TabObject"):(ae&&ae=="TabObject"&&(he=!0),ae="Other")}}Ee(i);for(var ie=0,Se,Le=0,Ce=0;Ce<i.length;Ce++)re=i[Ce],E?ge&&(re.width=re.width?re.width:e):(n(re.width)&&Le++,ie+=n(re.width)?ke:re.width);if(!E){if(ie>e-A*(xe-1))for(Ce=0;Ce<i.length;Ce++)re=i[Ce],re.width=(e-A*(xe-1))/ie*(n(re.width)?ke:re.width);else if(Math.round(ie)<Math.round(e-A*(xe-1))&&Le>0)for(Se=(xe*ke-(ie-Le*ke))/Le,Ce=0;Ce<i.length;Ce++)re=i[Ce],re.width=n(re.width)?Se:re.width}function ee(Pe,oe){for(Ce=0;Ce<Pe.length;Ce++)re=Pe[Ce],re!=""&&re.type=="TabObject"&&(n(re.label)&&(re.label=" "),(typeof re.label=="string"||typeof re.label=="number")&&(re.label=new t.Label({text:re.label,size:K.size!=null?K.size:E?te/2:r/2,font:K.font!=null?K.font:null,style:N,valign:u,inherit:oe})))}ee(i,N?K:null);var Me=0;for(Ce=0;Ce<i.length;Ce++)re=i[Ce],!re.width&&E&&re.label.width>Me&&(Me=re.label.width);var _e=0;function Ye(Pe,oe){var Fe=[],Ze=[];for(Ce=0;Ce<Pe.length;Ce++){if(re=Pe[Ce],re.type=="TabObject"){var Xe={color:n(re.color)?t.Pick.choose(x):re.color,rollColor:n(re.rollColor)?t.Pick.choose(k):re.rollColor,downColor:n(re.downColor)?t.Pick.choose(v):re.downColor,selectedColor:n(re.selectedColor)?t.Pick.choose(g):re.selectedColor,selectedRollColor:n(re.selectedRollColor)?t.Pick.choose(b):re.selectedRollColor,backgroundColor:n(re.backgroundColor)?t.Pick.choose(l):re.backgroundColor,rollBackgroundColor:n(re.rollBackgroundColor)?t.Pick.choose(a):re.rollBackgroundColor,downBackgroundColor:n(re.downBackgroundColor)?t.Pick.choose(s):re.downBackgroundColor,selectedBackgroundColor:n(re.selectedBackgroundColor)?t.Pick.choose(f):re.selectedBackgroundColor,selectedRollBackgroundColor:n(re.selectedRollBackgroundColor)?t.Pick.choose(c):re.selectedRollBackgroundColor,wait:n(re.wait)?t.Pick.choose(m):re.wait};if(oe)for(var We in oe)n(oe[We])||(Xe[We]=oe[We]);Ae=new t.Button({width:E?n(re.width)?ge?e:Me+te/2+w[0]/2:re.width:n(re.width)?ke:re.width,height:E?te:r,label:re.label,borderColor:K.borderColor!=null?K.borderColor:null,borderWidth:K.borderWidth!=null?K.borderWidth:null,backgroundColor:Xe.backgroundColor,rollBackgroundColor:Xe.rollBackgroundColor,downBackgroundColor:Xe.downBackgroundColor,downColor:Xe.downColor,corner:w,shadowColor:-1,gradient:C,gloss:O,backing:_?_.clone():null,rollBacking:Y?Y.clone():null,wait:Xe.wait,waitTime:n(re.waitTime)?$:re.waitTime,waitBackgroundColor:n(re.waitBackgroundColor)?I:re.waitBackgroundColor,rollWaitBackgroundColor:n(re.rollWaitBackgroundColor)?X:re.rollWaitBackgroundColor,waitColor:n(re.waitColor)?R:re.waitColor,rollWaitColor:n(re.rollWaitBackgroundColor)?q:re.rollWaitColor,waitModal:n(re.waitModal)?J:re.waitModal,waitEnabled:n(re.waitEnabled)?Z:re.waitEnabled,align:d,valign:u,indentH:S,indentV:F,inherit:t.copy(K)}),Ae.tabInfo=Xe,Ae.color=Ae.tabInfo.color,Ae.rollColor=Ae.tabInfo.rollColor,Ae.type="TabsButton",Ae.content=re,Ae.listIndentReady=!0}else{if(re.listIndentReady)Ae=re;else{Ae=new t.Container,Ae.type=re.type,Ae.content=re;for(var de=["text","backing","label","slider","stepper","checkBox","colorPicker","swatch","colorLabel"],Ve=0;Ve<de.length;Ve++)re[de[Ve]]&&(Ae[de[Ve]]=re[de[Ve]])}re.checkBox&&(Ae.checkBox=re.checkBox),n(Ae.tabInfo)&&(Ae.tabInfo={}),we&&(Ae.excludeTap=!0),Ae.tabInfo.color=n(re.color)?x:re.color,Ae.tabInfo.backgroundColor=n(re.backgroundColor)?l:re.backgroundColor,re.listIndentReady||(new t.Rectangle(Math.max(re.width,E?ge?e:Me+te/2+w[0]/2:re.width),Math.max(re.height,E?te:r),t.clear).addTo(Ae).expand(0).cur(),re.center(Ae).cur(),U=="center"||U=="middle"||re.pos(0,null,U=="right"),B=="center"||B=="middle"||re.pos(null,0,null,B=="bottom"),Ae.listIndentReady=!0)}Ae.width>_e&&(_e=Ae.width),L?Ae.tap(function(be){Be(be.currentTarget.znum),Q.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}):Ae.zimTabEvent=Ae.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(be){Be(be.currentTarget.znum),Q.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}),Ae.on("mousedown",function(be){Q.buttonDown=be.currentTarget}),Ae.on("pressup",function(be){Q.buttonDown=null;var Te=be.currentTarget.znum;L||t.ACTIONEVENT=="click"?setTimeout(function(){qe(Te)},50):qe(Te)}),Ze.push(re.label),Fe.push(Ae),Ae.index=Ce}return[Fe,Ze]}var je=Ye(i);le=je[0],G=je[1];function it(){var Pe=0,oe=0,Fe;for(Ce=0;Ce<le.length;Ce++)Fe=le[Ce],Fe.znum=Ce,Fe.selectedIndex=Ce,Fe.selectedIndex==ce&&h&&(Fe.backgroundColor=f,Fe.rollBackgroundColor=c,Fe.color=g),G[Ce]&&(G[Ce].znum=Ce),Q.addChild(Fe),(!E||ge)&&(Fe.x=(e-Fe.width)/2,Fe.y=(r-Fe.height)/2),E?(Fe.y=oe,oe=Fe.y+Fe.height+A,U=="left"?Fe.x=(Fe.type=="TabsButton"||Fe.type=="ListItem"?0:p)+(Fe.regX-(Fe.getBounds()?Fe.getBounds().x:0))*Fe.scaleX:U=="right"&&(Fe.x=(ge?e:_e)-Fe.width-(Fe.type=="TabsButton"||Fe.type=="ListItem"?0:p))):(Fe.x=Pe,Pe=Fe.x+Fe.width+A,B=="top"?Fe.y=(Fe.type=="TabsButton"&&!he?0:p)+(Fe.regY-(Fe.getBounds()?Fe.getBounds().y:0))*Fe.scaleY:B=="bottom"&&(Fe.y=r-Fe.height-(Fe.type=="TabsButton"&&!he?0:p))),Ce==ce&&!T?Fe.enabled=!1:Fe.enabled=!0;n(ne)||Q.removeChild(pe),Q._bounds=null;var Ze=Q.getBounds(),Xe=0,We=0;if(!Ze&&Ge.EaselJS.version[0]!=0?Q.setBounds():Ze&&(Xe=E&&Ze.width!=0&&ge?e:Ze.width,We=E&&Ze.height!=0?Ze.height:r,Q.setBounds(Xe,We)),n(ne)||(pe.widthOnly=Xe,pe.heightOnly=We,Q.addChildAt(pe,0)),E&&!ge)for(Ce=0;Ce<=le.length;Ce++)(U=="center"||U=="middle")&&(Fe.x=(Xe-Fe.width)/2)}it();function Be(Pe,oe){if(Pe!=ce){var Fe=le[ce];if(Fe&&h&&(Fe.tabInfo&&n(Fe.tabInfo.wait)&&(Fe.tabInfo.backgroundColor&&(Fe.backgroundColor=Fe.tabInfo.backgroundColor),Fe.tabInfo.rollBackgroundColor&&(Fe.rollBackgroundColor=Fe.tabInfo.rollBackgroundColor),Fe.tabInfo.color&&Fe.label&&(Fe.color=Fe.tabInfo.color),Fe.tabInfo.rollColor&&Fe.label&&(Fe.rollColor=Fe.tabInfo.rollColor)),T||(Fe.enabled=!0)),ce=Pe,Fe=le[ce],Fe){var Ze=Fe.tabInfo;Ze&&n(Fe.tabInfo.wait)&&h&&(Ze.selectedBackgroundColor&&(Fe.backgroundColor=!n(Ze.downBackgroundColor)&&!oe?Ze.downBackgroundColor:Ze.selectedBackgroundColor),Ze.selectedRollBackgroundColor&&(Fe.rollBackgroundColor=Ze.selectedRollBackgroundColor),Ze.selectedColor&&Fe.label&&(Fe.color=!n(Ze.downColor)&&!oe?Ze.downColor:Ze.selectedColor),Ze.selectedRollColor&&Fe.label&&(Fe.rollColor=Ze.selectedRollColor)),oe&&!T&&(Fe.enabled=!1)}}}function qe(Pe){var oe=le[Pe];if(oe&&h){var Fe=oe.tabInfo;Fe&&n(Fe.wait)&&(Fe.selectedBackgroundColor&&(oe.backgroundColor=Q.selected==oe?Fe.selectedBackgroundColor:Fe.backgroundColor),Fe.selectedColor&&oe.label&&(oe.color=Q.selected==oe?Fe.selectedColor:Fe.color)),T||(oe.enabled=!1)}}this.addAt=function(Pe,oe,Fe){n(oe)&&(oe=le.length),oe=t.constrain(oe,0,le.length),Array.isArray(Pe)||(Pe=[Pe]),Ee(Pe),ee(Pe,Fe);var Ze=Ye(Pe,Fe),Xe=Ze[0],We=Ze[1];oe<=ce&&(ce+=Xe.length);var de=[oe,0].concat(Xe);return Array.prototype.splice.apply(le,de),de=[oe,0].concat(We),Array.prototype.splice.apply(G,de),it(),Q},this.removeAt=function(Pe,oe){if(le.length==0)return Q;for(n(Pe)&&(Pe=1),n(oe)&&(oe=le.length-Pe),oe=t.constrain(oe,0,le.length-Pe),ce>=oe&&ce<=oe+Pe&&(ce=-1),ce>oe+Pe&&(ce-=Pe),Ce=oe;Ce<oe+Pe;Ce++)le[Ce].tabInfo&&(le[Ce].tabInfo.backgroundColor&&(le[Ce].backgroundColor=le[Ce].tabInfo.backgroundColor),le[Ce].tabInfo.color&&le[Ce].label&&(le[Ce].color=le[Ce].tabInfo.color)),L?le[Ce].noTap():le[Ce].off((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",le[Ce].zimTabEvent),le[Ce].removeFrom();return le.splice(oe,Pe),G.splice(oe,Pe),it(),Q},Q.keyEvent=function(Pe){if(!(!Q.keyEnabled||!Q.keyFocus||Q.zimAccessibility)&&Pe.keyCode==9){var oe=ce;Pe.shiftKey?Be(--oe<0?ue?i.length-1:0:oe):Be(++oe>i.length-1?ue?0:i.length-1:oe),Q.dispatchEvent("change"),Q.dispatchEvent("keychange"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update(),Pe.preventDefault()}},j.addEventListener("keydown",Q.keyEvent),Object.defineProperty(this,"selected",{get:function(){return le[ce]},set:function(){pt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"selectedIndex",{get:function(){return ce},set:function(Pe){Be(Pe,!0),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),this.last=function(){return this.selectedIndex=this.buttons.length-1,this},this.first=function(){return this.selectedIndex=0,this},Object.defineProperty(this,"tabs",{get:function(){return ce},set:function(Pe){Be(Math.min(Math.max(Pe,0),i.length-1)),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(this,"color",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.color:x},set:function(Pe){if(x=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.color=Pe),(oe!=ce||!h)&&(Q.buttons[oe].color=x);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"rollColor",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.rollColor:k},set:function(Pe){if(k=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.rollColor=Pe),Q.buttons[oe].rollColor=k,oe!=ce&&Q.buttons[oe].rolled&&(Q.buttons[oe].color=k);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"selectedColor",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.selectedColor:g},set:function(Pe){if(g=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.selectedColor=Pe),oe==ce&&h&&(Q.buttons[oe].color=g);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"selectedRollColor",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.selectedRollColor:b},set:function(Pe){if(b=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.selectedRollColor=Pe),oe==ce&&h&&Q.buttons[oe].rolled&&(Q.buttons[oe].color=b);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"backgroundColor",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.backgroundColor:l},set:function(Pe){if(l=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.backgroundColor=Pe),(oe!=ce||!h)&&(Q.buttons[oe].backgroundColor=l);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"rollBackgroundColor",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.rollBackgroundColor:a},set:function(Pe){if(a=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.rollBackgroundColor=Pe),Q.buttons[oe].rollBackgroundColor=a,oe!=ce&&Q.buttons[oe].rolled&&(Q.buttons[oe].backgroundColor=a);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"selectedBackgroundColor",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.selectedBackgroundColor:f},set:function(Pe){if(f=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.selectedBackgroundColor=Pe),oe==ce&&h&&(Q.buttons[oe].backgroundColor=f);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"selectedRollBackgroundColor",{get:function(){return Q.buttons[0].tabItems?Q.buttons[0].tabItems.selectedRollBackgroundColor:c},set:function(Pe){if(c=Pe,Q.buttons[0].tabInfo){for(var oe=0;oe<Q.buttons.length;oe++)Q.buttons[oe].tabInfo&&(Q.buttons[oe].tabInfo.selectedRollBackgroundColor=Pe),oe==ce&&h&&Q.buttons[oe].rolled&&(Q.buttons[oe].backgroundColor=c);!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&Q.stage&&Q.stage.update()}}}),Object.defineProperty(this,"label",{get:function(){return G[ce]},set:function(){pt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"text",{get:function(){return G[ce]!=null?G[ce].text:void 0},set:function(){pt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"buttons",{get:function(){return le},set:function(){pt&&tt("Tabs() - buttons is read only")}}),Object.defineProperty(this,"labels",{get:function(){return G},set:function(){pt&&tt("Tabs() - labels is read only")}}),this._enabled=!0,Object.defineProperty(Q,"enabled",{get:function(){return Q._enabled},set:function(Pe){St(Q,Pe)}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==Q},set:function(){t.KEYFOCUS=Q}}),y&&t.KEYFOCUS&&et(),this.on("mousedown",function(){y&&et()});function et(){Q.keyFocus=!0;var Pe=document.activeElement;Pe&&Pe.blur()}var ve=Q.getBounds();n(ve)||ve.width==0?Q.setBounds(0,0,e,r):Q.width=e,n(D)&&(D=K.selectedIndex!=null?K.selectedIndex:0),Q.selectedIndex=D,fe!==!1&&t.styleTransforms(this,K),this.clone=function(){for(var Pe=t.copy(i,!0),oe=0;oe<Pe.length;oe++)Pe[oe].label=Pe[oe].label.clone();return Q.cloneProps(new t.Tabs(e,r,Pe,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,this.group,z))},this.doDispose=function(Pe,oe,Fe){Q.keyEvent&&j.removeEventListener("keydown",Q.keyEvent),t.loop(Q.buttons,function(Ze){Ze.dispose()}),Q.keyEvent=null,Fe||this.zimContainer_dispose(!0),h=re=i=G=Ae=le=je=null}},t.extend(t.Tabs,t.Container,["clone","dispose"],"zimContainer",!1),t.Tabs.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.Pad=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B){var d="width, cols, rows, keys, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, spacing, currentEnabled, currentSelected, corner, labelColor, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, selectedIndex, style, group, inherit",u;if(u=st(t.Pad,arguments,d,this))return u;De("66"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pad",this.group=U;var o=ne===!1?{}:t.getStyle(this.type,this.group,B);n(e)&&(e=o.width!=null?o.width:150),n(r)&&(r=o.cols!=null?o.cols:3),n(i)&&(i=o.rows!=null?o.rows:r);var S;if(n(l))if(o.keys!=null)l=o.keys;else for(l=[],S=1;S<=i*r;S++)l.push(S);n(T)&&(T=o.currentEnabled!=null?o.currentEnabled:!0),n(A)&&(A=o.spacing!=null?o.spacing:1);var F=this,p;this.cols=r,this.rows=i;var L=e/r-A,we=[],D=0,N;for(this.labels=[],this.buttons=[],S=0;S<i;S++){for(var ue=[],fe=0;fe<r;fe++)ue.push(l[D]!=null?l[D]:""),D++;var V=o.corner!=null?o.corner:w;V&&!Array.isArray(V)&&(V=[V,V,V,V]),N=we[S]=new t.Tabs({width:e,height:L,tabs:ue,backgroundColor:o.backgroundColor!=null?o.backgroundColor:a,rollBackgroundColor:o.rollBackgroundColor!=null?o.rollBackgroundColor:s,downBackgroundColor:o.downBackgroundColor!=null?o.downBackgroundColor:f,selectedBackgroundColor:o.selectedBackgroundColor!=null?o.selectedBackgroundColor:c,color:o.color!=null?o.color:k,rollColor:o.rollColor!=null?o.rollColor:v,downColor:o.downColor!=null?o.downColor:g,selectedColor:o.selectedColor!=null?o.selectedColor:b,spacing:o.spacing!=null?o.spacing:A,currentEnabled:o.currentEnabled!=null?o.currentEnabled:T,currentSelected:o.currentSelected!=null?o.currentSelected:h,corner:V,backing:o.backing!=null?o.backing.clone():O,rollBacking:o.rollBacking!=null?o.rollBacking.clone():_,base:null,keyEnabled:!1,gradient:o.gradient!=null?o.gradient:y,gloss:o.gloss!=null?o.gloss:C,wait:o.wait!=null?o.wait:Y,waitTime:o.waitTime!=null?o.waitTime:m,waitBackgroundColor:o.waitBackgroundColor!=null?o.waitBackgroundColor:$,rollWaitBackgroundColor:o.rollWaitBackgroundColor!=null?o.rollWaitBackgroundColor:I,waitColor:o.waitColor!=null?o.waitColor:X,rollWaitColor:o.rollWaitColor!=null?o.rollWaitColor:R,waitModal:o.waitModal!=null?o.waitModal:q,waitEnabled:o.waitEnabled!=null?o.waitEnabled:J,group:U,style:!1}),this.labels=this.labels.concat(N.labels),this.buttons=this.buttons.concat(N.buttons),this.addChild(N),N.selectedIndex=-1,N.y=(L+A)*S,N.znum=S,N.on("change",z)}this.tabs=we;function z(se){var Oe=se.target;F.selected=Oe.selected,F.text=Oe.text,F.label=Oe.label;for(var K=Oe.selectedIndex,ge=0;ge<we.length;ge++)Oe!=we[ge]&&(we[ge].selectedIndex=-1);p=Oe.znum*r+K,F.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&F.stage&&F.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return p},set:function(se){p=se;for(var Oe=0;Oe<we.length;Oe++)we[Oe].selectedIndex=-1;var K=Math.floor(p/r);K>=0&&K<F.tabs.length&&(F.tabs[K].selectedIndex=p%r)}}),this._enabled=!0,Object.defineProperty(F,"enabled",{get:function(){return F._enabled},set:function(se){St(F,se)}}),n(Z)&&(Z=o.selectedIndex!=null?o.selectedIndex:0),F.selectedIndex=Z,ne!==!1&&t.styleTransforms(this,o),this.clone=function(){return F.cloneProps(new t.Pad(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,this.group,B))},this.dispose=function(se,Oe,K){t.loop(we,function(ge){ge.dispose()}),this.labels=this.buttons=this.tabs=null,N=we=F.rowTabs=null,K||this.zimContainer_dispose(!0)}},t.extend(t.Pad,t.Container,["clone","dispose"],"zimContainer",!1),t.NumPad=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_){var Y="advanced, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, numberCorner, close, closeColor, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",m;if(m=st(t.NumPad,arguments,Y,this))return m;De("57.7"),this.group=O;var $=C===!1?{}:t.getStyle("NumPad",this.group,_);n(e)&&(e=$.advanced!=null?$.advanced:!1);var I=400,X=e?620:530;n(r)&&(r=$.titleBar!=null?$.titleBar:"NUMPAD"),n(i)&&(i=$.titleBarColor!=null?$.titleBarColor:t.white),n(l)&&(l=$.titleBarBackgroundColor!=null?$.titleBarBackgroundColor:t.grey),n(a)&&(a=$.titleBarHeight!=null?$.titleBarHeight:40),n(s)&&(s=$.backgroundColor!=null?$.backgroundColor:t.darker),n(f)&&(f=$.borderColor!=null?$.borderColor:t.pewter),n(c)&&(c=$.borderWidth!=null?$.borderWidth:null),f<0||c<0?f=c=null:f!=null&&c==null&&(c=1),n(x)&&(x=$.corner!=null?$.corner:15),n(k)&&(k=$.numberCorner!=null?$.numberCorner:30),n(T)&&(T=$.align!=null?$.align:"left"),n(h)&&(h=$.shadowColor!=null?$.shadowColor:"rgba(0,0,0,.3)"),n(w)&&(w=$.shadowBlur!=null?$.shadowBlur:14),n(P)&&(P=$.draggable!=null?$.draggable:!0),n(y)&&(y=$.boundary!=null?$.boundary:null),n(v)&&(v=$.close!=null?$.close:!0),n(g)&&(g=$.closeColor!=null?$.closeColor:n(i)?t.grey:i),Array.isArray(x)||(x=[x,x,x,x]),n(b)&&(b=$.collapse!=null?$.collapse:!0),n(E)&&(E=$.collapseColor!=null?$.collapseColor:n(i)?t.grey:i),n(A)&&(A=$.collapsed!=null?$.collapsed:!1),this.zimPanel_constructor(I,X,null,r,i,l,a,s,f,c,x,v,g,null,null,null,b,E,A,T,h,w,P,y,C,O,_),this.type="NumPad";var R=this;function q(Z,ne){return n(ne)&&(ne=mist),{label:Z,backgroundColor:ne,rollBackgroundColor:white,color:darker,rollColor:darker}}var J=[q("C",t.red.darken(.1)),q(new t.Label({text:"\u2423",size:90,shiftV:-24}),t.yellow.darken(.1)),q(new t.Label({text:"/",size:48,bold:!0,shiftV:3})),q(new t.Label({text:"*",size:65,shiftV:18})),1,2,3,q(new t.Label({text:"-",size:60,shiftV:-3})),4,5,6,q(new t.Label({text:"+",size:55,shiftV:3})),7,8,9,q(new t.Label({text:"\u232B",size:M=="ios"?60:35}),t.red.darken(.1)),q(new t.Label({text:",",size:70,shiftV:-3})),q(new ti({text:".",size:70,shiftV:-3})),0,q(new t.Label({text:"\u23CE",size:M=="ios"?40:50,shiftV:5}),t.green.darken(.1))];e&&(J.splice(2,0,q("%",yellow.darken(.1))),J.splice(4,0,q(new t.Label({text:"^",size:47,shiftV:10}),yellow.darken(.1))),J.splice(4,0,q(")",yellow.darken(.1))),J.splice(4,0,q("(",yellow.darken(.1)))),R.pad=new t.Pad({width:380,cols:4,rows:e?6:5,keys:J,spacing:6,currentSelected:!1,backgroundColor:t.grey,rollBackgroundColor:t.tin,selectedBackgroundColor:t.grey,downBackgroundColor:t.green,corner:k}),R.pad.on("mousedown",function(){R.pad.text=="C"?R.key="clear":R.pad.text=="\u2423"?R.key="space":R.pad.text=="\u232B"?R.key="backspace":R.pad.text=="\u23CE"?R.key="enter":R.key=R.pad.text,R.dispatchEvent("pressed")}),R.add(R.pad,null,!0),C!==!1&&t.styleTransforms(this,$),this.clone=function(){return R.cloneProps(new t.NumPad(e,r?r.clone():"",i,l,a,s,f,c,x,k,v,g,b,E,R.collapsed,T,h,w,P,y,C,this.group,_))}},t.extend(t.NumPad,t.Panel,["clone"],"zimPanel",!1),t.DPad=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h){var w="axis, width, backgroundColor, borderWidth, borderColor, indicatorColor, indicatorPressColor, indicatorScale, indicatorRadius, innerCircle, innerScale, activeRadius, clamp, logo, style, group, inherit",P;if(P=st(t.DPad,arguments,w,this))return P;De("66.2"),this.zimContainer_constructor(null,null,null,null,!1),this.type="DPad",this.group=T;var y=A===!1?{}:t.getStyle(this.type,this.group,h);n(e)&&(e=y.axis!=null?y.axis:"all"),n(r)&&(r=y.width!=null?y.width:100),n(i)&&(i=y.backgroundColor!=null?y.backgroundColor:t.granite),n(a)&&(a=y.borderColor!=null?y.borderColor:null),n(l)&&(l=y.borderWidth!=null?y.borderWidth:null),a<0||l<0?a=l=null:a!=null&&l==null&&(l=1),n(s)&&(s=y.indicatorColor!=null?y.indicatorColor:t.moon),n(f)&&(f=y.indicatorPressColor!=null?y.indicatorPressColor:t.lighter),n(c)&&(c=y.indicatorScale!=null?y.indicatorScale:1),n(x)&&(x=y.indicatorRadius!=null?y.indicatorRadius:null),n(k)&&(k=y.innerCircle!=null?y.innerCircle:!0),n(v)&&(v=y.innerScale!=null?y.innerScale:.5),n(g)&&(g=y.activeRadius!=null?y.activeRadius:r),n(b)&&(b=y.clamp!=null?y.clamp:!0),n(E)&&(E=y.logo!=null?y.logo:!1);var C=this;this.axis=e,this.outer=new t.Circle(r/2,i,a,l).addTo(this);var O=this.inner=new t.Circle(r*v/2,"rgba(0,0,0,.2)").center(this);E&&(this.logo=new t.Label({text:"D",bold:!0}).center(O).mov(1,2).alp(.3));var _=new t.Container().addTo(this),Y=(r-l)*.2*c,m=8;e=="vertical"?m=2:e=="horizontal"?(m=2,_.rotation=90):e=="both"&&(m=4),t.loop(m,function(Z,ne){new t.Triangle(Y,Y,Y,s).addTo(_).reg(null,n(x)?(r-l)*.475:x).rot(Z*360/ne)});var $=0,I=0,X;C.dirX=0,C.dirY=0;var R,q=!0;this.on("mousedown",function(Z){R=Z,_.loop(function(ne){ne.color=f}),q?C.ticker=t.Ticker.add(function(){J()}):t.Ticker.add(C.ticker)}),this.on("pressmove",function(Z){R=Z}),this.on("pressup",function(){t.Ticker.remove(C.ticker),C.dirX=C.dirY=0,_.loop(function(Z){Z.color=s}),C.stage&&C.stage.update()});function J(){var Z=R;$=Z.stageX/t.scaX,I=Z.stageY/t.scaY,X=C.globalToLocal($,I),Z=new Ge.Event("change"),Z.dirX=((X.x+g)/(g*2)-.5)*2,Z.dirY=((X.y+g)/(g*2)-.5)*2,b&&(Z.dirX=t.constrain(Z.dirX,-1,1),Z.dirY=t.constrain(Z.dirY,-1,1)),C.dirX=Z.dirX,C.dirY=Z.dirY,C.dispatchEvent(Z)}this._enabled=!0,Object.defineProperty(C,"enabled",{get:function(){return C._enabled},set:function(Z){St(C,Z)}}),A!==!1&&t.styleTransforms(this,y),this.clone=function(){return C.cloneProps(new t.DPad(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,this.group,h))},this.dispose=function(Z,ne,U){return this.ticker&&t.Ticker.remove(this.ticker),U||this.zimContainer_dispose(!0),!0}},t.extend(t.DPad,t.Container,["clone","dispose"],"zimContainer",!1),t.Radial=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o){var S="labels, size, font, height, coreRadius, coreColor, startAngle, totalAngle, angles, flip, shiftRadial, icons, rollIcons, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, selectedIndex, style, group, inherit",F;if(F=st(t.Radial,arguments,S,this))return F;De("66.4"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Radial",this.group=u;var p=d===!1?{}:t.getStyle(this.type,this.group,o);n(e)&&(e=p.labels!=null?p.labels:["A","B","C","D","E"]),n(r)&&(r=p.size!=null?p.size:30),n(i)&&(i=p.font!=null?p.font:"verdana"),n(f)&&(f=p.startAngle!=null?p.startAngle:null),n(c)&&(c=p.totalAngle!=null?p.totalAngle:360),n(x)&&(x=p.angles!=null?p.angles:null),n(k)&&(k=p.flip!=null?p.flip:!0),n(v)&&(v=p.shiftRadial!=null?p.shiftRadial:0),n(g)&&(g=p.icons!=null?p.icons:null),n(b)&&(b=p.rollIcons!=null?p.rollIcons:null),n(E)&&(E=p.rotateIcons!=null?p.rotateIcons:!1),n(A)&&(A=p.iconsShiftRadial!=null?p.iconsShiftRadial:0),n(l)&&(l=p.height!=null?p.height:60),n(a)&&(a=p.coreRadius!=null?p.coreRadius:100),n(s)&&(s=p.coreColor!=null?p.coreColor:t.dark),n(y)&&(y=p.backdropColor!=null?p.backdropColor:t.clear),n(T)&&(T=p.backgroundColor!=null?p.backgroundColor:t.granite),n(h)&&(h=p.rollBackgroundColor!=null?p.rollBackgroundColor:t.tin),n(w)&&(w=p.selectedBackgroundColor!=null?p.selectedBackgroundColor:t.charcoal),n(P)&&(P=p.selectedRollBackgroundColor!=null?p.selectedRollBackgroundColor:w),n(C)&&(C=p.color!=null?p.color:t.white),n(O)&&(O=p.rollColor!=null?p.rollColor:C),n(_)&&(_=p.selectedColor!=null?p.selectedColor:C),n(Y)&&(Y=p.selectedRollColor!=null?p.selectedRollColor:O),n(m)&&(m=p.borderColor!=null?p.borderColor:t.dark),n($)&&($=p.borderWidth!=null?p.borderWidth:2),n(R)&&(R=p.gapAsAngle!=null?p.gapAsAngle:!1),n(X)&&(X=p.gap!=null?p.gap:R?3:6),n(I)&&(I=p.gradient!=null?p.gradient:null),I===!0&&(I=.1),n(q)&&(q=p.spacing!=null?p.spacing:6),n(J)&&(J=p.spacingInner!=null?p.spacingInner:q),n(Z)&&(Z=p.spacingOuter!=null?p.spacingOuter:q),n(ne)&&(ne=p.currentEnabled!=null?p.currentEnabled:!1),n(U)&&(U=p.currentSelected!=null?p.currentSelected:!0);var L=this,we=this.innerRadius=a+J,D=this.outerRadius=we+l;this.setBounds(-D,-D,D*2,D*2);var N=this.backdrop=new t.Circle(D+Z,y).center(this);if(a>0&&(this.core=new t.Circle(a,s).center(this)),x&&x.length<e.length-1)return pt&&tt("Radial() - not enough angles provided"),this;if(e&&e.length>0||g&&g.length>0){var ue;if(e&&e.length>0&&(ue=e.length),g&&g.length>0&&(ue>0?ue=Math.min(g.length,ue):ue=g.length),b&&b.length<ue)for(var fe=0;fe<ue-b.length;fe++)b.push(new t.Circle(1,t.clear));var V=N.width,z=this.buttons=new t.Container(-V/2,-V/2,V,V).centerReg(this),se=X;R||(X=X/D*180/Math.PI,se=se/we*180/Math.PI);for(var Oe=(c-X*ue+(c==360?0:X))/ue,K=f||0,ge=0;ge<ue;ge++){x&&(Oe=x[ge]);var Q=new t.Shape(-V/2,-V/2,V,V).centerReg(z);Q.num=ge,Q.zimSelected=!1,Q.angle=Oe;var ce=Q.graphics;Q.backgroundColor=t.Pick.choose(T),Q.rollBackgroundColor=t.Pick.choose(h),Q.selectedBackgroundColor=t.Pick.choose(w),Q.selectedRollBackgroundColor=t.Pick.choose(P),Q.color=t.Pick.choose(C),Q.rollColor=t.Pick.choose(O),Q.selectedColor=t.Pick.choose(_),Q.selectedRollColor=t.Pick.choose(Y),Q.colorCommand=ce.f(Q.backgroundColor).command,(n($)||$>0)&&(!n(m)||!n($))&&(n(m)&&(m=t.black),Q.borderColorCommand=ce.s(m).command,Q.borderWidthCommand=ce.ss($).command);var G=(K-90-Oe/2)*Math.PI/180,le=(K-90+Oe/2)*Math.PI/180,Ae=(K-90+(Oe+X-se)/2)*Math.PI/180,re=(K-90-(Oe+X-se)/2)*Math.PI/180;if(ce.arc(0,0,D,G,le,!1),ce.arc(0,0,we,Ae,re,!0).cp(),I&&(ce.s().ss().rf(["rgba(0,0,0,"+I+")","rgba(255,255,255,"+I+")"],[0,1],0,0,we,0,0,D),ce.arc(0,0,D,G,le,!1),ce.arc(0,0,we,Ae,re,!0).cp()),Q.cur("pointer"),Q.zimOverEvent=Q.on("mouseover",function(Ee){var ie=Ee.target;ie.colorCommand.style=ie==L.selected&&U?ie.selectedRollBackgroundColor:ie.rollBackgroundColor,ie.label&&(ie.label.color=ie==L.selected&&U?ie.selectedRollColor:ie.rollColor),b&&(ie.holder.removeAllChildren(),b[ie.num].loc(1,0,ie.holder)),L.stage&&L.stage.update()}),Q.zimOutEvent=Q.on("mouseout",function(Ee){var ie=Ee.target;ie.colorCommand.style=ie==L.selected&&U?ie.selectedBackgroundColor:ie.backgroundColor,ie.label&&(ie.label.color=ie==L.selected&&U?ie.selectedColor:ie.color),b&&(ie.holder.removeAllChildren(),g&&g[ie.num].loc(1,0,ie.holder)),L.stage&&L.stage.update()}),Q.zimDownEvent=Q.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Ee){var ie=Ee.target,Se=ie!==L.selected;L.lastSelected=L.selected,ae=ie.num,U?Se?(L.selected&&(L.selected.colorCommand.style=L.selected.backgroundColor,L.selected.label&&(L.selected.label.color=L.selected.color)),L.selected=ie,L.label=ie.label,L.label&&(L.text=L.label.text),L.icon=ie.icon,ie.colorCommand.style=ie.selectedRollBackgroundColor,ie.label&&(ie.label.color=ie.selectedRollColor)):ne||(ae=-1,L.selected=null,L.label=null,L.text=null,L.icon=null,ie.colorCommand.style=ie.rollBackgroundColor,ie.label&&(ie.label.color=ie.rollColor)):(L.selected=ie,L.label=ie.label,L.label&&(L.text=L.label.text),L.icon=ie.icon),L.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&L.stage&&L.stage.update()}),g&&g.length>0){var xe=we+l/2+A,ke=Q.holder=new t.Container(3,xe).addTo(this).reg(1,xe).rot(K);ke.mouseChildren=!1,ke.mouseEnabled=!1,Q.icon=g[ge],g[ge].loc(1,0,ke),E||(g[ge].rotation=-K)}if(e&&e.length>0){var te;if(e[ge].type!="LabelOnArc"){var pe=e[ge].type=="Label"?e[ge]:new t.Label({text:e[ge],size:r,font:i,color:C,style:d,inherit:o});te=new t.LabelOnArc({label:pe,color:C,size:r,spacing:-5,flip:k&&K>90&&K<270,radius:we+(l-pe.height)/2+2+v,style:d,inherit:o})}else te=e[ge];e[ge]=te,Q.label=te,te.center(this).rot(K),te.mouseChildren=!1,te.mouseEnabled=!1}if(ge!=e.length-1){var he=x?x[ge+1]:Oe;K+=(Oe+he)/2+X}}n(f)||(L.rotation+=L.buttons.getChildAt(0).angle/2)}var ae=null;Object.defineProperty(this,"selectedIndex",{get:function(){return ae},set:function(Ee){var ie;L.buttons&&(ie=L.buttons.getChildAt(Ee)),ie!==L.selected&&(L.selected&&(L.selected.colorCommand.style=L.selected.backgroundColor,L.selected.label&&(L.selected.label.color=L.selected.color)),L.selected=ie,ie&&(U&&(ie.colorCommand.style=ie.selectedRollBackgroundColor),ie.label&&(U&&(ie.label.color=ie.selectedColor),L.text=ie.label.text))),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&L.stage&&L.stage.update()}}),n(B)&&(B=p.selectedIndex!=null?p.selectedIndex:0),L.selectedIndex=B,d!==!1&&t.styleTransforms(this,p),this.clone=function(){return L.cloneProps(new t.Radial(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,this.group,o))}},t.extend(t.Radial,t.Container,"clone","zimContainer",!1),t.RadialMenu=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o){var S="menu, size, font, height, coreRadius, coreColor, title, titleIcon, startAngle, totalAngle, flip, shiftRadial, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, open, under, style, group, inherit",F=S.split(", "),p=!1;if(e&&e.constructor==={}.constructor){for(var L in e)if(F.indexOf(L)>=0){p=!0;break}}if(e&&p){var we;if(we=st(t.RadialMenu,arguments,S,this))return we}De("66.6"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadialMenu",this.group=u;var D=d===!1?{}:t.getStyle(this.type,this.group,o);n(e)&&(e=D.menu!=null?D.menu:{A:{A1:["AA1","AA2","AA3","AA4"],A2:[],A3:[]},B:["B1","B2","B3","B4","B5","B6"],C:[]}),n(r)&&(r=D.size!=null?D.size:30),n(i)&&(i=D.font!=null?D.font:"verdana"),n(x)&&(x=D.startAngle!=null?D.startAngle:null),n(k)&&(k=D.totalAngle!=null?D.totalAngle:360),n(v)&&(v=D.flip!=null?D.flip:!0),n(b)&&(b=D.rotateIcons!=null?D.rotateIcons:!1),n(g)&&(g=D.shiftRadial!=null?D.shiftRadial:0),n(E)&&(E=D.iconsShiftRadial!=null?D.iconsShiftRadial:0),n(l)&&(l=D.height!=null?D.height:60),n(a)&&(a=D.coreRadius!=null?D.coreRadius:100),n(s)&&(s=D.coreColor!=null?D.coreColor:t.dark),n(f)&&(f=D.title!=null?D.title:"MENU"),n(c)&&(c=D.titleIcon!=null?D.titleIcon:null),n(P)&&(P=D.backdropColor!=null?D.backdropColor:t.clear),n(A)&&(A=D.backgroundColor!=null?D.backgroundColor:t.granite),n(T)&&(T=D.rollBackgroundColor!=null?D.rollBackgroundColor:t.tin),n(h)&&(h=D.selectedBackgroundColor!=null?D.selectedBackgroundColor:t.charcoal),n(w)&&(w=D.selectedRollBackgroundColor!=null?D.selectedRollBackgroundColor:h),n(y)&&(y=D.color!=null?D.color:t.white),n(C)&&(C=D.rollColor!=null?D.rollColor:y),n(O)&&(O=D.selectedColor!=null?D.selectedColor:y),n(_)&&(_=D.selectedRollColor!=null?D.selectedRollColor:C),n(Y)&&(Y=D.borderColor!=null?D.borderColor:t.dark),n(m)&&(m=D.borderWidth!=null?D.borderWidth:2),n(X)&&(X=D.gapAsAngle!=null?D.gapAsAngle:!1),n(I)&&(I=D.gap!=null?D.gap:X?3:6),n(R)&&(R=D.spacing!=null?D.spacing:6),n($)&&($=D.gradient!=null?D.gradient:null),$===!0&&($=.1),n(q)&&(q=D.spacingInner!=null?D.spacingInner:R),n(J)&&(J=D.spacingOuter!=null?D.spacingOuter:R),n(Z)&&(Z=D.currentEnabled!=null?D.currentEnabled:!1),n(ne)&&(ne=D.currentSelected!=null?D.currentSelected:!0),n(U)&&(U=D.open!=null?D.open:!1),n(B)&&(B=D.under!=null?D.under:!0);var N=this,ue=(Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",fe=null,V=this.core=new t.Circle({radius:a,color:s,style:d,inherit:o}).addTo(this);c&&(this.titleIcon=c.center(V)),f&&(this.title=new t.Label({text:f,size:r,font:i,color:y,style:d,inherit:o}).center(V)),V.cur("pointer"),V.on(ue,function(){N.leafNode=!1,K.length==0?ge():(t.loop(K,function(ce){ce.selectedIndex=-1,ce.removeFrom(),K=[]}),N.outerLevel=0,N.selected=N.outerMenu=N.selectedMenu=N.text=null),(Z||N.selected!=fe)&&N.dispatchEvent("change"),fe=N.selected,N.stage&&N.stage.update()}),this.closeRings=function(ce){n(ce)&&(ce=N.outerLevel);var G=N.outerLevel-ce;t.loop(K,function(le,Ae){Ae>G-1&&(le.removeFrom(),le.selectedIndex=-1,K.pop())},!0),N.outerLevel=G,N.outerMenu=K[K.length-1],N.outerMenu&&(N.outerMenu.selectedIndex=-1),N.selected=N.selectedMenu=N.text=null,K[K.length-2]?(N.selectedMenu=K[K.length-2],N.selectedIndex=N.selectedMenu.selectedIndex):N.selectedIndex=-1,N.selected!=fe&&N.dispatchEvent("change"),fe=N.selected,N.stage&&N.stage.update()};var z={},se,Oe;N.outerLevel=0,e.constructor=={}.constructor&&(e={core:e},se=N.tree=new t.Hierarchy(e),Oe=se.getLinearIDs()),N.lastRadial=null;var K=this.radials=[];U&&ge();function ge(ce){var G,le;ce?G=ce.ringLevel:(G=0,le=a),t.loop(K,function(xe,ke){ke>G-1&&(xe.removeFrom(),xe.selectedIndex=-1,K.pop())},!0);var Ae;if(ce&&(Ae=ce.selected),Ae){var re=Ae.id;le=ce.outerRadius,Q(re,G+1,le)}else ce||Q("id0",G+1,le);N.selected=Ae,N.selected?(N.selectedMenu=K[N.selected.menu.ringLevel-1],N.selectedIndex=N.selected.num,N.selected.label?N.text=N.selected.label.text:N.text=null):Z&&ce?(N.selectedIndex=ce.selectedIndex,N.label=ce.label,N.text=ce.text,N.icon=ce.icon,N.selectedMenu=ce):(N.text=null,N.selectedIndex=-1,N.selectedMenu=null),N.stage&&N.stage.update()}function Q(ce,G,le){G&&(N.outerLevel=G);var Ae;if(!z[ce]){var re=se.getData(ce),xe=re.list;if(xe&&!t.isEmpty(xe)){var ke={labels:se.getLinearList(xe),coreRadius:le,size:r,font:i,startAngle:x,totalAngle:k,flip:v,rotateIcons:b,shiftRadial:g,iconsShiftRadial:E,height:l,coreColor:t.clear,backdropColor:P,backgroundColor:A,rollBackgroundColor:T,selectedBackgroundColor:h,selectedRollBackgroundColor:w,color:y,rollColor:C,selectedColor:O,selectedRollColor:_,borderColor:Y,borderWidth:m,gapAsAngle:X,gap:I,gradient:$,spacingInner:q,spacingOuter:J,currentSelected:ne,currentEnabled:Z,style:d,inherit:o};re.styles&&(ke=t.merge(ke,re.styles)),Ae=z[ce]=new t.Radial(ke),Oe=se.getLinearIDs(xe),Ae.buttons.loop(function(te,pe){te.menu=Ae,te.id=Oe[pe]}),Ae.ringLevel=N.outerLevel,Ae.selectedIndex=-1,Ae.on("change",function(te){N.leafNode=!1,ge(te.target),(Z||N.selected!=fe)&&N.dispatchEvent("change"),fe=N.selected})}}z[ce]?(K.push(z[ce]),z[ce].center(N),B&&z[ce].bot()):(N.leafNode=!0,N.outerLevel-=1),N.outerMenu=Ae}d!==!1&&t.styleTransforms(this,D),this.clone=function(){return N.cloneProps(new t.RadialMenu(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,this.group,o))}},t.extend(t.RadialMenu,t.Container,"clone","zimContainer",!1),t.ColorPicker=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R){var q="width, colors, cols, spacing, greyPicker, alphaPicker, startBackgroundColor, draggable, shadowColor, shadowBlur, buttonBar, circles, indicator, backgroundColor, keyArrows, container, selectedIndex, selectedColor, dropperTarget, spectrumCollapse, spectrumMode, spectrumClose, spectrumOk, spectrumTitle, tolerancePicker, collapsed, style, group, inherit",J;if(J=st(t.ColorPicker,arguments,q,this))return J;De("67"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ColorPicker",this.group=X;var Z=I===!1?{}:t.getStyle(this.type,this.group,R),ne;n(e)&&(e=Z.width!=null?Z.width:500),n(r)&&(r=Z.colors!=null?Z.colors:"spectrum"),r=="legacy"&&(ne=!0),n(i)&&(i=Z.cols!=null?Z.cols:10),n(l)&&(l=Z.spacing!=null?Z.spacing:2);var U=!ne&&r.length>0&&r.length<=i;r=="spectrum"&&(i=10,l=2,U=!1),n(s)&&(s=Z.alphaPicker!=null?Z.alphaPicker:!U),n(m)&&(m=Z.tolerancePicker!=null?Z.tolerancePicker:!1),m&&(s=!1),n(a)&&(a=Z.greyPicker!=null?Z.greyPicker:!U),n(x)&&(x=Z.shadowColor!=null?Z.shadowColor:"rgba(0,0,0,.3)"),n(k)&&(k=Z.shadowBlur!=null?Z.shadowBlur:14),n(v)&&(v=Z.buttonBar!=null?Z.buttonBar:!U),n(c)&&(v||r=="spectrum"?c=Z.draggable!=null?Z.draggable:!0:c=Z.draggable!=null?Z.draggable:!1),n(g)&&(g=Z.circles!=null?Z.circles:!1),n(b)&&(b=Z.indicator!=null?Z.indicator:!1,v||(b=Z.indicator!=null?Z.indicator:!0)),n(E)&&(E=Z.backgroundColor!=null?Z.backgroundColor:t.black),n(f)&&(f=Z.startBackgroundColor!=null?Z.startBackgroundColor:null),n(A)&&(A=Z.keyArrows!=null?Z.keyArrows:!0),n(P)&&(P=Z.dropperTarget!=null?Z.dropperTarget:!1),n(y)&&(y=Z.spectrumCollapse!=null?Z.spectrumCollapse:!0),n(C)&&(C=Z.spectrumMode!=null?Z.spectrumMode:!0),n(O)&&(O=Z.spectrumClose!=null?Z.spectrumClose:!0),n(_)&&(_=Z.spectrumOk!=null?Z.spectrumOk:!0),n(Y)&&(Y=Z.spectrumTitle!=null?Z.spectrumTitle:null),n($)&&($=Z.collapsed!=null?Z.collapsed:!1);var B=this;if(n(T))if(j.zdf)T=j.zdf.stage;else return;else if(T.getBounds){if(n(T.getStage))return}else return;B.container=T;var d="#e472c4",u="#50c4b7",o=1,S=1,F=new t.Shape;this.addChild(F),F.x+=l,F.y+=l,ne=!1;var p,L,we=[],D,N,ue,fe,V,z=r=="spectrum";if(n(r)||r=="legacy"||r=="spectrum"){ne=!0;var se=6,Oe=se*se*se;se=Math.ceil(Math.pow(Oe,1/2)),L=(e-l)/18-l,V=Math.floor(Math.pow(se*se,1/3)),p=[];for(var K=0;K<6;K++)for(var ge=0;ge<6;ge++)for(var Q=0;Q<6;Q++)p.push("#"+xe(K*3)+xe(ge*3)+xe(Q*3));for(r=[],K=0;K<p.length;K++)D=Math.floor(K/6),N=K%6,D>=6*3?V=1:V=0,ue=D-V*6*3,fe=N+V*6,r[fe*18+ue]=p[K];i=18,we=[u,d]}else L=(e-l)/i-l;var ce=Math.ceil(r.length/i),G=1,le=String(r[r.length-1]);if(!n(f)){var Ae=f.match(/rgba\((.*)\)/);Ae&&(D=Ae[1].split(","),G=D.pop(),f="rgb("+D.join(",")+")"),le=String(f)}var re;ne&&(re=u);function xe(yt){return yt=Math.floor(yt).toString(16),yt+""+yt}V=0;var ke=F.graphics,te,pe,he=Z.borderColor!=null?Z.borderColor:null,ae=Z.borderWidth!=null?Z.borderWidth:null;!n(he)&&n(ae)&&(ae=1),ae&&n(he)&&(he=t.dark),ae&&ke.s(he).ss(ae);var Ee=r.length;for(z&&(Ee=56),K=0;K<Ee;K++)D=K%i,N=Math.floor(K/i),te=D*(L+l),pe=N*(L+l),g?ke.f(r[K]).dc(te+L/2,pe+L/2,L/2):ke.f(r[K]).r(te,pe,L,L);var ie=pe+L+l;B.colors=r;var Se=ie;if(a){for(K=0;K<16;K++)we.push("#"+xe(K)+xe(K)+xe(K));for(K=0;K<we.length;K++)D=Math.floor(K/i),N=K%i,te=N*(L+l),pe=D*(L+l)+ie,g?ke.f(we[K]).dc(te+L/2,pe+L/2,L/2):ke.f(we[K]).r(te,pe,L,L);ie=pe+L+l;var Le=i,Ce=Math.ceil(we.length/i)}B.greys=we,b&&!z&&(b=this.indicator=g?new t.Circle(L/2*.5,null,null,null,null,null,null,null,!1):new t.Rectangle(L*.5,L*.5,null,null,null,null,null,null,null,!1),b.alpha=.5,b.centerReg(),this.addChild(b),b.mouseEnabled=!1,ee(r.indexOf(le)));function ee(yt){if(n(yt)||yt<0){b.visible=!1;return}else b.visible=!0;le=="#000"||le=="#000000"||le=="black"?(b.color="#222",b.alpha=1):(b.color="black",b.alpha=.5),b.x=F.x+yt%i*(L+l)+L/2,b.y=F.x+Math.floor(yt/i)*(L+l)+L/2}var Me=10,_e=ie;if(s||m){var Ye=new t.Container({style:!1});Ye.setBounds(0,0,600,70),this.addChild(Ye),Ye.x=0,Ye.y=ie;var je=this.alphaBacking=new t.Rectangle(600-Me*2,50,t.licorice,null,null,0,null,null,null,!1);Ye.addChild(je),t.centerReg(je,Ye);var it=this.alphaBut=new t.Button({width:20,height:30,backgroundColor:"darkorange",rollBackgroundColor:"orange",label:"",corner:0,hitPadding:20,style:!1}),Be=this.alphaSlider=new t.Slider({min:0,max:1,step:m?0:.05,button:it,barLength:m?500*.55:600*.55,barWidth:2,barColor:t.silver,vertical:!1,useTicks:!1,inside:!1,style:!1});Be.currentValue=n(G)?1:G,m&&(Be.currentValue=.1),Ye.addChild(Be),Be.x=40,Be.y=Ye.height/2;var qe=this.alphaText=new t.Label({text:m?"Tolerance: 0.1":"Alpha: "+t.decimals(G),size:30,color:"orange",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",rollColor:"orange",group:this.group});Ye.addChild(qe),qe.x=Be.x+Be.bar.width+40,qe.y=Ye.height/2-qe.height/2,Ye.scaleX=Ye.scaleY=e/600,Be.on("change",function(){qe.text=m?"Tolerance: "+Ut(Be.currentValue):"Alpha: "+Ut(Be.currentValue),s&&Xe&&(Xe.alpha=S=Be.currentValue),B.dispatchEvent("change"),B.stage&&B.stage.update()}),ie+=Ye.height-Me,m&&(B.toleranceBacking=B.alphaBacking,B.toleranceBut=B.alphaBut,B.toleranceSlider=B.alphaSlider,B.alphaBacking=B.alphaBut=B.alphaSlider=null)}if(v){var et=new t.Container({style:!1});et.setBounds(0,0,600,100),this.addChild(et),et.x=0,et.y=ie+Me;var ve=this.swatchText=new t.TextInput({align:"left",selectionAlpha:.5,text:le.toUpperCase(),width:140,size:30,color:"orange",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group});if(ve.on("input",function(){(ve.text.length==4||ve.text.length==7)&&(Xe.color=ve.text,le=Xe.color,B.dispatchEvent("change"))}),et.addChild(ve),t.centerReg(ve),ve.x=200/2-10,ve.y=50-2,c){var Pe=this.grip=new t.Shape({style:!1});Pe.cur("pointer"),et.addChild(Pe),Pe.graphics.f("rgba(256,256,256,.25)").r(0,0,5,20).r(10,0,5,20).r(20,0,5,20).r(30,0,5,20),Pe.x=70,Pe.y=65,ve.y=50-10,Pe.mouseEnabled=!1}var oe=this.closeBut=new t.Button({width:90,height:90,label:"X",backgroundColor:t.licorice,rollBackgroundColor:t.charcoal,corner:0,style:!1});et.addChild(oe),oe.x=600-oe.width-Me,oe.y=0,oe.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){B.hide(),B.dispatchEvent("close")});var Fe=this.okBut=new t.Button({width:150,height:90,label:"OK",backgroundColor:t.licorice,rollBackgroundColor:t.charcoal,corner:0,style:!1});et.addChild(Fe),Fe.x=oe.x-Fe.width-Me,Fe.y=0,Fe.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){gt(),B.dispatchEvent("ok")});var Ze=this.swatchBacking=new t.Shape({style:!1});et.addChild(Ze),ke=Ze.graphics,ke.f(t.black).r(.5,.5,50,89).f(t.granite).r(50,.5,50,89).f(t.white).r(100,.5,49.5,89),Ze.x=Fe.x-150-Me,Ze.y=0;var Xe=this.swatch=new t.Rectangle(150,90,le,null,null,null,null,null,null,!1);et.addChild(Xe),Xe.x=Ze.x,Xe.y=0,Xe.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){B.dispatchEvent("swatch")}),Xe.cur("pointer"),Xe.alpha=S=G,et.scaleX=et.scaleY=e/600,ie+=et.height}else F.cur("pointer");!s&&!v&&(ie-=Me-l);var We=ie+Me;this.setBounds(0,0,e,We);var de=this.background=new t.Rectangle(e,We,E,null,null,null,null,null,null,!1);this.addChildAt(de,0),x!=-1&&k>0&&(de.shadow=new Ge.Shadow(x,8,8,k));var ze=j.zdf,Ve,be=!1;if(this.dropperTarget=P,z){r="spectrum";var Te=30,Re=20,Ne=_e-Te+1,Ue=Ne-Re+1,rt=B.bar=new t.Rectangle(B.width,Te+1,t.black).addTo(B);Y&&(B.title=new t.Label(Y,18,null,t.light).pos(12,1,LEFT,CENTER,B.bar).noMouse()),c&&rt.cur();var me=new t.Container(B.width,Ne).loc(0,Te,B),He=new t.Rectangle(B.width,Ue,new t.GradientColor(["rgb(255 0 0)","rgb(255 255 0)","rgb(0 255 0)","rgb(0 255 255)","rgb(0 0 255)","rgb(255 0 255)","rgb(255 0 0)"],[0,1/6,2/6,3/6,4/6,5/6,6/6],0,0,500,0)).addTo(me).mov(0,Re-1);new t.Rectangle(B.width,Ue/2,new t.GradientColor(["rgba(255,255,255,1)","rgba(255,255,255,0)"],[0,1],0,0,0,Ue/2)).loc(He,null,me),new t.Rectangle(B.width,Ue/2+.5,new t.GradientColor(["rgba(0,0,0,1)","rgba(0,0,00,0)"],[1,0],0,0,0,Ue/2+.5)).loc(He,null,me).mov(0,Ue/2),new t.Rectangle(B.width,20,new t.GradientColor(["black","white"],[.1,.9],0,0,B.width,0)).addTo(me);var at=B.gradient=new t.Bitmap(me).loc(me,null,B).cur("none"),Qe=B.pixels=new t.Pixel(me,.5).loc(me,null,B).vis(!1).cur("none");me.dispose();var ct;!v&&O&&(ct=B.closeIcon=new t.Shape(-40,-40,80,80,null,!1),ct.graphics.f(t.light).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),ct.sca(.25).expand(10,10,10,1).pos(7,0,t.RIGHT,t.CENTER,rt).cur().addTo(B),ct.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){B.hide(),B.dispatchEvent("close")}));var ot=B.collapseIcon=new t.Triangle(20,20,20,t.faint,t.light,2).expand(10,10,10,1).pos(40+(ct?30:0),0,t.RIGHT,t.CENTER,rt).cur().addTo(B);ot.on("mousedown",function(){B.collapse(ot.rotation==0)});var dt=new t.Rectangle(20,20,t.white).reg("center");new t.Tile(new t.Rectangle(10,10,t.series(t.silver,t.white,t.white,t.silver)),2,2,0,0).addTo(dt),dt.mouseChildren=!1;var $e=B.modeIcon=new t.Button({width:20,height:20,shadowColor:-1,label:"",backing:dt,toggleEvent:"mousedown",toggleBacking:new t.Rectangle(20,20,new t.GradientColor([t.white,t.grey],[0,1],0,0,20,20)).reg("center")}).pos(8+(ct?30:0),5,t.RIGHT,t.TOP,B).expand(10,10,10,1);$e.on("mousedown",function(){Qe.vis($e.toggled),B.spectrumToggled=!$e.toggled,ze.stage.update()}),C||($e.removeFrom(),ot.mov(28)),y||ot.removeFrom(),_||B.okBut&&B.okBut.removeFrom(),!O&&oe&&oe.removeFrom();var Mt=new t.Rectangle(B.width,B.height-Ne-Te,t.faint).pos(0,0,t.LEFT,t.BOTTOM,B).noMouse(),Ct=this.dropper=new t.Circle(10,t.clear,t.white,8);new t.Circle(5,t.clear,t.black,2).center(Ct),new t.Circle(7,t.clear,t.white,2).center(Ct),Ct.noMouse()}this.updateDropperTarget=function(){Ct.vis(!1),kt(),Ct.vis(!0).top()},this.spectrumToggled=z,this.toggleSpectrum=function(yt){yt!=B.spectrumToggled&&(n(yt)&&(yt=!B.spectrumToggled),B.spectrumToggled=yt,$e.toggle(!yt),Qe.vis(!yt),B.updateDropperTarget())};var xt=!1;function Bt(){ze.stage.mouseInBounds?Ct.alp(1):Ct.alp(0),Ct.loc(ze.mouseX,ze.mouseY,ze.stage),xt=B.spectrumToggled?at.hitTestReg(Ct):Qe.hitTestReg(Ct);var yt;B.dropperTarget?yt=Ct.x>=Ve.x&&Ct.x<=Ve.x+Ve.width&&Ct.y>=Ve.y&&Ct.y<=Ve.y+Ve.height:yt=!1;var Vt;if(B.dropperTarget?Vt=(xt||yt)&&!Mt.hitTestReg(Ct)&&!rt.hitTestReg(Ct):Vt=xt,!be&&Vt)Rt(yt);else if(be&&!Vt){Ht(),ze.stage.update();return}if(Vt){var yn;if(xt)yn=B.spectrumToggled?at:Qe;else if(B.dropperTarget)yn=Ve;else return;var $t=yn.globalToLocal(ze.mouseX,ze.mouseY),an=yn.getColorAt($t.x,$t.y,!0),Rn="rgba("+an[0]+","+an[1]+","+an[2]+","+an[3]+")";an[3]<.05&&(Rn=ze.color),Ct.borderColor=Rn,ze.stage.update()}}function Rt(yt){be=!0,yt&&kt(),Ct.vis(!0).top()}function Ht(){be=!1,Ve.dispose(),Ct.vis(!1)}this.collapsed=!1,this.collapse=function(yt){n(yt)&&(yt=!0),yt!=B.collapsed&&(B.collapsed=yt,yt?($e.enabled=!1,ot.rot(180),B.background.vis(!1),at.vis(!1),Mt.vis(!1),F.visible=!1,Qe&&Qe.vis(!1),Ye&&Ye.vis(!1),v&&et.vis(!1),be=!1,en(),Qt(),B.dispatchEvent("collapsed")):($e.enabled=!0,ot.rot(0),B.background.vis(!0),at.vis(!0),Mt.vis(!0),F.visible=!0,B.spectrumToggled||Qe.vis(!0),Ye&&Ye.vis(!0),v&&et.vis(!0),be=!0,nn(),kt(),rt.hitTestReg(Ct)&&Qt(),B.dispatchEvent("expanded")),ze.stage.update())},z&&y&&(B.collapseEvent=rt.on("dblclick",function(){B.collapsed?B.collapse(!1):B.collapse(!0)})),z&&$&&y&&(B.vis(!1),setTimeout(function(){B.collapse(!0),B.vis(!0),B.stage&&B.stage.update()},50));function nn(){en(),B.dropperDown=ze.stage.on("stagemousedown",Bt),B.dropperMove=ze.stage.on("stagemousemove",Bt),B.dropperUp=ze.stage.on("stagemouseup",function(){Bt(),Xe&&z&&xt&&Xe.color!=Ct.borderColor&&Je()})}function en(){B.dropperDown&&ze.stage.off("stagemousedown",B.dropperDown),B.dropperMove&&ze.stage.off("stagemousemove",B.dropperMove),B.dropperUp&&ze.stage.off("stagemouseup",B.dropperUp)}function kt(){Ve&&Ve.dispose&&Ve.dispose();var yt=new t.Rectangle(ze.width,ze.height,ze.color).addTo(ze.stage,0),Vt;B.dropperTarget&&B.dropperTarget.getBounds&&B.dropperTarget.type&&!B.dropperTarget.type.includes("Stage")?Vt=B.dropperTarget.boundsToGlobal():Vt=ze.stage.getBounds(),Ve=new t.Bitmap(ze.stage,Vt.width,Vt.height,Vt.x,Vt.y).loc(Vt).cur("none"),yt.dispose(),Ve.on("mousedown",Je)}function Qt(){Ve&&Ve.dispose&&Ve.dispose(),Ct.vis(!1)}function Je(){Ct.vis(!1),B.currentValue=t.convertColor(Ct.borderColor,"hex"),B.dispatchEvent("change"),be&&(P?(kt(),Ct.vis(!0).top(),setTimeout(function(){B.updateDropperTarget(),ze.stage.update()},50)):(Ct.vis(!0).top(),ze.stage.update()))}function gt(){if(ne&&a){u=d,d=re;var yt=[u,d];for(K=0;K<2;K++){var Vt=F.graphics;D=Math.floor(K/i),N=K%i,te=N*(L+l),pe=D*(L+l)+Se,we[K]=yt[K],Vt.f(de.color).r(te-1,pe-1,L+2,L+2).f(yt[K]).r(te,pe,L,L)}}re=le,o=S,B.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&B.stage&&B.stage.update()}if(c){var It,Xt;de.on("mousedown",Yt),de.on("pressmove",ft),de.on("pressup",bt),z&&(rt.on("mousedown",Yt),rt.on("pressmove",ft),rt.on("pressup",bt))}function Yt(yt){It=yt.stageX/t.scaX-B.x,Xt=yt.stageY/t.scaY-B.y}function ft(yt){B.x=yt.stageX/t.scaX-It,B.y=yt.stageY/t.scaY-Xt,B.stage&&B.stage.update()}function bt(){B.stage&&B.stage.update()}var Gt=i*(L+l),Kt=ce*(L+l);if(a)var fn=Le*(L+l),Jt=Ce*(L+l);F.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(yt){var Vt=t.hitTestGrid(F,Gt,Kt,i,ce,yt.stageX,yt.stageY,0,0,l,l);n(Vt)||(le=r[Vt],v&&(Xe.color=le,ve.text=String(r[Vt]).toUpperCase()),gt()),a&&(Vt=null,Vt=t.hitTestGrid(F,fn,Jt,Le,Ce,yt.stageX,yt.stageY,0,Kt,l,l),n(Vt)||(le=we[Vt],v&&(Xe.color=le,ve.text=we[Vt].toUpperCase()),gt())),b&&ee(r.indexOf(le)),v?B.stage&&B.stage.update():b&&B.stage&&B.stage.update(),jt()}),Object.defineProperty(this,"selectedColor",{get:function(){return le},set:function(yt){yt=yt.toLowerCase(),re=le=yt,v&&(Xe.color=le,ve.text=le,B.stage&&B.stage.update()),b&&!z&&ee(r.indexOf(le)),jt()}}),Object.defineProperty(this,"currentValue",{get:function(){return le},set:function(yt){B.selectedColor=yt}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return le},set:function(yt){yt!=B.selectedColor&&(B.selectedColor=yt,B.dispatchEvent("change"))}}),Object.defineProperty(this,"selectedIndex",{get:function(){return z?null:r.indexOf(le)},set:function(yt){z||(re=le=r[yt],v&&(Xe.color=le,ve.text=le,B.stage&&B.stage.update()),b&&ee(r.indexOf(le)),jt())}}),Object.defineProperty(this,"selectedAlpha",{get:function(){return s?Ut(Be.currentValue):1},set:function(yt){s&&(o=Be.currentValue=yt,Xe&&(Xe.alpha=o),qe&&(qe.text="Alpha: "+Ut(Be.currentValue)),B.stage&&B.stage.update())}}),Object.defineProperty(this,"selectedTolerance",{get:function(){return m?Ut(Be.currentValue):1},set:function(yt){m&&(Be.currentValue=yt,B.stage&&B.stage.update())}}),Object.defineProperty(this,"colors",{get:function(){return z?"spectrum":a?r.concat(we):r},set:function(){pt&&tt("ColorPicker() colors is read only - make a new ColorPicker to change")}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==B},set:function(){Et?t.KEYFOCUS=B:j.KEYFOCUS=B}}),A&&t.KEYFOCUS&&rn(),this.on("mousedown",function(){A&&rn()});function rn(){B.keyFocus=!0;var yt=document.activeElement;yt&&yt.blur()}function jt(){B.zimAccessibility&&B.zimAccessibility.changeTitle(B,null,!0)}this.keyDownEvent=function(yt){if(B.stage&&!z&&(B.zimAccessibility&&B.focus||!B.zimAccessibility&&B.keyFocus)){var Vt=B.selectedIndex;yt.keyCode==37||yt.keyCode==40?(Vt--,gn(Vt)):(yt.keyCode==38||yt.keyCode==39)&&(Vt++,gn(Vt))}};function gn(yt){yt<0&&(yt=B.colors.length-1),yt>B.colors.length-1&&(yt=0),B.selectedIndex=yt,B.dispatchEvent("change"),B.stage&&B.stage.update()}j.addEventListener("keydown",this.keyDownEvent);var vt,ze;this.hide=function(){return vt=B.stage,B.removeFrom(),vt&&vt.update(),B},this.on("removed",wt);function wt(){if(z&&(be=!1,en(),Qt()),B.toggled=!1,B.zimAccessibility){var yt=B.zimAccessibility;yt.resize(B),Wt?Wt.focus():B.zimTabTag.nextSibling.focus(),setTimeout(function(){yt.talk("ColorPicker has been closed.")},50)}vt&&vt.update()}var Wt,_t=!1;this.show=function(){return B.center(B.container),B};function tn(){if(B.stage&&(vt=B.stage,ze=vt.frame),B.zimAccessibility){var yt=B.zimAccessibility;setTimeout(function(){yt.activatedObject&&(Wt=yt.activatedObject.zimTabTag)},50),yt.resize(B),yt.tabIndex=B.zimTabIndex}B.toggled=!0,setTimeout(function(){z&&(be=!0,kt(),nn(),Rt(),Bt()),B.stage&&B.stage.update()},20)}this.on("added",tn),this.toggle=function(yt){return yt===!0?B.show():yt===!1||B.container.contains(B)?B.hide():B.show(),B};function Ut(yt){return Math.round(yt*Math.pow(10,2))/Math.pow(10,2)}n(h)&&(h=Z.selectedIndex!=null?Z.selectedIndex:0),B.selectedIndex=h,n(w)&&(w=Z.selectedColor!=null?Z.selectedColor:null),w!=null?B.selectedColor=w:z&&(B.selectedColor="#888888"),I!==!1&&t.styleTransforms(this,Z),this.clone=function(){return B.cloneProps(new t.ColorPicker(e,ne?null:r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,this.group,R))},this.dispose=function(yt,Vt,yn){return j.removeEventListener("keydown",B.keyDownEvent),z&&(en(),B.gradient.cur("default"),B.pixels.cur("default"),P&&P.cur("default"),Ve.cur("default"),be=!1,Qt()),Be&&Be.dispose(),Ct&&Ct.dispose(),B.dropperDown&&ze.stage.off("stagemousedown",B.dropperDown),B.dropperMove&&ze.stage.off("stagemousemove",B.dropperMove),B.dropperUp&&ze.stage.off("stagemouseup",B.dropperUp),yn||this.zimContainer_dispose(!0),!0}},t.extend(t.ColorPicker,t.Container,["clone","dispose"],"zimContainer",!1),t.EmojiPicker=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P){var y="width, height, emojis, monochrome, backgroundColor, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, cache, size, collapse, collapseColor, collapsed, colSize, rowSize, style, group, inherit",C;if(C=st(t.EmojiPicker,arguments,y,this))return C;De("67.05"),this.group=w;var O=h===!1?{}:t.getStyle("EmojiPicker",this.group,P);n(e)&&(e=O.width!=null?O.width:400),n(r)&&(r=O.height!=null?O.height:600),n(l)&&(l=O.monochrome!=null?O.monochrome:!1),n(a)&&(a=O.backgroundColor!=null?O.backgroundColor:t.lighter),n(s)&&(s=O.titleBar!=null?O.titleBar:"Emojis"),n(f)&&(f=O.titleBarColor!=null?O.titleBarColor:null),n(c)&&(c=O.titleBarBackgroundColor!=null?O.titleBarBackgroundColor:t.silver.toAlpha(.8)),n(x)&&(x=O.titleBarHeight!=null?O.titleBarHeight:40),n(k)&&(k=O.cache!=null?O.cache:!!t.mobile()),n(v)&&(v=O.size!=null?O.size:30),n(A)&&(A=O.colSize!=null?O.colSize:v+15),n(T)&&(T=O.rowSize!=null?O.rowSize:v+14),n(g)&&(g=O.collapse!=null?O.collapse:!1),n(b)&&(b=O.collapseColor!=null?O.collapseColor:n(f)?t.grey:f),n(E)&&(E=O.collapsed!=null?O.collapsed:!1),this.zimWindow_constructor(e,r,null,a,null,O.borderWidth!=null?O.borderWidth:2,O.padding!=null?O.padding:10,O.corner!=null?O.corner:10,null,O.scrollBarActive!=null?O.scrollBarActive:!0,O.scrollBarDrag!=null?O.scrollBarDrag:!0,null,null,null,!1,null,null,null,null,null,!0,null,null,null,null,null,null,s,f,c,x,O.draggable!=null?O.draggable:!0,null,null,O.close!=null?O.close:!0,null,null,O.fullSize!=null?O.fullSize:!1,null,O.resizeHandle!=null?O.resizeHandle:!1,g,b,E,null,null,h,w,t.copy(O)),this.type="EmojiPicker";var _=this;this.emojiData=n(i)?["\u{1F4A5}","\u{1F335}","\u{1F382}","\u{1F370}","\u{1F429}","\u{1F525}","\u{1F32B}","\u{1F30A}","\u{1F34F}","\u{1F34E}","\u{1F34B}","\u{1F34C}","\u{1F347}","\u{1F351}","\u{1F345}","\u{1F346}","\u{1F9C0}","\u{1F355}","\u{1F36C}","\u{1F36D}","\u{1F369}","\u{1F37A}","\u{1F37B}","\u{1F378}","\u{1F37E}","\u2615\uFE0F","\u{1F4A9}","\u{1F47B}","\u{1F916}","\u{1F4A4}","\u{1F440}","\u{1F483}","\u{1F483}\u{1F3FB}","\u{1F483}\u{1F3FC}","\u{1F483}\u{1F3FD}","\u{1F483}\u{1F3FE}","\u{1F483}\u{1F3FF}","\u{1F454}","\u{1F457}","\u{1F459}","\u{1F458}","\u{1F460}","\u{1F452}","\u{1F3A9}","\u{1F431}","\u{1F43B}","\u{1F436}","\u{1F43C}","\u{1F42F}","\u{1F981}","\u{1F42E}","\u{1F437}","\u{1F419}","\u{1F435}","\u{1F412}","\u{1F414}","\u{1F426}","\u{1F434}","\u{1F984}","\u{1F41D}","\u{1F422}","\u{1F420}","\u{1F410}","\u{1F54A}","\u{1F415}","\u{1F408}","\u{1F409}","\u{1F432}","\u{1F384}","\u{1F340}","\u{1F33B}","\u{1F339}","\u{1F490}","\u{1F344}","\u2600\uFE0F","\u{1F327}","\u26BD\uFE0F","\u{1F3C0}","\u{1F3C8}","\u26BE\uFE0F","\u{1F3BE}","\u{1F3D2}","\u26F7","\u{1F3C4}","\u{1F3CA}","\u{1F6B4}","\u{1F3AD}","\u{1F3A8}","\u{1F3B7}","\u{1F3BA}","\u{1F3B8}","\u{1F3BB}","\u{1F3B0}","\u{1F3B3}","\u{1F697}","\u{1F695}","\u{1F68C}","\u{1F68E}","\u{1F691}","\u{1F692}","\u{1F69C}","\u{1F682}","\u2708\uFE0F","\u26F5\uFE0F","\u{1F6F0}","\u{1F301}","\u{1F30B}","\u{1F3DE}","\u{1F305}","\u{1F386}","\u{1F308}","\u{1F3E0}","\u{1F3E5}","\u{1F3EB}","\u231A\uFE0F","\u{1F4F1}","\u{1F5A5}","\u{1F4BE}","\u{1F4FC}","\u{1F3A5}","\u260E\uFE0F","\u{1F4FA}","\u{1F4FB}","\u{1F4E1}","\u{1F56F}","\u{1F4B0}","\u{1F48E}","\u{1F6AC}","\u26B0","\u{1F52E}","\u{1F488}","\u{1F6BD}","\u{1F511}","\u{1F6CF}","\u{1F389}","\u{1F38A}","\u2764\uFE0F","\u{1F921}","\u{1F600}","\u{1F62C}","\u{1F601}","\u{1F602}","\u{1F603}","\u{1F604}","\u{1F605}","\u{1F606}","\u{1F607}","\u{1F609}","\u{1F60A}","\u{1F642}","\u{1F643}","\u263A\uFE0F","\u{1F60B}","\u{1F60C}","\u{1F60D}","\u{1F618}","\u{1F617}","\u{1F619}","\u{1F61A}","\u{1F61C}","\u{1F61D}","\u{1F61B}","\u{1F911}","\u{1F913}","\u{1F60E}","\u{1F917}","\u{1F60F}","\u{1F636}","\u{1F610}","\u{1F611}","\u{1F612}","\u{1F644}","\u{1F914}","\u{1F633}","\u{1F61F}","\u{1F620}","\u{1F614}","\u{1F615}","\u{1F641}","\u2639\uFE0F","\u{1F623}","\u{1F62B}","\u{1F629}","\u{1F631}","\u{1F628}","\u{1F630}","\u{1F62F}","\u{1F626}","\u{1F622}","\u{1F62A}","\u{1F613}","\u{1F62D}","\u{1F635}","\u{1F632}","\u{1F910}","\u{1F637}","\u{1F912}","\u{1F915}","\u{1F634}","\u{1F480}","\u2620\uFE0F","\u{1F47D}","\u{1F63A}","\u{1F638}","\u{1F639}","\u{1F63B}","\u{1F63C}","\u{1F63D}","\u{1F640}","\u{1F63F}","\u{1F63E}","\u{1F444}","\u{1F48B}","\u{1F445}","\u{1F5E3}","\u{1F464}","\u{1F465}","\u{1F456}","\u{1F463}","\u{1F461}","\u{1F462}","\u{1F45E}","\u{1F45F}","\u{1F393}","\u{1F451}","\u{1F45C}","\u{1F45B}","\u{1F4BC}","\u{1F453}","\u{1F576}","\u{1F48D}","\u{1F302}","\u2744\uFE0F","\u{1F32A}","\u26A1\uFE0F","\u{1F951}","\u{1F98B}","\u{1F648}","\u{1F649}","\u{1F64A}","\u{1F427}","\u{1F577}","\u{1F982}","\u{1F980}","\u{1F40D}","\u{1F41B}","\u{1F40C}","\u{1F41E}","\u{1F41C}","\u{1F41F}","\u{1F421}","\u{1F42C}","\u{1F433}","\u{1F40B}","\u{1F40A}","\u{1F406}","\u{1F332}","\u{1F333}","\u{1F334}","\u{1F331}","\u{1F33F}","\u{1F343}","\u{1F342}","\u{1F341}","\u{1F33A}","\u{1F33C}","\u{1F338}","\u{1F330}","\u{1F383}","\u{1F41A}","\u{1F578}","\u{1F30E}","\u{1F30D}","\u{1F30F}","\u{1F315}","\u{1F316}","\u{1F317}","\u{1F318}","\u{1F311}","\u{1F312}","\u{1F313}","\u{1F314}","\u{1F31A}","\u{1F31D}","\u{1F31B}","\u{1F31C}","\u{1F31E}","\u{1F319}","\u2B50\uFE0F","\u{1F31F}","\u{1F4AB}","\u2728","\u2604\uFE0F","\u{1F354}","\u{1F373}","\u{1F35F}","\u{1F32D}","\u{1F35D}","\u{1F32E}","\u{1F32F}","\u{1F363}","\u{1F368}","\u{1F366}","\u{1F377}","\u{1F379}","\u{1F3C6}","\u{1F3AA}","\u{1F3B9}","\u{1F680}","\u26F2\uFE0F","\u{1F3A2}","\u26F0","\u{1F3D4}","\u{1F5FB}","\u{1F4AF}","\u{1F3B5}","\u{1F3B6}","\u{1F4AC}","\u{1F4AD}","\u{1F5EF}","\u{1F0CF}","\u{1F3F3}\uFE0F\u200D\u{1F308}","\u{1F953}","\u{1F943}","\u{1F3A4}","\u{1F6A8}","\u{1F3CD}","\u{1F3D5}","\u26FA\uFE0F","\u{1F3DC}","\u{1F3D6}","\u{1F3DD}","\u{1F307}","\u{1F306}","\u{1F3D9}","\u{1F303}","\u{1F3D8}","\u{1F3E1}","\u{1F3E2}","\u{1F528}","\u2699","\u{1F52B}","\u{1F4A3}","\u{1F52A}","\u{1F48A}","\u{1F573}","\u{1F489}","\u{1F6C1}","\u26F1","\u{1F381}","\u{1F388}","\u{1F380}","\u{1F4C5}","\u{1F5F3}","\u{1F4DA}","\u270F\uFE0F","\u26AA\uFE0F","\u26AB\uFE0F","\u2B1B\uFE0F","\u2B1C\uFE0F","\u{1F5BC}","\u{1F3DA}","\u{1F3ED}","\u{1F532}","\u{1F533}","\u{1F3B1}","\u{1F53A}","\u{1F53B}","\u{1F4A6}","\u26F3\uFE0F","\u{1F3DF}","\u{1F4A1}","\u{1F52D}","\u{1F52C}","\u{1F570}","\u{1F42A}","\u{1F42B}","\u{1F418}","\u{1F438}","\u{1F430}","\u{1F42D}","\u{1F6AA}","\u{1F6CD}","\u{1F441}","\u{1F353}","\u{1F352}","\u{1F336}","\u{1F33D}","\u{1F360}","\u{1F36F}","\u{1F35E}","\u{1F36B}","\u{1F37F}","\u{1F36A}","\u{1F34A}","\u{1F3F9}","\u{1F46F}","\u{1F46F}\u200D\u2642\uFE0F","\u{1F5D1}"]:i;var Y=[];t.loop(this.emojiData,function(m){var $=new t.Emoji(m,v,l);Y.push($)}),this.wrapper=new t.Wrapper({items:Y,width:e,alignInner:t.CENTER,valignInner:t.CENTER,wrapperType:"column",colSize:A,rowSize:T}).cur(),this.backdrop=new t.Rectangle(this.wrapper.width,this.wrapper.height,t.faint),t.timeout(.2,function(){_.scrollBar&&_.scrollBar.vertical&&_.scrollBar.vertical.getBounds()&&_.scrollBar.vertical.expand(),_.backdrop.heightOnly=_.wrapper.height,k&&_.wrapper.cache()}),this.add(this.backdrop),this.add(this.wrapper),this.wrapper.tap(function(m){_.currentEmoji=m.target,_.dispatchEvent("change")}),h!==!1&&t.styleTransforms(this,O),this.clone=function(){return _.cloneProps(new t.EmojiPicker(e,r,h,this.group,P))},this.dispose=function(){return!0}},t.extend(t.EmojiPicker,t.Window,["clone","dispose"],"zimWindow",!1),t.TextEditor=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B){var d="width, color, backgroundColor, fieldColor, fieldHeight, textSize, sizeList, optionList, colorList, fontList, live, button, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, wrap, limit, scroll, placeholder, password, borderColor, borderWidth, margin, corner, shadowColor, shadowBlur, draggable, boundary, frame, fontListHeight, fontListViewNum, style, group, inherit",u;if(u=st(t.TextEditor,arguments,d,this))return u;De("67.1"),this.group=U;var o=ne===!1?{}:t.getStyle("TextEditor",this.group,B);if(n(e)&&(e=o.width!=null?o.width:400),n(i)&&(i=o.backgroundColor!=null?o.backgroundColor:t.lighter),n(b)&&(b=o.titleBar!=null?o.titleBar:"Text Editor"),n(X)&&(X=o.draggable!=null?o.draggable:!0),n(T)&&(T=o.titleBarHeight!=null?o.titleBarHeight:30),n(l)&&(l=o.fieldColor!=null?o.fieldColor:i.darken(.05)),n(v)&&(v=o.live!=null?o.live:!0),n(h)&&(h=o.wrap!=null?o.wrap:!0),n(P)&&(P=o.scroll!=null?o.scroll:!0),n(Y)&&(Y=o.margin!=null?o.margin:10),n(w)&&(w=o.limit!=null?o.limit:null),n(b)&&(b=o.titleBar!=null?o.titleBar:null),n(f)&&(f=o.sizeList!=null?o.sizeList:null),n(x)&&(x=o.colorList!=null?o.colorList:null),n(c)&&(c=o.optionList!=null?o.optionList:null),n(k)&&(k=o.fontList!=null?o.fontList:null),n(l)&&(l=o.fieldColor!=null?o.fieldColor:null),n(a)&&(a=o.fieldHeight!=null?o.fieldHeight:null),n(s)&&(s=o.textSize!=null?o.textSize:null),n(J)&&(J=o.fontListHeight!=null?o.fontListHeight:100),n(Z)&&(Z=o.fontListViewNum!=null?o.fontListViewNum:3),typeof q>"u")if(j.zdf)var q=j.zdf;else{pt&&tt("zim.TextEditor - please provide a reference to zim Frame");return}this.zimPanel_constructor(e,300,null,b,E,A,T,i,O,_,m,!0,null,null,null,null,null,null,null,null,$,I,X,R,ne,U,B);var S=this;n(g)&&(g=new t.Button({width:50,height:50,label:"",icon:new t.Shape().sca(.4).f("white").p("AikFsQg5jmhphxIA1gXQBeBGA3CwQC8mRCpjOIBfAoQkPFGiSFpg"),color:t.white,corner:10,backgroundColor:t.green.darken(.2),borderColor:t.white,borderWidth:2,rollBackgroundColor:t.green,shadowBlur:3}).pos(Y,T+Y*2,t.RIGHT,t.TOP,S)),S.button=g,g.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",F),n(a)&&(a=o.fieldHeight!=null?o.fieldHeight:g.height+Y*2);function F(){v||(L.text=p.text),S.hide(),S.dispatchEvent("set")}var p=S.textArea=new t.TextArea({color:r,backgroundColor:l,width:e-g.width-Y*3,height:n(a)?g.height+Y*2:a,expand:10,password:C,placeholder:y,frame:q}).loc(Y,T+Y+(a&&a<g.height+Y*2?(g.height-a)/2+Y:0),null,null,!1);h||(p.tag.style.whiteSpace="nowrap"),w&&p.tag.setAttribute("maxLength",w),P&&(p.tag.style.overflowY="auto");var L=new t.Label;S.on("pressmove",function(){p.resize()}),S.on("close",function(){S.inputEvent&&p.off("input",S.inputEvent),p.removeFrom()}),S.panelHeight=T+Y+Math.max(a,g.height+Y*2)+Y;var we=t.mobile(),D=we?35:30;if(f||c||x){new t.Rectangle(e,D+Y,"rgba(0,0,0,.05)").loc(0,S.panelHeight,S);var N=[];if(x){var ue=Array.isArray(x),fe=S.colorPicker=new t.ColorPicker({colors:ue?x:null,cols:ue?Math.min(x.length,12):null,alphaPicker:!1,greyPicker:!ue,container:q.stage});fe.on("close",ge),fe.on("change",function(){L.color=r.color=fe.selectedColor,S.dispatchEvent("update"),ge()}),S.closeColorPicker=function(){ge()},r=S.swatch=new t.Rectangle(D,D,L.color,t.dark,1).cur(),r.on("mousedown",function(){S.dispatchEvent("color"),p.tag.style.display="none",fe.selectedColor=r.color,fe.show(),S.stage&&S.stage.update()}),N.push(r)}if(c){c===!0&&(c=["bold","italic","align"]),n(j.STYLE)&&(j.STYLE={}),n(j.STYLE.group)&&(j.STYLE.group={}),j.STYLE.group.zimEditor={width:D,height:D,corner:0,borderColor:t.tin,shadowBlur:-1,backgroundColor:t.light,rollBackgroundColor:t.light,toggleBackgroundColor:t.green,toggleColor:t.grey};var V,z,se;t.loop(c,function(Ae){if(Ae.toLowerCase()=="bold")V=S.bold=new t.Button({label:new t.Label({text:"B",color:t.grey,size:16,bold:!0}),toggle:"B",group:"zimEditor"}),V.on("click",function(){L.bold=V.toggled,S.dispatchEvent("update"),S.stage&&S.stage.update()}),N.push(V),L.bold&&V.toggle();else if(Ae.toLowerCase()=="italic")z=S.italic=new t.Button({label:new t.Label({text:"I",color:t.grey,size:16,bold:!0,italic:!0}),toggle:"I",group:"zimEditor"}),z.on("click",function(){L.italic=z.toggled,S.dispatchEvent("update"),S.stage&&S.stage.update()}),N.push(z),L.italic&&z.toggle();else if(Ae.toLowerCase()=="align"){var re=new t.Tile(new t.Rectangle(D-10,D-10,t.grey).centerReg(),3,1,10,10),xe=we?["\u21DA","\u21D4","\u21DB"]:["\u21D0","\u21D4","\u21D2"];t.loop(3,function(te){var pe=re.getChildAt(te);new t.Label(xe[te],D*2/3,null,t.white).center(pe).expand(10)});var ke=0;L.align=="right"?ke=2:(L.align=="center"||L.align=="middle")&&(ke=1),se=S.align=new t.Selector({tile:re,corner:0,borderWidth:1,borderColor:t.grey,backgroundColor:t.clear,selectedIndex:ke}),se.on("change",function(){se.selectedIndex==0?L.align="left":se.selectedIndex==1&&(L.align="center"),se.selectedIndex==2&&(L.align="right"),S.dispatchEvent("update"),S.stage&&S.stage.update()}),N.push(se)}}),delete j.STYLE.group.zimEditor}if(f){var Oe=S.sizePicker=new t.Stepper({list:f===!0?null:f,stepperType:f===!0?null:"list",min:f===!0?5:null,max:f===!0?500:null,width:150,shadowBlur:-1,borderColor:t.dark,borderWidth:2,corner:0,backgroundColor:t.green,downForward:!1}).siz(null,D);Oe.arrowPrev.expand(0),Oe.textBox.color=t.lighter,Oe.on("change",function(){L.size=Oe.currentValue,S.dispatchEvent("update"),S.stage&&S.stage.update()}),Oe.currentValue=L.size,N.push(Oe)}var K=new t.Tile(N,N.length,1,10,10,!0).loc(Y,S.panelHeight+Y/2,S);S.panelHeight=S.panelHeight+Y+K.height+Y}function ge(){p.tag.style.display="block",fe.hide(),S.stage&&S.stage.update()}var Q;if(k){Array.isArray(k)?Q=k:(Q=["Arial","Courier New","Georgia","Helvetica","Palatino","Tahoma","Verdana"],we||(Q=Q.concat(["Comic Sans MS","Impact"])),Q.sort());var ce=S.fonts=new t.List({width:e-Y*2,height:J,viewNum:Z,backgroundColor:t.moon,color:t.grey,rollColor:t.dark,rollBackgroundColor:t.green.lighten(.5),selectedBackgroundColor:t.mist,selectedRollBackgroundColor:t.green.lighten(.6),selectedColor:t.dark,backdropColor:t.light,scrollBarColor:t.dark,shadowBlur:-1,list:Q}).center(S).loc(null,S.panelHeight);ce.on("change",function(){L.font=ce.currentValue,S.dispatchEvent("update"),S.stage&&S.stage.update()}),S.panelHeight=S.panelHeight+Y+ce.height+Y}S.show=function(Ae,re,xe,ke){if(S.parent)return Ae==S.label||(S.label=Ae),S;L=Ae,p.addTo(S);var te;if(L&&L.stage)te=L.stage;else if(ke)te=ke.stage;else if(j.zdf)te=j.zdf.stage;else return S;return!n(re)||!n(xe)?S.loc(re,xe):L&&L.y>te.height/2?S.loc(te.width/2-e/2,L.y-S.panelHeight-te.height*.05,te):L&&L.y<=te.height/2?S.loc(te.width/2-e/2,L.y+L.height+te.height*.05,te):S.center(te),S.y<20&&(S.y=20),S.y+S.height>S.stage.height&&(S.y=S.stage.height-S.height-20),G(),S.stage.update(),S};function G(){L&&(p.text=L.text),r&&(r.color=L.color),V&&V.toggle(L.bold==!0),z&&z.toggle(L.italic==!0),se&&(se.noAnimate=!0,L.align=="center"?se.selectedIndex=1:L.align=="right"?se.selectedIndex=2:se.selectedIndex=0),Oe&&(Oe.currentValue=L.size),ce&&(ce.currentValue=L.font),S.inputEvent&&p.off("input",S.inputEvent),S.inputEvent=p.on("input",function(){v&&L&&(L.text=p.text),S.dispatchEvent("input"),S.dispatchEvent("update"),S.stage&&S.stage.update()})}S.hide=function(){if(x&&fe.hide(),p&&p.removeFrom(),!n(S.stage)){var Ae=S.stage;return S.removeFrom(),Ae.update(),S}},j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==S},set:function(){t.KEYFOCUS=S}}),t.KEYFOCUS||le(),this.on("mousedown",function(){le()});function le(){S.keyFocus=!0}Object.defineProperty(S,"label",{get:function(){return L},set:function(Ae){L=Ae,G()}}),ne!==!1&&t.styleTransforms(this,o),this.clone=function(){return S.cloneProps(new t.TextEditor(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,this.group,B))},this.dispose=function(Ae,re,xe){return S.inputEvent&&p.off("input",S.inputEvent),fe&&fe.dispose(),r&&r.dispose(),ce&&ce.dispose(),g&&g.dispose(),p&&p.dispose(),se&&se.dispose(),V&&V.dispose(),z&&z.dispose(),Oe&&Oe.dispose(),xe||this.zimPanel_dispose(),S.stage&&S.stage.update(),S.textArea=S.color=S.colorPicker=S.font=S.button=S.selector=S.bold=S.italic=S.size=null,!0}},t.extend(t.TextEditor,t.Panel,["clone","dispose"],"zimPanel",!1),t.Keyboard=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne){var U="labels, backgroundColor, color, shiftBackgroundColor, shiftHoldBackgroundColor, placeBackgroundColor, placeColor, cursorColor, shadeAlpha, borderColor, borderWidth, margin, corner, draggable, placeClose, shadowColor, shadowBlur, container, data, place, placeShiftH, placeShiftV, special, rtl, hardKeyboard, layout, numPadScale, numPadDraggable, numPadOnly, numPadAdvanced, style, group, inherit",B;if(B=st(t.Keyboard,arguments,U,this))return B;De("67.2"),this.zimContainer_constructor(1e3,400,null,null,!1),this.type="Keyboard",this.group=Z;var d=J===!1?{}:t.getStyle(this.type,this.group,ne);n(e)&&(e=d.labels!=null?d.labels:[]),Array.isArray(e)||(e=[e]),n(r)&&(r=d.backgroundColor!=null?d.backgroundColor:t.dark),n(i)&&(i=d.color!=null?d.color:t.white),n(l)&&(l=d.shiftBackgroundColor!=null?d.shiftBackgroundColor:"orange"),n(a)&&(a=d.shiftHoldBackgroundColor!=null?d.shiftHoldBackgroundColor:"red"),n(s)&&(s=d.placeBackgroundColor!=null?d.placeBackgroundColor:t.blue),n(f)&&(f=d.placeColor!=null?d.placeColor:i),n(c)&&(c=d.cursorColor!=null?d.cursorColor:t.blue),n(x)&&(x=d.shadeAlpha!=null?d.shadeAlpha:.2),n(k)&&(k=d.borderColor!=null?d.borderColor:"rgba(0,0,0,.1)"),n(v)&&(v=d.borderWidth!=null?d.borderWidth:null),k<0||v<0?k=v=null:k!=null&&v==null&&(v=1),n(g)&&(g=d.margin!=null?d.margin:5),n(b)&&(b=d.corner!=null?d.corner:30),n(E)&&(E=d.draggable!=null?d.draggable:!1),n(A)&&(A=d.placeClose!=null?d.placeClose:!0),n(T)&&(T=d.shadowColor!=null?d.shadowColor:"rgba(0,0,0,.2)"),n(h)&&(h=d.shadowBlur!=null?d.shadowBlur:14),n(P)&&(P=d.data!=null?d.data:[[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["shift","z","x","c","v","b","n","m","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]]]),P[3]||(P[3]={e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]});var u=this;n(y)&&(y=d.place!=null?d.place:!0),n(C)&&(C=d.placeShiftH!=null?d.placeShiftH:0),n(O)&&(O=d.placeShiftV!=null?d.placeShiftV:0),n(Y)&&(Y=d.rtl!=null?d.rtl:!1),n(m)&&(m=d.hardKeyboard!=null?d.hardKeyboard:!0),n(I)&&(I=d.numPadScale!=null?d.numPadScale:.8),n(R)&&(R=d.numPadOnly!=null?d.numPadOnly:!1),n(X)&&(X=d.numPadDraggable!=null?d.numPadDraggable:!0),n(q)&&(q=d.numPadAdvanced!=null?d.numPadAdvanced:!1),n($)&&($=d.layout!=null?d.layout:"qwerty"),$=$.toLowerCase(),$!="qwerty"&&($=="arabic"?P=[[["\u0636","\u0635","\u062B","\u0642","\u0641","\u063A","\u0639","\u0647","\u062E","\u062D","\u062C"],["\u0634","\u0633","\u064A","\u0628","\u0644","\u0627","\u062A","\u0646","\u0645","\u0643","\u0637"],["\u0630","\u0621","\u0624","\u0631","\u0649","\u0629","\u0648","\u0632","\u0638","\u062F","back"],["?123","\u0640"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{\u0627:["\u0623","\u0625","\u0622","\u0621"],\u0649:["\u0626"],\u0621:["\u0626","\u0624"],\u0648:["\u0624"],\u0640:["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],"*":["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],n:["\xF1","\u0144"]}]:$=="hebrew"?P=[[["\u05E7","\u05E8","\u05D0","\u05D8","\u05D5","\u05DF","\u05DD","\u05E4","backspace"],["\u05E9","\u05D3","\u05D2","\u05DB","\u05E2","\u05D9","\u05D7","\u05DC","\u05DA","\u05E3"],["\u05D6","\u05E1","\u05D1","\u05E0","\u05D4","\u05DE","\u05E6","\u05EA","\u05E5"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:$=="azerty"?P=[[["a","z","e","r","t","y","u","i","o","p"],["q","s","d","f","g","h","j","k","l","m"],["shift","w","x","c","v","b","n","\xB4","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:$=="turkish"&&(P=[[["q","w","e","r","t","y","u","\u0131","o","p","\u011F","\xFC"],["a","s","d","f","g","h","j","k","l","\u015F","i"],["shift","z","x","c","v","b","n","m","\xF6","\xE7","backspace"],["?123","*"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]},{\u0131:"I",i:"\u0130"},{I:"\u0131",\u0130:"i"}])),u.data=P;var o="zim display - Keyboard(): Please pass in a reference to a container with bounds set";if(n(w))if(j.zdf)w=j.zdf.stage;else{tt(o);return}else if(w.getBounds){if(n(w.stage)){tt("zim display - Keyboard(): The container must have a stage property");return}}else{tt(o);return}T!=-1&&h>0&&(u.shadow=new Ge.Shadow(T,3,3,h));var S=j.zdf?j.zdf.stage:null;u.labels=e;var F,p=10;t.loop(P[0],function(Te){Te.length>p&&(p=Te.length)});var L=p,we=["/","",",",".","numpad","away"];n(_)||we.splice(1,0,_);var D=t.copy(P[0]);D[3]=D[3].concat(we);var N=t.copy(P[1]);N[3]=N[3].concat(we);var ue=t.copy(P[2]);ue[3]=ue[3].concat(we);var fe=[],V=(1e3-(L-1)*5)/L,z={def:"default",shift:"shift",number1:"number1",number2:"number2"},se=z.def,Oe,K,ge,Q=!1,ce,G,le=0,Ae,re=[],xe,ke,te,pe,he,ae,Ee,ie;_e(),ee(se),E&&Ye(),this.on("mousedown",Se);function Se(Te){S=u.stage,K&&u.removeChild(K),Ae&&re.indexOf(Te.target)<0&&ve(),n(Te.target.na)||(E&&Te.target===Ee?(u.tickerMouseEvent=S.on("stagemousemove",function(Re){u.mouseYAmount=Re.stageY}),t.Ticker.add(it),u.on("pressup",Be),ie=Te.stageY-u.localToGlobal(0,0).y):!n(_)&&Te.target.na===_?u.dispatchEvent("special"):Te.target.na==="shift"?Ce():Te.target.toggle==="?123"?(u.removeChild(Oe),ee(z.number1)):Te.target.toggle==="ABC"?(u.removeChild(Oe),se=z.def,ee(),Q&&Ce(!0)):Te.target.toggle==="1/2"?(u.removeChild(Oe),ee(z.number2)):Te.target.toggle==="2/2"?(u.removeChild(Oe),ee(z.number1)):Te.target.na==="numpad"?je(Te.target):Te.target.na==="away"?(u.hideKeyboard(),u.dispatchEvent("close")):P[3]&&P[3][Te.target.na]?Me(Te.target.na):Te.target.na==="return"?Pe(`
`):Te.target.na==="backspace"||Te.target.na==="back"?Ze():Te.target.na===""?Pe(" "):Pe(Te.target.na),S.update())}u.addChar=function(Te){!n(Te)&&Te.match(/^.$/)&&Pe(Te)},u.removeChar=function(){Ze(!0)},u.clearText=function(){G.text="",Ze(!0),Fe(),u.selectedIndex=0},u.setText=function(Te){G.text=Te,Fe(),u.selectedIndex=Te.length};var Le;function Ce(Te){var Re=!1,Ne,Ue;if(se===z.def){for(ce.color=Te?a:l,Ne=0;Ne<fe.length-6-(n(_)?0:1);Ne++)Ue=fe[Ne],Ue.label.text.length>0&&(Ue.na.length===1?(P[4]&&P[4][Ue.label.text]?Ue.label.text=P[4][Ue.label.text]:Ue.label.text=Ue.label.text.toUpperCase(),Ue.label.centerReg(Ue).mov(0,6)):Ue.label.centerReg(Ue));Te||(Re=!0,setTimeout(rt,500),Le=u.on("pressup",me)),se=z.shift}else{for(ce.color=r,Q=!1,Ne=0;Ne<fe.length-6;Ne++)Ue=fe[Ne],Ue.label.text.length>0&&(Ue.na.length===1?(P[5]&&P[5][Ue.label.text]?Ue.label.text=P[5][Ue.label.text]:Ue.label.text=Ue.label.text.toLowerCase(),Ue.label.centerReg(Ue).mov(0,3)):Ue.label.centerReg(Ue));se=z.def}Oe.updateCache(),u.stage&&u.stage.update();function rt(){Re&&(Q=!0,ce.color=a,Oe.updateCache(),u.stage&&u.stage.update())}function me(){u.off("pressup",Le),Re=!1}}function ee(Te){var Re,Ne,Ue,rt=0,me=0,He,at,Qe=!1,ct,ot,dt=!1;n(Te)&&(Te=z.def),Te===z.def?Re=D:Te===z.number1?Re=N:Te===z.number2&&(Re=ue),u.keys=Oe=new t.Container(1e3,430,null,null,!1).addTo(u).vis(!R);for(var $e=0;$e<Re.length;$e++){($e<=1||Te==z.def&&$e==2&&Re[2][0]!="shift")&&(rt=(V/2+2.5)*(L-Re[$e].length));for(var Mt=0;Mt<Re[$e].length;Mt++){if(Qe=!1,ct=null,dt=!1,Re[$e][Mt]=="backspace"?(at=!0,ct=ke,dt=!0):Re[$e][Mt]=="back"?(at=!1,ct=ke,dt=!0):Re[$e][Mt]=="shift"?(at=!0,ct=xe):($e==3||Te!=z.def&&$e==2)&&Mt==0?(at=!0,dt=!0):Re[$e][Mt]==""?(at=!1,Qe=!0):Re[$e][Mt]=="numpad"?(ct=pe,at=!1,dt=!0):Re[$e][Mt]=="away"?(ct=te,at=!0,dt=!0):at=!1,at?He=V*1.5+2.5:Qe?(He=(V+5)*((n(_)?3:2)+L-10+1-P[0][3].length)-5,P[0][3].indexOf("backspace")!=-1&&(He-=V/2)):He=V,Ue=new t.Rectangle(He,V,r,k,v,b,null,null,null,!1).cur().addTo(Oe),dt&&Ue.addChild(new t.Rectangle(He,V,"black",null,null,b,null,null,null,!1).alp(x)),ct?Ue.label=Ne=new t.Label({text:"",backgroundColor:"ignore",font:d.font!=null?d.font:null,style:!1}):Ue.label=Ne=new t.Label({lineWidth:10,lineHeight:25,font:d.font!=null?d.font:null,text:Re[$e][Mt],color:i,align:"center",style:!1}),ct){var Ct=ct.clone(),xt;Re[$e][Mt]=="numpad"?(xt=60,ae=Ue):xt=70,Ct.scaleTo(Ue,xt,xt),Ct.centerReg(Ue)}ot?(ot=!1,rt+=67.33):(Ne.centerReg(Ue).mov(0,isNaN(Ne.text)?3:7),Ue.x=rt,Ue.y=me,Ue.na=Re[$e][Mt],$e==2&&Mt==0&&Te==z.number1&&(Ue.toggle="1/2"),$e==2&&Mt==0&&Te==z.number2&&(Ue.toggle="2/2"),$e==3&&Mt==0&&Te==z.def&&(Ue.toggle="?123"),$e==3&&Mt==0&&Te!=z.def&&(Ue.toggle="ABC"),Ue.toggle&&Ne.mov(0,3),fe.push(Ue),Ue.na=="shift"&&(ce=Ue),rt=Ue.x+Ue.width+5)}me+=V+5,rt=0}Oe.cache(v?-v:0,v?-v:0,v?Oe.width+v*2:Oe.width,v?Oe.height+v*2:Oe.height)}function Me(Te){var Re=P[3][Te],Ne=!1,Ue=!1,rt;rt=t.timeout(500,at,null,"ms");var me=u.on("pressup",He);function He(){Ne=!0,u.off("pressup",me),Ue||Pe(Te)}function at(){var Qe,ct,ot,dt=0,$e;if(rt.clear(),!Ne){Ue=!0,K=new t.Container(1e3,V,null,null,!1).addTo(u,0),K.y=-V-5;for(var Mt=0;Mt<Re.length;Mt++)se===z.shift?$e=Re[Mt].toUpperCase():$e=Re[Mt],Qe=new t.Label({lineWidth:10,lineHeight:25,text:$e,font:d.font!=null?d.font:null,color:i,align:"center",style:!1}),ct=new t.Rectangle(V,V,r,k,v,b,null,null,null,!1).addTo(K),ot=new t.Rectangle(V,V,"white",null,null,b,null,null,null,!1).alp(.2),ct.addChild(ot),Qe.center(ct),ct.na=Re[Mt],ct.x=dt,dt+=V+5;u.stage&&u.stage.update()}}}function _e(){xe=new t.Shape({style:!1}),xe.graphics.f(i).p("AhIFoIAAjYIixAAID5n3ID6H3IixAAIAADYgAjHBxICeAAIAADYIBTAAIAAjYICeAAIjImSg"),xe.setBounds(-51/2,-72/2,51,72),ke=new t.Container({style:!1});var Te=new t.Shape({style:!1});Te.graphics.f(i).p("ACgC+IigigIifCgQgGAGgJAAQgJAAgGgGQgGgGgBgJQABgJAGgGICgigIigifQgGgGgBgJQABgJAGgGQAGgGAJAAQAIAAAHAGICfCgICgigQAGgGAJAAQAJAAAGAGQAGAGABAJQgBAJgGAGIigCfICgCgQAGAGABAJQgBAJgGAGQgGAGgJAAQgJAAgGgGg"),Te.setTransform(82.6,32),Te.addTo(ke);var Re=new t.Shape({style:!1});Re.graphics.f(i).s().p("AkhFAQgcAAgUgUIkHj6QgVgUAAgeQAAgdAVgVIEHj6QAUgTAcAAINKAAQAdAAAUAUQAUAUAAAdIAAH1QAAAdgUATQgUAVgdAAgAk0kOIkGD8QgIAHAAALQAAALAIAIIEGD7QAIAHALAAINKAAQALAAAIgIQAHgHAAgLIAAn1QAAgLgHgIQgIgIgLAAItKAAQgLAAgIAHg"),Re.setTransform(62.2,32),Re.addTo(ke),ke.setBounds(0,0,125,64),te=new t.Container({style:!1}),te.setBounds(0,0,147,86);for(var Ne=[{p:"Ai+heIF9AAIi/C9g",transform:[73.4,76]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.4,43.2]},{p:"AnNAzIAAhlIObAAIAABlg",transform:[73,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.2,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.5,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.8,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[87.1,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.4,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.7,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.3,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.6,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[86.9,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.2,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.5,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]},{p:"AphEnQgzAAgkgkQglglAAgzIAAlVQAAgzAlglQAkgkAzAAITDAAQAzAAAkAkQAlAlAAAzIAAFVQAAAzglAlQgkAkgzAAgAqjjtQgcAcAAAnIAAFVQAAAnAcAbQAbAcAnAAITDAAQAnAAAcgcQAbgbAAgnIAAlVQAAgngbgcQgcgcgnAAIzDAAQgnAAgbAcg",transform:[73.4,29.5]}],Ue,rt=0;rt<Ne.length;rt++)Ue=new t.Shape({style:!1}),Ue.graphics.f(i).s().p(Ne[rt].p),Ue.setTransform(Ne[rt].transform[0],Ne[rt].transform[1]),Ue.addTo(te);pe=new t.Container({style:!1}),pe.setBounds(0,0,62,86),he=new t.Container({style:!1}),he.setBounds(0,0,62,86);for(var me=[{p:"Ai+heIF9AAIi/C9g",transform:[33,76,1,1,180]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]}],rt=0;rt<me.length;rt++){var He=new t.Shape({style:!1});He.graphics.f(i).s().p(me[rt].p),He.setTransform(me[rt].transform[0],me[rt].transform[1],me[rt].transform[2],me[rt].transform[3],me[rt].transform[4]),He.addTo(pe);var at=new t.Shape({style:!1});at.graphics.f(i).s().p(me[rt].p),at.setTransform(me[rt].transform[0],me[rt].transform[1]),at.addTo(he)}He.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10),at.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10)}function Ye(){Ee=new t.Rectangle(V*1.5+2.5+2.5,V,r,k,v,b,null,null,null,!1).addTo(u,0).cur();for(var Te,Re=0;Re<4;Re++)Te=new t.Rectangle(Ee.width*.4,4,i,null,null,null,null,null,null,!1).centerReg(Ee).alp(.2),Te.y-=-22+Re*15;Ee.x=8.5*V+40,Ee.y=-V-5,Ee.na="drag"}function je(Te){u.numPad||(u.numPad=new t.NumPad({advanced:q,draggable:X}).sca(I),X||R?u.numPad.center({add:!1}):u.numPad.pos({x:0,y:8,horizontal:"center",vertical:"bottom",add:!1}),u.numPad.on("pressed",function(){u.numPad.key=="enter"?u.dispatchEvent("enter"):u.numPad.key=="backspace"?u.removeChar():u.numPad.key=="clear"?u.clearText():u.numPad.key=="space"?Pe(" "):Pe(u.numPad.key)}),u.numPad.on("close",function(){ae.removeChildAt(2),pe.clone().scaleTo(ae,60,60).centerReg(ae,2),Oe.updateCache(),(!u.keys.parent||!u.keys.visible)&&ge&&(ge.visible=!1,u.toggled=!1,ve())})),ae.removeChildAt(2),u.numPad.parent||Te===!1?(u.numPad.removeFrom(),pe.clone().scaleTo(ae,60,60).centerReg(ae,2)):(!u.numPad.parent||Te===!0)&&(u.numPad.addTo(),he.clone().scaleTo(ae,60,60).centerReg(ae,2)),Oe.updateCache(),u.stage&&u.stage.update()}function it(){u.mouseYAmount&&(u.y=u.parent.globalToLocal(0,u.mouseYAmount-ie).y)}function Be(){S.off("pressmousemove",u.tickerMouseEvent),t.Ticker.remove(it)}u.setBounds(1e3,400-(L-10)*26);function qe(){if(!(!G||!ge)){for(var Te=G.label.x+G.label.getBounds().x,Re=0;Re<le;Re++)Te+=G.widthArray[Re]?G.widthArray[Re]:0;ge.heightOnly=G.getBounds().height*(G.backing&&n(G.padding)?.9:1)-(G.paddingV&&G.background?G.paddingV*2:0),ge.center(G),ge.x=Te}}function et(){if(Ae||!G)return u;var Te=A?["<",">","x"]:["<",">"],Re,Ne,Ue;re=[],Ue=G.localToLocal(0,0,u),Ae=u.place=new t.Container({style:!1}).addTo(u).cur();for(var rt=0;rt<Te.length;rt++)Re=new t.Rectangle(V,V,s,k,v,b,null,null,null,!1),Te[rt]=="x"&&new t.Rectangle(V,V,"black",null,null,b,null,null,null,!1).alp(x).addTo(Re),Ne=new t.Label({lineWidth:10,text:Te[rt],backing:Re,font:d.font!=null?d.font:null,color:f,align:"center",valign:"center",style:!1}),Ne.pos(0,0,t.LEFT,t.TOP,Ae).cache(),Ne.x=Ne.x+rt*(V+5),re.push(Ne);Ue=G.localToLocal(0,0,u),Ae.x=Ue.x+C,Ae.y=Ue.y+G.height+15+O,Ae.on("click",me);function me(He){re.indexOf(He.target)==0?le>0&&le--:re.indexOf(He.target)==1?le<G.text.length&&le++:ve(),qe()}u.stage&&u.stage.update()}function ve(){if(!Ae)return u;Ae.dispose(),Ae=null}function Pe(Te){if(G){var Re,Ne;if(Te==="del")G&&(G.text=[G.text.slice(0,le-1),G.text.slice(le)].join("")),le--,Fe();else{se===z.shift&&(Te=Te.toUpperCase());var Ue=G.text;Re=G.clone().removeFrom(),Re.text=Te,Ne=Re.label.getMeasuredWidth(),G.widthArray?G.widthArray.splice(le,0,Ne):G.widthArray=[G.breedte],le<G.text.length?G.text=[G.text.slice(0,le),Te,G.text.slice(le)].join(""):G.text+=Te,G&&G.label.getBounds().width<F?(le++,qe()):G.text=Ue}se===z.shift&&!Q&&(u.removeChild(Oe),ee(),se=z.def),qe();var rt=new Ge.Event("keydown");rt.letter=Te,u.dispatchEvent(rt),u.stage&&u.stage.update()}}function oe(Te){if(u.stage){var Re,Ne=0,Ue=!1;G=Te.target,G.widthArrayCheck||Fe(),F=G.label.lineWidth?G.label.lineWidth:1e4,Re=G.globalToLocal(Te.stageX/t.scaX,Te.stageY/t.scaY),Re.x-=G.label.x,Re.y-=G.label.y;for(var rt=0;rt<G.widthArray.length;rt++)if(Ne+=G.widthArray[rt],Re.x<Ne-G.widthArray[rt]/2+G.label.getBounds().x){le=rt,Ue=!0;break}Ue||(le=G.text.length),qe(),y&&!Ae&&G.text.length>0&&et(),Ae&&G&&(G.text.length>0?(Re=G.localToLocal(0,0,u),Ae.x=Re.x+C,Ae.y=Re.y+G.height+15+O):ve())}}function Fe(){if(G){var Te=new t.Label("");G.widthArray=[];for(var Re=0;Re<G.text.length;Re++)Te=G.clone().removeFrom(),Te.text=G.text[Re],G.widthArray.push(Te.label.getMeasuredWidth());Te.text=G.text,G.widthArrayCheck=!0,qe()}}function Ze(Te){var Re=!0,Ne;function Ue(){(!G||G.text.length<1||u.currentIndex==0)&&(Re=!1),Re&&(rt(),Ne&&(Ne=t.timeout(200,Ue,null,"ms"))),G&&G.text.length<1&&me()}function rt(){G&&G.text.length>0?(u.selectedIndex>0&&Pe("del"),Te?me():u.on("pressup",me)):Pe("del")}function me(){Re=!1,Ne&&Ne.clear(),u.off("pressup",me)}rt(),Ne=t.timeout(300,Ue,null,"ms"),u.stage&&u.stage.update()}function Xe(){for(var Te=0;Te<e.length;Te++)e[Te].clickEvent=e[Te].on("click",oe)}Xe();function We(){if(e.length>1)for(var Te=0;Te<e.length;Te++)e[Te].off("click",e[Te].clickEvent)}function de(){if(!ge&&(G=e[0],F=G&&G.label.lineWidth?G.label.lineWidth:1e4,G)){ge=new t.Rectangle(3,G.height-(G.paddingV&&G.background?G.paddingV*2:0),c,null,null,null,null,null,null,!1).center(G),ge.x=0,ge.visible=!1,ge.animate({obj:{alpha:0},rewind:!0,loop:!0,loopWait:750,time:250,id:"knipperTekst",timeUnit:"ms"});for(var Te=0;Te<e.length;Te++)e[Te].widthArray=[0];Fe()}}de();function Ve(){t.stopAnimate("knipperTekst"),G&&G.removeChild(ge),ge=null,G=null}Object.defineProperty(this,"selectedLabel",{get:function(){return G},set:function(Te){var Re={target:Te};oe(Re),u.hidePlace()}}),Object.defineProperty(this,"selectedIndex",{get:function(){return le},set:function(Te){le=Te,qe()}}),this.show=function(Te,Re){if(u.addTo(w),!n(Te)){var Ne={target:e[Te]};oe(Ne)}return ge&&(ge.visible=!0),u.toggled=!0,R?je():(!R||Re)&&(u.keys.vis(!0),be.vis(!0)),u.numPad&&u.numPad.parent&&u.numPad.top(),u},this.hide=function(){return u.removeFrom(w),je(!1),ge&&(ge.visible=!1),S.update(),u.toggled=!1,u},this.showNumPad=function(){je(!0),u.toggled=!0,ge&&(ge.visible=!0)},this.hideNumPad=function(){je(!1),(!u.keys.parent||!u.keys.visible)&&ge&&(ge.visible=!1,u.toggled=!1,ve())},this.showKeyboard=function(){u.show(null,!0)},this.hideKeyboard=function(){!u.numPad||!u.numPad.parent?u.hide():(u.keys.vis(!1),be.vis(!1))},this.toggle=function(Te){return Te===!0?u.show():Te===!1||u.parent?u.hide():u.show(),u},this.showPlace=function(){return et(),u},this.hidePlace=function(){return ve(),u},this.addLabels=function(Te){Array.isArray(Te)||(Te=[Te]);for(var Re=Te.length-1;Re>=0;Re--){var Ne=e.indexOf(Te[Re]);Ne>=0||Te[Re].type!="Label"?Te.splice(Re,1):Te[Re].widthArray=[0]}return We(),e=e.concat(Te),Xe(),de(),ge&&(ge.visible=!0),u},this.removeLabels=function(Te){Array.isArray(Te)||(Te=[Te]),We();for(var Re=0;Re<Te.length;Re++){var Ne=e.indexOf(Te[Re]);Ne>=0&&e.splice(Ne,1)}return Xe(),e.length==0?G&&Ve():G&&e.indexOf(G)==-1&&(Ve(),de()),u};var be=new t.Rectangle(this.width,this.height,t.clear,null,null,null,null,null,null,!1).addTo(this).expand().bot();be.on("mousedown",function(){}),be.on("click",function(){}),R&&be.vis(!1),this.resize=function(){if(u.scaleTo(S,100-g*2/S.width*100,50-g*2/S.height*100),u.y=S.height-u.height-g,u.x=S.width/2-u.width/2,G&&Ae){var Te=G.localToLocal(0,0,u);Ae.x=Te.x,Ae.y=Te.y+G.height+15}return u.stage&&u.stage.update(),u},this.resize(),u.selectedLabel&&(u.selectedIndex=u.selectedLabel.text.length),m&&(this.keydownEvent=function(Te){if(u.stage){var Re=u;n(Re)||(Te.keyCode==35&&(Re.selectedIndex=Re.selectedLabel.text.length),Te.keyCode==36&&(Re.selectedIndex=0),Te.keyCode==37&&(Re.selectedIndex=Re.selectedIndex-1),Te.keyCode==39&&(Re.selectedIndex=Re.selectedIndex+1),Te.keyCode==46&&Re.selectedIndex<Re.selectedLabel.text.length&&(Re.selectedIndex=Re.selectedIndex+1,Re.removeChar()),Te.keyCode==8&&(Te.preventDefault(),Re.removeChar()),Re.addChar(Te.key),u.stage&&u.stage.update())}},j.addEventListener("keydown",this.keydownEvent)),J!==!1&&t.styleTransforms(this,d),this.clone=function(){var Te=new t.Keyboard(e,r,i,l,a,s,c,x,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,this.group,ne);return u.cloneProps(Te)},this.dispose=function(Te,Re,Ne){be.removeAllEventListeners(),be=null,u.keydownEvent&&j.removeEventListener("keydown",u.keydownEvent);for(var Ue=0;Ue<u.labels.length;Ue++)u.labels[Ue].removeAllEventListeners();return u.numPad&&u.numPad.dispose(),ge&&ge.dispose(),u.labels=G=null,S&&S.off("pressmousemove",u.tickerMouseEvent),Ne||u.zimContainer_dispose(!0),!0}},t.extend(t.Keyboard,t.Container,["clone","dispose"],"zimContainer",!1),t.Organizer=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I){var X="width, list, useAdd, useRemove, usePosition, autoAdd, autoRemove, autoPosition, addForward, removeForward, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, spacing, corner, keyEnabled, gradient, gloss, backdropColor, style, group, inherit",R;if(R=st(t.Organizer,arguments,X,this))return R;De("67.3"),this.group=$;var q=m===!1?{}:t.getStyle("Organizer",this.group,I);if(n(e)&&(e=q.width!=null?q.width:r&&r.vertical?r.width:300),n(i)&&(i=q.useAdd!=null?q.useAdd:!0),n(l)&&(l=q.useRemove!=null?q.useRemove:!0),n(a)&&(a=q.usePosition!=null?q.usePosition:!0),n(s)&&(s=q.autoAdd!=null?q.autoAdd:i),n(f)&&(f=q.autoRemove!=null?q.autoRemove:l),n(c)&&(c=q.autoPosition!=null?q.autoPosition:a),n(x)&&(x=q.addForward!=null?q.addForward:!0),n(k)&&(k=q.removeForward!=null?q.removeForward:!0),n(v)&&(v=q.backgroundColor!=null?q.backgroundColor:t.tin),n(g)&&(g=q.rollBackgroundColor!=null?q.rollBackgroundColor:t.grey),n(b)&&(b=q.selectedBackgroundColor!=null?q.selectedBackgroundColor:t.dark),n(A)&&(A=q.color!=null?q.color:t.white),n(T)&&(T=q.rollColor!=null?q.rollColor:A),n(h)&&(h=q.selectedColor!=null?q.selectedColor:A),n(w)&&(w=q.selectedRollColor!=null?q.selectedRollColor:A),n(P)&&(P=q.spacing!=null?q.spacing:1),n(y)&&(y=q.corner!=null?q.corner:0),n(O)&&(O=q.gradient!=null?q.gradient:.2),n(_)&&(_=q.gloss!=null?q.gloss:null),n(Y)&&(Y=q.backdropColor!=null?q.backdropColor:null),Array.isArray(y)||(y=[y,y,y,y]),!(!i&&!a&&!l)){var J=(i?1:0)+(a?4:0)+(l?1:0),Z=(e+P)/J,ne={width:Z,height:Z,label:"",shadowColor:-1,gradient:O,corner:y,backgroundColor:v,rollBackgroundColor:g},U=[],B=new t.Shape;if(B.graphics.f(A).p("AAAA4Ih6B8Ig5g4IB8h8Ih7h6IA4g5IB6B8IB7h8IA5A5Ih8B6IB8B7Ig5A5g"),i&&U.push(new t.Button({icon:B.sca(.55).rot(-45).reg(1),inherit:ne})),a){var d=new t.Shape;d.graphics.f(A).p("AiJieIETCeIkTCfg"),U.push(new t.Button({icon:d.sca(.6).rot(r&&!r.vertical?180:-90).reg(-2),inherit:ne})),U.push(new t.Button({icon:d.clone().sca(.6).rot(r&&!r.vertical?0:90).reg(-2),inherit:ne}));var u=new t.Shape;u.graphics.f(A).p("AiFCLIAAkVIBXAAIAAEVgAgiAAICoiHIAAEQg"),U.push(new t.Button({icon:u.sca(.62).rot(r&&!r.vertical?0:90).reg(0),inherit:ne})),U.push(new t.Button({icon:u.clone().sca(.62).rot(r&&!r.vertical?180:-90).reg(0),inherit:ne}))}l&&U.push(new t.Button({icon:B.clone().rot(0).sca(.55),inherit:ne})),U.length==0&&(U=[""]),this.zimTabs_constructor(e,Z,U,v,g,null,b,E,A,T,null,h,w,!1,P,!0,!1,y,null,!0,O,_,null,null,null,null,null,null,null,null,null,null,Y);var o=this;o.list=r,o.type="Organizer",o.setButtons=function(){if(a){var p=i?1:0;U[p+0]&&(U[p+0].icon.rotation=o.list&&!o.list.vertical?180:-90),U[p+1]&&(U[p+1].icon.rotation=o.list&&!o.list.vertical?0:90),U[p+2]&&(U[p+2].icon.rotation=o.list&&!o.list.vertical?0:90),U[p+3]&&(U[p+3].icon.rotation=o.list&&!o.list.vertical?180:-90)}};var S=!1,F=r;o.change(function(p){(!S&&o.list||o.list&&o.list!=F)&&(o.list!=F&&F&&F.noChange(),o.list.change(function(){o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex}),S=!0,F=o.list);var L=p.target.selectedIndex;i||L++,!a&&(!i||L>0)&&(L=5);var we=n(o.list.selectedIndex)||o.list.selectedIndex<0;we&&(o.currentValue=null),o.lastIndex=o.list.selectedIndex;var D;switch(L){case 0:s&&(D=Math.max(0,o.list.selectedIndex),o.add(D)),o.orgType="add";break;case 1:if(we)break;c&&(D=o.list.selectedIndex,o.up(D)),o.orgType="up";break;case 2:if(we)break;c&&(D=o.list.selectedIndex,o.down(D)),o.orgType="down";break;case 3:if(we)break;c&&(D=o.list.selectedIndex,o.toTop(D)),o.orgType="top";break;case 4:if(we)break;c&&(D=o.list.selectedIndex,o.toBottom(D)),o.orgType="bottom";break;case 5:if(we)break;f&&(D=o.list.selectedIndex,o.remove(D)),o.orgType="remove";break}}),this.add=function(p,L,we){return n(p)&&(p=o.lastIndex),n(L)&&(L=""),x?p=Math.min(o.list.length,Math.max(0,o.list.selectedIndex)+1):p=Math.max(0,o.list.selectedIndex),o.list.addAt(L,p,we),o.list.selectedIndexPlusPosition=p,o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},this.up=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];return n(L)||(o.list.removeAt(1,p),o.list.addAt(L,p-1),o.list.selectedIndexPlusPosition=Math.max(0,p-1),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.down=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];return n(L)||(o.list.removeAt(1,p),o.list.addAt(L,p+1),o.list.selectedIndexPlusPosition=Math.min(o.list.length-1,p+1),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.toTop=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];return n(L)||(o.list.removeAt(1,p),o.list.addAt(L,0),o.list.first(),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.toBottom=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];if(!n(L))return o.list.removeAt(1,p),o.list.addAt(L,o.list.length),o.list.last(),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},this.remove=function(p){if(n(p))if(o.list.selectedIndex>=0)p=o.list.selectedIndex;else return o;var L=p==o.list.selectedIndex;return o.removedItem=o.list.items[p],o.list.removeAt(1,p),L?k||(p=Math.max(0,p-1)):p=o.list.selectedIndex,o.list.selectedIndexPlusPosition=Math.min(o.list.length-1,p),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},m!==!1&&t.styleTransforms(this,q),this.clone=function(){return o.cloneProps(new t.Organizer(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,o.group,I))},this.dispose=function(p,L,we){return U=null,we||o.zimTabs_dispose(!0),!0}}},t.extend(t.Organizer,t.Tabs,["clone","dispose"],"zimTabs",!1),t.Connectors=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u){var o="width, height, points, node, line, linear, linearWrap, linearOrder, num, snapH, snapV, dropType, dropArray, continuous, startIndex, duplicateLine, deleteNode, dblclick, fullMove, min, max, boundary, expand, nodeRollColor, nodeRollBorderColor, nodeSelectedColor, nodeSelectedBorderColor, baseColor, baseBorderColor, baseRollover, rootLock, grandChildren, dblclickTime, steps, style, group, inherit",S;if(S=st(t.Connectors,arguments,o,this))return S;De("67.39"),this.group=d;var F=B===!1?{}:t.getStyle("Connectors",this.group,u);n(e)&&(e=F.width!=null?F.width:null),n(r)&&(r=F.height!=null?F.height:null),this.zimContainer_constructor(null,null,null,null,!1),this.type="Connectors",n(i)&&(i=F.points!=null?F.points:[[0,0],[100,0],[100,100],[0,100]]),n(l)&&(l=F.node!=null?F.node:new t.Circle(10,t.grey,t.grey)),l.removeFrom(),l.color==t.clear&&!l.hitArea&&l.expand(0),n(a)&&(a=F.line!=null?F.line:new t.Line({length:10,thickness:3,color:t.tin,strokeObj:{caps:"round"}})),n(x)&&(x=F.num!=null?F.num:10),n(s)&&(s=F.linear!=null?F.linear:!1),n(f)&&(f=F.linearWrap!=null?F.linearWrap:!0),n(Y)&&(Y=F.nodeRollColor!=null?F.nodeRollColor:l.color.match("rgb")?l.color:l.color.lighten(.2)),n(m)&&(m=F.nodeRollBorderColor!=null?F.nodeRollBorderColor:l.borderColor),n($)&&($=F.nodeSelectedColor!=null?F.nodeSelectedColor:t.white),n(I)&&(I=F.nodeSelectedBorderColor!=null?F.nodeSelectedBorderColor:l.borderColor),n(X)&&(X=F.baseColor!=null?F.baseColor:l.color),n(R)&&(R=F.baseBorderColor!=null?F.baseBorderColor:l.borderColor),n(q)&&(q=F.baseRollover!=null?F.baseRollover:!1),n(y)&&(y=F.min!=null?F.min:l.radius?l.radius*2:Math.min(l.width,l.height)),n(C)&&(C=F.max!=null?F.max:null),n(_)&&(_=F.expand!=null?F.expand:t.mobile()?10:0),n(g)&&(g=F.dropType!=null?F.dropType:"any"),n(b)&&(b=F.dropArray!=null?F.dropArray:null),n(E)&&(E=F.continuous!=null?F.continuous:!1),n(A)&&(A=F.startIndex!=null?F.startIndex:null),n(T)&&(T=F.duplicateLine!=null?F.duplicateLine:!0),n(h)&&(h=F.deleteNode!=null?F.deleteNode:!0),n(w)&&(w=F.dblclick!=null?F.dblclick:!0),n(P)&&(P=F.fullMove!=null?F.fullMove:!0),n(ne)&&(ne=F.dblclickTime!=null?F.dblclickTime:.5);var p=Tt(ne);if(ne*=p=="s"?1e3:1,n(k)&&(k=F.snapH!=null?F.snapH:null),n(v)&&(v=F.snapV!=null?F.snapV:null),n(J)&&(J=F.rootLock!=null?F.rootLock:!1),n(Z)&&(Z=F.grandChildren!=null?F.grandChildren:!0),n(U)&&(U=F.steps!=null?F.steps:null),s&&i.length<=1){pt&&tt("Connector() - linear needs more than one point");return}var L=this,we=0;L.node=l,L.line=a;var D=[],N=l.color,ue=l.borderColor,fe=L.lines=new t.Container(e,r).addTo(L),V=L.nodes=new t.Container(e,r).addTo(L);if(i.type=="Blob"||i.type=="Squiggle"){var z=[];t.loop(i.points,function(Be){z.push([Be[0],Be[1]])}),i=z}L.points=i,this.addNode=function(Be,qe,et){if(!s)return se(Be,qe,et)};function se(Be,qe,et,ve){if(Be.addChild){g="on",J=!0,Z=!1,et=Be,et.connectorMoveEvent||(L.bases||(L.bases=[]),L.bases.push(et),et.connectorMoveEvent=et.on("pressmove",function(){et.positionConnectors(et,!0,!0)}),et.connectorUpEvent=et.on("pressup",function(){et.positionConnectors(et,!0,!0)}),q&&(et.connectorOverEvent=et.on("mouseover",function(){Ee(et)}),et.connectorOutEvent=et.on("mouseout",function(){ie(et)})),et.positionConnectors=function(Ze,Xe,We){t.loop(Ze.connectors,function(de){var Ve=Ze.parent.localToLocal(Ze.x-Ze.baseStart.x+de.nodeStart.x,Ze.y-Ze.baseStart.y+de.nodeStart.y,de.parent);de.x=Ve.x,de.y=Ve.y,Ye(de,Xe,We)}),Ze.stage&&Ze.stage.update()},et.setConnectorColors=function(Ze,Xe,We,de){return n(Ze)||(et.connectorColor=Ze),n(Xe)||(et.connectorBorderColor=Xe),n(We)||(et.connectorRollColor=We),n(de)||(et.connectorRollBorderColor=de),t.loop(et.connectors,function(Ve){n(Ze)||(Ve.color=Ze),n(Xe)||(Ve.borderColor=Xe)}),et},et.setConnectorColors(X,R,Y,m));var Pe=et.getBounds();a.endHead,Array.isArray(qe)||(qe=[qe,qe]);var oe=[];return qe.length==2&&(qe=[qe[0],qe[1],qe[0],qe[1]]),(a.lineOrientation==t.HORIZONTAL||a.lineOrientation=="auto")&&t.loop([qe[0],qe[1]],function(Ze,Xe){if(Ze==-1||Ze==-2){var We=et.localToLocal(Xe==0?Pe.x:Pe.x+Pe.width,Pe.y,L);oe.push([We.x,We.y,t.HORIZONTAL])}if(Ze==-1||Ze==-3){var de=et.localToLocal(Xe==0?Pe.x:Pe.x+Pe.width,Pe.y+Pe.height,L);oe.push([de.x,de.y,t.HORIZONTAL])}Ze>0&&t.loop(Ze,function(Ve,be){var Te=et.localToLocal(Xe==0?Pe.x:Pe.x+Pe.width,Pe.y+Pe.height*(Ve+1)/(be+1),L);oe.push([Te.x,Te.y,t.HORIZONTAL])})}),(a.lineOrientation==t.VERTICAL||a.lineOrientation=="auto")&&t.loop([qe[2],qe[3]],function(Ze,Xe){if(Ze==-1||Ze==-2){var We=et.localToLocal(Pe.x,Xe==0?Pe.y:Pe.y+Pe.height,L);oe.push([We.x,We.y,t.VERTICAL])}if(Ze==-1||Ze==-3){var de=et.localToLocal(Pe.x+Pe.width,Xe==0?Pe.y:Pe.y+Pe.height,L);oe.push([de.x,de.y,t.VERTICAL])}Ze>0&&t.loop(Ze,function(Ve,be){var Te=et.localToLocal(Pe.x+Pe.width*(Ve+1)/(be+1),Xe==0?Pe.y:Pe.y+Pe.height,L);oe.push([Te.x,Te.y,t.VERTICAL])})}),et.connectors=[],et.baseStart=new t.Point(et.x,et.y),t.loop(oe,function(Ze){var Xe=se(Ze[0],Ze[1],et,Ze[2]);Se(et,Xe)}),setTimeout(function(){et.positionConnectors(et,!0,!0)},50),L}var Fe=l.clone().loc(Be,qe,V).drag({boundary:O}).expand(_);return Fe.orientation=ve,Fe.nodeColor=Fe.color,Fe.on("mouseover",ge),Fe.on("mouseout",Q),Fe.on("mousedown",xe),Fe.on("pressmove",ke),Fe.on("pressup",te),h&&Fe.hold(K),Fe.nodeNum=we++,Fe.creations=[],Fe}function Oe(){t.loop(i,function(Be,qe){var et=se(Be[0],Be[1]);et.dropIndex=qe,b&&(et.dropArray=b[qe])}),s&&V.loop(function(Be,qe,et){qe==0?(f?Be.before=V.getChildAt(et-1):Be.before=null,Be.after=V.getChildAt(qe+1)):qe==et-1?(f?Be.after=V.getChildAt(0):Be.after=null,Be.before=V.getChildAt(qe-1)):(Be.before=V.getChildAt(qe-1),Be.after=V.getChildAt(qe+1)),c&&qe>0&&Be.noMouse()})}Oe(),L.setAvailableIndexes=function(Be){return Array.isArray(Be)||(Be=[Be]),L.nodes.loop(function(qe,et){Be.indexOf(et)==-1?qe.noMouse():qe.mouse()}),L},n(A)||L.setAvailableIndexes(A),L.keyEvent=function(Be){h&&Be.keyCode==46&&(t.loop(ce,function(qe){qe&&qe.parent&&je(qe)}),L.stage&&L.stage.update())},j.addEventListener("keydown",L.keyEvent);function K(Be){var qe=Be.target.stage,et=Be.target;L.bases||J&&!et.creator.creator||(et.adding?je(et.creator):je(et),L.stage&&L.stage.update())}function ge(Be){var qe=Be.target;qe.selected||(qe.color=qe.base?qe.base.connectorRollColor:Y,qe.borderColor=qe.base?qe.base.connectorRollBorderColor:m,L.stage&&L.stage.update())}function Q(Be){var qe=Be.target;qe.selected||(qe.color=qe.base?qe.base.connectorColor:qe.nodeColor,qe.borderColor=qe.base?qe.base.connectorBorderColor:ue,L.stage&&L.stage.update())}var ce=[],G,le=0,Ae,re;function xe(Be,qe,et,ve){var Pe=Be.target;if(!n(Pe)&&(et&&(Pe.selected=!0,ce=[],L.selectNode(Pe,!ve)),re=Pe.nodeNum,!s&&(!J||Pe.creator)&&w&&!qe&&(le==0&&(Ae=setTimeout(function(){if(le=0,ce){var Xe=L.stage?L.stage.frame:j.zdf,We=V.loop(function(de){if(de.hitTestPoint(Xe.mouseX,Xe.mouseY)&&de.selected)return!1});We&&_e()}},ne)),le++),Pe.startX=Pe.x,Pe.startY=Pe.y,!s&&ce.length>0&&t.loop(ce,function(Xe){Xe.startX=Xe.x,Xe.startY=Xe.y}),!(Pe.creations.length>=x||Pe.selected||Pe.creator&&!Z))){Pe.adding=!0;var oe=se(Pe.x,Pe.y).bot();oe.creations=Pe.creations,oe.creatorLine=Pe.creatorLine,oe.creator=Pe.creator,oe.orientation=Pe.orientation,oe.startX=Pe.startX,oe.startY=Pe.startY,oe.dropIndex=Pe.dropIndex,oe.dropArray=Pe.dropArray,oe.lineArray=Pe.lineArray,oe.color=oe.nodeColor=Pe.nodeColor;var Fe=oe.nodeNum;if(oe.nodeNum=Pe.nodeNum,Pe.nodeNum=Fe,Pe.base&&(oe.base=Pe.base,oe.baseStart=Pe.baseStart,oe.nodeStart=Pe.nodeStart,oe.connectors=Pe.connectors,Pe.base=Pe.baseStart=Pe.nodeStart=Pe.connectors=null,oe.base.connectors&&oe.base.connectors.splice(oe.base.connectors.indexOf(Pe),1,oe),oe.color=oe.base.connectorColor,oe.borderColor=oe.base.connectorBorderColor),oe.before=Pe.before,oe.after=Pe.after,oe.before&&(oe.before.after=oe),oe.after&&(oe.after.before=oe),oe.creator){var Ze=oe.creator.creations.indexOf(Pe);Ze!=-1&&oe.creator.creations.splice(Ze,1,oe)}t.loop(oe.creations,function(Xe){Xe.creator=oe}),Pe.creator=oe,Pe.creatorLine=a.clone().setPoints(Pe.x,Pe.y,Pe.x,Pe.y).addTo(fe).alp(0),Pe.creatorLine.lineOrientation=Pe.orientation,Pe.creatorLine.node=Pe,Pe.creatorLine.creatorNode=oe,Pe.creations=[],Pe.veeObj&&!n(Pe.veeObj.color)?Pe.color=t.Pick.choose(Pe.veeObj.color):Pe.color=oe.color,Pe.nodeColor=Pe.color,oe.creations.push(Pe),L.latestNode=Pe}}function ke(Be,qe,et,ve){var Pe=Be.target;Pe.creatorLine&&Pe.creatorLine.alp(1),!s&&ce.length>0&&ce.indexOf(Pe)==-1&&_e(),Ye(Pe,!1,!0),L.bases&&t.loop(L.bases,function(oe){Pe.creator&&Pe.creator.base==oe||(!oe.connectorsOn&&Pe.hitTestBounds(oe)&&Ee(oe),oe.connectorsOn&&!Pe.hitTestBounds(oe)&&ie(oe))}),L.stage&&L.stage.update()}function te(Be,qe,et,ve){var Pe=Be.target;L.bases&&t.loop(L.bases,function(Ue){Ue!=Pe.base&&Ue.connectorsOn&&ie(Ue)});var oe=!1;if(!s&&le>1&&!qe){clearTimeout(Ae);var Fe=Pe.adding?Pe.creator:Pe;if(Pe.adding&&je(Fe.creations[Fe.creations.length-1],!0),!Fe.selected){var Ze=L.stage?L.stage.frame:j.zdf;ee(Fe,!Ze.ctrlKey)}le=0,oe=!0}if(!s&&!L.base&&(k&&(Pe.x=Math.round(Pe.x/k)*k),v&&(Pe.y=Math.round(Pe.y/v)*v)),y&&t.dist(Pe.x,Pe.y,Pe.startX,Pe.startY)<y||C&&t.dist(Pe.x,Pe.y,Pe.startX,Pe.startY)>C){Pe.adding?je(Pe,!0):(Pe.loc(Pe.startX,Pe.startY),oe||Ye(Pe)),L.stage&&L.stage.update(),L.lastNode=null,L.targetNode=null,L.dispatchEvent("noconnection");return}var Xe=!1,We=!1;if(s){var de=Pe.creator;if(L.connectionStart=de,L.connectionEnd=Pe,de.before&&Pe.hitTestCircle(de.before)&&!c)Pe.loc(de.before).removeFrom(),de.before.after=null,de.before.before||de.before.noMouse(),de.before=null,de.after||de.noMouse(),We=!0,Xe=Me();else if(de.after&&Pe.hitTestCircle(de.after))Pe.loc(de.after).removeFrom(),de.after.before=null,de.after.after||de.after.noMouse(),c&&de.after.mouse(),de.after=null,de.before||de.noMouse(),c&&de.noMouse(),We=!0,Xe=Me();else if(!de||Pe.creations.length>0)Pe.loc(Pe.startX,Pe.startY).bot();else{je(Pe,!0),L.stage&&L.stage.update(),L.lastNode=null,L.targetNode=null,L.dispatchEvent("noconnection");return}}else if(g=="off"){var Ve=V.loop(function(Ue){if(Pe!=Ue&&Pe.hitTestCircles(Ue)){Pe.adding?je(Pe,!0):(Pe.loc(Pe.startX,Pe.startY),Ye(Pe)),J&&Ce(Pe),!P&&Pe.creator&&x>0&&Pe.creator.creations.length>=x&&Pe.creator.noMouse(),L.targetNode=Ue,E&&L.nodes.loop(function(rt){rt!=L.latestNode&&rt.noMouse()}),E&&L.nodes.loop(function(rt){rt!=L.latestNode&&rt.noMouse()}),pe(),L.dispatchEvent("connection"),L.stage&&L.stage.update();return}});if(!Ve){ae(Pe);return}}else if(g=="on"||g=="single"){var be=0,Te,Re=V.loop(function(Ue){if(Pe!=Ue&&Pe.hitTestCircles(Ue)){if(Te=Ue,L.bases&&(Pe.orientation!=Ue.orientation||Pe.creator&&Pe.creator.base&&Pe.creator.base==Ue.base)||Pe.dropArray&&Pe.dropArray.indexOf(Ue.dropIndex)==-1||!T&&Pe.lineArray&&Pe.lineArray.indexOf(Ue.dropIndex)!=-1)return;if(g=="on")return!1;be++,be+=Ue.creations.length}});if(Re&&!(g=="single"&&be==1)){ae(Pe);return}else{if(Pe.loc(Te),Pe.creator&&Pe.orientation==t.VERTICAL&&Math.round(Pe.y)==Math.round(Pe.creator.startY)||Pe.creator&&Pe.orientation==t.HORIZONTAL&&Math.round(Pe.x)==Math.round(Pe.creator.startX))return;L.targetNode=Te;var Ne=Pe.dropIndex;Pe.dropIndex=Te.dropIndex,Pe.dropArray=t.copy(Te.dropArray),Te.lineArray?Te.lineArray.push(Ne):Te.lineArray=[Ne],Pe.lineArray=t.copy(Te.lineArray),Pe.creator&&(Pe.creator.lineArray||(Pe.creator.lineArray=[]),Pe.creator.lineArray.push(Pe.dropIndex)),Te.base&&Te.base.connectors&&Se(Te.base,Pe),We=!0}}else Pe.selected||(We=!0);!P&&Pe.creator&&x>0&&Pe.creator.creations.length>=x&&Pe.creator.noMouse(),Pe.adding=!1,Ye(Pe,!0,!0),t.loop(ce,function(Ue){if(ce.indexOf(Ue.creator)==-1){var rt=t.loop(Ue.creations,function(me){if(ce.indexOf(me)>=0)return!1});pe(Ue.nodeNum,null,t.decimals(Ue.x,2),t.decimals(Ue.y,2),rt||rt===void 0?1:0)}Ue.startX=Ue.x,Ue.startY=Ue.y}),Pe.startX=Pe.x,Pe.startY=Pe.y,J&&Ce(Pe),We?(E&&L.nodes.loop(function(Ue){Ue!=L.latestNode&&Ue.noMouse()}),pe(),L.dispatchEvent("connection"),t.arraysEqual(Pe.dropArray,Pe.lineArray,!1)&&L.dispatchEvent("blocked")):L.dispatchEvent("noconnection"),Xe&&L.dispatchEvent("complete"),L.stage&&L.stage.update()}function pe(Be,qe,et,ve,Pe){qe?D.push([Be,null,null,1]):n(et)?D.push([re,t.decimals(L.latestNode.x,2),t.decimals(L.latestNode.y,2)]):D.push([Be,null,null,null,et,ve,Pe])}L.makeConnection=function(Be,qe,et,ve,Pe){var oe=L.stage?L.stage.frame:j.zdf;return ve?(oe.ctrlKey=Pe==1,xe({target:Be},!0,!0,Pe),Be.loc(qe,et),ke({target:Be},!0,!0,Pe),te({target:Be},!0,!0,Pe)):(xe({target:Be},!0,!1,null),L.latestNode.loc(qe,et),ke({target:L.latestNode},!0,!1,null),te({target:L.latestNode},!0,!1,null)),oe.ctrlKey=!1,L.latestNode};function he(Be){var qe=L.nodes.loop(function(et){if(et.nodeNum==Be)return et});if(qe.type)return qe}L.setSteps=function(Be){return t.loop(Be,function(qe){var et=he(qe[0]);et&&(qe[3]?et&&je(et):n(qe[4])?L.makeConnection(et,qe[1],qe[2]):(L.makeConnection(et,qe[4],qe[5],!0,qe[6]),_e()))}),L},L.applySteps=L.setSteps,L.getSteps=function(Be){return Be&&(L.stage||(L.stage=zdf.stage),L.pane||(L.pane=new t.Pane({displayClose:!1,container:L.stage,width:Math.min(500,L.stage.width-20),height:Math.min(500,L.stage.height-20),draggable:!0}),L.textArea=new t.TextArea(Math.min(400,L.stage.width-70),Math.min(400,L.stage.height-70)).centerReg(L.pane)),L.pane.show(),L.textArea.text=JSON.stringify(D)),D},Object.defineProperty(this,"steps",{get:function(){return D},set:function(Be){L.setSteps(Be)}});function ae(Be){Be.adding||!Z?je(Be,!0):(Be.loc(Be.startX,Be.startY),Ye(Be)),J&&Ce(Be),Be.base&&Be.base.connectors&&Le(Be.base,Be),L.lastNode=null,L.targetNode=null,L.dispatchEvent("noconnection"),L.stage&&L.stage.update()}function Ee(Be){t.loop(Be.connectors,function(qe){qe.color=Be.connectorRollColor,qe.borderColor=Be.connectorRollBorderColor}),Be.connectorsOn=!0,Be.stage&&Be.stage.update()}function ie(Be){t.loop(Be.connectors,function(qe){qe.color=Be.connectorColor,qe.borderColor=Be.connectorBorderColor}),Be.connectorsOn=!1,Be.stage&&Be.stage.update()}function Se(Be,qe){Be.connectors.push(qe),qe.nodeStart=qe.parent.localToLocal(qe.x,qe.y,Be.parent),qe.nodeStart.x-=Be.x-Be.baseStart.x,qe.nodeStart.y-=Be.y-Be.baseStart.y,qe.base=Be}function Le(Be,qe){Be.connectors.splice(Be.connectors.indexOf(qe),1),qe.nodeStart=null,qe.base=null}function Ce(Be){if(Be.creator){if(Be.creator.creator){Ce(Be.creator);return}Be.creator&&Be.creator.creations.length>=x?Be.creator.noMouse():Be.creator.mouse()}}function ee(Be,qe){qe&&t.loop(Be.creations,function(et){ee(et,qe)}),Be.selected=!0,Be.color=Be.base?Be.base.connectorColor:$,Be.borderColor=Be.base?Be.base.connectorBorderColor:I,ce.push(Be),Be.top(),G||(G=L.stage.on("stagemousedown",function(){var et=L.stage?L.stage.frame:j.zdf,ve=V.loop(function(Pe){if(Pe.hitTestPoint(et.mouseX,et.mouseY))return!1});ve&&_e()}))}this.selectNode=function(Be,qe){ee(Be,qe)};function Me(){var Be=V.loop(function(qe){if(qe.before||qe.after)return!1});if(Be)return V.loop(function(qe){qe.noMouse()}),!0}function _e(){t.loop(ce,function(Be){Be.selected=!1,Be.color=Be.base?Be.base.connectorColor:Be.nodeColor,Be.borderColor=Be.base?Be.base.connectorBorderColor:ue}),ce=[],L.stage.off("stagemousedown",G),G=null,L.stage&&L.stage.update()}function Ye(Be,qe,et){var ve=ce.length>0?ce:[Be];t.loop(ve,function(Pe){Pe!=Be&&Pe.loc(Pe.startX+Be.x-Be.startX,Pe.startY+Be.y-Be.startY),Pe.creator&&Pe.creatorLine.setPoints(Pe.x,Pe.y,Pe.creator.x,Pe.creator.y,qe,et),t.loop(Pe.creations,function(oe){oe.creatorLine.setPoints(oe.x,oe.y,oe.creator.x,oe.creator.y,qe,et)})})}function je(Be,qe){if(t.loop(Be.creations,function(ve){je(ve)},!0),Be.creatorLine){Be.creatorLine.removeFrom();var et=Be.creator.creations.indexOf(Be);et!=-1&&Be.creator.creations.splice(et,1),!Be.creator.mouseEnabled&&!(J&&!Be.creator.creator)&&Be.creator.mouse()}return Be.removeFrom(),Be.removeAllEventListeners(),qe?we--:pe(Be.nodeNum,1),Be=null,L}this.removeNode=function(Be){je(Be)},this.removeConnectors=function(){t.loop(V,function(Be){je(Be)},!0),Oe(),L.stage&&L.stage.update()},this.removeBase=function(Be){t.loop(Be.connectors,function(qe){je(qe)}),it(Be)},this.addBase=function(Be,qe){se(Be,qe)};function it(Be){Be.off("pressmove",Be.connectorMoveEvent),Be.off("pressup",Be.connectorUpEvent),Be.connectorOverEvent&&Be.off("mouseover",Be.connectorOverEvent),Be.connectorOutEvent&&Be.off("mouseout",Be.connectorOutEvent),Be.connectors=null,Be.baseStart=null,Be.positionConnectors=Be.setConnectorColors=null,Be.connectorColor=Be.connectorBorderColor=Be.connectorRollColor=Be.connectorRollBorderColor=null,L.bases.splice(L.bases.indexOf(Be),1),L.stage&&L.stage.update()}U&&L.added(function(){L.setSteps(U),L.stage.update()}),Object.defineProperty(this,"selectedList",{get:function(){return ce},set:function(){pt&&tt("Selectors() - selectedList is read only")}}),this.dispose=function(Be,qe,et){return L.nodes.loop(function(ve){ve.removeFrom(),ve.removeAllEventListeners(),ve=null},!0),L.lines.loop(function(ve){ve.removeFrom(),ve=null},!0),j.removeEventListener("keydown",L.keyEvent),L.keyEvent=null,L.bases&&t.loop(L.bases,function(ve){it(ve)}),et||(L.zimContainer_dispose(!0),L.stage&&L.stage.update()),!0},B!==!1&&t.styleTransforms(this,F),this.clone=function(){return L.cloneProps(new t.Connectors(e,r,i,l,a,s,f,c,x,k,v,g,t.copy(b),E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,L.group,u))}},t.extend(t.Connectors,t.Container,["clone","dispose"],"zimContainer",!1),t.Marquee=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h){var w="width, height, items, time, transition, speed, direction, marginLeft, marginRight, marqueeType, borderColor, borderWidth, refresh, mix, style, group, inherit",P;if(P=st(t.Marquee,arguments,w,this))return P;De("67.4"),this.group=T;var y=A===!1?{}:t.getStyle("Marquee",this.group,h),C=this;n(e)&&(e=y.width!=null?y.width:300),n(r)&&(r=y.height!=null?y.height:100);var O=Tt(l);n(l)&&(l=y.time!=null?y.time:O=="s"?5:5e3),n(a)&&(a=y.transition!=null?y.transition:"slide"),n(v)&&(v=y.borderColor!=null?y.borderColor:t.dark),n(g)&&(g=y.borderWidth!=null?y.borderWidth:1),v<0||g<0?v=g=null:v!=null&&g==null&&(g=1),n(c)&&(c=y.marginLeft!=null?y.marginLeft:25),n(x)&&(x=y.marginRight!=null?y.marginRight:25),n(s)&&(s=y.speed!=null?y.speed:O=="s"?.5:500),Pt(s,O),n(f)&&(f=y.direction!=null?y.direction:"right"),n(b)&&(b=y.refresh!=null?y.refresh:O=="s"?30*60:30*60*1e3),n(E)&&(E=y.mix!=null?y.mix:!0),this.zimContainer_constructor(e+c+x,r,null,null,!1),this.type="Marquee",this.speed=s;var _=new t.Rectangle(e-1,r-1,t.clear).addTo(C).mov(c+.5,.5),Y=this.content=new t.Container(e,r).loc(c,0,C).setMask(_),m=this.pages=new t.Pages(null,a,s,null,Y).addTo(Y),$=!1;this.add=function(p,L,we,D,N){n(N)&&(N=!0),p.scaleTo(Y,100,100),L&&p.cur().on("click",function(){ir(L,we)}),m.addPage(p),N&&m.center(),p.marqueeViews=0,p.marquee=C,$||I(),D||B(),F&&F.top()},this.remove=function(p){if(C.selected==p){if(C.pages.pages.length==1)return;var L=C.selectedIndex+1;L==C.pages.pages.length&&(L=0),C.pages.go(L,null,null,0),setTimeout(function(){C.pages.removePage(p),p.dispose&&p.dispose(),B()},20)}else C.pages.removePage(p),p.dispose&&p.dispose(),B()};function I(){$=!0,C.selectedIndex=0,C.selected=m.pages[C.selectedIndex].page,C.lastSelected=null,C.selected.marqueeOn&&C.selected.marqueeOn(),C.interval=t.interval(l,function(){C.go()})}if(!n(i)&&!Array.isArray(i)&&(i=[i]),i&&i.length>0&&(E&&t.shuffle(i),t.loop(i,function(p){C.add(p,null,null,!0)})),b>0)var X=t.timeout(b*(O=="s"?1e3:1),function(){location.reload()},null,"ms");C.go=function(p){if(C.selected.marqueeViews+=1,C.selected.marqueeOff&&C.selected.marqueeOff(),p)C.selected=p,t.loop(m.pages,function(we,D){if(we.page==p){C.selectedIndex=D;return}}),C.interval.interval=C.selected.marqueeTime?C.selected.marqueeTime:l,C.interval.pause(ne.toggled,null,!0);else{var L=C.selectedIndex+1;C.selectedIndex=L%m.pages.length,C.selected=m.pages[C.selectedIndex].page,C.interval.time=C.selected.marqueeTime?C.selected.marqueeTime:l}C.dispatchEvent("page"),C.selected.marqueeOn&&C.selected.marqueeOn(),m.go(C.selected,f,a,s)},m.on("pagetransitioned",function(){C.dispatchEvent("pagetransitioned"),C.indicator&&(C.indicator.selectedIndex=C.selectedIndex)});var R=!1,q=C.left=new t.Container(c-4,r-4),J=new t.Shape().sca(.6);J.graphics.f(t.light).mt(0,0).p("AAhCLIAAkVIBXAAIAAEVgAh3CLIAAkVIBXAAIAAEVg");var Z=new t.Shape().sca(.6).reg(-2,0);Z.graphics.f(t.light).mt(0,0).p("AiJieIETCeIkTCfg");var ne=C.button=new t.Button({label:"",icon:J,toggleIcon:Z,width:45,height:45,corner:0,shadowBlur:0}).scaleTo(q,100).pos(0,0,!1,!0,q);ne.on("click",function(){C.interval&&C.interval.pause(ne.toggled),R=ne.toggled,C.stage.update()});var U;function B(){if(!(n(c)||c==0)){var p=4*c/25;q.pos(c-q.width-p,p/2,!1,!0,C),C.indicator&&(C.indicator.dispose(),C.indicator.removeFrom()),U||(U=new t.Proportion(8,16,q.width+p,q.width/2+p,-1)),C.indicator=new t.Indicator({width:(m.pages.length<=2?m.pages.length:m.pages.length-1)*(q.width-3),height:U.convert(m.pages.length),num:m.pages.length,shadowBlur:-1,interactive:!0,scale:1.2,indicatorType:k}),C.indicator.fit(0,0,r-ne.height,ne.width),C.indicator.rot(f=="down"?-90:90).center(q).pos(null,q.width-p/2,null,!0),C.indicator.selectedIndex=C.selectedIndex,C.indicator.on("change",function(){C.go(m.pages[C.indicator.selectedIndex].page)})}}if(B(),!n(x)&&x>0&&j.zdf&&j.zdf){var d=4*x/25,u=C.right=new t.Container(45,270),o=C.icon=j.zdf.makeIcon(t.grey,t.lighter,t.silver).sca(.5).pos(0,0,!0,!0,u).mov(0,0).cur();o.on("mouseover",function(){S.animate({props:{scaleX:1},time:500,ease:"backOut",override:!0,timeUnit:"ms"}),o.stage.update()}),o.on("mouseout",function(){S.animate({props:{scaleX:0},time:300,ease:"backIn",override:!0,timeUnit:"ms"}),o.stage.update()}),o.on("mousedown",function(){ir("https://zimjs.com/marquee","_blank")});var S=C.label=new t.Label({text:"MARQUEE",color:t.dark,backgroundColor:t.lighter,shiftV:1,paddingV:5}).rot(-90).pos(0,13,!0,!1,u).reg(-10).sca(0,1).mov(0);u.fit(0,0,x-d,r-d),u.pos(x-u.width-d,d/2,!0,!0,C)}if(C.stage&&C.stage.update(),this.pause=function(p,L){n(p)&&(p=!0),p!=R&&(R=p,C.interval.pause(p,L),C.button.toggle(p))},Object.defineProperty(this,"paused",{get:function(){return R},set:function(){pt&&tt("Marquee() - paused is read only - use pause()")}}),Object.defineProperty(this,"time",{get:function(){return l},set:function(p){l=p,C.interval.time=l}}),this.load=function(p,L){var we=[];E&&t.shuffle(p),t.loop(p,function(N){Array.isArray(N)?we.push(N[0]):we.push(N)});var D=C.stage?C.stage.frame:j.zdf;return C.marqueeLoader=D.loadAssets(we,L),C.loadEvent=C.marqueeLoader.on("assetload",function(N){var ue=p[N.asset.id],fe,V;Array.isArray(ue)?(fe=ue[0],V=ue[1]):(fe=ue,V="_self"),C.add(N.asset,fe,V),B()}),C},!n(v)){var F=new t.Rectangle(e-1,r-1,t.clear,v,g).loc(_,null,C);F.mouseEnabled=!1}A!==!1&&t.styleTransforms(this,y),this.clone=function(){return C.cloneProps(new t.Marquee(e,r,i,l,a,s,f,k,v,g,b,E,A,this.group,h))},this.dispose=function(p,L,we){return X&&X.clear(),C.interval&&C.interval.clear(),C.loadEvent&&C.marqueeLoader.off("assetload",C.loadEvent),m.dispose(),m=null,we||this.zimContainer_dispose(!0),!0}},t.extend(t.Marquee,t.Container,["clone","dispose"],"zimContainer"),t.Carousel=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C){var O="items, viewNum, time, spacing, backgroundColor, backing, padding, paddingH, paddingV, arrowLeft, arrowRight, arrowGap, valign, ease, swipe, remember, selectedIndex, continuous, style, group, inherit",_;if(_=st(t.Carousel,arguments,O,this))return _;De("67.45"),this.group=y;var Y=P===!1?{}:t.getStyle("Carousel",this.group,C),m=this;this.zimContainer_constructor(),n(e)&&(e=Y.items!=null?Y.items:[new Mn({color:red}),new Mn({color:orange}),new Mn({color:yellow}),new Mn({color:green}),new Mn({color:blue}),new Mn({color:purple}),new Mn({color:pink})]),n(a)&&(a=Y.backgroundColor!=null?Y.backgroundColor:t.clear),n(s)&&(s=Y.backing!=null?Y.backing:null),n(b)&&(b=Y.valign!=null?Y.valign:"center"),n(r)&&(r=Y.viewNum!=null?Y.viewNum:3),n(l)&&(l=Y.spacing!=null?Y.spacing:20),n(f)&&(f=Y.padding!=null?Y.padding:0),n(c)&&(c=Y.paddingH!=null?Y.paddingH:f),n(x)&&(x=Y.paddingV!=null?Y.paddingV:f),n(k)&&(k=Y.arrowLeft!=null?Y.arrowLeft:new t.Arrow().rot(180)),n(v)&&(v=Y.arrowRight!=null?Y.arrowRight:new t.Arrow),n(g)&&(g=Y.arrowGap!=null?Y.arrowGap:20);var $=Tt(i);n(i)&&(i=Y.time!=null?Y.time:$=="s"?.2:200),n(E)&&(E=Y.ease!=null?Y.ease:"quadInOut"),n(A)&&(A=Y.swipe!=null?Y.swipe:!0),n(T)&&(T=Y.remember!=null?Y.remember:"zimCarousel"),n(h)&&(h=Y.selectedIndex!=null?Y.selectedIndex:0),n(w)&&(w=Y.continuous!=null?Y.continuous:!0),T&&localStorage&&!n(localStorage[T])&&(localStorage[T]=="NaN"&&(localStorage[T]=0),h=Number(localStorage[T])),m.items=e,m.viewNum=r,m.spacing=l,m.arrowLeft=k,m.arrowRight=v,m.arrowLeft.oW=k.width,m.arrowRight.oW=v.width,s&&(m.backing=s);var I={};t.loop(e,function(o,S){typeof o=="string"&&(o=e[S]=new t.Pic(o)),o.reg(CENTER,CENTER);var F=I["width"+o.width];F?I["width"+o.width]+=1:I["width"+o.width]=1});var X=0,R=0;t.loop(I,function(o,S){S>X&&(X=S,R=Number(o.substring(5)))});var q=0;t.loop(e,function(o){o.width=R,o.height>q&&(q=o.height)});var J;w?(m.continuous=!0,J=t.copy(e),t.loop(e.length,function(o){J.push(e[o].duplicate())})):J=e,m.itemWidth=R,m.itemHeight=q;var Z=k.width+g+c,ne;function U(){var o=r*(R+l)-l,S=q;ne=o+c*2+g*2+k.width+v.width,m.setBounds(0,0,ne,S+x*2),m.tile=new t.Tile({obj:J,cols:J.length,spacingH:l,rows:1,unique:!0,align:"center",valign:b}).center(m).loc(Z),m.background=new Mn(o+c*2,S+x*2,a).center(m,0),m.tile.setMask(m.background)}function B(){k.pos(0,0,"left","center",m),v.pos(0,0,"right","center",m),k.on("mousedown",function(){m.cycleInterval&&(m.cycleClear(),m.dispatchEvent("cyclecleared")),m.goLeft()}),v.on("mousedown",function(){m.cycleInterval&&(m.cycleClear(),m.dispatchEvent("cyclecleared")),m.goRight()}),u()}function d(){if(m.swipe){var o=m.swipeObj=new t.Swipe(m.tile);o.on("swipe",function(S){S.swipeX!=0&&m.cycleInterval&&(m.cycleClear(),m.dispatchEvent("cyclecleared")),S.swipeX==1?m.goLeft():S.swipeX==-1&&m.goRight()})}}function u(){localStorage&&T&&(localStorage[T]=m.selectedIndex),k.activate(!0),v.activate(!0),!w&&(m.tile.x+m.tile.width<=ne-v.oW-c-g&&v.activate(!1),m.tile.x>=Z&&k.activate(!1))}m.goLeft=function(o){return n(o)&&(o=i),w&&m.tile.x>=-R&&(m.tile.x-=m.tile.width/2+l/2),m.tile.x<Z&&(m.disableArrows(),h--,m.tile.animate({props:{x:m.tile.x+R+l},time:o,ease:E,call:function(){u(),m.enableArrows(),m.dispatchEvent("transitioned")}})),m},m.goRight=function(o){return n(o)&&(o=i),w&&m.tile.x-R<=ne-m.tile.width&&(m.tile.x+=m.tile.width/2+l/2),m.tile.x+m.tile.width>ne-v.oW-c-g&&(m.disableArrows(),h++,m.tile.animate({props:{x:m.tile.x-R-l},time:o,ease:E,call:function(){u(),m.enableArrows(),m.dispatchEvent("transitioned")}})),m},m.cycleClear=function(){return m.cycleInterval.clear(),m.cycleInterval=null,m},m.cycle=function(o,S,F,p,L,we){var D="cycleTime, transitionTime, repeat, repeatNum, recycle, rtl",N;if(N=st(m.cycle,arguments,D))return N;n(o)&&(o=Y.cycleTime!=null?Y.cycleTime:$=="s"?5:5e3),n(S)&&(S=Y.transitionTime!=null?Y.transitionTime:$=="s"?1:1e3),n(F)&&(F=!0),n(p)&&(p=0),n(L)&&(L=o*2),n(we)&&(we=j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl");let ue=we?-1:1;return m.cycleInterval&&m.cycleInterval.clear(),L&&L!=-1&&(m.recycleEvent&&m.off("cyclecleared",m.recycleEvent),m.recycleWait&&m.recycleWait.clear(),m.recycleEvent=m.on("cyclecleared",function(){m.recycleWait&&m.recycleWait.clear(),m.recycleWait=zr(L,function(){m.cycle(o,S,F,p,L,we)})})),w?(m.repeatTotal=0,m.cycleInterval=t.interval(o*2,function(fe){if(m.selectedIndex==0)if(!F&&we)m.cycleInterval.clear();else{if(we&&fe.count!=1&&(m.repeatTotal+=1),we&&p!=0&&m.repeatTotal>=p){m.cycleInterval.clear(),m.dispatchEvent("repeatdone");return}ue==1?m.goRight(S):m.goLeft(S)}else if(m.selectedIndex==e.length-r){if(!we&&fe.count!=1&&(m.repeatTotal+=1),!we&&p!=0&&m.repeatTotal>=p){m.cycleInterval.clear(),m.dispatchEvent("repeatdone");return}m.repeatTotal>=1&&m.dispatchEvent("repeated"),!we&&!F?m.cycleInterval.clear():ue==1?m.goRight(S):m.goLeft(S)}else ue==1?m.goRight(S):m.goLeft(S)})):(m.repeatTotal=.5,m.cycleInterval=t.interval(o*2,function(fe){if(m.selectedIndex==0){if(fe.count!=1&&(m.repeatTotal+=.5),p!=0&&m.repeatTotal>p){m.cycleInterval.clear(),m.dispatchEvent("bouncedone");return}m.repeatTotal>=1&&m.dispatchEvent("bounced"),ue=1,m.goRight(S)}else if(m.selectedIndex==e.length-r){if(fe.count!=1&&(m.repeatTotal+=.5),p!=0&&m.repeatTotal>p){m.cycleInterval.clear(),m.dispatchEvent("bouncedone");return}m.repeatTotal>=1&&m.dispatchEvent("bounced"),ue=-1,m.goLeft(S)}else Yr(),ue==1?m.goRight(S):m.goLeft(S)})),m},m.enableArrows=function(){return m.swipeObj&&(m.swipeObj.active=!0),k.mouse(),v.mouse(),m},m.disableArrows=function(){return m.swipeObj&&(m.swipeObj.active=!1),k.noMouse(),v.noMouse(),m},Object.defineProperty(m,"selectedIndex",{get:function(){return(h+e.length)%e.length},set:function(o){h=t.constrain(o,0,e.length-r),m.tile.x=Z-h*(R+l),u()}}),Object.defineProperty(m,"swipe",{get:function(){return A},set:function(o){A=o,A&&!m.swipeObj&&d(),m.swipeObj.active=A}}),U(),B(),d(),s&&s.center(m,1),h&&(m.selectedIndex=h),this.dispose=function(o,S,F){return m.swipeObj&&m.swipeObj.dispose(),m.recycleEvent&&m.off("cyclecleared",m.recycleEvent),m.cycleWait&&m.cycleWait.clear(),m.cycleInterval&&m.cycleInterval.clear(),m.swipeObj=m.recycleEvent=m.cycleWait=null,F||this.zimContainer_dispose(),!0},P!==!1&&t.styleTransforms(this,Y),this.clone=function(){for(var o=[],S=0;S<e.length;S++){var F=e[S];F.duplicate?o.push(F.duplicate()):F.clone?o.push(F.clone()):o.push(t.copy(e[S]))}return m.cloneProps(new t.Carousel(o,r,i,l,a,s,f,c,x,k.duplicate(),v.duplicate(),g,b,E,A,T,h,w,P,this.group))}},t.extend(t.Carousel,t.Container,["clone","dispose"],"zimContainer",!1),t.Loader=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B){var d="width, height, label, type, backgroundColor, rollBackgroundColor, color, rollColor, borderColor, rollBorderColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, toggleBacking, rollToggleBacking, toggleIcon, rollToggleIcon, toggleEvent, frame, multiple, accept, style, group, inherit",u;if(u=st(t.Loader,arguments,d,this))return u;De("67.5"),this.group=U;var o=ne===!1?{}:t.getStyle("Loader",this.group,B);if(n(e)&&(e=o.width!=null?o.width:250),n(r)&&(r=o.height!=null?o.height:70),n(l)&&(l=o.type!=null?o.type:"image"),l=l.toLowerCase(),n(a)&&(a=o.backgroundColor!=null?o.backgroundColor:"rgba(0,0,0,.05)"),n(s)&&(s=o.rollBackgroundColor!=null?o.rollBackgroundColor:"rgba(0,0,0,.1)"),n(f)&&(f=o.color!=null?o.color:"rgba(0,0,0,.5)"),n(c)&&(c=o.rollColor!=null?o.rollColor:f),n(x)&&(x=o.borderColor!=null?o.borderColor:"rgba(0,0,0,.3)"),n(v)&&(v=o.borderWidth!=null?o.borderWidth:1),n(w)&&(w=o.dashed!=null?o.dashed:!0),n(g)&&(g=o.corner!=null?o.corner:0),n(J)&&(J=o.multiple!=null?o.multiple:!0),n(i)&&(i=o.label!=null?o.label:new t.Label({text:"UPLOAD PIC",color:f,rollColor:c,valign:"center",align:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group})),typeof q>"u")if(j.zdf)var q=j.zdf;else{pt&&tt("zim.Loader - please provide a reference to zim Frame");return}this.zimButton_constructor(e,r,i,a,s,null,f,c,null,x,v,k,null,P,y,null,O,_,null,g,w,b,E,T,h,null,null,null,null,null,A,null,null,null,C,Y,null,null,null,null,null,null,m,$,null,I,X,null,R,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!1),this.type="Loader";var S=this,F=q.stage;i=S.label;var p=S.tag=document.createElement("input");q.tag?q.tag.appendChild(p):document.body.appendChild(p),p.setAttribute("type","file"),p.setAttribute("aria-hidden",!0),J&&p.setAttribute("multiple","multiple"),Z&&p.setAttribute("accept",Z),p.hidden=!0,p.zimDisplay=p.style.display||"inline-block",p.style.cssText="border:thin solid grey; z-index:2; width:"+e+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none; cursor:pointer; opacity: 0; filter: alpha(opacity=0);",this.addEventListener("mousedown",function(){p.click()}),p.addEventListener("change",N);var L=new Ge.DOMElement(p);F.addChild(L),L.alpha=0;var we=q.retina&&j.devicePixelRatio||1;this.resize=function(V,z){if(!S.stage){p.setAttribute("aria-hidden",!0),p.hidden=!0,p.style.display="none";return}p.setAttribute("aria-hidden",!1),p.hidden=!1,p.style.display=p.zimDisplay,n(V)&&(V=!0),S.time1&&clearTimeout(S.time1),z||(S.time1=setTimeout(function(){S.resize(null,!0)},40));var se=S.getConcatenatedMatrix().decompose(),Oe=S.localToGlobal(0,0);if(q.retina){var K=t.browserZoom();q.tag?(L.x=Oe.x/we/K,L.y=Oe.y/we/K):(L.x=q.x/F.scaleX+Oe.x/we/K,L.y=q.y/F.scaleY+Oe.y/we/K),t.sca(L,se.scaleX/we/F.scaleX/K,se.scaleY/we/F.scaleY/K)}else L.x=q.x+Oe.x*q.scale,L.y=q.y+Oe.y*q.scale,t.sca(L,q.scale*se.scaleX,q.scale*se.scaleY);return F.update(),S},this.resize(),S.on("added",function(){p.style.display="block",p.hidden=!1,p.style.display="block",S.resize()}),S.added(D);function D(){S.resize(),S.time2=setTimeout(function(){p.style.display="block",p.hidden=!1,p.style.display="block"},50),S.on("added",D,null,!0)}S.on("removed",function(){S.time1&&clearTimeout(S.time1),S.time2&&clearTimeout(S.time2),p&&(p.style.display="none",p.hidden=!0,p.style.display="none")});function N(V){var z;if(V.dataTransfer&&V.dataTransfer.files&&V.dataTransfer.files.length>0?z=V.dataTransfer.files:z=V.target.files,l=="text"||l=="json"){var se=[],Oe;if(l.toLowerCase()=="json")var K=[],ge}else if(l=="other")var Q=[],ce;else var G=[],le;for(var Ae=0;Ae<z.length;Ae++)(function(re){var xe=new FileReader;xe.onload=function(ke){if(l=="text"||l=="json"){var te=ke.target.result;if(se.push(te),l=="json"){var pe=JSON.parse(te);K.push(pe)}if(se.length==1&&(Oe=te,l=="json"&&(ge=pe)),se.length==z.length){var he=new Ge.Event("loaded");he.texts=se,he.text=Oe,he.lastText=te,he.total=se.length,l=="json"&&(he.jsons=K,he.json=ge,he.lastJSON=pe),S.dispatchEvent(he),p.value=""}}else if(l=="other"){var ae=ke.target.result;if(Q.push(ae),Q.length==1&&(ce=ae),Q.length==z.length){var he=new Ge.Event("loaded");he.others=Q,he.other=ce,he.lastOther=ae,he.total=Q.length,S.dispatchEvent(he),p.value=""}}else{var Ee=new Image;Ee.onload=function(){var ie=new t.Bitmap(Ee);if(G.push(ie),G.length==1&&(le=ie),G.length==z.length){var Se=new Ge.Event("loaded");Se.bitmaps=G,Se.bitmap=le,Se.lastBitmap=ie,Se.total=G.length,S.dispatchEvent(Se),p.value=""}},Ee.src=ke.target.result}},l=="text"||l=="json"?xe.readAsText(re):xe.readAsDataURL(re)})(z[Ae])}var ue=new XMLHttpRequest;if(ue.upload){var fe=function(V){p.removeEventListener("change",N),N(V),setInterval(function(){p.addEventListener("change",N)},100)};p.addEventListener("drop",fe)}this.save=function(V,z,se,Oe,K,ge,Q,ce,G,le,Ae){var re="content, filename, x, y, width, height, cached, cachedBounds, type, data, quality",xe;if(xe=st(S.save,arguments,re))return xe;if(n(V)&&(V=q.stage),n(G)&&(G="png"),n(z))z="saved_"+String(t.makeID("numbers",5))+"."+G;else{var ke=z.split(".");if(ke.length==1)z+="."+G;else{var te=["png","jpg","jpeg"],pe=te.indexOf(ke[ke.length-1].toLowerCase());pe==-1?z+="."+G:G=te[pe]}}if(n(se)&&(se=0),n(Oe)&&(Oe=0),n(K)&&(K=V.getBounds&&V.getBounds()?V.getBounds().width:q.width),n(ge)&&(ge=V.getBounds&&V.getBounds()?V.getBounds().height:q.height),V.cache(se,Oe,K,ge),le){var he=V.cacheCanvas.toDataURL("image/"+G,Ae);return Q?ce&&V.cache(ce.x,ce.y,ce.width,ce.height):V.uncache(),he}var ae=/Edge\/(\d)+/.test(navigator.userAgent);if(ae){var Ee=j.open();Ee.document.write("<html><head><title>saved</title></head><body style='margin:0px;padding:0px;overflow:hidden'><img src="+V.cacheCanvas.toDataURL("image/"+G)+"></body></html>"),Ee.document.close()}else{G=="jpg"&&(G="jpeg");var ie=document.createElement("a");ie.setAttribute("download",z),ie.setAttribute("href",V.cacheCanvas.toDataURL("image/"+G,Ae)),document.body.appendChild(ie),ie.click(),document.body.removeChild(ie)}return Q?ce&&V.cache(ce.x,ce.y,ce.width,ce.height):V.uncache(),S},ne!==!1&&t.styleTransforms(this,o),this.clone=function(){var V=new t.Loader(e,r,n(i)?null:i.clone(),a,s,f,c,x,v,g,b,E,A,T,h,n(P)?null:P.clone(),n(y)?null:y.clone(),C,n(O)?null:O.clone(),n(_)?null:_.clone(),Y,n(m)?null:m.clone(),n($)?null:$.clone(),n(I)?null:I.clone(),n(X)?null:X.clone(),R,q,ne,this.group);return S.cloneProps(V)},Object.defineProperty(this,"frame",{get:function(){return q},set:function(V){V!=q&&(q.off("update",S.updateEvent),q.off("resize",S.resizeEvent),q=V,S.resizeEvent=q.on("resize",S.resize),S.updateEvent=q.on("update",S.resize),S.resize())}}),this.resizeEvent=q.on("resize",S.resize),this.updateEvent=q.on("update",S.resize),this.dispose=function(V,z,se){var Oe;return S.stage&&(Oe=S.stage),q.off("update",S.updateEvent),q.off("resize",S.resizeEvent),N&&p.removeEventListener("change",N),fe&&p.removeEventListener("drop",fe),p&&p.parentNode&&p.parentNode.removeChild(p),p=null,se||(this.zimButton_dispose(),Oe&&Oe.update()),!0}},t.extend(t.Loader,t.Button,["clone","dispose"],"zimButton",!1),t.TextArea=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I){var X="width, height, placeholder, text, size, padding, color, backgroundColor, borderColor, borderWidth, corner, shadowColor, shadowBlur, dashed, id, readOnly, spellCheck, password, inputType, wrap, maxLength, frame, expand, keyboardShift, style, group, inherit",R;if(R=st(t.TextArea,arguments,X,this))return R;De("67.6"),this.group=$;var q=m===!1?{}:t.getStyle("TextArea",this.group,I);if(n(e)&&(e=q.width!=null?q.width:250),n(r)&&(r=q.height!=null?q.height:70),n(i)&&(i=q.placeholder!=null?q.placeholder:null),n(l)&&(l=q.text!=null?q.text:null),n(a)&&(a=q.size!=null?q.size:20),n(s)&&(s=q.padding!=null?q.padding:5),n(f)&&(f=q.color!=null?q.color:t.granite),n(c)&&(c=q.backgroundColor!=null?q.backgroundColor:"rgba(256,256,256,.1)"),n(x)&&(x=q.borderColor!=null?q.borderColor:"rgba(0,0,0,.1)"),n(k)&&(k=q.borderWidth!=null?q.borderWidth:null),x<0||k<0?x=k=null:x!=null&&k==null&&(k=1),n(v)&&(v=q.corner!=null?q.corner:0),!n(b)&&n(g)&&(g=q.shadowColor!=null?q.shadowColor:"rgba(0,0,0,.3)"),!n(g)&&n(b)&&(b=q.shadowBlur!=null?q.shadowBlur:10),n(w)&&(w=q.password!=null?q.password:!1),n(P)&&(P=q.inputType!=null?q.inputType:!1),n(y)&&(y=q.wrap!=null?q.wrap:!0),n(C)&&(C=q.maxLength!=null?q.maxLength:null),n(h)&&(h=q.spellCheck!=null?q.spellCheck:!0),n(T)&&(T=q.readOnly!=null?q.readOnly:!1),n(Y)&&(Y=q.keyboardShift!=null?q.keyboardShift:!1),this.maxLength=C,n(_)&&(_=q.expand!=null?q.expand:20),_===!0&&(_=20),typeof O>"u")if(j.zdf)var O=j.zdf;else{pt&&tt("zim.TextArea - please provide a reference to zim Frame");return}this.zimContainer_constructor(e,r,null,null,!1),this.type="TextArea";var J=this,Z=O.stage,ne=this.background=new t.Rectangle(e,r,c,x,k,v,E,null,null,!1).expand(_);g!=-1&&b>0&&(ne.shadow=new Ge.Shadow(g,3,3,b)),J.addChild(ne);var U=J.tag=P||w?document.createElement("input"):document.createElement("textarea");O.tag?O.tag.appendChild(U):document.body.appendChild(U),n(A)||(U.setAttribute("id",A),U.setAttribute("name",A)),w?U.setAttribute("type","password"):P&&U.setAttribute("type",P),U.readOnly=T,U.spellcheck=h,i&&U.setAttribute("placeholder",i),l&&(U.value=l),U.zimDisplay=U.style.display||"inline-block",U.style.cssText="background-color:rgba(0,0,0,.01); color:"+f+"; resize:none; z-index:3; width:"+(e-s*2)+"px; height:"+(r-s*2)+"px; overflow:hidden; outline:none;font-size:"+a+"px; font-family:"+(q.font!=null?q.font:"arial")+"; border:none; position:absolute; left:0px; top:0px; display:none;",J.taInput=function(){!n(J.maxLength)&&J.text.length>J.maxLength&&(J.text=J.text.substring(0,J.maxLength)),J.dispatchEvent("input")};var B=J.y;J.taFocus=function(){if(j.M&&Y){J.re&&J.stage.frame.off("resize",J.re),J.re=J.stage.frame.on("resize",function(){J.stage&&S>J.stage.height/4&&(J.stage.y=J.stage.scaleY*(J.stage.height/4-S),J.stage.update())});var S=J.localToGlobal(0,0).y;J.stage&&S>J.stage.height/4&&(J.stage.y=J.stage.scaleY*(J.stage.height/4-S),J.stage.update())}J.stage&&(O=J.stage.frame),O.zil&&j.removeEventListener("keydown",O.zil[0]),J.dispatchEvent("focus")},J.taBlur=function(){j.M&&Y&&J.stage&&(J.re&&J.stage.frame.off("resize",J.re),J.stage.y=B,J.stage.update()),J.stage&&(O=J.stage.frame),O.zil&&j.addEventListener("keydown",O.zil[0]),J.dispatchEvent("blur")},U.addEventListener("change",J.taChange),U.addEventListener("input",J.taInput),U.addEventListener("focus",J.taFocus),U.addEventListener("blur",J.taBlur);var d=new Ge.DOMElement(U);d.alpha=0,this.on("mousedown",function(){setTimeout(function(){U.focus()},100)}),this.setFocus=function(S){return n(S)&&(S=!0),S?U.focus():U.blur(),J};var u=O.retina&&j.devicePixelRatio||1;this.resize=function(S,F){n(S)&&(S=!0),J.time1&&clearTimeout(J.time1),F||(J.time1=setTimeout(function(){J.resize(null,!0)},40));var p=J.getConcatenatedMatrix().decompose(),L=J.localToGlobal(s,s);if(O.retina){var we=t.browserZoom();O.tag?(d.x=L.x/u/we,d.y=L.y/u/we):(d.x=O.x/Z.scaleX+L.x/u/we,d.y=O.y/Z.scaleY+L.y/u/we),t.sca(d,p.scaleX/u/Z.scaleX/we,p.scaleY/u/Z.scaleY/we)}else O.tag?(d.x=L.x*O.scale,d.y=L.y*O.scale):(d.x=O.x+L.x*O.scale,d.y=O.y+L.y*O.scale),t.sca(d,O.scale*p.scaleX,O.scale*p.scaleY);return d.alpha=J.alpha,J.parent&&(d.alpha*=J.parent.alpha),S&&J.stage&&Z.update(),J},this.resize(),J.added(o);function o(){Z.addChild(d),J.time2=setTimeout(function(){U.style.display=U.zimDisplay},50),J.resize(),J.on("added",o,null,!0),J.FOEvent=Z.on("stagemousedown",function(){J.focus=!1})}J.on("removed",function(){J.time1&&clearTimeout(J.time1),J.time2&&clearTimeout(J.time2),Z.removeChild(d),J.FOEvent&&Z.off("stagemousedown",J.FOEvent),U&&(U.style.display="none")}),Object.defineProperty(this,"currentValue",{get:function(){return U.value},set:function(S){U.value=S}}),Object.defineProperty(this,"text",{get:function(){return U.value},set:function(S){U.value=S}}),Object.defineProperty(this,"focus",{get:function(){return document.activeElement==U},set:function(S){J.setFocus(S)}}),Object.defineProperty(this,"readOnly",{get:function(){return U.readOnly},set:function(S){U.readOnly=S}}),j.KEYFOCUS!=null&&(t.KEYFOCUS=j.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==J},set:function(){t.KEYFOCUS=J}}),t.KEYFOCUS||(J.keyFocus=!0),J.taMousedown=function(){J.keyFocus=!0},U.addEventListener("mousedown",J.taMousedown),y||(U.style.whiteSpace="pre"),m!==!1&&t.styleTransforms(this,q),this.clone=function(){var S=new t.TextArea(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,this.group,I);return J.cloneProps(S)},Object.defineProperty(this,"frame",{get:function(){return O},set:function(S){S!=O&&(O.off("update",J.updateEvent),O.off("resize",J.resizeEvent),O=S,J.resizeEvent=O.on("resize",J.resize),J.updateEvent=O.on("update",J.resize),u=O.retina&&j.devicePixelRatio||1,Z=O.stage,J.resize())}}),this.resizeEvent=O.on("resize",J.resize),this.updateEvent=O.on("update",J.resize),this.dispose=function(S,F,p){var L;return J.stage&&(L=J.stage),O.off("update",J.updateEvent),O.off("resize",J.resizeEvent),L&&J.FOEvent&&L.off("stagemousedown",J.FOEvent),U&&U.parentNode&&U.parentNode.removeChild(U),U.removeEventListener("change",J.taChange),U.removeEventListener("input",J.taInput),U.removeEventListener("focus",J.taFocus),U.removeEventListener("blur",J.taBlur),U.removeEventListener("mousedown",J.taMousedown),U=null,p||(this.zimContainer_dispose(!0),L&&L.update()),J.background=null,!0}},t.extend(t.TextArea,t.Container,["clone","dispose"],"zimContainer",!1),t.Tag=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="width, height, id, frame, backgroundColor, padding, paddingH, paddingV, expand, style, group, inherit",E;if(E=st(t.Tag,arguments,b,this))return E;De("67.7"),this.group=v;var A=k===!1?{}:t.getStyle("Tag",this.group,g);if(n(e)&&(e=A.width!=null?A.width:250),n(r)&&(r=A.height!=null?A.height:70),n(i)&&(i=A.id!=null?A.id:"zimTag_"+t.rand(1e4)),typeof l>"u")if(j.zdf)var l=j.zdf;else{pt&&tt("zim.Tag - please provide a reference to zim Frame");return}n(a)&&(a=A.backgroundColor!=null?A.backgroundColor:"rgba(0,0,0,0)"),n(s)&&(s=A.padding!=null?A.padding:10),n(f)&&(f=A.paddingH!=null?A.paddingH:s),n(c)&&(c=A.paddingV!=null?A.paddingV:s),n(x)&&(x=A.expand!=null?A.expand:20),x===!0&&(x=20),this.zimContainer_constructor(e,r,null,null,!1),this.type="Tag",this.tagID=i,this.id=i;var T=this,h=l.stage;T.background=new t.Rectangle(e+f,r+c,a).center(this).expand(x||0);var w=T.tag=document.createElement("div");l.tag?l.tag.appendChild(w):document.body.appendChild(w),w.setAttribute("id",i),w.setAttribute("name",i),w.zimDisplay=w.style.display||"inline-block",w.style.cssText="resize:none; z-index:3; width:"+e+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none;";var P=new Ge.DOMElement(w);P.alpha=0;var y=l.retina&&j.devicePixelRatio||1;this.resize=function(O,_){n(O)&&(O=!0),T.time1&&clearTimeout(T.time1),_||(T.time1=setTimeout(function(){T.resize(null,!0)},40));var Y=T.getConcatenatedMatrix().decompose(),m=T.localToGlobal(0,0);if(l.retina){var $=t.browserZoom();l.tag?(P.x=m.x/y/$,P.y=m.y/y/$):(P.x=l.x/h.scaleX+m.x/y/$,P.y=l.y/h.scaleY+m.y/y/$),t.sca(P,Y.scaleX/y/h.scaleX/$,Y.scaleY/y/h.scaleY/$)}else P.x=l.x+m.x*l.scale,P.y=l.y+m.y*l.scale,t.sca(P,l.scale*Y.scaleX,l.scale*Y.scaleY);return P.alpha=T.alpha,T.parent&&(P.alpha*=T.parent.alpha),O&&T.stage&&h.update(),T},this.resize(),T.added(C);function C(){h.addChild(P),T.time2=setTimeout(function(){w.style.display=w.zimDisplay},50),T.resize(),T.on("added",C,null,!0)}T.on("removed",function(){T.time1&&clearTimeout(T.time1),T.time2&&clearTimeout(T.time2),h.removeChild(P),w&&(w.style.display="none")}),this.add=function(O){return w.innerHTML+=O,T},Object.defineProperty(this,"innerHTML",{get:function(){return w.innerHTML},set:function(O){w.innerHTML=O}}),Object.defineProperty(this,"style",{get:function(){return w.style},set:function(O){w.style=O}}),k!==!1&&t.styleTransforms(this,A),this.clone=function(){var O=new t.Tag(e,r,i,l,a,s,f,c,x,k,this.group,g);return T.cloneProps(O)},Object.defineProperty(this,"frame",{get:function(){return l},set:function(O){O!=l&&(l.off("update",T.updateEvent),l.off("resize",T.resizeEvent),l=O,T.resizeEvent=l.on("resize",T.resize),T.updateEvent=l.on("update",T.resize),T.resize())}}),this.resizeEvent=l.on("resize",T.resize),this.updateEvent=l.on("update",T.resize),this.dispose=function(O,_,Y){var m;return T.stage&&(m=T.stage),l.off("update",T.updateEvent),l.off("resize",T.resizeEvent),w&&w.parentNode&&w.parentNode.removeChild(w),w=null,Y||(this.zimContainer_dispose(!0),m&&m.update()),!0}},t.extend(t.Tag,t.Container,["clone","dispose"],"zimContainer",!1);function St(e,r){r?(e.mouseChildren=!0,e.mouseEnabled=!0,e._enabled=!0):(e.mouseChildren=!1,e.mouseEnabled=!1,e._enabled=!1)}if(t.addTo=function(e,r,i,l){var a="obj, container, index, localToLocal",s;if(s=st(t.addTo,arguments,a))return s;if(De("47.5"),n(e)){tt("zim methods - addTo(): please provide object");return}if(n(r))if(j.zdf)r=j.zdf.stage;else{tt("zim methods - addTo(): please provide container");return}if(n(l)&&(l=!0),e.parent||(l=!1),l)var f=e.parent.localToLocal(e.x,e.y,r);return n(i)||isNaN(i)?r.addChild(e):r.addChildAt(e,i),l&&(e.x=f.x,e.y=f.y),e},t.removeFrom=function(e,r){if(De("47.6"),n(e)){tt("zim methods - removeFrom(): please provide object");return}return e.removePhysics&&e.removePhysics(),n(r)?e.parent&&e.parent.removeChild(e):r.removeChild(e),e},t.added=function(e,r,i,l){if(De("47.7"),!(n(e)||n(r)||typeof r!="function")){var a=Tt(i);if(n(i)&&(i=a=="s"?.1:100),e.stage){r(e.stage,e);return}var s=i*(a=="s"?1e3:1),f;l&&(Pt(l),f=l*(a=="s"?1e3:1));var c=Date.now(),x=0,k=setInterval(function(){if(x>5){clearInterval(k);return}x++,e.stage&&(r(e.stage,e),clearInterval(k),clearInterval(v))},10),v=setInterval(function(){f>0&&c-Date.now()>f&&clearInterval(v),e.stage&&(r(e.stage,e),clearInterval(v))},s);return v}},t.centerReg=function(e,r,i,l){var a="obj, container, index, add",s;if(s=st(t.centerReg,arguments,a))return s;if(e.type=="AC"&&j.zdf)return j.zdf.ac("centerReg",arguments),e.addTo(r,i);if(De("48"),n(e)||!e.getBounds||!e.getBounds())return tt("zim methods - centerReg(): please provide object with bounds set"),e;n(l)&&(l=!0),n(r)&&e.parent&&l&&(r=e.parent,n(i)&&(i=e.parent.getChildIndex(e)),e.parent.removeChild(e)),!n(r)&&r==e.parent&&(n(i)&&(i=e.parent.getChildIndex(e)),e.parent.removeChild(e));var f=e.getBounds();return e.regX=f.x+f.width/2,e.regY=f.y+f.height/2,l?t.center(e,r,i):e},t.center=function(e,r,i,l){var a="obj, container, index, add",s;if(s=st(t.center,arguments,a))return s;if(e.type=="AC"&&j.zdf)return j.zdf.ac("center",arguments),e.addTo(r,i);if(t.centerCheck||(De("48.1"),t.centerCheck=!0),n(e)||!e.getBounds)return tt("zim.center(): please provide object with bounds"),e;if(n(r)&&(e.parent?r=e.parent:j.zdf&&(r=j.zdf.stage)),n(r)||!r.getBounds)return tt("zim.center(): please provide container with bounds"),e;var f=e.getBounds(),c=r.getBounds();n(l)&&(l=!0);var x=!1;if(n(c)&&(r.setBounds(0,0),c=r.getBounds(),x=!0),l&&r.addChild&&(n(i)||typeof i=="number"&&isNaN(i)?(!e.parent||e.parent!=r)&&r.addChild(e):r.addChildAt(e,i)),n(f))return e.x=c.x+c.width/2,e.y=c.y+c.height/2,e;var k=!1,v=!1;r.scaleX==0&&(k=!0,r.scaleX=1e-5),r.scaleY==0&&(v=!0,r.scaleY=1e-5);var g=e.localToLocal(e.regX,e.regY,r),b=t.boundsToGlobal(e),E=t.boundsToGlobal(r,b,!0);if(k&&(r.scaleX=0),v&&(r.scaleY=0),e.x=c.x+c.width/2-E.width/2+(g.x-E.x),e.y=c.y+c.height/2-E.height/2+(g.y-E.y),!l&&r.getStage&&r.stage&&e.parent){var A=r.localToLocal(e.x,e.y,e.parent);e.x=A.x,e.y=A.y}return x&&r.setBounds(null),e},t.place=function(e,r){if(De("49"),n(e))return;n(r)&&(r="obj"),t.lastPlace=e;function i(){tt(r+".x = "+Math.round(e.x)+"; "+r+".y = "+Math.round(e.y)+";"),tt(r+".loc("+Math.round(e.x)+", "+Math.round(e.y)+");")}t.drag({obj:e,currentTarget:!0,dragCursor:"crosshair"}),e.on("mousedown",function(){t.lastPlace=e});var l=j.zdf;return l&&l.on("keydown",function(a){if(e==t.lastPlace){var s=a.keyCode;if(s>=37&&s<=40){var f=a.shiftKey?10:1;e.mov(s==37?-1*f:s==39?1*f:0,s==38?-1*f:s==40?1*f:0),i(),e.stage&&e.stage.update()}}}),tt("place "+r+" - to get new position",e),e.on("click",i),e},t.placeReg=function(e,r){if(De("49.5"),n(e))return;var i=e.stage;if(n(i))return tt("zim.placeReg() - add object to stage before calling placeReg()"),e;n(r)&&(r="obj");function l(){var f=e.globalToLocal(s.x,s.y);tt(r+".regX = "+Math.round(f.x)+"; "+r+".regY = "+Math.round(f.y)+";"),tt(r+".reg("+Math.round(f.x)+", "+Math.round(f.y)+");")}var a=e.parent.localToGlobal(e.x,e.y),s=new t.Shape(-25,-25,50,50,null,!1).addTo(i).pos({x:a.x,y:a.y,reg:!0});return s.graphics.s("white").mt(-25,0).lt(25,0).mt(0,-25).lt(0,20),s.compositeOperation="difference",s.expand(0),t.drag({obj:s}),tt("place cursor to get new registration point location"),i.on("stagemouseup",l),e},t.pos=function(e,r,i,l,a,s,f,c,x,k,v){var g="obj, x, y, horizontal, vertical, container, index, add, reg, regX, regY",b;if(b=st(t.pos,arguments,g))return b;if(e.type=="AC"&&j.zdf)return j.zdf.ac("pos",arguments),e.addTo(s,f);De("41.5"),j.DIR&&j.DIR=="rtl"||!j.DIR&&t.DIR=="rtl"?l=="start"?l="right":l=="end"&&(l="left"):l=="start"?l="left":l=="end"&&(l="right");var E=!1;l=="right"&&(E=!0);var A=!1;a=="bottom"&&(A=!0);var T=t.POSREG;if(j.POSREG!=null&&(T=j.POSREG),n(x)&&(x=T),n(e))return;n(x)&&n(k)&&(k=!1),n(x)&&n(v)&&(v=!1),!n(x)&&n(k)&&(k=x),!n(x)&&n(v)&&(v=x),n(c)&&(c=!0),!n(s)&&!s.addChild&&(s=null),!e.getBounds&&!e.getBounds()&&(k=v=!1),e.zimPos={x:r,y:i,h:l,v:a,i:f},n(s)&&(e.parent?s=e.parent:j.zdf&&(s=j.zdf.stage)),!e.parent&&n(r)&&(r=0),!e.parent&&n(i)&&(i=0);var h=!1;e.getBounds()||(e.setBounds(0,0),h=!0);var w=!1;s&&!s.getBounds()&&(s.setBounds(0,0),w=!0);function P(){n(f)||typeof f=="number"&&isNaN(f)?s.contains(e)||s.addChild(e):s.addChildAt(e,f)}if(!n(s)&&s.addChild&&c){var y=s.getBounds().clone();P();var C=s.getBounds();(y.width!=C.width||y.height!=C.height||y.x!=C.x||y.y!=C.y)&&(e.removeFrom(),s.setBounds(y.x,y.y,y.width,y.height),w=!0,P())}if(!k&&!v&&(l=="center"||l=="middle")&&(a=="center"||a=="middle"))return e.center({container:s}),e.mov(r,i),h&&e.setBounds(null),w&&s.setBounds(null),e;if(l=="center"||l=="middle"){if(k)e.x=s.width/2;else{var O=e.y;e.center(),e.y=O}e.mov(r),r=null,l=null}else l===!0&&(E=!0);if(a=="center"||a=="middle"){if(v)e.y=s.height/2;else{var _=e.x;e.center(),e.x=_}e.mov(0,i),i=null,a=null}else a===!0&&(A=!0);function Y(){var q=e.getBounds(),J=q.x,Z=q.y,ne=q.width,U=q.height,B=e._props.matrix;B=e.getMatrix(B),(J||Z)&&B.appendTransform(0,0,1,1,0,0,0,-J,-Z);var d=ne*B.a,u=ne*B.b,o=U*B.c,S=U*B.d,F=B.tx,p=B.ty,L=F,we=F,D=p,N=p;return(J=d+F)<L?L=J:J>we&&(we=J),(J=d+o+F)<L?L=J:J>we&&(we=J),(J=o+F)<L?L=J:J>we&&(we=J),(Z=u+p)<D?D=Z:Z>N&&(N=Z),(Z=u+S+p)<D?D=Z:Z>N&&(N=Z),(Z=S+p)<D?D=Z:Z>N&&(N=Z),{x:L,y:D,width:we-L,height:N-D}}if(e.parent&&e.parent.getBounds){if(s=e.parent,n(r)&&E==!0&&(r=0),n(i)&&A==!0&&(i=0),n(r)||(e.x=r),n(i)||(e.y=i),n(r)&&n(i)&&!E&&!A)return h&&e.setBounds(null),w&&s.setBounds(null),e;var m=0,$=0;if(e.getBounds()){var I=Y();if(!n(r)){var X;E?X=new t.Point(I.x+I.width,I.y+I.height):X=new t.Point(I.x,I.y),m=X.x-r}n(i)||(A?X=new t.Point(I.x+I.width,I.y+I.height):X=new t.Point(I.x,I.y),$=X.y-i);var R=s.getBounds();n(r)||(E?k?e.x=R.width+R.x-r:e.x=R.width+R.x-r-m:(k?e.x=r:e.x=r-m,e.x+=R.x)),n(i)||(A?v?e.y=R.height+R.y-i:e.y=R.height+R.y-i-$:(v?e.y=i:e.y=i-$,e.y+=R.y))}}return h&&e.setBounds(null),w&&s.setBounds(null),c||e.removeFrom(),e},t.loc=function(e,r,i,l,a,s,f,c){var x="obj, target, y, container, index, add, localToLocal, x",k;if(k=st(t.loc,arguments,x))return k;if(e.type=="AC"&&j.zdf)return j.zdf.ac("loc",arguments),e.addTo(l,a);if(De("41.55"),!n(e)){if(typeof r=="number"&&(c=r,r=null),n(r)||(Array.isArray(r)?(c=r[0],i=r[1]):(n(r.x)||(c=r.x),n(r.y)||(i=r.y))),n(c)&&n(r)&&(c=e.x),n(i)&&n(r)&&(i=e.y),n(s)&&(s=!0),n(l)&&(e.parent?l=e.parent:j.zdf&&(l=j.zdf.stage)),s&&l&&(!e.parent||l!=e.parent?n(a)||isNaN(a)?l.addChild(e):l.addChildAt(e,a):n(a)||l.addChildAt(e,a)),n(f)&&(f=!0),r&&r.parent&&e.parent&&f){var v=r.parent.localToLocal(c,i,e.parent);c=v.x,i=v.y}return e.x=c,e.y=i,e}},t.mov=function(e,r,i){var l="obj, x, y",a;if(a=st(t.mov,arguments,l))return a;if(e.type=="AC"&&j.zdf)return j.zdf.ac("mov",arguments),e;if(De("41.6"),!n(e))return n(r)||(e.x+=r),n(i)||(e.y+=i),e},t.sca=function(e,r,i){return e.type=="AC"&&j.zdf?(j.zdf.ac("sca",arguments),e):(De("41.97"),n(e)||n(e.scaleX)||(n(r)&&(r=e.scaleX),n(i)&&(i=r),e.scaleX=r,e.scaleY=i),e)},t.alp=function(e,r){if(De("41.7"),!n(e))return n(r)||(e.alpha=e.hovOriginal=r,e.tag&&e.tag.style&&(e.type!="Loader"&&(e.tag.style.opacity=r),r==0?e.tag.style.display=e.tag.zimDisplay="none":e.tag.style.display=e.tag.zimDisplay="inline-block")),e},t.vis=function(e,r){if(De("41.71"),!n(e))return e.visible=r,e.tag&&e.tag.style&&(r?e.tag.style.display=e.tag.zimDisplay="inline-block":e.tag.style.display=e.tag.zimDisplay="none"),e},t.ble=function(e,r){if(De("41.72"),!n(e))return n(r)&&(r="difference"),e.compositeOperation=r,(e.type=="Blob"||e.type=="Squiggle")&&e.update(),e},t.dye=function(e,r){if(De("41.73"),!n(e))return e.hasOwnProperty("backgroundColor")?e.backgroundColor=r:e.hasOwnProperty("color")&&(e.color=r),e},t.hov=function(e,r,i){if(De("41.75"),!n(e))return n(r)&&(r=1),n(i)&&(i=typeof r=="number"?"alpha":"color"),e.hovMouseover&&(e.off("mouseover",e.hovMouseover),e.off("mouseout",e.hovMouseout)),r==-1?(e.cur("default"),n(e.hovOld)||(e[e.hovType]=e.hovOld),e.hovOld=null,e.stage&&e.stage.update(),e):(e.cur(),e.hovOld=e[i],e.hovNew=r,e.hovType=i,e.hovMouseover=e.on("mouseover",function(){e[i]=e.hovNew,e.stage&&e.stage.update()}),e.hovMouseout=e.on("mouseout",function(){e[i]=e.hovOld,e.stage&&e.stage.update()}),e)},t.rot=function(e,r,i,l){if(De("41.8"),!n(e)){if(e.type=="AC"&&j.zdf)return j.zdf.ac("rot",arguments),e;if(!n(r))if(e.parent&&(!n(i)||!n(l))){n(i)&&(i=e.x),n(l)&&(l=e.y);var a=e.parent.localToLocal(i,l,e),s=new t.Point(e.x,e.y);e.reg(a.x,a.y),e.rotation=r,e.x=i,e.y=l;var f=e.parent.localToLocal(s.x,s.y,e);e.reg(f.x,f.y),e.x=s.x,e.y=s.y}else e.rotation=r;return e}},t.siz=function(e,r,i,l){if(De("41.85"),!n(e))return e.type=="AC"&&j.zdf?(j.zdf.ac("siz",arguments),e):(n(l)&&(l=!1),!n(r)&&!n(i)?(e.widthOnly=r,e.heightOnly=i):n(r)?n(i)||(l?e.heightOnly=i:e.height=i):l?e.widthOnly=r:e.width=r,e)},t.ske=function(e,r,i){if(De("41.9"),!n(e))return e.type=="AC"&&j.zdf?(j.zdf.ac("ske",arguments),e):(n(r)||(e.skewX=r),n(i)||(e.skewY=i),e)},t.reg=function(e,r,i,l){if(De("41.95"),!n(e)){if(e.type=="AC"&&j.zdf)return j.zdf.ac("reg",arguments),e;var a=e.regX,s=e.regY,f=r,c=j.DIR||t.DIR||"ltr",x;if(r=="default"&&(r=null),typeof r=="string"&&(x=e.getBounds(),x?(r=="start"&&(r=c=="ltr"?"left":"right"),r=="end"&&(r=c=="ltr"?"right":"left"),r=="left"?r=x.x:r=="right"?r=x.x+x.width:(r=="center"||r=="middle")&&(r=x.x+x.width/2)):r=null),typeof i=="string"?(x||(x=e.getBounds()),x?i=="top"?i=x.y:i=="bottom"?i=x.y+x.height:(i=="center"||i=="middle")&&(i=x.y+x.height/2):i=null):n(i)&&(f=="center"||f=="middle")&&(x||(x=e.getBounds()),x?i=x.y+x.height/2:i=null),i=="default"&&(i=null),n(r)||(e.regX=r),n(i)||(e.regY=i),l&&e.parent){var k=e.localToLocal(a,s,e.parent);e.x-=k.x-e.x,e.y-=k.y-e.y}return e}},t.top=function(e){return De("41.62"),n(e)||!e.parent||e.parent.setChildIndex(e,e.parent.numChildren-1),e},t.bot=function(e){return De("41.63"),n(e)||!e.parent||e.parent.setChildIndex(e,0),e},t.ord=function(e,r){if(De("41.64"),!(n(e)||!e.parent))return n(r)&&(r=0),e.parent.setChildIndex(e,t.constrain(e.parent.getChildIndex(e)+r,0,e.parent.numChildren-1)),e},t.cur=function(e,r){if(De("41.1"),n(e))return tt("zim methods - cur(): please provide object"),e;n(r)&&(r="pointer");var i=j.zdf;return e.stage&&(i=e.stage.frame),i.cursors&&i.cursors[r]?(e.cursor="none",e._cursor=r,i.cursorList.add(e,r),e):(i.cursorList&&i.cursorList.add(e,!0),e.cursor=r,e)},t.sha=function(e,r,i,l,a){return De("41.2"),n(e)?(tt("zim methods - sha(): please provide object"),e):(n(r)&&(r="rgba(0,0,0,.3)"),r.blur?(e.shadow=r,e):(n(i)&&(i=e.width?e.width*.08:5),n(l)&&(l=e.height?e.height*.08:5),n(a)&&(a=e.width?e.width*.16:10),r==-1?e.shadow=null:e.shadow=new Ge.Shadow(r,i,l,a),e))},t.dep=function(e,r){if(De("41.65"),!n(e))return n(r)&&(r=0),e.depth=r,e},t.nam=function(e,r){if(De("41.67"),!(n(e)||n(r)))return e.name=r,t.zimObjectIDs[r]=e,e},t.movement=function(e,r,i){De("47.75");var l=e.stage||j.zdf.stage;function a(){l=e.stage,e.zimMovementStage=l,e.zimMovementEvent&&l.off("stagemousemove",e.zimMovementEvent),e.zimMovementEvent=l.on("stagemousemove",function(s){r(s)}),e.on("mouseout",function(){e.zimMovementEvent&&l.off("stagemousemove",e.zimMovementEvent)},null,!0)}return t.mobile()?(e.zimMovementEvent&&l.off("pressmove",e.zimMovementEvent),e.zimMovementEvent=e.on("pressmove",function(s){r(s)})):(e.zimMouseoverEvent&&e.off("mouseover",e.zimMouseoverEvent),e.zimMouseoverEvent=e.on("mouseover",a),i&&a()),e},t.noMovement=function(e){if(De("47.9"),!n(e))return e.zimMouseoverEvent&&e.off("mouseover",e.zimMouseoverEvent),e.zimMovementEvent&&e.zimMovementStage&&e.zimMovementStage.off("stagemousemove",e.zimMovementEvent),e},t.tap=function(e,r,i,l,a,s,f,c,x,k){var v="obj, call, distance, time, once, dbl, dblTime, call2, call3, call4",g;if(g=st(t.tap,arguments,v))return g;if(De("47.8"),!(n(e)||n(r)||typeof r!="function")){n(i)&&(i=s?10:5);var b=Tt(l);n(l)&&(l=b=="s"?8:8e3),n(a)&&(a=!1),n(s)&&(s=!1),n(f)&&(k?f=b=="s"?.5:500:f=b=="s"?1:1e3),e.cur("pointer");var E=!1,A=!1,T;return s?e.zimDblClickDownEvent=e.on("mousedown",function(h){if(T=!1,E){E=!1;return}if(E=!0,h.currentTarget.type=="List"){if(h.target.type=="WindowBacking")return;var w=h.currentTarget.globalToLocal(h.stageX/t.scaX,h.stageY/t.scaY);if(w.y<=0)return}var P=h.stageX/t.scaX,y=h.stageY/t.scaY,C=Date.now(),O,_;A=!0,e.zimDoubleTimeout&&clearTimeout(e.zimDoubleTimeout),e.zimDoubleTimeout=setTimeout(function(){if(A=!1,E=!1,e.zimDblClickUpEvent&&e.off("pressup",e.zimDblClickUpEvent),T&&k)if(Math.abs(P+y-O/t.scaX-_/t.scaY)<i){if(e.excludeTap)return;k(h)}else c&&c(h)},b=="s"?f*1e3:f),e.zimDblClickUpEvent=e.on("pressup",function(Y){if(O=Y.stageX,_=Y.stageY,T=!0,E){x&&x(Y);return}else if(!A)return;if(Math.abs(P+y-Y.stageX/t.scaX-Y.stageY/t.scaY)<i&&Date.now()-C<(b=="s"?l*1e3:l)){if(e.excludeTap)return;clearTimeout(e.zimDoubleTimeout),r(Y)}else c&&c(Y);Y.remove()})},null,a):e.zimClickDownEvent=e.on("mousedown",function(h){if(h.currentTarget.type=="List"){if(h.target.type=="WindowBacking")return;var w=h.currentTarget.globalToLocal(h.stageX/t.scaX,h.stageY/t.scaY);if(w.y<=0)return}var P=h.stageX/t.scaX,y=h.stageY/t.scaY,C=Date.now();e.zimClickUpEvent=e.on("pressup",function(O){if(Math.abs(P+y-O.stageX/t.scaX-O.stageY/t.scaY)<i&&Date.now()-C<(b=="s"?l*1e3:l)){if(e.excludeTap)return;r(O)}else c&&c(O);O.remove()})},null,a),e}},t.noTap=function(e){if(De("47.9"),!n(e))return e.cursor&&e.cur("default"),e.zimClickDownEvent&&e.off("mousedown",e.zimClickDownEvent),e.zimClickUpEvent&&e.off("pressup",e.zimClickUpEvent),e.zimDoubleTimeout&&clearInterval(e.zimDoubleTimeout),e},t.hold=function(e,r,i,l,a){if(De("47.87"),!(n(e)||n(r)||typeof r!="function")){n(i)&&(i=5);var s=Tt(l);n(l)&&(l=s=="s"?1.5:1500),n(a)&&(a=!1),e.cur("pointer");var f;return e.zimClickHoldDownEvent=e.on("mousedown",function(c){if(f||(f=c.target.stage),!!f){if(n(f.frame)&&(f.frame=j.zdf),(n(f.frame)||!f.frame.mousemoveEvent)&&(n(f.frame)&&(f.frame={}),f.frame.mouseX=c.stageX/t.scaX,f.frame.mouseY=c.stageY/t.scaY,f.frame.mouseholdEvent&&f.off("stagemousemove",f.frame.mouseholdEvent),f.frame.mouseholdEvent=f.on("stagemousemove",function(b){f.frame.mouseX=b.stageX/t.scaX,f.frame.mouseY=b.stageY/t.scaY})),c.currentTarget.type=="List"){if(c.target.type=="WindowBacking")return;var x=c.currentTarget.globalToLocal(c.stageX/t.scaX,c.stageY/t.scaY);if(x.y<=0)return}var k=c.stageX/t.scaX,v=c.stageY/t.scaY;clearInterval(e.zimHoldInterval);var g=0;e.zimHoldInterval=setInterval(function(){if(g<10)Math.abs(k+v-f.frame.mouseX-f.frame.mouseY)>i&&clearInterval(e.zimHoldInterval);else{if(Math.abs(k+v-f.frame.mouseX-f.frame.mouseY)<i){if(e.excludeHold)return;r(c)}clearInterval(e.zimHoldInterval)}g++},l/10*(s=="s"?1e3:1)),e.zimClickHoldUpEvent=e.on("pressup",function(){clearInterval(e.zimHoldInterval),f&&f.frame.mouseholdEvent&&f.off("stagemousemove",f.frame.mouseholdEvent)},null,!0)}},null,a),e}},t.noHold=function(e){if(De("47.88"),!n(e))return e.cursor&&e.cur("default"),e.off("mousedown",e.zimClickHoldDownEvent),e.off("pressup",e.zimClickHoldUpEvent),e.stage&&e.stage.frame.mouseEvent&&e.stage.off("stagemousemove",e.stage.frame.mouseEvent),clearInterval(e.zimHoldTimeout),e},t.change=function(e,r,i){if(De("47.85"),!(n(e)||n(r)||typeof r!="function"))return n(i)&&(i=!1),e.zimChangeEvent=e.on("change",function(l){r(l)},null,i),e},t.noChange=function(e){if(De("47.95"),!n(e))return e.off("mousedown",e.zimChangeEvent),e},t.drag=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O){var _="obj, boundary, axis, overCursor, dragCursor, all, swipe, localBoundary, onTop, surround, slide, slideFactor, slideSnap, slideSnapDamp, reg, removeTweens, startBounds, rect, currentTarget, offStage, immediateBoundary, singleTouch",Y;if(Y=st(t.drag,arguments,_))return Y;if(De("31"),n(e)||!e.on)return;var m=t.DRAGALL;if(j.DRAGALL!=null&&(m=j.DRAGALL),n(s)&&n(P)&&(s=m),n(s)&&n(P)?P=!1:n(s)?n(P)&&(P=!1):P=s,(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&(P=!0),r&&r.getBounds&&(e.type=="Container"||e.type=="Tile")&&e.mouseChildren==!0&&!s){var $=Array.prototype.slice.call(arguments);return $[4]=!0,setTimeout(function(){e.loop(function(Ce){$[0]=Ce,t.drag.apply(null,$)})},C?0:50),e}(n(i)||i=="all"||i!="horizontal"&&i!="vertical")&&(i="both"),e.zimDown&&e.noDrag(),e.cur(n(l)?"pointer":l),n(f)&&(f=!1),n(c)&&(c=!1),n(x)&&(x=!0),n(k)&&(k=!1),n(v)&&(v=!1),n(g)&&(g=.9),n(b)&&(b=!0);var I=["horizontal","vertical","auto"];if(b!==!0&&I.indexOf(b)<0&&(b=!1),b=="auto"&&(b=!0),n(E)&&(E=.1),n(A)&&(A=!1),n(T)&&(T=!0),n(h)&&(h=!0),n(r)&&!n(w)&&(r=w),n(O)&&(O=!1),e.dragPaused=!1,v)var X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue=j.M?20:10,fe,V,z,se,Oe=!1,K=!1,ge=50;else e.zimDragTicker=function(){};e._draggable=!0,t.setSwipe(e,f),e.zimBoundary=r,e.zimlocalBoundary=c,e.circleBounds=r&&r.type=="Circle"?r.radius:!1,e.downCheck=!1;var Q=!1,ce,G,le,Ae,re;e.zimAdded=e.on("added",xe,null,!0),e.zimRemoved=e.on("removed",ke,null,!0),e.parent&&xe();function xe(){if(e.off("added",e.zimAdded),r=e.zimBoundary,r&&r.getBounds&&r.type!="Blob"){if(e.zimlocalBoundary=!1,r.type!="Stage"&&r.type!="StageGL"?r=r.boundsToGlobal():r=new t.Boundary(0,0,r.width,r.height),!k){var Ce=e.boundsToGlobal();re=e.localToGlobal(e.regX,e.regY);var ee=new t.Point(re.x-Ce.x,re.y-Ce.y),Me=e.borderWidth?e.borderWidth:0;r.x+=ee.x+Me/2,r.y+=ee.y+Me/2,r.width-=Ce.width+Me,r.height-=Ce.height+Me}e.zimBoundary=r}ce=0,G=0,e.zimBoundary&&e.zimBoundary.type!="Blob"&&(c?(le=t.boundsToGlobal(e.parent,e.zimBoundary),k&&(Ae=e.zimBoundary)):(le=e.zimBoundary,k&&(Ae=t.boundsToGlobal(e.parent,e.zimBoundary,!0)))),le&&h&&(re=e.parent.localToGlobal(e.x,e.y),ae(e,re.x,re.y)),v&&setTimeout(function(){v&&b&&(X=new t.Damp(null,E),R=new t.Damp(null,E)),e.zimDragImmediate=function(_e,Ye){o=_e,S=Ye,fe=V=0,z=se=0,B=F=d=p=u=L=0,v&&b&&(n(_e)||X.immediate(_e),n(Ye)||R.immediate(Ye))},q=3,J=0,Z=[],ne=[],U=[],B=e.x,d=e.y,o=e.x,S=e.y,F=e.x,p=e.y,L=Date.now(),we=-1e4,D=-1e4,e.zimDragMoving=!0,Le()},50),n(e.zimMaskDynamic)||e.zimMaskApply()}function ke(){e.zimDragTicker&&t.Ticker.remove(e.zimDragTicker)}var te,pe;e.pointers={};var he=!1;e.zimDown=e.on("mousedown",function(Ce){if(!(!e.stage||e.dragPaused)&&!(O&&he)){he=!0,pe=e.stage,e.zmu||(e.zmu=pe.frame.on("mouseupplus",function(je){e.downCheck&&(v||(e.downCheck=!1),Ee(je,!0))})),e.dragMouseX=Math.round(Ce.stageX/t.scaX)+pe.x,e.dragMouseY=Math.round(Ce.stageY/t.scaY)+pe.y;var ee="id"+Math.abs(Ce.pointerID+1);if(e.pointers[ee]=!0,te=P?Ce.currentTarget:Ce.target,e.zimBoundary&&!te.getBounds()){tt("zim.drag() - drag object needs bounds set");return}if(e.downCheck=!0,e.stage.mouseMoveOutside=!0,t.Ticker.has(e.zimDragTicker)||t.Ticker.add(e.zimDragTicker,e.stage),T&&e.zimTweens)for(var Me in e.zimTweens){var _e=e.zimTweens[Me];_e.zimObj&&(_e.zimObj.x!=null||_e.zimObj.y!=null)&&e.stopAnimate(Me)}if(te.parent){if(x){var Ye=te.parent.numChildren-1;te.parent.getChildAt(Ye).type=="Keyboard"&&Ye--,te.parent.setChildIndex(te,Ye),te.ZIMoutlineShape&&te.outline()}te.parent==e.stage?re=new t.Point(Ce.stageX/t.scaX,Ce.stageY/t.scaY):re=te.parent.globalToLocal(Ce.stageX/t.scaX,Ce.stageY/t.scaY),A&&(te.x=re.x,te.y=re.y),ce=re.x-te.x,G=re.y-te.y,le=null,e.zimBoundary&&(c?(le=t.boundsToGlobal(te.parent,e.zimBoundary),k&&(Ae=e.zimBoundary)):(le=e.zimBoundary,k&&(Ae=t.boundsToGlobal(te.parent,e.zimBoundary,!0)))),e.cur(n(a)?"pointer":a),v&&(e.slideStartX=e.x,e.slideStartY=e.y,N=e.zimDragMoving,J=0,Z=[re.x],ne=[re.y],U=[Date.now()],we=-1e4,D=-1e4,e.zimDragMoving=!0),e.type=="Pen"&&(e.zimDragCheck=!0,Q=!1)}}},!0),e.zimMove=e.on("pressmove",function(Ce){if(!(O&&!e.pointers["id"+Math.abs(Ce.pointerID+1)])&&!(!e.downCheck||e.dragPaused)){var ee=(y?Ce.rawX:Ce.stageX)/t.scaX+pe.x,Me=(y?Ce.rawY:Ce.stageY)/t.scaY+pe.y;e.dragMouseX=Math.round(ee),e.dragMouseY=Math.round(Me),ae(te,ee,Me),te.ZIMoutlineShape&&te.outline(),e.type=="Pen"&&!Q&&e.drawing?Q=!0:(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize()}},!0);function ae(Ce,ee,Me){var _e=ce,Ye=G;if(n(Ce)&&(Ce=te||e),!!Ce.parent){if(n(ee)||n(Me)){var je=Ce.parent.localToGlobal(Ce.x,Ce.y);ce=G=0,e.zimBoundary&&(c?(le=t.boundsToGlobal(Ce.parent,e.zimBoundary),k&&(Ae=Ce.zimBoundary)):(le=e.zimBoundary,k&&(Ae=t.boundsToGlobal(Ce.parent,e.zimBoundary,!0)))),ee=je.x,Me=je.y,v&&(o=Ce.x,S=Ce.y,te=Ce)}var it;pe&&pe.type?it=Ce.parent.globalToLocal(ee,Me):it=Ce.parent.globalToLocal(ee*t.scaX,Me*t.scaY);var Be=i=="both"||i=="horizontal",qe=i=="both"||i=="vertical",et;v&&b?b=="vertical"?(et=ie(Ce,it.x-ce,it.y-G),Be&&(Ce.x=et.x),qe&&(Ce.y=it.y-G)):b=="horizontal"?(et=ie(Ce,it.x-ce,it.y-G),Be&&(Ce.x=it.x-ce),qe&&(Ce.y=et.y)):(Be&&(Ce.x=it.x-ce),qe&&(Ce.y=it.y-G)):(et=ie(Ce,it.x-ce,it.y-G),Be&&(Ce.x=et.x),qe&&(Ce.y=et.y)),v&&!N&&(Ce.slideStartX!=Ce.x||Ce.slideStartY!=Ce.y)&&(N=!0),Ce.downCheck&&(ce=_e,G=Ye)}}e.zimPosition=ae,e.zimUp=e.on("pressup",function(Ce){Ee(Ce)},!0);function Ee(Ce,ee){if(!(O&&!ee&&!e.pointers["id"+Math.abs(Ce.pointerID+1)])){he=!1;var Me="id"+Math.abs((n(Ce.pointerID)?0:Ce.pointerID)+1);if(delete e.pointers[Me],!(!e.downCheck||e.dragPaused)){if(e.cur(n(l)?"pointer":l),v){if(te.dispatchEvent("slidestart"),te.parent){var _e=y?Ce.rawX:Ce.stageX,Ye=y?Ce.rawY:Ce.stageY;re=te.parent.globalToLocal(_e/t.scaX,Ye/t.scaY)}else re=new t.Point(0,0);B=re.x,d=re.y,u=Date.now(),isNaN(B)&&(B=-1e3),isNaN(d)&&(d=-1e3),z=B-F,se=d-p;var je=u-L;fe=t.constrain(z*ue/je,-ge,ge),V=t.constrain(se*ue/je,-ge,ge),Oe=!1,K=!1,e.downCheck=!1,o=te.x,S=te.y,ee&&(F=B=0,p=d=0,L=u=0)}else{e.downCheck=!1;var it=0;for(var Be in e.pointers)it++;it==0&&t.Ticker.remove(e.zimDragTicker),e.type=="Pen"&&(e.zimDragCheck=!1,Q&&e.drawing&&e.stopCheck())}e.stage&&e.stage.update()}}}function ie(Ce,ee,Me){if(!Ce.parent)return{x:ee,y:Me};if(le)if(k){var _e=Ce.getBounds().width,Ye=Ce.getBounds().height,je=Ce.getBounds().x,it=Ce.getBounds().y;_e<Ae.width?ee=Ae.x+(Ae.width-_e)/2+(Ce.regX-je):(ee-(Ce.regX-je)>Ae.x&&(ee=Ae.x+(Ce.regX-je)),ee-(Ce.regX-je)+_e<Ae.x+Ae.width&&(ee=Ae.x+Ae.width+(Ce.regX-je)-_e)),Ce.height<Ae.height?Me=Ae.y+(Ae.height-Ye)/2+(Ce.regY-it):(Me-(Ce.regY-it)>Ae.y&&(Me=Ae.y+(Ce.regY-it)),Me-(Ce.regY-it)+Ye<Ae.y+Ae.height&&(Me=Ae.y+Ae.height+(Ce.regY-it)-Ye))}else{if(le.type=="Blob")return le.shape.hitTestPoint(ee,Me)?{x:ee,y:Me}:{x:e.x,y:e.y};if(re=Ce.parent.localToGlobal(ee,Me),e.circleBounds){var Be=le.x+le.width/2,qe=le.y+le.height/2,et=e.circleBounds;if(t.dist(Be,qe,re.x,re.y)<=et)ee=re.x,Me=re.y;else{var ve=t.angle(Be,qe,re.x,re.y)*RAD;ee=Be+et*Math.cos(ve),Me=qe+et*Math.sin(ve)}}else ee=Math.max(le.x,Math.min(le.x+le.width,re.x)),Me=Math.max(le.y,Math.min(le.y+le.height,re.y));re=Ce.parent.globalToLocal(ee,Me),ee=re.x,Me=re.y}return{x:ee,y:Me}}function Se(Ce,ee,Me,_e,Ye){Math.abs(Ce.x-we)<.1&&Math.abs(Ce.y-D)<.1?(e.zimDragMoving=!1,Ce.x=_e,Ce.y=Ye,Ce.slideStartX=null,Ce.slideStartY=null,N&&(Ce.dispatchEvent("slidestop"),t.Ticker.remove(e.zimDragTicker)),e.type=="Pen"&&(e.zimDragCheck=!1,Q&&e.drawing&&e.stopCheck())):(we=ee,D=Me)}function Le(){e.zimDragTicker=function(){if(!n(e.slideStartX))if(te||(te=e),e.downCheck){var Ce;te.parent?Ce=te.parent.globalToLocal(e.dragMouseX,e.dragMouseY):Ce=new t.Point(0,0),J++,Z.push(Ce.x),ne.push(Ce.y),U.push(Date.now()),J>=q?(F=Z.shift(),p=ne.shift(),L=U.shift()):(F=Z[0],p=ne[0],L=U[0])}else{if(!e.zimDragMoving)return;z=fe,se=V;var ee,Me;i==BOTH?(ee=te.x+z,Me=te.y+se):i==HORIZONTAL?(ee=te.x+z,Me=te.y):i==VERTICAL&&(ee=te.x,Me=te.y+se),fe=z*g,V=se*g;var _e;le&&(_e=ie(te,ee,Me),(b===!0||b=="horizontal")&&(Math.round(ee)!=Math.round(_e.x)&&(Oe||(X.immediate(ee),Oe=!0),fe=0,ee=X.convert(_e.x)),b=="horizontal"&&(Me=_e.y)),(b===!0||b=="vertical")&&(Math.round(Me)!=Math.round(_e.y)&&(K||(K=!0,R.immediate(Me),V=0),Me=R.convert(_e.y)),b=="vertical"&&(ee=_e.x)),b||(ee=_e.x,Me=_e.y)),te.x=ee,te.y=Me,Se(te,te.x,te.y,ee,Me)}}}return e},t.noDrag=function(e,r){if(De("32"),n(e)||!e.on)return;if(n(r)&&(r=!0),r&&e.numChildren&&e.numChildren>1)for(var i=0;i<e.numChildren;i++){var l=e.getChildAt(i);a(l)}a(e);function a(s){s.cur&&s.cur("default"),s._draggable=!1,t.setSwipe(s,!0),s.off("added",s.zimAdded),s.off("removed",s.zimRemoved),s.off("mousedown",s.zimDown),s.off("pressmove",s.zimMove),s.off("pressup",s.zimUp),s.zmu&&(s.stage?s.stage.frame.off("mouseupplus",s.zmu):j.zdf.off("mouseupplus",s.zmu)),t.Ticker&&(s.zimDragSlide&&t.Ticker.remove(s.zimDragSlide),s.zimDragTicker&&t.Ticker.remove(s.zimDragTicker)),s.zimDragMoving=s.zimAdded=s.zimRemoved=s.zimDown=s.zimMove=s.zimUp=s.zimBoundary=s.zimDragSlide=null,s.slideStartX=s.slideStartY=s.zimDragImmediate=null,s.dragMouseX=s.zimPosition=s.dragMouseY=s.zimDown=s.zimUp=null,s.zimDragTicker=s.zimDragSlide=null}return e},t.dragBoundary=function(e,r){if(De("33"),!(n(e)||!e.on))return e.zimBoundary=r,e.zimDragMoving=!0,e.zimPosition&&e.zimPosition(),e},t.dragRect=t.dragBoundary,t.mouse=function(e){return De("33.1"),e.zimLastMouse&&(e.mouseChildren=e.zimLastMouse),e.mouseEnabled=!0,e.zimLastMouseEnabled=!0,e},t.noMouse=function(e){return De("33.15"),e.zimLastMouse=e.mouseChildren,e.mouseChildren=!1,e.mouseEnabled=!1,e.zimLastMouseEnabled=!1,e},t.wire=function(e,r,i,l,a,s,f,c){var x="source, target, prop, twoWay, setSource, filter, call, input",k;if(k=st(t.wire,arguments,x))return k;if(De("33.2"),n(t.Ticker)&&pt)return tt("wire() - requires ZIM Frame"),e;if(n(r)&&pt)return tt("wire() - requires a target"),e;var v=t.DEFAULTWIRE;return j.DEFAULTWIRE!=null&&(v=j.DEFAULTWIRE),n(c)&&(v&&v!="currentValue"&&v!="selectedIndex"||v&&Object.prototype.hasOwnProperty.call(e,v)?c=v:Object.prototype.hasOwnProperty.call(e,"currentValue")?c="currentValue":Object.prototype.hasOwnProperty.call(e,"selectedIndex")?c="selectedIndex":c=i),n(i)&&(i=c),e.addChild&&(e.zimWire=!0),r.addChild&&(r.zimWired=!0),t.Ticker.addWire(e,[r,i,l,a,s,f,c]),e},t.noWire=function(e,r,i,l){var a="source, target, prop, input",s;return(s=st(t.noWire,arguments,a))?s:(De("33.25"),n(t.Ticker)&&pt?(tt("noWire() - requires ZIM Frame"),e):(t.Ticker.removeWire(e,r,i,l),e))},t.wired=function(e,r,i,l,a,s,f,c){var x="target, source, prop, twoWay, setSource, filter, call, input",k;return(k=st(t.wired,arguments,x))?k:(De("33.3"),n(t.Ticker)&&pt?(tt("wired() - requires ZIM Frame"),e):(t.wire(r,e,i,l,a,s,f,c),e))},t.noWired=function(e,r,i,l){var a="target, source, prop, input",s;return(s=st(t.noWire,arguments,a))?s:(De("33.35"),n(t.Ticker)&&pt?(tt("noWired() - requires ZIM Frame"),e):(t.Ticker.removeWire(r,e,i,l),e))},typeof mt>"u")var mt;if(t.bind=function(e,r,i,l,a,s){var f="obj, id, props, extra, filter, bindObj",c;if(c=st(t.bind,arguments,f))return c;if(De("33.17"),!mt)return pt&&tt("bind() - needs a Bind() object created first"),e;if(n(r))return pt&&tt("bind() - needs a unique id"),e;var x=s||mt;return x.add(r,e,i,l,a),e},t.noBind=function(e,r,i,l,a){var s="obj, props, removeConnectionData, call, bindObj",f;if(f=st(t.noBind,arguments,s))return f;if(De("33.18"),!mt)return e;var c=a||mt;return c.remove(e,r,i,l),e},t.transform=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q){var J="obj, move, stretchX, stretchY, scale, rotate, allowToggle, visible, onTop, showStretch, showRotate, showScale, showReg, showBorder, borderColor, borderWidth, dashed, customCursors, handleSize, regSize, snapDistance, snapRotation, cache, events, ghostColor, ghostWidth, ghostDashed, ghostHidden, frame, container",Z;if(Z=st(t.transform,arguments,J))return Z;if(e.type=="AC"&&j.zdf)return j.zdf.ac("transform",arguments),e;if(De("33.5"),n(e)||!e.getBounds)return tt("zim methods - transform(): please provide object with bounds set"),e;if(!e.getBounds())return tt("zim methods - transform(): please setBounds() on object"),e;if(!e.parent)return tt("zim methods - transform(): object should be on stage first"),e;n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),e.width==0&&(i=!1),e.height==0&&(l=!1),n(a)&&(a=!0),n(s)&&(s=!0),n(f)&&(f=!0),n(c)&&(c=!0),n(x)&&(x=!0),n(k)&&(k=!!ne),n(v)&&(v=!!ne),n(g)&&(g=!0),n(b)&&(b=!0),n(E)&&(E=!0),n(A)&&(A="brown"),n(T)&&(T=1),n(m)&&(m=null),n($)&&($=null),m<0||$<0?m=$=null:m!=null&&$==null&&($=1),n(I)&&(I=!0),n(X)&&(X=!1),n(R)&&(R=j.zdf);var ne=j.M;n(w)&&(w=!ne),n(P)&&(P=ne?20:10),n(y)&&(y=16),n(C)&&(C=10),n(O)&&(O=5),n(_)&&(_=!0),n(Y)&&(Y=!1),(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&(Y=!0),e.mouseChildren=!1;var U=e.getConcatenatedMatrix().decompose(),B=e.stage?e.stage:R.stage;n(q)&&(q=B),n(R.eventRemove)&&(B.enableMouseOver(),R.ctrlKey=!1,R.shiftKey=!1,j.addEventListener("keydown",function(ze){R.altKey=ze.altKey,R.ctrlKey=ze.ctrlKey}),j.addEventListener("keyup",function(ze){R.altKey=ze.altKey,R.ctrlKey=ze.ctrlKey}));var d=e.getBounds(),u=new t.Shape({style:!1}),o=new t.Shape({style:!1}),S=new t.Shape({style:!1});o.mouseEnabled=!1,S.controlType="reg";var F=e.parent,p=u.graphics,L=o.graphics,we=S.graphics,D,N,ue,fe,V,z,se,Oe,K,ge=new t.Container({style:!1});ge.type="TransformControls";var Q=new t.Container({style:!1}),ce=new t.Container({style:!1}),G=new t.Container({style:!1}),le=new t.Container({style:!1}),Ae,re,xe,ke,te;n(e.zimMaskDynamic)||e.zimMaskApply();function pe(ze,wt){ze==wt&&new t.Triangle(16,12,12,"white",null,null,0).addTo(ze).mov(0,-13.5),new t.Triangle(16,12,12,"white",null,null,0).addTo(ze).mov(13.5).rot(90),ze==wt&&new t.Triangle(16,12,12,"white",null,null,0).addTo(ze).mov(0,13.5).rot(180),new t.Triangle(16,12,12,"white",null,null,0).addTo(ze).mov(-13.5).rot(-90),ze==wt&&new t.Triangle(10,7,7,"black",null,null,0).addTo(ze).mov(0,-13),new t.Triangle(10,7,7,"black",null,null,0).addTo(ze).mov(13).rot(90),ze==wt&&new t.Triangle(10,7,7,"black",null,null,0).addTo(ze).mov(0,13).rot(180),new t.Triangle(10,7,7,"black",null,null,0).addTo(ze).mov(-13).rot(-90),_&&ze.cache(-20,-20,40,40)}if(w){var he=new t.Container({style:!1}),ae=new t.Container({style:!1});pe(he,he),pe(ae,he);var Ee={"nw-resize":45,"ne-resize":-45,"n-resize":90,"e-resize":0}}function ie(){var ze=e;for(Ae=0,re=1,xe=1,ke=0,te=0;ze.parent;)Ae+=ze.rotation,re*=ze.scaleX,xe*=ze.scaleY,ke+=ze.skewX,te+=ze.skewY,ze=ze.parent}ie();var Se=Ae,Le=["nw-resize","ne-resize","nw-resize","ne-resize"],Ce=[2,3,0,1],ee,Me;for(Me=0;Me<4;Me++)g?(ee=new t.Rectangle(P,P,t.pink,t.grey,2,null,null,null,null,!1),ee.centerReg(Q),_&&ee.cache(-1,-1,P+2,P+2)):(ee=new t.Rectangle(P,P,"rgba(0,0,0,0)","rgba(0,0,0,0)",2,null,null,null,null,!1),ee.centerReg(Q),ee.expand(0)),ee.rotation=Ae,se=w?"none":Le[Me],ee.drag({overCursor:se,dragCursor:se,onTop:!1}),ee.controlType="corner",ee.cu=Le[Me];for(Me=0;Me<Ce.length;Me++)Q.getChildAt(Me).op=Q.getChildAt(Ce[Me]);var _e=["n-resize","e-resize","n-resize","e-resize"];for(Ce=[1,1,0,0],Me=0;Me<4;Me++){var Ye=Me%2==0?e.width/2:P,je=Me%2==0?P:e.height/2;k?(ee=new t.Rectangle(P,P,t.fog,t.dark,2,null,null,null,null,!1),ee.centerReg(Me%2==0?G:ce),_&&ee.cache(-1,-1,P+2,P+2)):(ee=new t.Rectangle(Ye,je,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),ee.centerReg(Me%2==0?G:ce),ee.expand(0)),ee.rotation=Ae,se=w?"none":_e[Me],ee.drag({overCursor:se,dragCursor:se,onTop:!1}),ee.controlType="side",ee.cu=_e[Me]}for(Me=0;Me<Ce.length;Me++){var it=Me%2==0?G:ce;it.getChildAt(Math.floor(Me/2)).op=it.getChildAt(Ce[Me])}var Be=["ne-resize","nw-resize","ne-resize","nw-resize"];for(Me=0;Me<4;Me++)v?(ee=new t.Circle(P,t.pink,null,null,null,null,null,null,!1),ee.addTo(le),_&&ee.cache(-P,-P,P*2,P*2)):(ee=new t.Circle(P,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),ee.addTo(le),ee.expand(0)),se=w?"none":Be[Me],ee.drag({overCursor:se,dragCursor:se,onTop:!1}),ee.controlType="rotate",ee.cu=Be[Me];var qe=1.8;le.alpha=.5,et();function et(){var ze=P*qe*t.sign(re),wt=P*qe*t.sign(xe);le.getChildAt(0).reg(ze,wt),le.getChildAt(1).reg(-ze,wt),le.getChildAt(2).reg(-ze,-wt),le.getChildAt(3).reg(ze,-wt),B.update()}function ve(){p.c(),L.c(),we.c(),D=e.localToLocal(d.x,d.y,q),N=e.localToLocal(d.x+d.width,d.y,q),ue=e.localToLocal(d.x+d.width,d.y+d.height,q),fe=e.localToLocal(d.x,d.y+d.height,q);var ze=e.localToLocal(d.x+d.width/2,d.y,q),wt=e.localToLocal(d.x+d.width,d.y+d.height/2,q),Wt=e.localToLocal(d.x+d.width/2,d.y+d.height,q),_t=e.localToLocal(d.x,d.y+d.height/2,q);V=e.localToLocal(e.regX,e.regY,q),z=e.localToLocal(d.x+d.width/2,d.y+d.height/2,q),K=[D,N,ue,fe],Oe=[ze,wt,Wt,_t],E&&(p.s(A),h&&p.sd([10,5],0),p.ss(T).mt(D.x,D.y).lt(N.x,N.y).lt(ue.x,ue.y).lt(fe.x,fe.y).lt(D.x,D.y).cp()),n(m)||(L.s(m),I&&L.sd([10,5],0),L.ss($).mt(D.x,D.y).lt(N.x,N.y).lt(ue.x,ue.y).lt(fe.x,fe.y).lt(D.x,D.y).cp()),u.setBounds(D.x,D.y,N.x-D.x,fe.y-D.y),b&&(we.s("#eee").ss(T).f("rgba(0,0,0,.1)").dc(0,0,y),we.s("#222").ss(T).dc(0,0,y*.3)),ie();for(var tn=Math.min(50,Math.abs(ke))*t.sign(ke),Ut=Math.min(50,Math.abs(te))*t.sign(te),yt=Ae*t.sign(re*xe)*t.sign(e.scaleX*e.scaleY),Vt=0;Vt<K.length;Vt++){var yn=K[Vt];Q.getChildAt(Vt).loc(yn.x,yn.y).ske(tn,Ut).rot(yt),le.getChildAt(Vt).loc(yn.x,yn.y).rot(yt);var $t=Oe[Vt],an=Vt%2==0?G:ce;an.getChildAt(Math.floor(Vt/2)).loc($t.x,$t.y).ske(tn,Ut).rot(yt),k||an.getChildAt(Math.floor(Vt/2)).sca(Vt%2==0?re/2:1,Vt%2==0?1:xe/2)}S.x=V.x,S.y=V.y}ve();var Pe=new t.Shape(1e3,1e3,null,null,null,!1);function oe(){Pe.x=0,Pe.y=0,Pe.graphics.c().f("rgba(0,0,0,.01)").mt(D.x,D.y).lt(N.x,N.y).lt(ue.x,ue.y).lt(fe.x,fe.y).lt(D.x,D.y).cp(),Pe.reg(V.x,V.y),Pe.x=V.x,Pe.y=V.y}oe(),ge.on("dblclick",function(ze){R.ctrlKey&&e.transformControls.visible&&(e.scaleX=1,e.scaleY=1,e.rotation=0,ve(),oe(),B.update()),kt(ze,!0)});var Fe=ge.on("mousedown",Xe),Ze=e.on("mousedown",Xe);function Xe(ze){var wt=B.getObjectUnderPoint(ze.stageX,ze.stageY,1);ne||wt&&(e.contains&&e.contains(wt)||!e.contains&&e==wt)?e.transformControls.visible||(w?(bt=!1,Pe.mouseEnabled=!1):R.canvas.style.cursor="move",e.transformControls.show(),e.dispatchEvent("transformshow")):e.transformControls.visible&&(!wt||!ge.contains(wt))&&(e.transformControls.hide(),e.dispatchEvent("transformhide"))}var We=B.on("stagemousedown",function(ze){var wt=B.getObjectUnderPoint(ze.stageX,ze.stageY,1),Wt=wt&&wt.parent&&wt.parent.layer&&wt.parent.layer==e;e.transformControls.visible&&(!wt||!ge.contains(wt)&&!Wt)&&(e.dispatchEvent("transformhide"),e.transformControls.hide())});f||(ge.off("mousedown",Fe),e.off("mousedown",Ze),B.off("stagemousedown",We));var de,Ve,be,Te,Re,Ne,Ue,rt,me,He,at,Qe,ct,ot=!1,dt=!1,$e,Mt,Ct=e.cursor,xt,Bt=new t.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);if(w){Bt.mouseEnabled=!1,Bt.mouseChildren=!1,Bt.addChild(ae),Q.on("mouseover",Je),Q.on("mouseout",gt),ce.on("mouseover",Je),ce.on("mouseout",gt),G.on("mouseover",Je),G.on("mouseout",gt),le.on("mouseover",Je),le.on("mouseout",gt);var Rt=new t.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);Rt.cursor="none"}Q.on("mousedown",Ht),Q.on("pressmove",nn),Q.on("pressup",kt),ce.on("mousedown",Ht),ce.on("pressmove",nn),ce.on("pressup",kt),G.on("mousedown",Ht),G.on("pressmove",nn),G.on("pressup",kt),le.on("mousedown",Ht),le.on("pressmove",en),le.on("pressup",kt);function Ht(ze){dt=!0,x&&It(),$e&&B.off("stagemousemove",$e),de=ze.target.x,Ve=ze.target.y,He=e.x,at=e.y,be=e.scaleX,Te=e.scaleY;var wt=q.globalToLocal(ze.stageX/t.scaX,ze.stageY/t.scaY);if(ze.target.controlType=="rotate"){ot=!0,Re=e.rotation;var Wt=wt.x,_t=wt.y,tn=F.localToLocal(He,at,q);Qe=tn.x,ct=tn.y,Ne=Math.atan2(_t-ct,Wt-Qe)*180/Math.PI}R.ctrlKey||ze.target.controlType=="rotate"?(Ue=Math.abs(de-e.x),rt=Math.abs(Ve-e.y)):(Ue=Math.abs(de-ze.target.op.x),rt=Math.abs(Ve-ze.target.op.y)),ze.target.controlType!="rotate"&&(me=ze.target.op.parent.localToLocal(ze.target.op.x,ze.target.op.y,e.parent)),Bt.stage?q.setChildIndex(Bt,q.getChildIndex(ge)):Bt.addTo(q,q.getChildIndex(ge)+1),Bt.x=wt.x,Bt.y=wt.y,Bt.cursor=w?"none":ze.target.cu,w&&(e.getConcatenatedMatrix().decompose(U),U.rotation||(U.rotation=0),ae.rotation=U.rotation*t.sign(re*xe)*t.sign(e.scaleX*e.scaleY)+Ee[ze.target.cu]+Se,ze.target.controlType!="side"&&re*xe<0&&(ae.rotation+=90),Rt.addTo(q,1).pos({x:wt.x,y:wt.y,reg:!0})),Pe.visible=!1,e.cursor="none"}function nn(ze){var wt=1;R.ctrlKey&&ze.target.controlType=="corner"?wt=Ue>rt?(ze.target.x-He)/(de-He):(ze.target.y-at)/(Ve-at):Ue>rt?de-ze.target.op.x&&(wt=(ze.target.x-ze.target.op.x)/(de-ze.target.op.x)):Ve-ze.target.op.y&&(wt=(ze.target.y-ze.target.op.y)/(Ve-ze.target.op.y)),ze.target.controlType=="corner"?(e.scaleX=wt*be,e.scaleY=wt*Te):(e.scaleX=ze.target.cu=="e-resize"?wt*be:be,e.scaleY=ze.target.cu=="n-resize"?wt*Te:Te),ve();var Wt=q.globalToLocal(ze.stageX/t.scaX,ze.stageY/t.scaY);if(Bt.x=Wt.x,Bt.y=Wt.y,w&&(Rt.x=Wt.x,Rt.y=Wt.y),!R.ctrlKey||ze.target.controlType=="side"){var _t=ze.target.op.parent.localToLocal(ze.target.op.x,ze.target.op.y,e.parent);e.x-=(_t.x-me.x)*t.sign(re)*t.sign(e.scaleX),e.y-=(_t.y-me.y)*t.sign(xe)*t.sign(e.scaleY)}if(ve(),e.transformControls.events){var tn=ze.target.controlType;Qt(ze,tn)}}function en(ze){var wt=q.globalToLocal(ze.stageX/t.scaX,ze.stageY/t.scaY),Wt=Math.atan2(wt.y-ct,wt.x-Qe)*180/Math.PI;if(R.shiftKey?e.rot(Math.round((Re+(Wt-Ne)*t.sign(re)*t.sign(e.scaleX))/45)*45):e.rot(Re+(Wt-Ne)*t.sign(re)*t.sign(e.scaleX)),ve(),Bt.x=wt.x,Bt.y=wt.y,w&&(e.getConcatenatedMatrix().decompose(U),U.rotation||(U.rotation=0),ae.rotation=U.rotation*t.sign(re*xe)*t.sign(e.scaleX*e.scaleY)+Ee[ze.target.cu]+Se,ze.target.controlType!="side"&&re*xe<0&&(ae.rotation+=90),Rt.x=wt.x,Rt.y=wt.y),ve(),e.transformControls.events){var _t=ze.target.controlType;Qt(ze,_t,null,!1)}}function kt(ze,wt){et();var Wt=ze?ze.target.controlType:"move";wt&&(Wt="reset"),w&&Rt.removeFrom(),Qt(ze,Wt,!0),B.update()}function Qt(ze,wt,Wt,_t){_t==null&&(_t=!0);var tn=!1;xt=null;var Ut=q.globalToLocal(ze.stageX/t.scaX,ze.stageY/t.scaY);wt=="move"?((e.x!=rn.x||e.y!=rn.y)&&(xt=new Ge.Event("transformed"),xt.transformType="move"),_t&&(tn=Pe.hitTestPoint(Ut.x,Ut.y))):wt=="corner"?((e.scaleX!=rn.scaleX||e.scaleY!=rn.scaleY)&&(xt=new Ge.Event("transformed"),xt.transformType="size"),_t&&(tn=Q.hitTestPoint(Ut.x,Ut.y))):wt=="side"?((e.scaleX!=rn.scaleX||e.scaleY!=rn.scaleY)&&(xt=new Ge.Event("transformed"),xt.transformType="stretch"),_t&&(tn=ce.hitTestPoint(Ut.x,Ut.y)||G.hitTestPoint(Ut.x,Ut.y))):wt=="rotate"?(e.rotation!=rn.rotation&&(xt=new Ge.Event("transformed"),xt.transformType="rotate"),_t&&(tn=le.hitTestPoint(Ut.x,Ut.y))):wt=="reg"?(e.regX!=rn.regX||e.regY!=rn.regY)&&(xt=new Ge.Event("transformed"),xt.transformType="reg"):wt=="reset"?(xt=new Ge.Event("transformed"),xt.transformType="reset"):(xt=new Ge.Event("transformed"),xt.transformType="unknown"),_t&&!tn&&(Bt.removeFrom(),R.canvas.style.cursor="default",e.cursor=Ct),xt&&(xt.pressup=Wt,(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize(),e.dispatchEvent(xt))}function Je(ze){if(!dt){Bt.stage?q.setChildIndex(Bt,q.getChildIndex(ge)):Bt.addTo(q,q.getChildIndex(ge)+1),Rt.addTo(q,1);var wt=q.globalToLocal(ze.stageX/t.scaX,ze.stageY/t.scaY);Bt.x=wt.x,Bt.y=wt.y,Rt.x=wt.x,Rt.y=wt.y,e.getConcatenatedMatrix().decompose(U),U.rotation||(U.rotation=0),ae.rotation=U.rotation*t.sign(re*xe)*t.sign(e.scaleX*e.scaleY)+Ee[ze.target.cu]+Se,ze.target.controlType!="side"&&re*xe<0&&(ae.rotation+=90),B.update(),$e&&B.off("stagemousemove",$e),$e=B.on("stagemousemove",function(Wt){var _t=q.globalToLocal(Wt.stageX/t.scaX,Wt.stageY/t.scaY);Bt.x=_t.x,Bt.y=_t.y,B.update()})}}function gt(){B.off("stagemousemove",$e),!dt&&(e.cursor=Ct,Bt.removeFrom(),Rt.removeFrom(),B.update())}function It(){if(x){var ze=F.numChildren-1;F.getChildAt(ze).type=="Keyboard"&&ze--,F.setChildIndex(e,ze),Xt()}}function Xt(){if(F==q)ge.removeFrom(),q.addChildAt(ge,q.getChildIndex(e)+1);else{for(var ze=F;ze.parent&&ze.parent!=q;)ze=ze.parent;e.stage&&(ge.parent==q&&q.removeChild(ge),q.addChildAt(ge,q.getChildIndex(ze)+1))}}var Yt,ft;S.drag(),S.on("mousedown",It),S.on("pressup",function(ze){if(!R.ctrlKey){for(var wt=0;wt<K.length;wt++)if(t.dist(S.x,S.y,K[wt].x,K[wt].y)<C){S.x=K[wt].x,S.y=K[wt].y;break}t.dist(S.x,S.y,z.x,z.y)<C&&(S.x=z.x,S.y=z.y)}var Wt=e.rotation;Yt=q.localToLocal(S.x,S.y,e),F==B?ft=new t.Point(S.x,S.y):ft=q.localToLocal(S.x,S.y,F),e.reg(Yt.x,Yt.y),e.rotation=0,e.x=e.x+ft.x-e.x,e.y=e.y+ft.y-e.y,e.rotation=Wt,ve(),oe(),kt(ze),B.update()});var bt=!0;se=w?"none":"move",Pe.drag({overCursor:se,dragCursor:se,onTop:!1}),Pe.controlType="move",w&&(Pe.on("mouseover",Kt),Pe.on("mouseout",Gt));function Gt(){B.off("stagemousemove",Mt),!dt&&(he.removeFrom(ge),B.update())}function Kt(ze){if(!(dt||!w||!bt)){var wt=q.globalToLocal(ze.stageX/t.scaX,ze.stageY/t.scaY);he.addTo(ge).pos({x:wt.x,y:wt.y,reg:!0}),B.update(),Mt&&B.off("stagemousemove",Mt),Mt=B.on("stagemousemove",function(Wt){var _t=q.globalToLocal(Wt.stageX/t.scaX,Wt.stageY/t.scaY);he.x=_t.x,he.y=_t.y,B.update()})}}Pe.on("mousedown",It),Pe.on("pressmove",function(ze){if(e.transformControls.visible){var wt;if(F==B?wt=new t.Point(Pe.x,Pe.y):wt=q.localToLocal(Pe.x,Pe.y,F),e.x=wt.x,e.y=wt.y,ve(),e.transformControls.events){var Wt="move";Qt(ze,Wt)}}}),Pe.on("pressup",function(ze){e.transformControls.visible&&kt(ze)});var fn=B.on("stagemouseup",function(){dt=!1,Pe.mouseEnabled=!0,bt||(xt=new Ge.Event("transformed"),e.x!=rn.x||e.y!=rn.y?xt.transformType="move":xt.transformType="select",xt.pressup=!0,e.dispatchEvent(xt)),bt=!0,Pe.visible=!0,ot&&!R.ctrlKey&&O>1&&(e.rotation=Math.round(e.rotation/O)*O,ve()),oe(),Pe.mouseEnabled=!0,ot=!1,B.update()});function Jt(){rn={x:e.x,y:e.y,rotation:e.rotation,regX:e.regX,regY:e.regY,scaleX:e.scaleX,scaleY:e.scaleY}}var rn;Jt();var jt=e.on("mousedown",Jt);ge.on("mousedown",Jt),ge.addChild(u),r&&ge.addChild(Pe),a&&ge.addChild(Q),i&&ge.addChild(ce),l&&ge.addChild(G),s&&ge.addChild(le),ge.addChild(S);var gn;r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),gn=e.on("pressmove",function(ze){if(ve(),oe(),et(),e.transformControls.events){var wt="move";Qt(ze,wt)}}));var vt=f;return e.transformControls={visible:c,events:Y,ghost:!n(m),ghostEnabled:!n(m),show:function(){return x&&It(),Xt(),e.toggled=!0,e.transformControls.visible=!0,o.parent&&o.removeFrom(),B.update(),e},hide:function(){if(e.transformControls.ghost)var ze=q.getChildIndex(ge);return q.removeChild(ge),e.transformControls.ghost&&e.transformControls.ghostEnabled&&q.addChildAt(o,ze),e.toggled=!1,e.transformControls.visible=!1,w&&($e&&B.off("stagemousemove",$e),Mt&&B.off("stagemousemove",Mt),dt=!1,Bt.removeFrom(),Rt.removeFrom()),r||e.cur(Ct),B.update(),e},remove:function(ze){ze||e.transformControls.hide(),f=!1,r&&(e.noDrag(),e.off("pressmove",gn))},add:function(ze){ze||e.transformControls.show(),f=vt,r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),gn=e.on("pressmove",gn))},allowToggleOn:function(){f=vt=!0,Fe=ge.on("mousedown",Fe),Ze=e.on("mousedown",Ze),We=B.on("stagemousedown",We)},allowToggleOff:function(){f=vt=!1,ge.off("mousedown",Fe),e.off("mousedown",Ze),B.off("stagemousedown",We)},disable:function(){ge.mouseChildren=!1,ge.mouseEnabled=!1,r&&(e.noDrag(),e.off("pressmove",gn))},enable:function(){ge.mouseChildren=!0,ge.mouseEnabled=!0,r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),gn=e.on("pressmove",gn))},recordData:function(ze){var wt={type:e.type,index:F.getChildIndex(e),x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation,skewX:e.skewX,skewY:e.skewY,regX:e.regX,regY:e.regY,controls:e.transformControls.visible};return ze?JSON.stringify(wt):wt},setData:function(ze,wt){if(!n(ze)){wt&&(ze=JSON.parse(ze)),delete ze.controls;var Wt=ze.index;n(Wt)&&(Wt=0),delete ze.index;for(var _t in ze)e[_t]=ze[_t];return setTimeout(function(){ve(),oe(),et(),F.setChildIndex(e,Wt),e.transformControls.visible&&e.type!="Layer"?e.transformControls.show():e.transformControls.hide(),e.transformControls.ghost&&!e.transformControls.ghostEnabled&&!e.transformControls.visible&&q.addChild(o)},90),e}},hideGhost:function(){e.transformControls.ghost=!1,o.removeFrom()},showGhost:function(){if(e.transformControls.ghost=!0,e.transformControls.ghostEnabled&&!e.transformControls.visible){for(var ze=F;ze.parent&&ze.parent!=q;)ze=ze.parent;o.stage?q.setChildIndex(o,q.getChildIndex(ze)+1):q.addChildAt(o,q.getChildIndex(ze)+1)}},addGhost:function(){$>0?(e.transformControls.ghostEnabled=!0,e.transformControls.showGhost()):pt&&tt("transform() - ghostWidth must be > 0 when making transform")},removeGhost:function(){e.transformControls.ghostEnabled=!1,e.transformControls.hideGhost()},resize:function(ze){if(F=e.parent,ve(),oe(),et(),c&&e.transformControls.show(),ze){var wt=new Ge.Event("transformed");wt.pressup=!0,wt.transformType="resize",e.dispatchEvent(wt)}return e},dispose:function(){e.transformControls.hide(),f=!1,r&&(e.noDrag(),e.off("pressmove",gn)),e.transformControls.hideGhost(),Pe.removeAllEventListeners(),le.removeAllEventListeners(),S.removeAllEventListeners(),ce.removeAllEventListeners(),G.removeAllEventListeners(),Q.removeAllEventListeners(),ge.removeAllEventListeners(),Ze&&e.off("mousedown",Ze),Fe&&e.off("mousedown",Fe),We&&B.off("stagemousedown",We),$e&&B.off("stagemousemove",$e),Mt&&B.off("stagemousemove",Mt),fn&&B.off("stagemouseup",fn),jt&&e.off("mousedown",jt),gn&&e.off("pressmove",gn),ge=Bt=Rt=null,e.transformControls=null},controls:ge,scaleControls:Q,stretchXControls:ce,stretchYControls:G,rotateControls:le},e.toggle=function(ze){return ze===!0?e.transformControls.show():ze===!1||e.transformControls.visible?e.transformControls.hide():e.transformControls.show(),e},e.transformControls.ghost&&(e.transformControls.toggleGhost=function(ze){return ze===!0?e.transformControls.showGhost():ze===!1||e.transformControls.visible?e.transformControls.hideGhost():e.transformControls.showGhost(),e}),c?e.transformControls.show():!X&&e.transformControls.ghost&&e.transformControls.showGhost(),e},t.gesture=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T){var h="obj, move, scale, rotate, boundary, minScale, maxScale, snapRotate, localBoundary, slide, slideFactor, regControl, onTop, surround, circularBounds, rect",w;if(w=st(t.gesture,arguments,h))return w;if(De("34.5"),n(e)||!e.on)return;n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),n(x)&&(x=!1),n(c)&&(c=1),n(k)&&(k=!1),n(v)&&(v=5),n(g)&&(g=!1),n(b)&&(b=!0),n(E)&&(E=!1),E&&l&&(E=T=null,pt&&tt("gesture() - does not support surround when rotate is true")),n(A)&&(A=!1),n(a)&&!n(T)&&(a=T);var P,y,C,O,_=Tt();if(n(e.zimMaskDynamic)||e.zimMaskApply(),!e.zimTouch){var Y=new t.Damp(e.scaleX,.05),m=new t.Damp(e.scaleY,.05),$=e.scaleX/e.scaleY;if(e.zimTouch={move:r,scale:i,rotate:l,pointers:{},checkBounds:function(o,S){if(e.zimTouch.boundary){var F=e.zimTouch.boundary,p=e.parent.localToLocal(o,S,e.parent);E?(o=Math.min(F.x,Math.max(F.x+F.width,p.x)),S=Math.min(F.y,Math.max(F.y+F.height,p.y))):(o=Math.max(F.x,Math.min(F.x+F.width,p.x)),S=Math.max(F.y,Math.min(F.y+F.height,p.y))),p=e.parent.globalToLocal(o,S),o=p.x,S=p.y}return{x:o,y:S}}},a){e.zimTouch.boundary=a,x&&(e.zimTouch.boundary=t.boundsToGlobal(e.parent,a)),e.zimTouch.boundaryStartX=e.zimTouch.boundary.x,e.zimTouch.boundaryStartY=e.zimTouch.boundary.y,e.zimTouch.boundaryStartW=e.zimTouch.boundary.width,e.zimTouch.boundaryStartH=e.zimTouch.boundary.height;var I=e.zimTouch.checkBounds(e.x,e.y);e.x=I.x,e.y=I.y}k&&(C=10,O=5,y=0,P=[],e.zimTouch.slideInterval=t.interval(C/(_=="s"?1e3:1),function(){P[y++%O]=[e.x,e.y]}),e.zimTouch.slideInterval.pause(),e.animate({x:e.x,y:e.y},10/(_=="s"?1e3:1),"quadOut"));var X,R,q,J,Z,ne,U,B;e.zimTouch.mousedown=e.on("mousedown",function(o){if(n(B)?B=1:B++,b){var S=e.parent.numChildren-1;e.parent.getChildAt(S).type=="Keyboard"&&S--,e.parent.setChildIndex(e,S),e.ZIMoutlineShape&&e.outline()}g||(U=null,R=e.scaleX,q=e.scaleY,J=e.rotation,Z=e.regX,ne=e.regY,e.reg(0,0),X=e.getMatrix(),e.regX=Z,e.regY=ne);var F="id"+Math.abs(o.pointerID+1),p=e.parent.globalToLocal(o.stageX/t.scaX,o.stageY/t.scaY);e.zimTouch.pointers[F]={startX:p.x,startY:p.y,x:p.x,y:p.y},(e.zimTouch.move||e.zimTouch.rotate)&&(e.zimTouch.total=0,t.loop(e.zimTouch.pointers,function(){e.zimTouch.total++})),k&&e.zimTouch.total==1&&e.zimTouch.slideInterval.pause(!1),d()}),e.zimTouch.pressmove=e.on("pressmove",function(o){var S="id"+Math.abs(o.pointerID+1),F=e.parent.globalToLocal(o.stageX/t.scaX,o.stageY/t.scaY);e.zimTouch.pointers[S]&&(e.zimTouch.pointers[S].x=F.x,e.zimTouch.pointers[S].y=F.y);var p=0,L=0,we=0,D=0,N=0,ue=0;if(t.loop(e.zimTouch.pointers,function(pe,he){p+=he.x-he.startX,L+=he.y-he.startY,we+=he.x,D+=he.y}),e.zimTouch.total!=0){N=p/e.zimTouch.total,ue=L/e.zimTouch.total,p=e.zimTouch.startX+N,L=e.zimTouch.startY+ue,we=we/e.zimTouch.total,D=D/e.zimTouch.total;var fe={x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation};if(e.zimTouch.move){var V=e.zimTouch.checkBounds(p,L);fe.x=V.x,fe.y=V.y}if(e.zimTouch.pair.length==2){var z=e.zimTouch.pair[0],se=e.zimTouch.pair[1];if(e.zimTouch.scale){var Oe=Math.sqrt(Math.pow(se.startX-z.startX,2)+Math.pow(se.startY-z.startY,2)),K=Math.sqrt(Math.pow(se.x-z.x,2)+Math.pow(se.y-z.y,2)),ge=e.zimTouch.startSX+(K/Oe-1),Q=e.zimTouch.startSY+(K/Oe-1);fe.scaleX=ge,fe.scaleY=Q,fe.scaleX=Y.convert(ge),fe.scaleY=m.convert(Q);var ce=!n(s)&&Math.min(ge,Q)<s,G=!n(f)&&Math.max(ge,Q)>f;(ce||G)&&(ce?$>1?(fe.scaleY=s,fe.scaleX=s*$):(fe.scaleX=s,fe.scaleY=s/$):G&&($>1?(fe.scaleX=f,fe.scaleY=f/$):(fe.scaleY=f,fe.scaleX=f*$)),Y.immediate(fe.scaleX),m.immediate(fe.scaleY))}if(e.zimTouch.rotate){var le=Math.atan2(z.startY-se.startY,z.startX-se.startX)*(180/Math.PI),Ae=Math.atan2(z.y-se.y,z.x-se.x)*(180/Math.PI),re=Ae-le;fe.rotation=e.zimTouch.startR+re}if(g)e.scaleX=fe.scaleX,e.scaleY=fe.scaleY,e.rotation=fe.rotation,e.zimTouch.move&&(e.x=fe.x,e.y=fe.y);else{e.reg(0,0);var xe=e.parent.localToGlobal(we,D);we=xe.x,D=xe.y;var ke=n(U)?e.globalToLocal(we,D):e.globalToLocal(U.x,U.y),te=X.clone().translate(ke.x,ke.y).rotate(fe.rotation-J).scale(fe.scaleX/R,fe.scaleY/q).translate(-ke.x,-ke.y);te.decompose(e),e.zimTouch.move&&(e.x+=N,e.y+=ue),U=e.localToGlobal(ke.x,ke.y),e.reg(Z,ne)}e.zimTouch.scale&&e.dispatchEvent("scale"),e.zimTouch.rotate&&e.dispatchEvent("rotate"),e.zimTouch.move&&e.dispatchEvent("move")}else e.x=fe.x,e.y=fe.y,e.zimTouch.move&&e.dispatchEvent("move");(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize(),e.ZIMoutlineShape&&e.outline(),e.getStage&&e.stage&&e.stage.update()}}),e.on("mousedown",function(){var o=1;e.stage.on("stagemousedown",function(){o++}),e.stage.on("stagemouseup",function(){o--,o==0&&setTimeout(function(){e.zimTouch&&(e.zimTouch.total=0),e.zimTouch&&(e.zimTouch.pointers={}),B=null},50)})},null,!0),e.zimTouch.pressup=e.on("pressup",function(o){var S="id"+Math.abs(o.pointerID+1);if(delete e.zimTouch.pointers[S],(e.zimTouch.move||e.zimTouch.rotate)&&e.zimTouch.total--,l&&!n(c)&&e.zimTouch.total==0&&(c>0?e.rotation=Math.round(e.rotation/c)*c:c==0&&(e.rotation=Math.round(e.rotation))),k&&e.zimTouch.total==0&&B==1){e.zimTouch.slideInterval.pause();var F=P[(y+1)%P.length],p=P[y%P.length],L=e.x+(F[0]-p[0])*v,we=e.y+(F[1]-p[1])*v,D=e.zimTouch.checkBounds(L,we),N=O*C*v*Math.min((e.x-D.x)/(e.x-L)||1,(e.y-D.y)/(e.y-we)||1);e.animate({x:D.x,y:D.y},N/(_=="s"?1e3:1),"quadOut",function(){e.dispatchEvent("slidestop")})}e.zimTouch.total==0&&(B=null),e.getStage&&e.stage&&e.stage.update(),d()}),a&&(u(),e.on("move",u))}function d(){e.zimTouch.pair=[],t.loop(e.zimTouch.pointers,function(o,S,F){S.startX=S.x,S.startY=S.y,F<=1&&e.zimTouch.pair.push(S)}),e.zimTouch.startX=e.x,e.zimTouch.startY=e.y,e.zimTouch.startSX=e.scaleX,e.zimTouch.startSY=e.scaleY,e.zimTouch.startR=e.rotation}function u(){var o=e.localToGlobal(e.regX,e.regY),S;if(A){var F=e.parent.localToGlobal(e.x-e.width/2,e.y-e.height/2),p=e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2);S={x:F.x,y:F.y,width:p.x-F.x,height:p.y-F.y}}else S=e.boundsToGlobal();var L={x:e.zimTouch.boundaryStartX+o.x-S.x,y:e.zimTouch.boundaryStartY+o.y-S.y,width:e.zimTouch.boundaryStartW-S.width,height:e.zimTouch.boundaryStartH-S.height};e.gestureBoundary(L,!1)}return e},t.noGesture=function(e,r,i,l){var a="obj, move, scale, rotate",s;if(s=st(t.noGesture,arguments,a))return s;if(De("34.6"),!(n(e)||!e.on||!e.zimTouch))return n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),e.zimTouch.move=!r,e.zimTouch.scale=!i,e.zimTouch.rotate=!l,!e.zimTouch.move&&!e.zimTouch.scale&&!e.zimTouch.rotate&&(e.off("mousedown",e.zimTouch.mousedown),e.off("pressmove",e.zimTouch.pressmove),e.off("pressup",e.zimTouch.pressup),delete e.zimTouch),e},t.gestureBoundary=function(e,r,i){if(De("34.7"),!(n(e)||!e.on)&&!(n(r)||!e.zimTouch)){e.zimTouch.localBoundary&&e.parent?e.zimTouch.boundary=t.boundsToGlobal(e.parent,r):e.zimTouch.boundary=r,n(i)&&(i=!0),i&&(e.zimTouch.boundaryStartX=r.x,e.zimTouch.boundaryStartY=r.y,e.zimTouch.boundaryStartW=r.width,e.zimTouch.boundaryStartH=r.height);var l=e.zimTouch.checkBounds(e.x,e.y);return e.x=l.x,e.y=l.y,e}},t.effect=function(e,r,i,l,a,s){if(De("33.16"),n(r))return e;n(e.effects)&&(e.effects={}),Array.isArray(r)||(r=[r]);for(var f=0,c=0;c<r.length;c++){var x=r[c];x.type||(x instanceof Ge.BlurFilter?x.type="BlurEffect":x instanceof Ge.ColorFilter?x.type="ColorEffect":x instanceof Ge.AlphaMaskFilter?x.type="AlphaEffect":x instanceof Ge.ColorMatrixFilter?x.type="MultiEffect":n(x.type)&&(x.type="custom"+f++));var k=x.type.replace(/effect/i,"");e.effects[k.toLowerCase()]=x}e.filters=[];for(var v in e.effects)e.filters.push(e.effects[v]);return e.cache(i,l,a,s),e},t.updateEffects=function(e,r){return De("33.163"),e.updateCache&&(r?e.cache():e.updateCache()),e},t.noEffect=function(e,r,i){if(De("33.165"),n(i)&&(i=!1),n(r)){var l;e.effects.multi&&(l=e.effects.multi),e.effects={},l&&(e.effects.multi=l)}else{e.effects||(e.effects={}),Array.isArray(r)||(r=[r]);for(var a=0;a<r.length;a++){var s=r[a].replace(/effect/i,"");delete e.effects[s.toLowerCase()]}}e.filters=[];for(var f in e.effects)e.filters.push(e.effects[f]);return i||e.filters.length>0?e.updateCache&&e.updateCache():e.uncache&&e.uncache(),e},t.addPhysics=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E){var A="obj, dynamic, contract, shape, friction, linear, angular, density, bounciness, maskBits, categoryBits, physics, restitution, sensor",T;if(T=st(t.addPhysics,arguments,A))return T;if(De("34.8"),n(g)){if(typeof zimPhysics>"u")return pt&&tt("ZIM Physics module must be imported"),e;n(j.zimDefaultPhysics)&&(j.zimDefaultPhysics=new t.Physics),g=j.zimDefaultPhysics}e.physics=g;var h="rectangle";return e.type=="Circle"||e.type=="Dial"?h="circle":e.type=="Triangle"?h="triangle":e.type=="Blob"&&(h="poly"),n(l)&&(l=h),n(x)&&(x=b),Ke(e,r,i,l,a,s,f,c,x,k,v,E),e},t.removePhysics=function(e){return De("34.85"),n(e.physics)||(e==e.physics.followObj&&e.physics.follow(null),e.follow=e.noFollow=e.control=e.noControl=e.sleep=e.wake=null,e.impulse=e.force=e.spin=e.torque=null,e.physics.remove(e.body),e.physics=null),e},t.hitTestPoint=function(e,r,i,l){if(t.zimhtp||(De("35"),t.zimhtp=!0),!e.stage||n(r)||n(i))return!1;if(!(n(e)||!e.globalToLocal)){if(n(l)&&(l=!0),l){var a=e.getBounds();if(a){var s=e.globalToLocal(r,i);if(s.x>a.x+a.width||s.x<a.x||s.y>a.y+a.height||s.y<a.y)return!1}}var f={x:r,y:i};return e.image||e.spriteSheet||e.type=="Shape"?f=e.globalToLocal(f.x,f.y):f=e.globalToLocal(f.x*t.scaX,f.y*t.scaY),e.hitTest(f.x,f.y)}},t.hitTestReg=function(e,r,i){if(t.zimhtr||(De("36"),t.zimhtr=!0),!e.stage||!r.stage)return!1;if(!(n(e)||n(r)||!e.localToLocal||!r.localToLocal)){n(i)&&(i=!0);var l=r.localToGlobal(r.regX,r.regY),a=e.getBounds();if(i&&a){var s=e.globalToLocal(l.x,l.y);if(s.x>a.x+a.width||s.x<a.x||s.y>a.y+a.height||s.y<a.y)return!1}return e.image||e.spriteSheet||e.type=="Shape"?l=e.globalToLocal(l.x,l.y):l=e.globalToLocal(l.x*t.scaX,l.y*t.scaY),e.hitTest(l.x,l.y)}},t.hitTestRect=function(e,r,i,l,a){if(t.zimhtr||(De("37"),t.zimhtr=!0),!e.stage||!r.stage)return!1;if(n(e)||n(r)||!e.hitTest||!r.getBounds)return;n(i)&&(i=0),n(l)&&(l=!0);var s=r.getBounds();if(!s){pt&&tt(`hitTestRect():
 please setBounds() on param b object`);return}if(l){var f=e.getBounds();if(f&&!t.hitTestBounds(e,r))return!1}function c(A){if(e.image||e.spriteSheet||e.type=="Shape"?A=e.globalToLocal(A.x,A.y):A=e.globalToLocal(A.x*t.scaX,A.y*t.scaY),e.hitTest(A.x,A.y))return!0}var x=s.x+s.width/2,k=s.y+s.height/2,v=r.localToGlobal(x,k),g,b;if(a){if(!c(v))return!1;for(var E=0;E<=i;E++)if(g=s.width*(E+1)/(i+1),b=s.height*(E+1)/(i+1),v=r.localToGlobal(s.x+g,s.y),!c(v)||(v=r.localToGlobal(s.x+s.width,s.y+b),!c(v))||(v=r.localToGlobal(s.x+s.width-g,s.y+s.height),!c(v))||(v=r.localToGlobal(s.x,s.y+s.height-b),!c(v)))return!1;return!0}else{if(c(v))return!0;for(var E=0;E<=i;E++)if(g=s.width*(E+1)/(i+1),b=s.height*(E+1)/(i+1),v=r.localToGlobal(s.x+g,s.y),c(v)||(v=r.localToGlobal(s.x+s.width,s.y+b),c(v))||(v=r.localToGlobal(s.x+s.width-g,s.y+s.height),c(v))||(v=r.localToGlobal(s.x,s.y+s.height-b),c(v)))return!0}},t.hitTestCircle=function(e,r,i,l,a){if(t.zimhtc||(De("38"),t.zimhtr=!0),De("38"),!e.stage||!r.stage||n(e)||n(r)||!e.hitTest||!r.getBounds)return;n(i)&&(i=8),n(l)&&(l=!0);var s=r.getBounds();if(!s){pt&&tt(`hitTestCircle():
 please setBounds() on param b object`);return}var f=e.getBounds();if(l&&f&&!t.hitTestBounds(e,r))return!1;function c(h){if(e.image||e.spriteSheet||e.type=="Shape"?h=e.globalToLocal(h.x,h.y):h=e.globalToLocal(h.x*t.scaX,h.y*t.scaY),e.hitTest(h.x,h.y))return!0}var x=s.x+s.width/2,k=s.y+s.height/2,v=r.localToGlobal(x,k),g=(s.width+s.height)/2/2,b,E,A;if(a){if(!c(v))return!1;for(var T=0;T<i;T++)if(b=T/i*2*Math.PI,E=x+g*Math.cos(b),A=k+g*Math.sin(b),v=r.localToGlobal(E,A),!c(v))return!1;return!0}else{if(c(v))return!0;for(var T=0;T<i;T++)if(b=T/i*2*Math.PI,E=x+g*Math.cos(b),A=k+g*Math.sin(b),v=r.localToGlobal(E,A),c(v))return!0}return!1},t.hitTestCircleRect=function(e,r,i){if(t.zimhtcr||(De("38.2"),t.zimhtcr=!0),!(!e.stage||!r.stage)){var l=e.stage;if(!(n(e)||n(r)||!e.getBounds||!r.getBounds)){var a=e.getBounds(),s=r.getBounds();if(!a||!s){pt&&tt(`hitTestCircleRect():
 please setBounds() on both objects`);return}n(i)&&(i=0);var f=(e.radius?e.radius:(a.width+a.height)/2)+i,c=e.getConcatenatedMatrix().decompose().scaleX;f*=c/l.scaleX;var x=r.boundsToGlobal(),k=e.localToGlobal(0,0),v=k.x,g=k.y,b=x.x,E=x.y,A=x.x+x.width,T=x.y+x.height,h=v<b?b:v>A?A:v,w=g<E?E:g>T?T:g,P=h-v,y=w-g;return P*P+y*y<=f*f}}},t.hitTestCircles=function(e,r,i){if(t.zimhtcs||(De("38.5"),t.zimhtcs=!0),!(!e.stage||!r.stage)){var l=e.stage;if(!(n(e)||n(r)||!e.hitTest||!e.getBounds||!r.getBounds)){var a=e.getBounds(),s=r.getBounds();if(!a||!s){pt&&tt(`hitTestCircles():
 please setBounds() on both objects`);return}n(i)&&(i=0);var f=e.localToGlobal(a.x+a.width/2,a.y+a.height/2),c=r.localToGlobal(s.x+s.width/2,s.y+s.height/2),x=e.getConcatenatedMatrix(),k=r.getConcatenatedMatrix(),v=Math.sqrt(x.a/l.scaleX*x.a/l.scaleX+x.c/l.scaleX*x.c/l.scaleX),g=Math.sqrt(x.b/l.scaleY*x.b/l.scaleY+x.d/l.scaleY*x.d/l.scaleY),b=Math.sqrt(k.a/l.scaleX*k.a/l.scaleX+k.c/l.scaleX*k.c/l.scaleX),E=Math.sqrt(k.b/l.scaleY*k.b/l.scaleY+k.d/l.scaleY*k.d/l.scaleY),A=Math.sqrt(Math.abs(Math.pow(f.x-c.x,2)+Math.pow(f.y-c.y,2)));return a.width*Math.max(v,g)/2+s.width*Math.max(b,E)/2>=A-i}}},t.hitTestBounds=function(e,r,i,l){if(t.zimhtb||(De("39"),t.zimhtb=!0),!(!e.stage||!r.stage)&&!(n(e)||n(r)||!e.getBounds||!r.getBounds)){var a=!1;l&&l.graphics&&(a=!0);var s=e.getBounds(),f=r.getBounds();if(!s||!f){pt&&tt(`hitTestBounds():
 please setBounds() on both objects`);return}n(i)&&(i=0);var c=t.boundsToGlobal(e),x=t.boundsToGlobal(r);if(a){var k=l.graphics;k.c(),k.ss(1).s("blue"),k.r(c.x,c.y,c.width,c.height),k.s("green"),k.r(x.x,x.y,x.width,x.height),l.stage.update()}return t.rectIntersect(c,x,i)}},t.hitTestPath=function(e,r,i,l,a,s){if(t.zimhtpa||(De("37.5"),t.zimhtpa=!0),!e.stage||!r.stage||n(e)||n(r)||!e.hitTest||r.type!="Squiggle"&&r.type!="Blob")return;var f=e.getBounds();n(i)&&(i=2),n(l)&&(l=!1),n(a)&&(a=!1),n(s)&&(s=!1);var c=[],x;function k(A){var T;if(e.image||e.spriteSheet||e.type=="Shape"?T=e.globalToLocal(A.x,A.y):T=e.globalToLocal(A.x*t.scaX,A.y*t.scaY),e.hitTest(T.x,T.y))if(a)c.push({x:Math.round(A.x),y:Math.round(A.y)});else if(s)x=g/v.length*100;else return!0}var v=r.interpolate(i,null,!0,null,!0),g,b;if(l)for(r.hitPathPoints?r.hitPathPoints.removeAllChildren():r.hitPathPoints=new t.Container().addTo(),r.hitPathPoints.top(),g=0;g<v.length;g++)b=v[g],b=r.localToGlobal(b.x,b.y),new t.Circle(3).loc(b.x,b.y,r.hitPathPoints);if(f){var E=t.boundsAroundPoints(v);if(!t.rectIntersect(e.boundsToGlobal(f),r.boundsToGlobal(E)))return!1}for(g=0;g<v.length;g++){if(b=v[g],b=r.localToGlobal(b.x,b.y),k(b))return!0;if(x!=null)return x}return c.length>0?c:!1},t.hitTestGrid=function(e,r,i,l,a,s,f,c,x,k,v,g,b){if(t.zimhtg||(De("41"),t.zimhtg=!0),!e.stage)return!1;if(!n(e)&&!g){var E=e.globalToLocal(s,f);s=E.x,f=E.y}n(c)&&(c=0),n(x)&&(x=0),n(k)&&(k=0),n(v)&&(v=0),r+=k,i+=v;var A=r/l,T=i/a,h=Math.min(l-1,Math.max(0,Math.floor((s-c+k/2)/A))),w=Math.min(a-1,Math.max(0,Math.floor((f-x+v/2)/T)));if(!(b!="open"&&(s-c>A*(h+1)-k||s-c<A*h||f-x>T*(w+1)-v||f-x<T*w))){var P=w*l+h;if(n(b)||b=="index")return P;if(b=="col")return h;if(b=="row")return w;if(b=="array"||b=="open")return[P,h,w]}},t.animate=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le,Ae,re){var xe="target, props, time, ease, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startCall, startParams, animateCall, animateParams, sequence, sequenceCall, sequenceParams, sequenceReverse, ticker, cjsProps, css, protect, override, from, set, id, events, sequenceTarget, dynamic, drag, clamp, startPaused, clean, obj, seriesWait, sequenceWait, rate, pauseOnBlur, easeAmount, easeFrequency, timeUnit, timeCheck, noAnimateCall, pathDamp";if(e&&(e.props||e.obj)){var ke;if(ke=st(t.animate,arguments,xe))return ke}if(e.type=="AC"&&j.zdf)return j.zdf.ac("animate",arguments),e;if(t.animateCheck||(De("45"),t.animateCheck=!0),!e)return;var te=t.ANIMATE;if(j.ANIMATE!=null&&(te=j.ANIMATE),!te)return n(Ae)&&(Ae=!0),a&&Ae&&typeof a=="function"&&a(n(s)?e:s),e;n(le)&&(le=!0);var pe=Tt(null,G,null,null,n(le)?!1:!le);(v||b||g)&&(k=!0),(Y||y||Y||m||P)&&(w=!0);var he,ae,Ee,ie=arguments,Se=Array.prototype.slice.call(arguments);if(n(r)&&!n(z)&&(r=z),z=r,n(z))return pt&&tt("animate() - need props"),e;if(e.type=="BeadsContainer"&&n(q)&&(q=0),e.type=="Tone"&&(ge=!1),ge===!1?t.pauseAnimateOnBlur=!1:(ge||n(ge)&&t.pauseAnimateOnBlur!==!1)&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseAnimateOnBlur=!0),!(!n(q)&&e.addChild)){i=t.Pick.choose(i),l=t.Pick.choose(l),f=t.Pick.choose(f),v=t.Pick.choose(v),g=t.Pick.choose(g),w=t.Pick.choose(w),P=t.Pick.choose(P),n(Y)?Y=i:Y=t.Pick.choose(Y),ne=t.Pick.choose(ne),S=t.Pick.choose(S),F=t.Pick.choose(F);var Le=["loopCount","loopWait","rewind","rewindWait"];for(ae in B)Le.indexOf(ae)>=0&&(B[ae]=t.Pick.choose(B[ae]))}var Ce={override:!n(e)&&!n(e.zimX)&&!n(z.x)||!n(e)&&!n(e.zimY)&&!n(z.y)};n(k)||(Ce.loop=k),n(v)||(Ce.count=v),n(g)||(Ce.loopWait=g),n(b)||(Ce.loopCall=b),n(T)||(Ce.loopWaitParams=T),n(A)||(Ce.loopWaitCall=A),n(E)||(Ce.loopParams=E),n(h)||(Ce.loopPick=h),n(w)||(Ce.rewind=w),n(P)||(Ce.rewindWait=P),n(y)||(Ce.rewindCall=y),n(C)||(Ce.rewindParams=C),n(O)||(Ce.rewindWaitCall=O),n(_)||(Ce.rewindWaitParams=_),n($)||(Ce.startCall=$),n(I)||(Ce.startParams=I),n(X)||(Ce.animateCall=X),n(R)||(Ce.animateParams=R),n(r)||(Ce=t.merge(Ce,B)),B=Ce,t.loop(z,function(Ie,lt){if(typeof Ie=="string"){var ut=Ie.split(".");if(ut.length>1&&Ie.substr(0,1)!="."&&(z["."+Ie]=lt,delete z[Ie],Ie="."+Ie),ut.length>1&&typeof lt=="string"){var ht=lt.substr(0,1);ht!="+"&&ht!="-"&&(z[Ie]="+"+lt)}}});function ee(Ie,lt){if(lt.substr(0,1)=="."){for(var ut=lt.split("."),ht=Ie,Lt=1;Lt<ut.length;Lt++)ht=ht[ut[Lt]];return ht}else return lt=="transform"&&Ie.style?Ie.style.transform:Ie[lt]}function Me(Ie,lt,ut){if(lt.substr(0,1)=="."){for(var ht=lt.split("."),Lt=Ie,Ft=1;Ft<ht.length-1;Ft++)Lt=Lt[ht[Ft]];Lt[ht[ht.length-1]]=ut}else Ie[lt]=ut}if(e.zimTweenOriginals={},!n(q)&&e.addChild){var _e=[];for(he=0;he<e.numChildren;he++)_e.push(e.getChildAt(he));we=e,e=_e}var Ye=["extra","zoom","speed","layer","fade"],je={zoom:e.type=="Pen"?"size":"scale",speed:"percentSpeed",layer:"layer",fade:"alpha"};if(e instanceof Array){for(ne&&e.reverse(),he=0;he<e.length;he++){var it=e[he];if(S){var Be;it.zimObj={};for(ae in z){if(Ye.indexOf(ae)>=0?Be=z[ae]:Be=t.Pick.choose(z[ae]),it.zimObj[ae]=it[ae],typeof Be=="string"&&ae!="transform"){var qe;it.zimLastObj&&!n(it.zimLastObj[ae])?qe=it.zimLastObj[ae]:qe=it[ae],Be=qe+Number(Be.replace(/\s/g,""))}it.zimLastObj&&(it.zimLastObj[ae]=w?it.zimTweenOriginals[ae]:z[ae]),it[ae]=Be}}else{it.zimObj={};for(ae in z)Ye.indexOf(ae)>=0,it.zimObj[ae]=z[ae]}var et=he*q;he==0&&q!=0&&(et=pe=="s"?.02:20),t.animate(it,it.zimObj,i,l,he==e.length-1?a:null,he==e.length-1?s:null,f,c,x,null,null,null,null,null,null,null,h,null,null,null,null,null,null,Y,m,$,I,X,R,null,J,Z,null,U,t.copy(B),d,u,o,null,F,p,L,we,D,N,ue,fe,V,z,se,et,K,ge,Q,ce,G,le,Ae,re)}return we}var ve=i,Pe=Y;n(ve)&&(ve=pe=="s"?1:1e3),n(Y)&&(Y=Pe=ve),n(l)&&(l="quadInOut"),n(f)&&(f=0),n(P)&&(P=0),n(B)&&(B={override:!n(e.zimX)&&!n(z.x)||!n(e.zimY)&&!n(z.y)}),n(s)&&(s=e),n(U)&&(U=!0),n(d)&&(d=!1),n(u)&&(u=!1),n(S)&&(S=!1),n(F)&&(F={}),F.scale&&(F.scaleX=F.scaleY=F.scale,delete F.scale),n(o)||(B.override=o),n(N)&&(N=!1),n(fe)&&(fe=!!N),n(D)&&(D=!1),n(ue)&&(ue=!0),n(V)&&(V=!0),n(re)&&(re=.15),n(K)&&(K=1),e.futureRate=K;var oe,Fe,Ze;if(z instanceof Array){if(Ee=1,z.length==0)return this;var Xe,We;return be(),Qt(),de(),e}function de(){e.zimLastObj&&t.loop(e.zimLastObj,function(An){n(e.zimTweenOriginals[An])||(e[An]=e.zimTweenOriginals[An],e.zimLastObj[An]=e.zimTweenOriginals[An])});for(var Ie,lt=f,ut=0,ht,Lt,Ft=0;Ft<z.length;Ft++)if(Ie=z[Ft],!n(Ie.target)){n(Ie.time)&&(Ie.time=ve),lt+=Ie.wait?Ie.wait:0,ht=Ie.time,Lt=n(Ie.rewindTime)?ht:Ie.rewindTime,Ie.rewind&&(ht=ht+Lt+(Ie.rewindWait?Ie.rewindWait:0)),Ie.loop&&(ht*=Ie.loopCount,ht+=(Ie.loopCount-1)*(Ie.loopWait?Ie.loopWait:0)),n(Ie.params)&&(Ie.params=Ie.target),We=Ie.target,lt<0&&(ut+=lt,lt=0);var pn={target:Ie.target,obj:t.copy(Ie.obj),seriesWait:ut,wait:lt,waitedCall:Ie.waitedCall,waitedParams:Ie.waitedParams,time:Ie.time,ease:Ie.ease,from:Ie.from,rewind:Ie.rewind,call:Ie.call,params:Ie.params,loop:Ie.loop,loopCount:Ie.loopCount,loopWait:Ie.loopWait,loopCall:Ie.loopCall,loopParams:Ie.loopParams,loopWaitCall:Ie.loopWaitCall,loopWaitParams:Ie.loopWaitParams,loopPick:Ie.loopPick,rewindWait:Ie.rewindWait,rewindCall:Ie.rewindCall,rewindParams:Ie.rewindParams,rewindWaitCall:Ie.rewindWaitCall,rewindWaitParams:Ie.rewindWaitParams,rewindTime:Ie.rewindTime,rewindEase:Ie.rewindEase,startCall:Ie.startCall,startParams:Ie.startParams,animateCall:Ie.animateCall,animateParams:Ie.animateParams,set:t.copy(Ie.masterSet),events:L,rate:e.futureRate,pauseOnBlur:Ie.pauseOnBlur,easeAmount:Ie.easeAmount,easeFrequency:Ie.easeFrequency,override:!1,id:p};Ft==z.length-1&&Ve(pn),t.animate(pn),ut+=lt+ht,lt=0}}function Ve(Ie){var lt=Ie.call,ut=Ie.params;B.loop&&(!B.count||Ee<B.count)?Ie.call=function(){lt&&typeof lt=="function"&&lt(ut),B.loopCall&&typeof B.loopCall=="function"&&B.loopCall(B.loopParams),B.loopWait?(n(e.zimTweens)&&(e.zimTweens={}),oe=e.zimTweens[p]=e.zimTween=Ge.Tween.get(e,{override:B.override}).wait(B.loopWait,!0).call(ht),oe.timeScale=e.futureRate):ht();function ht(){for(var Lt=0;Lt<Xe.objects.length;Lt++)Xe.objects[Lt].set&&Xe.objects[Lt].set(Xe.values[Lt]);B.loopWaitCall&&typeof B.loopWaitCall=="function"&&B.loopWaitCall(B.loopWaitParams),de()}}:Ie.call=function(){lt&&typeof lt=="function"&&lt(ut),n(s)&&(s=We),a&&typeof a=="function"&&a(s),e.zimLastObj=null},Ee++}function be(){e&&!e.seriesTweens&&(e.seriesTweens=[],e.seriesCalls=[],e.seriesParams=[]);for(var Ie,lt=0;lt<z.length;lt++)Ie=z[lt],Ie.target?(Ie.target.seriesTweens||(Ie.target.seriesTweens=[]),Ie.target.seriesCalls||(Ie.target.seriesCalls=[]),Ie.target.seriesParams||(Ie.target.seriesParams=[]),Ie.target.seriesTweens.push(Ie.props),Ie.target.seriesCalls.push(Ie.call),Ie.target.seriesParams.push(Ie.params)):(e.seriesTweens.push(Ie.props),e.seriesCalls.push(Ie.call),e.seriesParams.push(Ie.params));e.seriesCalls.push(a),e.seriesParams.push(s),Ie=z[0];var ut;for(e?ut=e:ut=Ie.target,ut.zimSeriesOriginals={},lt=z.length-1;lt>=0;lt--)Ie=z[lt],n(Ie.props)&&!n(Ie.obj)&&(Ie.props=Ie.obj),Ie.obj=Ie.props,t.loop(Ie.obj,function(fr){fr=="path"?ut.zimSeriesOriginals[fr]=z[fr]:ut.zimSeriesOriginals[fr]=ee(ut,fr)});var ht=new t.Dictionary;for(Xe=new t.Dictionary,lt=0;lt<z.length;lt++)if(Ie=z[lt],e||(e=Ie.target),n(Ie.target)&&(Ie.target=e),n(Ie.ease)&&(Ie.ease=l),!n(Ie.target)){if(lt==0&&(Ie.target.zimSeriesArgs=ie),n(Ie.props)&&!n(Ie.obj)&&(Ie.props=Ie.obj),Ie.obj=Ie.props,Ie.loop&&(n(Ie.loopCount)||Ie.loopCount<=0)&&(Ie.loopCount=0,z.splice(lt+1,z.length)),n(Ie.obj.scale)||(Ie.obj.scaleX=Ie.obj.scaleY=Ie.obj.scale,delete Ie.obj.scale),Ie.from){var Lt=ht.at(Ie.target);if(Lt){if(Ie.set){var Ft=t.copy(Ie.obj),pn=t.merge(Lt,Ie.set);Ie.obj=Jt(Ie.target,Ie.obj,pn),Ie.set=t.merge(Ie.set,Ft)}else Ie.set=t.copy(Ie.obj),Ie.obj=Jt(Ie.target,Ie.obj,Lt);Ie.from=!1}else ht.add(Ie.target,Jt(Ie.target,Ie.obj,Ie.set))}var An={};for(var Xn in Ie.obj)An[Xn]=Ie.set&&Ie.set[Xn]?Ie.set[Xn]:Ie.target[Xn];n(Xe.at(Ie.target))&&Xe.add(Ie.target,{});var rr=t.merge(Xe.at(Ie.target),An);Xe.remove(Ie.target),Xe.add(Ie.target,rr),Ie.masterSet=t.copy(Ie.set)}n(e.zimTweens)&&(e.zimTweens={})}if(z&&(z.x&&(e.zimX=!0),z.y&&(e.zimY=!0)),!n(z.shape)&&z.shape.type==e.type&&(e.type=="Blob"||e.type=="Squiggle")){var Te=e.pointObjects,Re=z.shape.pointObjects;if(Te.length!=Re.length)pt&&tt("animate() - shapes must be of same number of points"),delete z.shape;else{delete z.shape;var Ne=n(z.blobShift)?0:z.blobShift;delete z.blobShift;var Ue=!0;for(he=0;he<Te.length;he++){var rt=Te[he],me=Re[(Te.length*2e4+he+Ne)%Te.length];for(Yn=0;Yn<4;Yn++)if(Yn!=1){var He=rt[Yn],at=t.copy(Se);at[0]=He,at[1]={x:me[Yn].x,y:me[Yn].y,rotation:me[Yn].rotation},Ue&&(at[37]=!0,He.animateEvent&&He.off("animation",He.animateEvent),He.animateEvent=He.on("animation",function(){e.update()})),Ue=!1,t.animate.apply(t.animate,at)}}if(t.isEmpty(z))return e}}if(n(e))return;e.tweenStates||(e.tweenStates={all:!0});var Qe=!1;if(z.note){if(Array.isArray(z.note))t.loop(z.note,function(Ie,lt){typeof Ie=="string"&&(z.note[lt]=t.Synth.note(Ie))});else if(z.note.min)z.note.min=t.Synth.note(z.note.min),z.note.max=t.Synth.note(z.note.max);else if(z.note.array)t.loop(z.note.array,function(Ie,lt){typeof Ie=="string"&&(z.note.array[lt]=t.Synth.note(Ie))});else if(typeof z.note=="function"){if(pt)return tt("animate() - use frequency in ZIM VEE functions not note"),e}else z.note=t.Synth.note(z.note);z.frequency=z.note,delete z.note}function ct(Ie,lt){return!!Object.getOwnPropertyDescriptor(Ie,lt).get}(e.type=="Sprite"||!Object.prototype.hasOwnProperty.call(e,"paused"))&&(Object.defineProperty(e,"paused",{get:function(){return e.animatePaused},set:function(Ie){e.animatePaused=Ie}}),e.type!=null&&(e.paused=!0),e.animating=!1),e.endTween=function(Ie,lt){if(e.stopAnimate(lt),Ie!="all"&&Ie!="main"&&Ie!="none"&&(Ie="all"),!e.seriesTweens)t.loop(e.zimLastObj,function(ht){typeof e.zimLastObj[ht]=="string"&&ht!="transform"&&(e.zimLastObj[ht]=e[ht]+Number(e.zimLastObj[ht].replace(/\s/g,""))),Me(e,ht,e.zimLastObj[ht])}),Ie!="none"&&a&&a(s);else{if(t.loop(e.seriesTweens,function(ht,Lt){t.loop(ht,function(Ft){typeof ht[Ft]=="string"&&Ft!="transform"&&(ht[Ft]=e[Ft]+Number(ht[Ft].replace(/\s/g,""))),Me(e,Ft,ht[Ft])}),Ie=="all"&&e.seriesCalls[Lt]&&e.seriesCalls[Lt](e.seriesParams[Lt])}),Ie!="none"){var ut=e.seriesCalls[e.seriesCalls.length-1];ut&&ut(e.seriesParams[e.seriesParams.length-1])}e.seriesTweens=null,e.seriesCalls=null,e.seriesParams=null}return e.stage&&e.stage.update(),e};var ot=!1;if(t.loop(z,function(Ie,lt){Ie=="path"?e.zimTweenOriginals[Ie]=z[Ie]:e.zimTweenOriginals[Ie]=ee(e,Ie),Ie.match("hue")?(z.hueBatch=lt,delete z.hue,ot=!0):Ie.match("saturation")?(z.saturationBatch=lt,delete z.saturation,ot=!0):Ie.match("brightness")?(z.brightnessBatch=lt,delete z.brightness,ot=!0):Ie.match("contrast")?(z.contrastBatch=lt,delete z.contrast,ot=!0):Ie.match(/^.effects/)&&(ot=!0)}),e.resetTween=function(Ie){n(Ie)&&(Ie=!0),e.pauseAnimate(),e.percent=null,e.startPercent=null;var lt=e.zimSeriesOriginals?e.zimSeriesOriginals:e.zimTweenOriginals;return t.loop(lt,function(ut){if(ut=="path"){e.percentComplete=0,e.zimPath=lt[ut];var ht;e.zimStartPercent,ht=e.zimPath.getCurvePoint(e.zimStartPercent/100),e.loc(ht.x,ht.y)}else Me(e,ut,lt[ut])}),e.zimLastObj=null,e.stage&&e.stage.update(),e.stopAnimate(),e.zimPath&&(Se[1].path=e.zimPath),n(e.zimStartRotation)||(e.rotation=e.zimStartRotation),e.zimStartRotation=null,n(e.zimStartScaleX)||(e.scaleX=e.zimStartScaleX),e.zimStartScaleX=null,n(e.zimStartScaleY)||(e.scaleY=e.zimStartScaleY),e.zimStartScaleY=null,t.animate.apply(null,e.zimSeriesArgs?e.zimSeriesArgs:Se),e.pauseAnimate(Ie),e},e.replayTween=function(){return e.resetTween(!1),e},z.path||D){var dt;e.requestedPercentComplete?dt=e.requestedPercentComplete:e.percentComplete&&!ct(e,"percentComplete")&&(dt=e.percentComplete),e.requestedPercentComplete=null,n(dt)&&(dt=0),e.pathRatio=0,e.zimStartRotation=e.rotation,e.percent=null,e.parent&&e.parent.type=="BeadsContainer"||(e.startPercent=null)}d&&(U=!1),n(e.zimTweens)&&(e.zimTweens={});var $e;if(d||(e.stage?$e=e.stage:j.zdf?$e=j.zdf.stage:d=!0),e.setColorRange&&!n(z.color)){var Mt=z.color;delete z.color,z.colorRange=1,e.setColorRange(e.color,Mt),e.colorRange=0}else if(z.color&&(e.material||e.isMaterial)){if(e.isMaterial)return tt("ZIM animate - please animate the color on the mesh not the material"),e;var Ct=e;Ct.cT&&t.Ticker.remove(Ct.cT),e={val:0,zimTweens:{},ticker:Ct.cT};var xt=Ct.material.color.getHexString(),Bt=z.color;if(z={val:1},Ct.cT=t.Ticker.add(function(){var Ie=t.colorRange("#"+xt,Bt,e.val);Ct.material.color.set(Ie)}),a){var Rt=a;a=function(){Ct.cT==e.ticker&&(Rt(callParams||Ct),t.Ticker.remove(Ct.cT),Ct.cT=null,e=null)}}else a=function(){Ct.cT==e.ticker&&(t.Ticker.remove(Ct.cT),Ct.cT=null,e=null)}}var Ht={};for(he in z)Ye.indexOf(he)>=0||(Ht[he]=t.copy(z[he]),z[he]=t.Pick.choose(z[he]));n(z.scale)||(z.scaleX=z.scaleY=t.Pick.choose(z.scale),delete z.scale);for(var nn in z){if(!e.zimBusy)break;e.zimBusy[nn]&&delete z[nn]}if(t.isEmpty(z))return;if(e.type!="Sprite")e.type!=null&&(e.paused=!1),e.animating=!0;else for(var en in z)if(en!="normalizedFrame"){e.animating=!0;break}function kt(){e.zimMouseEnabledCheck||(e.zimMouseEnabledCheck=!0,e.zimLastMouseEnabled=e.mouseEnabled),e.mouseEnabled=!1,setTimeout(function(){e.zimBusy||(e.zimBusy={});for(var Ie in z)e.zimBusy[Ie]=!0;e.zimMouseEnabledCheck=null,e.mouseEnabled=e.zimLastMouseEnabled},70)}(u||B.loop||B.rewind)&&kt(),Qt();function Qt(){n(p)?p=t.makeID(null,10):(p=String(p),Ze=p),n(e.zimIdSets)&&(e.zimIdSets={}),n(e.zimIdSets[p])?e.zimTweens&&!n(e.zimTweens[p])&&(Fe=p,p=t.makeID(null,10),e.zimIdSets[Fe]=[Fe],e.zimTweens[Fe].zimIdSet=Fe,e.zimIdSets[Fe].push(p)):(Fe=p,p=t.makeID(null,10),e.zimIdSets[Fe].push(p))}Ye.shift();for(he in F)F[he]=t.Pick.choose(F[he]);for(he in B)he=="waitedCall"||he=="waitedParams"||he=="loopCall"||he=="rewindCall"||he=="loopWaitCall"||he=="rewindWaitCall"||he=="startCall"||he=="animateCall"||(B[he]=t.Pick.choose(B[he]));Je();function Je(){It(),Xt(),e.seriesTweens&&(e.seriesTweens[0]=z),S&&!Qe&&(z=Jt(e,z,F,!0))}function gt(){It(),S&&!Qe&&(z=Jt(e,z,F,!0))}function It(){var Ie;e.zimLastObj||(e.zimLastObj={});for(he in z){if(typeof z[he]=="string"&&he!="transform"){if(he.substring&&he.substring(0,1)=="."){if(z[he].substr(0,1)=="+"||z[he].substr(0,1)=="-")continue}else if(z[he].substr(0,1)=="+")continue;if(z[he].substr(0,3)=="rgb")continue;e.zimLastObj&&!n(e.zimLastObj[he])?Ie=e.zimLastObj[he]:Ie=e[he],z[he]=Ie+Number(z[he].replace(/\s/g,""))}e.zimLastObj[he]=w?e.zimTweenOriginals[he]:z[he]}}function Xt(){var Ie;for(he in F){if(typeof F[he]=="string"&&he!="transform"){if(he.substring&&he.substring(0,1)=="."){if(F[he].substr(0,1)=="+"||F[he].substr(0,1)=="-")continue}else if(F[he].substr(0,1)=="+")continue;if(F[he].substr(0,3)=="rgb")continue;e.zimLastObj&&!n(e.zimLastObj[he])?Ie=e.zimLastObj[he]:Ie=e[he],F[he]=Ie+Number(F[he].replace(/\s/g,""))}e.zimLastObj[he]=w?e.zimTweenOriginals[he]:z[he]}}e.getBounds&&n(e.percentCompleteCheck)&&(e.percentCompleteCheck=!0,e._percentComplete=0,Object.defineProperty(e,"percentComplete",{get:function(){if(e.paused)return e._percentComplete;if(e.tweenStartTime&&e.tweenEndTime){var Ie=Date.now(),lt;B.loop&&Ie>e.tweenEndTime?lt=(Ie-e.tweenStartTime)%(e.tweenEndTime-e.tweenStartTime):lt=Ie-e.tweenStartTime;var ut=Math.max(0,Math.min(100,lt/(e.tweenEndTime-e.tweenStartTime)*100));return e._percentComplete=ut,ut}else return 0},set:function(Ie){this.zimTween?(Zn=!0,Yt(Ie,!0)):this.requestedPercentComplete=Ie,e._percentComplete=Ie}}),Object.defineProperty(e,"percentCompleteNoAngle",{get:function(){if(e.paused)return e._percentComplete;if(e.tweenStartTime&&e.tweenEndTime){var Ie=Date.now(),lt;B.loop&&Ie>e.tweenEndTime?lt=(Ie-e.tweenStartTime)%(e.tweenEndTime-e.tweenStartTime):lt=Ie-e.tweenStartTime;var ut=Math.max(0,Math.min(100,lt/(e.tweenEndTime-e.tweenStartTime)*100));return e._percentComplete=ut,ut}else return 0},set:function(Ie){this.zimTween?Yt(Ie,!1):this.requestedPercentComplete=Ie,e._percentComplete=Ie}})),Object.defineProperty(e,"rate",{get:function(){return e.futureRate},set:function(Ie){e.futureRate=Ie,t.loop(e.zimTweens,function(lt,ut){ut.timeScale=Ie})},configurable:!0});function Yt(Ie,lt){e.zimTween.startPaused=!1,D?n(e.zimTween.currentTime)||(e.zimTween.currentTime=e.zimTween.currentTime-e.zimTween.position+Ie*e.zimTween.duration/100):e.zimTweens?t.loop(e.zimTweens,function(ut,ht,Lt){var Ft=e.tweenStartTime+(e.tweenEndTime-e.tweenStartTime)*Ie/100,pn;ht.zimLoop&&Ft<=ht.startTime?pn=0:ht.zimLoop&&Ft>ht.startTime+ht.duration?pn=(Ft-ht.startTime)%ht.duration:pn=Ft-ht.startTime,ht.percentComplete=Math.max(0,Math.min(100,pn/ht.duration*100))}):e.zimTween.setPosition(Math.round(Ie*e.zimTween.duration/100)),lt&&ft&&z.orient!==!1&&ft.getCurvePoint&&(e.rotation=ft.getCurvePoint(e.pathRatio,null,null,!0).angle+(En||0)),Zn&&typeof _t<"u"&&(_t=Ie),e.handlePath&&e.handlePath()}var ft,bt,Gt,Kt;if(!n(z.path)&&z.path.segmentPoints){n(z.orient)&&(z.orient=!0),z.orient&&n(z.flip)&&(z.flip=!0),e.type=="Pen"&&(e.infinite=!0),e.zimOnPath=!0,n(e.pathRatio)&&(e.pathRatio=0),z.orient&&(z.orient=z.path,z.startOrient=z.rotation),ft=z.path,N?(delete z.path,delete z.percent,(pt&&e.startPercent&&e.startPercent>0||e.percent&&e.percent!=100)&&tt("ZIM.animate() - startPercent and percent currently not supported with drag on path"),bt=ft.getCurvePoint(e.pathRatio,wt,Kt),bt&&(Gt=e.parent.globalToLocal(bt.x,bt.y),e.x=Gt.x,e.y=Gt.y)):(n(e.startPercent)&&(e.startPercent=t.Pick.choose(n(z.startPercent)?0:z.startPercent)),n(e.percent)&&(e.percent=t.Pick.choose(n(z.percent)?100:z.percent)),delete z.path,delete z.percent);var fn=!ft.lockControls;delete z.path,z.pathRatio=1}function Jt(Ie,lt,ut,ht){Qe=!0,ft&&(!n(Ie.percentComplete)||ut&&!n(ut.percentComplete))&&(ut||(ut={}),n(ut.pathRatio)&&(ut.pathRatio=n(ut.percentComplete)?Ie.percentComplete/100:ut.percentComplete/100));var Lt={};for(he in lt)ut&&!n(ut[he])?Lt[he]=ut[he]:Lt[he]=Ie[he],ht&&(Ie[he]=lt[he]);return Lt}var rn=!0,jt=!1,gn=!0,vt=!0;n(z.redirect)||(vt=z.redirect,delete z.redirect);function ze(Ie){var lt=ft.globalToLocal(Ie.rawX/t.scaX,Ie.rawY/t.scaY),ut=Nn;ft.type=="Blob"&&(xn[0]<xn[4]?yt=!0:xn[0]>xn[4]&&(yt=!1),ut<10&&!yt?(Ln=Nn=ut=$t-5,Qn.immediate(Ln/$t*100),xn=[$t-1,$t-2,$t,$t-3,$t-4]):ut>$t-10&&yt&&(Ln=Nn=ut=5,Qn.immediate(Ln/$t*100),xn=[0,0,0,0,0]));var ht={x:lt.x,y:lt.y,r:ut};Rn.sort(function(Lt,Ft){var pn={x:Lt.x,y:Lt.y,r:Lt.r*$t},An={x:Ft.x,y:Ft.y,r:Ft.r*$t},Xn=Math.sqrt(Math.pow(ht.x-pn.x,2)+Math.pow(ht.y-pn.y,2)+Math.pow(ht.r-pn.r,2)),rr=Math.sqrt(Math.pow(ht.x-An.x,2)+Math.pow(ht.y-An.y,2)+Math.pow(ht.r-An.r,2));return Xn-rr}),Ln=Rn[0].r*$t,_t=Ln/$t*100,_t=t.constrain(_t,0,99.95),w&&(_t/=2,oe.position>oe.duration/2&&(_t=100-_t))}if(ft){let Ie=function(ut){return ut.latestTween?ut.latestTween.percentComplete:ut.percentComplete},lt=function(ut,ht){ut.zimTween.startPaused=!1,ut.latestTween.percentComplete=ht,Zn&&typeof _t<"u"&&(_t=value),ut.handlePath&&ut.handlePath()};var wt;fn||(Kt=t.copy(ft.segmentPoints),wt=t.copy(ft.segmentRatios)),e.currentPercent=e.startPercent+e.percent*e.pathRatio;var Wt=(1e6+e.currentPercent)%100/100;if(bt=ft.getCurvePoint(Wt,wt,Kt),e.parent&&bt&&(Gt=e.parent.globalToLocal(bt.x,bt.y),e.x=Gt.x,e.y=Gt.y),N){l="linear",e.cur("pointer");var _t;z.startPercent!=null?_t=z.startPercent:_t=0;var tn=!1,Ut=!0,yt=!0,Vt=_t,yn=10;Kt=t.copy(ft.segmentPoints);var $t=0;t.loop(Kt,function(ut){$t+=t.distanceAlongCurve(ut)});var an=Math.round($t/Kt.length/yn),Rn=ft.interpolate(an,null,!0,null,!0),Nn=(_t||0)/100*$t,Ln=Nn;ft.zimAnimateChanged=!1,e.zimAnimatePathChange=ft.on("change",function(){ft.zimAnimateChanged=!0}),e.zimAnimatePathDown=ft.on("mousedown",function(){tn=!0,e.paused==!0&&(jt=!0)}),e.zimAnimatePathUp=ft.on("pressup",function(){jt=!1}),e.zimAnimateDragDown=e.on("mousedown",function(ut){$e=ut.target.stage,e.amu||(e.amu=$e.frame.on("mouseupplus",function(){jt=!1})),$e.mouseMoveOutside=!0,rn=!1,gn=!0,setTimeout(function(){rn=!0},50),jt=!0,ft.zimAnimateChanged&&(Kt=t.copy(ft.segmentPoints),$t=0,t.loop(Kt,function(Lt){$t+=t.distanceAlongCurve(Lt)}),an=Math.round($t/Kt.length/yn),Rn=ft.interpolate(an,null,!0,null,!0)),ft.zimAnimateChanged=!1,_t=Ie(e),Qn.immediate(_t);var ht=_t;w&&(oe.position>oe.duration/2?ht=(100-_t)*2:ht=_t*2),Nn=(ht||0)/100*$t,Ln=Nn});var zn=!1;e.zimAnimateDragPress=e.on("pressmove",function(ut){zn=!0,ze(ut)}),e.animateReturn=function(){if(!w){pt&&tt("animate() - animateReturn() needs rewind set to true");return}Ut=!1,yt=!1,Ie(e)<50&&lt(e,100-Ie(e)),e.pauseAnimate(!1)},e.zimAnimateDragUp=e.on("pressup",function(){e.paused==!1&&(jt=!1),rn=!1,setTimeout(function(){rn=!0},50),xn[0]<xn[4]?yt=!0:xn[0]>xn[4]&&(yt=!1),!e.paused&&w&&vt&&yt!=Ut&&(lt(e,100-Ie(e)),Ut=yt)});var Qn=new t.Damp(_t,re),qn=0,cn=0,xn=[0,0,0,0,0],Zn=!1;e.zimDragAnimateTicker=t.Ticker.add(function(){var ut;N&&(++cn%20&&(xn.push(Ln),xn.shift()),Nn=Ln,tn&&(_t=Ie(e)),jt||gn&&e.paused==!0?(tn||Zn||ft.type=="Blob"&&Math.abs(qn-_t)>(w?45:90)?(tn=!1,ut=_t,Qn.immediate(ut),Zn=!1):ut=Qn.convert(_t),Math.abs(qn-ut)>.1?(lt(e,ut),qn=ut):(lt(e,ut),gn=!1,zn=!1)):gn=!1)},$e)}}var sn;if(z.orient){if(z.orient===!0){var on=e.parent.localToGlobal(n(z.x)?e.x:z.x,n(z.y)?e.y:z.y);z.orient={x:on.x,y:on.y}}sn=z.orient,delete z.orient;var En=e.rotation;if(e.rotation=ft.getPointAngle(0)+En,sn!=ft){var Fn;sn.parent?Fn=sn.parent.localToLocal(sn.x,sn.y,e.parent):Fn=e.parent.globalToLocal(sn.x,sn.y),e.rotation=t.angle(e.x,e.y,Fn.x,Fn.y)+En}}var lr=e.scaleX,ar=e.scaleY,Pn=z.flip!=null?z.flip:!1,kn=z.flipVertical!=null?z.flipVertical:!1,In=e.x,qt=e.y,ln=0;B.loop&&(n(B.count)||(ln=B.count,delete B.count,Ee=1));var zt=0;B.loopWait&&(zt=B.loopWait,g=B.loopWait,delete B.loopWait);var wn;B.loopCall&&(wn=B.loopCall,delete B.loopCall);var On=e;B.loopParams&&(On=B.loopParams,delete B.loopParams),j.TIMECHECK&&le&&(ve&&Pt(ve,pe),Pe&&Pt(Pe,pe),f&&Pt(f,pe),Vn&&Pt(Vn,pe),zt&&Pt(zt,pe),g&&Pt(g,pe),B.rewindWait&&Pt(B.rewindWait,pe),se&&Pt(se,pe),Oe&&Pt(Oe,pe)),pe=="s"&&(ve&&(ve*=1e3),Pe&&(Pe*=1e3),f&&(f*=1e3),Vn&&(Vn*=1e3),zt&&(zt*=1e3),g&&(g*=1e3),B.rewindWait&&(B.rewindWait*=1e3),se&&(se*=1e3),Oe&&(Oe*=1e3));var Tn=ve;B.rewind&&(Tn+=Pe),e.zimTweenArgs={time:Tn,wait:f,wait2:Vn,wait3:zt,loopWait:g,rewindWait:B.rewindWait,seriesWait:se,sequenceWait:Oe};function $n(){if(zt>0&&(e.waiting=!1),!!B.loop){if(J&&typeof J=="function"){var Ie=n(Z)?e:Z;J(Ie)}if(wn&&typeof wn=="function"&&wn(On||e),h){var lt=t.Pick.choose(e.futureRate);n(e.futureRate)||(oe.timeScale=lt);var ut;if(n(Ht.scale)||(ut=t.Pick.choose(Ht.scale)),!S&&oe.step&&oe.step.prev&&oe.step.prev.props){for(var ht in oe.step.prev.props)if(!(Ye.indexOf(ht)>=0)){var Lt=t.Pick.choose(Ht[ht]);if(typeof Lt=="string"&&ht!="transform"&&Lt.substr(0,1)!="+"&&Lt.substr(0,1)!="-"){var Ft;e.zimLastObj&&!n(e.zimLastObj[ht])?Ft=e.zimLastObj[ht]:Ft=e[ht],Lt=Ft+Number(Lt.replace(/\s/g,""))}e.zimLastObj[ht]=w?e.zimTweenOriginals[ht]:Lt,w?(n(Ht[ht])||(oe.step.prev.props[ht]=Lt),ht=="scaleX"&&!n(ut)&&(oe.step.prev.props.scaleX=ut),ht=="scaleY"&&!n(ut)&&(oe.step.prev.props.scaleY=ut)):(n(Ht[ht])||(oe.step.props[ht]=Lt),ht=="scaleX"&&!n(ut)&&(oe.step.props.scaleX=ut),ht=="scaleY"&&!n(ut)&&(oe.step.props.scaleY=ut))}}}}}var Sn;B.loopWaitCall&&(Sn=B.loopWaitCall,delete B.loopWaitCall);var Gn=e;B.loopWaitParams&&(Gn=B.loopWaitParams,delete B.loopWaitParams);function dr(){Sn&&typeof Sn=="function"&&Sn(Gn||e)}var er;B.startCall&&(er=B.startCall,delete B.startCall);var hr;B.startParams&&(hr=B.startParams,delete B.startParams);function pr(Ie){Ie.startCalled||(Ie.startCalled=!0,er&&typeof er=="function"&&er(hr||e))}function Kn(Ie){e.latestTween=Ie,e.waiting?Ie.startTime=Date.now():Ie.startTime=gr,Ie.zimLoop=k,e.animating||e.pauseAnimate(!0),Object.defineProperty(Ie,"percentComplete",{get:function(){return this.position/this.duration*100},set:function(lt){this.setPosition(lt*this.duration/100)}})}var sr=Date.now();e.tweenStartTime||(e.tweenStartTime=sr),e.tweenEndTime||(e.tweenEndTime=sr);var gr=sr+(f||0)+(se||0),vr=gr+(Tn||0);vr>e.tweenEndTime&&(e.tweenEndTime=vr);var yr=["ballisticIn","ballisticOut","ballisticInOut","snapIn","snapOut","snapInOut","slowmoIn","slowmoOut","slowmoInOut"];yr.indexOf(l)!=-1&&(l=xr(l));function xr(Ie){var lt=[.4,.75,.9,.95],ut=[.99,-.69,.53,.014],ht=[1.18,.69,1,.96];return Ie=="ballisticIn"?Ie=nt(t.zimEase(lt)):Ie=="ballisticOut"?Ie=nt(t.zimEase(lt).reverse()):Ie=="ballisticInOut"?Ie=nt(t.zimEase(lt,null,!0)):Ie=="snapIn"?Ie=nt(t.zimEase(ut)):Ie=="snapOut"?Ie=nt(t.zimEase(ut).reverse()):Ie=="snapInOut"?Ie=nt(t.zimEase(ut,null,!0)):Ie=="slowmoIn"?Ie=nt(t.zimEase(ht)):Ie=="slowmoOut"?Ie=nt(t.zimEase(ht).reverse()):Ie=="slowmoInOut"&&(Ie=nt(t.zimEase(ht,null,!0))),Ie}var vn,mn,tr;if(B.rewind&&(l&&(l instanceof Function?vn=nt(l.reverse()):(vn=l,vn.indexOf("InOut")==-1&&(vn.indexOf("Out")!=-1?vn=vn.replace("Out","In"):vn.indexOf("In")!=-1&&(vn=vn.replace("In","Out"))))),m&&(vn=m,yr.indexOf(vn)!=-1&&(vn=xr(vn)))),l instanceof Function)mn=l;else{var _n="get"+l.charAt(0).toUpperCase()+l.slice(1),Bn=nt(Q),Dn=nt(ce);(!n(Bn)||!n(Dn))&&Ge.Ease[_n]?(!n(Dn)&&n(Bn)&&(Bn=1),!n(Bn)&&n(Dn)&&(Dn=.3*1.5),mn=Ge.Ease[_n](Bn,Dn)):mn=Ge.Ease[l]}vn&&(vn instanceof Function?tr=vn:(_n="get"+vn.charAt(0).toUpperCase()+vn.slice(1),Bn=nt(Q),Dn=nt(ce),(!n(Bn)||!n(Dn))&&Ge.Ease[_n]?(!n(Dn)&&n(Bn)&&(Bn=1),!n(Bn)&&n(Dn)&&(Dn=.3*1.5),tr=Ge.Ease[_n](Bn,Dn)):tr=Ge.Ease[vn]));function si(){Vn>0&&(e.waiting=!1),wr&&typeof wr=="function"&&wr(Or)}function oi(){Vn>0&&(e.waiting=!0),Cr&&typeof Cr=="function"&&Cr(Sr)}function Nr(Ie){gt(),f>0?(e.waiting=!0,oe=e.zimTweens[p]=e.zimTween=Ge.Tween.get(e,{override:B.override}).wait(f,!0).call(function(){e.waiting=!1,f=0,Mr(oe),c&&typeof c=="function"&&c(n(x)?e:x)}),oe.timeScale=e.futureRate,Ie&&Tr(Ie,oe),Kn(oe)):Mr(Ie)}function Mr(Ie){var lt=Vr();e.set&&!S&&e.set(F),oe=e.zimTweens[p]=e.zimTween=Ge.Tween.get(e,B).call(pr).to(z,ve,mn).call(oi).wait(Vn,!0).call(si).to(lt,Pe,tr).call(Gr).wait(zt,!0).call($n),oe.timeScale=e.futureRate,Ie&&Tr(Ie,oe),Lr(),Kn(oe)}function Fr(Ie){gt(),f>0?(e.waiting=!0,oe=e.zimTweens[p]=e.zimTween=Ge.Tween.get(e,{override:B.override}).wait(f,!0).call(function(){f=0,e.waiting=!1,Ir(oe),c&&typeof c=="function"&&c(n(x)?e:x)}),oe.timeScale=e.futureRate,Ie&&Tr(Ie,oe),Kn(oe)):Ir(Ie)}function Ir(Ie){e.set&&!S&&e.set(F),oe=e.zimTweens[p]=e.zimTween=Ge.Tween.get(e,B).call(pr).to(z,ve,mn).call(Gr).wait(zt,!0).call($n),oe.timeScale=e.futureRate,Ie&&Tr(Ie,oe),Lr(),Kn(oe)}if(B.rewind){var Vn=0;delete B.rewind,w=!0,P=B.rewindWait,B.rewindWait&&(Vn=B.rewindWait,delete B.rewindWait);var wr;if(B.rewindCall){wr=B.rewindCall;var Or=B.rewindParams;n(Or)&&(Or=e),delete B.rewindCall,delete B.rewindParams}var Cr;if(B.rewindWaitCall){Cr=B.rewindWaitCall;var Sr=B.rewindWaitParams;n(Sr)&&(Sr=e),delete B.rewindWaitCall,delete B.rewindWaitParams}se>0||Oe>0||f>0?se>0||Oe>0?(e.waiting=!0,oe=e.zimTweens[p]=e.zimTween=Ge.Tween.get(e,{override:B.override}).wait(se>0?se:0,!0).wait(Oe>0?Oe:0,!0).call(function(Ie){Ie.waiting=!1,Oe=se=0,Nr(oe)}),oe.timeScale=e.futureRate,Kn(oe)):Nr():(gt(),Mr())}else se>0||Oe>0||f>0?se>0||Oe>0?(e.waiting=!0,oe=e.zimTweens[p]=e.zimTween=Ge.Tween.get(e,{override:B.override}).wait(se>0?se:0,!0).wait(Oe>0?Oe:0,!0).call(function(){Oe=se=0,e.waiting=!1,Fr(oe)}),oe.timeScale=e.futureRate,Kn(oe)):Fr():(gt(),Ir());function Tr(Ie,lt){lt.zimIdSet=Ie.zimIdSet,lt.zimObj=Ie.zimObj,lt.zimTicker=Ie.zimTicker,lt.zimExtraTickers=Ie.zimExtraTickers,lt.requestID=Ie.requestID}oe.startPaused=fe,oe.rewinding=!1,n(K)||(oe.timeScale=t.Pick.choose(K)),B.animateCall&&(X=B.animateCall,delete B.animateCall),B.animateParams&&(R=B.animateParams,delete B.animateParams);var or;!d&&U&&(dt&&(e.pathRatio=e.percentComplete&&Math.round(e.percentComplete)!=100?e.percentComplete/100:0,e.percentCompleteNoAngle=Math.round(dt)!=100?dt:0),L&&!n(we)&&we.dispatchEvent?or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr(),we.dispatchEvent("animation")},$e):L&&e.dispatchEvent?or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr(),e.dispatchEvent("animation")},$e):X&&typeof X=="function"?or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr(),X(R||e)},$e):or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr()},$e));function fi(Ie){if(Array.isArray(Ie)){for(var lt=0,ut=0,ht=Ie.length;ut<ht;ut++)lt+=Ie[ut];return lt}}var br=[1,1,1],nr=function(){if(!(!e.parent||oe.passive||oe.startPaused)){if(N&&w&&(Vt<50&&e.percentComplete>50||Vt>50&&e.percentComplete<50)&&(Ut=e.percentComplete<50),Vt=e.percentComplete,ft){if(fn&&(Kt=ft.segmentPoints,wt=ft.segmentRatios),N)var Ie=ft.getCurvePoint(e.pathRatio,wt,Kt);else{e.currentPercent=e.startPercent+e.percent*e.pathRatio;var lt=(1e6+e.currentPercent)%100/100;e.pathRatio==1&&(lt+=e.percent>0?1:0),Ie=ft.getCurvePoint(lt,wt,Kt)}if(Ie){var ut=e.parent.globalToLocal(Ie.x,Ie.y);e.x=ut.x,e.y=ut.y}}var ht=Math.abs(In-e.x),Lt=Math.abs(qt-e.y),Ft=En==90||En==270||En==-90;Pn&&rn&&(In>e.x&&ht>.01&&t.sign(Ft?e.scaleY:e.scaleX)==t.sign(lr)||In<e.x&&ht>.01&&t.sign(Ft?e.scaleY:e.scaleX)!=t.sign(lr)||e.percentComplete<99&&e.percentComplete>1&&ht<.01&&Lt>.01&&t.sign(Ft?e.scaleY:e.scaleX)!=t.sign(lr))&&(Ft?e.scaleY*=-1:e.scaleX*=-1),kn&&rn&&(qt>e.y&&Lt>.01&&t.sign(Ft?e.scaleX:e.scaleY)==t.sign(ar)||qt<e.y&&Lt>.01&&t.sign(Ft?e.scaleX:e.scaleY)!=t.sign(ar)||e.percentComplete<99&&e.percentComplete>1&&Lt<.01&&ht>.01&&t.sign(Ft?e.scaleX:e.scaleY)!=t.sign(ar))&&(Ft?e.scaleX*=-1:e.scaleY*=-1);var pn;if(sn&&ht>.05||sn&&Lt>.05){if(ft==sn)pn=t.angle(In,qt,e.x,e.y)+En;else{var An;sn.parent?An=sn.parent.localToLocal(sn.x,sn.y,e.parent):An=e.parent.globalToLocal(sn.x,sn.y),pn=t.angle(e.x,e.y,An.x,An.y)+En}if(pn!=0&&(!e.paused||zn)){Pn&&In-e.x>.01&&(pn+=180);var Xn=pn;e.rotation=Math.round(Xn==En?e.rotation:Xn),w&&e.percentComplete>50&&!Pn&&(e.rotation+=180)}}if(N){var rr=e.x-In+e.y-qt;Math.abs(rr)>2&&(br.push(t.sign(rr)),br.shift(),oe.forward=fi(br))}In=e.x,qt=e.y}};(ft||sn||Pn||kn)&&(e.handlePath=nr),n(e.zimMaskDynamic)||e.zimMaskApply();function Gr(){if(e.seriesTweens&&e.seriesTweens.shift(),e.seriesCalls&&e.seriesCalls.shift(),e.seriesParams&&e.seriesParams.shift(),e.paused&&e.type!="Sprite"){a&&typeof a=="function"&&a(s);return}if(B.loop)if(ln>0)if(Ee<ln){zt>0&&(e.waiting=!0),dr(),Ee++;return}else w?e.set&&e.set(Vr()):e.set&&e.set(z);else{zt>0&&(e.waiting=!0),dr();return}if(V?Br(p):e.pauseAnimate(!0,p),!B.loop&&J&&typeof J=="function"){var Ie=n(Z)?e:Z;J(Ie)}a&&typeof a=="function"&&a(s)}function Vr(){var Ie={};for(var lt in z)if(d&&e.style)!n(F[lt])&&!S?Ie[lt]=F[lt]:lt=="transform"?Ie[lt]=e.style[lt]:Ie[lt]=Hn(e.style[lt]);else if(!n(F[lt])&&!S)Ie[lt]=F[lt];else if(lt.substr(0,1)=="."){for(var ut=lt.split("."),ht=e,Lt=1;Lt<ut.length;Lt++)ht=ht[ut[Lt]];Ie[lt]=ht}else Ie[lt]=e[lt];return Ie}function ui(Ie){if(e.zimBusy){for(var lt in Ie)delete e.zimBusy[lt];t.isEmpty(e.zimBusy)&&(e.zimBusy=null)}}var ci=!1;Lr();function Lr(){oe.zimObj=z,oe.zimTicker=or,oe.zimPaused=ci,Fe&&(oe.zimIdSet=Fe),Ze&&(n(t.idSets)&&(t.idSets={}),n(t.idSets[Ze])?t.idSets[Ze]=[e]:t.idSets[Ze].indexOf(e)<0&&t.idSets[Ze].push(e)),t.animatedObjects||(t.animatedObjects=new t.Dictionary(!0)),t.animatedObjects.add(e,!0)}function Br(Ie){if(e.tweenStates&&e.tweenStates[Ie]&&delete e.tweenStates[Ie],!(n(e.zimTweens)||n(e.zimTweens[Ie]))){e.zimX=null,e.zimY=null,ui(e.zimTweens[Ie].zimObj),e.zimTweens[Ie].paused=!0,Wr(Ie);var lt=e.zimTweens[Ie].zimIdSet;if(!n(lt)&&e.zimIdSets){var ut=e.zimIdSets[lt];ut&&ut.splice(ut.indexOf(Ie),1),ut&&ut.length==0&&(delete e.zimIdSets[lt],t.isEmpty(e.zimIdSets)&&delete e.zimIdSets)}if(e.type=="Pen"&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),delete e.zimTweens[Ie],e.zimLastObj=null,t.isEmpty(e.zimTweens)&&e.stopAnimate(null,null,null,!1,!0),!(e.zimTweens&&e.zimTweens[Ie]||e.zimIdSets&&e.zimIdSets[lt||Ie])){if(t.idSets&&t.idSets[lt||Ie]){t.idSets[lt||Ie];var ht=t.idSets[lt||Ie].indexOf(e);ht>=0&&t.idSets[lt||Ie].splice(ht,1),t.idSets[lt||Ie].length<=0&&(delete t.idSets[lt||Ie],t.isEmpty(t.idSets)&&delete t.idSets)}}}}function Wr(Ie){-function(){var lt=e.zimTweens[Ie].zimTicker;if(e.zimTweens[Ie].extraTickers)for(var ut=0;ut<e.zimTweens[Ie].extraTickers.length;ut++)t.Ticker.remove(e.zimTweens[Ie].extraTickers[ut]);e.zimTweens[Ie].requestID&&cancelAnimationFrame(e.zimTweens[Ie].requestID),lt&&setTimeout(function(){lt&&t.Ticker.remove(lt),lt=null},200)}()}function mr(Ie,lt){var ut=e.zimTweens[Ie];ut.paused=lt,lt!=ut.zimPaused&&(ut.zimPaused=lt,lt?ut.zimTicker&&(ut.zimAnimateTimeout=setTimeout(function(){t.Ticker.remove(ut.zimTicker)},200)):(ut.startPaused=!1,clearTimeout(ut.zimAnimateTimeout),ut.zimTicker&&(ut.zimTicker=t.Ticker.add(ut.zimTicker,$e))))}function Ur(Ie){for(var lt=[],ut=0;ut<Ie.length;ut++)e.zimIdSets&&!n(e.zimIdSets[Ie[ut]])?lt=lt.concat(e.zimIdSets[Ie[ut]]):lt.push(Ie[ut]);return lt}(!e.stopAnimate||!e.stopAnimate.real)&&(e.stopAnimate=function(Ie,lt,ut,ht,Lt){var Ft;if(e.dynamicAnimation=null,Lt&&N){e.pauseAnimate();return}if(n(Ie)&&(e.tweenStates={}),lt)return e.endTween(null,Ie),e;if(n(ht)&&(ht=!0),e.pan==null&&(e.type!=null&&(e.paused=!0),e.animating=!1),e.type=="Pen"&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),n(ut)&&(ut=!0),ht&&N&&(ft&&ft.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),e.amu&&$e.frame.off("mouseupplus",e.amu),t.Ticker.remove(e.zimDragAnimateTicker)),n(Ie)){if(!ut)return e;e.zimBusy=null,Ge.Tween.removeTweens(e);for(Ft in e.zimTweens)Wr(Ft);e.zimTweens=null,e.zimIdSets=null,e.zimTween=null,t.idSets&&t.idSets[Fe||Ft]&&(delete t.idSets[Fe||Ft],t.isEmpty(t.idSets)&&delete t.idSets),t.animatedObjects.remove(e)}else{Array.isArray(Ie)||(Ie=[Ie]);var pn=Ur(Ie);for(Ft in e.zimTweens)e.zimTweens[Ft].requestID&&cancelAnimationFrame(e.zimTweens[Ft].requestID),ut&&pn.indexOf(Ft)>=0&&Br(Ft,ht),!ut&&pn.indexOf(Ft)<0&&Br(Ft,ht)}return e},e.stopAnimate.real=!0,e.pauseAnimate=function(Ie,lt,ut,ht){var Lt;if(lt=="pauseOnBlur"?lt=null:n(lt)&&(e.tweenStates={all:Ie===!1}),e.type=="Pen"&&(Ie===!1?e.zimOnPath&&(e.infinite=!0):e.stop()),Zr&&!ht){if(n(lt))for(Lt in e.zimTweens)mr(Lt,Ie);else e.pause(Ie,lt);return e}if(n(Ie)&&(Ie=!0),jt=!1,e.type!=null&&(e.paused=Ie),e.animating=!Ie,n(ut)&&(ut=!0),n(lt)&&!ut)return e;if(n(lt))for(Lt in e.zimTweens)mr(Lt,Ie);else{Array.isArray(lt)||(lt=[lt]);var Ft=Ur(lt);for(Lt in e.zimTweens)ut&&Ft.indexOf(Lt)>=0&&(mr(Lt,Ie),e.tweenStates[Lt]=!Ie),!ut&&Ft.indexOf(Lt)<0&&(mr(Lt,Ie),e.tweenStates[Lt]=!Ie)}return e.type=="Sprite"&&(e.running||e.stop()),e}),fe&&e.pauseAnimate(!0,p,null,!0);var bn;for(z.extra&&(bn=z.extra,delete z.extra,Array.isArray(bn)||(bn=[bn])),he=0;he<Ye.length;he++){var Ar=Ye[he];z[Ar]&&(n(bn)&&(bn=[]),di(Ar,z[Ar]),delete z[Ar])}function di(Ie,lt){lt===!0?bn.push({outputProp:je[Ie]}):Array.isArray(lt)?bn.push({outputProp:je[Ie],outputMin:lt[0],outputMax:lt[1],inputMin:lt[2],inputMax:lt[3]}):bn.push({outputProp:je[Ie],outputMax:lt})}if(bn){e.zimStartScaleX=e.scaleX,e.zimStartScaleY=e.scaleY,oe.extraTickers=[];var Qr;for(he=0;he<bn.length;he++){var un=bn[he];n(un.inputObj)&&(un.inputObj=e),n(un.inputProp)&&(un.inputProp="y"),n(un.inputMin)&&(un.inputMin=0),n(un.inputMax)&&(un.inputMax=un.inputProp=="x"?$e.width:$e.height),n(un.outputObj)&&(un.outputObj=e),n(un.outputProp)&&(un.outputProp="scale"),n(un.outputMin)&&(un.outputMin=0),n(un.outputMax)&&(un.outputMax=un.outputMin+1),n(un.constrain)&&(un.constrain=!0);for(var Yn in un)z[Yn]=t.Pick.choose(z[Yn]);un.outputProp=="percentSpeed"&&(D=!0),Qr=new t.Proportion(un.inputMin,un.inputMax,un.outputMin,un.outputMax,un.factor,un.outputRound);var qr=function(){var Ie=un,lt=Qr;return function(){var ut,ht=Ie.outputObj,Lt=Ie.inputObj[Ie.inputProp];if((Ie.inputProp=="x"||Ie.inputProp=="y")&&Ie.inputObj.parent){var Ft=Ie.inputObj.parent.localToGlobal(Lt,Lt);Lt=Ft[Ie.inputProp]}if(Ie.constrain?ut=t.constrain(lt.convert(Lt),Ie.outputMin,Ie.outputMax):ut=lt.convert(Lt),Number.isNaN(ut)&&(ut=Ie.outputMin!=null?Ie.outputMin:0),Ie.outputProp=="scale")ht.scaleX=t.sign(ht.scaleX)*ut,ht.scaleY=t.sign(ht.scaleY)*ut;else if(Ie.outputProp=="scaleX")ht.scaleX=t.sign(ht.scaleX)*ut;else if(Ie.outputProp=="scaleY")ht.scaleY=t.sign(ht.scaleY)*ut;else if(Ie.outputProp=="layer"){if(!ht.parent)return;var pn=t.constrain(Math.round(ut),0,ht.parent.numChildren-1);pn!=ht.parent.getChildIndex(ht)&&ht.parent.setChildIndex(ht,pn)}else Ie.outputProp=="percentSpeed"?ht[Ie.outputProp]=ut*100:ht[Ie.outputProp]=ut}}();qr(),oe.extraTickers.push(t.Ticker.add(qr,$e))}}var Zr;function Kr(){if(oe.requestID=requestAnimationFrame(Kr),!(!D||oe.startPaused&&e.percentSpeed==0)){oe.startPaused=!1,oe!=Hr&&(Hr=oe,oe.currentTime=0,e.pauseAnimate(!0,p,null,!0),e.type!=null&&(e.paused=!1),e.animating=!0,Dr=!Oe&&!se&&!f&&!ln&&B.loop),Dr&&(oe.currentTime+=1e4*Rr,oe.setPosition(oe.currentTime,!0),Dr=!1);var Ie=oe.currentTime+hi*e.percentSpeed/100;_r&&f==0&&(Ie=t.constrain(Ie,0,_r)),oe.currentTime=Ie,oe.setPosition(oe.currentTime),(ft||sn||Pn||kn)&&nr(),$e.update()}}if(D&&(e.dynamicAnimation=!0),D||e.zimAnimateDragDown){if(D){Zr=!0,e.pauseAnimate(!0,p,null,!0),e.type!=null&&(e.paused=!1),e.animating=!0,oe.currentTime=0;var Hr=oe;n(e.percentSpeed)&&(e.percentSpeed=oe.startPaused?0:100);var hi=1e3/60;oe.currentTime=0;var Dr=!Oe&&!se&&!f&&!ln&&B.loop;ue&&B.loop&&!ln&&(ue=!1);var Rr=i+(w?Y||i:0)+(P||0)+(g||0);Rr*=pe=="s"?1e3:1;var Jr=1;B.loop&&ln&&(Jr=ln);var _r;ue&&(_r=Rr*Jr),Kr()}var kr;e.pause=function(Ie,lt){if(n(Ie)&&(Ie=!0),n(lt)&&(lt=0),Ie){if(e.zimAnimateDragDown&&(N=!1,e.cur("default"),ft&&ft.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),!D))return;kr=e.percentSpeed,lt>0?t.animate({target:e,props:{percentSpeed:0},override:!1,ticker:!1,time:lt,call:function(){e.percentSpeed=0,e.type!=null&&(e.paused=!0),e.animating=!1,D=!1,e.dispatchEvent("pause")}}):(oe.startPaused=!1,e.percentSpeed=0,e.type!=null&&(e.paused=!0),e.animating=!1,D=!1,setTimeout(function(){e.dispatchEvent("pause")},10))}else{if(e.zimAnimateDragDown&&(N=!0,e.cur("pointer"),ft&&(e.zimAnimatePathChange=ft.on("change",e.zimAnimatePathChange)),e.zimAnimateDragDown=e.on("mousedown",e.zimAnimateDragDown),e.zimAnimateDragPress=e.on("pressmove",e.zimAnimateDragPress),e.zimAnimateDragUp=e.on("pressup",e.zimAnimateDragUp),!D&&fe!=!1))return;jt=!1,oe.currentTime=oe.position,lt>0?t.animate({target:e,props:{percentSpeed:kr},override:!1,ticker:!1,time:lt,call:function(){e.percentSpeed=kr,e.paused=!1,e.animating=!0,D=!0}}):(e.percentSpeed=kr,e.type!=null&&(e.paused=!1),e.animating=!0,D=!0)}return e}}return e},t.stopAnimate=function(e,r){De("45.12");var i;if(n(e)){if(t.animatedObjects)for(i=t.animatedObjects.length-1;i>=0;i--)t.animatedObjects.objects[i].stopAnimate(null,r);return}if(Array.isArray(e)||(e=[e]),!!t.idSets)for(var l=0;l<e.length;l++){var a=e[l];if(t.idSets[a]){var s=t.idSets[a].length-1;for(i=s;i>=0;i--)t.idSets[a][i].stopAnimate(a,r)}}},t.stopZimAnimate=function(e){De("45.1"),t.stopAnimate(e)},t.pauseAnimate=function(e,r){De("45.22"),n(e)&&(e=!0);var i;if(n(r)||r=="pauseOnBlur"){if(t.animatedObjects)for(i=t.animatedObjects.length-1;i>=0;i--)t.animatedObjects.objects[i].pauseAnimate(e,r);return}if(Array.isArray(r)||(r=[r]),!!t.idSets)for(var l=0;l<r.length;l++){var a=r[l];if(t.idSets[a])for(i=t.idSets[a].length-1;i>=0;i--)t.idSets[a][i].pauseAnimate(e,a)}},t.pauseZimAnimate=function(e,r){De("45.2"),t.pauseAnimate(e,r)},t.wiggle=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T){var h="target, property, baseAmount, minAmount, maxAmount, minTime, maxTime, totalTime, type, ease, integer, id, startType, ticker, wait, pauseOnBlur",w;if(w=st(t.wiggle,arguments,h))return w;if(De("45.25"),n(e)||n(i)||n(l))return e;n(a)&&(a=l);var P=Tt(s,null,40);n(s)&&(s=P=="s"?1:1e3),n(f)&&(f=s),Pt(f,P,40),n(k)&&(k="quadInOut"),n(v)&&(v=!1),n(g)&&(g=t.makeID()),n(x)&&(x="both"),n(b)&&(b="both"),n(E)&&(E=!0),n(A)&&(A=0),Pt(c,P,40),n(c)||(e.wiggleTimeout=setTimeout(function(){e.stopAnimate(g),e.dispatchEvent("wigglestop")},c*(P=="s"?1e3:1)));var y=0,C;function O(){var _=t.rand(t.Pick.choose(s),t.Pick.choose(f),!1),Y={},m={},$;m[r]=t.Pick.choose(i),x=="negative"||y==0&&b=="negative"?$=-t.rand(t.Pick.choose(l),t.Pick.choose(a),v):x=="positive"||y==0&&b=="positive"?$=t.rand(t.Pick.choose(l),t.Pick.choose(a),v):y==0?$=t.rand(t.Pick.choose(l),t.Pick.choose(a),v,!0):$=t.rand(t.Pick.choose(l),t.Pick.choose(a),v)*t.sign(C)*-1,Y[r]=t.Pick.choose(i)+$,y==0&&(_=_/2),C=$,y++;var I=e.futureRate;x=="negative"||x=="positive"?t.animate({target:e,obj:Y,set:m,ease:k,time:_*2,wait:nt(A),rewind:!0,override:!1,call:O,id:g,ticker:!!e.stage,timeCheck:!1,pauseOnBlur:T}):t.animate({target:e,obj:Y,ease:k,time:_,wait:nt(A),override:!1,call:O,id:g,ticker:!!e.stage,timeCheck:!1,pauseOnBlur:T}),I&&(e.futureRate=I)}return e.addTo&&!e.stage?e.added(O):O(),e},t.loop=function(e,r,i,l,a,s,f,c,x,k){var v="obj, call, reverse, interval, step, start, end, immediate, complete, completeParams",g;if(g=st(t.loop,arguments,v))return g;if(t.zimLoopCheck||De("45.3"),t.zimLoopCheck=!0,n(e)||n(r))return;n(i)&&(i=!1),n(l)&&(l=0),(n(a)||a<=0)&&(a=1),n(c)&&(c=!0),e.constructor===Number&&(e=Number(e)),e.constructor===String&&(e=String(e));var b=l===0&&x&&typeof x=="function",E=typeof e=="number"?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":e instanceof NodeList?"nodelist":typeof e=="string"?"string":e instanceof HTMLCollection?"htmlcollection":e.type&&e.type=="Dictionary"?"Dictionary":"invalid";if(E=="container"&&!e.addChild)return;var A,T,h,w;if(E=="number"||E=="string"||E=="array"||E=="nodelist"||E=="htmlcollection"||E=="Dictionary"){if(E=="Dictionary"){var P=t.copy(e.values);e=t.copy(e.objects)}if(A=E=="number"?e:e.length,h=C(A-1),h==0)return;if(i)if(l===0){for(T=s;T>=f;T-=a)if(E=="number"?w=r(T,h,s,f,e):E=="array"||E=="string"?w=r(e[T],T,h,s,f,e):E=="Dictionary"?w=r(e[T],P[T],T,h,s,f,e):w=r(e.item(T),T,h,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(T=O.count,c||T--,a&&(T*=a),T=s-T,E=="number"?w=r(T,h,s,f,e):E=="array"||E=="string"?w=r(e[T],T,h,s,f,e):E=="Dictionary"?w=r(e[T],P[T],T,h,s,f,e):w=r(e.item(T),T,h,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},h,c,null,null,x,k);else if(l===0){for(T=s;T<=f;T+=a)if(E=="number"?w=r(T,h,s,f,e):E=="array"||E=="string"?w=r(e[T],T,h,s,f,e):E=="Dictionary"?w=r(e[T],P[T],T,h,s,f,e):w=r(e.item(T),T,h,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(T=O.count,c||T--,a&&(T*=a),E=="number"?w=r(T,h,s,f,e,O):E=="array"||E=="string"?w=r(e[T],T,h,s,f,e,O):E=="Dictionary"?w=r(e[T],P[T],T,h,s,f,e):w=r(e.item(T),T,h,s,f,e,O),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},h,c,null,null,x,k);return b&&x(k),!0}else if(E=="object"){A=0;var y=[];for(T in e)A++,y.push(T);if(h=C(A-1),h==0)return;if(i)if(l===0){for(T=s;T>=f;T-=a)if(w=r(y[T],e[y[T]],T,h,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(T=O.count,c||T--,a&&(T*=a),T=s-T,w=r(y[T],e[y[T]],T,h,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},h,c,null,null,x,k);else if(l===0){for(T=s;T<=f;T+=a)if(w=r(y[T],e[y[T]],T,h,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(T=O.count,c||T--,a&&(T*=a),w=r(y[T],e[y[T]],T,h,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},h,c,null,null,x,k);return b&&x(k),!0}else{if(h=C(e.numChildren-1),h==0)return;if(i)if(l===0){for(T=s;T>=f;T-=a)if(w=r(e.getChildAt(T),T,h,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(T=O.count,c||T--,a&&(T*=a),T=s-T,w=r(e.getChildAt(T),T,h,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},h,c,null,null,x,k);else if(l===0){for(T=s;T<=f;T+=a)if(w=r(e.getChildAt(T),T,h,s,f,e),typeof w<"u"&&w!="next")return w}else t.interval(l,function(O){if(T=O.count,c||T--,a&&(T*=a),w=r(e.getChildAt(T),T,h,s,f,e),w=="next")O.next();else if(typeof w<"u")return O.clear(),w},h,c,null,null,x,k);return b&&x(k),!0}function C(O){return n(s)&&(s=i?O:0),n(f)&&(f=i?0:O),i&&f>s||!i&&s>f||(s<0&&f)<0||s>O&&f>O?0:(s=Math.max(0,Math.min(s,O)),f=Math.max(0,Math.min(f,O)),Math.floor((i?s-f:f-s)/a)+1)}},t.scaleTo=function(e,r,i,l,a,s,f){var c="obj, boundObj, percentX, percentY, type, boundsOnly, simple",x;if(x=st(t.scaleTo,arguments,c))return x;if(e.type=="AC"&&j.zdf)return j.zdf.ac("scaleTo",arguments),e;if(De("43"),n(r)&&(r=j.zdf&&j.zdf.stage?j.zdf.stage:null),n(e)||!e.getBounds||!e.getBounds())return Wn("zim methods - scaleTo(): please provide an object (with setBounds) to scale"),e;if(n(r)||!r.getBounds||!r.getBounds())return Wn("zim methods - scaleTo(): please provide a boundObject (with setBounds) to scale to"),e;n(i)&&(i=-1),n(l)&&(l=-1),i==-1&&l==-1&&(i=l=100,n(a)&&(a="fill")),n(a)&&(a="fit"),a=="smallest"?a="fit":a=="biggest"||a=="outside"||a=="largest"?a="fill":(a=="both"||a=="stretch")&&(a="full"),n(s)&&(s=!1),n(f)&&(f=!1);var k=r.getBounds().width*i/100*(s?1:r.scaleX),v=r.getBounds().height*l/100*(s?1:r.scaleY);(r.type=="Stage"||r.type=="StageGL")&&(k=r.width*i/100,v=r.height*l/100);var g,b;if(f)g=e.getBounds().height,b=e.getBounds().width;else{var E=t.boundsToGlobal(e);g=E.height/e.scaleX,b=E.width/e.scaleY,(isNaN(g)||isNaN(b)||g>5e3)&&(g=e.getBounds().height,b=e.getBounds().width)}if((i==-1||l==-1)&&a!="full")return i==-1?t.sca(e,v/g):t.sca(e,k/b),e;var A;return a=="full"?(e.scaleX=i!=-1?k/b:e.scaleX,e.scaleY=l!=-1?v/g:e.scaleY,e):(a=="fill"?A=Math.max(k/b,v/g):A=Math.min(k/b,v/g),t.sca(e,A),e)},t.fit=function(e,r,i,l,a,s){var f="obj, left, top, width, height, type",c;if(c=st(t.fit,arguments,f))return c;if(e.type=="AC"&&j.zdf)return j.zdf.ac("fit",arguments),e;if(De("46"),!(n(e)||!e.getBounds)){if(!e.getBounds()){tt("zim methods - fit(): please setBounds() on object");return}if(n(r)){if(!e.stage){tt("zim methods - fit(): please add boundary dimensions or add obj to stage first");return}if(!e.stage.getBounds()){tt("zim methods - fit(): please add boundary dimensions or add obj with bounds to stage first");return}var x=e.stage.getBounds().width,k=e.stage.getBounds().height;r=0,i=0,l=x,a=k}s===!0?s="fit":s===!1&&(s="fill"),n(s)&&(s="fit"),e.scaleX=e.scaleY=1;var v=l,g=a,b=e.getBounds().width,E=e.getBounds().height,A,T,h,w,P;return s=="full"?(e.scaleX=h=v/b,e.scaleY=w=g/E,A=v,T=g):(s=="fit"?v/g>=b/E?P=g/E:P=v/b:s=="fill"&&(v/g>=b/E?P=v/b:P=g/E),h=w=P),e.scaleX=h,e.scaleY=w,A=b*h,T=E*w,e.x=(e.regX-e.getBounds().x)*h+r+(v-A)/2,e.y=(e.regY-e.getBounds().y)*w+i+(g-T)/2,{x:e.x,y:e.y,width:A,height:T,scale:P,scaleX:h,scaleY:w,bX:r,bY:i,bWidth:l,bHeight:a}}},t.boundsCheck=!1,t.boundsToGlobal=function(e,r,i,l,a){if(t.boundsCheck||(De("40"),t.boundsCheck=!0),!(n(e)||!e.getBounds)){if(n(i)&&(i=!1),a&&!e.getBounds&&!e.getBounds())return e;var s=e.getBounds();if(!s&&n(r)){tt(`zim methods - boundsToGlobal():
 please setBounds() on object (or a rectangle)`);return}r&&(s=r);var f,c,x,k;a&&a.type&&!(a.type=="Stage"||a.type=="StageGL")?(f=e.localToLocal(s.x,s.y,a),c=e.localToLocal(s.x+s.width,s.y,a),x=e.localToLocal(s.x+s.width,s.y+s.height,a),k=e.localToLocal(s.x,s.y+s.height,a)):i?(f=e.globalToLocal(s.x,s.y),c=e.globalToLocal(s.x+s.width,s.y),x=e.globalToLocal(s.x+s.width,s.y+s.height),k=e.globalToLocal(s.x,s.y+s.height)):(f=e.localToGlobal(s.x,s.y),c=e.localToGlobal(s.x+s.width,s.y),x=e.localToGlobal(s.x+s.width,s.y+s.height),k=e.localToGlobal(s.x,s.y+s.height));var v=Math.min(f.x,c.x,x.x,k.x),g=Math.min(f.y,c.y,x.y,k.y),b=Math.max(f.x,c.x,x.x,k.x),E=Math.max(f.y,c.y,x.y,k.y);return new Ge.Rectangle(v,g,b-v,E-g)}},t.resetBounds=function(e,r,i,l,a,s){var f="obj, a, b, c, d, margin",c;if(c=st(t.resetBounds,arguments,f))return c;De("40.5");var x,k,v,g;return n(l)?(x=0,k=r,v=0,g=i):(x=r,k=l,v=i,g=a),n(g)&&(g=k),n(r)?e.setBounds(null):e.setBounds(x,v,k,g),s&&(i=e.getBounds(),i&&e.setBounds(i.x-s,i.y-s,i.width+s*2,i.height+s*2)),e},t.copyMatrix=function(e,r){return De("45.5"),e.x=r.x,e.y=r.y,e.scaleX=r.scaleX,e.scaleY=r.scaleY,e.regX=r.regX,e.regY=r.regY,e.rotation=r.rotation,e.skewX=r.skewX,e.skewY=r.skewY,e},t.duplicate=function(e,r){De("45.6");var i=e.clone(r);for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)&&i[l]==null){if(l=="parent"||l=="zimTouch")continue;i[l]=e[l]}return i},t.expand=function(e,r,i,l,a){var s="obj, padding, paddingV, paddingRight, paddingBottom",f;if(f=st(t.expand,arguments,s))return f;if(De("50"),n(e)||!e.getBounds||!e.getBounds())return tt("zim methods - expand(): please provide object with bounds set"),e;n(r)&&(r=20),n(i)&&(i=r);var c,x;!n(l)||!n(a)?(n(l)&&(l=r),n(a)&&(a=i),c=r,x=i):(c=l=r,x=a=i);var k=e.getBounds(),v=new t.Shape({style:!1});return v.graphics.f("rgba(0,0,0,.01)").r(k.x-c,k.y-x,k.width+c+l,k.height+x+a),e.hitArea=v,e},t.setSwipe=function(e,r){if(De("34"),n(e)||!e.on)return;e.zimNoSwipe=r?null:!0,e instanceof Ge.Container&&i(e);function i(l){for(var a=l.numChildren,s,f=0;f<a;f++)s=l.getChildAt(f),s.zimNoSwipe=e.zimNoSwipe,s instanceof Ge.Container&&i(s)}return e},t.setMask=function(e,r,i){if(De("50.1"),n(e)&&tt("zim methods - setMask(): please provide obj"),n(r))return a(),e;var l=e.stage||(j.zdf?j.zdf.stage:null);function a(){e.zimMask&&e.zimMask.parent&&e.zimMask.parent.removeChild(e.zimMask),e.zimMask=null,e.zimMaskTicker&&t.Ticker.remove(e.zimMaskTicker),e.mask=null}e.zimMaskOriginal&&e.zimMaskOriginal!=r&&a(),n(i)&&(i=r.type=="Blob"||!n(r.zimDown)||!n(r.transformControls)||!n(r.zimTouch)||!n(r.zimTweens),r.zimMaskDynamic=i),e.zimMaskOriginal=r;var s;function f(){if(i&&(!l||!r.stage))return e;if(s&&s.dispose&&s.dispose(),s=null,e.zimMask=r.zimMask=s=r.shape.clone(),t.copyMatrix(s,r),r.addChildAt(s,0),s.alpha=0,!e.parent){e.mask=s;return}var c=r.getConcatenatedMatrix().decompose(),x=e.parent.getConcatenatedMatrix().decompose();s.scaleX=c.scaleX/x.scaleX,s.scaleY=c.scaleY/x.scaleY,s.rotation=(c.rotation?c.rotation:0)-(x.rotation?x.rotation:0);var k=r.localToLocal(r.shape.x+r.regX,r.shape.y+r.regY,e.parent);s.x=k.x,s.y=k.y,e.mask=s}return r.zimMaskApply=function(){e.zimMaskTicker&&t.Ticker.remove(e.zimMaskTicker),e.zimMaskTicker=t.Ticker.add(f)},r&&r.shape?(f(),i&&r.zimMaskApply()):(s=r,e.mask=s),e},t.outline=function(e,r,i,l){var a="obj, color, size, boundsOnly",s;if(s=st(t.outline,arguments,a))return s;if(e.type=="AC"&&j.zdf)return j.zdf.ac("outline",arguments),e;if(De("47"),e.type&&e.type=="zimOultineShape")return pt&&tt("zim.outline() - warning, you are trying to outline an outline - do not outline in a loop"),e;if(n(e)||!e.getBounds)return tt("zim methods - outline(): please provide object with bounds set"),e;if(!e.getBounds())return tt("zim methods - outline(): please setBounds() on object"),e;if(!e.parent)return tt("zim methods - outline(): object should be on stage first"),e;if(n(r)&&(r="brown"),n(i)&&(i=2),i<=0){e.ZIMoutlineShape&&e.ZIMoutlineShape.parent.removeChild(e.ZIMoutlineShape),e.ZIMoutlineShapeC&&e.ZIMoutlineShapeC.parent.removeChild(e.ZIMoutlineShapeC),e.ZIMoutlineShape=e.ZIMoutlineShapeC=null;return}var f=e.getBounds(),c=e.ZIMoutlineShape=e.ZIMoutlineShape?e.ZIMoutlineShape:new t.Shape;c.type="zimOutlineShape";var x=e.ZIMoutlineShapeC=e.ZIMoutlineShapeC?e.ZIMoutlineShapeC:new t.Shape;x.type="zimOutlineShape";var k=e.parent;e.outlineToggled=!0,e.outlineToggle=function(C){return C===!0?(e.ZIMoutlineShape.visible=!0,e.ZIMoutlineShapeC.visible=!0):C===!1?(e.ZIMoutlineShape.visible=!1,e.ZIMoutlineShapeC.visible=!1):(e.ZIMoutlineShape.visible=!e.ZIMoutlineShape.visible,e.ZIMoutlineShapeC.visible=!e.ZIMoutlineShapeC.visible),e.outlineToggled=e.ZIMoutlineShape.visible,e};var v=e.localToLocal(f.x,f.y,k),g=e.localToLocal(f.x+f.width,f.y,k),b=e.localToLocal(f.x+f.width,f.y+f.height,k),E=e.localToLocal(f.x,f.y+f.height,k),A=e.localToLocal(0,0,k),T=c.graphics.c(),h=x.graphics.c();if(T.s(r).ss(i).mt(v.x,v.y).lt(g.x,g.y).lt(b.x,b.y).lt(E.x,E.y).lt(v.x,v.y).cp(),!l){var w=10,P=w+1;h.s("white").ss(i+2),h.mt(-P,0).lt(P,0),h.mt(0,-P).lt(0,P),h.s(r).ss(i),h.mt(-w,0).lt(w,0),h.mt(0,-w).lt(0,w),h.cp(),x.x=A.x,x.y=A.y,x.rotation=e.rotation,T.s("white").ss(i+2).dc(e.x,e.y,w+6),T.s(r).ss(i).dc(e.x,e.y,w+6)}e.parent.removeChild(c),e.parent.removeChild(x);var y=e.parent.getChildIndex(e);return e.parent.addChildAt(x,y+1),e.parent.addChildAt(c,y+1),c.mouseEnabled=!1,x.mouseEnabled=!1,e},t.blendmodes=function(e,r,i){De("47.05"),n(r)&&(r=1);var l=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"];i===!1&&l.push("source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","copy","xor");var a=0,s=t.interval(r,function(){var f=l[a%l.length];a++,e.ble(f),Yr(f),e.stage&&e.stage.update()});return e.on("mousedown",function(){s.pause(!s.paused)}),e},t.STYLE=null,t.ignore="ignore",t.getStyle=function(e,r,i,l){t.STYLECHECK||(De("50.34"),t.STYLECHECK=!0);var a=["tap","change","hold","noTap","noChange","noHold","pos","addTo","center","centerReg","reg","mov","move","drag","transform","gesture","mouse","expand","outline","bounds","animate","wiggle","cache"],s=j.STYLE||t.STYLE,f=s,c,x=!1;n(l)||(e=null,r=l,x=!0),s&&s.type&&typeof s.type=="string"&&(s.ttype=s.type,delete s.type);for(var k in s)c=s[k],k.match(/^[(A-Z)]/)?(s.type||(s.type={}),s.type[k]?s.type[k]=t.merge(s.type[k],c):s.type[k]=c,delete s[k]):c.constructor==={}.constructor&&k!="group"&&k!="type"&&!t.isPick(c)&&a.indexOf(k)==-1&&(s.group||(s.group={}),s.group[k]?s.group[k]=t.merge(s.group[k],c):s.group[k]=c,delete s[k]);n(f)?f={}:f=t.copy(f);var v;if(n(i))i={};else for(v=0;v<a.length;v++)delete i[a[v]];var g=i,b=f.type;if(b&&delete f.type,!n(r)&&!n(f.group)){var E=r.split(","),A={};for(v=0;v<E.length;v++){var T=E[v].trim();n(f.group[T])||(A=t.merge(A,f.group[T]))}delete f.group}x?!n(r)&&!n(A)&&(f=A):(!n(e)&&!n(b)&&!n(b[e])&&(f=t.merge(f,b[e])),!n(r)&&!n(A)&&(f=t.merge(f,A)));for(var h in f){if(g[h]){delete f[h];continue}if(c=a.indexOf(h)==-1&&!f.delayPick?t.Pick.choose(f[h]):f[h],c=="ignore"){delete f[h];continue}else c&&c.constructor==={}.constructor&&(c=t.copy(c,!0,!1));var w;for(var P in f)(w=P.match(/^(.+)gColor$/))&&(f[w[1]+"ackgroundColor"]=f[P],delete f[P]);f[h]=c}return f=t.merge(f,g),f.ttype&&!f.type&&(f.type=f.ttype,delete f.ttype),f.style===!1?{}:f},t.styleTransforms=function(e,r){var i=["visible","x","y","scale","scaleX","scaleY","rotation","alpha","skewX","skewY","blendMode"],l;if(r){for(r.add&&e.addTo(),r.addTo&&e.addTo(r.addTo===!0?null:r.addTo),l=0;l<i.length;l++)r[i[l]]!=null&&(e[i[l]]=t.Pick.choose(r[i[l]]));if((r.regX!=null||r.regY!=null)&&e.reg(n(r.regX)?DEFAULT:r.regX,n(r.regY)?DEFAULT:r.regY),r.bounds&&r.bounds.constructor==={}.constructor&&e.setBounds(r.bounds.x?r.bounds.x:0,r.bounds.y?r.bounds.y:0,r.bounds.width?r.bounds.width:100,r.bounds.height?r.bounds.height:100),r.center&&e.center(r.center===!0?null:r.center),r.centerReg&&e.centerReg(r.centerReg===!0?null:r.centerReg),r.reg!=null&&(r.reg.constructor==={}.constructor?e.reg(t.Pick.choose(r.reg.x),t.Pick.choose(r.reg.y),r.reg.still):e.reg(r.reg)),r.x!=null&&(r.loc?r.loc.x==null&&(r.loc.x=r.x):r.loc={x:r.x}),r.y!=null&&(r.loc?r.loc.y==null&&(r.loc.y=r.y):r.loc={y:r.y}),r.loc&&(r.loc.constructor==={}.constructor?e.loc(t.Pick.choose(r.loc.x),t.Pick.choose(r.loc.y)):e.loc(t.Pick.choose(r.loc))),r.pos)if(r.pos.constructor==={}.constructor)e.pos(t.Pick.choose(r.pos.x),t.Pick.choose(r.pos.y),t.Pick.choose(r.pos.horizontal),t.Pick.choose(r.pos.vertical),t.Pick.choose(r.pos.container),t.Pick.choose(r.pos.index),r.pos.add,t.Pick.choose(r.pos.reg),t.Pick.choose(r.pos.regX),t.Pick.choose(r.pos.regY));else{var a=t.Pick.choose(r.pos);(a=="left"||a=="top")&&e.pos(),a=="right"&&e.pos({horizontal:"right"}),a=="bottom"&&e.pos({vertical:"bottom"}),(a=="rightbottom"||a=="bottomright")&&e.pos({horizontal:"right",vertical:"bottom"}),a=="center"&&e.center()}if((r.mov||r.move)&&(r.move&&(r.mov=r.move),r.mov.constructor==={}.constructor?e.mov(t.Pick.choose(r.mov.x),t.Pick.choose(r.mov.y)):e.mov(t.Pick.choose(r.mov))),r.outline&&setTimeout(function(){e.outline(r.outline.constructor==={}.constructor?r.outline:null),e.stage&&e.stage.update()},20),r.drag&&e.drag(r.drag.constructor==={}.constructor?r.drag:{currentTarget:!0}),r.gesture&&e.gesture(r.gesture.constructor==={}.constructor?r.gesture:null),r.mouse===!1&&e.noMouse(),r.transform&&setTimeout(function(){e.transform(r.transform.constructor==={}.constructor?r.transform:null)},20),r.animate)for(Array.isArray(r.animate)||(r.animate=[r.animate]),l=0;l<r.animate.length;l++)-function(){var f=r.animate[l];f.constructor==={}.constructor&&setTimeout(function(){e.animate(f)},20)}();if(r.wiggle)for(Array.isArray(r.wiggle)||(r.wiggle=[r.wiggle]),l=0;l<r.wiggle.length;l++)-function(){var f=r.wiggle[l];f.constructor==={}.constructor&&setTimeout(function(){e.wiggle(f)},20)}();r.expand&&e.expand(r.expand===!0?null:r.expand),r.cache&&(r.cache.constructor==={}.constructor?r.cache.x?e.cache(t.Pick.choose(r.cache.x),t.Pick.choose(r.cache.y),t.Pick.choose(r.cache.x),t.Pick.choose(r.cache.y)):e.cache(t.Pick.choose(r.cache.width),t.Pick.choose(r.cache.height)):e.cache()),r.tap&&e.tap&&e.tap(r.tap),r.change&&e.change&&e.change(r.change),r.hold&&e.hold&&e.hold(r.hold),r.noChange&&e.noChange&&e.noChange(),r.noTap&&e.noTap&&e.noTap(),r.noHold&&e.noHold&&e.noHold();var s=j.STYLE||t.STYLE;s&&(s.once===!0||s.once==e.type)&&(j.STYLE?j.STYLE={}:t.STYLE={})}},t.Style={remembered:{},clear:function(){return j.STYLE&&(j.STYLE={}),t.STYLE&&(t.STYLE={}),t.Style},clearTypes:function(){var e=j.STYLE||t.STYLE;return delete e.types,t.Style},clearGroups:function(){var e=j.STYLE||t.STYLE;return delete e.groups,t.Style},remember:function(e){n(e)&&(e="default");var r=j.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=j.STYLE={}),t.Style.remembered[e]=t.copy(r,!0),t.Style},clearRemembered:function(e){return n(e)?t.Style.remembered={}:delete t.Style.remembered[e],t.Style},recall:function(e){return n(e)&&(e="default"),j.STYLE?j.STYLE=t.Style.remembered[e]:t.STYLE=t.Style.remembered[e],t.Style},add:function(e){var r=j.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=j.STYLE={}),j.STYLE?j.STYLE=t.merge(r,e):t.STYLE=t.merge(r,e),t.Style},addType:function(e,r){var i=j.STYLE||t.STYLE;return i||(Et?i=t.STYLE={}:i=j.STYLE={}),i.type||(i.type={}),i.type[e]=r,t.Style},addGroup:function(e,r){var i=j.STYLE||t.STYLE;return i||(Et?i=t.STYLE={}:i=j.STYLE={}),i.group||(i.group={}),i.group[e]=r,t.Style},remove:function(e){var r=j.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=j.STYLE={}),delete r[e],t.Style},removeType:function(e){var r=j.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=j.STYLE={}),r.type&&delete r.type[e],t.Style},removeGroup:function(e){var r=j.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=j.STYLE={}),r.group&&delete r.group[e],t.Style}},t.PATH=null,t.TIME="seconds",t.TIMECHECK=!1,t.DIR="ltr",t.SEEDRAND=null,t.SEEDRANDCOUNT=0,t.ANIMATE=!0,t.OPTIMIZE=!1,t.ACTIONEVENT="mousedown",t.DEFAULTWIRE="currentValue",t.KEYFOCUS=null,t.POSREG=!1,t.DRAGALL=!1,t.MOBILE="default",t.Ticker={stages:null,myUpdate:null,alwaysList:new t.Dictionary,list:new t.Dictionary,wire:new t.Dictionary,setFPS:function(e,r){n(e)&&n(r)?(e=60,r=60):n(e)?e=60:n(r)&&(r=e),t.Ticker.framerate=Ge.Ticker.framerate=t.mobile()?e:r},setTimingMode:function(e){Ge.Ticker.timingMode=Ge.Ticker.RAF,e=="synched"&&(Ge.Ticker.timingMode=Ge.Ticker.RAF_SYNCHED),e=="timeout"&&(Ge.Ticker.timingMode=Ge.Ticker.TIMEOUT)},add:function(e,r){De("30");var i=t.Ticker;if(i.has(e,r))return e;if((n(r)||!r.update)&&(r=j.zdf.stage),n(e)||typeof e!="function"){tt("zim.Ticker.add() - only add functions");return}return i.list.at(r)?i.list.at(r).push(e):i.list.add(r,[e]),i.ticker||(i.ticker=Ge.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),e},addWire:function(e,r){if(De("30"),n(r[0]))return e;var i=t.Ticker;i.wire.add(e,r);var l=r[0][r[1]];return r[4]&&(l=r[4](l,"from")),r[3]&&(e[r[6]]=r[7]=l),i.ticker||(i.ticker=Ge.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),e},rawID:{},raw:function(e){De("30");var r=t.makeID("letters",7);return-function i(l){e(l),t.Ticker.rawID[r]=requestAnimationFrame(i)}(),r},removeRaw:function(e){cancelAnimationFrame(t.Ticker.rawID[e]),delete t.Ticker.rawID[e]},call:function(e){var r=t.Ticker,i,l,a,s=[];for(a=0;a<r.list.length;a++){i=r.list.objects[a],l=r.list.values[a];for(var f=0;f<l.length;f++)l[f](e);var c=!1;(r.alwaysList.at(i)||l.length>0&&(n(r.update)&&!t.OPTIMIZE&&(Et||!j.OPTIMIZE)||r.update))&&(c=!0),c&&s.indexOf(i)<0&&s.push(i)}for(a=r.wire.length-1;a>=0;a--){var x=r.wire.objects[a],k=r.wire.values[a];if(k){var v=x[k[6]];v!=k[7]&&(k[4]&&(v=k[4](v,"to",k[7])),k[0][k[1]]=k[7]=v,k[5]&&k[5](v),i=k[0].stage,i&&s.indexOf(i)<0&&s.push(i)),k[2]&&k[0]&&(v=k[0][k[1]],k[7]!=v&&(k[4]&&(v=k[4](v,"from",k[7])),x[k[6]]=k[7]=v,k[5]&&k[5](v),i=x.stage,i&&s.indexOf(i)<0&&s.push(i)))}}if(r.list.length==0)for(a=0;a<r.alwaysList.length;a++)i=r.alwaysList.objects[a],s.indexOf(i)<0&&s.push(i);var g=s.length;for(a=0;a<g;a++)s[a].update()},always:function(e){De("30");var r=t.Ticker;r.framerate||r.setFPS(),(n(e)||!e.update)&&(e=j.zdf.stage),r.alwaysList.add(e,!0),r.ticker||(r.ticker=Ge.Ticker.on("tick",r.call))},alwaysOff:function(e){var r=t.Ticker;(n(e)||!e.update)&&(e=j.zdf.stage),r.alwaysList.remove(e)},remove:function(e){var r=t.Ticker;if(n(e)||typeof e!="function"){tt("zim.Ticker - only remove functions");return}for(var i=0;i<r.list.length;i++){var l=r.list.values[i].indexOf(e);l>-1&&r.list.values[i].splice(l,1)}r.alwaysList.length>0||r.list.length>0||r.wire.length>0||(Ge.Ticker.off("tick",r.ticker),r.ticker=null)},removeAll:function(e){for(var r=t.Ticker,i,l=0;l<r.list.length;l++)i=r.list.objects[l],(n(e)||e===i)&&(r.list.values[l]=[]);r.alwaysList.length>0||r.list.length>0||r.wire.length>0||(Ge.Ticker.off("tick",r.ticker),r.ticker=null)},removeWire:function(e,r,i,l){var a=t.Ticker;if(n(e)&&n(r)&&n(i)&&n(l))a.wire.clear();else for(var s=a.wire.length-1;s>=0;s--){var f=a.wire.objects[s],c=a.wire.values[s];c&&(e&&f!=e||r&&c[0]!=r||i&&c[1]!=i||l&&c[6]!=l||(a.wire.objects.splice(s,1),a.wire.values.splice(s,1)))}a.alwaysList.length>0||a.list.length>0||a.wire.length>0||(Ge.Ticker.off("tick",a.ticker),a.ticker=null)},isUpdating:function(e){n(e)&&(e=j.zdf.stage);var r=!1,i=t.Ticker;return(i.alwaysList.at(e)||i.list&&i.list.values.at(e)&&i.list.values.at(e).length>0&&(n(i.update)&&!t.OPTIMIZE&&(Et||!j.OPTIMIZE)||i.update))&&(r=!0),r},has:function(e,r){return(n(r)||!r.update)&&(r=j.zdf.stage),t.Ticker.list&&t.Ticker.list.at(r)&&t.Ticker.list.at(r).indexOf(e)>=0},getFPS:function(){return Ge.Ticker.getMeasuredFPS()},dispose:function(e){for(var r=t.Ticker,i=0,l,a=r.list.length-1;a>=0;a--)l=r.list.objects[a],n(e)||e===l?(r.list.remove(e),r.alwaysList.remove(e)):i+=r.list.values[a].length;if(!(r.alwaysList.length>0))return i==0&&(Ge.Ticker.off("tick",r.ticker),r.ticker=null),!0}},t.Ticker.setFPS(),Object.defineProperty(t.Ticker,"update",{get:function(){return t.Ticker.myUpdate},set:function(e){var r=t.Ticker;typeof e!="boolean"&&(e=null),r.myUpdate=e,r.myUpdate===!1&&(cancelAnimationFrame(r.ticker),r.alwaysList=new t.Dictionary)}}),t.Pages=function(e,r,i,l,a,s,f,c,x){var k="pages, transition, speed, transitionTable, holder, arrowDisableColor, style, group, inherit",v;if(v=st(t.Pages,arguments,k,this))return v;De("71"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pages",this.group=c;var g=f===!1?{}:t.getStyle(this.type,this.group,x),b=Tt(i);if(n(e)&&(e=g.pages!=null?g.pages:[]),this.pages=e,n(r)&&(r=g.transition!=null?g.transition:"none"),n(i)&&(i=g.speed!=null?g.speed:b=="s"?.2:200),n(l)&&(l=g.transitionTable!=null?g.transitionTable:[]),this.transitionTable=l,n(s)&&(s=g.arrowDisableColor!=null?g.arrowDisableColor:t.grey),this.arrowDisableColor=s,n(a)&&(a=g.holder!=null?g.holder:null),n(a)&&j.zdf&&(a=j.zdf.stage),!a.getBounds||!a.getBounds()){tt(`zim controls - Pages():
holder object must have bounds set`);return}this.speed=i,this.active=!0;var E=this;E.transitioning=!1;var A=a.getBounds().width,T=a.getBounds().height,h,w;(r!="none"||l!=[])&&P();function P(){h=new Ge.Shape,h.graphics.f("black").r(0,0,A,T+1),w=new Ge.Shape,w.graphics.f("white").r(0,0,A,T+1)}var y=["left","right","up","down"],C,O,_=!0,Y;for(Y=0;Y<e.length;Y++)C=e[Y],C.constructor!={}.constructor&&(C=e[Y]={page:e[Y]}),C.swipe&&(_=!1);for(Y=0;Y<e.length;Y++){if(C=e[Y],C.constructor!=={}.constructor&&(C=e[Y]={page:e[Y]}),_){var m=e[Y-1],$=e[Y+1];C.swipe=[m?m.page:null,$?$.page:null]}J(C.page,C.swipe)}var I=this.page=e[0]?e[0].page:null;n(this.page)||(this.index=0),this.addChild(I),Z(I),this.swipe=new t.Swipe(a);var X,R=!1,q=this.swipe.on("swipe",function(B){if(E.active){var d=B.currentTarget.direction;if(d!="none"){var u="";d=="left"?u="right":d=="right"?u="left":d=="up"?u="down":d=="down"&&(u="up"),d=u;var o=y.indexOf(d);O=I.zimSwipeArray[o],X=[O,d,null,null,!0],E.page=I,E.nextPage=O,E.direction=d,E.dispatchEvent("swipe"),setTimeout(function(){R||E.go(O,d,null,null,!0)},50)}}});function J(B,d){n(B)||(B.zimHTMLList=new t.Dictionary,ne(B),B.zimSwipeArray=d||[],B.zimOriginalAlpha=B.alpha,B.parent&&B.parent.removeChild(C.page))}function Z(B){if(!n(B))for(B.removedHTML=!1,Y=0;Y<B.zimHTMLList.length;Y++)B.addChildAt(B.zimHTMLList.values[Y].obj,B.zimHTMLList.values[Y].depth)}function ne(B){if(!B.removedHTML){B.removedHTML=!0,B.zimHTMLList.clear();var d,u;for(u=0;u<B.numChildren;u++)if(d=B.getChildAt(u),d.type=="TextArea"||d.type=="Loader"||d.type=="Tag"){var o={obj:d,depth:B.getChildIndex(d)};B.zimHTMLList.add(d,o)}for(u=B.numChildren-1;u>=0;u--)d=B.getChildAt(u),(d.type=="TextArea"||d.type=="Loader"||d.type=="Tag")&&B.removeChild(d)}}this.addPage=function(B,d){J(B,d),E.pages.push({page:B}),I?B.parent&&B.parent.removeChild(B):(I=E.page=B,E.addChild(I))},this.removePage=function(B){ne(B),E.currentPage==B&&(E.removeChild(B),a.stage&&a.stage.update()),t.loop(E.pages,function(d,u){(d.page==B||d==B)&&E.pages.splice(u,1)},!0),B.zimSwipeArray=null},this.setSwipeArray=function(B,d){n(d)&&(d=[]);var u={page:B,swipe:d};u.page.zimSwipeArray=u.swipe?u.swipe:[]},this.pause=function(){R=!0},this.unpause=function(){R&&E.go(X[0],X[1],X[2],X[3],X[4])};var U=!0;this.go=function(B,d,u,o,S){if(typeof B=="number"){var F=E.pages[B];if(n(F))return;B=F.page}setTimeout(function(){R=!1},200);for(var p=[{x:A},{x:-A},{y:T},{y:-T}],L=[{x:0},{x:0},{y:0},{y:0}],we=[{x:A/2,alpha:0},{x:-A/2,alpha:0},{y:T/2,alpha:0},{y:-T/2,alpha:0}],D=r,N=E.speed,ue=0;ue<E.transitionTable.length;ue++)if(E.transitionTable[ue][0]==I&&E.transitionTable[ue][1]==B){D=E.transitionTable[ue][2],n(E.transitionTable[ue][3])||(N=E.transitionTable[ue][3]);break}n(u)&&(u=D),n(o)&&(o=N),E.speed=o;function fe(ke){ke[0].uncache(),ke[1].uncache(),E.transitioning=!1,E.dispatchEvent("pagetransitioned"),E.removeChild(E.lastPage),u=="fan"&&(d=="right"||d=="down"?(E.lastPage.rotation=0,E.lastPage.regY=0,E.lastPage.mov(0,-E.lastPage.height)):(E.page.rotation=0,E.page.regY=0,E.page.mov(0,-E.lastPage.height))),E.removeChild(h),E.removeChild(w),Z(I),U=!0}function V(ke){E.removeChild(E.lastPage),t.animate(ke.shift(),{alpha:0},E.speed/2,null,fe,ke)}if(E.direction=d,B==""||B==null)E.page=I,E.dispatchEvent("nothing");else if(typeof B=="string")E.page=I,E.dispatchEvent(B);else{if(B==I)return;n(d)&&(d="right");var z=y.indexOf(d);if(!U)return;U=!1,B.x=0,B.y=0,B.alpha=B.zimOriginalAlpha;var se,Oe=["pixelDark","pixelLight","pixelZIM","bubbleDark","bubbleLight","bubbleZIM","lineDark","lineLight","lineZIM"];if(Oe.indexOf(u)>=0){var K=u;se=!0,u="slide"}var ge=["explodeDark","explodeLight","explodeZIM"];if(ge.indexOf(u)>=0){var Q=u;se=!0,u="fade"}if(u.type=="Emitter"&&(se=u,u.horizontal||u.vertical?u="slide":u="fade"),E.transitioning=!0,u=="slide"?(B.x=-(p[z].x|0),B.y=-(p[z].y|0),B.cache(0,0,(A+1)/B.scaleX,(T+1)/B.scaleY),I.cache(0,0,(A+1)/I.scaleX,(T+1)/I.scaleY),E.addChild(B),E.addChild(I),t.animate(I,p[z],E.speed,null,fe,[I,B]),t.animate(B,L[z],E.speed)):u=="reveal"?(B.cache(0,0,(A+1)/B.scaleX,(T+1)/B.scaleY),I.cache(0,0,(A+1)/I.scaleX,(T+1)/I.scaleY),E.addChild(B),E.addChild(I),t.animate(I,we[z],E.speed,null,fe,[I,B])):u=="fade"?(B.cache(0,0,(A+1)/B.scaleX,(T+1)/B.scaleY),I.cache(0,0,(A+1)/I.scaleX,(T+1)/I.scaleY),B.alpha=1,E.addChild(B),E.addChild(I),t.animate(I,{alpha:0},E.speed,null,fe,[I,B])):u=="black"?(B.cache(0,0,(A+1)/B.scaleX,(T+1)/B.scaleY),I.cache(0,0,(A+1)/I.scaleX,(T+1)/I.scaleY),B.alpha=1,E.addChild(B),E.addChild(I),h.alpha=0,E.addChild(h),t.animate(h,{alpha:1},E.speed/2,null,V,[h,I,B])):u=="clear"?(B.cache(0,0,(A+1)/B.scaleX,(T+1)/B.scaleY),I.cache(0,0,(A+1)/I.scaleX,(T+1)/I.scaleY),B.alpha=0,E.addChild(B),E.addChild(I),t.animate(I,{alpha:0},E.speed/2),t.animate(B,{alpha:1},E.speed/2,null,fe,[I,B],E.speed/2)):u=="white"?(B.cache(0,0,(A+1)/B.scaleX,(T+1)/B.scaleY),I.cache(0,0,(A+1)/I.scaleX,(T+1)/I.scaleY),B.alpha=1,E.addChild(B),E.addChild(I),w.alpha=0,E.addChild(w),t.animate(w,{alpha:1},E.speed/2,null,V,[w,I,B])):u=="fan"?(B.cache(0,0,(A+1)/B.scaleX,(T+1)/B.scaleY),I.cache(0,0,(A+1)/I.scaleX,(T+1)/I.scaleY),B.alpha=1,d=="right"||d=="down"?(E.addChild(B),E.addChild(I),I.regY=I.height,I.mov(0,I.height),t.animate(I,{rotation:-90},E.speed,null,fe,[I,B])):(E.addChild(I),E.addChild(B),B.regY=I.height,B.mov(0,I.height),B.rotation=-90,t.animate(B,{rotation:0},E.speed,null,fe,[I,B]))):(E.transitioning=!1,E.addChild(B),E.removeChild(I),U=!0),se){var ce=z<2,G,le;if(K||u=="slide"){K?(K=="lineDark"||K=="lineLight"?G=new t.Rectangle(ce?30:A+5,ce?T+5:30,K=="lineDark"?t.dark:t.white).alp(.2):K=="lineZIM"?G=new t.Rectangle(ce?50:A+5,ce?T+5:50,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.5):K=="pixelDark"||K=="pixelLight"?G=new t.Rectangle(40,40,t.clear,K=="pixelDark"?t.dark:t.white,2).alp(.7):K=="pixelZIM"?G=new t.Rectangle(40,40,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7):K=="bubbleDark"||K=="bubbleLight"?G=new t.Circle(30,t.clear,K=="bubbleDark"?t.dark:t.white,2).alp(.7):K=="bubbleZIM"&&(G=new t.Circle(30,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7)),G.centerReg({add:!1}),K=="lineDark"||K=="lineLight"||K=="lineZIM"?le=new t.Emitter({obj:G,life:.5,decayTime:.5,shrink:!1,force:0,gravity:0,width:0,startPaused:!0}):le=new t.Emitter({obj:G,num:6,life:.5,decayTime:.5,width:ce?0:A,height:ce?T:0,vertical:ce,horizontal:!ce,startPaused:!0})):le=se;var Ae=[{x:0,y:T/2},{x:A,y:T/2},{x:A/2,y:0},{x:A/2,y:T}],re=[{x:A,y:T/2},{x:0,y:T/2},{x:A/2,y:T},{x:A/2,y:0}];le.centerReg(a).spurt(null,E.speed),le.x=Ae[z].x,le.y=Ae[z].y,t.animate(le,re[z],E.speed,null,function(){K&&le.dispose()})}else(Q||u=="fade")&&(Q?(Q=="explodeDark"||Q=="explodeLight"?G=new t.Circle(150,Q=="explodeDark"?t.dark:t.white).alp(.5):Q=="explodeZIM"&&(G=new t.Circle(130,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7)),le=new t.Emitter({obj:G,num:5,gravity:0,force:{min:20,max:40},life:.5,shrink:!1,decayTime:.5,startPaused:!0})):le=se,le.centerReg(a).spurt(null,E.speed*.35),le.on("fizzed",function(){Q&&le.dispose()}));a&&a.type!="Stage"&&a.type!="StageGL"&&le.particles&&a.shape&&le.particles.setMask(a.shape)}for(a&&a.shape&&le&&le.particles&&le.particles.setMask(a.shape),ne(I),E.lastPage=I,E.page=B,E.index=-1,ue=0;ue<E.pages.length;ue++){var xe=E.pages[ue].page;xe==E.page&&(E.index=ue)}u=="none"&&Z(B),n(S)&&(S=!1),E.fromSwipe=S,E.dispatchEvent("page"),I=B,E.setArrows(e.index),a.stage&&a.stage.update()}},a&&a.shape&&(a.mouseChildren=!0,a.mouseEnabled=!0,E.setMask(a.shape)),this.resize=function(){A=a.getBounds().width,T=a.getBounds().height,(r!="none"||l!=[])&&P()},this.puff=function(B){for(var d=0;d<e.length;d++)E.addChild(e[d].page);E.addChild(I),B>0&&setTimeout(function(){E.settle()},B*(b=="s"?1e3:1))},this.settle=function(){E.removeAllChildren(),E.addChild(I),E.dispatchEvent("puffed")},this.disable=function(){E.active=!1},this.enable=function(){E.active=!0},this.arrows={},this.setArrows=function(){if(!t.isEmpty(E.arrows)){var B=E.pages[E.index];if(!(!B||!B.swipe)){var d=B.swipe,u=[t.LEFT,t.RIGHT,t.DOWN,t.UP];t.loop(u,function(o,S){d[S]?t.loop(E.arrows[o],function(F){if(F.setDisabled===!0){F.activate(!1,E.arrowDisableColor),F.setDisabled=null;return}F.enabled||F.activate(!0,F.arrowBackgroundColor)}):t.loop(E.arrows[o],function(F){if(F.setDisabled===!1){F.activate(!0,F.arrowBackgroundColor),F.setDisabled=null;return}F.enabled&&F.activate(!1,E.arrowDisableColor)})}),E.stage&&E.stage.update()}}},E.added(function(B){if(B.frame&&B.frame.scaling=="full"){if(!t.globalManager){var d=t.globalManager=new t.Manager;d.frame=B.frame,d.event=B.frame.on("resize",function(){d.resize()})}t.globalManager.add(E)}}),f!==!1&&t.styleTransforms(this,g),this.dispose=function(B,d,u){if(t.globalManager){var o=t.globalManager;o.remove(E),t.globalManager.items.length==0&&(o.frame.off("resize",o.event),o.dispose(),t.globalManager=null)}return E.swipe.off("swipe",q),E.swipe.dispose(),u||this.zimContainer_dispose(!0),!0}},t.extend(t.Pages,t.Container,["clone","dispose"],"zimContainer",!1),t.Arrow=function(e,r,i,l,a,s,f,c,x,k,v){var g="backgroundColor, rollBackgroundColor, pages, direction, type, newPage, trans, speed, style, group, inherit",b;if(b=st(t.Arrow,arguments,g,this))return b;De("71.2"),this.group=k;var E=x===!1?{}:t.getStyle("Arrow",this.group,v);n(l)&&(l=E.direction!=null?E.direction:"right"),n(e)&&(e=E.backgroundColor!=null?E.backgroundColor:t.blue),this.arrowBackgroundColor=e,n(r)&&(r=E.rollBackgroundColor!=null?E.rollBackgroundColor:t.blue.lighten(.2)),this.arrowRollBackgroundColor=r,n(a)&&(a=E.type!=null?E.type:"triangle"),n(s)&&(s=E.newPage!=null?E.newPage:null),n(f)&&(f=E.trans!=null?E.trans:null),n(c)&&(c=E.speed!=null?E.speed:null);var A,T,h,w,P;a=="triangle"?(A=new t.Triangle(45,45,45,e,null,null,null,null,-7).rot(90),T=new t.Triangle(45,45,45,r,null,null,null,null,-7).rot(90)):a=="thick"?(A=new t.Shape,h=A.graphics.f(e).command,P="AhFBdIiWAAIAAi4ICWAAIAAh7IEhDWIkhDXg",A.p(P).reg(-4),T=new t.Shape,w=T.graphics.f(r).command,T.p(P).reg(-4)):a=="thin"?(A=new t.Shape,h=A.graphics.f(e).command,P="AhBCIIBZhbIjWAAIAAhVIDaAAIhdhfIA9g+IDDDFIAAAAIAAAAIjDDGg",A.p(P).reg(-4),T=new t.Shape,w=T.graphics.f(r).command,T.p(P).reg(-4)):a=="angle"&&(A=new t.Shape,h=A.graphics.f(e).command,P="AiNC5IC4i5Ii4i5IAxgxIDqDqIjqDrg",A.p(P).reg(-3),T=new t.Shape,w=T.graphics.f(r).command,T.p(P).reg(-3)),this.zimButton_constructor(50,50,"",t.clear,t.clear,null,null,null,null,null,null,null,null,null,null,null,A,T),this.type="Arrow";var y=this;if(this.activate=function(Y,m){return n(Y)&&(Y=!0),n(m)&&(m=t.grey),m===!1||(Y?(y.enabled=!0,m!==!1&&(a=="triangle"?(y.icon.color=y.arrowBackgroundColor,y.rollIcon.color=y.arrowRollBackgroundColor):(h.style=y.arrowBackgroundColor,w.style=y.arrowRollBackgroundColor))):(y.enabled=!1,m!==!1&&(a=="triangle"?(y.icon.color=m,y.rollIcon.color=m):(h.style=m,w.style=m)))),y},n(i)||i.type!="Pages")return;var C=(Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click";n(i.arrows)&&(i.arrows={}),n(i.arrows[l])&&(i.arrows[l]=[]),i.arrows[l].push(this);var O=_();O||this.activate(!1,i.arrowDisableColor);function _(){var Y=i.pages[i.index];if(!(!Y||!Y.page||!Y.page.zimSwipeArray)){var m=Y.page.zimSwipeArray;if(l=="left")return m[0];if(l=="right")return m[1];if(l=="up")return m[2];if(l=="down")return m[3]}}this.expand(),this.on(C,function(){if(!i.transitioning){var Y=_();Y&&i.go(Y,l,f,c)}}),x!==!1&&t.styleTransforms(this,E),this.clone=function(){return y.cloneProps(new t.Arrow(e,r,i,l,a,s,f,c,x,this.group,v))}},t.extend(t.Arrow,t.Button,"clone","zimButton",!1),t.HotSpots=function(e,r,i){var l="spots, local, mouseDowns",a;if(a=st(t.HotSpots,arguments,l,this))return a;De("72"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpots",n(r)&&(r=!0),n(i)&&(i=!1);var s=(Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",f=this,c,x,k=f.hotSpots=[];n(e)&&(e=[]);for(var v=0;v<e.length;v++)g(e[v]);function g(E){var A=null;if(!Array.isArray(E.rect)){if(A=E.rect,!A){tt("zim controls - HotSpots(): HotSpot "+E.page+" "+E.rect+" button does not exist");return}E.rect=[A.x,A.y,A.width||1,A.height||1]}x=new t.HotSpot(E.page,E.rect[0],E.rect[1],E.rect[2],E.rect[3],E.call,E.callOver,E.callOut,r,E.talk),x.zimHSpage=E.page,x.button=A,k.push(x),x.on(s,b),A&&n(E.callOver)&&n(E.callOut)&&(x.spot.mouseEnabled=!1,x.spot.mouseChildren=!1,A.zimHScall=E.call,A.zimHSEvent=A.on(s,b,!0),i||(A.zimHSMDEvent=A.on("mousedown",function(T){T.stopImmediatePropagation()})),A.cur("pointer"))}function b(E){E.stopImmediatePropagation&&E.stopImmediatePropagation(),j.event&&(j.event.cancelBubble=!0),typeof E.currentTarget.zimHScall=="function"&&E.currentTarget.zimHScall(E)}this.add=this.addHotSpot=function(E,A,T,h,w,P){c={page:E,rect:A,call:T,callOver:h,callOut:w,talk:P},e.push(c),g(c)},this.show=function(){for(var E=0;E<k.length;E++)x=k[E],x.button||(x.spot.alpha=.2)},this.hide=function(){for(var E=0;E<k.length;E++)x=k[E],x.spot.alpha=0},this.remove=this.removeHotSpots=function(E,A){for(var T=e.length-1;T>=0;T--)c=e[T],x=k[T],A&&!Array.isArray(A)&&(A=[A.x,A.y,A.getBounds().width,A.getBounds().height]),(n(E)&&n(A)||n(A)&&E==c.page||n(E)&&t.arraysEqual(A,c.rect)||E==c.page&&t.arraysEqual(A,c.rect))&&(e.splice(T,1),x.button&&(x.button.off(s,x.button.zimHSEvent),x.button.zimHSEvent=null,i||(x.button.off("mousedown",x.button.zimHSMDEvent),x.button.zimHSMDEvent=null)),x.off(s,b),x.dispose(),k.splice(T,1))},this.dispose=function(){for(var E=0;E<k.length;E++)x=k[E],x.button&&(x.button.off(s,x.button.zimHSEvent),x.button.zimHSCall=null,x.button.zimHSEvent=null,i||(x.button.off("mousedown",x.button.zimHSMDEvent),x.button.zimHSMDEvent=null)),x.off(s,b),x.dispose();return!0}},t.extend(t.HotSpots,t.Container,"dispose","zimContainer",!1),t.HotSpot=function(e,r,i,l,a,s,f,c,x,k){var v="obj, x, y, width, height, call, callOver, callOut, local, talk",g;if(g=st(t.HotSpot,arguments,v,this))return g;if(De("73"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpot",n(e)||!e.addChild){tt(`zim controls - HotSpot():
Please pass in container object for obj`);return}if(!(e instanceof Ge.Container)){tt(`zim controls - HotSpot():
Objects passed in should be Containers`);return}if(n(r)||n(i)||n(l)||n(a)){tt(`zim controls - HotSpot():
Please pass in x, y, width, height`);return}n(x)&&(x=!0);var b=(Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",E=l,A=a,T,h,w;if(x)T=new t.Point(r,i),h=l,w=a;else{T=e.globalToLocal(r,i);var P=e.globalToLocal(r+E,i+A);h=P.x-T.x,w=P.y-T.y}var y=new t.Shape(l,a);if(y.talk=n(k)?"HotSpot":k,y.alpha=0,y.graphics.f("black").dr(0,0,h,w),y.x=T.x,y.y=T.y,y.cur("pointer"),y.expand(0),this.spot=y,typeof s=="function")var C=y.on(b,function(Y){s(Y)});if(typeof f=="function")var O=y.on("mouseover",function(Y){f(Y)});if(typeof c=="function")var _=y.on("mouseout",function(Y){c(Y)});e.addChild(y),this.show=function(){y.alpha=.5,e.stage&&e.stage.update()},this.hide=function(){y.alpha=0,e.stage&&e.stage.update()},this.dispose=function(){return C&&y.off(b,O),O&&y.off("mouseover",O),_&&y.off("mouseout",_),e.removeChild(y),y=null,!0}},t.extend(t.HotSpot,t.Container,"dispose","zimContainer",!1),t.Guide=function(e,r,i,l,a,s,f,c){var x="obj, vertical, pixels, hideKey, pixelKey, style, group, inherit",k;if(k=st(t.Guide,arguments,x,this))return k;De("76"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Guide",this.group=f;var v=s===!1?{}:t.getStyle(this.type,this.group,c);if(n(e)&&(j.zdf?e=j.zdf.stage:e="stage"),n(r)&&(r=v.vertical!=null?v.vertical:!0),e!="stage"&&(!e.addChild||!e.getBounds||!e.getBounds())){Wn("zim controls - Guide(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=v.pixels!=null?v.pixels:!(zdf&&zdf.scaling=="full")),n(l)&&(l=v.hideKey!=null?v.hideKey:"G"),n(a)&&(a=v.pixelKey!=null?v.pixelKey:"P");var g=this,b,E=80,A=26,T=E/6+E/2,h=A*2,w,P,y;r?(y=C("#00c5af","white","white"),y.shape.regX=E+E/6,y.shape.regY=A/2,y.label.x=-E/2-E/6):(y=C("#d61fa0","white","white"),y.shape.regX=E/2,y.shape.regY=A+A/4,y.label.y=-A*3/4);function C(U,B,d){var u=new t.Container({style:!1});return u.shape=new t.Shape,u.shape.graphics.s(B).ss(1).f(U).r(0,0,E,A),u.shape.alpha=.9,u.addChild(u.shape),u.label=new Ge.Text("10","16px arial",d),u.label.textAlign="center",u.label.textBaseline="middle",u.addChild(u.label),u.mouseChildren=!1,u.mouseEnabled=!1,u}var O;e!="stage"&&e.addChild(g);var _=t.added(g,R),Y=!1,m,$,I,X;function R(){if(e=="stage"?(O=g.stage,e=O):O=e.stage,O.frame&&O.frame.scaling=="full"){if(!t.globalManager){var U=t.globalManager=new t.Manager;U.frame=O.frame,U.event=O.frame.on("resize",function(){U.resize()})}t.globalManager.add(g)}e.addChild(g),m=e.getBounds().width,$=e.getBounds().height,r?(y.y=$/2,y.label.text="x:"+(g.pixels?Math.round(m*70/100):"70%")):(y.x=m/2,y.label.text="y:"+(g.pixels?Math.round($*70/100):"70%")),I=new t.Shape,g.addChild(I),r?I.x=m*.7:I.y=$*.7,Y||(e.addChild(g),Z()),O.off("stagemousemove",b),b=O.on("stagemousemove",J),O.update()}var q={x:0,y:0};function J(U){var B,d;U?(B=e.globalToLocal(U.rawX/t.scaX,U.rawY/t.scaY),q=B):B={x:q.x,y:q.y},i?r?(d=Math.round(Math.abs(B.x-I.x)),y.label.text="x:"+Math.max(0,Math.min(d,Math.round(m))),y.y=Math.max(h,Math.min(B.y,P))):(d=Math.round(Math.abs(B.y-I.y)),y.label.text="y:"+Math.max(0,Math.min(d,Math.round($))),y.x=Math.max(T,Math.min(B.x,w))):r?(d=Math.round(Math.abs(B.x-I.x)/m*100),y.label.text="x:"+Math.max(0,Math.min(d,100))+"%",y.y=Math.max(h,Math.min(B.y,P))):(d=Math.round(Math.abs(B.y-I.y)/$*100),y.label.text="y:"+Math.max(0,Math.min(d,100))+"%",y.x=Math.max(T,Math.min(B.x,w))),O&&O.update()}function Z(){Y=!0,m=e.getBounds().width,$=e.getBounds().height;var U;r?(U="ew-resize",X=new Ge.Rectangle(0,0,m,0)):(U="ns-resize",X=new Ge.Rectangle(0,0,0,$)),t.noDrag(I),setTimeout(function(){t.drag(I,X,null,U,U,null,null,!0)},500),O.mouseMoveOutside=!0,O.enableMouseOver(10),w=m-E*2/3,P=$-A-A,I.uncache();var B=I.graphics;r?(B.c().s("rgba(0,255,255,.1)").ss(20).mt(0,0).lt(0,$),B.f().s("white").ss(2).mt(0,0).lt(0,$),B.s("#00c5af").sd([20,20]).mt(0,0).lt(0,$).sd(),I.cache(-10,0,20,$)):(B.c().s("rgba(255,0,255,.1)").ss(20).mt(0,0).lt(m,0),B.f().s("white").ss(2).mt(0,0).lt(m,0),B.s("#d61fa0").sd([20,20]).mt(0,0).lt(m,0).sd(),I.cache(0,-10,m,20)),r?y.x=m:y.y=$,g.addChild(y)}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(U){i=U,g.resize()}}),j.addEventListener("keydown",ne);function ne(U){U||(U=event),O&&(String.fromCharCode(U.keyCode)==l.toUpperCase()&&g.toggle(),String.fromCharCode(U.keyCode)==a.toUpperCase()&&(g.pixels=!g.pixels))}this.toggled=!0,this.toggle=function(U){return U===!0?g.visible=g.toggled=!0:U===!1?g.visible=g.toggled=!1:(g.visible=!g.visible,g.toggled=g.visible),O&&(O.off("stagemousemove",b),g.visible&&(b=O.on("stagemousemove",J,g)),O.update()),g},this.resize=function(){return g?(O&&(Z(),J()),!0):!1},s!==!1&&t.styleTransforms(this,v),this.dispose=function(){if(!g)return!1;if(t.globalManager){var U=t.globalManager;U.remove(g),t.globalManager.items.length==0&&(U.frame.off("resize",U.event),U.dispose(),t.globalManager=null)}return t.noDrag(I),clearInterval(_),g.removeAllChildren(),j.removeEventListener("keydown",ne),g.parent&&g.parent.removeChild(g),g=null,!0}},t.extend(t.Guide,t.Container,"clone","zimContainer",!1),t.Grid=function(e,r,i,l,a,s,f,c,x,k,v){var g="obj, color, pixels, hideKey, pixelKey, allowToggle, cache, numbers, style, group, inherit",b;if(b=st(t.Grid,arguments,g,this))return b;De("78"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Grid",this.group=k;var E=x===!1?{}:t.getStyle(this.type,this.group,v);if(n(e)&&(j.zdf?e=j.zdf.stage:e="stage"),n(r)&&(r=E.color!=null?E.color:t.black),e!="stage"&&(!e.addChild||!e.getBounds||!e.getBounds())){Wn("zim controls - Grid(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=E.pixels!=null?E.pixels:!(zdf&&zdf.scaling=="full")),n(l)&&(l=E.hideKey!=null?E.hideKey:"G"),n(a)&&(a=E.pixelKey!=null?E.pixelKey:"P"),n(s)&&(s=E.allowToggle!=null?E.allowToggle:!0),n(f)&&(f=E.cache!=null?E.cache:!0),n(c)&&(c=E.numbers!=null?E.numbers:!0);var A=this,T=10,h;this.mouseChildren=!1,this.mouseEnabled=!1;var w=80,P=26,y=A.numbersX=O("#dddddd",r,"#333333");y.shape.regX=w/2,y.shape.regY=-P/4,y.label.y=P*3/4;var C=A.numbersY=O("#dddddd",r,"#333333");C.shape.regX=-w/6,C.shape.regY=P/2,C.label.x=w/2+w/6,c||(y.visible=!1,C.visible=!1);function O(o,S,F){var p=new t.Container({style:!1});return p.shape=new Ge.Shape,p.shape.graphics.s(S).ss(1).f(o).r(0,0,w,P),p.shape.alpha=.9,p.addChild(p.shape),p.label=new Ge.Text("10","16px arial",F),p.label.textAlign="center",p.label.textBaseline="middle",p.addChild(p.label),p.mouseChildren=!1,p.mouseEnabled=!1,p}var _=w/6+w/2,Y=P*2,m,$;y.x=_,C.y=Y,y.label.text="x:0",C.label.text="y:0";var I;e!="stage"&&e.addChild(A);var X=t.added(A,q),R=!1;function q(){if(e=="stage"?(I=A.stage,e=I):I=e.stage,I.frame&&I.frame.scaling=="full"){if(!t.globalManager){var o=t.globalManager=new t.Manager;o.frame=I.frame,o.event=I.frame.on("resize",function(){o.resize()})}t.globalManager.add(A)}R||(d(),e.addChild(A)),I.off("stagemousemove",h),h=I.on("stagemousemove",Z),I.update()}var J={x:0,y:0};function Z(o){var S;o?(S=e.globalToLocal(o.rawX/t.scaX,o.rawY/t.scaY),J=S):S={x:J.x,y:J.y},i?(y.label.text="x:"+Math.max(0,Math.min(Math.round(S.x),Math.round(ne))),y.x=Math.max(_,Math.min(S.x,m)),C.label.text="y:"+Math.max(0,Math.min(Math.round(S.y),Math.round(U))),C.y=Math.max(Y,Math.min(S.y,$))):(y.label.text="x:"+Math.max(0,Math.min(Math.round(S.x/ne*100),100))+"%",y.x=Math.max(_,Math.min(S.x,m)),C.label.text="y:"+Math.max(0,Math.min(Math.round(S.y/U*100),100))+"%",C.y=Math.max(Y,Math.min(S.y,$))),I&&I.update()}var ne,U,B;function d(){R=!0,e&&e.getBounds&&(ne=e.getBounds().width,U=e.getBounds().height),I&&(I.mouseMoveOutside=!0,I.enableMouseOver(10)),m=ne-w*2/3,$=U-P-P,B=A.grid=new t.Container({style:!1}),A.addChild(B);var o=new Ge.Shape;B.addChild(o);var S=o.graphics;S.s(r).ss(1);var F=new Ge.Shape;B.addChild(F);var p;if(i){for(p=0;p<ne/T;p++)S.mt(p*T,0).lt(p*T,U);for(p=0;p<U/T;p++)S.mt(0,p*T).lt(ne,p*T);for(o.alpha=.3,S=F.graphics,S.s(r).ss(1),p=0;p<ne/(T*10);p++)S.mt(p*(T*10),0).lt(p*(T*10),U);for(p=0;p<U/(T*10);p++)S.mt(0,p*(T*10)).lt(ne,p*(T*10))}else{for(p=1;p<20+1;p++)S.mt(p*ne/20,0).lt(p*ne/20,U);for(p=1;p<20;p++)S.mt(0,p*U/20).lt(ne,p*U/20);for(o.alpha=.3,S=F.graphics,S.s(r).ss(1),p=1;p<10;p++)S.mt(p*ne/10,0).lt(p*ne/10,U);for(p=1;p<10;p++)S.mt(0,p*U/10).lt(ne,p*U/10)}var L=80;S.s("#FFFFFF").ss(8),S.mt(ne/2,U/2-L/2).lt(ne/2,U/2+L/2),S.mt(ne/2-L/2,U/2).lt(ne/2+L/2,U/2),S.s("#000000").ss(4),S.mt(ne/2,U/2-L/2).lt(ne/2,U/2+L/2),S.mt(ne/2-L/2,U/2).lt(ne/2+L/2,U/2),S.s(r).ss(f?3:2),S.dr(0,0,ne,U),F.alpha=.5,f&&B.cache(0,0,ne,U),A.addChild(y),A.addChild(C),I&&I.update()}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(o){i=o,A.resize()}}),j.addEventListener("keydown",u);function u(o){o||(o=event),!(!I||!s)&&(String.fromCharCode(o.keyCode)==l.toUpperCase()&&A.toggle(),String.fromCharCode(o.keyCode)==a.toUpperCase()&&(A.removeChild(B),B=null,A.pixels=!A.pixels))}this.toggled=!0,this.toggle=function(o){return o===!0?A.visible=A.toggled=!0:o===!1?A.visible=A.toggled=!1:(A.visible=!A.visible,A.toggled=A.visible),I.off("stagemousemove",h),A.visible&&(h=I.on("stagemousemove",Z,A)),I&&I.update(),A},this.resize=function(){return A?(A.removeChild(B),B=null,I&&(d(),Z(),setTimeout(function(){A&&A.removeChild(B),B=null,d()},200)),!0):!1},x!==!1&&t.styleTransforms(this,E),this.dispose=function(){if(t.globalManager){var o=t.globalManager;o.remove(A),t.globalManager.items.length==0&&(o.frame.off("resize",o.event),o.dispose(),t.globalManager=null)}return clearInterval(X),A.removeAllChildren(),j.removeEventListener("keydown",u),A.parent&&A.parent.removeChild(A),A=null,!0}},t.extend(t.Grid,t.Container,"clone","zimContainer",!1),t.Wrapper=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y){var m="items, width, spacingH, spacingV, wrapperType, align, valign, alignInner, valignInner, flip, reverse, bottomFull, colSize, rowSize, height, minSpreadNum, minStretchNum, percentVoidH, offsetVoidH, percentVoidV, offsetVoidV, style, group, inherit",$=null;if($=st(t.Wrapper,arguments,m,this))return $;De("78.5"),this.group=_;var I=O===!1?{}:t.getStyle("Wrapper",this.group,Y);n(r)&&(r=I.width!=null?I.width:300),n(A)&&(A=I.height!=null?I.height:null),n(i)&&(i=I.spacingH!=null?I.spacingH:null),n(l)&&(l=I.spacingV!=null?I.spacingV:null),n(a)&&(a=I.wrapperType!=null?I.wrapperType:"spacing"),n(s)&&(s=I.align!=null?I.align:"left"),n(f)&&(f=I.valign!=null?I.valign:"top"),n(c)&&(c=I.alignInner!=null?I.alignInner:"left"),n(x)&&(x=I.valignInner!=null?I.valignInner:"bottom"),n(k)&&(k=I.flip!=null?I.flip:!1),n(v)&&(v=I.reverse!=null?I.reverse:!1),n(g)&&(g=I.bottomFull!=null?I.bottomFull:!1),n(b)&&(b=I.colSize!=null?I.colSize:100),n(E)&&(E=I.rowSize!=null?I.rowSize:null),n(i)&&(i=0),n(l)&&(l=0),n(T)&&(T=I.minSpreadNum!=null?I.minSpreadNum:2),n(h)&&(h=I.minStretchNum!=null?I.minStretchNum:3),n(w)&&(w=I.percentVoidH!=null?I.percentVoidH:0),n(P)&&(P=I.offsetVoidH!=null?I.offsetVoidH:0),n(y)&&(y=I.percentVoidV!=null?I.percentVoidV:0),n(C)&&(C=I.offsetVoidV!=null?I.offsetVoidV:0);var X=200,R=0,q=0,J=0,Z=r;this.items=[];var ne,U;a=="spread"?ne=!0:a=="stretch"&&(U=!0),this.zimContainer_constructor(r,X),this.type="Wrapper",s=="middle"&&(s="center"),f=="middle"&&(f="center"),c=="middle"&&(c="center"),x=="middle"&&(x="center");var B=this;this.add=function(u){return this.addAt(u,this.numChildren-1),B},this.addAt=function(u,o){return n(u)||((n(o)||o<0)&&(o=0),Array.isArray(u)||(u=[u]),t.loop(u,function(S,F){B.addChildAt(S,o+F)}),B.resize()),B},this.remove=function(u){return Array.isArray(u)||(u=[u]),t.loop(u,function(o){o&&o.removeFrom&&o.removeFrom()},!0),B.resize(),B},this.convert=function(u,o){var S=[];return u.loop(function(F){S.push(F),o&&F.cache()}),B.add(S),u.removeFrom(),B},this.resize=function(u,o){if(!B.preventResize){n(u)||(r=u),n(o)||(A=o),this.items2D=[],this.items=[],R=0,q=0,J=0,n(w)&&(w=0),n(P)&&(P=0);var S=t.Pick.choose(w),F=t.Pick.choose(P);Z=r*(100-S)/100,this.setBounds(Z,X);var p=0,L=0,we=0;B.cols=0,B.rows=0;var D=[],N=[0],ue=null,fe=0,V=null,z=t.Pick.choose(b);a!="column"&&(z=null);var se=t.Pick.choose(E),Oe=0,K,ge;t.loop(this,function(ke,te){g||k?ke.pos(p+(ke.marginRight?ke.marginRight:0),L+(ke.marginTop?ke.marginTop:0),t.RIGHT,k?t.TOP:t.BOTTOM):ke.pos(p+(ke.marginLeft?ke.marginLeft:0),L+(ke.marginTop?ke.marginTop:0)),Oe++,V=ke.boundsToGlobal();var pe=B.globalToLocal(V.x,V.y),he=B.globalToLocal(V.x+V.width,V.y+V.height);if(g||k?K=B.globalToLocal(V.x,V.y):K=B.globalToLocal(V.x+V.width,V.y+V.height),ke.wrapHeight=he.y-pe.y,ke.wrapWidth=he.x-pe.x,S){var ae=B.globalToLocal(V.x+ke.wrapWidth/2,V.y+ke.wrapHeight/2);ke.centerX=ae.x,ke.centerY=ae.y,ae=null}z?ge=z*Oe:g||k?ge=Z-K.x+(ke.marginLeft?ke.marginLeft:0)+i:ge=K.x+(ke.marginRight?ke.marginRight:0)+i,Math.round(ge)-i>Z&&(d(D,ue,we,fe,z,S,F,!1),fe=0,B.cols==0&&(B.cols=te),p=0,L+=we+(se?0:t.Pick.choose(l)),we=0,se=t.Pick.choose(E),S=t.Pick.choose(w),F=t.Pick.choose(P),Oe=0,B.items2D.push(t.copy(D)),B.rows++,N.push(L),D=[],g||k?ke.pos(p+(ke.marginRight?ke.marginRight:0),L+(ke.marginTop?ke.marginTop:0),t.RIGHT,k?t.TOP:t.BOTTOM):ke.pos(p+(ke.marginLeft?ke.marginLeft:0),L+(ke.marginTop?ke.marginTop:0)),S&&(V=ke.boundsToGlobal(),ae=B.globalToLocal(V.x+ke.wrapWidth/2,V.y+ke.wrapHeight/2),ke.centerX=ae.x,ke.centerY=ae.y,ae=null),Oe++,z?ge=0:(ge=(ke.marginLeft?ke.marginLeft:0)+ke.wrapWidth+(ke.marginRight?ke.marginRight:0)+t.Pick.choose(i),g||k?K.x=Z-((ke.marginRight?ke.marginRight:0)+ke.wrapWidth):K.x=(ke.marginLeft?ke.marginLeft:0)+ke.wrapWidth)),D.push(ke),fe+=ke.wrapWidth,p=ge,se?we=se:we=Math.max(we,ke.wrapHeight+(ke.marginTop?ke.marginTop:0)+(ke.marginBottom?ke.marginBottom:0)),ue=new t.Point(K.x,L+we)},v&&g?!1:v||g),B.numChildren>0&&(B.cols==0&&(B.cols=B.numChildren),B.items2D.push(t.copy(D)),N.push(L),d(D,ue,we,fe,z,S,F,!0),B.rows+=1);var Q=t.Pick.choose(f),ce;n(Q)&&(Q="top"),g&&(ce=L+we-X,t.loop(this,function(ke){ke.mov(0,ce)}),B.items2D.reverse(),t.loop(B.items2D,function(ke){ke.reverse()}));var G=t.Pick.choose(y),le=t.Pick.choose(C);if(!n(G)){n(le)&&(le=0);var Ae=L+we,re=Ae*G/100,xe=Ae/2+le/100*Ae;t.loop(N,function(ke,te){if(ke>=xe)return t.loop(B.items2D,function(pe){t.loop(pe,function(he){he.mov(0,re)})},null,1,te),"break"})}return n(A)||(f=="bottom"?(ce=A-(L+we),t.loop(this,function(ke){ke.mov(0,ce)})):(f=="center"||f=="middle")&&(ce=(A-(L+we))/2,t.loop(this,function(ke){ke.mov(0,ce)}))),B.setBounds(null),V=B.getBounds(),V&&B.setBounds(0,V.y,r,V.height),t.loop(B.items2D,function(ke){t.loop(ke,function(te){B.items.push(te)})}),this.stage&&this.stage.update(),B}};function d(u,o,S,F,p,L,we,D){var N=t.Pick.choose(s),ue=t.Pick.choose(ne),fe=t.Pick.choose(U),V=t.Pick.choose(k),z=t.Pick.choose(c),se=t.Pick.choose(x);n(N)&&(N="left"),n(se)&&(se="top"),n(z)&&(z="left"),V&&u.reverse();var Oe=((100-L)/100/2+we/100)*r,K=r*L/100,ge=0,Q=!1,ce,G;if(p){(g||k)&&u.reverse();var le=Z%p,Ae=Z/2+we/100*Z,re=0,xe=0,ke=Math.floor(Z/p);B.rows!=0&&D&&(Q=!0),t.loop(u,function(Ee,ie){ge=0,z=="right"?xe=p*ie+re+p-Ee.wrapWidth:z=="center"||z=="middle"?xe=p*ie+re+(p-Ee.wrapWidth)/2:xe=p*ie+re,ce=Ee.x,Ee.pos(xe),G=Ee.x-ce,Ee.centerX+=G,Ee.marginLeft&&(ge+=Ee.marginLeft),Ee.marginRight&&(ge-=Ee.marginRight);var Se;N=="center"||N=="middle"?(Se=Math.floor(Z/p)-u.length,ge+=(le+(Se?Se*p:0))/2):N=="right"&&(Se=Math.floor(Z/p)-u.length,ge+=le+(Se?Se*p:0)),Ee.mov(ge),Ee.centerX+=ge}),N=="center"&&Q&&(u.length+ke)%2!=0&&(ge=(Ae<=Z/2?-1:1)*p/2,t.loop(u,function(Ee){Ee.mov(ge),Ee.centerX+=ge}))}else if(ue||fe){var te,pe;ue?te=u.length?(Z-F)/(u.length+1):0:fe&&(te=u.length-1>0?(Z-F)/(u.length-1):0),u.length<h&&B.rows!=0&&D&&(te=J,Q=!0),J=te;var he=0;if((g||k)&&u.reverse(),t.loop(u,function(Ee,ie){ge=0,ce=Ee.x,Ee.pos(te*(ie+(ue?1:0))+he),G=Ee.x-ce,Ee.centerX+=G,Q||(Ee.marginLeft&&(ge+=Ee.marginLeft),Ee.marginRight&&(ge-=Ee.marginRight),Ee.mov(ge),Ee.centerX+=ge),he+=Ee.wrapWidth}),Q){ge=0;var ae=ue?te:0;G=0,t.loop(u,function(Ee){if(N=="right")ce=Ee.x,Ee.pos(ae,null,t.RIGHT),G=Ee.x-ce,ae+=Ee.wrapWidth+te;else if(N=="center"){var ie=(Z-(he+(u.length-1)*te))/2-(ue?te:0);ce=Ee.x,Ee.pos(ae+ie,null,t.RIGHT),G=Ee.x-ce,ae+=Ee.wrapWidth+te}Ee.marginLeft&&(ge+=Ee.marginLeft),Ee.marginRight&&(ge-=Ee.marginRight),Ee.mov(ge),Ee.centerX+=G+ge},!0)}}else N=="center"?t.loop(u,function(Ee){ge=((g||k?0:r)-o.x)/2,(ue||fe)&&(Ee.marginLeft&&(ge+=Ee.marginLeft),Ee.marginRight&&(ge-=Ee.marginRight)),Ee.mov(ge),Ee.centerX+=ge}):(g||k)&&N=="left"?(pe=u[u.length-1].marginLeft,t.loop(u,function(Ee){ge=-o.x+(pe||0),ue&&(ge+=q),Ee.mov(ge),Ee.centerX+=ge})):!(g||k)&&N=="right"?(pe=u[u.length-1].marginRight,t.loop(u,function(Ee){ge=r-o.x-(pe||0),ue&&(ge-=q),Ee.mov(ge),Ee.centerX+=ge})):ue&&ue&&t.loop(u,function(Ee){ge=q*(N=="right"?-1:1),Ee.mov(ge),Ee.centerX+=ge});L&&(Oe=(1/2+we/100)*Z,K=r*L/100,t.loop(u,function(Ee){p||fe||ue?N=="right"?Ee.centerX>Z-Oe&&Ee.mov(K):N=="center"?Math.round(Ee.centerX)==Math.round(Z/2+we/100*Z)?Ee.mov(K/2):Math.round(Ee.centerX)>Math.round(Z/2+we/100*Z)&&Ee.mov(K):Ee.centerX>Oe&&Ee.mov(K):!(g||k)&&N=="right"?Ee.centerX<r-Oe&&Ee.mov(-K):!(g||k)&&N=="center"?Ee.centerX>r/2+we/100*Z?Ee.mov(K/2):Ee.mov(-K/2):(g||k)&&N=="right"?Ee.centerX>Z-Oe&&Ee.mov(K):(g||k)&&N=="center"?Ee.centerX>Z/2+we/100*Z&&Ee.mov(K):Ee.centerX>Oe&&Ee.mov(K)})),ue&&(R+=te,q=R/(B.rows+1)),se=="center"?t.loop(u,function(Ee){Ee.mov(0,(S-Ee.wrapHeight)/2*(g?-1:1))}):!g&&se=="bottom"?t.loop(u,function(Ee){Ee.mov(0,S-Ee.wrapHeight-(Ee.marginBottom?Ee.marginBottom:0))}):g&&se=="top"&&t.loop(u,function(Ee){Ee.mov(0,-(S-Ee.wrapHeight)+(Ee.marginTop?Ee.marginTop:0))})}Object.defineProperty(B,"spacingH",{get:function(){return i},set:function(u){i=u,this.resize()}}),Object.defineProperty(B,"spacingV",{get:function(){return l},set:function(u){l=u,this.resize()}}),Object.defineProperty(B,"wrapperType",{get:function(){return a},set:function(u){u=="spread"?ne=!0:ne=!1,u=="stretch"?U=!0:U=!1,a=u,this.resize()}}),Object.defineProperty(B,"align",{get:function(){return s},set:function(u){s=u,s=="middle"&&(s="center"),this.resize()}}),Object.defineProperty(B,"valign",{get:function(){return f},set:function(u){f=u,f=="middle"&&(f="center"),this.resize()}}),Object.defineProperty(B,"alignInner",{get:function(){return c},set:function(u){c=u,c=="middle"&&(c="center"),this.resize()}}),Object.defineProperty(B,"valignInner",{get:function(){return x},set:function(u){x=u,x=="middle"&&(x="center"),this.resize()}}),Object.defineProperty(B,"colSize",{get:function(){return b},set:function(u){b=u,a=="column"&&this.resize()}}),Object.defineProperty(B,"rowSize",{get:function(){return E},set:function(u){E=u,this.resize()}}),Object.defineProperty(B,"flip",{get:function(){return k},set:function(u){k=u,this.resize()}}),Object.defineProperty(B,"reverse",{get:function(){return v},set:function(u){v=u,this.resize()}}),Object.defineProperty(B,"bottomFull",{get:function(){return g},set:function(u){g=u,this.resize()}}),Object.defineProperty(B,"percentVoidH",{get:function(){return w},set:function(u){w=u,this.resize()}}),Object.defineProperty(B,"offsetVoidH",{get:function(){return P},set:function(u){P=u,this.resize()}}),Object.defineProperty(B,"percentVoidV",{get:function(){return y},set:function(u){y=u,this.resize()}}),Object.defineProperty(B,"offsetVoidV",{get:function(){return C},set:function(u){C=u,this.resize()}}),n(e)||B.add(e),O!==!1&&t.styleTransforms(this,I),this.clone=function(){var u=B.cloneProps(new t.Wrapper(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,this.style,this.group));return u}},t.extend(t.Wrapper,t.Container,"clone","zimContainer",!1),t.Tile=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U){var B="obj, cols, rows, spacingH, spacingV, unique, width, height, squeezeH, squeezeV, colSize, rowSize, align, valign, count, mirrorH, mirrorV, snapToPixel, clone, events, exact, scaleToH, scaleToV, scaleToType, backgroundColor, backing, backdropColor, backdropPadding, backdropPaddingH, backdropPaddingV, mat, style, group, inherit",d;if(d=st(t.Tile,arguments,B,this))return d;De("66.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Tile",this.group=ne;var u=Z===!1?{}:t.getStyle(this.type,this.group,U);n(e)&&(e=u.obj!=null?u.obj:new t.Circle),n(r)&&(r=u.cols!=null?u.cols:1121),n(i)&&(i=u.rows!=null?u.rows:1121);var o;r==1121&&i==1121?r=i=o=3:r==1121?r=1:i==1121&&(i=1),n(s)&&(s=u.unique!=null?u.unique:!1),n(f)&&(f=u.width!=null?u.width:null),n(c)&&(c=u.height!=null?u.height:null),n(v)&&(v=u.colSize!=null?u.colSize:null),n(g)&&(g=u.rowSize!=null?u.rowSize:null),n(f)||(v=null),n(c)||(g=null),n(l)&&(l=u.spacingH!=null?u.spacingH:o?3:null),n(a)&&(a=u.spacingV!=null?u.spacingV:o?3:null);var S=l,F=a;(n(l)||!n(v)||!n(f))&&(l=0),(n(a)||!n(g)||!n(c))&&(a=0),n(x)&&(x=u.squeezeH!=null?u.squeezeH:!1),n(k)&&(k=u.squeezeV!=null?u.squeezeV:!1),n(b)&&(b=u.align!=null?u.align:"left"),n(E)&&(E=u.valign!=null?u.valign:"top"),n(A)&&(A=u.count!=null?u.count:s&&Array.isArray(e)?e.length:null),A===0&&(A=null,pt&&tt("ZIM Tile() - count parameter of 0 is ignored - see docs")),n(T)&&(T=u.mirrorH!=null?u.mirrorH:!1),n(h)&&(h=u.mirrorV!=null?u.mirrorV:!1),n(w)&&(w=u.snapToPixel!=null?u.snapToPixel:!0),w&&(e&&e.stage?e.stage.snapToPixelEnabled=!0:typeof elem<"u"&&j.zdf&&(j.zdf.stage.snapToPixelEnabled=!0)),n(P)&&(P=u.clone!=null?u.clone:s?!1:null),P==null&&(P=!(typeof e=="function"&&e.type!="series")),n(y)&&(y=u.events!=null?u.events:!0),n(O)&&(O=u.scaleToH!=null?u.scaleToH:null),n(_)&&(_=u.scaleToV!=null?u.scaleToV:null),n(Y)&&(Y=u.scaleToType!=null?u.scaleToType:null),n(m)&&(m=u.backgroundColor!=null?u.backgroundColor:null),n($)&&($=u.backing!=null?u.backing:null),n(I)&&(I=u.backdropColor!=null?u.backdropColor:null),n(X)&&(X=u.backdropPadding!=null?u.backdropPadding:null),n(R)&&(R=u.backdropPaddingH!=null?u.backdropPaddingH:n(I)?null:X||l),n(q)&&(q=u.backdropPaddingV!=null?u.backdropPaddingV:n(I)?null:X||a),(q||R)&&(X=!0),n(J)&&(J=u.mat!=null?u.mat:!1);var p=this;p.cols=r=Math.round(r),p.rows=i=Math.round(i),p.spacingH=l,p.spacingV=a,p.squeezeH=x,p.squeezeV=k;var L=typeof b=="function",we=typeof E=="function";p.align=L?"left":b,p.valign=we?"top":E,p.mirrorH=T,p.mirrorV=h,p.items=[];var D,N=0,ue=!1;e:for(var fe=0;fe<i;fe++)for(var V=0;V<r;V++){if(N++,!n(A)&&N>A)break e;D=s?e[N-1]:t.Pick.choose(e),typeof D=="string"&&(D=j.asset(D).centerReg({add:!1}).clone()),n(D)&&(D=new t.Container(0,0,0,0)),P&&(fe!=0||V!=0)&&(D=D.clone(C)),y&&D.on("change",function(oe){var Fe=new Ge.Event("change");Fe.item=oe.currentTarget,p.dispatchEvent(Fe)}),p.items.push(D),D.type=="AC"&&(ue=!0),D.tileNum=N-1,D.tileCol=V,D.tileRow=fe}ue&&pt&&tt("ZIM Tile - assets must have dimensions for Tile");var z,se,Oe,K,ge,Q,ce,G,le,Ae,re,xe,ke,te;function pe(){p.removeAllChildren(),z=[],se=[],Oe=[],K=[],ge=[],Q=0,ce=0,G=0,le=0,Ae=[],re=[],xe=[],te=[],ke=[],(!p.items||!p.items.length)&&(p.items=[]),A=p.items.length;var oe=0,Fe,Ze,Xe=0,We=0,de,Ve;for(Ze=0;Ze<A;Ze++)Xe=Math.floor(Ze/p.cols),We=Ze%p.cols,n(z[Xe])&&(z[Xe]=[]),n(p.items[Ze])&&(p.items[Ze]=new t.Container(0,0,0,0)),z[Xe][We]=p.items[Ze];p.rows=Math.max(1,z.length),p.cols=Math.max(1,n(z[0])?0:z[0].length);e:for(Xe=0;Xe<p.rows;Xe++)for(Ae.push([]),re.push([]),te.push([]),g&&n(c)&&(de=t.Pick.choose(g)),Ze=0;Ze<p.cols;Ze++){if(oe++,!n(A)&&oe>A)break e;Fe=z[Xe][Ze],Fe.snapToPixel=w,p.addChild(Fe),Ae[Xe].push(Fe.scaleX),re[Xe].push(Fe.scaleY),v&&n(f)&&(Ve=t.Pick.choose(v)),Xe==0&&ke.push(t.Pick.choose(b)),(!v||!n(f))&&(Ve=Math.abs(Fe.width)),(!g||!n(c))&&(de=Math.abs(Fe.height)),te[Xe][Ze]=[Ve,de],n(K[Ze])&&(K[Ze]=0),n(ge[Xe])&&(ge[Xe]=0),Ve>K[Ze]&&(K[Ze]=Ve),de>ge[Xe]&&(ge[Xe]=de),n(se[Xe])&&(se[Xe]=0),n(Oe[Ze])&&(Oe[Ze]=0),se[Xe]+=Ve,Oe[Ze]+=de,se[Xe]>Q&&(Q=se[Xe]),Oe[Ze]>ce&&(ce=Oe[Ze]),n(xe[Ze])&&(xe[Ze]=0),xe[Ze]++}var be;if(p.squeezeH===!1)for(Ze=0;Ze<K.length;Ze++)be=K[Ze],G+=be;if(p.squeezeV===!1)for(Ze=0;Ze<ge.length;Ze++)be=ge[Ze],le+=be}pe();var he=G,ae=le,Ee,ie,Se,Le,Ce=1,ee=1;function Me(oe,Fe){!n(I)&&X&&(oe-=Math.max(R*2,0),Fe-=Math.max(q*2,0)),oe<=0&&(oe=null),Fe<=0&&(Fe=null),!n(oe)&&p.squeezeH=="full"?Ee=oe:n(oe)?G>0?Ee=G+(p.cols-1)*p.spacingH:Ee=Q+(p.cols-1)*p.spacingH:O?Ee=oe:Ee=Math.max(Q+(p.cols-1)*p.spacingH,oe),!n(Fe)&&p.squeezeV=="full"?ie=Fe:n(Fe)?le>0?ie=le+(p.rows-1)*p.spacingV:ie=ce+(p.rows-1)*p.spacingV:_?ie=Fe:ie=Math.max(ce+(p.rows-1)*p.spacingV,Fe),p.setBounds(0,0,Ee,ie),Ce=(Ee-(p.cols-1)*S)/he,ee=(ie-(p.rows-1)*F)/ae;var Ze,Xe;Se=[],Le=[];var We=[];for(fe=0;fe<z.length;fe++)for(Ze=z[fe],Xe=0,V=0;V<Ze.length;V++){D=Ze[V];var de,Ve;if(fe==0&&(Se[V]=0,n(Fe)||(p.squeezeV=="full"?Le[V]=xe[V]>1?(Fe-Oe[V])/(xe[V]-1):0:p.squeezeV?Le[V]=xe[V]>1?Math.max(p.spacingV,(Fe-Oe[V])/(xe[V]-1)):0:Le[V]=xe[V]>1?Math.max(p.spacingV,(ie-Oe[V])/(xe[V]-1)):0),p.squeezeV?p.valign=="center"||p.valign=="middle"?We[V]=(ie-(Oe[V]+(xe[V]-1)*(n(Fe)?p.spacingV:Le[V])))/2:p.valign=="bottom"?We[V]=ie-(Oe[V]+(xe[V]-1)*(n(Fe)?p.spacingV:Le[V])):We[V]=0:We[V]=0),V==0){n(oe)||(p.squeezeH=="full"?Ve=Ze.length>1?(oe-se[fe])/(Ze.length-1):0:p.squeezeH?Ve=Ze.length>1?Math.max(p.spacingH,(oe-se[fe])/(Ze.length-1)):0:Ve=Ze.length>1?Math.max(p.spacingH,(Ee-se[fe])/(Ze.length-1)):0),p.squeezeH?p.align=="center"||p.align=="middle"?de=(Ee-(se[fe]+(Ze.length-1)*(n(oe)?p.spacingH:Ve)))/2:p.align=="right"?de=Ee-(se[fe]+(Ze.length-1)*(n(oe)?p.spacingH:Ve)):de=0:de=0;var be=t.Pick.choose(E)}b=ke[V];var Te=te[fe][V][0],Re=te[fe][V][1];p.mirrorH&&V%2==1&&(D.scaleX=-Ae[fe][V]),D.pos(Xe,null),!p.squeezeH&&L?n(oe)&&(b=="center"||b=="middle")?D.x+=(K[V]-D.width)/2:n(oe)&&b=="right"&&(D.x+=K[V]-D.width):p.squeezeH?n(oe)&&(p.align=="center"||p.align=="middle")?D.x+=(Te-D.width)/2:n(oe)&&p.align=="right"&&(D.x+=Te-D.width):n(oe)&&(p.align=="center"||p.align=="middle")?D.x+=(K[V]-D.width)/2:n(oe)&&p.align=="right"&&(D.x+=K[V]-D.width),p.mirrorV&&fe%2==1&&(D.scaleY=-re[fe][V]),D.pos(null,Se[V]),!p.squeezeV&&we?n(Fe)&&(be=="center"||be=="middle")?D.y+=(ge[fe]-D.height)/2:n(Fe)&&be=="bottom"&&(D.y+=ge[fe]-D.height):p.squeezeV?n(Fe)&&(p.valign=="center"||p.valign=="middle")?D.y+=(Re-D.height)/2:n(Fe)&&p.valign=="bottom"&&(D.y+=Re-D.height):n(Fe)&&(p.valign=="center"||p.valign=="middle")?D.y+=(ge[fe]-D.height)/2:n(Fe)&&p.valign=="bottom"&&(D.y+=ge[fe]-D.height),p.squeezeH===!0||!n(oe)?Xe+=Te+(n(oe)?p.spacingH:Ve):Xe+=K[V]+(n(oe)?p.spacingH:Ve),D.x+=de,D.y+=We[V],p.squeezeV===!0||!n(Fe)?Se[V]+=Re+(n(Fe)?p.spacingV:Le[V]):Se[V]+=ge[fe]+(n(Fe)?p.spacingV:Le[V])}}Me(f,c),this.itemUnderPoint=function(oe,Fe,Ze){if(n(Ze)&&(Ze=!0),!(n(oe)||n(Fe))){var Xe=p.globalToLocal(oe,Fe);oe=Xe.x,Fe=Xe.y;var We=0,de=t.loop(K,function(Te,Re){if(We+=Te+p.spacingH,(!Ze||Ze=="vertical")&&oe>We-p.spacingH&&oe<We)return!1;if(oe<We-p.spacingH/2)return Re});if(de!==!1&&(de===!0&&(de=r-1),!(oe<0||oe>Ee||Fe<0||Fe>ie))){var Ve=0,be=t.loop(ge,function(Te,Re){var Ne=n(c)?p.spacingV:Le[V];if((!Ze||Ze=="horizontal")&&Fe>Ve-Ne&&Fe<Ve)return!1;if(Ve+=Te+Ne,Fe<Ve-Ne/2)return Re});if(be!==!1)return be===!0&&(be=i-1),p.items2D[be][de]}}},this.remake=function(oe){return n(oe)||(p.items=oe),pe(),Me(f,c),Pe(!0),p},this.resize=function(oe,Fe){return n(oe)&&(oe=f),n(Fe)&&(Fe=c),f=oe,c=Fe,Me(oe,Fe),Pe(!0),p};function _e(oe){for(var Fe=[],Ze,Xe=0;Xe<oe.length;Xe++)Xe%p.cols==0&&(Ze=[],Fe.push(Ze)),Ze.push(oe[Xe]);return Fe}function Ye(oe){var Fe=[],Ze;for(Ze=0;Ze<p.cols;Ze++)Fe.push([]);for(Ze=0;Ze<oe.length;Ze++)Fe[Ze%p.cols][Math.floor(Ze/p.cols)]=oe[Ze];return Fe}Object.defineProperty(this,"items2D",{get:function(){return _e(p.items)},set:function(){pt&&tt("Tile() - items2D is read only")}}),Object.defineProperty(this,"items2DCols",{get:function(){return Ye(p.items)},set:function(){pt&&tt("Tile() - items2DCols is read only")}}),Object.defineProperty(this,"current",{get:function(){var oe=[];return t.loop(p.items,function(Fe){var Ze=Fe.getBounds(),Xe=Fe.x-Fe.regX+Ze.x+Ze.width/2,We=Fe.y-Fe.regY+Ze.y+Ze.height/2,de=p.hitTestGrid(p.width,p.height,p.cols,p.rows,Xe,We,null,null,p.spacingH,p.spacingV,!0,"open");de!=null&&(oe[de[0]]=Fe)}),oe},set:function(){pt&&tt("Tile() - current is read only")}}),Object.defineProperty(this,"current2D",{get:function(){return _e(p.current)},set:function(){pt&&tt("Tile() - current2D is read only")}}),Object.defineProperty(this,"current2DCols",{get:function(){return Ye(p.current)},set:function(){pt&&tt("Tile() - current2DCols is read only")}});var je,it,Be,qe,et,ve;function Pe(oe){if(oe&&(qe&&qe.removeFrom(),J&&J.removeFrom()),!n(m)||$||O||_){!oe&&(O||_)&&(et=[],ve=[]),(!oe||n(m))&&(je=[]),!oe&&!n(m)&&(Be=[]),!oe&&$&&(it=[]);var Fe=(v?S:0)/2,Ze=(g?F:0)/2,Xe,We=0;if(t.loop(p.items2D,function(Ve,be){t.loop(Ve,function(Te,Re){var Ne=black;if(n(m)||(oe&&!n(m)?(Ne=Be[We],Xe=je[We].siz(K[Re]*Ce-(v?S:0),ge[be]*ee-(g?F:0)).loc(Fe,Ze,p,0)):(Ne=nt(m),Be.push(m),Xe=new t.Rectangle({width:K[Re]*Ce-(v?S:0),height:ge[be]*ee-(g?F:0),color:Ne,style:!1,scaleDimensions:!1,strokeObj:{ignoreScale:!0},group:"background"}).loc(Fe,Ze,p,0),je.push(Xe)),Te.pos(0,0,b,E,Xe).addTo(p)),Fe=Xe.x+Xe.width+S,O||_){var Ue,rt;if(oe)Ue=et[We],rt=ve[We];else{var Ue=nt(O)||100,rt=nt(_)||100;et.push(Ue),ve.push(rt)}Te.scaleTo(Xe,Ue,rt,Y).pos(0,0,b,E,Xe).addTo(p)}if($){var me;oe?me=it[We]:me=nt($).clone(null,!1),it.push(me),me.pos(0,0,b,E,Xe).addTo(p)}We++}),Fe=(v?S:0)/2,Ze+=Xe.height+F}),$&&!n(m)&&t.loop(it,function(Ve){Ve.addTo(p,je.length)},!0),n(m)?(t.loop(je,function(Ve){Ve.dispose()},!0),je=null,Be=null):(p.backgrounds=je,p.backgroundColors=Be),!n(m)&&(v||g)){p.loop(function(Ve){Ve.mov(v?-S/2:0,g?-F/2:0)});var de=p.getBounds();p.setBounds(de.x,de.y,de.width-(v?S:0)*r,de.height-(g?F:0)*i),de=p.getBounds()}$&&(p.backings=it)}if(J&&(p.mat=J,J.center(p,0)),I){var de=p.getBounds();qe=p.backdrop=new t.Rectangle({width:de.width+R*2,height:de.height+q*2,color:I,style:!1,group:"backdrop"}),qe.center(p,0),p.loop(function(be){be.mov(Math.max(0,R),Math.max(q,0))}),p.setBounds(0,0,de.width+Math.max(0,R)*2,de.height+Math.max(q,0)*2)}}Pe(),Z!==!1&&t.styleTransforms(this,u),this.clone=function(oe){if(oe){var Fe=[];if(m)var Ze=[];if($)var Xe=[];for(var We=0;We<p.items.length;We++)Fe.push(p.items[We].clone(!0)),m&&Ze.push(Be[We]),$&&Xe.push(it[We].clone(!0))}return p.cloneProps(new t.Tile(oe&&Fe?t.series(Fe):e.clone?e.clone():e,p.cols,p.rows,p.spacingH,p.spacingV,oe?!1:s,f,c,p.squeezeH,p.squeezeV,v,g,b,E,p.items.length,p.mirrorH,p.mirrorV,w,oe?!1:P,y,oe,O,_,Y,oe&&Ze?t.series(Ze):m,oe&&Xe?t.series(Xe):$&&$.clone?$.clone():$,I,X,R,q,J&&J.clone?J.clone():J,this.style,this.group))}},t.extend(t.Tile,t.Container,"clone","zimContainer",!1),t.Pack=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m){var $="width, height, items, spacingH, spacingV, flatten, direction, lock, backgroundColor, align, valign, lastAlign, paddingH, paddingV, dragOrder, dragColor, dragThickness, dragDashed, reverse, funnel, showPacking, order, style, group, inherit",I;if(I=st(t.Pack,arguments,$,this))return I;De("66.52"),this.group=Y;var X=_===!1?{}:t.getStyle("Pack",this.group,m);n(e)&&(e=X.width!=null?X.width:500),n(r)&&(r=X.height!=null?X.height:500),this.zimContainer_constructor(e,r),this.type="Pack",n(i)&&(i=X.items!=null?X.items:[new t.Rectangle(400,300,t.orange),new t.Rectangle(400,200,t.purple),new t.Rectangle(500,300,t.blue)]),n(l)&&(l=X.spacingH!=null?X.spacingH:10),n(a)&&(a=X.spacingV!=null?X.spacingV:10),n(s)&&(s=X.flatten!=null?X.flatten:"top"),n(f)&&(f=X.direction!=null?X.direction:"horizontal"),n(c)&&(c=X.lock!=null?X.lock:"auto"),n(x)&&(x=X.backgroundColor!=null?X.backgroundColor:t.clear),n(k)&&(k=X.align!=null?X.align:"center"),n(v)&&(v=X.valign!=null?X.valign:"center"),n(g)&&(g=X.lastAlign!=null?X.lastAlign:f=="horizontal"?"left":"top"),n(b)&&(b=X.paddingH!=null?X.paddingH:0),n(E)&&(E=X.paddingV!=null?X.paddingV:0),n(A)&&(A=X.dragOrder!=null?X.dragOrder:!1),n(T)&&(T=X.dragColor!=null?X.dragColor:t.white),n(h)&&(h=X.dragThickness!=null?X.dragThickness:2),n(w)&&(w=X.dragDashed!=null?X.dragDashed:!0),n(P)&&(P=X.reverse!=null?X.reverse:!1),n(y)&&(y=X.funnel!=null?X.funnel:!1),n(C)&&(C=X.showPacking!=null?X.showPacking:!1),n(O)&&(O=X.order!=null?X.order:null);var R=this;R.funnel=y;var q=i.length,J=e-b*2,Z=r-E*2,ne=50;s===!1&&(s=NONE);var U=this.backing=new Mn({width:e,height:r,color:x,scaleDimensions:!1}).addTo(this);if(R.items=t.copy(i),i.length<=0)return this;if(i.length==1)return d(i[0]),u(i[0]),this;var B=function(ae,Ee,ie){return ae.width>Ee.width?1:ae.width<Ee.width?-1:0};function d(ae){ae.scaleTo(U,100-b/J*100*2,100-E/Z*100*2),ae.scale*=R.scale,ae.scale<0&&(ae.scale=.05)}function u(ae){ae.pos(k!=CENTER&&k!=MIDDLE?b:0,v!=CENTER&&v!=MIDDLE?E:0,k,v,U).addTo(R)}function o(ae){var Ee=[];t.loop(ae,function(ie,Se){Ee[Se]=R.items[ie]}),i=[],t.loop(Ee,function(ie){ie&&i.push(ie)})}var S=R.content=new t.Container,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge;t.loop(i,function(ae,Ee){ae.zpRotation=ae.rotation,ae.zpIndex=Ee}),O&&o(O),f==VERTICAL&&Q(!0);function Q(ae){S.rotation=0;var Ee=r;r=e,e=Ee;var ie=Z;Z=J,J=ie;var Se=a;a=l,l=Se;var Le=E;E=b,b=Le,s==RIGHT?s=BOTTOM:s!=CENTER&&s!=NONE&&(s=TOP),g==BOTTOM?g=LEFT:g!=CENTER&&g!=MIDDLE&&(g=RIGHT),U.dispose(),U=new Mn(e,r,x).center(R),ae?(c==HORIZONTAL?c=VERTICAL:c==VERTICAL&&(c=HORIZONTAL),t.loop(i,function(Ce,ee){var Me=new t.Container(Ce.height,Ce.width);Ce.rotation+=90,Ce.pos(0,0,TOP,LEFT,Me),i[ee]=Me})):(c==HORIZONTAL?c=VERTICAL:c==VERTICAL&&(c=HORIZONTAL),S.rotation-=90,t.loop(i,function(Ce,ee){var Me=Ce,_e=Ce.getChildAt(0).addTo(S).sca(Me.scale);Me.dispose(),i[ee]=_e}))}var ce=c;function G(ae){c==AUTO&&(c=HORIZONTAL),F=Math.ceil(Math.sqrt(q)),p=Math.ceil(q/F),D=null,N=null,ue=0,ge=null,fe=0,V=0,z=null,se=null,Oe=null,K=null,he(ae,F,p),pe(S,F,p)}G(i),le();function le(){if(d(S),u(S),s==NONE){t.loop(i,function(Se){Se.surrogate?(i.splice(i.indexOf(Se),1),Se.dispose()):Se.bot()},!0);var ae=p*F-q;if(s==NONE&&ae>0){var Ee=S.getChildAt(S.numChildren-1);if(f==HORIZONTAL&&!P&&g!=LEFT){var ie=S.getBounds().width-(Ee.x+(Ee.getBounds().x-Ee.regX)*Ee.scaleX+Ee.width);t.loop(F-ae,function(Se){S.getChildAt(S.numChildren-Se-1).mov(g==RIGHT?ie:ie/2)})}else if(f==HORIZONTAL&&P&&g!=RIGHT){var ie=Ee.x+(Ee.getBounds().x-Ee.regX)*Ee.scaleX;t.loop(F-ae,function(Le){S.getChildAt(S.numChildren-Le-1).mov(g==LEFT?-ie:-ie/2)})}else if(f==VERTICAL&&!P&&g!=RIGHT){var ie=Ee.x;t.loop(F-ae,function(Le){S.getChildAt(S.numChildren-Le-1).mov(g==LEFT?-ie:-ie/2)})}else if(f==VERTICAL&&P&&g!=LEFT){var ie=S.getBounds().width-Ee.x;t.loop(F-ae,function(Le){S.getChildAt(S.numChildren-Le-1).mov(g==RIGHT?ie:ie/2)})}}}f==VERTICAL&&(Q(!1),d(S),u(S)),R.cols=F,R.rows=p,R.iterations=ue-2,R.currentItems=i,R.dispatchEvent("change")}var Ae,re,xe;A&&R.added(ke);function ke(){te(),xe=Math.min(30,f==HORIZONTAL?S.height/p/3*R.scale*S.scale:S.width/F/3*R.scale*S.scale),Ae?Ae.siz(xe,xe).reg(CENTER):Ae=R.beacon=new t.Rectangle({width:xe,height:xe,borderColor:T,borderWidth:h,scaleDimensions:!1}).reg(CENTER).rot(45),re||(re=R.ghost=new t.Rectangle({width:100,height:100,borderColor:T,borderWidth:h,dashed:w,scaleDimensions:!1}).reg(CENTER));var ae,Ee,ie,Se;R.mdEvent=R.on("mousedown",function(Le){if(ie=Le.target,Ae.top(),ae=null,!(i.indexOf(ie)<0)){Se=R.localToGlobal(R.getBounds().x,R.getBounds().y);var Ce=ie.boundsToGlobal();R.ghost.siz(Ce.width,Ce.height).reg(CENTER).loc(Ce.x+re.width/2,Ce.y+re.height/2,R.stage),re.diffX=R.stage.frame.mouseX-re.x,re.diffY=R.stage.frame.mouseY-re.y,Ee=S.getChildIndex(ie),R.stage.update()}}),R.pmEvent=R.on("pressmove",function(){if(re.parent){var Le=R.stage.frame;re.loc(Le.mouseX-re.diffX,Le.mouseY-re.diffY);var Ce=R.getObjectUnderPoint((re.x-Se.x)/R.scaleX,(re.y-Se.y)/R.scaleY,1);if(i.indexOf(Ce)>=0){var ee=Ce.boundsToGlobal();f==HORIZONTAL?re.x>=ee.x+ee.width/2?(Ae.loc(ee.x+ee.width+l/2*R.scaleX*S.scaleX,ee.y+ee.height/2,R.stage),ae=S.getChildIndex(Ce)+(P?0:1)):(Ae.loc(ee.x-l/2*R.scaleX*S.scaleX,ee.y+ee.height/2,R.stage),ae=S.getChildIndex(Ce)+(P?1:0)):re.y>=ee.y+ee.height/2?(Ae.loc(ee.x+ee.width/2,ee.y+ee.height+a/2,R.stage),ae=S.getChildIndex(Ce)+(P?0:1)):(Ae.loc(ee.x+ee.width/2,ee.y-a/2,R.stage),ae=S.getChildIndex(Ce)+(P?1:0))}R.stage.update()}}),R.puEvent=R.on("pressup",function(){re.parent&&(ae!=null&&(ae>Ee&&ae--,ae!=Ee&&(ie.level=ae,i=[],S.loop(function(Le,Ce){i.push(Le.rot(Le.zpRotation||0).sca(1))}),c=ce,f==VERTICAL&&Q(!0),G(i),le())),re.removeFrom(),Ae.removeFrom(),R.stage.update())})}function te(){R.mdEvent&&R.off("mousedown",R.mdEvent),R.pmEvent&&R.off("pressmove",R.pmEvent),R.puEvent&&R.off("pressup",R.puEvent),Ae&&Ae.removeFrom(),re&&re.removeFrom()}function pe(ae,Ee,ie){if(ae.scale=1,ue++>20){ge&&ge.clear();return}var Se=!1;if(ae.height>Z){if(L=Ee+1,we=Math.ceil(q/L),Ee==N&&c==VERTICAL)if(V>fe)L=se,we=K,Se=!0;else return ae}else if(ae.height<=Z&&(L=Math.max(Ee-1,1),we=Math.ceil(q/L),Ee==N&&c==HORIZONTAL))if(V>fe)L=se,we=K,Se=!0;else return ae;if(N=D,D=F,F=L,p=we,t.loop(i,function(Le){s==NONE&&Le.surrogate?(i.splice(i.indexOf(Le),1),Le.dispose()):Le.siz(null,Z)},!0),he(i,F,p),V=fe,se=z,K=Oe,ce==AUTO||c==HORIZONTAL&&Math.round(ae.width)==J||c==VERTICAL&&Math.round(ae.height)==Z?fe=ae.width*ae.height:fe=0,z=F,Oe=p,Se){ge&&ge.clear(),u(ae),R.stage&&R.stage.update();return}C?(ge=zr(1,function(){pe(ae,F,p)}),u(ae),R.stage&&R.stage.update(),ae.sca(1)):(ae.sca(1),pe(ae,F,p))}function he(ae,Ee,ie){var Se=0;t.loop(ae,function(Be,qe){Be.siz(null,ne),Se+=Be.width});var Le=Se/q,Ce=ae;q%Ee!=0&&s==NONE&&t.loop(Ee-q%Ee,function(){var Be=new t.Rectangle(Le,ne,grey);Be.surrogate=!0,Ce.push(Be)});var ee=new ni(Ce,Ee,ie,0,0,!0),Me=[],_e=t.copy(ee.items2D);if(s!=NONE&&Ee*ie!=q&&_e.length>1){var Ye;if(s==BOTTOM)Ye=R.funnel?Math.floor((Ee*ie-q)/2):Math.ceil((Ee*ie-q)/2),t.loop(Ye,function(Be){_e[ie-1].unshift(_e[ie-2].pop())});else{var je=Ee*ie-q;t.loop(_e,function(Be,qe,et){qe!=et-1&&t.loop(Be.splice(-je,je),function(ve){_e[qe+1].unshift(ve)},!0)}),Ye=R.funnel?Math.floor((Ee*ie-q)/2):Math.ceil((Ee*ie-q)/2),t.loop(Ye,function(Be){_e[0].push(_e[1].shift())})}}t.loop(_e,function(Be,qe,et){var ve=0;t.loop(Be,function(Ze){ve+=Ze.width});var Pe=(J-l*(Be.length-1))/ve;t.loop(Be,function(Ze){Ze.scale*=Pe});var oe=t.copy(Be);(P&&f==HORIZONTAL||!P&&f==VERTICAL)&&oe.reverse();var Fe=new ni(oe,Be.length,1,l,0,!0);P&&Fe.loop(function(Ze){Ze.bot()}),Me.push(Fe)}),ee.dispose();var it=0;return S.loc(U,null,R),S.removeAllChildren(),t.loop(Me,function(Be){Be.loc(0,it,S),it+=Be.height+a,Be.loop(function(qe,et,ve){qe.addTo(S).ord(-(ve-et))},!0)}),t.loop(Me,function(Be){Be.dispose()},!0),d(S),S}R.getOrder=function(ae){if(n(ae)&&(ae=!1),ae){if(!Ee){var Ee=R.pane=new t.Pane({displayClose:!1,container:R.stage,width:Math.min(500,R.stage.width-20),height:Math.min(500,R.stage.height-20),draggable:!0}),ie=R.textArea=new t.TextArea(Math.min(400,R.stage.width-70),Math.min(400,R.stage.height-70));ie.centerReg(Ee)}Ee.show(),ie.text=JSON.stringify(R.order)}return R.order},this.setOrder=function(ae){return o(ae),G(i),le(),R},this.addAt=function(ae,Ee){return n(ae)||(n(Ee)&&(Ee=R.items.length),Array.isArray(ae)||(ae=[ae]),t.loop(ae,function(ie,Se){R.items.push(ie),ie.zpIndex=R.items.length-1,R.currentItems.splice(Ee+Se,0,ie)}),G(R.currentItems),le()),R},this.removeAt=function(ae,Ee){n(ae)&&(ae=1),n(Ee)&&(Ee=R.items.length);var ie=R.currentItems.splice(Ee,ae);return t.loop(ie,function(Se){var Le=R.items.indexOf(Se);R.items.splice(Le,1)}),G(R.currentItems),le(),R},Object.defineProperty(R,"order",{get:function(){var ae=[];return S.loop(function(Ee){ae.push(Ee.zpIndex)}),ae},set:function(ae){R.setOrder(ae)}}),Object.defineProperty(R,"lock",{get:function(){return ce},set:function(ae){ae!=ce&&(c=ae,G(i),le(),A&&ke())}}),Object.defineProperty(R,"direction",{get:function(){return f},set:function(ae){ae!=f&&(f=ae,S.rotation=0,i=[],S.loop(function(Ee,ie){i.push(Ee.rot(Ee.zpRotation||0).sca(1))}),f==VERTICAL&&Q(!0),G(i),le(),A&&ke())}}),Object.defineProperty(R,"spacing",{get:function(){return f==VERTICAL?a:l},set:function(ae){l=a=ae,G(i),le()}}),Object.defineProperty(R,"outerWidth",{get:function(){return e},set:function(ae){e!=ae&&(e=ae,J=e-b*2,U&&(U.widthOnly=e,U.center(R)),G(i),le(),A&&ke())}}),Object.defineProperty(R,"outerHeight",{get:function(){return r},set:function(ae){r!=ae&&(r=ae,Z=r-E*2,U&&(U.heightOnly=r,U.center(R)),G(i),le(),A&&ke())}}),Object.defineProperty(R,"flatten",{get:function(){return s},set:function(ae){s!=ae&&(s=ae,G(i),le())}}),Object.defineProperty(R,"dragOrder",{get:function(){return A},set:function(ae){ae?ke():(te(),R.stage&&R.stage.update())}}),_!==!1&&t.styleTransforms(this,X),this.dispose=function(ae){return A&&te(),R.items=null,R.currentItems=null,ae||this.zimContainer_dispose(!0),!0},this.clone=function(){return R.cloneProps(new t.Pack(e,r,t.copy(i,!0),l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,t.copy(R.order),this.style,this.group))}},t.extend(t.Pack,t.Container,["dispose","clone"],"zimContainer",!1),t.Beads=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A){var T="path, obj, count, angle, startPercent, endPercent, percents, onTop, showControls, visible, interactive, clone, group, style, inherit",h;if(h=st(t.Beads,arguments,T,this))return h;De("66.7"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Beads",this.group=b;var w=E===!1?{}:t.getStyle(this.type,this.group,A);n(c)&&(c=w.onTop!=null?w.onTop:!1),n(x)&&(x=w.showControls!=null?w.showControls:!1),n(k)&&(k=w.visible!=null?w.visible:!0),n(v)&&(v=w.interactive!=null?w.interactive:!0),n(e)&&(e=w.path!=null?w.path:new t.Blob({color:null,borderWidth:3,borderColor:t.blue})),e.visible=k,e.interactive=v,e.toggle(x),e.onTop=c,n(r)&&(r=w.obj!=null?w.obj:new t.Circle(10)),n(i)&&(i=w.count!=null?w.count:10),n(l)&&(l=w.angle!=null?w.angle:null),n(a)&&(a=w.startPercent!=null?w.startPercent:0),n(s)&&(s=w.endPercent!=null?w.endPercent:100),n(f)&&(f=w.percents!=null?w.percents:null);var P=s;s<a&&(P=100+s);var y;if(n(f)){var C;e.type=="Squiggle"?C=(P-a)/(i-1):C=(P-a)/(i-(a!=P%100?1:0)),f=[];var O=a-C;for(y=0;y<i;y++)f.push(O+C),O+=C,O>100&&(O-=100)}n(g)&&(g=w.clone!=null?w.clone:!0);var _=this;_.count=i,_.percents=f,_.items=[];var Y;for(y=0;y<i;y++)Y=t.Pick.choose(r),g&&y!=0&&(Y=Y.clone()),Y.beadNum=y,Y.startPercent=f[y],_.items.push(Y);_.path=e.addTo(_),_.beads=new t.Container().addTo(_,c?0:null),_.beads.type="BeadsContainer",this.resize=function(){for(var m=e.segmentRatios,$=e.segmentPoints,I=0;I<_.count;I++){var X=e.getCurvePoint(Math.max(0,Math.min(.9999,f[I]/100)),m,$,!0);if(X){var R=_.beads.globalToLocal(X.x,X.y);R&&_.items[I].loc(R,null,_.beads).rot(n(l)?X.angle>180?X.angle-360+e.rotation:X.angle+e.rotation:l)}}return this},_.resize(),v&&(e.on("pressmove",_.resize),e.on("update",_.resize)),E!==!1&&t.styleTransforms(this,w),this.dispose=function(m){return m||this.zimContainer_dispose(!0),_.items=[],!0},this.clone=function(m){if(m)for(var $=[],I=0;I<_.items.length;I++)$.push(_.items[I].clone(!0));return _.cloneProps(new t.Beads(e.clone(),m?t.series($):r.clone?r.clone():r,_.count,l,a,s,f,c,x,k,v,g,this.style,this.group))}},t.extend(t.Beads,t.Container,["clone","dispose"],"zimContainer",!1),t.Layout=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="holder, regions, lastMargin, lastMarginMin, backgroundColor, vertical, showRegions, scalingObject, hideKey, style, group, inherit",E;if(E=st(t.Layout,arguments,b,this))return E;De("80"),this.cjsEventDispatcher_constructor(),this.type="Layout",this.group=v;var A=k===!1?{}:t.getStyle(this.type,this.group,g);if(n(e)&&(e=A.holder!=null?A.holder:null),n(c)&&(c=A.scalingObject!=null?A.scalingObject:null),n(e)||!e.getBounds){Wn("zim controls - Layout(): please provide an object with bounds set that holds the objects being laid out");return}if(c=n(c)?e:c,!c.getBounds||!c.getBounds()){Wn("zim controls - Layout(): holder must have bounds set or provide a scalingObject with bounds");return}var T=c.getBounds();e.setBounds(0,0,T.width,T.height),n(i)&&(i=A.lastMargin!=null?A.lastMargin:0),n(l)&&(l=A.lastMarginMin!=null?A.lastMarginMin:0),n(s)&&(s=A.vertical!=null?A.vertical:!0),n(a)&&(a=A.backgroundColor!=null?A.backgroundColor:""),n(x)&&(x=A.hideKey!=null?A.hideKey:"B"),n(f)&&(f=A.showRegions!=null?A.showRegions:null);var h;f&&(h=new t.Shape);var w=this.backing=new t.Shape,P=this;if(this.active=!0,n(r)&&(r=A.regions!=null?t.copy(A.regions):null),n(r))return;t.loop(r,function(d,u){d instanceof Ge.DisplayObject&&(r[u]={obj:d}),r[u].object&&(r[u].obj=r[u].object,delete r[u].object)}),this.regions=r;var y,C=0,O="minWidth",_="width",Y="height",m="marginLeft",$="marginMinLeft",I="maxHeight";s&&(O="minHeight",_="height",Y="width",m="marginTop",$="marginMinTop",I="maxWidth");for(var X=[],R=0,q=0;q<r.length;q++){if(y=r[q],!y.obj||!y.obj.getBounds()){tt("Layout(): each region object must have an object with setBounds() set");return}y[O]||(y[O]=0),y[_]||(y[_]=0),y.backgroundColor||(y.backgroundColor=""),y.given=0,y.maxGiven=0,y[m]=="auto"?(X[q]=!0,R++,y[$]?y[m]=y[$]:delete y[m]):y[m]&&y[$]&&y[m]<y[$]&&(y[m]=y[$]),n(y[m])&&(y[m]=1e-4),y[I]||(y[I]=100),s?(y.align||(y.align="middle"),y.valign||(q==0?y.valign="top":q==r.length-1?y.valign="bottom":y.valign="middle",r.length==1&&(y.valign="middle"))):(y.valign||(y.valign="top"),y.align||(q==0?y.align="left":q==r.length-1?y.align="right":y.align="middle",r.length==1&&(y.align="middle"))),y[_]&&(y[O]=0),C+=y[_]+y[m]}if(i=="auto"?(X[r.length]=!0,i=l||0):i&&l&&i<l&&(i=l),C+=i,C>100){tt("Layout(): cannot fit regions into 100% bounds");return}var J=100-C;Z();function Z(){var d=0,u;for(u=0;u<r.length;u++)y=r[u],y.given=0,y[_]==0&&(d+=y.obj.getBounds()[_]);for(u=0;u<r.length;u++)y=r[u],y[_]==0&&(y.given=y.obj.getBounds()[_]/d*J)}this.resize=function(){var d;if(P.active){for(T=c.getBounds(),e.setBounds(0,0,T.width,T.height),w.graphics.clear(),a!=""&&(ne(w,a),w.graphics.r(0,0,T.width,T.height)),d=0;d<r.length;d++)y=r[d],y.maxGiven=0,y.marginGiven=0;for(var u=!0,o,S,F,p,L,we,D=J;u;){for(u=!1,o=!0,d=0;d<r.length;d++)y=r[d],y.given>0&&y.maxGiven==0&&(S=y.obj.getBounds()[_],F=y.obj.getBounds()[Y],p=y.given*T[_]/100,L=y[I]*T[Y]/100,we=F/S*p,we>L&&y.obj.type!="Window"?(y.maxGiven=S/F*L*100/T[_],D-=y.maxGiven):o=!1);if(o)break;var N=0;for(d=0;d<r.length;d++)y=r[d],y[_]==0&&y.maxGiven==0&&(N+=y.obj.getBounds()[_]);for(d=0;d<r.length;d++)y=r[d],y[_]==0&&y.maxGiven==0&&(y.given=y.obj.getBounds()[_]/N*D)}var ue=!0;if(y=r[0],y.maxGiven>0?y.maxGiven<y[O]&&(y[_]=y[O],ue=!1):y.given>0&&y.given<y[O]&&(y[_]=y[O],ue=!1),y=r[r.length-1],y.maxGiven>0?y.maxGiven<y[O]&&(y[_]=y[O],ue=!1):y.given>0&&y.given<y[O]&&(y[_]=y[O],ue=!1),!ue){for(C=0,d=0;d<r.length;d++)y=r[d],C+=y[_]+y[m];if(C+=i,C>100){tt("zim display - Layout(): cannot fit regions into 100% bounds");return}J=100-C,Z(),P.resize();return}var fe=!0,V=0,z=0;for(d=0;d<r.length;d++)y=r[d],V+=y[m],y[_]>0?z+=y[_]:y.maxGiven>0?z+=y.maxGiven:y.given>0&&(z+=y.given),y[_]==0&&(fe=!1);if(fe||o){V+=i;var se=100-z-V;if(V-=i+r[0][m],se!=0&&V!=0)for(d=0;d<r.length;d++)d!=0&&(y=r[d],y.marginGiven=y[m]/V*(V+se))}if(R>0){var Oe=0,K=0;for(d=0;d<r.length;d++)y=r[d],y.marginGiven>0?K+=y.marginGiven:K+=y[m],y.marginGiven=0,Oe+=y[m]>.05?y[m]:0;var ge=(K-Oe)/R;for(d=0;d<X.length;d++)X[d]&&r[d]&&(y=r[d],y.marginGiven=(y[$]?y[$]:0)+ge)}var Q=0,ce=0,G,le,Ae;if(h&&h.graphics){var re=h.graphics;re.c()}for(d=0;d<r.length;d++)y=r[d],y.marginGiven>0?Q+=y.marginGiven*T[_]/100:Q+=y[m]*T[_]/100,y[_]>0?S=y[_]:y.maxGiven>0?S=y.maxGiven:y.given>0?S=y.given:S=0,S=S*T[_]/100,F=y[I]*T[Y]/100,ce=(T[Y]-F)/2,s?(y.obj.type=="Wrapper"&&y.obj.resize(F),y.obj.type=="Window"&&y.obj.resize(F,S),y.obj.type=="Region"&&y.obj.setBounds(F,S),G=t.fit(y.obj,ce,Q,F,S)):(y.obj.type=="Wrapper"&&y.obj.resize(S),y.obj.type=="Window"&&y.obj.resize(S,F),y.obj.type=="Region"&&y.obj.setBounds(S,F),G=t.fit(y.obj,Q,ce,S,F)),y.valign=="top"?y.obj.y=G.bY:y.valign=="bottom"&&(y.obj.y=G.bY+G.bHeight-G.height),y.align=="left"?y.obj.x=G.bX:y.align=="right"&&(y.obj.x=G.bX+G.bWidth-G.width),h&&h.graphics&&(re.s("white").ss(2).r(G.bX,G.bY,G.bWidth,G.bHeight),re.s("#ff8203").sd([20,20]).r(G.bX,G.bY,G.bWidth,G.bHeight).sd()),Ae=le=0,(Q==0||Q+S==T[_])&&(s?Ae=1:le=1),F==T[Y]&&(s?le=1:Ae=1),y.backgroundColor!=""&&(ne(w,y.backgroundColor),w.graphics.r(G.bX,G.bY,G.bWidth+le,G.bHeight+Ae)),Q+=S,y.obj.ZIMoutlineShape&&y.obj.outline()}};function ne(d,u){u.type=="GradientColor"?d.graphics.lf(u.colors,u.ratios,u.x0,u.y0,u.x1,u.y1):u.type=="RadialColor"?d.graphics.rf(u.colors,u.ratios,u.x0,u.y0,u.r0,u.x1,u.y1,u.r1):u.type=="BitmapColor"?d.graphics.bf(u.image,u.repetition,u.matrix):d.graphics.f(y.backgroundColor)}this.resize(),h&&e.addChild(h),e.addChildAt(w,0),j.addEventListener("keydown",U);function U(d){d||(d=event),h&&String.fromCharCode(d.keyCode)==x.toUpperCase()&&(P.toggle(),h.stage&&h.stage.update())}this.disable=function(){P.active=!1,j.removeEventListener("keydown",U),h&&(h.alpha=0)},this.enable=function(){P.active=!0,j.addEventListener("keydown",U),P.resize(),h&&(h.alpha=1)},this.removeShape=function(){h&&(h.graphics.clear(),h.dispose(),h=null,h=!1),j.removeEventListener("keydown",U)},this.toggled=!0,this.toggle=function(d){return d===!0?h.visible=!0:d===!1?h.visible=!1:h.visible=!h.visible,P.toggled=h.visible,P},this.addShape=function(d){P.removeShape(),h=d,j.addEventListener("keydown",U),e.addChild(h),P.resize()},k!==!1&&t.styleTransforms(this,A),c.added?c.added(B):B(c);function B(d){if(d&&d.frame&&d.frame.scaling=="full"){if(!t.globalManager){var u=t.globalManager=new t.Manager;u.frame=d.frame,u.event=d.frame.on("resize",function(){u.resize()})}t.globalManager.add(P)}}this.dispose=function(){if(P.resize=null,t.globalManager){var d=t.globalManager;d.remove(P),t.globalManager.items.length==0&&(d.frame.off("resize",d.event),d.dispose(),t.globalManager=null)}return P.backing&&P.backing.dispose(),P.backing=null,P.removeShape(),!0}},t.extend(t.Layout,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),t.Accessibility=function(e,r,i,l,a,y,f,c,x,k,v,g,b,E,A){var T="appName, tabOrder, tabIndex, cycle, decimals, frame, application, alwaysHighlight, AHTime, AHColor, AHBorderWidth, AHBorderPadding, AHAlpha, AHObject, AHObjectScale",h;if(h=st(t.Accessibility,arguments,T,this))return h;De("30.5"),this.cjsEventDispatcher_constructor(),this.type="Accessibility",n(e)&&(e="application"),n(l)&&(l=!1),n(a)&&(a=2),n(y)&&(y=j.zdf),n(f)&&(f=!t.mobile()),n(c)&&(c=!1);var w=Tt(x);if(n(x)&&(x=w=="s"?.7:700),n(k)&&(k="brown"),n(v)&&(v=3),n(g)&&(g=5),n(b)&&(b=.8),n(A)&&(A=.8),n(E)){var P=new t.Shape({style:!1});P.mouseEnabled=!1}else E.mouseEnabled&&(E.mouseEnabled=!1);if(typeof y>"u")var y=j.zdf;if(n(y)){pt&&tt("Accessibility - needs a Frame");return}var C=y.retina&&j.devicePixelRatio||1,O=this;O.cycle=l,O.decimals=a,O.alwaysHighlight=c,O.AHTime=x,O.AHColor=k,O.AHBorderWidth=v,O.AHBorderPadding=g,O.AHAlpha=b,O.AHObjectScale=A;var _=-1,Y=-1,m=[],$=[],I={RadioButtons:"option",Tabs:"tab",Pad:"key"},X,R=y.canvas.id,q=t.mobile(),J=!1,Z=null,ne=[],U,B,d,u,o,S,F,p=150,L;Object.defineProperty(this,"tabOrder",{get:function(){return _},set:function(ie){var Se;for(U&&U.removeEventListener("focus",N),B&&B.removeEventListener("focus",N),Se=0;Se<m.length;Se++)m[Se].parentElement&&(m[Se].outerHTML="");m=[];var Le,Ce;for(Se=0;Se<$.length;Se++)Le=_[Se],Le&&$[Se][0].off("mousedown",$[Se][1]);$=[],_=[];var ee=[];L=y.shim?document.body:y.canvas,ae=!1;var Me=0;for(Se=0;Se<ie.length;Se++){if(Le=ie[Se],Le.type=="HotSpots"&&(ie.splice.apply(ie,[Se,1].concat(Le.hotSpots)),Le=Le.hotSpots[0]),Le.type=="HotSpot"&&(Le=Le.spot),Le.constructor=={}.constructor){if(Ce=Le.obj,!Ce||!Ce.getStage)continue;Le.title||(Le.title=Q(Ce,Se+Me))}else Ce=Le,Le={obj:Le,title:Q(Le,Se+Me)};if(Ce.type=="RadioButtons"||Ce.type=="Tabs"||Ce.type=="Pad"){var _e=[];Me--;for(var Ye=0;Ye<Ce.buttons.length;Ye++){Me++;var je=Ce.buttons[Ye],it={obj:je,title:Le.title+" - "+I[Ce.type]+": "+(je.text=="a"||je.text=="A"?"eh":je.text)};_e.push(it),je.zimTabParent=Ce,je.zimTabParent.zimAccessibility=O,je.zimTabIndex=Se+Me,je.tabIndex=Ye,je.zimAccessibility=O,ce(it),L=G(R+"Tab"+(Se+Me),it.title,L,it),$.push([je,je.on("mousedown",ge)]),J||ne.push([je,je.on("mousedown",D)])}ee=ee.concat(_e)}else Ce.zimTabIndex=Se+Me,Ce.zimTabParent=Ce,ce(Le),Ce.zimAccessibility=O,$.push([Ce,Ce.on("mousedown",ge)]),J||ne.push([Ce,Ce.on("mousedown",D)]),ee.push(Le),L=G(R+"Tab"+(Se+Me),Le.title,L,Le)}U=O.startAppTag=G(R+"PrefixTab",e+" start",y.shim?document.body:y.canvas,null,"before"),U.addEventListener("focus",N),J||(U.addEventListener("focus",se),u=G(R+"noAriaTab","",U,null,"before"),u.setAttribute("aria-hidden",!0),u.focusTab=U,u.addEventListener("focus",z),S=G(R+"noAriaTab","",U),S.setAttribute("aria-hidden",!0),S.focusTab=U,S.addEventListener("focus",z)),L=G(R+"BufferTab","",L),q&&L.setAttribute("aria-hidden",!0),L=B=O.endAppTag=G(R+"SuffixTab",e+" end",L),B.addEventListener("focus",N),J||(B.addEventListener("focus",se),L=o=G(R+"noAriaTab","",B),o.setAttribute("aria-hidden",!0),o.focusTab=B,o.addEventListener("focus",z),F=G(R+"noAriaTab","",B,null,"before"),F.setAttribute("aria-hidden",!0),F.focusTab=B,F.addEventListener("focus",z)),_=ee}});function we(){U&&(U.removeEventListener("focus",N),U.removeEventListener("focus",se),U.parentNode&&(U.outerHTML="")),u&&(u.removeEventListener("focus",z),u.parentNode&&(u.outerHTML="")),S&&(S.removeEventListener("focus",z),S.parentNode&&(S.outerHTML="")),L&&L.parentNode&&(L.outerHTML=""),B&&(B.removeEventListener("focus",N),B.removeEventListener("focus",se),B.parentNode&&(B.outerHTML="")),o&&(o.removeEventListener("focus",z),o.parentNode&&(o.outerHTML="")),F&&(F.removeEventListener("focus",z),F.parentNode&&(F.outerHTML=""))}Object.defineProperty(this,"tabIndex",{get:function(){return Y},set:function(ie){if(!Ee)return;if(ie<0||ie>=_.length)Be();else{ie!=Y&&it();var Se=_[ie].obj;if(Se.stage){if(Y=ie,Se.focus=!0,le=!0,Ae=!1,O.changeTitle(Se),Se.zimTabTag.focus(),setTimeout(function(){Se.zimTabTag.focus();var qe=new Ge.Event("change");qe.title=Se.zimTabTag.getAttribute("aria-label"),O.dispatchEvent(qe)},p),O.alwaysHighlight&&(!Z||!q)){if(O.AHObject){X=O.AHObject;var je=t.boundsToGlobal(Se);O.AHObject.alp(O.AHAlpha).addTo(y.stage,null,!1),O.AHObject.fit(je.x,je.y,je.width,je.height),O.AHObject.sca(O.AHObject.scaleX*O.AHObjectScale),O.AHTime>0&&(pe=setTimeout(function(){y.stage.removeChild(O.AHObject),y.stage.update()},O.AHTime*(w=="s"?1e3:1)))}else{X=P;var Le=Se.getBounds(),Ce=Se.localToGlobal(Le.x-5,Le.y-5),ee=Se.localToGlobal(Le.x+Le.width+5,Le.y-5),Me=Se.localToGlobal(Le.x+Le.width+5,Le.y+Le.height+5),_e=Se.localToGlobal(Le.x-5,Le.y+Le.height+5),Ye=P.graphics;Ye.clear(),Ye.s(O.AHColor).ss(O.AHBorderWidth).mt(Ce.x-O.AHBorderPadding,Ce.y-O.AHBorderPadding).lt(ee.x+O.AHBorderPadding,ee.y-O.AHBorderPadding).lt(Me.x+O.AHBorderPadding,Me.y+O.AHBorderPadding).lt(_e.x-O.AHBorderPadding,_e.y+O.AHBorderPadding).lt(Ce.x-O.AHBorderPadding,Ce.y-O.AHBorderPadding).cp(),P.alpha=O.AHAlpha,O.AHTime>0&&(pe=setTimeout(function(){y.stage.removeChild(P),y.stage.update()},O.AHTime*(w=="s"?1e3:1)))}y.stage.addChild(X),y.stage.update()}}else Be()}function it(){if(Y&&Y>-1)_&&_[Y]&&(_[Y].obj.focus=!1);else for(var qe=0;qe<_.length;qe++)_[qe].obj.focus=!1}function Be(){it(),le=!1,O.AHObject&&y.stage.removeChild(O.AHObject),O.alwaysHighlightShape&&y.stage.removeChild(O.alwaysHighlightShape),y.stage.update(),Y=-1}}}),Object.defineProperty(this,"aria",{get:function(){return Z},set:function(ie){Z=ie,Z&&ue()}});function D(ie){var Se=ie.currentTarget,Le=Se.boundsToGlobal(),Ce=Le.x+Le.width/2,ee=Le.y+Le.height/2,Me=5;ie.stageX/t.scaX<Ce-Me||ie.stageX/t.scaX>Ce+Me||ie.stageY/t.scaY<ee-Me||ie.stageY/t.scaY>ee+Me?fe():ue()}function N(){d&&(d.innerHTML="")}q=="android"&&(t.ACTIONEVENT="click",Et||(j.ACTIONEVENT="click"));function ue(){Z=!0,Oe(),d&&d.setAttribute("aria-hidden",!1),t.ACTIONEVENT="click",Et||(j.ACTIONEVENT="click"),y.stage.removeChild(X),q&&(O.alwaysHighlight=!1),y.stage.update();for(var ie,Se,Le,Ce=0;Ce<_.length;Ce++)ie=_[Ce],Se=ie.obj,Le=Se.zimTabTag,Le.disabled=!1,ie.title=ie.title.replace(/\s\(use arrow keys\)/,""),Le.setAttribute("aria-label",ie.title),Le.addEventListener("focus",V)}function fe(){Z=!1;for(var ie,Se,Le,Ce=0;Ce<_.length;Ce++)ie=_[Ce],Se=ie.obj,Le=Se.zimTabTag,Le.disabled=!1;Oe(),c&&K()}function V(ie){var Se=ie.currentTarget,Le=Se.zimObject;Y=Le.zimTabIndex,Le.focus=!0;var Ce=new Ge.Event("change");Ce.title=Se.getAttribute("aria-label"),O.dispatchEvent(Ce)}function z(ie){Z=!1,ie.target.focusTab.focus()}function se(){n(Z)||Z?ue():fe()}function Oe(){J=!0,U.removeEventListener("focus",se),B.removeEventListener("focus",se),u.removeEventListener("focus",z),o.removeEventListener("focus",z),u.parentNode&&(u.parentNode.removeChild(u),o.parentNode.removeChild(o)),S.removeEventListener("focus",z),F.removeEventListener("focus",z),S.parentNode&&(S.parentNode.removeChild(S),F.parentNode.removeChild(F));for(var ie=0;ie<ne.length;ie++)ne[ie][0].off("mousedown",ne[ie][1])}function K(){for(var ie=0;ie<m.length;ie++){var Se=m[ie];Se.zimObject&&(Se.zimObject.type=="Loader"||Se.zimObject.type=="TextArea"||Se.zimObject.type=="Tag")||(m[ie].style.left="-2000px")}}n(r)?setTimeout(function(){if(_==-1){_=[];var ie=[];t.loop(y.stage,function(Se){Se.type&&ie.push(Se)}),O.tabOrder=ie,n(i)||(O.tabIndex=i)}},50):(_=[],O.tabOrder=r,n(i)||(O.tabIndex=i));function ge(ie){var Se=ie.currentTarget;if(Se.type=="RadioButton"||Se.type=="TabsButton"||Se.type=="PadButton")for(var Le=0;Le<Se.zimTabParent.buttons.length;Le++){var Ce=Se.zimTabParent.buttons[Le];Ce.zimTabTag.setAttribute("aria-label",Ce.zimTabTag.getAttribute("aria-label").split(" - currently")[0]+(Se.zimTabParent.selectedIndex==Ce.tabIndex?" - currently selected.":" - currently not selected."))}O.tabIndex=ie.currentTarget.zimTabIndex,O.activatedObject=Se}function Q(ie){return ie.talk?ie.talk:ie.type=="TextArea"||ie.type=="RadioButtons"||ie.type=="Tabs"||ie.type=="Pad"?ie.type:ie.type=="Waiter"?"Waiter active - please wait":ie.text?ie.type+" - "+(ie.text=="a"||ie.text=="A"?"eh":ie.text):ie.type+(ie.type=="Dial"||ie.type=="Slider"||ie.type=="ColorPicker"||ie.type=="Stepper"?" (use arrow keys)":"")+(ie.type=="TextArea"?" (press ENTER to edit)":"")}function ce(ie){var Se=ie.obj;ie.title=ie.title.replace(/\.$/,""),Se.type=="RadioButton"||Se.type=="TabsButton"||Se.type=="PadButton"?ie.title=ie.title+(Se.tabIndex==Se.zimTabParent.selectedIndex?" - currently selected":" - currently not selected"):Se.type=="CheckBox"?ie.title=ie.title+(Se.checked?" - currently checked":" - currently not checked"):Se.type=="Stepper"?ie.title=ie.title+" - currently displaying "+Se.currentValue:Se.type=="Slider"||Se.type=="Dial"?ie.title=ie.title+" - currently at "+t.decimals(Se.currentValue,O.decimals):Se.type=="ColorPicker"?ie.title=ie.title+" - currently at "+Se.selectedColor:Se.type=="TextArea"?ie.title=ie.title+(Se.tag.value!=""?"":" - placeholder: "+Se.tag.placeholder):Se.type=="Indicator"?ie.title=ie.title+" - currently "+(Se.selectedIndex>=0?"at "+(Se.selectedIndex+1)+" of "+Se.num:"not indicating"):Se.type=="TextInput"&&(ie.title=ie.title+(Se.htmlTag.value!=""?"":" - placeholder: "+Se.htmlTag.placeholder)),ie.title+="."}function G(ie,Se,Le,Ce,ee){var Me,_e;if(Ce&&(Me=Ce.obj),Ce&&(Me.type=="TextArea"||Me.type=="Loader"))return _e=Me.tag,_e.setAttribute("aria-label",Se),Me&&_e.setAttribute("aria-hidden",!Me.stage),ee=="before"?Le.parentNode.insertBefore(_e,Le):Le.parentNode.insertBefore(_e,Le.nextSibling),Me.type=="TextArea"?_e.style.zIndex=3:_e.style.zIndex=-5,_e.zimObject=Me,Ce.obj.zimTabTag=_e,m.push(_e),_e;if(Ce&&Me.type=="TextInput")return _e=Me.htmlTag,_e.setAttribute("aria-label",Se),Me&&_e.setAttribute("aria-hidden",!Me.stage),ee=="before"?Le.parentNode.insertBefore(_e,Le):Le.parentNode.insertBefore(_e,Le.nextSibling),_e.style.zIndex=-5,_e.zimObject=Me,Ce.obj.zimTabTag=_e,m.push(_e),_e;var Ye;if(Ce&&(Me.type=="Dial"||Me.type=="Slider"||Me.type=="Stepper"||Me.type=="ColorPicker")){var je=[];if(Me.type=="Dial"||Me.type=="Slider"){var it=Me.step<=0?(Me.max-Me.min)/20:Me.step;for(Ye=Me.min;Ye<Me.max;Ye=Ye+it)je.push(Me.min+Ye)}else Me.type=="Stepper"?je=Me.stepperArray:Me.type=="ColorPicker"&&(je=Me.colors);_e=document.createElement("select"),_e.disabled=!0,_e.zimObject=Me,_e.addEventListener("change",function(ve){!Z&&!q=="android"||(ve.currentTarget.zimObject.zimTabParent.currentValueEvent=ve.target.value,y.stage.update())}),_e.size=1;var Be,qe;for(Ye=0;Ye<je.length;Ye++)Be=je[Ye],qe=document.createElement("option"),qe.setAttribute("aria-label",Be),qe.innerHTML=Be,_e.add(qe),Be==Me.zimTabParent.currentValue&&qe.setAttribute("selected","selected");_e.setAttribute("role","button")}else _e=document.createElement("div"),Me&&(_e.zimObject=Me),_e.innerHTML="tag",_e.setAttribute("role",f?"application":"button"),q=="android"&&_e.addEventListener("click",function(){Me.dispatchEvent("click")});if(_e.setAttribute("id",ie),_e.setAttribute("tabindex",0),_e.setAttribute("aria-label",Se),Me&&_e.setAttribute("aria-hidden",!Me.stage),ee=="before"?Le.parentNode.insertBefore(_e,Le):Le.parentNode.insertBefore(_e,Le.nextSibling),_e.style.position="absolute",Ce){Me=Ce.obj;var et=Me.boundsToGlobal();y.retina?(_e.style.left=y.x+et.x*y.scale/C+"px",_e.style.top=y.y+et.y*y.scale/C+"px",_e.style.width=et.width*y.scale/C+"px",_e.style.height=et.height*y.scale/C+"px"):(_e.style.left=y.x+et.x*y.scale+"px",_e.style.top=y.y+et.y*y.scale+"px",_e.style.width=et.width*y.scale+"px",_e.style.height=et.height*y.scale+"px"),Ce.obj.zimTabTag=_e}else _e.style.left="-1000px",_e.style.top=y.y+"px";return _e.style.overflow="hidden",_e.style.zIndex=-5,_e.style.fontSize="20px",_e.style.color="rgba(0,0,0,.01)",m.push(_e),_e}var le=!1,Ae=!0,re=y.on("keydown",function(ie){if(ie.keyCode==9&&(xe()||(le=!1,O.tabIndex!=-1&&(O.tabIndex=-1)),le?te(ie):ke(ie)),le&&_.length>0&&O.tabIndex>=0&&ie.keyCode==13){var Se=_[O.tabIndex],Le=Se.obj;if(Se&&Le.stage){var Ce=new Ge.Event("mousedown"),ee=new Ge.Event("click");Ce.fromEnter=ee.fromEnter=!0,Le.type=="Pane"?(Le.backdrop.dispatchEvent(Ce),Le.backdrop.dispatchEvent(ee)):(Le.dispatchEvent(Ce),Le.dispatchEvent(ee))}}});function xe(){for(var ie=!1,Se=0;Se<m.length;Se++)if(document.activeElement==m[Se]){ie=!0;break}return!!(document.activeElement==y.canvas||ie)}function ke(ie){!y.shiftKey&&(Cn(R+"PrefixTab")==document.activeElement||y.canvas==document.activeElement)?(_.length>0&&(_[_.length-1].obj.focus=!0),Ae=!0,le=!0,te(ie)):y.shiftKey&&(Cn(R+"SuffixTab")==document.activeElement||Cn(R+"BufferTab")==document.activeElement)&&(_.length>0&&(_[0].obj.focus=!0),Ae=!0,le=!0,te(ie))}function te(ie){if(ie.ctrlKey){he(ie.shiftKey?-1:1);return}ie.shiftKey?O.tab(-1):O.tab(1),ie.preventDefault()}var pe;this.tab=function(ie){if(clearTimeout(pe),X&&y.stage.removeChild(X),n(ie)&&(ie=1),_.length==0){he(ie);return}for(var Se=0;Se<_.length;Se++){var Le=_[Se].obj;if(Le.focus){Le.focus=!1;var Ce=Se+ie,ee=(Ce+_.length*1e4)%_.length,Me=_[ee];Le=Me.obj;for(var _e=0,Ye=!1;!(Le.stage&&(!Le.zimTabParent&&(n(Le.enabled)||Le.enabled)||Le.zimTabParent&&(n(Le.zimTabParent.enabled)||Le.zimTabParent.enabled)));)if(_e++,Ce=Ce+ie,ee=(Ce+_.length*100)%_.length,Me=_[ee],Le=Me.obj,_e==_.length){Ye=!0;break}if(Ye||!O.cycle&&Ce!=ee&&!Ae){he(ie);return}Ae=!1,O.tabIndex=ee;break}}};function he(ie){le=!1,Cn(R+(ie==1?"SuffixTab":"PrefixTab")).focus(),y.stage.removeChild(E),y.stage.update(),O.tabIndex=-1}this.changeTitle=function(ie,Se,Le){if(typeof ie!="number"&&(ie=ie.zimTabIndex),!n(ie)){if(Le&&n(Se)){O.tabIndex=ie;return}var Ce=_[ie],ee=Ce.obj;n(Se)&&(Se=ee.zimTabTag.getAttribute("aria-label").split(" - currently")[0]),Ce.title=Se,ce(Ce),ee.zimTabTag.setAttribute("aria-label",Ce.title),Le&&(O.tabIndex=ie)}};var ae=!1;this.talk=function(ie){ae||(d=G(R+"TalkTab","",B),d.setAttribute("role","alert"),ae=!0),d.removeAttribute("role"),d.setAttribute("aria-label",ie),d.setAttribute("role","alert");var Se=new Ge.Event("change");Se.title=ie,O.dispatchEvent(Se)},this.resize=function(ie){if(n(ie))for(var Ce=0;Ce<_.length;Ce++)ee(_[Ce].obj);else{if(typeof ie!="number"&&(ie=ie.zimTabIndex),ie<0)return;var Se=_[ie],Le=Se.obj;!Le.stage&&X&&Le==O.currentObject&&(y.stage.removeChild(X),y.stage.update()),ee(Le)}function ee(Me){if(Me.type=="TextArea"||Me.type=="Loader"){Me.resize();return}else{var _e=Me.boundsToGlobal(),Ye=Me.zimTabTag;y.retina?(Ye.style.left=y.x+_e.x*y.scale/C+"px",Ye.style.top=y.y+_e.y*y.scale/C+"px",Ye.style.width=_e.width*y.scale/C+"px",Ye.style.height=_e.height*y.scale/C+"px"):(Ye.style.left=y.x+_e.x*y.scale/C/C+"px",Ye.style.top=y.y+_e.y*y.scale/C/C+"px",Ye.style.width=_e.width*y.scale/C/C+"px",Ye.style.height=_e.height*y.scale/C/C+"px")}Ye.setAttribute("aria-hidden",!Me.stage),Ye.hidden=!Me.stage}},Object.defineProperty(this,"currentObject",{get:function(){return _[Y]&&_[Y].obj?_[Y].obj:null},set:function(ie){for(var Se=0;Se<_.length;Se++)if(_[Se].obj==ie){O.tabIndex=Se;break}}});var Ee=!0;Object.defineProperty(this,"enabled",{get:function(){return Ee},set:function(ie){Ee=ie}}),this.dispose=function(){P&&P.graphics.clear(),O.tabOrder=[];for(var ie=0;ie<m.length;ie++)m[ie].parentElement&&(m[ie].outerHTML="");we(),O.removeAllEventListeners(),y.off("keydown",re)}},t.extend(t.Accessibility,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),t.TextureActive=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T){var h="width, height, color, color2, angle, borderColor, borderWidth, corner, interactive, animated, backingOrbit, pattern, scalePattern, style, group, inherit",w;if(w=st(t.TextureActive,arguments,h,this))return w;De("35.2"),this.group=A;var P=E===!1?{}:t.getStyle("TextureActive",this.group,T);n(e)&&(e=P.width!=null?P.width:j.zdf.width),n(r)&&(r=P.height!=null?P.height:j.zdf.height),n(x)&&(x=P.interactive!=null?P.interactive:!0),n(k)&&(k=P.animated!=null?P.animated:!0),n(i)&&(i=P.color!=null?P.color:null),n(l)&&(l=P.color2!=null?P.color2:null),n(a)&&(a=P.angle!=null?P.angle:null),n(s)&&(s=P.borderColor!=null?P.borderColor:null),n(f)&&(f=P.borderWidth!=null?P.borderWidth:null),s<0||f<0?s=f=null:s!=null&&f==null&&(f=1),n(c)&&(c=P.corner!=null?P.corner:10),n(v)&&(v=P.backingOrbit!=null?P.backingOrbit:!0),n(g)&&(g=P.pattern!=null?P.pattern:null),n(b)&&(b=P.scalePattern!=null?P.scalePattern:null),this.zimPage_constructor(e,r,i,l,a,g,b,null,E,A,T),this.type="TextureActive",c&&(this.backing.corner=c),n(f)||(this.backing.borderWidth=f),n(s)||(this.backing.borderColor=s),(f||!n(s))&&(this.backing.siz(this.width-f,this.height-f),this.backing.center()),this.backing.mouseChildren=!1,this.interactive=x,this.animated=k,this.backingOrbit=v,E!==!1&&t.styleTransforms(this,P),this.clone=function(){return this.cloneProps(new t.TextureActive(e,r,i,l,a,s,f,c,x,k,v,g,b,E,this.group,T))}},t.extend(t.TextureActive,t.Page,["clone"],"zimPage",!1),t.TextureActive.makeLogo=function(e,r){n(e)&&(e="light");var i=e!="dark",l=i?t.light:t.dark,a=i?t.dark:t.light,s=i?t.white:t.black,f=i?t.black:t.white,c=new t.Container(400,100),x=j.zdf.makeIcon(l,a,[l,l,l,l,l]).ske(0,30).scaleTo(c,100,100).center(c),k=new t.Rectangle((400-x.width)/2+4,80-10,new t.GradientColor([i?l:s,i?s:l,i?l:s],-70),f,.5).addTo(c),v=k.clone().pos(0,0,"right","bottom",c);return new t.Label({text:"Texture",size:50,color:a,variant:!0}).scaleTo(k,75,75).center(k),new t.Label({text:"Active",size:50,color:a,variant:!0}).scaleTo(k,72,72).center(v),r?c:c.noMouse()},t.TextureActive.makeBacking=function(e,r,i,l){n(e)&&(e=800),n(r)&&(r=600),n(i)&&(i="CANVAS WINDOW"),n(l)&&(l=t.light);var a=new t.Container(e,r);return a.icon=j.zdf.makeIcon({box:black}).sca(2),a.label=new t.Label({text:i,size:25,color:l,align:"center"}).reg("center"),a.tile=new t.Tile({obj:[a.icon,a.label],rows:2,spacingV:24,unique:!0,align:CENTER}).scaleTo(a,50,70).center(a),a.tile.items[1].mov(0,10),a},t.TextureActives=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w){var P="actives, threejs, zimThree, renderer, scene, camera, controls, layers, near, far, ignoreList, toggleKey, color, outerColor, damp, style, group, inherit",y;if(y=st(t.TextureActives,arguments,P,this))return y;De("35.4"),this.group=h;var C=T===!1?{}:t.getStyle("TextureActives",this.group,w),O,_,Y="ZIM TextureActives - need a ZIM Frame";if(n(e)&&n(e[0]))if(j.zdf)_=j.zdf,O=j.zdf.stage;else{tt(Y);return}else if(n(e)||n(e[0])||n(e[0].stage))if(j.zdf)_=j.zdf,O=j.zdf.stage;else{tt(Y);return}else O=e[0].stage,_=O.frame;n(e)&&(e=C.actives!=null?C.actives:null),n(r)&&(r=C.threejs!=null?C.threejs:null),n(i)&&(i=C.zimThree!=null?C.zimThree:null),n(l)&&(l=C.renderer!=null?C.renderer:null),n(a)&&(a=C.scene!=null?C.scene:null),n(s)&&(s=C.camera!=null?C.camera:null),n(f)&&(f=C.controls!=null?C.controls:null),n(c)&&(c=C.layers!=null?C.layers:[]),Array.isArray(c)||(c=[c]),n(x)&&(x=C.near!=null?C.near:void 0),n(k)&&(k=C.far!=null?C.far:void 0),n(v)&&(v=C.ignoreList!=null?C.ignoreList:[]),Array.isArray(v)||(v=[v]),n(g)&&(g=C.toggleKey!=null?C.toggleKey:"t"),n(b)&&(b=C.color!=null?C.color:t.darker),n(E)&&(E=C.outerColor!=null?C.outerColor:"black"),n(A)&&(A=C.damp!=null?C.damp:null);var m=this;t.TAM||(t.TAM=new t.TextureActivesManager(O,g,A),l&&l.domElement&&l.domElement.addEventListener("mousedown",R=>{R.preventDefault()})),m.manager=t.TAM,this.ignoreList=v,this.raycast=!0,this.renderer=l,this.layers=c,this.animated=!1,this.interactive=!1,this.actives=[],this.threeMeshes=[];var $=!1;function I(R){n(R)&&(R=[]),Array.isArray(R)||(R=[R]);var q=0,J,Z;return t.loop(R,function(ne){m.actives.indexOf(ne)<0&&(m.actives.push(ne),ne.cache(),ne.canvas.content=ne,ne.interactive&&(J=!0,ne.canvas.isTextureActive=!0),ne.animated&&(Z=!0),q++)}),J&&!m.interactive&&(m.interactive=!0,q>0&&X()),Z&&!m.animated&&(m.animated=!0),q}I(e),t.TAM.updateTile(m,m.actives),t.TAM.color=b,t.TAM.outerColor=E,_.canvas.style.display="none";function X(){if($)return;$=!0,m.pointerCheck||(m.pointerCheck=t.TAM.addPointer(m)),m.pointerData={x:_.mouseX,y:_.mouseY,mousedown:!1};var R=window.innerWidth,q=window.innerHeight,J=-1,Z=-2,ne=-1,U=-2;m.overInterval=t.interval(.05,function(){if(Z&&Z!=J||U&&U!=ne){var Q=new Ge.Event("rayover");Q.mesh=m.mesh=Z,Q.material=m.material=U,U.userData&&(Q.textureActive=m.textureActive=U.userData.ta_content),Q.intersect=m.intersect,m.dispatchEvent(Q),f&&!f.screenSpacePanning&&(f.activeLook=!1)}else if(!Z&&J||!U&&ne){var Q=new Ge.Event("rayout");Q.mesh=J,Q.material=ne,ne.userData&&(Q.textureActive=ne.userData.ta_content),Q.intersect=m.intersect,m.dispatchEvent(Q),f&&!f.screenSpacePanning&&(f.activeLook=!0)}J=Z,ne=U});var B=m.raycaster=new r.Raycaster(void 0,void 0,x,k);c.length>0&&t.loop(c,function(Q){B.layers.set(Q)});var d,u;m.XR=j.XR=!1;var o=new r.Matrix4;let S=m.controllerLeft=l.xr.getController(0);S.addEventListener("selectstart",p),S.addEventListener("selectend",L),S.addEventListener("move",we);let F=m.controllerRight=l.xr.getController(1);F.addEventListener("selectstart",D),F.addEventListener("selectend",N),F.addEventListener("move",ue);function p(Q){u=!0,V(Q)}function L(Q){u=!0,se(Q)}function we(Q){u=!0,K(Q,"left")}function D(Q){u=!0,V(Q)}function N(Q){u=!0,se(Q)}function ue(Q){u=!0,K(Q,"right")}window.addEventListener("pointerdown",fe);function fe(Q){u=!1,V(Q)}function V(Q){if(m.raycast){if(u){var ce=Q.target;o.identity().extractRotation(ce.matrixWorld),B.ray.origin.setFromMatrixPosition(ce.matrixWorld),B.ray.direction.set(0,0,-1).applyMatrix4(o),Q.data&&Q.data.handedness=="left"?Q.pointerId=2:Q.pointerId=1}else{var G;!i||i.resizeEvent?G={x:Q.clientX/window.innerWidth*2-1,y:1-Q.clientY/window.innerHeight*2}:G={x:Q.clientX/R*2-1,y:1-Q.clientY/q*2},B.setFromCamera(G,s)}var le=B.intersectObjects(a.children);d=null;var Ae,re,xe;for(re=0;re<le.length;re++)if(Ae=le[re].object,!(m.ignoreList.indexOf(Ae)>-1)){if(m.threeMeshes.indexOf(Ae)>-1)if(Ae.material&&Array.isArray(Ae.material))xe=Ae.material[le[re].face.materialIndex];else if(Ae.material)xe=Ae.material;else break;if(xe&&xe.map&&xe.map.source&&xe.map.source.data&&xe.map.source.data.isTextureActive&&xe.userData.ta_content){d=Ae;var ke=xe.userData.ta_content;if(m.pointerData.mousedown=!0,ge(ke,le[re],xe.userData.ta_flipped),Ge.handleRemotePointer(m.pointerData.x,m.pointerData.y,"down",Q,O,Q.pointerId),f&&f.maxAzimuthAngle&&ke)if(ke.backingOrbit){var te=ke.globalToLocal(_.mouseX,_.mouseY),pe=ke.backing;pe&&ke.getObjectUnderPoint(te.x,te.y,1)!=pe?f.enableRotate=!1:f.enableRotate=!0}else f.enableRotate=!1;var he=new Ge.Event("raydown");he.mesh=m.mesh=Ae,he.material=m.material=xe,he.textureActive=m.textureActive=ke,he.intersect=m.intersect=le[re],m.dispatchEvent(he);break}else break}}}window.addEventListener("pointerup",z);function z(Q){u=!1,se(Q)}function se(Q){if(m.raycast){if(m.pointerData.mousedown=!1,f&&f.maxAzimuthAngle&&(f.enableRotate=!0),d){var ce=new Ge.Event("rayup");ce.mesh=m.mesh,ce.material=m.material,ce.textureActive=m.textureActive,ce.intersect=m.intersect,m.dispatchEvent(ce)}d=null,u&&(Q.data&&Q.data.handedness=="left"?Q.pointerId=2:Q.pointerId=1),Ge.handleRemotePointer(null,null,"up",Q,O,Q.pointerId)}}window.addEventListener("pointermove",Oe);function Oe(Q){u=!1,K(Q)}function K(Q,ce){if(m.raycast){if(u){var G=Q.target;o.identity().extractRotation(G.matrixWorld),B.ray.origin.setFromMatrixPosition(G.matrixWorld),B.ray.direction.set(0,0,-1).applyMatrix4(o),ce=="left"?Q.pointerId=2:Q.pointerId=1}else{var le;!i||i.resizeEvent?le={x:Q.clientX/window.innerWidth*2-1,y:1-Q.clientY/window.innerHeight*2}:le={x:Q.clientX/R*2-1,y:1-Q.clientY/q*2},B.setFromCamera(le,s)}var Ae=!1,re,xe,ke;if(d){let ae=B.intersectObject(d);if(ae.length>0&&(re=d,re.material&&Array.isArray(re.material)?ke=re.material[ae[0].face.materialIndex]:re.material&&(ke=re.material),ke)){var te=ke.userData.ta_content;ge(te,ae[0],ke.userData.ta_flipped),Ge.handleRemotePointer(m.pointerData.x,m.pointerData.y,"move",Q,O,Q.pointerId),Ae=!0;var pe=new Ge.Event("raymove");pe.mesh=Z=m.mesh=re,pe.material=U=m.material=ke,pe.textureActive=m.textureActive=te,pe.intersect=m.intersect=ae[0],m.dispatchEvent(pe)}}else{var he=B.intersectObjects(a.children);for(xe=0;xe<he.length;xe++)if(re=he[xe].object,!(m.ignoreList.indexOf(re)>-1)){if(m.threeMeshes.indexOf(re)>-1)if(re.material&&Array.isArray(re.material))ke=re.material[he[xe].face.materialIndex];else if(re.material)ke=re.material;else break;if(ke&&ke.map&&ke.map.source&&ke.map.source.data&&ke.map.source.data.isTextureActive&&ke.userData.ta_content){var te=ke.userData.ta_content;ge(te,he[xe],ke.userData.ta_flipped),Ge.handleRemotePointer(m.pointerData.x,m.pointerData.y,"move",Q,O,Q.pointerId),Ae=!0;var pe=new Ge.Event("raymove");pe.material=U=m.material=ke,pe.mesh=Z=m.mesh=re,pe.textureActive=m.textureActive=te,pe.intersect=m.intersect=he[xe],m.dispatchEvent(pe);break}else break}}Ae||(Z=null,U=null),t.TAM.setActive(m,Ae)}}function ge(Q,ce,G){if(!(!Q||!Q.getBounds)){var le=Q.getBounds(),Ae=G?le.width-ce.uv.x*le.width:ce.uv.x*le.width,re=(1-ce.uv.y)*le.height,xe=Q.localToGlobal(Ae,re);m.pointerData.x=xe.x,m.pointerData.y=xe.y}}}this.add=function(R){var q=I(R);return q>0&&t.TAM.updateTile(m,m.actives),m},this.remove=function(R){n(R)&&(R=[]),Array.isArray(R)||(R=[R]);var q=0;return t.loop(R,function(J){if(Ge.remoteQueue){var Z=Ge.remoteQueue.indexOf(J);Z>=0&&Ge.remoteQueue.splice(Z,1)}Z=m.actives.indexOf(J),Z>=0&&(m.actives.splice(Z,1),q++),J.textureMap&&delete J.textureMap.userData.ta_content,Z=m.threeMeshes.indexOf(J),Z>=0&&m.threeMeshes.splice(Z,1),J.dispose()},!0),q>0&&t.TAM.updateTile(m,m.actives),m},m.addMesh=function(R,q){if(n(q)||R.layers.enable(q),R.material){var J=m.threeMeshes.indexOf(R);if(J<0)m.threeMeshes.push(R);else return m;var Z;Array.isArray(R.material)?Z=R.material:Z=[R.material],R.onBeforeRender=function(){R.userData.ta_viewID&&clearTimeout(R.userData.ta_viewID),R.userData.ta_viewID=setTimeout(function(){R.userData.ta_view=!1,Ge.remoteQueue&&t.loop(R.userData.ta_content,function(ne){var U=Ge.remoteQueue.indexOf(ne);U>=0&&Ge.remoteQueue.splice(U,1)},!0)},100),R.userData.ta_view||(R.userData.ta_view=!0,t.loop(R.userData.ta_content,function(ne){Ge.remoteQueue.indexOf(ne)<0&&Ge.remoteQueue.push(ne)}))},R.userData.ta_content=[],t.loop(Z,function(ne){if(ne&&ne.map&&ne.map.source&&ne.map.source.data&&ne.map.source.data.content){var U=ne.map.source.data.content;R.userData.ta_content.push(U),U.mesh=R,R.textureActive=!0,ne.userData.ta_content=U,U.textureMaps||(U.textureMaps=[]);var B=U.textureMaps.indexOf(ne.map);B<0&&U.textureMaps.push(ne.map),(U.animated||U.interactive)&&(Ge.remoteQueue||(Ge.remoteQueue=[]))}})}return m},m.dispose=function(){m.raycast=!1,f&&(f.enableRotate=!0,f.enabled=!0),m.remove(m.actives),t.TAM.remove(m),t.TAM.count<1&&(t.TAM.dispose(),t.TAM=null),m.material=m.mesh=m.content=m.intersect=null}},t.extend(t.TextureActives,Ge.EventDispatcher,"dispose"),t.TextureActivesManager=function(e,r,i){De("35.6");var l=this;this.type="TextureActivesManager",l.color=t.darker,l.outerColor="black";var a=!1;l.toggleKey=r||"t",(n(i)||i===!0)&&(i=.2);var s=l.objects=new t.Dictionary(!0),f=e.frame,c=new t.Proportion({baseMin:1e3,baseMax:9e3,targetMin:-.1,targetMax:-.05,clamp:!1});l.backing=new t.Rectangle(100,100,t.faint).addTo(e,0);var x=[];l.updateTile=function(w,P,y){y||s.add(w,P);var C=[];if(x=[],t.loop(s,function(_,Y){t.loop(Y,function(m){C.push(m),m.loop(function($){($.type=="Scrambler"||$.type=="List"||$.type=="Window")&&x.push($)})})}),C.length<0){var O=l.message=new t.Rectangle(W,H,t.yellow);new t.Label("No TextureActives Added").center(O),C.push(O)}l.tile?(l.tile.cols=C.length,l.tile.remake(C)):l.tile=new t.Tile(C,C.length,1,20,0,!0).addTo(e),l.backing.scaleTo(l.tile,100,100,"full").siz(null,e.height,!0),l.swiper&&(l.swiper.sensitivity=t.constrain(c.convert(l.tile.width),-.1,-.01))},this.addPointer=function(w){var P=[];return t.loop(s,function(y){P.indexOf(y.renderer.domElement)<0&&P.push(y.renderer.domElement)}),P.indexOf(w)<0&&P.push(w.renderer.domElement),Ge.remotePointers?Ge.remotePointers=P:Ge.addRemotePointers(e,P),!0},this.setActive=function(w,P){if(w.active=P,!P){var y=t.loop(s,function(C){if(C.active)return!1});y&&(e.mouseInBounds=!1)}};var k=!1,v=this.nav=new t.Panel({width:200,height:80,titleBar:"TextureActives",draggable:!0,close:!0}).pos(50,50,RIGHT,BOTTOM),g=this.slider=new t.Slider({min:0,max:100,damp:!0}).scaleTo(v,80);g.on("mousedown",function(){k=!0,l.swiper.enabled=!1,E()}),g.on("pressup",function(){l.swiper.immediate(g.currentValue),l.swiper.enabled=!0,A(),k=!1}),v.on("close",function(){l.hide(),v.addTo()});var b=0;this.ticker=t.Ticker.add(function(){l.tile.x=-g.currentValue*(l.tile.width-W)/100,a&&!k&&b!=0&&b!=100&&(g.currentValue==0||g.currentValue==100)&&A(),b=g.currentValue}),v.add(g,0,!0),v.removeFrom(),t.Ticker.remove(l.ticker);function E(){a||(a=!0,t.loop(x,function(w){w.enabled=!1}))}function A(){a&&(a=!1,t.loop(x,function(w){w.enabled=!0,w.update()}))}l.swiper=new t.Swiper({swipeOn:l.backing,target:g,property:"currentValue",sensitivity:l.tile?t.constrain(c.convert(tile.width),-.1,-.01):-.1,damp:i}),l.backing.on("mousedown",function(){b=-100,E()}),l.swiper.on("swipestop",A),l.toggled=!1;var T=f.color,h=f.outerColor;this.show=function(){if(!l.toggled)return f.color=l.color,f.outerColor=l.outerColor,l.toggled=!0,t.Ticker.add(l.ticker),v.addTo(),t.loop(s,function(w){w.lastRaycast=w.raycast,w.raycast=!1,w.renderer.domElement.style.display="none"}),Ge.remoteQueue&&t.loop(l.tile.items,function(w){Ge.remoteQueue.indexOf(w)<0&&Ge.remoteQueue.push(w)}),f.canvas.style.display="block",Ge.removeRemotePointers(e),this},this.hide=function(){if(l.toggled){f.color=T,f.outerColor=h,l.toggled=!1,t.Ticker.remove(l.ticker),v.removeFrom();var w=[];return t.loop(s,function(P){P.raycast=P.lastRaycast,P.renderer.domElement.style.display="block",w.push(P.renderer.domElement)}),Ge.remoteQueue&&(Ge.remoteQueue=[],t.loop(l.tile.items,function(P){P.mesh&&(P.mesh.userData.ta_view=!1)})),f.canvas.style.display="none",Ge.addRemotePointers(e,w),this}},l.toggle=function(w){return n(w)&&(w=!l.toggled),w&&!l.toggled?l.show():!w&&l.toggled&&l.hide(),this},l.keyEvent=f.on("keydown",function(w){w.key==l.toggleKey&&(l.toggled?l.hide():l.show())}),l.remove=function(w){s.remove(w),l.updateTile(null,null,!0)},l.dispose=function(){l.hide(),v.dispose(),f.off("keydown",l.keyEvent),l.backing.removeAllEventListeners(),l.backing.dispose(),l.objects.dispose(),l.tile.dispose(),l.objects=l.tile=v=null}},t.extend(t.TextureActivesManager,Ge.EventDispatcher),t.Manager=function(e){De("75");var r=this;this.type=e,this.items=[],this.add=function(a){return Array.isArray(a)?r.items=r.items.concat(a):r.items.push(a),r};var i,l;this.remove=function(a){if(r){if(!a)r.items=[];else for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--){l=a[i];var s=r.items.indexOf(l);s!=-1&&r.items.splice(s,1)}return r}},this.resize=function(a){if(r){if(a)for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--)l=a[i],!l.resize&&r.items.indexOf(l)!=-1?r.items.splice(r.items.indexOf(l),1):l.resize();else for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].resize():r.items.splice(i,1);return r}},this.toggle=function(a,s){if(r){if(s)for(Array.isArray(s)||(s=[s]),f=s.length-1;f>=0;f--)l=s[f],!l.resize&&r.items.indexOf(l)!=-1?r.items.splice(r.items.indexOf(l),1):l.toggle(a);else for(var f=r.items.length-1;f>=0;f--)r.items[f].resize?r.items[f].toggle(a):r.items.splice(f,1);return r}},this.dispose=function(a){if(r){if(r.resize=null,a)for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--)l=a[i],r.items.indexOf(l)!=-1&&r.items.splice(r.items.indexOf(l)),l.dispose&&l.dispose();else{for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].dispose():r.items.splice(i,1);r.items=null}return!0}}},t.ResizeManager=function(){De("75.5"),t.Manager.call(this,"ResizeManager")},t.ResizeManager.prototype=new t.Manager,t.ResizeManager.prototype.constructor=t.ResizeManager,t.TransformManager=function(e,r){De("75.7");var i=this;this.type="TransformManager",this.persistID=r,this.items=[];function l(s){!localStorage||s&&!s.pressup||i.savePersist(s)}this.add=function(s){var f=[];Array.isArray(s)?f=s:f=[s];for(var c,x=!1,k=0;k<f.length;k++)if(c=f[k],c.transformControls&&(c.originalVisible=c.transformControls.visible),c.toggle&&c.toggle(!1),i.items.length==0&&k==0&&(x=!0),c.type=="Blob"||c.type=="Squiggle")i.persistID||x&&(x=!1,c.controlsVisible=!0,i.currentObject=c),c.on("change",function(g){var b=new Ge.Event("transformed");b.transformObject=g.target,b.transformType=g.controlType,i.dispatchEvent(b)}),c.on("controlsshow",function(g){var b=new Ge.Event("transformshow");i.currentObject=b.transformObject=g.target,i.dispatchEvent(b)}),c.on("controlshide",function(g){var b=new Ge.Event("transformhide");b.transformObject=g.target,i.currentObject=null,i.dispatchEvent(b)}),c.on("update",function(g){var b=new Ge.Event("transformed");b.transformObject=g.target,b.transformType=g.controlType,i.dispatchEvent(b)});else if(c.type=="Connectors")i.persistID||x&&(x=!1,i.currentObject=c),c.on("connection",function(g){var b=new Ge.Event("transformed");b.transformObject=g.target,b.transformType="connection",i.dispatchEvent(b)});else if(c.type=="Pack")i.persistID||x&&(x=!1,i.currentObject=c),c.on("change",function(g){var b=new Ge.Event("transformed");b.transformObject=g.target,b.transformType="change",i.dispatchEvent(b)});else{var v=c.transformControls;i.persistID||x&&c.type!="Layer"&&(x=!1,c.originalVisible&&(v.show(),i.currentObject=c)),c.on("transformed",function(g){var b=new Ge.Event("transformed");b.transformObject=g.target,b.transformType=g.transformType,i.dispatchEvent(b)}),c.on("transformshow",function(g){var b=new Ge.Event("transformshow");i.currentObject=b.transformObject=g.target,i.dispatchEvent(b)}),c.on("transformhide",function(g){var b=new Ge.Event("transformhide");b.transformObject=g.target,i.currentObject=null,i.dispatchEvent(b)})}i.items=i.items.concat(s),i.persist&&!n(i.persistID)&&i.persist(i.persistID)},this.remove=function(s){if(n(s)){i.items=[];return}Array.isArray(s)||(s=[s]);for(var f,c=0;c<s.length;c++){f=s[c],i.currentObject==f&&(i.currentObject=null),f.transformedEvent&&(f.off("transformed",f.transformedEvent),f.transformedEvent=null),f.type=="Blob"||f.type=="Squiggle"?f.controlsVisible=!1:f.transformControls&&f.transformControls.remove();var x=i.items.indexOf(f);x!=-1&&i.items.splice(x,1)}r&&i.savePersist()},this.show=function(s){if(!n(s)){if(s.type=="Blob"||s.type=="Squiggle")s.controlsVisible||(s.controlsVisible=!0);else{var f=s.transformControls;if(!f||f.visible)return;f.show()}i.currentObject=s}},this.hide=function(s){if(!n(s))if(i.currentObject==s&&(i.currentObject=null),s.type=="Blob"||s.type=="Squiggle")s.controlsVisible&&(s.controlsVisible=!1);else{var f=s.transformControls;if(!f||f.visible)return;f.hide()}},this.hideAll=function(s){for(var f,c,x=0;x<i.items.length;x++)if(c=i.items[x],!c||!(c.transformControls||c.update))i.items.splice(x);else{if(i.items[x]==s)continue;c.type=="Blob"||c.type=="Squiggle"?c.controlsVisible&&(c.controlsVisible=!1):(f=i.items[x].transformControls,f.visible&&f.hide())}i.currentObject=null},this.resize=function(){if(i){for(var s,f=0;f<i.items.length;f++)s=i.items[f],!s||!(s.transformControls||s.update)?i.items.splice(f):s.type=="Blob"||s.type=="Squiggle"?s.update():s.transformControls.resize();r&&i.savePersist()}},n(e)||i.add(e);var a="TransformManager persist(persistID) - sorry, must provide id";this.persist=function(s){var f,c;if(n(s)&&pt){tt(a);return}i.persistID=s;var x=0;if(localStorage&&localStorage[s]){var k=i.persistData=JSON.parse(localStorage[s]);if(k.length==i.items.length)for(c=0;c<i.items.length;c++)k[c].controls&&(i.currentObject=i.items[c]),k[c]&&(k[c].type=="Blob"||k[c].type=="Squiggle")?(i.items[c].points.length!=k[c].points.length&&(i.items[c].points=k[c].points),i.items[c].setData(k[c]),i.items[c]==i.currentObject&&i.currentObject.toggle(!0),x++,x==k.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):k[c]&&k[c].type=="Connectors"?(i.items[c].setSteps(k[c].steps),i.items[c].loc(k[c].x,k[c].y),i.items[c].sca(k[c].scale),x++,x==k.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):k[c]&&k[c].type=="Pack"?(i.items[c].setOrder(k[c].order),i.items[c].outerWidth=k[c].outerWidth,i.items[c].outerHeight=k[c].outerHeight,x++,x==k.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):k[c]&&(n(i.items[c].transformControls)?-function(){var v=f=i.items[c],g=k[c];t.interval(50,function(b){v.transformControls&&(v.transformControls.setData(g),v.dispatchEvent("persistset"),x++,x==k.length&&(setTimeout(function(){v==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),b.clear()))},20,null,null,"ms")}():(i.items[c].transformControls.setData(k[c]),-function(){var v=f=i.items[c];t.interval(50,function(g){v.dispatchEvent("persistset"),x++,x==k.length&&(setTimeout(function(){v==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),g.clear())},20,null,null,"ms")}()))}for(c=0;c<i.items.length;c++)f=i.items[c],f.transformedEvent||(f.type=="Blob"||f.type=="Squiggle"?(f.transformedEvent=f.on("change",function(v){v.pressup=!0,l(v)}),f.transformedUEvent=f.on("update",function(v){v.pressup=!0,l(v)}),f.transformedSEvent=f.on("controlsshow",function(v){v.pressup=!0,l(v)}),f.transformedHEvent=f.on("controlshide",function(v){v.pressup=!0,l(v)})):f.type=="Connectors"?f.transformedEvent=f.on("connection",function(v){v.pressup=!0,l(v)}):f.type=="Pack"?f.transformedEvent=f.on("change",function(v){v.pressup=!0,l(v)}):(f.transformedEvent=f.on("transformed",l),f.transformedSEvent=f.on("transformshow",l),f.transformedHEvent=f.on("transformhide",l)))},this.savePersist=function(){for(var s=[],f=0;f<i.items.length;f++){var c=i.items[f];c.type=="Blob"||c.type=="Squiggle"?c.recordData&&s.push(c.recordData()):c.type=="Connectors"?s.push({type:c.type,x:c.x,y:c.y,scale:c.scale,steps:c.getSteps()}):c.type=="Pack"?s.push({type:c.type,outerWidth:c.outerWidth,outerHeight:c.outerHeight,order:c.getOrder()}):c.transformControls&&c.transformControls.recordData&&s.push(c.transformControls.recordData())}i.persistData=s,localStorage[i.persistID]=JSON.stringify(s)},this.clearPersist=function(s){if(n(s)&&pt){tt(a);return}i.persistData=null,localStorage&&localStorage.removeItem(s)},this.stopPersist=function(){for(var s=0;s<i.items.length;s++){var f=i.items[s];f.transformedEvent&&(f.type=="Blob"||f.type=="Squiggle"?(f.off("change",f.transformedEvent),f.off("update",f.transformedUEvent),f.off("controlsshow",f.transformedSEvent),f.off("controlshide",f.transformedHEvent)):f.type=="Connectors"?f.off("connection",f.transformedEvent):f.type=="Pack"?f.off("change",f.transformedEvent):(f.off("transformed",f.transformedEvent),f.off("transformshow",f.transformedSEvent),f.off("transformhide",f.transformedHEvent)),f.transformedEvent=null,f.transformedUEvent=null,f.transformedSEvent=null,f.transformedHEvent=null)}i.persistData=null},n(r)||i.persist(r),this.dispose=function(s,f){if(n(s)&&(s=!0),i.removeAllEventListeners(),i.persistID&&s&&i.stopPersist(),f)for(var c=0;c<i.items.length;c++){var x=i.items[c];x.type=="Blob"||x.type=="Squiggle"?x.dispose():x.transformControls.dispose()}}},t.extend(t.TransformManager,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),t.GuideManager=function(){De("77"),t.Manager.call(this,"GuideManager")},t.GuideManager.prototype=new t.Manager,t.GuideManager.prototype.constructor=t.GuideManager,t.GridManager=function(){De("79"),t.Manager.call(this,"GridManager")},t.GridManager.prototype=new t.Manager,t.GridManager.prototype.constructor=t.GridManager,t.LayoutManager=function(){De("81"),t.Manager.call(this,"LayoutManager")},t.LayoutManager.prototype=new t.Manager,t.LayoutManager.prototype.constructor=t.LayoutManager,t.SelectionSet=function(e){De("81.5"),this.type="SelectionSet",n(e)&&(e=[]),this.selections=e,this.clear=function(){this.selections=[]},this.isSelected=function(r){return this.selections.indexOf(r)>=0},this.add=function(r,i,l,a){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear();var s=this.selections.indexOf(r);if(!(s>=0)){if(this.selections.push(r),!n(l)){Array.isArray(l)||(l=[l]);for(var f=0;f<=l.length;f++)l[f].add(r,i)}if(!n(a))for(Array.isArray(a)||(a=[a]),f=0;f<=a.length;f++)a[f].remove(r,i)}}},this.remove=function(r,i,l,a){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||this.selectionManager.setCurrent(this),i||this.clear();var s=this.selections.indexOf(r);if(n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear(),i?s>=0&&this.selections.splice(s,1):this.clear(),!n(l)){Array.isArray(l)||(l=[l]);for(var f=0;f<=l.length;f++)l[f].remove(r,i)}if(!n(a))for(Array.isArray(a)||(a=[a]),f=0;f<=a.length;f++)a[f].add(r,i)}},this.toggle=function(r,i,l,a){this.isSelected(r)?this.remove(r,i,l,a):this.add(r,i,l,a)},this.dispose=function(){return this.clear(),this.selections=null,!0}},t.SelectionManager=function(e,r,i){De("81.6"),this.cjsEventDispatcher_constructor(),this.type="SelectionManager",n(e)&&(e=[]),n(i)&&(i=!0),Array.isArray(e)||(e=[e]),this.sets=e,this.multipleKey=r,this.multipleSets=i,this.multiple=!1;for(var l=this,a=0;a<e.length;a++)e[a].selectionManager=this;this.clear=function(){this.currentSet=null;for(var f=0;f<e.length;f++)e[f].clear()},this.setCurrent=function(f){this.currentSet=f;for(var c=0;c<e.length;c++)e[c]!=f&&(this.multipleSets||e[c].clear())};var s=new Ge.Event("keydown");this.eventRemove=s.remove,this.keydownEvent=function(f){f.remove=l.eventRemove,l.multipleKey&&(l.multiple=f[l.multipleKey+"Key"]),l.ctrlKey=f.ctrlKey,l.shiftKey=f.shiftKey,l.metaKey=f.metaKey,l.dispatchEvent(f),f.keyCode==90&&(l.ctrlKey||l.metaKey)&&l.dispatchEvent("undo")},j.addEventListener("keydown",this.keydownEvent),this.keyupEvent=function(f){l.multipleKey&&(l.multiple=f[l.multipleKey+"Key"]),l.ctrlKey=f.ctrlKey,l.shiftKey=f.shiftKey,l.metaKey=f.metaKey,f.remove=l.eventRemove,l.dispatchEvent(f)},j.addEventListener("keyup",this.keyupEvent),this.dispose=function(){this.clear(),j.removeEventListener("keydown",this.keydownEvent),j.removeEventListener("keyup",this.keyupEvent)}},t.extend(t.SelectionManager,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),typeof mt>"u")var mt;t.Bind=function(e,r,i,l,a,s,f,c){var x="connection, bindType, master, masterFilter, couple, smartDecimals, report, setDefault",k;if(k=st(t.Bind,arguments,x,this))return k;De("81.8"),this.type="Bind";var v=this;n(e)&&localStorage&&n(mt)&&(n(r)||r==t.LOCALSTORAGE)?(e="zimBind",r=t.LOCALSTORAGE):e&&e.match(/\/|\./)?(n(r)&&(r=t.GET),e.match(/\?/)?e+="&":e+="?"):e&&n(r)&&(r=t.LOCALSTORAGE),n(s)&&(s=!0),r==t.LOCALSTORAGE&&!localStorage&&(pt&&tt("Bind() - no localStorage"),v.error="error - no localStorage"),this.connection=e,this.bindType=r,this.master=i,this.masterFilter=l,this.smartDecimals=s,n(f)&&(f=!1),(!mt||c)&&(mt=this),Object.defineProperty(v,"default",{get:function(){return v==mt},set:function(h){!h&&mt==v?mt=null:h&&(mt=v)}}),this.bindType==t.POST&&(v.ajax=new t.Ajax),this.bindings={},this.ids=[],this.data={},this.objIDs=new t.Dictionary(!0),this.toIDs={},this.fromIDs={},this.add=function(h,w,P,y,C){if(n(P)||n(w)||n(h))return v;if(v.bindings[h]){if(v.bindings[h].obj!=w)return pt&&tt("Bind() - id can be used with only one object"),v}else{v.ids.indexOf(h)<=0&&v.ids.push(h),v.bindings[h]={obj:w,props:[]},!n(C)&&typeof C=="function"&&(v.bindings[h].filter=C);var O=v.objIDs.at(w);O?O.indexOf(h)<0&&O.push(h):v.objIDs.add(w,[h])}!Array.isArray(P)&&P.constructor!={}.constructor&&(P=[P]);var _=v.bindings[h].props;Array.isArray(P)?t.loop(P,function(m){Y(v.toIDs,m,h),Y(v.fromIDs,m,h),_.indexOf(m)<0&&_.push(m)}):t.loop(P,function(m,$){($==t.BOTH||$==t.TO)&&Y(v.toIDs,m,h),($==t.BOTH||$==t.FROM)&&Y(v.fromIDs,m,h),_.indexOf(m)<0&&_.push(m)});function Y(m,$,I){n(m[$])?m[$]=[I]:m[$].indexOf(I)<0&&m[$].push(I)}return f&&T("Bind Report: ADD ["+h+"]",(P?" "+P:"")+(y?" "+y:"")),v.bindType==t.LOCALSTORAGE?(v.from(null,h,P,y),(!v.data||t.isEmpty(v.data))&&v.to(h,P)):(E("bind",null,[C],v.data,y),v.applyData()),v},this.updatefilter=function(h,w){var P=v.bindings[h];return P&&(n(w)?P.filter&&delete P.filter:typeof w=="function"&&(P.filter=w)),v},this.remove=function(h,w,P,y,C,O){var _;if(!n(h)&&!Array.isArray(h)&&(h=[h]),!n(h)){_=[];var Y=[];t.loop(h,function(ne){typeof ne=="string"?_.push(ne):Y.push(ne)})}!n(w)&&!Array.isArray(w)&&(w=[w]),n(C)&&(C=!0),h=_.concat(Y),h.length==0&&(h=null);var m=g("from",h,w,!1),$=m[0];m=m[1];var I=E("remove",y,$,m,P);if(I=="stop")return;var X=t.copy(m);n(w)||w.length==0?(_.length>0&&t.loop(_,function(ne){Z(ne,!0)}),Y.length>0&&t.loop(Y,function(ne){_=v.objIDs.at(ne),_.length>0&&t.loop(_,function(U){Z(U,!1)}),v.objIDs.remove(ne)})):(_=[],t.loop(m,function(ne,U){var B=v.bindings[ne],d=B.props;t.loop(U,function(u){var o=d.indexOf(u);o>=0&&d.splice(o,1),J(u,ne)}),d.length==0&&_.push(ne)}),_.length>0&&v.remove(_));function R(ne){O&&typeof O=="function"&&(a&&(ne=t.couple(ne)),O(ne)),f&&T("Bind Report: REMOVE"+(P?" ["+P+"]":""),ne)}if(C){var q="type="+v.bindType+"&";v.bindType==t.LOCALSTORAGE?(v.to(),R("success")):v.bindType==t.GET?(I=JSON.stringify(X),a&&(I=t.couple(I)),t.async(v.connection+q+"remove="+I,R,"callbackRemove")):v.bindType==t.POST?v.ajax.post(v.connection+q,X,R,"remove"):v.bindType==t.SOCKET}function J(ne,U){var B,d;B=v.fromIDs[ne],B&&(d=B.indexOf(U),d>=0&&B.splice(d,1),B.length==0&&delete v.fromIDs[ne]),B=v.toIDs[ne],B&&(d=B.indexOf(U),d>=0&&B.splice(d,1),B.length==0&&delete v.toIDs[ne])}function Z(ne,U){var B=v.bindings[ne].obj,d=v.bindings[ne].props,u=v.objIDs.at(B),o=u.indexOf(ne);o>=0&&u.splice(o,1),U&&u.length==0&&Y.push(B),o=v.ids.indexOf(ne),o>=0&&v.ids.splice(o,1),t.loop(d,function(S){J(S,ne)}),delete v.bindings[ne]}return v};function g(h,w,P){var y=[],C;if(n(w)&&n(P)){if(h=="from"&&v.bindType!=t.LOCALSTORAGE)return t.loop(v.bindings,function(m){m.filter&&y.push(m.filter)}),[y,"full"];C=v.ids}else!n(w)&&!Array.isArray(w)&&(w=[w]),!n(P)&&!Array.isArray(P)&&(P=[P]),w&&(C=[],t.loop(w,function(m){if(typeof m=="string")C.indexOf(m)<0&&C.push(m);else{var $=v.objIDs.at(m);$&&t.loop($,function(I){C.indexOf(I)<0&&C.push(I)})}}));var O={};return C?_(P):P&&Y(),[y,O];function _(m){t.loop(C,function($){var I=v.bindings[$];if(I){I.filter&&y.push(I.filter);var X=I.obj;t.loop(m||I.props,function(R){var q=v.toIDs[R];if(q&&q.indexOf($)>=0)if(h=="from")O[$]||(O[$]=[]),O[$].push(R);else{O[$]||(O[$]={});var J=X[R];typeof J=="number"&&v.smartDecimals&&(J>1?J=t.decimals(J,1):J=t.decimals(J,2)),O[$][R]=t.copy(J)}})}})}function Y(){var m=[];t.loop(P,function($){t.loop(v.toIDs[$],function(I){var X=v.bindings[I];m.indexOf(I)<0&&(X.filter&&y.push(X.filter),m.push(I));var R=X.obj;if(h=="from")O[I]||(O[I]=[]),O[I].push($);else{O[I]||(O[I]={});var q=R[$];typeof q=="number"&&v.smartDecimals&&(q>1?q=t.decimals(q,1):q=t.decimals(q,2)),O[I][$]=t.copy(q)}})})}}this.stopProcess=!1,this.stop=function(){v.stopped=!0};var b=function(){var h=this;h.stop=function(){h.stopped=!0}};function E(h,w,P,y,C){var O=new b,_=y!=null&&!t.isEmpty(y)&&v.data;if(A(O,C))return["stop",y];v.masterFilter&&typeof v.masterFilter=="function"&&(y=v.data=v.masterFilter(y,h,C,O));var Y=t.loop(P,function(m){if(typeof m=="function"){if(A(O,C))return"stop";y=v.data=m(y,h,C,O)}});return Y=="stop"||A(O,C)?["stop",y]:(w&&typeof w=="function"&&(y=v.data=w(y,h,C,O)),A(O,C)?["stop",y]:(_&&!v.data&&pt&&tt("Bind()"+(h?" ["+h+"]":"")+(C?" ["+C+"]":"")+" - warning, a filter may not have returned data"),["go",y]))}function A(h,w){if(v.stopped||h.stopped)return T("STOP"+(w?" ["+w+"]":""),h.stopped?"process stopped":"bind stopped"),h.stopped?h.stop=null:v.stopped=!1,!0}this.to=function(h,w,P,y,C,O,_,Y){var m="targets, props, extra, filter, smartDecimals, call, lock, unique",$;if($=st(v.to,arguments,m))return $;var I=g("to",h,w,C),X=I[0];I=I[1];var R=E("to",y,X,I,P);if(I=R[1],R[0]=="stop")return;if(v.bindType==t.LOCALSTORAGE)localStorage[v.connection]=JSON.stringify(I),u(I);else{var q="type="+v.bindType+"&";if(!I||t.isEmpty(I))return v;if(v.bindType==t.GET){var J=I;t.isJSON(J)||(J=JSON.stringify(J)),a&&(J=t.couple(J)),f&&T("Bind Report: TO [bindings]",J),J=t.urlEncode(J);var Z=n(v.master)?"":"&master="+t.urlEncode(i),ne=n(_)?"":"&lock="+t.urlEncode(_),U=n(Y)?"":"&unique="+t.urlEncode(Y),B=n(P)?"":"&extra="+t.urlEncode(P),d=v.connection+q+"command=to&data="+J+Z+ne+U+B;f&&T("Bind Report: TO [url]",d),t.async(d,u,"callbackTo")}else v.bindType==t.POST&&(v.ajax.master=i,v.ajax.couple=a,v.ajax.lock=_,v.ajax.unique=Y,f&&T("Bind Report: TO [bindings]",I),v.ajax.post(v.connection+q,I,"to",P,u))}function u(o){a&&(o=t.decouple(o)),O&&typeof O=="function"&&O(o),f&&T("Bind Report: TO"+(P?" ["+P+"]":" -"),o)}return v},this.toLock=function(h,w,P,y,C,O){var _="targets, props, extra, filter, smartDecimals, call",Y;if(Y=st(v.toLock,arguments,_))return Y;if(v.bindType.toLowerCase()=="localstorage")return v.to(h,w,P,y,C,O),v;var m=t.makeID();v.from($,h,w,P,y,m);function $(){v.to(h,w,P,y,C,O,m)}return v},this.toUnique=function(h,w,P,y,C,O){var _="targets, props, extra, filter, smartDecimals, call",Y;return(Y=st(v.toUnique,arguments,_))?Y:(v.to(h,w,P,y,C,O,null,!0),v)},this.toggleReport=function(h){return n(h)?f=!f:f=h,v},f&&T("Bind Report: CREATE ["+r.toUpperCase()+"]",e+(i?" "+i:""));function T(h,w){v==mt?Er(h,w):Pr(h,w)}return this.report=function(){var h="Bind {DATA} Report:",w=t.copy(v.data);return v==mt?Er(h,w):Pr(h,w),h="Bind {BINDINGS} Report:",w=t.copy(v.bindings),v==mt?Er(h,w):Pr(h,w),v},this.from=function(h,w,P,y,C,O){var _="call, targets, props, extra, filter, lock",Y;if(Y=st(v.from,arguments,_))return Y;var m=g("from",w,P,s),$=m[0];m=m[1];var I=E("fromTo",C,$,m,y);if(m=I[1],I[0]=="stop")return;var X="type="+v.bindType+"&";if(v.bindType==t.LOCALSTORAGE)(!localStorage[v.connection]||localStorage[v.connection]==null)&&(localStorage[v.connection]="{}"),v.data=JSON.parse(localStorage[v.connection]),U(v.data);else if(v.bindType==t.GET){var R=m;t.isJSON(R)||(R=JSON.stringify(R)),a&&(R=t.couple(R)),f&&T("Bind Report: FROM [bindings]",R),R=t.urlEncode(R);var q=n(v.master)?"":"&master="+t.urlEncode(i),J=n(O)?"":"&lock="+t.urlEncode(O),Z=n(y)?"":"&extra="+t.urlEncode(y),ne=v.connection+X+"data="+R+"&command=from"+q+J+Z;f&&T("Bind Report: FROM [url]",ne),t.async(ne,U,"callbackFrom")}else v.bindType==t.POST&&(v.ajax.master=i,v.ajax.couple=a,v.ajax.lock=O,f&&T("Bind Report: FROM [bindings]",m),v.ajax.post(v.connection+X,m,"from",y,U));function U(B){if(v.data=B,a&&(v.data=t.decouple(v.data)),!n(O))var d=JSON.stringify(v.data);var u=E("from",C,$,v.data,y);if(u[0]!="stop"){var o=!1;(n(O)||d!=JSON.stringify(v.data))&&(o=!0,v.applyData()),f&&T("Bind Report: FROM"+(y?" ["+y+"]":" -"),o?v.data:"data not applied in toLock()"),h&&typeof h=="function"&&h(v.data)}}return v},this.applyData=function(){return t.loop(v.data,function(h,w){var P=v.bindings[h];if(P){var y=v.bindings[h].obj;t.loop(w,function(C,O){y[C]=O})}}),v},this.clear=function(){return v.bindType==t.LOCALSTORAGE&&(localStorage[v.connection]=null),v},this.removeAllBindings=function(h,w){if(n(h)&&(h=!0),this.bindings={},this.ids=[],this.data={},this.objIDs=new t.Dictionary(!0),this.toIDs={},this.fromIDs={},h){var P="type="+v.bindType+"&";if(v.bindType==t.LOCALSTORAGE)v.clear(),C("success");else if(v.bindType==t.GET){var y=n(v.master)?"":"&master="+encodeURI(i);t.async(v.connection+P+"command=removeAll"+y,C,"callbackRemoveAll")}else v.bindType==t.POST&&(v.ajax.master=i,v.ajax.post(v.connection+P,{},"removeAll",null,C,"removeAll"))}function C(O){w&&typeof w=="function"&&w(O),f&&T("Bind Report: REMOVEALL",O)}return v},v},t.Swipe=function(e,r,i,l,a){var s="obj, distance, duration, isometric, overrideNoSwipe",f;if(f=st(t.Swipe,arguments,s,this))return f;if(De("70"),this.cjsEventDispatcher_constructor(),this.type="Swipe",n(e)||!e.on){tt(`zim controls - Swipe():
Please pass in object`);return}n(r)&&(r=30);var c=Tt(i);n(i)&&(i=c=="s"?.08:80),this.distance=r,this.duration=i,this.active=!0;var x,k,v,g,b,E,A=this,T,h,w=e.on("mousedown",function(P){if(!A.active||!a&&P.target.zimNoSwipe)return;A.obj=P.target,g=x=P.stageX/t.scaX,b=k=P.stageY/t.scaY,v=!0,A.dispatchEvent("swipedown"),clearTimeout(E),E=setTimeout(function(){v&&(y(),v=!1)},A.duration*(c=="s"?1e3:1)),T=e.on("pressmove",function(C){g=C.stageX/t.scaX,b=C.stageY/t.scaY}),h=e.on("pressup",function(){v&&(y(),v=!1,clearTimeout(E))});function y(){var C=new Ge.Event("swipe");if(C.obj=A.obj,C.stageX=P.stageX/t.scaX,C.stageY=P.stageY/t.scaY,C.rawX=P.rawX/t.scaX,C.rawY=P.rawY/t.scaY,C.swipeX=C.swipeY=0,A.direction="none",l){if(Math.abs(g-x)>A.distance||Math.abs(b-k)>A.distance){var O=Math.atan2(b-k,g-x)*180/Math.PI;O=(O+360)%360,O>=270&&O<360?(C.swipeY=-1,A.direction="up"):O>=0&&O<90?(C.swipeX=1,A.direction="right"):O>=90&&O<180?(C.swipeY=1,A.direction="down"):O>=180&&O<270&&(C.swipeX=-1,A.direction="left")}}else Math.abs(g-x)>Math.abs(b-k)?(g-x>A.distance&&(C.swipeX=1,A.direction="right"),x-g>A.distance&&(C.swipeX=-1,A.direction="left")):(b-k>A.distance&&(C.swipeY=1,A.direction="down"),k-b>A.distance&&(C.swipeY=-1,A.direction="up"));A.dispatchEvent(C)}});this.disable=function(){A.active=!1},this.enable=function(){A.active=!0},this.dispose=function(){w&&e.off("mousedown",w),T&&e.off("pressmove",T),h&&e.off("pressup",h)}},t.extend(t.Swipe,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),t.Swiper=function(e,r,i,l,a,s,f,c,x,k,v,g,b){var E="swipeOn, target, property, sensitivity, swiperType, min, max, damp, integer, factor, loop, pauseTime, otherSwiper",A;if(A=st(t.Swiper,arguments,E,this))return A;if(De("69.5"),this.cjsEventDispatcher_constructor(),this.type="Swiper",n(e)||!e.getStage||!e.stage){tt("zim.Swiper() - please provide container on stage");return}if(n(r))return;n(l)&&(l=1),n(a)&&(a="horizontal"),n(c)&&(c=.1),c===!1&&(c=1),n(x)&&(x=!1),n(k)&&(k=1),n(v)&&(v=!1);var T=Tt(g);n(g)&&(g=T=="s"?.2:200);var h=this,w=e,P,y,C=h.desiredValue=r[i],O;this.target=r,this.property=i,this.sensitivity=l;var _=!1,Y=j.zdf||e.stage?e.stage.frame:{};w.canvas?(O=w,h.downEvent=w.on("stagemousedown",function(D){_=!0,U(D),h.moveEvent=w.on("stagemousemove",B),h.upEvent=w.on("stagemouseup",m),h.upEvent2=Y.on("mouseupplus",m)})):(O=w.stage,p(),h.downEvent=w.on("mousedown",U),h.moveEvent=w.on("pressmove",B),h.upEvent=w.on("pressup",$),h.upEvent2=Y.on("mouseupplus",$));function m(){_=!1,w.off("stagemousemove",h.moveEvent),w.off("stagemouseup",h.upEvent),h.dispatchEvent("swipeup")}function $(){_=!1,h.dispatchEvent("swipeup")}var I,X,R,q=Math.sqrt(Math.pow(w.width,2)+Math.pow(w.height,2)),J,Z,ne=!1;function U(D){ne=!0,O=D.target.stage,R=(w.parent?w.parent:w).localToGlobal(w.x,w.y),_=!0,a=="radial"?(J=D.stageX/t.scaX,Z=D.stageY/t.scaY,I=Math.atan2(Z-R.y,J-R.x)*t.DEG):P=a=="horizontal"?D.stageX/t.scaX:D.stageY/t.scaY,y=h.target[h.property],h.dispatchEvent("swipedown")}function B(D){if(_){if(a=="radial"){h.diff=t.dist(J,Z,D.stageX/t.scaX,D.stageY/t.scaY),X=Math.atan2(D.stageY/t.scaY-R.y,D.stageX/t.scaX-R.x)*t.DEG;var N=t.sign(I-X);if(Math.abs(X-I)>180){_=!1;return}h.diff=h.diff*N;var ue=Math.max(10,t.dist(R.x,R.y,D.stageX/t.scaX,D.stageY/t.scaY));h.diff*=(q-ue)/q}else h.diff=P-(a=="horizontal"?D.stageX/t.scaX:D.stageY/t.scaY);if(b&&(Math.abs(h.diff)<Math.abs(b.diff)?(h.override=!0,b.override=!1):(h.override=!1,b.override=!0)),!h.override){if(Math.abs(h.diff)>0&&(h.swiperMoving=!0),C=y-h.diff*h.sensitivity*k,!n(s)&&!n(f)&&v){var fe=C;C=(C+(f-s)*1e4-s)%(f-s)+s,Math.abs(fe-C)>Math.abs(f-s)*.8&&(h.immediate(C),P=a=="horizontal"?D.stageX/t.scaX:D.stageY/t.scaY,y=h.target[h.property])}else n(s)||(C=Math.max(C,s)),n(f)||(C=Math.min(C,f));h.desiredValue=C,h.dispatchEvent("swipemove")}}}var d=new t.Damp(h.target[h.property],c),u=C,o=C;h.swiperTicker=t.Ticker.add(function(){C==u?C!=o&&(h.pauseTimeout&&h.pauseTimeout.clear(),o=C,h.pauseTimeout=t.timeout(g,function(){_&&h.dispatchEvent("swipepause"),h.pauseTimeout=null})):(o=null,u=C,h.pauseTimeout&&h.pauseTimeout.clear()),h.swiperMoving&&(h.target[h.property]=x?Math.round(d.convert(C)):d.convert(C),ne&&!_&&Math.abs(h.target[h.property]-C)<Math.abs(l)/2&&(h.swiperMoving=!1,ne=!1,h.target[h.property]=C,h.immediate(h.target[h.property]),h.dispatchEvent("swipestop")))},O),this.immediate=function(D){d.immediate(D),h.target[h.property]=x?Math.round(D):D,h.desiredValue=C=D};var S=!0;Object.defineProperty(h,"enabled",{get:function(){return S},set:function(D){S!=D&&(D?we():L(),S=!!D)}}),Object.defineProperty(h,"desiredValue",{get:function(){return C},set:function(D){h.swiperMoving=!0,C=D}}),Object.defineProperty(h,"damp",{get:function(){return c},set:function(D){c=D,d.damp=c}});function F(){w.off("stagemousedown",h.downEvent),w.off("stagemousemove",h.moveEvent),w.off("stagemouseup",h.upEvent),Y.off("mouseupplus",h.upEvent2)}function p(){w.off("mousedown",h.downEvent),w.off("pressmove",h.moveEvent),w.off("pressup",h.upEvent),Y.off("mouseupplus",h.upEvent2)}function L(){w.canvas?F():p(),t.Ticker.remove(h.swiperTicker)}function we(){w.canvas?h.downEvent=w.on("stagemousedown",h.downEvent):(h.downEvent=w.on("mousedown",h.downEvent),h.moveEvent=w.on("pressmove",h.moveEvent),h.upEvent=w.on("pressup",h.upEvent),h.upEvent2=Y.on("mouseupplus",h.upEvent2)),h.immediate(h.target[h.property]),h.swiperTicker=t.Ticker.add(h.swiperTicker,O)}this.dispose=function(){L(),d=null,h.swiperTicker=null}},t.extend(t.Swiper,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),t.MotionController=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y){var m="target, type, speed, axis, boundary, map, diagonal, damp, flip, orient, constant, firstPerson, turnSpeed, moveThreshold, stickThreshold, container, localBoundary, mouseMoveOutside, mousedownIncludes, minPercentSpeed, maxPercentSpeed, dampKeyup, rotate, mouseOutside",$;if($=st(t.MotionController,arguments,m,this))return $;De("69.7"),this.cjsEventDispatcher_constructor(),this.type="MotionController";var I=this,X,R="zim MotionController(): Please pass in a reference to the stage or a container on the stage";if(n(T))if(j.zdf)X=T=j.zdf.stage;else{tt(R);return}else if(n(T.stage))if(j.zdf)X=j.zdf.stage;else{tt(R);return}else X=T.stage;var q=X.frame;n(k)||(_=k),n(e)&&(e=new t.Container(1,1,null,null,!1));var J=e.type=="Accelerator";if(n(i)&&(i=r=="pressmove"?20:7),!n(r)&&r.type=="DPad"){var Z=r;r="manual",n(l)&&(l=Z.axis),l=="all"&&(l="both"),Z.on("change",function(){I.convert(e.x+Z.dirX*i,e.y+Z.dirY*i)})}(n(r)||r!="mousemove"&&r!="pressmove"&&r!="pressdrag"&&r!="keydown"&&r!="gamebutton"&&r!="gamestick"&&r!="swipe"&&r!="follow"&&r!="manual")&&(r="mousedown"),n(l)&&(l=J?"horizontal":"both"),r=="keydown"&&n(s)&&(s=[[65,37],[68,39],[87,38],[83,40]]),r=="gamebutton"&&n(s)&&(g?s=[14,15,t.GamePad.RT,t.GamePad.LT]:s=[14,15,12,13]),r=="gamestick"&&n(s)&&(g?s=[[0,2],[0,2],[1],[1]]:s=[0,0,1,1]),r=="gamestick"&&n(s)&&(s=[0,0,1,1]),n(f)&&(f=!0),(l=="horizontal"||l=="vertical")&&(f=!1),(n(c)||c===!0)&&(c=r=="keydown"||r=="gamebutton"?1:r=="pressmove"?.5:.1),c===!1&&(c=1),n(g)&&(g=!1),n(b)&&(b=i*.4),n(E)&&(E=4),n(A)&&(A=.2),n(w)&&(w=!0),X.mouseMoveOutside=w,n(P)&&(P=[]),Array.isArray(P)||(P=[P]),e.type=="Pen"&&!e.move?P.push(e,e.paper):P.push(e),a&&a.getBounds&&(P?P.indexOf(a)==-1&&P.push(a):P=[a]),e.motionController=this,this.mousedownIncludes=P,T&&T.backing&&this.mousedownIncludes.push(T.backing),n(O)&&(O=.3),I.dampKeyup=O,this.dirX=0,this.dirY=0,this.speed=i,this.turnSpeed=b,this.axis=l,this.target=e,this.moveThreshold=E,this.stickThreshold=A,this.boundary=a,e.zimMCStartAngle=e.rotation;var ne=I.speed,U=I.speed,B=0;I.rotation=e.zimMCStartAngle;var d,u;if(J){u=T.getBounds();var o;!u||l=="vertical"&&!u.height||l!="vertical"&&!u.width?o=1e3:o=l=="vertical"?u.height:u.width,n(y)&&(y=0),n(C)&&(C=100),n(this.target.percentSpeed)&&(this.target.percentSpeed=(C-y)/2),I.x=o/2,I.y=o/2,d=new t.Proportion(0,o,y,C)}else I.x=this.target.x,I.y=this.target.y;var S=I.scaleX=e.scaleX,F=I.scaleY=e.scaleY,p,L,we,D,N=!1,ue=!1,fe,V,z,se,Oe;if(r=="keydown"||r=="gamebutton"){for(V=0;V<4;V++)Array.isArray(s[V])||(s[V]=[s[V]]);var K=[0,0,0,0],ge=[],Q=["X","X","Y","Y"],ce=[-1,1,-1,1],G={dirX:0,dirY:0};if(r=="keydown")var le=q.on("keydown",Ee);else{se=I.gamepad=new t.GamePad;var Ae=se.on("buttondown",Ee)}if(n(v))if(r=="keydown")var re=q.on("keyup",ie);else var xe=se.on("buttonup",ie);Oe={rotation:0,speedX:I.speed,speedY:I.speed};var ke=t.Ticker.add(function(){if(g){Le(G);return}var We=I.speed,de=I.speed;if(I.axis=="both"&&G.dirX!=0&&G.dirY!=0){var Ve=Me(G.dirX,G.dirY);We=Ve.speedX,de=Ve.speedY}(I.axis=="horizontal"||I.axis=="both")&&(I.x+=We*G.dirX),(I.axis=="vertical"||I.axis=="both")&&(I.y+=de*G.dirY),Ce()},X)}else if(r=="mousedown"||r=="mousemove")p=X.on("stage"+r,function(We){X=We.target.stage;var de,Ve;if(!Y&&I.boundary&&!I.boundary.type=="Blob"?Ve=I.boundary:!Y&&T&&T.boundsToGlobal&&(Ve=T.boundsToGlobal()),!(Ve&&(de={x:We.stageX/t.scaX,y:We.stageY/t.scaY},de.x<Ve.x||de.x>Ve.x+Ve.width||de.y<Ve.y||de.y>Ve.y+Ve.height))){if(r=="mousedown"){if(Array.isArray(I.mousedownIncludes)||(I.mousedownIncludes=[I.mousedownIncludes]),I.mousedownIncludes.indexOf(T)<0)for(V=0;V<T.numChildren;V++){var be=T.getChildAt(V);if(I.mousedownIncludes.indexOf(be)==-1&&be.mouseEnabled&&be.hitTestPoint&&be.hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY))return}I.dispatchEvent("mousedown")}var Te=T.globalToLocal(w?We.rawX/t.scaX:We.stageX/t.scaX,w?We.rawY/t.scaY:We.stageY/t.scaY);I.x=Te.x,I.y=Te.y,Ce()}});else if(r=="pressmove"||r=="pressdrag"||r=="follow")e.type=="Pen"&&(e.write=!1),p=X.on("stagemousedown",function(We){var de,Ve;if(!Y&&I.boundary&&!I.boundary.type=="Blob"?Ve=I.boundary:!Y&&T&&T.boundsToGlobal&&(Ve=T.boundsToGlobal()),!(Ve&&(de={x:We.stageX/t.scaX,y:We.stageY/t.scaY},de.x<Ve.x||de.x>Ve.x+Ve.width||de.y<Ve.y||de.y>Ve.y+Ve.height))&&!(I.boundary&&I.boundary.type=="Blob"&&(r=="pressmove"||r=="pressdrag")&&(de={x:We.stageX/t.scaX,y:We.stageY/t.scaY},!I.boundary.shape.hitTestPoint(de.x,de.y)))&&!(r=="pressdrag"&&!e.hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY))){ue=!1,Array.isArray(I.mousedownIncludes)||(I.mousedownIncludes=[I.mousedownIncludes]);var be=!1;for(I.mouseDownIncludes&&(fe=X.getObjectUnderPoint(We.stageX,We.stageY,1)),V=0;V<I.mousedownIncludes.length;V++)fe&&I.mousedownIncludes[V].hitTestPoint&&I.mousedownIncludes[V].hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY)&&I.mousedownIncludes[V].contains(fe)&&(be=!0);if(!be)for(V=0;V<T.numChildren;V++){var Te=T.getChildAt(V);if(I.mousedownIncludes.indexOf(Te)==-1&&Te.mouseEnabled&&Te.hitTestPoint&&Te.hitTestPoint(We.stageX/t.scaX,We.stageY/t.scaY))return}var Re=T.globalToLocal(w?We.rawX/t.scaX:We.stageX/t.scaX,w?We.rawY/t.scaY:We.stageY/t.scaY);r!="follow"&&r!="pressdrag"&&I.immediate(l=="both"||l=="horizontal"?Re.x:null,l=="both"||l=="vertical"?Re.y:null),Ce(),I.dispatchEvent("mousedown"),N=!0,I.moveX=w?We.rawX/t.scaX:We.stageX/t.scaX,I.moveY=w?We.rawY/t.scaY:We.stageY/t.scaY,L=X.on("stagemousemove",function(Ne){I.moveX=w?Ne.rawX/t.scaX:Ne.stageX/t.scaX,I.moveY=w?Ne.rawY/t.scaY:Ne.stageY/t.scaY,r!="follow"&&Se()}),D&&t.Ticker.remove(D),r=="follow"&&(D=t.Ticker.add(Se)),e.type=="Pen"&&(e.write=!0,e.paper.noMouse(),e.zimDragCheck=!0)}}),we=X.on("stagemouseup",function(){e.type=="Pen"&&(e.write=!1,e.paper.mouse(),e.zimDragCheck=!1,ue&&e.stopCheck()),D&&t.Ticker.remove(D),X.off("stagemousemove",L),N=!1});else if(r=="gamestick"){for(se=this.gamepad=new t.GamePad,V=0;V<4;V++)Array.isArray(s[V])||(s[V]=[s[V]]);Oe={rotation:e.zimMCStartAngle,speedX:I.speed,speedY:I.speed};var te=se.on("data",function(We){for(G={dirX:0,dirY:0},V=0;V<s[0].length;V++)if(z=We.axes[s[0][V]],Math.abs(z)>I.stickThreshold){G.dirX=z;break}for(V=0;V<s[2].length;V++)if(z=We.axes[s[2][V]],Math.abs(z)>I.stickThreshold){G.dirY=z;break}if(g){Le(G);return}I.x+=I.speed*G.dirX,I.y+=I.speed*G.dirY,Ce()})}else if(r=="swipe")var pe=new t.Swiper(X,I,"x",.8),he=new t.Swiper(X,I,"y",.8,!1),ae=pe.on("swipemove",function(){Ce()});function Ee(We){var de=r=="keydown"?We.keyCode:We.buttonCode,Ve;for(V=0;V<4;V++)if(s[V].indexOf(de)>-1){if(!f&&I.axis=="both"&&(G.dirX=G.dirY=0),G["dir"+Q[V]]=ce[V],K[V]=1,Ve=ge.indexOf(V),Ve==0)return;Ve>0&&ge.splice(Ve,1),ge.unshift(V);return}}function ie(We){var de=r=="keydown"?We.keyCode:We.buttonCode,Ve;for(V=0;V<4;V++)if(s[V].indexOf(de)>-1){if(K[V]=0,Ve=ge.indexOf(V),Ve>=0&&ge.splice(Ve,1),I.axis!="both"||f)G["dir"+Q[V]]=-K[Math.floor(V/2)*2]+K[Math.floor(V/2)*2+1];else if(ge.length>0){G["dir"+Q[V]]=0;var be=ge[0];G["dir"+Q[be]]=ce[be]}else G.dirX=G.dirY=0;return}}function Se(){var We=T.globalToLocal(I.moveX,I.moveY);I.x=We.x,I.y=We.y,Ce(),e.type=="Pen"&&!ue&&e.drawing&&(ue=!0)}function Le(We){Oe.rotation+=We.dirX*I.turnSpeed,I.rotation=Oe.rotation,Oe.speedX=Math.sin(Oe.rotation*Math.PI/180)*I.speed*-We.dirY,Oe.speedY=-Math.cos(Oe.rotation*Math.PI/180)*I.speed*-We.dirY,I.x+=Oe.speedX,I.y+=Oe.speedY}function Ce(){var We=I.x-(J?I.target.percentSpeed:I.target.x),de=I.y-(J?I.target.percentSpeed:I.target.y),Ve=Me(We,de);if(ne=Ve.speedX,U=Ve.speedY,!!_){if(n(Ve.angle)||(I.rotation=Ve.angle+e.zimMCStartAngle),n(I.rotation)){I.rotation=I.target.rotation;return}I.rotation+=B;var be=ee(I.rotation),Te=I.target.rotation=ee(I.target.rotation);Math.abs(be-Te)>180&&(Te>be?Te-=360:be-=360),I.dampR.immediate(Te),I.target.rotation=Te,I.rotation=be}}function ee(We){return(We%360+360)%360}function Me(We,de){var Ve=I.speed,be=I.speed,Te,Re=Math.sqrt(Math.pow(We,2)+Math.pow(de,2));return Re>0&&(Ve=Math.abs(We)/Re*I.speed,be=Math.abs(de)/Re*I.speed,Te=90-Math.atan2(We,de)*180/Math.PI),{speedX:Ve,speedY:be,angle:Te}}var _e=this.x,Ye=this.y,je=this.x,it=this.y,Be=this.x=J?o/2:this.target.x,qe=this.y=J?o/2:this.target.y;this.dampX=new t.Damp(Be,c),this.dampY=new t.Damp(qe,c),this.dampR=new t.Damp(this.target.rotation,c);var et=0,ve=0,Pe=t.Ticker.add(function(){if(r=="manual"&&Ce(),I.boundary&&I.boundary.type!="Blob"&&(I.x=t.constrain(I.x,I.boundary.x,I.boundary.x+I.boundary.width),I.y=t.constrain(I.y,I.boundary.y,I.boundary.y+I.boundary.height)),I.axis=="horizontal"||I.axis=="both"){if(I.dirX=t.sign(I.x-Be),Math.abs(I.x-Be)<ne?Be=I.x:Be+=I.dirX*ne,G&&G.dirX==0){var We=I.boundary?I.boundary.width/2:X.width/2,de=I.x-(I.x-We)*(J?I.dampKeyup:0);Be=de,I.x=Be}J&&u&&u.width?I.target.percentSpeed=d.convert(I.dampX.convert(Be)):I.target.x=I.dampX.convert(Be)}if(I.axis=="vertical"||I.axis=="both"){if(I.dirY=t.sign(I.y-qe),Math.abs(I.y-qe)<U?qe=I.y:qe+=t.sign(I.y-qe)*U,G&&G.dirY==0){We=I.boundary?I.boundary.height/2:X.height/2;var Ve=I.y-(I.y-We)*(J?I.dampKeyup:0);qe=Ve,I.y=qe}J&&u&&u.height?I.target.percentSpeed=d.convert(I.dampY.convert(qe)):I.target.y=I.dampY.convert(qe)}if(I.boundary&&I.boundary.type=="Blob"&&(I.boundary.shape.hitTestPoint(I.target.x,I.target.y)?(_e=I.target.x,Ye=I.target.y):(I.target.x=I.x=_e,I.target.y=I.y=Ye,I.immediate(_e,Ye))),r=="pressmove"&&N&&I.dispatchEvent("pressing"),c==1?(I.movingX=Math.round(je-I.x)!=0,I.movingY=Math.round(it-I.y)!=0,je=I.x,it=I.y):(I.movingX=Math.abs(Be-(J?I.target.percentSpeed:I.target.x))>I.moveThreshold,I.movingY=Math.abs(qe-(J?I.target.percentSpeed:I.target.y))>I.moveThreshold),I.moving&&!(I.movingX||I.movingY)?I.dispatchEvent("stopmoving"):!I.moving&&(I.movingX||I.movingY)&&I.dispatchEvent("startmoving"),I.moving=I.movingX||I.movingY,I.moving&&I.dispatchEvent("moving"),I.dirX!=et||I.dirY!=ve){var be=new Ge.Event("change"),Te;I.dirX!=et?(Te=["left",null,"right"],be.dir=Te[I.dirX+1],et=I.dirX,!e.zimMCStartAngle&&(x=="horizontal"||x=="both")&&(I.scaleX=e.scaleX=I.dirX?Math.abs(e.scaleX)*I.dirX:e.scaleX,S!=0&&Math.round(I.scaleX/S)==-1?B=180:B=0)):(Te=["up",null,"down"],be.dir=Te[I.dirY+1],ve=I.dirY,!e.zimMCStartAngle&&(x=="vertical"||x=="both")&&(I.scaleY=e.scaleY=I.dirY?-Math.abs(e.scaleY)*I.dirY:e.scaleY,F!=0&&Math.round(I.scaleY/F)==-1?B=180:B=0)),I.dispatchEvent(be)}_&&!n(I.rotation)&&(I.target.rotation=I.dampR.convert(I.rotation))},X);this.immediate=function(We,de,Ve){return!n(We)&&I.dampX&&(I.dampX.immediate(We),J?I.x=I.target.percentSpeed=Be=We:I.x=I.target.x=Be=We,pe&&pe.immediate(We)),!n(de)&&I.dampY&&(I.dampY.immediate(de),J?I.y=I.target.percentSpeed=qe=de:I.y=I.target.y=qe=de,he&&he.immediate(de)),!n(Ve)&&I.dampR&&(I.dampR.immediate(Ve),I.rotation=I.target.rotation=Ve),_e=I.x,Ye=I.y,I},this.convert=function(We,de){n(We)||(I.x=We),n(de)||(I.y=de),Ce()},Object.defineProperty(I,"pausingSpeed",{get:function(){return I.speed},set:function(We){I.speed=We}}),this.paused=!1;var oe;this.pause=function(We,de,Ve){return n(We)&&(We=!0),n(de)&&(de=0),n(Ve)&&(Ve=!1),We?(oe=I.speed,de>0?(t.animate({target:I,obj:{pausingSpeed:0},ticker:!1,time:de,call:function(){I.speed=0,I.paused=!0,I.enabled=!1,I.immediate(I.target.x,I.target.y),I.dispatchEvent("pause")}}),Ve&&(N=!1,L&&X.off("stagemousemove",L),D&&t.Ticker.remove(D),e.type=="Pen"&&(e.write=!1,e.zimDragCheck=!1),we&&X.off("stagemouseup",we),ue&&e.stopCheck(),r=="keydown"?re&&q.off("keyup",re):xe&&se.off("buttonup",xe))):(I.speed=0,I.paused=!0,I.enabled=!1,I.immediate(I.target.x,I.target.y),setTimeout(function(){I.dispatchEvent("pause")},10))):(I.enabled=!0,de>0?t.animate({target:I,obj:{pausingSpeed:oe},ticker:!1,time:de,call:function(){I.speed=oe,I.paused=!1}}):(I.speed=oe,I.paused=!1)),I};var Fe=!0;Object.defineProperty(I,"enabled",{get:function(){return Fe},set:function(We){Fe!=We&&(We?(Ze(),I.paused=!1):(Xe(),I.paused=!0),Fe=!!We)}});function Ze(){r=="keydown"?(le=q.on("keydown",le),re&&(re=q.on("keyup",re)),ke=t.Ticker.add(ke,X)):r=="gamebutton"?(Ae=se.on("buttondown",Ae),xe&&(xe=se.on("buttonup",xe)),ke=t.Ticker.add(ke,X)):r=="gamestick"?te=se.on("data",te):r=="swipe"?(pe.enabled=!0,he.enabled=!0,ae&&(ae=pe.on("swipemove",ae))):r=="mousedown"||r=="mousemove"?p=X.on("stage"+r,p):r=="pressmove"&&(p=X.on("stagemousedown",p),L&&(L=X.on("stagemousemove",L)),we&&(we=X.on("stagemouseup",we))),Pe=t.Ticker.add(Pe,X)}function Xe(){r=="keydown"?(q.off("keydown",le),q.off("keyup",re),t.Ticker.remove(ke)):r=="gamebutton"?(se.off("buttondown",Ae),se.off("buttonup",xe),t.Ticker.remove(ke)):r=="gamestick"?se.off("data",te):r=="swipe"?(pe.enabled=!1,he.enabled=!1,pe.off("swipemove",ae)):r=="mousedown"||r=="mousemove"?X.off("stage"+r,p):r=="pressmove"&&(X.off("stagemousedown",p),X.off("stagemousemove",L),X.off("stagemouseup",we)),t.Ticker.remove(Pe)}this.dispose=function(){Xe(),se&&se.dispose(),pe&&pe.dispose(),he&&pe.dispose()}},t.extend(t.MotionController,Ge.EventDispatcher,"enabled","cjsEventDispatcher"),t.GamePad=function(){if(De("69.8"),this.type="GamePad",this.cjsEventDispatcher_constructor(),!navigator.getGamepads){this.error=!0,pt&&tt("zim.GamePad() - no browswer support");return}var e;j.addEventListener("gamepadconnected",i),this.currentIndex=0;var r=this;function i(f){r.connected=!0,a("gamepadconnected",f);var c=navigator.getGamepads()[r.currentIndex];r.lastData=[];for(var x=0;x<c.buttons.length;x++)r.lastData[x]=c.buttons[x].pressed;function k(){if(e=requestAnimationFrame(k),r.data=navigator.getGamepads()[r.currentIndex],!!r.data){for(var v=r.buttons=[],g,b=0;b<r.data.buttons.length;b++)v[b]=r.data.buttons[b].pressed,v[b]!=r.lastData[b]&&(r.lastData[b]=v[b],v[b]?g=new Ge.Event("buttondown"):g=new Ge.Event("buttonup"),g.buttonCode=b,g.button=Dt[b],r.dispatchEvent(g));g=new Ge.Event("data"),g.axes=r.axes=r.data.axes,g.buttons=r.buttons,r.dispatchEvent(g)}}k()}var l=setInterval(function(){navigator.getGamepads&&navigator.getGamepads()[0]&&(r.connected||i(),clearInterval(l))},500);function a(f,c){var x=new Ge.Event(f);x.index=c.gamepad.index,x.id=c.gamepad.id,x.buttons=c.gamepad.buttons,x.axes=c.gamepad.axes,r.dispatchEvent(x)}var s=function(f){f.gamepad.index==r.currentIndex&&(cancelAnimationFrame(e),r.connected=!1,r.dispatchEvent("gamepaddisconnected"))};j.addEventListener("gamepaddisconnected",s),this.dispose=function(){j.removeEventListener("gamepadconnected",i),j.removeEventListener("gamepaddisconnected",s),cancelAnimationFrame(e),clearInterval(l),r.connected=!1}};var Dt=["A","B","X","Y","LB","RB","LT","RT","BACK","START","LS","RS","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT"];for(dn=0;dn<Dt.length;dn++)t.GamePad[Dt[dn]]=dn;var Zt=["LSX","LSY","RSX","RSY"];for(dn=0;dn<Zt.length;dn++)t.GamePad[Zt[dn]]=dn;t.extend(t.GamePad,Ge.EventDispatcher,null,"cjsEventDispatcher"),t.Portal=function(e,r){var i="obj, lands",l;if(l=st(t.Portal,arguments,i,this))return l;if(De("69.96"),n(e)||!e.stage)return;this.type="Portal";var a=this,s=r&&r.numChildren&&r.numChildren>0;if(s){var f=r.getChildAt(r.numChildren-1),c=r.getChildAt(r.numChildren-2);r.setChildIndex(c,r.numChildren-1),c.setMask(e)}function x(){r.setChildIndex(f,0),f=c,c=r.getChildAt(r.numChildren-2),r.setChildIndex(c,r.numChildren-1),f.setMask(null),c.setMask(e),e.stage.update()}e.on(t.mobile()?"mousedown":"mouseover",function(){a._enabled&&(s&&x(),a.dispatchEvent("enter"))}),e.on(t.mobile()?"pressup":"mouseout",function(){a._enabled&&a.dispatchEvent("exit")}),Object.defineProperty(this,"portal",{get:function(){return e},set:function(k){if((n(k)||!k.stage)&&pt){tt("zim.Portal() - please provide a Display Object to act as the portal");return}c.setMask(e)}}),Object.defineProperty(this,"currentLand",{get:function(){return f},set:function(k){if(r.contains(k))for(;k!=f;)x()}}),Object.defineProperty(this,"nextLand",{get:function(){return c},set:function(){if(pt){tt("zim.Portal() - nextLand is read only - remake Portal to change");return}}}),this._enabled=!0,Object.defineProperty(a,"enabled",{get:function(){return a._enabled},set:function(k){a._enabled=k}})},t.extend(t.Portal,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),j.zimContactListener=null;var At,Nt;function Ke(e,r,i,l,a,s,f,c,x,k,v,g){if(De("69.97"),n(i)&&(i=0),l=="rectangle")e.body=e.physics.makeRectangle(e.width-i,e.height-i,r,a,f,c,x,k,v,s,g);else if(l=="circle")e.body=e.physics.makeCircle(e.width/2-i,r,a,f,c,x,k,v,s,g);else if(l=="triangle")n(e.a)&&(e.a=e.width,e.b=e.c=Math.sqrt(Math.pow(e.a/2,2)+Math.pow(e.height,2))),e.body=e.physics.makeTriangle(e.a-i,e.b-i,e.c-i,r,a,f,c,x,k,v,s,g);else if(l=="poly"){var b=[];e.reg(0,0,!0);var E=e;e.scale!=1&&(E=e.clone().transformPoints("scale",e.scale)),i&&(E=e.clone().transformPoints("scale",Math.max(0,1-i/((e.width+e.height)/4)))),t.loop(E.points,function(T){b.push({x:T[0],y:T[1]})}),e.body=e.physics.makePoly(b,e.width,e.height,r,a,f,c,x,k,v,s,g)}e.body.x=e.x,e.body.y=e.y,e.body.rotation=e.rotation,e.physics.addMap(e.body,e),e.impulse=function(T,h,w,P){n(T)&&(T=0),n(h)&&(h=0);var y=e.body.GetWorldCenter();return n(w)&&(w=y.x*e.physics.scale),n(P)&&(P=y.y*e.physics.scale),e.body.ApplyImpulse(new j.b2Vec2(T,h),new j.b2Vec2(w/e.physics.scale,P/e.physics.scale)),e},e.force=function(T,h,w,P){n(T)&&(T=0),n(h)&&(h=0);var y=e.body.GetWorldCenter();return n(w)&&(w=y.x*e.physics.scale),n(P)&&(P=y.y*e.physics.scale),e.body.ApplyForce(new j.b2Vec2(T,h),new j.b2Vec2(w/e.physics.scale,P/e.physics.scale)),e},e.setLinearVelocity=function(T,h){return e.body.SetLinearVelocity(new j.b2Vec2(T,h)),e},e.setAngularVelocity=function(T){return e.body.SetAngularVelocity(T),e},e.spin=function(T){return n(T)&&(T=10),e.body.ApplyTorque(T*1e3),e},e.torque=function(T){return n(T)&&(T=10),e.body.ApplyTorque(T),e},e.follow=function(T,h,w,P,y,C,O,_,Y,m,$,I){var X="damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, borderOriginal",R;return(R=st(e.follow,arguments,X))?R:(e.physics.follow(e,T,h,w,P,y,C,O,_,Y,m,$,I),e)},e.noFollow=function(){return e.physics.follow(null),e},e.control=function(T,h,w,P,y){var C="type, speed, speedY, horizontal, vertical",O;return(O=st(e.control,arguments,C))?O:(e.physics.control(e,T,h,w,P,y),e)},e.customControl=function(T,h,w){var P="dir, speed, speedY",y;return(y=st(e.customControl,arguments,P))?y:(e.physics.customControl(T,h,w),e)},e.noControl=function(){return e.physics.noControl(e),e},e.sleep=function(){return e.body.SetAwake(!1),e},e.wake=function(){return e.body.SetAwake(!0),e};function A(){j.zimContactListener=new j.b2ContactListener,At=new t.Dictionary(!0),Nt=new t.Dictionary(!0),j.zimContactListener.BeginContact=T,j.zimContactListener.EndContact=h;function T(w){var P=At.at(w.m_fixtureB.GetBody());P&&P(w.m_fixtureA.GetBody().zimObj,w.m_fixtureA.GetBody()),P=At.at(w.m_fixtureA.GetBody()),P&&P(w.m_fixtureB.GetBody().zimObj,w.m_fixtureB.GetBody())}function h(w){var P=Nt.at(w.m_fixtureB.GetBody());P&&P(w.m_fixtureA.GetBody().zimObj,w.m_fixtureA.GetBody()),P=Nt.at(w.m_fixtureA.GetBody()),P&&P(w.m_fixtureB.GetBody().zimObj,w.m_fixtureB.GetBody())}e.physics.world.SetContactListener(j.zimContactListener)}e.contact=function(T){return j.zimContactListener||A(),At.add(e.body,T),e},e.noContact=function(){return At.remove(e.body),e},e.contactEnd=function(T){return j.zimContactListener||A(),Nt.add(e.body,T),e},e.noContactEnd=function(){return Nt.remove(e.body),e},e.hasOwnProperty("dynamic")||Object.defineProperty(e,"dynamic",{get:function(){return e.body.GetType()==2},set:function(T){e.body.SetType(T==!0?2:0)}})}for(t.Timeline=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A){var T="objects, width, startPaused, barColor, buttonColor, themeColor, corner, ticks, damp, loop, noLoop, call, style, group, inherit",h;if(h=st(t.Timeline,arguments,T,this))return h;De("69.971"),this.group=E;var w=b===!1?{}:t.getStyle("Timeline",E,A),P=this.stage?this.stage:zimDefaultFrame.stage,y=P.frame,C=P.width,O=P.height;n(i)&&(i=w.startPaused!=null?w.startPaused:!1),n(k)&&(k=w.loop!=null?w.loop:!0),n(v)&&(v=w.noLoop!=null?w.noLoop:!1),n(l)&&(l=w.barColor!=null?w.barColor:t.tin),n(a)&&(a=w.buttonColor!=null?w.buttonColor:t.light),n(s)&&(s=w.themeColor!=null?w.themeColor:t.purple),n(r)&&(r=w.width!=null?w.width:C*.5),n(c)&&(c=w.ticks!=null?w.ticks:!0),n(x)&&(x=w.damp!=null?w.damp:!1),n(N)&&(N=w.labels!=null?w.labels:!0),n(f)&&(f=w.corner!=null?w.corner:5);var _=50;this.zimContainer_constructor(r,_,null,null,!1),this.type="Timeline";var Y=this,m=e,$=t.toBW(y.color);if(n(m)){if(!t.animatedObjects||!t.animatedObjects.objects)return tt("ZIM Timeline - add Timeline after animated objects"),Y;m=t.copy(t.animatedObjects.objects)}Array.isArray(m)||(m=[m]);var I=Date.now(),X=0;t.loop(m,function(xe){xe.pauseAnimate(),xe.tweenEndTime&&xe.tweenEndTime>X&&(X=xe.tweenEndTime)});var R=Math.ceil((X-I)/1e3),q=this.backing=new t.Rectangle(r,_,l,null,null,f).alp(.8).addTo(Y),J=$=="#000000"?0:1,Z=this.shade=new t.Rectangle(_-J,_-J*2,black,null,null,[f,0,0,f]).alp(.7).pos(J,J,LEFT,TOP,Y),ne=this.shade2=new t.Rectangle(_-J,_-J*2,black,null,null,[0,f,f,0]).alp(.7).pos(J,J,RIGHT,TOP,Y),U=new t.Container(50,50).alp(.9);new t.Rectangle(7,24,white).center(U).mov(-6),new t.Rectangle(7,24,white).center(U).mov(6);var B=Y.controls=new t.Button({icon:new t.Triangle(30,30,30,white).reg(null,16).rot(90).alp(.9),toggleIcon:U.reg("center"),downBackgroundColor:t.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(q,null,70).center(Z).addTo(Y).expand(10).tap(function(){K.pauseAnimate(!B.toggled)});i||B.toggle();var d=new t.Container(50,50).reg("center").alp(.8).expand(10);new Mn(24,5,t.white).center(d).mov(0,-8),new Mn(24,5,t.white).center(d),new Mn(24,5,t.white).center(d).mov(0,8);var u=!0,o=Y.menu=new t.Button({icon:d,downBackgroundColor:t.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(q,null,70).center(ne).addTo(Y).tap(function(){Oe.show(),u&&Oe.loc(Y.x,Y.y).mov(Y.width-Oe.width/2,-Oe.height/2-10)});function S(xe){K.rate=xe,re.speed=xe,Y.trailInterval.time=Ae.convert(re.speed),localStorage&&(localStorage.zim_tl=JSON.stringify(re))}function F(xe){K.ticks.vis(xe),K.labels.vis(xe),P.update(),re.labels=xe,localStorage&&(localStorage.zim_tl=JSON.stringify(re))}function p(xe){k=xe,re.looping=xe,localStorage&&(localStorage.zim_tl=JSON.stringify(re))}function L(xe){le(),xe&&(K.percentComplete=0,setTimeout(function(){G()},50)),re.trailing=xe,localStorage&&(localStorage.zim_tl=JSON.stringify(re))}function we(xe){return t.loop([B,o],function(ke){ke.backgroundColor=xe,ke.toggleBackgroundColor=xe,ke.rollBackgroundColor=xe.lighten(.2),ke.rollToggleBackgroundColor=xe.lighten(.2),ke.downBackgroundColor=xe.darken(.2)}),Oe.backing.color=xe,D.slider.bar.color=xe,P.update(),re.color=xe,localStorage&&(localStorage.zim_tl=JSON.stringify(re)),this}this.setThemeColor=we;var D=t.List.slider("speed",0,2,1,S,.1),N=t.List.checkBox("labels",!1,F),ue=t.List.checkBox("loop",!1,p),fe=t.List.checkBox("trails",!1,L),V=t.List.colorPicker("color",t.purple,new t.ColorPicker({colors:[t.purple,t.pink,t.red,t.orange,t.brown,t.green,t.blue,t.grey,t.black],cols:9}),we),z=this.title=new t.Container(300,25).noMouse();new t.Rectangle(500,70,t.black.toAlpha(.4)).pos(0,-45,CENTER,TOP,z),this.icon=y.makeIcon({edges:"white",box:faint,slats:["white","white","white","white","white"]}).alp(.6).scaleTo(z,null,140).pos(7,-10,"left","center",z),new t.Label({text:"Z  I  M  -  T  I  M  E  L  I  N  E",color:"white"}).alp(.6).sca(.47).loc(51,-4,z),new t.Line(219,1,"white").alp(.6).center(z).mov(8,3);var se=this.list=new t.List({width:300,height:260,backdropColor:clear,borderWidth:-1,shadowColor:-1,viewNum:6,padding:12,scrollBarV:!1,list:[D,N,ue,fe,V],swipe:!1});D.slider.bar.color=t.purple,se.tabs.mov(0,8);var Oe=Y.pane=new t.Pane({width:se.width,height:se.height+40,backgroundColor:t.purple,backdropColor:t.faint,draggable:!0,corner:8,content:se,resets:!1});Oe.contentContainer.mov(0,20),Oe.backing.on("pressmove",function(){u=!1},null,!0),z.scaleTo(Oe.contentContainer,100).pos(0,2,"center","top",Oe.contentContainer).setMask(Oe.backing);var K=Y.slider=new t.Slider({min:0,max:R,inside:!0,barColor:l,barWidth:_,barLength:r-_*2-12,tickColor:$.toAlpha(.8),damp:x,useTicks:!0,tickScale:1,tickStep:.1,semiTicks:4,semiTickScale:1,useLabels:!0,labelColor:$.toAlpha(.8)}).center(Y,1);K.bar.dye(t.faint),K.currentValue=0,K.ticks.mov(0,-20),K.bar.widthOnly=K.bar.width+14,new t.Triangle({color:t.dark}).alp(.3).scaleTo(K.button,70,90,"full").center(K.button),K.animate({props:{currentValue:K.max},time:K.max,ease:"linear",startPaused:i,loop:!0,loopWait:.5,loopWaitCall:function(){k||(K.pauseAnimate(),B.toggle(!1),K.currentValue=K.max),Q&&Y.trailInterval.pause(),g&&typeof g=="function"&&g()},loopCall:function(){t.loop(m,function(xe){xe.percentComplete=0})}}),K.bar.on("mousedown",function(){K.percentComplete=K.currentValue/K.max*100});var ge=!0;K.button.on("mousedown",function(){ge=K.animating,K.pauseAnimate()}),K.button.on("pressup",function(){ge&&K.pauseAnimate(!1),K.percentComplete=K.currentValue/K.max*100}),Y.keyEvent=y.on("keydown",function(xe){xe.key==" "&&(B.toggled?(B.toggle(!1),K.pauseAnimate(!0)):(B.toggle(!0),K.pauseAnimate(!1)))}),Y.tickerID=t.Ticker.add(function(){var xe=Math.min(100,Y.slider.currentValue/R*100)-.01;t.loop(m,function(ke){var te=I+xe/100*(X-I)-ke.tweenStartTime;v&&(ke.percentComplete=Math.max(0,Math.min(100,te/(ke.tweenEndTime-ke.tweenStartTime)*100))),ke.percentComplete=te/(ke.tweenEndTime-ke.tweenStartTime)*100})});var Q;function ce(){t.loop(m,function(xe){var ke=xe.clone().addTo(Q).alp(.05);ke.color=clear,ke.borderColor=$}),Q.updateCache("source-over"),Q.disposeAllChildren()}Y.trailInterval=t.interval(.05,function(){K.animating&&D.slider.currentValue>0&&ce()}),Y.trailInterval.pause();function G(){Y.trails||(Q=new t.Container(C,O).addTo(P,0).cache(),Y.trails=new t.Bitmap(Q.cacheCanvas).addTo(P,1),Y.trailInterval.pause(!1))}function le(){Y.trails&&(Y.trailInterval.pause(),Y.trails.dispose(),Y.trails=null,Q.dispose(),Q=null)}var Ae=new t.Proportion(.1,2,.1,.01);if(localStorage){var re=localStorage.zim_tl;re||(re=JSON.stringify({speed:1,labels:!1,looping:!1,color:purple})),re=JSON.parse(re),S(re.speed),D.slider.currentValue=re.speed,D.stepper.currentValue=re.speed,F(re.labels),N.checkBox.checked=re.labels,p(re.looping),ue.checkBox.checked=re.looping,we(re.color),V.colorPicker.selectedColor=re.color,V.swatch.color=re.color,V.colorLabel.text=re.color.toUpperCase(),re.trailing&&G(),fe.checkBox.checked=re.trailing,Y.trailInterval.time=Ae.convert(re.speed)}this.pos(0,20,"center","bottom"),s!=t.purple&&we(s),this.dispose=function(xe,ke,te){return t.Ticker.remove(Y.tickerID),y.off("keydown",Y.keyEvent),te||this.zimContainer_dispose(!0),!0},b!==!1&&t.styleTransforms(this,w)},t.extend(t.Timeline,t.Container,"dispose","zimContainer",!1),t.BlurEffect=function(e,r,i,l,a,s){var f="blurX, blurY, quality, style, group, inherit",c;if(c=st(t.BlurEffect,arguments,f,this))return c;De("69.972"),this.group=a;var x=l===!1?{}:t.getStyle("BlurEffect",a,s);n(e)&&(e=x.blurX!=null?x.blurX:10),n(r)&&(r=x.blurY!=null?x.blurY:10),n(i)&&(i=x.quality!=null?x.quality:1);var k=v(e,r,i);this.veeObj={blurX:k[0],blurY:k[1],quality:k[2]};function v(){return arguments}e=nt(e),r=nt(r),i=nt(i),this.createjsBlurFilter_constructor(e,r,i),this.type="BlurEffect",this.clone=function(g){return new t.BlurEffect(g||!t.isPick(k[0])?e:k[0],g||!t.isPick(k[1])?r:k[1],g||!t.isPick(k[2])?i:k[2],l,this.group,s)}},t.extend(t.BlurEffect,Ge.BlurFilter,"clone","createjsBlurFilter",!1),t.GlowEffect=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",E;if(E=st(t.GlowEffect,arguments,b,this))return E;De("69.9725"),this.group=v;var A=k===!1?{}:t.getStyle("GlowEffect",v,g);n(e)&&(e=A.color!=null?A.color:t.white),n(r)&&(r=A.alpha!=null?A.alpha:1),n(i)&&(i=A.blurX!=null?A.blurX:30),n(l)&&(l=A.blurY!=null?A.blurY:30),n(a)&&(a=A.strength!=null?A.strength:1),n(s)&&(s=A.quality!=null?A.quality:1),n(f)&&(f=A.inner!=null?A.inner:!1),n(c)&&(c=A.knockout!=null?A.knockout:!1),n(x)&&(x=A.hideObject!=null?A.hideObject:!1);var T=h(e,r,i,l,a,s,f,c,x);this.veeObj={color:T[0],alpha:T[1],blurX:T[2],blurY:T[3],strength:T[4],quality:T[5],inner:T[6],knockout:T[7],hideObject:T[8]};function h(){return arguments}i=nt(i),l=nt(l),s=nt(s),e=nt(e),this.alpha=nt(r),this.strength=nt(a),this.inner=nt(f),this.knockout=nt(c),this.hideObject=nt(x),this.createjsBlurFilter_constructor(i,l,s),this.type="GlowEffect",this.usesContext=!0,this.applyFilter=function(w,P,y,C,O,_,Y,m){if((this.alpha<=0||this.strength<=0)&&!this.knockout)return!0;_=_||w,Y===void 0&&(Y=P),m===void 0&&(m=y);var $=_.getImageData(Y,m,C,O),I=$.data,X=document.createElement("canvas");X.width=C,X.height=O;for(var R=X.getContext("2d",{willReadFrequently:!0}),q=R.getImageData(0,0,C,O),J=q.data,Z=this.inner,ne=this._red,U=this._green,B=this._blue,d=0,u=J.length;d<u;d+=4){var o=d+3,S=I[o];Z?S!==255&&(J[d]=ne,J[d+1]=U,J[d+2]=B,J[o]=255-S):S!==0&&(J[d]=ne,J[d+1]=U,J[d+2]=B,J[o]=S)}R.putImageData(q,0,0);var F=this.strength;if(0<F){this.createjsBlurFilter_applyFilter(R,0,0,C,O),255<F&&(F=255);for(var p=1;p<F;p++)R.drawImage(X,0,0)}var L=this.alpha;L<0?L=0:1<L&&(L=1);var we;return this.knockout?Z?we="source-in":we="source-out":this.hideObject?Z?we="source-in":we="copy":Z?we="source-atop":we="destination-over",_.save(),_.setTransform(1,0,0,1,0,0),_.globalAlpha=L,_.globalCompositeOperation=we,_.drawImage(X,Y,m),_.restore(),!0},Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(w){w=t.convertColor(w,"hexNumber"),this._red=w>>16&255,this._green=w>>8&255,this._blue=w&255}}),this.color=e,this.clone=function(w){return new t.GlowFilter(w||!t.isPick(T[0])?e:T[0],w||!t.isPick(T[1])?r:T[1],w||!t.isPick(T[2])?i:T[2],w||!t.isPick(T[3])?l:T[3],w||!t.isPick(T[4])?s:T[4],w||!t.isPick(T[5])?a:T[5],w||!t.isPick(T[6])?f:T[6],w||!t.isPick(T[7])?c:T[7],w||!t.isPick(T[8])?c:T[8],k,this.group,g)}},t.extend(t.GlowEffect,Ge.BlurFilter,["clone","applyFilter"],"createjsBlurFilter",!1),t.ShadowEffect=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E){var A="distance, angle, color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",T;if(T=st(t.ShadowEffect,arguments,A,this))return T;De("69.973"),this.group=b;var h=g===!1?{}:t.getStyle("ShadowEffect",b,E);n(e)&&(e=h.distance!=null?h.distance:10),n(r)&&(r=h.angle!=null?h.angle:45),n(i)&&(i=h.color!=null?h.color:t.black),n(l)&&(l=h.alpha!=null?h.alpha:.4),n(a)&&(a=h.blurX!=null?h.blurX:15),n(s)&&(s=h.blurY!=null?h.blurY:15),n(f)&&(f=h.strength!=null?h.strength:1),n(c)&&(c=h.quality!=null?h.quality:1),n(x)&&(x=h.inner!=null?h.inner:!1),n(k)&&(k=h.knockout!=null?h.knockout:!1),n(v)&&(v=h.hideObject!=null?h.hideObject:!1);var w=P(e,r,i,l,a,s,f,c,x,k,v);this.veeObj={distance:w[0],angle:w[1],color:w[2],alpha:w[3],blurX:w[4],blurY:w[5],strength:w[6],quality:w[7],inner:w[8],knockout:w[9],hideObject:w[10]};function P(){return arguments}a=nt(a),s=nt(s),c=nt(c),i=nt(i),e=nt(e),r=nt(r);var y=this;this.alpha=nt(l),this.strength=nt(f),this.inner=nt(x),this.knockout=nt(k),this.hideObject=nt(v),this.createjsBlurFilter_constructor(a,s,c),this.type="ShadowEffect",this.usesContext=!0,Object.defineProperty(this,"angle",{get:function(){return r},set:function(O){r=O=(O%360+360)%360,C(e,O)}}),this.angle=r,Object.defineProperty(this,"distance",{get:function(){return e},set:function(O){e=O,C(O,r)}}),this.distance=e;function C(O,_){var Y=_*t.RAD;y._offsetX=Math.cos(Y)*O,y._offsetY=Math.sin(Y)*O}Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(O){O=t.convertColor(O,"hexNumber"),this._red=O>>16&255,this._green=O>>8&255,this._blue=O&255}}),this.color=i,this.applyFilter=function(O,_,Y,m,$,I,X,R){if((this.alpha<=0||this.strength<=0)&&!this.knockout&&!this.hideObject)return!0;I=I||O,X===void 0&&(X=_),R===void 0&&(R=Y);var q=I.getImageData(X,R,m,$),J=q.data,Z=document.createElement("canvas");Z.width=m,Z.height=$;for(var ne=Z.getContext("2d",{willReadFrequently:!0}),U=ne.getImageData(0,0,m,$),B=U.data,d=this.inner,u=this._red,o=this._green,S=this._blue,F=0,p=B.length;F<p;F+=4){var L=F+3,we=J[L];d?we!==255&&(B[F]=u,B[F+1]=o,B[F+2]=S,B[L]=255-we):we!==0&&(B[F]=u,B[F+1]=o,B[F+2]=S,B[L]=we)}ne.putImageData(U,0,0);var D=this.strength;if(0<D){this.createjsBlurFilter_applyFilter(ne,0,0,m,$),255<D&&(D=255);for(var N=1;N<D;N++)ne.drawImage(Z,0,0)}var ue=this.alpha;ue<0?ue=0:1<ue&&(ue=1);var fe;return this.knockout?d?fe="source-in":fe="source-out":this.hideObject?d?fe="source-in":fe="copy":d?fe="source-atop":fe="destination-over",I.save(),I.setTransform(1,0,0,1,0,0),I.globalAlpha=ue,I.globalCompositeOperation=fe,I.drawImage(Z,X+this._offsetX,R+this._offsetY),I.restore(),!0},this.getBounds=function(O){var _=this.createjsBlurFilter_getBounds(O),Y=this._offsetX,m=this._offsetY;return Y!==0&&(Y<0?(_.x+=Y,_.width+=-Y):_.width+=Y),m!==0&&(m<0?(_.y+=m,_.height+=-m):_.height+=m),_},this.clone=function(O){return new t.ShadowFilter(O||!t.isPick(w[0])?e:w[0],O||!t.isPick(w[1])?r:w[1],O||!t.isPick(w[2])?i:w[2],O||!t.isPick(w[3])?l:w[3],O||!t.isPick(w[4])?a:w[4],O||!t.isPick(w[5])?s:w[5],O||!t.isPick(w[6])?c:w[6],O||!t.isPick(w[7])?f:w[7],O||!t.isPick(w[8])?x:w[8],O||!t.isPick(w[9])?k:w[9],O||!t.isPick(w[10])?v:w[10],g,this.group,E)}},t.extend(t.ShadowEffect,Ge.BlurFilter,["clone","getBounds","applyFilter"],"createjsBlurFilter",!1),t.ColorEffect=function(e,r,i,l,a,s,f,c,x,k,v){var g="redMultiplier, greenMultiplier, blueMultiplier, alphaMultiplier, redOffset, greenOffset, blueOffset, alphaOffset, style, group, inherit",b;if(b=st(t.ColorEffect,arguments,g,this))return b;De("69.9735"),this.group=k;var E=x===!1?{}:t.getStyle("ColorEffect",k,v);n(e)&&(e=E.redMultiplier!=null?E.redMultiplier:1),n(r)&&(r=E.greenMultiplier!=null?E.greenMultiplier:1),n(i)&&(i=E.blueMultiplier!=null?E.blueMultiplier:1),n(l)&&(l=E.alphaMultiplier!=null?E.alphaMultiplier:1),n(a)&&(a=E.redOffset!=null?E.redOffset:0),n(s)&&(s=E.greenOffset!=null?E.greenOffset:0),n(f)&&(f=E.blueOffset!=null?E.blueOffset:0),n(c)&&(c=E.alphaOffset!=null?E.alphaOffset:0);var A=T(e,r,i,l,a,s,f,c);this.veeObj={redMultiplier:A[0],greenMultiplier:A[1],blueMultiplier:A[2],alphaMultiplier:A[3],redOffset:A[4],greenOffset:A[5],blueOffset:A[6],alphaOffset:A[7]};function T(){return arguments}e=nt(e),r=nt(r),i=nt(i),l=nt(l),a=nt(a),s=nt(s),f=nt(f),c=nt(c),this.createjsColorFilter_constructor(e,r,i,l,a,s,f,c),this.type="ColorEffect",this.clone=function(h){return new t.ColorEffect(e,r,i,l,a,s,f,c,h||!t.isPick(A[0])?e:A[0],h||!t.isPick(A[1])?r:A[1],h||!t.isPick(A[2])?i:A[2],h||!t.isPick(A[2])?l:A[3],h||!t.isPick(A[2])?a:A[4],h||!t.isPick(A[2])?s:A[5],h||!t.isPick(A[2])?f:A[6],h||!t.isPick(A[2])?c:A[7],x,this.group,v)}},t.extend(t.ColorEffect,Ge.ColorFilter,"clone","createjsColorFilter",!1),t.MultiEffect=function(e,r,i,l,a,s,f){var c="hue, saturation, brightness, contrast, style, group, inherit",x;if(x=st(t.MultiEffect,arguments,c,this))return x;De("69.974"),this.group=s;var k=a===!1?{}:t.getStyle("MultiEffect",s,f);n(e)&&(e=k.hue!=null?k.hue:0),n(r)&&(r=k.saturation!=null?k.saturation:0),n(i)&&(i=k.brightness!=null?k.brightness:0),n(l)&&(l=k.contrast!=null?k.contrast:0);var v=g(e,r,i,l);this.veeObj={hue:v[0],saturation:v[1],brightness:v[2],contrast:v[3]};function g(){return arguments}e=nt(e),this.createjsColorMatrixFilter_constructor(new Ge.ColorMatrix().adjustColor(i,l,r,e)),this.type="MultiEffect",this.adjustColor=function(b,E,A,T){n(e)||(e=nt(b)),n(r)||(r=nt(E)),n(i)||(i=nt(A)),n(l)||(l=nt(T)),this.matrix.reset().adjustColor(b,E,A,T)},Object.defineProperty(this,"brightness",{get:function(){return i},set:function(b){i=nt(b),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"contrast",{get:function(){return l},set:function(b){l=nt(b),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"saturation",{get:function(){return r},set:function(b){r=nt(b),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"hue",{get:function(){return e},set:function(b){e=nt(b),this.matrix=new Ge.ColorMatrix().adjustColor(i,l,r,e),this.applyFilter()}}),this.clone=function(b){return new t.MultiEffect(b||!t.isPick(v[0])?e:v[0],b||!t.isPick(v[0])?r:v[0],b||!t.isPick(v[0])?i:v[0],b||!t.isPick(v[0])?l:v[0],a,this.group,f)}},t.extend(t.MultiEffect,Ge.ColorMatrixFilter,"clone","createjsColorMatrixFilter",!1),t.AlphaEffect=function(e,r,i,l){var a="mask, style, group, inherit",s;if(s=st(t.AlphaEffect,arguments,a,this))return s;De("69.9745"),this.group=i;var f=r===!1?{}:t.getStyle("AlphaEffect",i,l);n(e)&&(e=f.mask!=null?f.mask:null);var c=x(e);this.veeObj={mask:c[0]};function x(){return arguments}e=nt(e),e.type=="Bitmap"?e=e.image:e.cache&&(e=e.cache().cacheCanvas),this.createjsAlphaMaskFilter_constructor(e),this.type="AlphaEffect",this.clone=function(k){return new t.AlphaEffect(k||!t.isPick(c[0])?e:c[0],r,this.group,l)}},t.extend(t.AlphaEffect,Ge.AlphaMaskFilter,"clone","createjsAlphaMaskFilter",!1),t.Pixel=function(e,r,i,l,a,s,f,c,x,k,v,g,b){var E="obj, amount, amountY, blur, dynamic, blendmode, boundary, expand, amountFactor, blurFactor, style, group, inherit",A;if(A=st(t.Pixel,arguments,E,this))return A;De("69.9747"),this.group=g;var T=v===!1?{}:t.getStyle("Pixel",g,b);n(e)&&(e=T.obj!=null?T.obj:null),n(r)&&(r=T.amount!=null?T.amount:.5),n(i)&&(i=T.amountY!=null?T.amountY:null);var h=!1;i==null&&(h=!0,i=r),n(l)&&(l=T.blur!=null?T.blur:0),n(a)&&(a=T.dynamic!=null?T.dynamic:!1),n(s)&&(s=T.blendmode!=null?T.blendmode:null),n(f)&&(f=T.boundary!=null?T.boundary:new t.Boundary(e.getBounds())),n(c)&&(c=T.expand!=null?T.expand:0),n(x)&&(x=T.amountFactor!=null?T.amountFactor:.6),n(k)&&(k=T.blurFactor!=null?T.blurFactor:.6);var w=P(e,r,i,l,s,x,k);this.veeObj={obj:w[0],amount:w[1],amountY:w[2],blur:w[3],blendmode:w[4],amountFactor:w[5],blurFactor:w[6]};function P(){return arguments}e=nt(e),r=nt(r),i=nt(i),l=nt(l),s=nt(s),x=nt(x),k=nt(k),c&&(Array.isArray(c)?c.length==1?f.contract(-c):c.length==2?f.contract(-c[0],-c[1]):f.contract(-c[0],-c[1],-c[2],-c[3]):f.contract(-c));var y=t.constrain(x*10,0,10),C=t.constrain(k*10,0,10),O=this,_=Math.pow(Math.E,-r*y),Y=Math.pow(Math.E,-i*y),m=Math.pow(Math.E,-l*C);n(e)&&(e=new t.Tile(new t.Circle(20,[t.green,t.blue,t.yellow,t.pink,t.purple]),5,5,5,5));var $=document.createElement("canvas"),I=$.getContext("2d"),X=document.createElement("canvas"),R=X.getContext("2d"),q=m;this.update=function(){!e.cacheCanvas||m!=q?(e.cache(f.x,f.y,f.width,f.height,m),q=m):e.updateCache(s);var J=e.width,Z=e.height,ne=e.width*_,U=e.height*Y;$.width=J,$.height=Z,X.width=J,X.height=Z,R.msImageSmoothingEnabled=!1,R.mozImageSmoothingEnabled=!1,R.webkitImageSmoothingEnabled=!1,R.imageSmoothingEnabled=!1,I.drawImage(e.cacheCanvas,0,0,ne,U),R.drawImage($,0,0,ne,U,-c*e.scale,-c*e.scale,X.width+c*2*e.scaleX,X.height+c*2*e.scaleY)},this.update(),this.zimBitmap_constructor(X),a&&(this.dynamicTicker=t.Ticker.add(function(){O.update()})),Object.defineProperty(this,"amount",{get:function(){return r},set:function(J){r=J,_=Math.pow(Math.E,-r*y),h&&(Y=Math.pow(Math.E,-r*y),i=r),O.update()}}),Object.defineProperty(this,"amountX",{get:function(){return r},set:function(J){r=J,h=!1,_=Math.pow(Math.E,-r*y),O.update()}}),Object.defineProperty(this,"amountY",{get:function(){return i},set:function(J){i=J,h=!1,Y=Math.pow(Math.E,-i*y),O.update()}}),Object.defineProperty(this,"amountFactor",{get:function(){return x},set:function(J){x=J,y=t.constrain(x*10,0,10),_=Math.pow(Math.E,-r*y),Y=Math.pow(Math.E,-i*y),O.update()}}),Object.defineProperty(this,"blur",{get:function(){return l},set:function(J){l=J,m=Math.pow(Math.E,-l*C),O.update()}}),Object.defineProperty(this,"blurFactor",{get:function(){return k},set:function(J){k=J,C=t.constrain(k*10,0,10),m=Math.pow(Math.E,-l*C),O.update()}}),Object.defineProperty(this,"dynamic",{get:function(){return a},set:function(J){a!=J&&(a=J,a?O.dynamicTicker?O.dynamicTicker=t.Ticker.add(O.dynamicTicker):O.dynamicTicker=t.Ticker.add(O.update):O.dynamicTicker&&t.Ticker.remove(O.dynamicTicker))}}),this.dispose=function(){O.dynamicTicker&&t.Ticker.remove(O.dynamicTicker),this.zimBitmap_dispose()},v!==!1&&t.styleTransforms(this,T),this.clone=function(J){return O.cloneProps(new t.Pixel(J||!t.isPick(w[0])?e:w[0],J||!t.isPick(w[1])?r:w[1],J||!t.isPick(w[2])?i:w[2],J||!t.isPick(w[3])?l:w[3],a,J||!t.isPick(w[4])?s:w[4],f,c,J||!t.isPick(w[5])?x:w[5],J||!t.isPick(w[6])?k:w[6],v,this.group,b))}},t.extend(t.Pixel,t.Bitmap,["clone","dispose"],"zimBitmap",!1),t.Parallax=function(e,r,i,l,a,s,f){var c="layers, damp, auto, stage, startPaused, mouseMoveOutside, clamp",x;if(x=st(t.Parallax,arguments,c,this))return x;if(De("68"),this.type="Parallax",n(l))if(e&&e[0]&&e[0].obj&&e[0].obj.stage)l=e[0].obj.stage;else if(j.zdf)l=j.zdf.stage;else return;n(i)?i=!0:i=!1,n(a)&&(a=!1),n(s)&&(s=!1);var k=l.getBounds().width,v=l.getBounds().height;l.mouseMoveOutside=s;var g=this;g.stageEvent=l.on("stagemousemove",function(w){g.mouseX=w.rawX/t.scaX,g.mouseY=w.rawY/t.scaY});var b=n(r)?.1:r;this.addLayer=function(w){if(!(n(w.obj)||n(w.prop)||n(w.propChange))){var P={obj:w.obj,prop:w.prop};P[P.prop]=w.propChange,n(w.input)&&(w.input="mouseX"),P.input=w.input,P.split=n(w.split)?!!(w.input=="mouseX"&&i):w.split;var y=n(w.inMin)?0:w.inMin,C=n(w.inMax)?w.input=="mouseX"||w.input=="scrollX"?k:v:w.inMax,O=n(w.factor)?1:w.factor,_=n(w.integer)?!1:w.integer;return P["p_"+P.prop]=new t.ProportionDamp(y,C,0,P[P.prop],b,O,_,f),P.prop=="scale"?P["s_"+P.prop]=P.obj.scaleX:P.prop=="frame"?P["s_"+P.prop]=P.obj.currentFrame:P["s_"+P.prop]=P.obj[P.prop],n(w.immediate)||P["p_"+P.prop].immediate(w.immediate),E.push(P),g}},this.removeLayer=function(w){if(!n(w)){var P=E[w];return P["p_"+P.prop].dispose(),E.splice(w,1),g}},this.immediate=function(w){for(var P,y=0;y<E.length;y++)P=E[y],P["p_"+P.prop].immediate(w[y]);return g},this.dispose=function(){return l.off("stagemousemove",g.stageEvent),E=null,i&&t.Ticker.remove(T),!0},e=n(e)?[]:e;for(var E=[],A=0;A<e.length;A++)this.addLayer(e[A]);if(i){var T=t.Ticker.add(h,l);a&&t.Ticker.remove(T)}function h(){g.step()}this.step=function(w){for(var P,y,C=0;C<E.length;C++)P=E[C],n(w)?P.input=="mouseX"?y=g.mouseX:P.input=="mouseY"?y=g.mouseY:P.input=="scrollX"?y=t.scrollX():P.input=="scrollY"&&(y=t.scrollY()):y=w,P.prop=="scale"?P.obj.scaleX=P.obj.scaleY=P["s_"+P.prop]+P["p_"+P.prop].convert(y):P.prop=="frame"?P.obj.gotoAndStop(P["s_"+P.prop]+P["p_"+P.prop].convert(y)):(P.obj[P.prop]=P["s_"+P.prop]+P["p_"+P.prop].convert(y),P.split&&(P.obj[P.prop]-=P[P.prop]/2));return g},g.paused=a,g.pause=function(w){return n(w)&&(w=!0),g.paused!=w&&(g.paused=w,T&&(w?t.Ticker.remove(T):T=t.Ticker.add(T))),g},Object.defineProperty(g,"damp",{get:function(){return b},set:function(w){b=w;for(var P,y=0;y<E.length;y++)P=E[y],P["p_"+P.prop].damp=b}})},t.Flipper=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E){var A="front, back, interactive, time, vertical, flipped, easeRoot, frontPress, backPress, reverse, continuous, style, group, inherit",T;if(T=st(t.Flipper,arguments,A,this))return T;De("68.5"),this.group=b;var h=g===!1?{}:t.getStyle("Flipper",this.group,E);if(n(e)&&(e=h.front!=null?h.front:j.zdf.makeIcon().sca(2)),n(r)&&(r=h.back!=null?h.back:new t.Page(e.width,e.height,t.dark)),this.front=e,this.back=r,s){var w=e;e=r,r=w}var P=Math.max(e.width,r.width),y=Math.max(e.height,r.height);this.zimContainer_constructor(P,y),this.type="Flipper",n(l)&&(l=h.time!=null?h.time:.2),n(a)&&(a=h.vertical!=null?h.vertical:!1),n(i)&&(i=h.interactive!=null?h.interactive:!1),n(s)&&(s=h.flipped!=null?h.flipped:!1),n(f)&&(f=h.easeRoot!=null?h.easeRoot:"quad"),n(c)&&(c=h.frontPress!=null?h.frontPress:!0),n(x)&&(x=h.backPress!=null?h.backPress:!0),n(k)&&(k=h.reverse!=null?h.reverse:!1),n(v)&&(v=h.continuous!=null?h.continuous:!1);var C=s;this.flipped=s;var O=this;e.centerReg(this);var _;(c&&!s||x&&s)&&(_=i&&e.backing?e.backing:e,_.on("mousedown",function(){Y(e,r)}),_.cur()),(x&&!s||c&&s)&&(_=i&&r.backing?r.backing:r,_.on("mousedown",function(){Y(r,e,-1)}),_.cur()),e.oScale=e.scale,r.oScale=r.scale,e.flipper=O,e.other=r,r.flipper=O,r.other=e,i||(e.mouseChildren=r.mouseChildren=!1),this.flip=function(m,$){m!=O.flipped&&(O.flipped?Y(C?e:r,C?r:e,-1,$):Y(C?r:e,C?e:r,1,$))};function Y(m,$,I,X){if(n(I)&&(I=1),I*=k?-1:1,v&&(I=k?C?1:-1:C?-1:1),n(X)&&(X=l),O.flipped=!O.flipped,O.dispatchEvent("flip"),X==0){O.removeAllChildren(),$.scale=$.oScale,$.skewX=$.skewY=0,$.centerReg(O),O.dispatchEvent("flipped");return}var R,q;a?(R={skewX:-90*I,scaleY:m.oScale/2},q={skewX:0,scaleY:$.oScale},$.ske(90*I,0).sca($.oScale,$.oScale/2)):(R={skewY:-90*I,scaleX:m.oScale/2},q={skewY:0,scaleX:$.oScale},$.ske(0,90*I).sca($.oScale/2,$.oScale)),m.animate({props:R,time:l,ease:f+"In",call:function(){m.removeFrom(),$.centerReg(O).animate({props:q,time:l,ease:f+"Out",call:function(){O.dispatchEvent("flipped")}})}})}g!==!1&&t.styleTransforms(this,h),this.clone=function(){return O.cloneProps(new t.Flipper(e.clone(),r.clone(),i,l,a,s,f,c,x,k,v,g,this.group,E))}},t.extend(t.Flipper,t.Container,"clone","zimContainer"),t.Book=function(e,r,i,l,a,s,f,c){var x="width, height, pages, startPage, rollUp, radius, backgroundColor, arrows",k;if(k=st(t.Book,arguments,x,this))return k;De("68.7"),n(e)&&(e=j.zdf?j.zdf.stage.width:1024),n(r)&&(r=j.zdf?j.zdf.stage.height:768),this.zimContainer_constructor(e,r),this.type="Book",n(i)&&(i=[]),n(l)&&(l=0),n(a)&&(a=!0),n(f)&&(f=t.darker),n(c)&&(c=!0);var v=Tt(),g=this;if(i.length==0)return;g.backing=new t.Rectangle(e-2,r-2,f),t.loop(i,function(O,_){typeof O=="string"&&(i[_]=t.asset(O)),i[_].zimBookIndex=_,h(O)}),g.added(T);var b,E,A;function T(O){b=O,E=b.frame;var _=new t.Shape,Y,m,$,I,X,R,q;g._currentPage=l;function J(S){if(g._currentPage=S,g.removeAllChildren(),g.backing.loc(1,1,g),g.setMask(g.backing),_.addTo(g),_.c().f(t.black).dr(0,0,0,0),g.moving=!1,i[S-1]?Y=i[S-1].reg(0,0).rot(0).loc(0,0,g):S>0&&q.reg(0,0).rot(0).loc(0,0,g).setMask(null),i[S-2]?m=i[S-2].reg(e/2,r).loc(0,r,g).rot(-90):m=new t.Rectangle(e/2,r,f).reg(e/2,r).loc(0,r,g).rot(-90),i[S-3]?$=i[S-3].rot(0).loc(0,0,g).setMask(_):$=new t.Rectangle(e/2,r,f).loc(0,0,g).setMask(_),i[S])I=i[S].rot(0).reg(0,0).pos(0,0,t.RIGHT,t.TOP,g);else{b.update();return}i[S+1]?X=i[S+1].reg(0,r).loc(e,r,g).rot(90):(X=new t.Rectangle(e/2,r,f).reg(0,r).loc(e,r,g).rot(90),q=X),i[S+2]?R=i[S+2].rot(0).pos(0,0,t.RIGHT,t.TOP,g).setMask(_):R=new t.Rectangle(e/2,r,f).pos(0,0,t.RIGHT,t.TOP,g).setMask(_),b.update()}J(l),Object.defineProperty(g,"directPage",{get:function(){return g._currentPage},set:function(S){C(),l%2==1?S=Math.ceil(S/2)*2-1:S=Math.ceil(S/2)*2,S!=g.page&&(S>g.page?(X.reg(0,0),R.setMask(null)):(m.reg(0,0),$.setMask(null)),J(S),g.moving=!1,Z=!1,g.currentW=0,g.currentH=0,y())}});var Z=!1;g.currentW=0,g.currentH=0,g.moving=!1;function ne(){g.stageEvent=b.on("stagemousedown",function(){if(g.hitTestPoint(E.mouseX,E.mouseY)){var S,F;if(!g.moving){var p=g.globalToLocal(E.mouseX,E.mouseY);if(!(p.x<0||p.x>e||p.y<0||p.y>r)&&!(s>0&&t.dist(p,new t.Point(0,r))>s&&t.dist(p,new t.Point(e,r))>s)){var L=p.x>e/2?"right":"left";L=="right"&&g._currentPage>=i.length-1||L=="left"&&g._currentPage<=1||(g.moving=!0,L=="right"?(I.addTo(g),X.addTo(g),R.addTo(g),g.pageNext=R.zimBookIndex):(Y.addTo(g),m.addTo(g),$.addTo(g),g.rolledUp&&d(0,0,"right"),g.pageNext=m.zimBookIndex),C(),g.direction=L,g.dispatchEvent("rollpress"),g.moveEvent=b.on("stagemousemove",function(){U&&(U.clear(),U=null);var we=g.globalToLocal(E.mouseX,E.mouseY);L=="right"?S=e-we.x:S=we.x,F=r-we.y+S,g.currentW=S=t.constrain(S,0,e/2),g.currentH=F=t.constrain(F,0,r),d(S,F,L)}),g.upEvent=b.on("stagemouseup",function(){b.off("stagemousemove",g.moveEvent),!Z&&B(S,F,L)},null,!0))}}}})}if(ne(),g.rollUp=function(S,F,p,L,we){if(!g.moving&&!(p=="right"&&g._currentPage>=i.length-1)&&!(p=="left"&&g._currentPage<=1)){p=="right"?(I.addTo(g),X.addTo(g),R.addTo(g)):(g.rolledUp&&d(0,0,"right"),Y.addTo(g),m.addTo(g),$.addTo(g)),g.moving=!0,n(L)&&(L=v=="s"?.5:.5/1e3),n(we)&&(we=null),g.animate({props:{currentW:S,currentH:F},time:L,ease:we,call:function(){t.Ticker.remove(D),g.moving=!1,d(S,F,p)}});var D=t.Ticker.add(function(){d(g.currentW,g.currentH,p)})}},a!==!1){g.rolledUp=!0,a===!0&&(a=v=="s"?1:1/1e3);var U=t.timeout(a,function(){g.rollUp(60,130,"right",.5),g.dispatchEvent("rollup")})}g.rollDown=function(S,F,p,L){g.moving||p=="right"&&g._currentPage>=i.length-1||p=="left"&&g._currentPage<=1||B(S,F,p,L)};function B(S,F,p,L){g.moving=!0,g.rolledUp=!1,n(L)&&(L=v=="s"?.7:.7/1e3),g.animate({props:{currentW:0,currentH:0},time:L,call:function(){t.Ticker.remove(we),d(0,0,p),g.moving=!1,y(),g.dispatchEvent("rolldown")}});var we=t.Ticker.add(function(){d(g.currentW,g.currentH,p)})}function d(S,F,p){var L;p=="right"?(_.c().mt(e,r).lt(e-S,r).lt(e,r-F).cp(),L=Math.atan2(S,F),X.loc(e-(S+S*Math.cos(2*L)),r-S*Math.sin(2*L)).rot(L*2*t.DEG),!Z&&S>=e/2&&F>=r&&u()):(_.c().mt(0,r).lt(S,r).lt(0,r-F).cp(),L=Math.atan2(S,F),m.loc(S+S*Math.cos(2*L),r-S*Math.sin(2*L)).rot(-L*2*t.DEG),!Z&&S>=e/2&&F>=r&&o()),b.update()}function u(){C(),Z=!0,g.moving=!0,g.moveEvent&&b.off("stagemousemove",g.moveEvent),g.upEvent&&b.off("stagemouseup",g.upEvent),g.currentW=0,g.currentH=0,g.lastPage=t.constrain(g._currentPage),g.direction="right",g.pageNext=R.zimBookIndex,g.dispatchEvent("pageanimate"),g.animate({ease:"quadOut",props:{currentW:e/2},time:.3,timeUnit:"s",call:function(){t.Ticker.remove(S),X.reg(0,0),R.setMask(null),J(g._currentPage+2),g.moving=!1,Z=!1,g.currentW=0,g.currentH=0,y(),g.dispatchEvent("page")}});var S=t.Ticker.add(function(){_.c().mt(e,r).lt(e/2,r).lt(e-g.currentW,0).lt(e,0).cp()});X.reg(e/2,r).loc(e/2,r,g).animate({props:{rotation:0},time:.3,ease:"quadOut",timeUnit:"s"})}function o(){C(),Z=!0,g.moving=!0,g.moveEvent&&b.off("stagemousemove",g.moveEvent),g.upEvent&&b.off("stagemouseup",g.upEvent),g.currentW=0,g.currentH=0,g.lastPage=t.constrain(g._currentPage),g.direction="left",g.pageNext=m.zimBookIndex,g.dispatchEvent("pageanimate"),g.animate({ease:"quadOut",props:{currentW:e/2},time:.3,timeUnit:"s",call:function(){t.Ticker.remove(S),m.reg(0,0),$.setMask(null),J(g._currentPage-2),g.moving=!1,Z=!1,g.currentW=0,g.currentH=0,y(),g.dispatchEvent("page")}});var S=t.Ticker.add(function(){_.c().mt(0,r).lt(e/2,r).lt(g.currentW,0).lt(0,0).cp()});m.reg(0,r).loc(e/2,r,g).animate({props:{rotation:0},time:.3,timeUnit:"s",ease:"quadOut"})}c&&(c===!0&&(c=.2),g.keydown=E.on("keydown",function(S){S.keyCode==39?g.nextPage(c):S.keyCode==37&&g.prevPage(c)})),g.changeFrame=function(S){return g.stageEvent&&b.off("stagemousedown",g.stageEvent),g.moveEvent&&b.off("stagemousemove",g.moveEvent),g.upEvent&&b.off("stagemouseup",g.upEvent),E=S,b=S.stage,ne(),g},y()}g.nextPage=function(O){if(n(g.rollUp))return setTimeout(function(){g.nextPage(O)},10),g;g.moving||g.rollUp(e/2+.1,r+.1,"right",O,"quadIn")},g.prevPage=function(O){if(n(g.rollUp))return setTimeout(function(){g.prevPage(O)},10),g;g.moving||g.rollUp(e/2+.1,r+.1,"left",O,"quadIn")},g.gotoPage=function(O,_){if(n(g.rollUp))return setTimeout(function(){g.gotoPage(O,_)},10),g;O=t.constrain(O,0,g.pages.length-1),n(_)&&(_=v=="s"?.3:300);var Y=_+(v=="s"?.35:350);g.pageInterval=t.interval(Y,function(m){var $=!1;g._currentPage<O?g.nextPage(_):g._currentPage>O?g.prevPage(_):$=!0,g.dispatchEvent("pageturn"),m.count==m.total-1&&($?(y(),g.dispatchEvent("pagedone")):t.timeout(Y,function(){y(),g.dispatchEvent("pagedone")}))},Math.floor(Math.abs(O-g._currentPage)/2+1),!0)};function h(O){O.addChild&&(O.zimHTMLList=new t.Dictionary,P(O),O.parent&&O.parent.removeChild(data.page))}function w(O){if(!(n(O)||!O.addChild))for(O.removedHTML=!1,A=0;A<O.zimHTMLList.length;A++)O.addChildAt(O.zimHTMLList.values[A].obj,O.zimHTMLList.values[A].depth)}function P(O){if(!(O.removedHTML||!O.addChild)){O.removedHTML=!0,O.zimHTMLList.clear();var _,Y;for(Y=0;Y<O.numChildren;Y++)if(_=O.getChildAt(Y),_.type=="TextArea"||_.type=="Loader"||_.type=="Tag"){var m={obj:_,depth:O.getChildIndex(_)};O.zimHTMLList.add(_,m)}for(Y=O.numChildren-1;Y>=0;Y--)_=O.getChildAt(Y),(_.type=="TextArea"||_.type=="Loader"||_.type=="Tag")&&O.removeChild(_)}}function y(){g.pages[g.page]&&w(g.pages[g.page]),g.pages[g.page-1]&&w(g.pages[g.page-1])}function C(){g.pages[g.page]&&P(g.pages[g.page]),g.pages[g.page-1]&&P(g.pages[g.page-1])}Object.defineProperty(g,"page",{get:function(){return g._currentPage},set:function(O){g.gotoPage(O,v=="s"?.1:100)}}),Object.defineProperty(g,"pages",{get:function(){return i},set:function(){pt&&tt("Book() - pages is read only")}}),this.dispose=function(O,_,Y){return g.stageEvent&&b.off("stagemousedown",g.stageEvent),g.moveEvent&&b.off("stagemousemove",g.moveEvent),g.upEvent&&b.off("stagemouseup",g.upEvent),g.keydown&&E.off("keydown",g.keydown),g.removeFrom(),Y||this.zimContainer_dispose(!0),!0}},t.extend(t.Book,t.Container,["clone","dispose"],"zimContainer"),t.Scrambler=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E){var A="tile, keys, keyProperty, scramble, time, wait, num, shadowColor, shadowBlur, swap, swapLock, style, group, inherit",T;if(T=st(t.Scrambler,arguments,A,this))return T;De("67.35"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Scrambler",this.group=b;var h=g===!1?{}:t.getStyle(this.type,this.group,E);n(e)&&(e=h.tile!=null?h.tile:e),n(r)&&(r=h.keys!=null?h.keys:null),n(i)&&(i=h.keyProperty!=null?h.keyProperty:null),n(l)&&(l=h.scramble!=null?h.scramble:!0),n(a)&&(a=h.time!=null?h.time:0),n(s)&&(s=h.wait!=null?h.wait:0),n(f)&&(f=h.num!=null?h.num:1),n(c)&&(c=h.shadowColor!=null?h.shadowColor:"rgba(0,0,0,.3)"),n(x)&&(x=h.shadowBlur!=null?h.shadowBlur:5),n(k)&&(k=h.swap!=null?h.swap:!1),n(v)&&(v=h.swapLock!=null?h.swapLock:!1),v&&(k=!0),n(e)&&(e=new t.Tile(new t.Rectangle(100,100,t.series(t.silver,t.tin,t.grey,t.dark,t.darker)),5,1,5)),e.addTo(this);var w=this;w.tile=e,w.complete=!0;var P=Tt(a);Tt(s);var y=(e.width+e.spacingH)/e.cols,C=(e.height+e.spacingV)/e.rows,O=j.zdf,_=t.makeID(null,10),Y,m,$,I=!1;e.pointers={},e.on("mousedown",function(B){if(I)return;I=!0,R(B.target),w.myDownCheck=!0,$=B.target;var d="id"+Math.abs(B.pointerID+1);if(e.pointers[d]=!0,Y=B.target.x,m=B.target.y,v){var u=e.current;if(w.testItem(B.target,u.indexOf(B.target))){B.target.noMouse(),B.target.noDrag(),B.target.locked=!0,w.myDownCheck=I=!1,q();return}}if(c!=-1&&x>0){var o=new Ge.Shadow(c,3,3,x);B.target.backing?B.target.backing.shadow=o:B.target.shadow=o}O&&(w.scrmu||(w.scrmu=O.on("mouseupplusonly",function(p){if(w.myDownCheck){w.myDownCheck=!1;var L=t.loop(e.pointers,function(we,D){return D});L||(e.pointers.id0=!0),p={target:$,pointerID:p.pointerID?L:-1},S(p)}}))),w.upEvent&&e.off("pressup",w.upEvent),w.upEvent=e.on("pressup",function(p){var L="id"+Math.abs(p.pointerID+1);e.pointers[L]&&(w.myDownCheck=I=!1,S(p))});function S(p){var L="id"+Math.abs(p.pointerID+1);if(e.pointers[L]){delete e.pointers[L];var we=!0;if(q(),I=!1,w.moveEvent&&e.off("pressmove",w.moveEvent),v){var D=p.target.boundsToGlobal(),N=e.hitTestGrid(e.width,e.height,e.cols,e.rows,D.x+D.width/2,D.y+D.height/2,null,null,e.spacingH,e.spacingV,null,"open");if(n(N))we=!1;else{var ue=u[N[0]];p.target==ue?we=!1:we=!w.testItem(ue,N[0])}}k&&we&&X(p),p.target.mouseEnabled=!1,p.target.animate({props:{x:Y,y:m},time:.1,id:_,timeUnit:"seconds",pauseOnBlur:!1,call:F,params:p})}}function F(p){!w.complete&&w.test()&&(w.complete=!0,w.dispatchEvent("complete")),c!=-1&&x>0&&(p.target.backing?p.target.backing.shadow=null:p.target.shadow=null),p.target.mouseEnabled=!0}k||(w.moveEvent&&e.off("pressmove",w.moveEvent),w.moveEvent=e.on("pressmove",function(p){X(p)}))});function X(B){var d=B.target;d.stopAnimate();var u=d.boundsToGlobal(),o=e.hitTestGrid(e.width,e.height,e.cols,e.rows,u.x+u.width/2,u.y+u.height/2,null,null,e.spacingH,e.spacingV,null,"open");n(o)||t.loop(e,function(S){if(!(S==d||S.paused===!1)){var F=S.boundsToGlobal(),p=e.hitTestGrid(e.width,e.height,e.cols,e.rows,F.x+F.width/2,F.y+F.height/2,null,null,e.spacingH,e.spacingV,null,"open");if(!n(p)){var L;o[2]==p[2]&&(S.x>=d.x&&S.x<=d.x+y/2||S.x<=d.x&&S.x>=d.x-y/2)&&(L=S.x,S.top().ord(-1),S.animate({props:{x:Y},time:.2,id:_,timeUnit:"seconds",call:function(){k&&!w.complete&&w.test()&&(w.complete=!0,w.dispatchEvent("complete"))}}),Y=L),o[1]==p[1]&&(S.y>=d.y&&S.y<=d.y+C/2||S.y<=d.y&&S.y>=d.y-C/2)&&(L=S.y,S.top().ord(-1),S.animate({props:{y:m},time:.201,override:!1,id:_,timeUnit:"seconds",call:function(){k&&!w.complete&&w.test()&&(w.complete=!0,w.dispatchEvent("complete"))}}),m=L)}}},!0)}function R(B){e.loop(function(d){d!=B&&d.noMouse()})}function q(){e.loop(function(B){B.locked||B.mouse()})}this.test=function(){var B=e.current;return t.loop(B,function(d,u){if(n(d)||!w.testItem(d,u))return!1})},this.testItem=function(B,d){if(!n(B)){if(n(d)&&(d=e.current.indexOf(B)),r){var u=n(i)?B.key:B[i];if(u!=r[d])return!1}else if(e.items[d]!=B)return!1;return!0}},this.update=function(){return e.noDrag(),e.drag({boundary:e,singleTouch:!0}),this},this.starts=[];var J=[];t.loop(e.rows*e.cols,function(B){J.push(B)});var Z=J.slice();e.loop(function(B){B.mouseChildren=!1,w.starts.push({x:B.x,y:B.y})}),this.inactive=!1,this.scramble=function(B,d,u){n(d)&&(d=0),n(B)&&(B=0),(n(u)||B==0)&&(u=1),ne(),t.timeout(d,function(){B>0?t.interval(B/u,o,u,!0):o()}),setTimeout(function(){w.complete=!1,e.loop(function(S){S.mouse(),S.locked=!1}),w.mouse(),e.drag({boundary:e,singleTouch:!0}),I=!1},P=="s"?(d+B)*1e3:d+B);function o(){for(var S=!0,F=0;S&&F<50;)F++,t.shuffle(J),S=t.loop(J,function(p,L){var we=e.getChildAt(p);if(r){var D=n(i)?we.key:we[i];if(D!=r[L])return!1}else if(e.items[L]!=we)return!1});U(J,B/u),t.timeout(B,function(){w.dispatchEvent("scrambled")})}return w},l?w.scramble(a,s,f):w.added(function(){e.drag({boundary:e,singleTouch:!0})});function ne(){w.upEvent&&e.off("pressup",w.upEvent),w.moveEvent&&e.off("pressmove",w.moveEvent),e.noDrag(),s+a>0&&w.noMouse()}function U(B,d,u){t.stopAnimate(_),t.loop(e.items,function(o,S,F){var p=w.starts[B[S]];d?o.animate({props:{x:p.x,y:p.y},time:d,ease:u?"quadInOut":"quadOut",wait:u,timeUnit:"seconds",id:_}):(o.loc(p),w.stage?o.drag({boundary:e,singleTouch:!0}):S==F-1&&w.added(function(){e.drag({boundary:e,singleTouch:!0})}))})}this.solve=function(B,d,u){n(u)&&(u=!0),n(d)&&(d=0),n(B)&&(B=0),d+B==0&&u&&w.noMouse(),setTimeout(function(){J=Z.slice(),ne(),U(J,B,0,u)},P=="s"?d*1e3:d),u||setTimeout(function(){w.mouse(),e.drag({boundary:e,singleTouch:!0})},P=="s"?(d+B)*1e3:d+B)},this._enabled=!0,Object.defineProperty(w,"enabled",{get:function(){return w._enabled},set:function(B){St(w,B),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&w.stage&&w.stage.update()}}),Object.defineProperty(w,"order",{get:function(){var B=[],d=t.loop(e.current,function(u){if(!u)return!1;B.push(u.tileNum)});return!d||B.length!=J.length||(J=B),J},set:function(B){var d=[];t.loop(B,function(u){d.push(e.items[u])}),e.remake(d),e.stage&&e.stage.update()}}),this.dispose=function(B,d,u){return w.scrmu&&O.off("mouseupplus",w.scrmu),e.removeAllEventListeners(),u||(w.zimContainer_dispose(!0),w.stage&&w.stage.update()),!0},g!==!1&&t.styleTransforms(this,h),this.clone=function(){return w.cloneProps(new t.Scrambler(e.clone(),r,i,l,a,s,f,c,x,k,v,g,w.group,E))}},t.extend(t.Scrambler,t.Container,["clone","dispose"],"zimContainer",!1),t.Scroller=function(e,r,i,l,a,s,f,c,x,k,v){var g="backing, speed, direction, horizontal, gapFix, stage, container, backing2, style, group, inherit",b;if(b=st(t.Scroller,arguments,g,this))return b;De("69"),this.cjsEventDispatcher_constructor(),this.type="Scroller",this.group=k;var E=x===!1?{}:t.getStyle(this.type,this.group,v);if(n(e)&&(e=E.backing!=null?E.backing:null),n(e))return;var A=this.backing1=e;if(n(A)||!A.getBounds)return;var T;n(c)?T=this.backing2=e.clone(!0):T=c,n(l)&&(l=E.horizontal!=null?E.horizontal:!0),n(a)&&(a=E.gapFix!=null?E.gapFix:0),n(f)&&(f=E.container!=null?E.container:null),n(s)&&(s=E.stage!=null?E.stage:null);var h=this;n(r)&&(r=E.speed!=null?E.speed:1),this.speed=r;var w=this.baseSpeed=this.speed;n(i)&&(i=E.direction!=null?E.direction:1),this.direction=i;var P=l?A.scaleX:A.scaleY;if(A.type=="AC"){tt("ZIM Scroller(): please provide Pic() with dimensions for backing objects");return}if(!A.getBounds()){tt("ZIM Scroller(): please setBounds() on backing objects");return}if(!s&&!A.stage){tt("ZIM Scroller(): please pass in stage parameter or add backing objects to stage to start");return}if(!A.parent){tt("ZIM Scroller(): please add object to container or stage before adding to Scroller");return}if(A.parent.addChildAt(T,A.parent.getChildIndex(A)),s=s||A.stage,n(f)&&(f=s),!f.getBounds()){tt("zim display - Scroller(): please setBounds() on container or stage if no container");return}var y=A.getBounds().width*P-a,C=A.getBounds().height*P-a,O,_;l?T.x=y:T.y=C;var Y=!1,m=t.Ticker.add($,s);function $(){O||(O=f.getBounds().width,_=f.getBounds().height),!(h.speed==0||h.direction==0)&&(l?(A.x-=h.speed*h.direction,A.x<T.x?T.x=A.x+y:T.x=A.x-y,h.direction*h.speed>0?T.x<0&&A.x<T.x?A.x=T.x+y:A.x<0&&T.x<A.x&&(T.x=A.x+y):T.x>O&&T.x>A.x?T.x=A.x-y:A.x>O&&A.x>T.x&&(A.x=T.x-y)):(A.y-=h.speed*h.direction,A.y<T.y?T.y=A.y+C:T.y=A.y-C,h.direction*h.speed>0?T.y<0&&A.y<T.y?A.y=T.y+C:A.y<0&&T.y<A.y&&(T.y=A.y+C):T.y>_&&T.y>A.y?T.y=A.y-C:A.y>_&&A.y>T.y&&(A.y=T.y-C)))}this.paused=!1,this.pause=function(I,X){return n(I)&&(I=!0),n(X)&&(X=0),I?(w=h.speed,X>0?(Y=!0,t.animate({target:h,obj:{pausingSpeed:0},ticker:!1,time:X,call:function(){h.speed=0,h.paused=!0,Y=!1,h.dispatchEvent("pause")}})):(Y=!1,h.speed=0,h.paused=!0,setTimeout(function(){h.dispatchEvent("pause")},10))):(Y=!1,X>0?t.animate({target:h,obj:{pausingSpeed:w},ticker:!1,time:X,call:function(){h.speed=w,h.paused=!1,Y=!1}}):(h.speed=w,h.paused=!1)),h},Object.defineProperty(h,"percentSpeed",{get:function(){return h.baseSpeed==0?NaN:h.speed/h.baseSpeed*100},set:function(I){Y||h.paused||(h.speed=h.baseSpeed*I/100)}}),Object.defineProperty(h,"pausingSpeed",{get:function(){return h.baseSpeed==0?NaN:h.speed/h.baseSpeed*100},set:function(I){h.speed=h.baseSpeed*I/100}}),Object.defineProperty(h,"percentComplete",{get:function(){return l?A.x<0&&A.x>T.x?-A.x/A.width*100:(-T.x/T.width*100+1e9)%100:A.y<0&&A.y>T.y?-A.y/A.height*100:(-T.y/T.height*100+1e9)%100},set:function(I){I=(I+1e9)%100,l?(A.x=-I*A.width/100,T.x=A.x+y):(A.y=-I*A.height/100,T.y=A.y+C)}}),x!==!1&&t.styleTransforms(this,E),this.dispose=function(){return t.Ticker.remove(m),!0}},t.extend(t.Scroller,Ge.EventDispatcher,null,"cjsEventDispatcher"),t.Dynamo=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="sprite, speed, label, startFrame, endFrame, update, reversible, flip, flipVertical, style, group, inherit",E;if(E=st(t.Dynamo,arguments,b,this))return E;De("69.2"),this.cjsEventDispatcher_constructor(),this.type="Dynamo",this.group=v;var A=k===!1?{}:t.getStyle(this.type,this.group,g);if(n(e)&&(e=A.sprite!=null?A.sprite:null),n(e))return;var T=this.frames=e.parseFrames(i,l,a,!0);if(T.length==0)return;this.totalFrames=T.length;var h=0;n(r)&&(r=A.speed!=null?A.speed:30),n(f)&&(f=A.reversible!=null?A.reversible:!0);var w=this.baseSpeed=this.speed=r;n(s)&&(s=A.update!=null?A.update:!1),n(c)&&(c=A.flip!=null?A.flip:null),n(c)&&f==!1&&(c=!0);var P=this,y,C,O=Date.now(),_,Y,m,$=!1;P.scaleX=e.scaleX,P.scaleY=e.scaleY;function I(){if(y=requestAnimationFrame(I),C=T[h].s,!(P.speed==0||C==0)&&(Y=1e3/Math.abs(P.speed)*C,_=Date.now(),_-O>Y)){O=_;var X=P.frame+(P.speed>0||!f?1:-1),R=!1;X>=T.length&&(R=!0,X=0),X<0&&(R=!0,X=T.length-1),P.frame=X,c&&(P.speed<0?e.scaleX=-P.scaleX:e.scaleX=P.scaleX),x&&(P.speed<0?e.scaleY=-P.scaleY:e.scaleY=P.scaleY),R&&P.dispatchEvent("loop"),P.dispatchEvent("change"),s&&e.stage&&e.stage.update(),!n(m)&&m==P.frame&&($=!1,P.speed=0,P.paused=!0,P.dispatchEvent("pause"))}}I(),this.paused=!1,this.pause=function(X,R,q){if(n(X)&&(X=!0),X!=P.paused)return n(R)&&(R=0),X?(w=P.speed,typeof q>"u"?R>0?($=!0,t.animate({target:P,obj:{pausingSpeed:0},ticker:!1,time:R,call:function(){$=!1,P.speed=0,P.paused=!0,P.dispatchEvent("pause")}})):($=!1,P.speed=0,P.paused=!0,setTimeout(function(){P.dispatchEvent("pause")},10)):($=!0,m=q)):(m=null,R>0?($=!0,t.animate({target:P,obj:{pausingSpeed:w},ticker:!1,time:R,call:function(){$=!1,P.speed=w,P.paused=!1}})):($=!1,P.speed=w,P.paused=!1)),P},Object.defineProperty(P,"frame",{get:function(){return h},set:function(X){h=Math.round(X)%T.length;var R=T[h];n(R)||(e.frame=R.f)}}),Object.defineProperty(P,"percentSpeed",{get:function(){return P.baseSpeed==0?NaN:$||P.paused?w/P.baseSpeed*100:P.speed/P.baseSpeed*100},set:function(X){if($||P.paused){w=P.baseSpeed*X/100;return}P.speed=P.baseSpeed*X/100}}),Object.defineProperty(P,"pausingSpeed",{get:function(){return P.baseSpeed==0?NaN:P.speed/P.baseSpeed*100},set:function(X){P.speed=P.baseSpeed*X/100}}),k!==!1&&t.styleTransforms(this,A),this.dispose=function(){cancelAnimationFrame(y)}},t.extend(t.Dynamo,Ge.EventDispatcher,null,"cjsEventDispatcher"),t.Accelerator=function(e){De("69.3"),this.cjsEventDispatcher_constructor();var r=this;this.type="Accelerator",this.paused=!1,this.items=[],this.paused=!1,this._percentSpeed=100,this.add=function(i){var l;Array.isArray(i)?l=i:l=[i];for(var a,s=0;s<l.length;s++)a=r.items.indexOf(l[s]),a<0&&r.items.push(l[s]);return r},e&&this.add(e),this.remove=function(i){var l;Array.isArray(i)?l=i:l=[i];for(var a,s=0;s<l.length;s++)a=r.items.indexOf(l[s]),a>=0&&r.items.splice(a,1);return r},this.pause=function(i,l,a){if(n(i)&&(i=!0),i==r.paused)return;var s=[];if(i){n(a)||(l=null);for(var f=!1,c=0;c<r.items.length;c++)(!n(l)&&n(a)&&!r.items[c].totalFrames||r.items[c].totalFrames&&(!n(l)||!n(a)))&&(r.items[c].pause(!0,l,a),f=!0,s[c]=1,r.items[c].on("pause",function(){r.paused||(x(!0),r.paused=!0,r.dispatchEvent("pause"))},null,!0));f||(x(),r.paused=!0,setTimeout(function(){r.dispatchEvent("pause")},10))}else r.paused=!1,x();function x(){for(var k=0;k<r.items.length;k++)s[k]!=1&&r.items[k].pause(i)}},Object.defineProperty(r,"percentSpeed",{get:function(){return r._percentSpeed},set:function(i){r._percentSpeed=i;for(var l=0;l<r.items.length;l++)r.items[l].percentSpeed=i}}),this.dispose=function(){for(var i=0;i<r.items.length;i++)r.items[i].dispose();return r.items=null,!0}},t.extend(t.Accelerator,Ge.EventDispatcher,null,"cjsEventDispatcher"),t.Emitter=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d){var u="obj, width, height, interval, num, life, fade, shrink, warm, decayTime, decayStart, trace, traceFadeTime, traceShiftX, traceShiftY, angle, force, gravity, wind, layers, animation, random, horizontal, vertical, sink, sinkForce, cache, events, startPaused, pool, poolMin, particles, focusWarm, style, group, inherit",o;if(o=st(t.Emitter,arguments,u,this))return o;De("69.9"),this.type="Emitter",this.group=B;var S=U===!1?{}:t.getStyle(this.type,this.group,d);n(e)&&(e=S.obj!=null?S.obj:[new t.Circle(20,t.pink),new t.Circle(20,t.green),new t.Circle(20,t.blue)]),n(r)&&(r=S.width!=null?S.width:300),n(i)&&(i=S.height!=null?S.height:300);var F=Tt(l);n(l)&&(l=S.interval!=null?S.interval:F=="s"?.02:20),typeof l=="number"&&(l=Math.max(F=="s"?.01:10,l)),n(a)&&(a=S.num!=null?S.num:1),n(g)&&(g=S.trace!=null?g.size:!1),n(b)&&(b=S.traceFadeTime!=null?S.traceFadeTime:k),n(E)&&(E=S.traceShiftX!=null?S.traceShiftX:0),n(A)&&(A=S.traceShiftY!=null?S.traceShiftY:0),Pt(s,F),n(s)&&(s=S.life!=null?S.life:F=="s"?1:1e3),n(f)&&(f=S.fade!=null?S.fade:!0),n(c)&&(c=S.shrink!=null?S.shrink:!g),n(x)&&(x=S.warm!=null?S.warm:null),Pt(k,F),n(k)&&(k=S.decayTime!=null?S.decayTime:F=="s"?1:1e3),n(T)&&(T=S.angle!=null?S.angle:{min:0,max:360}),n(h)&&(h=S.force!=null?S.force:5),n(w)&&(w=S.gravity!=null?S.gravity:9.8),n(P)&&(P=S.wind!=null?S.wind:0),n(y)&&(y=S.layers!=null?S.layers:"top"),n(r)&&(r=S.width!=null?S.width:100),n(i)&&(i=S.height!=null?S.height:100),n(_)&&(_=S.horizontal!=null?S.horizontal:!1),n(Y)&&(Y=S.vertical!=null?S.vertical:!1),n(m)&&(m=S.sink!=null?S.sink:null),!n(m)&&n($)&&($=S.sinkForce!=null?S.sinkForce:10),n(X)&&(X=S.events!=null?S.events:!1),n(R)&&(R=S.startPaused!=null?S.startPaused:!1),n(q)&&(q=S.pool!=null?S.pool:!0),n(J)&&(J=S.poolMin!=null?S.poolMin:0),n(Z)&&(Z=S.particles!=null?S.particles:new t.Container),n(ne)&&(ne=S.focusWarm!=null?S.focusWarm:!0),e.type=="shape"&&(ne=!1),Z.type="Particles",Z.emitter=this,this.zimContainer_constructor(r,i,null,null,!1),this.type="Emitter";var p=this;this.regX=r/2,this.regY=i/2,p.obj=e,p.particles=Z,p.interval=l,p.num=a,p.life=s,p.fade=f,p.shrink=c,p.decayTime=k,p.decayStart=v,p.trace=g,p.traceFadeTime=b,p.traceShiftX=E,p.traceShiftY=A,p.angle=T,p.emitterForce=h,p.gravity=w,p.wind=P,p.layers=y,p.animation=C,p.random=O,p.horizontal=_,p.vertical=Y,p.sink=m,p.sinkForce=$,p.events=X,p.startEmitterPaused=p.emitterPaused=R,p.pool=q,p.poolMin=J,p.particlesEmitted=0;var L=[],we=0,D=0,N,ue;t.added(p,fe);function fe(K){if(p.emitterPaused=null,p.on("added",function(){t.loop(p.particles,function(ce){ce.visible=!1}),p.particles.addTo(p.parent)}),ue=K,n(I)&&(ue.isWebGL?I=!1:I=t.mobile()),I&&(ue.snapToPixelEnabled=!0),ue){let ce=function(){var le=t.isPick(p.life)?t.Pick.getMinMax(p.life).max:p.life;if(n(le)&&(le=F=="s"?1:1e3),p.startEmitterPaused){p.pauseEmitter();return}if(e=Array.isArray(p.obj)?p.obj:[p.obj],e.length<=0)return;var Ae,re;function xe(ke,te){return ke-te}Array.isArray(p.interval)?(p.interval.sort(xe),Ae=p.interval[0]):p.interval.constructor=={}.constructor?Ae=p.interval.min:Ae=p.interval,Array.isArray(p.num)?(p.num.sort(xe),re=p.num[p.num.length-1]):p.num.constructor=={}.constructor?re=p.num.max:re=p.num,t.loop(t.Pick.choose(p.num),function(){if(p.decayTime>0){var ke={};p.shrink&&(ke.scale=0),p.fade&&(ke.alpha=0)}var te,pe,he;if(p.pool&&L.length>0&&D>=Math.max(p.poolMin,le/Ae*re))te=L[we++%L.length],te.visible=!0,he=te.trace?te.getChildAt(0):te,he.emitShape&&(pe=he.template,he.graphics.c().s(pe.s?t.Pick.choose(pe.s):null).ss(pe.ss?t.Pick.choose(pe.ss):null).sd(pe.sd?t.Pick.choose(pe.sd):null,pe.offset?t.Pick.choose(pe.offset):null)),te.trace&&te.cacheCanvas&&te.updateCache(),p.layers=="top"?he.emitShape?te.addTo(Z,null,!1):te.addTo(Z,Z.numChildren-1):he.emitShape?te.addTo(Z,p.layers=="bottom"?0:t.rand(Z.numChildren),!1):te.addTo(Z,p.layers=="bottom"?0:t.rand(Z.numChildren)),g||te.reg("center"),te.scaleX=1,te.scaleY=1,te.alpha=te.originalAlpha,he.scaleX=he.originalScaleX,he.scaleY=he.originalScaleY,he.rotation=he.originalRotation,he.color=he.originalColor,he.endSpurt=!1;else{D++,p.trace&&(te=new t.Container(r,i,null,null,!1),te.trace=!0);var ae=t.Pick.choose(t.shuffle(e)[0]);ae.type=="shape"?(pe=ae,he=new t.Shape(1,1,null,null,null,!1),he.emitShape=!0,he.template=pe,he.graphics.s(pe.s?t.Pick.choose(pe.s):null).ss(pe.ss?t.Pick.choose(pe.ss):null).sd(pe.sd?t.Pick.choose(pe.sd):null,pe.offset?t.Pick.choose(pe.offset):null),p.trace?he.addTo(te,null,!1):p.layers=="top"?he.addTo(Z,null,!1):he.addTo(Z,p.layers=="bottom"?0:t.rand(Z.numChildren),null,!1)):(he=ae.clone(),he.centerReg||Un(he),p.trace?he.centerReg(te).loc(-1e3,-1e3):p.layers=="top"?he.centerReg(Z):he.centerReg(Z,p.layers=="bottom"?0:t.rand(Z.numChildren))),p.trace&&(p.layers=="top"?te.addTo(Z,null,!1):te.addTo(Z,p.layers=="bottom"?0:t.rand(Z.numChildren),!1),te.cache(E,A,r*2,i*2)),p.trace||(te=he),te.particle=he,te.originalAlpha=te.alpha,he.originalAlpha=he.alpha,he.originalScaleX=he.scaleX,he.originalScaleY=he.scaleY,he.originalRotation=he.rotation,he.originalColor=he.color}p.currentParticle=he,p.particlesEmitted++,te.particleNormal=!0,te.particleDecaying=!1,te.particleFizzing=!1;var Ee=t.Pick.choose(p.angle),ie=t.Pick.choose(p.emitterForce),Se=ie*Math.cos(Ee*Math.PI/180),Le=ie*Math.sin(Ee*Math.PI/180);he.info={position:{x:p.x,y:p.y},velocity:{x:Se,y:Le},sink:n($)?null:nt($)},p.horizontal&&(he.info.position={x:p.x-p.regX+t.rand(0,r),y:p.y-p.regY+(p.vertical?i/2:0)}),p.vertical&&(he.info.position={x:p.x-p.regX+(p.horizontal?r/2:0),y:p.y-p.regY+t.rand(0,i)}),he.emitShape?he.graphics.mt(he.info.position.x,he.info.position.y):(he.x=he.info.position.x,he.y=he.info.position.y),he.alpha=he.originalAlpha,p.random&&t.loop(p.random,function(Ye,je){var it=t.Pick.choose(je);Ye=="scale"?he.sca(it):(Ye=="x"?he.info.position.x=p.horizontal||p.vertical?it:it+r/2:Ye=="y"&&(he.info.position.y=p.horizontal||p.vertical?it:it+i/2),(Ye=="x"||Ye=="y")&&he.emitShape&&he.graphics.mt(he.info.position.x,he.info.position.y),he[Ye]=it,he.emitShape&&(he.x=0,he.y=0))}),I&&!he.emitShape&&he.cache(he.getBounds().x-10,he.getBounds().y-10,he.getBounds().width+20,he.getBounds().height+20);var Ce=he.emitShape?!1:p.shrink,ee=(te||he).life=nt(p.life);if(p.decayTime>0&&(p.fade||Ce||p.trace&&p.traceFadeTime>0)){if(p.trace&&p.traceFadeTime>0&&te.animate({obj:{alpha:0},time:p.traceFadeTime,wait:ee-p.traceFadeTime,waitedCall:function(Ye){Ye.particleNormal=!1,Ye.particleFizzing=!0},call:V,override:!1,id:"decay"}),p.fade||Ce){var Me={};p.fade&&(Me.alpha=0),Ce&&(Me.scaleX=0,Me.scaleY=0),he.animate({obj:Me,time:p.decayTime,wait:n(p.decayStart)?ee-p.decayTime:p.decayStart,waitedCall:function(Ye){Ye.parent!=p&&(Ye=Ye.parent),Ye.particleNormal=!1,Ye.particleDecaying=!0},call:function(Ye){p.events&&z("decayed",Ye),Ye.endSpurt&&z("spurtdecayed",Ye),p.trace&&p.traceFadeTime>0||(n(p.decayStart)||p.decayStart+p.decayTime>p.life?Ye.parent&&V(Ye.parent.trace?Ye.parent:Ye):-function(){var je=te;t.timeout(ee-(p.decayStart+p.decayTime),function(){V(je)})}())},override:!1,id:"decay"})}}else te.life=p.life,p.life>0&&-function(){var Ye=te;Ye.timeOut=t.timeout(p.life,function(){V(Ye)})}();if(p.events&&z("emitted",te),se(he),p.animation){var _e=t.Pick.choose(p.animation);Array.isArray(_e)?t.loop(_e,function(Ye){n(Ye.override)&&(Ye.override=!1),he.animate(t.copy(Ye))}):(n(_e.override)&&(_e.override=!1),he.animate(t.copy(_e)))}})},G=function(){t.loop(Z,function(le){if(le.trace){var Ae=le;le=le.getChildAt(0)}var re=le.info,xe=0,ke=0;if(!n(p.sink)){var te=p.particles.localToGlobal(re.position.x,re.position.y),pe;p.sink.parent&&p.sink.parent.localToGlobal?pe=p.sink.parent.localToGlobal(p.sink.x,p.sink.y):pe=new Ge.Point(t.Pick.choose(p.sink.x),t.Pick.choose(p.sink.y));var he=t.angle(te.x,te.y,pe.x,pe.y);xe=re.sink*Math.cos(he*Math.PI/180),ke=re.sink*Math.sin(he*Math.PI/180)}var ae=p.wind+xe,Ee=p.gravity+ke;re.velocity.x+=ae*Q,re.velocity.y+=Ee*Q,re.position.x+=re.velocity.x*Q*100,re.position.y+=re.velocity.y*Q*100,le.emitShape?le.graphics.lt(re.position.x,re.position.y):(le.x=re.position.x,le.y=re.position.y),p.trace&&Ae&&Ae.cacheCanvas&&Ae.updateCache(le.emitShape?null:"source-over")})};var ge=p.parent.getChildIndex(p);p.parent.addChildAt(Z,ge),!_&&!Y&&p.centerReg(null,null,!1),p.zimInterval=t.interval(p.interval,ce,null,!0,!0);var Q=0;N=p.emitterTicker=t.Ticker.add(G,ue),Q=1/t.Ticker.framerate,p.focusWarm=ne,p.doWarm=function(le){if(n(le)||le===!0){var Ae;s.max?Ae=s.max:Array.isArray(s)?Ae=t.arrayMinMax(s).max:Ae=nt(s);var re;l.min?re=l.min:Array.isArray(l)?re=t.arrayMinmin(l).min:re=nt(l),le=Math.min(200,Math.round(Ae/re))}var xe=p.pool;p.pool=!1;var ke=Math.round(l*t.Ticker.framerate);t.loop(Math.round(le*l*t.Ticker.framerate),function(te){te%ke==0&&ce(),t.loop(Z,function(pe){pe.warmTick?pe.warmTick++:pe.warmTick=1,pe.warmTick/t.Ticker.framerate>pe.life&&V(pe)}),G()}),t.loop(Z,function(te){if(te.zimTweens){var pe=te.warmTick/t.Ticker.framerate/te.life*100;pe>=100&&(te.alpha=0),te.percentComplete=pe}}),p.pool=xe},x&&p.doWarm(x)}}p.particles.noMouse();function V(K){if(p.events&&z("fizzed",K),(K.trace?K.getChildAt(0).endSpurt:K.endSpurt)&&(z("spurtfizzed",K),p.spurting=!1),p.pool&&K.pooled!="end")if(K.pooled){K.visible=!1;return}else{K.pooled=!0,L&&L.push(K),K.visible=!1;return}p.removeChild(K),p.trace&&K.uncache(),K=null}function z(K,ge){if(!n(ge)){var Q=new Ge.Event(K);Q.particle=ge.trace?ge.getChildAt(0):ge,p.dispatchEvent(Q)}}function se(K){n(p.spurtCount)&&n(p.spurtNum)||(p.spurtCount++,p.spurtCount>=p.spurtNum&&Oe(K))}function Oe(K){p.pauseEmitter(),p.spurtCount=p.spurtNum=null,!n(K)&&(z("spurted",K),K.endSpurt=!0)}Object.defineProperty(p,"interval",{get:function(){return l},set:function(K){l=K,p.zimInterval&&(p.zimInterval.time=l)}}),this.removeFrom=function(){p.parent&&p.parent.removeChild(p),p.particles.removeFrom()},this.spurting=!1,this.spurt=function(K,ge,Q){var ce="num, time, restart",G;return(G=st(p.spurt,arguments,ce))?G:(n(ge)||(t.timeout(t.Pick.choose(ge),function(){Oe(p.currentParticle)},!0),p.spurting=!0),n(K)||(p.spurtNum=t.Pick.choose(K),p.spurtCount=0,p.spurting=!0),p.pauseEmitter(!1,Q,null,!0),p)},this.clearPool=function(){t.loop(p.particles,function(K){K.pooled="end",K.visible||p.removeChild(K)},!0),D=0,we=0,L=[]},p.startEmitterPaused||(this.emitterPaused=!1),this.pauseEmitter=function(K,ge,Q,ce){if(p.startEmitterPaused=null,n(K)&&(K=!0),n(ge)&&(ge=!1),n(Q)&&(Q=!1),K){if(p.emitterPaused)return p;Q&&(N&&t.Ticker.remove(N),t.loop(p.particles,function(G){G.pauseAnimate(),G.trace&&G.getChildAt(0).pauseAnimate(),G.timeOut&&G.timeOut.pause()})),p.zimInterval.pause(),p.emitterPaused=!0}else{if(!p.emitterPaused)return p;ge&&(t.loop(p.particles,function(G){G.stopAnimate(),G.timeOut&&G.timeOut.clear(),G.trace&&G.getChildAt(0).pauseAnimate()}),p.removeAllChildren()),ue&&N&&!t.Ticker.has(ue,N)&&(t.Ticker.add(N,ue),t.loop(p.particles,function(G){G.pauseAnimate(!1),G.timeOut&&G.timeOut.pause(!1),G.trace&&G.getChildAt(0).pauseAnimate(!1)})),p.zimInterval&&p.zimInterval.pause(!1,ce),p.emitterPaused=!1}return p},this.resize=function(K,ge){n(K)||(r=K),n(ge)||(i=ge),p.setBounds(0,0,r,i),!_&&!Y&&p.centerReg(),p.clearPool()},U!==!1&&t.styleTransforms(this,S),this.clone=function(K){var ge;return Array.isArray(p.obj)||p.obj.constructor=={}.constructor?ge=t.copy(p.obj):p.obj.clone?ge=p.obj.clone(K):ge=p.obj,p.cloneProps(new t.Emitter(ge,r,i,p.interval,p.num,p.life,p.fade,p.shrink,p.decayTime,p.decayStart,p.trace,p.traceFadeTime,p.traceShiftX,p.traceShiftY,p.angle,p.emitterForce,p.gravity,p.wind,p.layers,p.animation,t.copy(p.random),p.horizontal,p.vertical,p.sink,p.sinkForce,I,p.events,R,p.pool,p.poolMin,U,p.group,d))},this.dispose=function(){return p.zimInterval&&p.zimInterval.clear(),N&&t.Ticker.remove(N),t.loop(L,function(K){K&&K.dispose()}),Z&&Z.dispose&&Z.dispose(),p.currentParticle&&p.currentParticle.dispose&&p.currentParticle.dispose(),e&&Array.isArray(e)?t.loop(e,function(K){K.dispose&&K.dispose()}):e&&e.dispose&&e.dispose(),Z=p.currentParticle=p.particles=e=p.obj=L=p.poolList=null,!0}},t.extend(t.Emitter,t.Container,"clone","zimContainer",!1),t.Generator=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O){var _="color, strokeColor, strokeWidth, draw, stamp, setup, maxCount, boundary, drawCount, drawPause, drawSpacebarPause, startX, startY, cache, recordLinePoints, frame, seed, output, outputType, style, group, inherit",Y;if(Y=st(t.Generator,arguments,_,this))return Y;De("69.92"),this.group=C;var m=y===!1?{}:t.getStyle("Generator",this.group,O);n(T)&&(T=m.frame!=null?m.frame:j.zdf);var $=T.stage;n(e)&&(e=m.color!=null?m.color:null),n(r)&&(r=m.strokeColor!=null?m.strokeColor:t.white),n(i)&&(i=m.strokeWidth!=null?m.strokeWidth:1),n(f)&&(f=m.maxCount!=null?m.maxCount:1e3),n(c)&&(c=m.boundary!=null?m.boundary:new t.Boundary(0,0,$.width,$.height)),n(x)&&(x=m.drawCount!=null?m.drawCount:1),n(k)&&(k=m.drawPause!=null?m.drawPause:!0),n(v)&&(v=m.drawSpacebarPause!=null?m.drawSpacebarPause:!0),n(g)&&(g=m.startX!=null?m.startX:$.width/2),n(b)&&(b=m.startY!=null?m.startY:$.height/2),n(E)&&(E=m.cache!=null?m.cache:!1);var I=this.drawing=new t.Container(c.x,c.y,c.width,c.height).addTo($),X=this.shape=new t.Shape(c.width,c.height).addTo(I);this.drawCount=x,n(k)&&(k=!0),E&&X.cache(c.x,c.y,c.width,c.height),this.zimContainer_constructor(c.x,c.y,c.width,c.height),this.type="Generator";var R=this;if(R.draw=null,w){R.drawCount=10,!n(a)&&n(l)&&(l=a),a=null;var q=new t.Loader;R.outputNum=0,R.outputName=w===!0?"gen_":w.match(/_$/)?w:w+"_"}this.color=e,this.strokeColor=r,this.strokeWidth=i;var J=g,Z=b;this.fill=function(u){return R.color=u,R.currentColor=nt(R.color),X.f(R.currentColor),this},this.stroke=function(u,o){return n(u)||(R.strokeColor=u,R.currentStrokeColor=nt(R.strokeColor),X.s(R.currentStrokeColor)),n(o)||(R.strokeWidth=o,R.currentStrokeWidth=nt(R.strokeWidth),X.ss(R.currentStrokeWidth)),this},this.noStroke=function(){return R.strokeColor=R.currentStrokeColor=null,R.strokeWidth=R.currentStrokeWidth=null,X.s(),X.ss(1),this},X.matrix=X.getMatrix(),this.translate=function(u,o){n(u)&&(u=0),n(o)&&(o=0),u=nt(u),o=nt(o);var S=X.matrix.transformPoint(u,o);return J=S.x,Z=S.y,X.mt(J,Z),X.matrix.translate(u,o),this},this.rotate=function(u){return n(u)&&(u=0),u=nt(u),X.matrix.rotate(u),this},this.scale=function(u,o){return n(u)&&(u=1),n(o)&&(o=u),u=nt(u),o=nt(o),X.matrix.scale(u,o),this},this.skew=function(u,o){return n(u)&&(u=0),n(o)&&(o=0),u=nt(u),o=nt(o),X.matrix.skew(u,o),this},A&&(R.linePoints=[]),this.line=function(u,o,S,F){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=0),n(F)&&(F=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),(A=="zero"||A=="nonzero"&&u&&o)&&R.linePoints.push([u,o]),R.translate(u,o);var p=X.matrix.transformPoint(S,F);return J=p.x,Z=p.y,X.lt(J,Z),A&&R.linePoints.push([J,Z]),X.matrix.translate(S,F),this},this.arc=function(u,o,S,F,p,L){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),u=nt(u),o=nt(o),S=nt(S),S=Math.abs(S),n(F)&&(F=0),n(p)&&(p=180),F=nt(F),p=nt(p),n(L)&&(L=!1),L=nt(L),R.translate(u,o);var we=X.matrix.transformPoint(0,0);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var D=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,N=X.decomp.rotation||0,ue=S*D;return X.mt(we.x+ue*Math.cos((F+N)*Math.PI/180),we.y+ue*Math.sin((F+N)*Math.PI/180)),X.a(we.x,we.y,ue,(F+N)*Math.PI/180,(p+N)*Math.PI/180,L),this},this.curve=function(u,o,S,F,p,L){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),n(F)&&(F=50),n(p)&&(p=100),n(L)&&(L=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),p=nt(p),L=nt(L),R.translate(u,o);var we=X.matrix.transformPoint(S,F),D=X.matrix.transformPoint(p,L),N=D.x,ue=D.y;return X.qt(we.x,we.y,N,ue),X.matrix.translate(p,L),this},this.bezier=function(u,o,S,F,p,L,we,D){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),n(F)&&(F=50),n(p)&&(p=-50),n(L)&&(L=-50),n(we)&&(we=100),n(D)&&(D=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),p=nt(p),L=nt(L),we=nt(we),D=nt(D),R.translate(u,o);var N=X.matrix.transformPoint(S,F),ue=X.matrix.transformPoint(p,L),fe=X.matrix.transformPoint(we,D),V=fe.x,z=fe.y;return X.bt(N.x,N.y,ue.x,ue.y,V,z),X.matrix.translate(we,D),this},this.rectangle=function(u,o,S,F,p,L,we,D){if(n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=100),n(F)&&(F=S),u=nt(u),o=nt(o),S=nt(S),F=nt(F),!p&&!L&&!we&&!D){R.translate(u,o);var N=X.matrix.transformPoint(0,0),ue=X.matrix.transformPoint(S,0),fe=X.matrix.transformPoint(S,F),V=X.matrix.transformPoint(0,F);return X.mt(N.x,N.y).lt(ue.x,ue.y).lt(fe.x,fe.y).lt(V.x,V.y).lt(N.x,N.y).lt(ue.x,ue.y),X.mt(N.x,N.y),this}n(p)&&(p=0),n(L)&&(L=p),n(we)&&(we=p),n(D)&&(D=p),p=nt(p),L=nt(L),we=nt(we),D=nt(D);var z=(S<F?S:F)/2,se=0,Oe=0,K=0,ge=0;z=Math.abs(z),p<0&&(p*=se=-1),p>z&&(p=z),L<0&&(L*=Oe=-1),L>z&&(L=z),we<0&&(we*=K=-1),we>z&&(we=z),D<0&&(D*=ge=-1),D>z&&(D=z),R.translate(u,o),X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var Q=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,ce=S<0?-1:1,G=F<0?-1:1,le=X.matrix.transformPoint(S-L*ce,0),Ae=X.matrix.transformPoint(S+L*Oe*ce,-L*Oe*G),re=X.matrix.transformPoint(S,L*G),xe=X.matrix.transformPoint(S,F-we*G),ke=X.matrix.transformPoint(S+we*K*ce,F+we*K*G),te=X.matrix.transformPoint(S-we*ce,F),pe=X.matrix.transformPoint(D*ce,F),he=X.matrix.transformPoint(-D*ge*ce,F+D*ge*G),ae=X.matrix.transformPoint(0,F-D*G),Ee=X.matrix.transformPoint(0,p*G),ie=X.matrix.transformPoint(-p*se*ce,-p*se*G),Se=X.matrix.transformPoint(p*ce,0);return X.mt(le.x,le.y).at(Ae.x,Ae.y,re.x,re.y,L*Q).lt(xe.x,xe.y).at(ke.x,ke.y,te.x,te.y,we*Q).lt(pe.x,pe.y).at(he.x,he.y,ae.x,ae.y,D*Q).lt(Ee.x,Ee.y).at(ie.x,ie.y,Se.x,Se.y,p*Q).cp(),this},this.circle=function(u,o,S,F,p){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=50),n(F)&&(F=100),n(p)&&(p=!0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),S=Math.abs(S),R.translate(u,o);var L=X.matrix.transformPoint(0,0);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var we=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,D=X.decomp.rotation||0,N=S*we;if(R.circleHeight=N*2,typeof F=="number"&&F>=0&&F<100){var ue=360*F/100/2;X.mt(L.x+N*Math.cos((-ue-90+D)*Math.PI/180),L.y+N*Math.sin((-ue-90+D)*Math.PI/180)),X.a(L.x,L.y,N,(-ue-90+D)*Math.PI/180,(ue-90+D)*Math.PI/180,!1),p&&X.cp(),R.circleHeight=N-Math.cos(ue*Math.PI/180)*N}else X.mt(L.x+N,L.y),X.a(L.x,L.y,N,0,Math.PI*2);return this},this.elipse=function(u,o,S,F){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=100),n(F)&&(F=50),u=nt(u),o=nt(o),S=nt(S),F=nt(F),R.translate(u,o);var p=X.matrix.transformPoint(-S/2,-F/2);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var L=X.decomp.scaleX,we=X.decomp.scaleY;return X.de(p.x,p.y,S*L,F*we),this},this.poly=function(u,o,S,F,p,L){n(u)&&(u=0),n(o)&&(o=0),n(S)&&(S=100),n(F)&&(F=5),n(p)&&(p=0),n(L)&&(L=0),u=nt(u),o=nt(o),S=nt(S),F=nt(F),p=nt(p),L=nt(L),S=Math.abs(S),R.translate(u,o);var we=X.matrix.transformPoint(0,0);X.decomp||(X.decomp={}),X.matrix.decompose(X.decomp);var D=(Math.abs(X.decomp.scaleX)+Math.abs(X.decomp.scaleY))/2,N=X.decomp.rotation||0,ue=S*D;return X.dp(we.x,we.y,ue,F,p,N),this},this.closePath=this.close=this.cp=function(){return X.cp(),this},this._noise=new t.Noise(h),this.noise=function(){if(arguments.length==1)return(this._noise.simplex1D.apply(null,arguments)+1)/2;if(arguments.length==2)return(this._noise.simplex2D.apply(null,arguments)+1)/2;if(arguments.length==3)return(this._noise.simplex3D.apply(null,arguments)+1)/2;if(arguments.length==4)return(this._noise.simplex4D.apply(null,arguments)+1)/2},this.stack=[],this.colorStrokeStack=[],this.push=function(){return R.stack.push(X.matrix.clone()),R.colorStrokeStack.push([R.color,R.strokeColor,R.strokeWidth,R.currentColor,R.currentStrokeColor,R.currentStrokeWidth]),this},this.pop=function(){X.matrix=R.stack.pop()||X.matrix;var u=R.colorStrokeStack.pop()||[R.color,R.strokeColor,R.strokeWidth,R.currentColor,R.currentStrokeColor,R.currentStrokeWidth];return R.color=u[0],R.strokeColor=u[1],R.strokeWidth=u[2],R.currentColor=u[3],R.currentStrokeColor=u[4],R.currentStrokeWidth=u[5],X.f(R.currentColor).s(R.currentStrokeColor).ss(R.currentStrokeWidth),X.mt(X.matrix.x,X.matrix.y),this},this.blit=function(){return X.updateCache("source-over"),X.c(),this},this.step=function(){return R.draw&&d(),this},n(R.color)||this.fill(R.color),!n(R.strokeColor)&&R.strokeWidth?this.stroke(R.strokeColor,R.strokeWidth):R.noStroke(),this.translate(J,Z),typeof s=="function"&&(this.setup=s,t.timeout(.01,function(){s(0,R.count,R),E&&X.updateCache(),$.update()}));var ne=0;this.maxCount=f,this.resetup=function(u){return n(u)&&(u=!0),ne=0,u&&R.shape.c(),n(R.color)||this.fill(R.color),!n(R.strokeColor)&&R.strokeWidth?this.stroke(R.strokeColor,R.strokeWidth):R.noStroke(),this.reset(),this.setup&&(s(0,R.count,R),E&&X.updateCache(),$.update()),this},this.stampNum=0,typeof a=="function"&&(this.stamp=a,t.timeout(.015,function(){B(0)})),this.restamp=function(u,o){return n(u)&&(u=!0),n(o)&&(o=!0),ne=0,u&&R.shape.c(),o&&R.resetup(u),B(0),this},this.reset=function(){return this.fill(e),!n(r)&&i?this.stroke(r,i):this.noStroke(),X.matrix.identity(),this.translate(g,b),this},this.clear=function(){return this.shape.c(),this};function U(){q.save({content:$,filename:R.outputName+t.decimals(R.outputNum,null,null,6),type:P}),R.outputNum++}w&&($.update(),U());function B(u){R.stampNum++;var o=t.loop(R.maxCount,function(S,F){if(R.paused)return R.pausedCount=S,!1;if(R.changeCount)return R.changeCount=!1,!1;ne=S+1;var p=a(S+1,F,R,R.stampNum);if(R.currentColor=nt(R.color),X.f(R.currentColor),R.currentStrokeColor=nt(R.strokeColor),X.s(R.currentStrokeColor),R.currentStrokeWidth=nt(R.strokeWidth),X.ss(R.currentStrokeWidth),w&&($.update(),U()),p)return p},null,null,u);E&&X.updateCache(),o&&R.dispatchEvent("complete"),$.update()}R.iterator=0,typeof l=="function"&&(this.draw=l,s?setTimeout(function(){R.ticker=t.Ticker.add(d)},100):this.ticker=t.Ticker.add(d),R.generatorPaused=!1,k&&(R.pauseEvent=$.on("stagemousedown",function(){R.count>=R.maxCount||R.pauseTimeout||(t.Ticker.has(R.ticker)?(t.Ticker.remove(R.ticker),R.generatorPaused=!0,R.dispatchEvent("generatorpaused")):(R.ticker=t.Ticker.add(R.ticker),R.generatorPaused=!1,R.dispatchEvent("generatorunpaused")))})),v&&(R.pauseSpacebarEvent=T.on("keydown",function(u){R.count>=R.maxCount||R.pauseTimeout||u.keyCode==20&&(t.Ticker.has(R.ticker)?(t.Ticker.remove(R.ticker),R.generatorPaused=!0,R.dispatchEvent("generatorpaused")):(R.ticker=t.Ticker.add(R.ticker),R.generatorPaused=!1,R.dispatchEvent("generatorunpaused")))})));function d(){R.iterator++,R.iterator%Math.ceil(R.drawCount)==0&&(R.count++,R.draw(R.count,R.maxCount,R),E&&R.blit(),R.currentColor=nt(R.color),X.f(R.currentColor),R.currentStrokeColor=nt(R.strokeColor),X.s(R.currentStrokeColor),R.currentStrokeWidth=nt(R.strokeWidth),X.ss(R.currentStrokeWidth),R.dispatchEvent("drawing"),$.update(),w&&U()),R.maxCount&&R.count>=R.maxCount&&(R.dispatchEvent("complete"),t.Ticker.remove(R.ticker))}this.redraw=function(u,o){return n(u)&&(u=!0),R.reset(),n(o)&&(o=!0),R.ticker&&t.Ticker.remove(R.ticker),R.iterator=0,R.count=0,u&&R.shape.c(),o?(R.resetup(u),setTimeout(function(){R.ticker&&(R.ticker=t.Ticker.add(R.ticker))},100)):R.ticker&&(R.ticker=t.Ticker.add(R.ticker)),this},this.paused=!1,this.pause=function(u,o){if(n(u)&&(u=!0),!(R.count>=R.maxCount)){if(u==this.paused)return this;this.paused=u,this.pauseTimeout&&this.pauseTimeout.clear(),this.paused?R.ticker&&t.Ticker.remove(R.ticker):R.ticker?R.ticker=t.Ticker.add(R.ticker):B(R.pausedCount,R.maxCount),setTimeout(function(){$.update()},20),o&&(this.pauseTimeout=t.timeout(o,function(){R.pause(!R.paused),R.pauseTimeout=null})),R.dispatchEvent(R.paused?"paused":"unpaused")}},this.outOfBounds=function(u,o){n(u)&&(u=0),n(o)&&(o=u);var S=R.shape.stage;if(S)return R.currentX>S.width-u||R.currentX<0+u||R.currentY>S.height-o||R.currentY<0+o},this.stop=function(){R.pause(),R.pauseEvent&&$.off("stagemousedown",R.pauseEvent),R.pauseSpaceEvent&&T.off("keydown",R.pauseSpaceEvent)},Object.defineProperty(this,"count",{get:function(){return ne},set:function(u){ne=u,R.stamp&&(R.changeCount=!0,setTimeout(function(){B(ne,R.maxCount)}))}}),Object.defineProperty(this,"currentX",{get:function(){return J},set:function(){pt&&tt("Generator() - currentX is read only")}}),Object.defineProperty(this,"currentY",{get:function(){return Z},set:function(){pt&&tt("Generator() - currentY is read only")}}),this.clone=function(){return R.cloneProps(new t.Generator(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,y,R.group,O))},R.dispose=function(u,o,S){return R.pause(),R.ticker&&t.Ticker.remove(R.ticker),R.pauseEvent&&$.off("stagemousedown",R.pauseEvent),R.pauseSpacebarEvent&&T.off("keydown",R.pauseSpacebarEvent),R._noise&&(R._noise=null),R.shape&&R.shape.dispose(),R.drawing&&R.drawing.dispose(),R.shape=R.drawing=null,S||R.zimContainer_dispose(),!0},y!==!1&&t.styleTransforms(this,m)},t.extend(t.Generator,t.Container,["clone","dispose"],"zimContainer",!1),t.Pen=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q){var J="size, color, penType, damp, spread, borderColor, borderWidth, end, paper, nib, cache, ctrlKey, cropScale, undo, undoKeys, move, onTop, deleteable, doubleClickDelete, holdDelete, immediateStop, lineAlpha, lineBlendMode, frame, dashed, pullColor, pullThickness, style, group, inherit",Z;if(Z=st(t.Pen,arguments,J,this))return Z;De("69.93"),this.zimContainer_constructor(),this.type="Pen",this.group=R;var ne=X===!1?{}:t.getStyle(this.type,this.group,q);n(i)&&(i=ne.penType!=null?ne.penType:"line");var U={size:2,color:t.dark,spread:{min:5,max:20},borderColor:t.darker,borderWidth:0},B={line:{size:2},kitetail:{size:{min:5,max:20},color:t.series(t.pink,t.blue,t.green),borderColor:"rgba(0,0,0,.5)",borderWidth:1},grass:{color:t.green,size:3,spread:{min:10,max:30}},hair:{color:[t.pink,t.blue],size:3,spread:{min:20,max:50}},city:{size:{min:30,max:70},spread:{min:50,max:200},color:[t.dark,t.darker,t.grey]},barbwire:{},splatter:{size:{min:5,max:20},color:"rgba(0,0,0,.5)"}};n(B[i])&&(i="line"),n(e)&&(e=ne.size!=null?ne.size:n(B[i].size)?U.size:B[i].size),n(r)&&(r=ne.color!=null?ne.color:n(B[i].color)?U.color:B[i].color),n(l)&&(l=ne.damp!=null?ne.damp:.5),l===!1&&(l=1),n(a)&&(a=ne.spread!=null?ne.spread:n(B[i].spread)?U.spread:B[i].spread),n(s)&&(s=ne.borderColor!=null?ne.borderColor:n(B[i].borderColor)?U.borderColor:B[i].borderColor),n(f)&&(f=ne.borderWidth!=null?ne.borderWidth:n(B[i].borderWidth)?U.borderWidth:B[i].borderWidth),n(c)&&(c=ne.end!=null?ne.end:t.isPick(e)||t.isPick(r)||i!="line"?"butt":"round"),n(b)&&(b=ne.cropScale!=null?ne.cropScale:1),n(v)&&(v=ne.cache!=null?ne.cache:!0),n(E)&&(E=ne.undo!=null?ne.undo:0),n(A)&&(A=ne.undoKeys!=null?ne.undoKeys:!0),n(T)&&(T=ne.move!=null?ne.move:!0),n(w)&&(w=ne.deleteable!=null?ne.deleteable:!0),n(P)&&(P=ne.doubleClickDelete!=null?ne.doubleClickDelete:!0),n(y)&&(y=ne.holdDelete!=null?ne.holdDelete:!0),n(h)&&(h=ne.onTop!=null?ne.onTop:!0),n(C)&&(C=ne.immediateStop!=null?ne.immediateStop:"both"),n(O)&&(O=ne.lineAlpha!=null?ne.lineAlpha:1),n(_)&&(_=ne.lineBlendMode!=null?ne.lineBlendMode:"normal"),n(x)&&(x=ne.paper!=null?ne.paper:new t.Container),n(k)&&(k=ne.nib!=null?ne.nib.clone():null),n(Y)&&(Y=ne.frame!=null?ne.frame:j.zdf),n(m)&&(m=ne.dashed!=null?ne.dashed:null),m===!0&&(m=[3,100]),n($)&&($=ne.pullColor!=null?ne.pullColor:null),n(I)&&(I=ne.pullThickness!=null?ne.pullThickness:1);var d=this;this.dampX=new t.Damp(null,l),this.dampY=new t.Damp(null,l);var u=!0;this.drawing=!1,this.immediateStop=C,this.undoLevels=E,this.undoKeys=A,this.move=T,this.draggable=!0,this.lineAlpha=O,this.lineBlendMode=_;var o=d.shape=new t.Shape,S=Y.stage.width,F=Y.stage.height,p,L,we,D;d.paperNum=0,d.sizeScale=1,d.spreadScale=1,d.sizeFactor=1,d.spreadFactor=1,d.pullThickness=I,d.stop=function(){};var N;this.added(function(Q){N=Q,d.paper=x,S=d.stage.width,F=d.stage.height,n(k)?d.stageDown=N.on("stagemousedown",function(re){d.dispatchEvent("start")}):d.zimDown?d.nib=k.addTo(d):(d.nib=k.addTo(d.parent,d.parent.getChildIndex(d)),d.nib.x=d.x,d.nib.y=d.y,d.nib.mouseEnabled=!1,d.stageDown=N.on("stagemousedown",function(re){N=re.target.stage,d.nibEvent=N.on("stagemousemove",ce),d.dispatchEvent("start")}),d.stageUp=N.on("stagemouseup",function(){N.off("stagemousemove",d.nibEvent)}));function ce(re){d.drawing&&(d.nib.x=re.stageX/t.scaX,d.nib.y=re.stageY/t.scaY)}d.zimDragCheck=!1,d.stop=function(){d.stopCheck(!0)},d.infinite=!1,d.stopCheck=function(re){if(re)d.drawing=!1,d.infinite=!1;else if(d.infinite||d.zimDragCheck||!d.immediateStop&&d.drawing)return;d.immediate(d.x,d.y),setTimeout(function(){var xe;if(!d.drawing){if(v?(o.cache(-(S*b-S)/2,-(F*b-F)/2,S*b,F*b),xe=x.bitmap=new t.Bitmap(o.cacheCanvas).reg((S*b-S)/2,(F*b-F)/2).addTo(x),o.graphics.clear(),o.uncache(),o.top()):xe=o,d.undoLevels>0){var ke={paper:x,line:xe};E.push(ke),E.length>d.undoLevels&&E.shift(),d.dispatchEvent("recordUndo")}v||(o=new t.Shape().clone().addTo(x)),d.lastSegment=xe,d.lastSelected=xe,xe.alpha=d.lineAlpha,xe.blendMode=d.lineBlendMode,xe.paper=x,d.dispatchEvent("stop"),d.dispatchEvent("change")}},d.immediateStop||re?0:50)};var G=0;d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.drawX=d.x,d.lastY=d.lastMidY=d.drawY=d.y;var le,Ae;d.ticker=t.Ticker.add(function(){if(d.parent){var re=d.dampX.convert(u?d.x:d.finishX),xe=d.dampY.convert(u?d.y:d.finishY),ke=d.parent.localToLocal(re,xe,o);if(Math.abs(d.lastX-re)+Math.abs(d.lastY-xe)<1){if(d.drawing&&(d.drawing=!1,d.zimDown?(d.x=d.lastX=d.lastMidX=u?d.x:d.finishX,d.y=d.lastY=d.lastMidY=u?d.y:d.finishY):(d.x=d.finishX=d.lastX=d.lastMidX=re,d.y=d.finishY=d.lastY=d.lastMidY=xe),d.stopCheck(),le=Ae=null),d.lastX=d.lastMidX=re,d.lastY=d.lastMidY=xe,x){var te=x.localToLocal(0,0,d.parent);d.lastMidX-=te.x,d.lastMidY-=te.y}return}else{var pe=t.Pick.choose(e)*d.sizeScale*d.sizeFactor,he=t.Pick.choose(a)*d.spreadScale*d.spreadFactor;d.drawing||(V=[],x.getChildIndex(o)!=x.numChildren-1&&o.top()),d.drawing=!0,d.dispatchEvent("drawing")}var ae=d.parent.localToLocal(d.lastX,d.lastY,o),Ee;x?Ee=x.localToLocal(d.lastMidX,d.lastMidY,o):Ee=d.parent.localToLocal(d.lastMidX,d.lastMidY,o);var ie,Se,Le;if(i=="splatter")for(var Ce=0;Ce<=3;Ce++){var ee=t.rand(360)*Math.PI/180,Me=he,_e={x:re+Me*Math.cos(ee),y:xe+Me*Math.sin(ee)},Ye=d.parent.localToLocal(_e.x,_e.y,o);o.graphics.mt(Ye.x,Ye.y).f(t.Pick.choose(r)).dc(Ye.x,Ye.y,pe/2)}else i=="grass"||i=="hair"||i=="city"?((i=="grass"||i=="hair")&&(ie=d.lastX+(re-d.lastX)/2,Se=d.lastY+(xe-d.lastY)/2,Le=d.parent.localToLocal(ie,Se,o),o.graphics.s(t.Pick.choose(r)).ss(pe,c).mt(Le.x,Le.y).lt(Le.x+t.rand(-he/4,he/4),i=="hair"?Le.y+he:Le.y-he)),(i=="grass"||i=="hair"||i=="city"&&G%3==0)&&o.graphics.s(t.Pick.choose(r)).ss(pe,c).mt(ke.x,ke.y).lt(ke.x+(i=="city"?0:t.rand(-he/4,he/4)),i=="hair"?Le.y+he:ke.y-he),G++):(i=="kitetail"&&o.graphics.s(t.Pick.choose(r)).ss(pe,c),i=="barbwire"?(o.graphics.s(t.Pick.choose(r)).ss(pe,c),ie=d.lastX+(re-d.lastX)/2+t.rand(-he,he),Se=d.lastY+(xe-d.lastY)/2+t.rand(-he,he)):(ie=d.lastX+(re-d.lastX)/2,Se=d.lastY+(xe-d.lastY)/2),Le=d.parent.localToLocal(ie,Se,o),i!="line"&&o.graphics.qt(ae.x,ae.y,Le.x,Le.y));if(f>0&&i!="line"&&(ie=d.lastX+(re-d.lastX)/2,Se=d.lastY+(xe-d.lastY)/2,Le=d.parent.localToLocal(ie,Se,o),o.graphics.s(t.Pick.choose(s)).ss(t.Pick.choose(f)).mt(Ee.x,Ee.y).qt(ae.x,ae.y,Le.x,Le.y),i=="splatter"&&o.graphics.es()),i=="splatter")o.graphics.f(t.Pick.choose(r));else if(i!="kitetail")if(i=="line"){if(t.isPick(r)||pe!=Ae){var je=t.Pick.choose(r);(je!=le||pe!=Ae)&&o.graphics.s(je).ss(pe,c),le=je,Ae=pe}}else o.graphics.s(t.Pick.choose(r)).ss(pe,c);i!="grass"&&i!="hair"&&i!="city"&&i!="splatter"&&o.graphics.mt(Ee.x,Ee.y).qt(ae.x,ae.y,Le.x,Le.y),m&&o.graphics.sd(m),d.lastX=re,d.lastY=xe,Le&&(d.lastMidX=Le.x,d.lastMidY=Le.y),d.drawX=d.lastMidX||0,d.drawY=d.lastMidY||0}}),n($)||ue(N),d.mouseChildren=!1});function ue(Q){var ce=Q.frame;d.ppdEvent&&d.off("drawing",d.ppdEvent),d.ppsEvent&&d.off("stop",d.ppsEvent),d.ppmEvent&&Q.off("stagemousedown",d.ppmEvent),d.pullShape||(d.pullShape=new t.Shape),d.ppdEvent=d.on("drawing",function(){setTimeout(function(){var G=x.localToGlobal(d.drawX,d.drawY);d.pullShape.c().s($).ss(d.pullThickness).mt(ce.mouseX,ce.mouseY).lt(G.x,G.y)},10)}),d.ppsEvent=d.on("stop",function(){d.pullShape.removeFrom(),d.pullShape.c()}),d.ppmEvent=Q.on("stagemousedown",function(){d.pullShape.addTo(Q),d.immediate(ce.mouseX,ce.mouseY),d.motionController&&d.motionController.immediate(ce.mouseX,ce.mouseY)})}function fe(){d.ppdEvent&&d.off("drawing",d.ppdEvent),d.ppsEvent&&d.off("stop",d.ppsEvent),d.ppmEvent&&d.off("stagemousedown",d.ppmEvent),d.pullShape&&d.pullShape.dispose()}E=[];var V=[];this.saveState=function(Q,ce,G){var le=Q.type=="Container"?"paper":"line",Ae={paper:d.paper};Ae[le]=Q,Ae[le+"Transform"]={x:Q.x,y:Q.y,r:Q.rotation,a:Q.alpha,rX:Q.regX,rY:Q.regY,sX:Q.scaleX,sY:Q.scaleY,skX:Q.skewX,skY:Q.skewY,v:Q.visible},!n(ce)&&!n(G)&&ce!=G&&(Ae.startLayer=ce,Ae.endLayer=G),E.push(Ae),d.dispatchEvent("recordUndo"),E.length>d.undoLevels&&E.shift()};var z={x:0,y:0,r:0,a:1,rX:0,rY:0,sX:1,sY:1,skX:0,skY:0,v:!0};this.undo=function(){var Q=E.pop();if(Q){if(V.push(Q),Q.clear){for(var ce=0;ce<Q.clear.length;ce++)Q.paper.addChild(Q.clear[ce]);Q.paper.addChild(o)}else Q.line&&Q.lineTransform?(n(Q.startLayer)||(o.top(),Q.paper.setChildIndex(Q.line,we)),se("line",Q.line)):Q.line?Q.line.removeFrom():Q.paperTransform&&se("paper",Q.paper);d.lastPaper=d.paper,Q.paper!=d.paper&&(d.paper=Q.paper,d.dispatchEvent("paperChange")),d.dispatchEvent("change"),d.dispatchEvent("undo"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&d.stage&&d.stage.update()}};function se(Q,ce){for(var G,le=E.length-1;le>=0;le--)if(E[le][Q]==ce&&E[le][Q+"Transform"]){G=E[le][Q+"Transform"];break}G||(G=t.copy(z)),ce.x=G.x,ce.y=G.y,ce.alpha=G.a,ce.rotation=G.r,ce.regX=G.rX,ce.regY=G.rY,ce.scaleX=G.sX,ce.scaleY=G.sY,ce.skewX=G.skX,ce.skewY=G.skY,ce.visible=G.v,Q=="line"&&v&&(ce.regX=(S*b-S)/2,ce.regY=(F*b-F)/2)}this.redo=function(){var Q=V.pop(),ce,G;Q&&(E.push(Q),Q.clear?(Q.paper.removeAllChildren(),Q.paper.addChild(o)):Q.line&&Q.lineTransform?(n(Q.endLayer)||(o.top(),Q.paper.setChildIndex(Q.line,D)),G=Q.lineTransform,ce=Q.line):Q.line?Q.line.addTo(Q.paper):Q.paperTransform&&(G=Q.paperTransform,ce=Q.paper),ce&&(ce.x=G.x,ce.y=G.y,ce.alpha=G.a,ce.rotation=G.r,ce.regX=G.rX,ce.regY=G.rY,ce.scaleX=G.sX,ce.scaleY=G.sY,ce.skewX=G.skX,ce.skewY=G.skY,ce.visible=G.v),d.lastPaper=d.paper,Q.paper!=d.paper&&(d.paper=Q.paper,d.dispatchEvent("paperChange")),d.dispatchEvent("change"),d.dispatchEvent("redo"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&d.stage&&d.stage.update())},d.ctrlKey=!1,d.shiftKey=!1,d.ctrlKeyCheck=!1,d.zimkeydownEvent=function(Q){d.ctrlKey=Q.ctrlKey,d.shiftKey=Q.shiftKey,Q.keyCode==17&&T&&!d.ctrlKeyCheck&&(d.ctrlKeyCheck=!0,x.noDrag(),x.drag({onTop:h,all:!0})),!(d.undoLevels<=0)&&d.undoKeys&&(Q.ctrlKey&&(Q.shiftKey&&Q.keyCode==90||Q.keyCode==89)?d.redo():Q.ctrlKey&&Q.keyCode==90&&d.undo(),Y&&Y.ctrlKey&&d.write&&(d.lastWrite=d.write,d.write=!1))},j.addEventListener("keydown",d.zimkeydownEvent),d.zimkeyupEvent=function(Q){Q.keyCode==17&&T&&d.ctrlKeyCheck&&(d.ctrlKeyCheck=!1,x.noDrag(),x.drag({onTop:h})),Q.ctrlKey||(d.ctrlKey=!1),Q.shiftKey||(d.shiftKey=!1),Y&&!Y.ctrlKey&&d.write==!1&&(d.write=d.lastWrite)},j.addEventListener("keyup",d.zimkeyupEvent),Object.defineProperty(this,"paper",{get:function(){return x},set:function(Q){Q.type=="Container"&&(x=Q,o.addTo(x,0,!1),x.shape=o,d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.finishX=d.x,d.lastY=d.lastMidY=d.finishY=d.y,i=="barbwire"&&o.graphics.s(t.Pick.choose(r)).ss(t.Pick.choose(e)*d.sizeScale*d.sizeFactor,c),o.graphics.mt(d.x,d.y),x.parent||x.addTo(d.parent,d.parent.getChildIndex(d)),n(x.paperNum)&&(x.paperNum=++d.paperNum,w&&x.on("mousedown",function(ce){d.lastSelected=ce.target,d.nibEvent&&d.stage.off("stagemousemove",d.nibEvent);var G=ce.target.paper;G&&(G!=d.paper&&(d.paper=G,d.dispatchEvent("paperChange")),d.shiftKey&&(d.ctrlKey?d.clear():(ce.target.visible=!1,d.undoLevels>0&&d.saveState(ce.target),d.dispatchEvent("change"))))}),P&&x.on("dblclick",function(ce){ce.target.visible=!1,d.undoLevels>0&&d.saveState(ce.target)}),P&&x.hold(function(ce){ce.target.visible=!1,d.undoLevels>0&&d.saveState(ce.target)}),T&&(x.on("mousedown",function(ce){N=ce.target.stage,d.draggingCheck=!0,!(d.shiftKey&&w)&&(p=ce.stageX/t.scaX,L=ce.stageY/t.scaY,o.top(),we=x.getChildIndex(ce.target))}),x.drag({onTop:h}),x.on("pressup",function(ce){if(!(w&&d.shiftKey)&&ce.target.visible!=!1&&!(d.undoLevels<=0)){if(Math.abs(ce.stageX/t.scaX-p)<1&&Math.abs(ce.stageY/t.scaY-L)<1){h&&(o.top(),D=x.getChildIndex(ce.target),we!=D&&d.saveState(ce.target,we,D));return}d.ctrlKey?(d.saveState(x),d.dispatchEvent("paperChange")):(o.top(),D=x.getChildIndex(ce.target),d.saveState(ce.target,we,D)),d.dispatchEvent("change"),o.top()}}))))}}),Object.defineProperty(this,"write",{get:function(){return u},set:function(Q){u&&Q===!1&&(d.finishX=d.x,d.finishY=d.y),!u&&Q&&(o.graphics.es(),o.graphics.ef(),d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.x,d.lastY=d.lastMidY=d.y),u=Q}}),Object.defineProperty(this,"size",{get:function(){return e},set:function(Q){o.graphics.es(),o.graphics.ef(),e=Q,i!="splatter"&&o.graphics.ss(t.Pick.choose(e)*d.sizeScale*d.sizeFactor,c)}}),Object.defineProperty(this,"color",{get:function(){return r},set:function(Q){r=Q,o.graphics.es(),o.graphics.ef(),i!="splatter"&&o.graphics.s(t.Pick.choose(r))}}),Object.defineProperty(this,"penType",{get:function(){return i},set:function(Q){i=Q,o.graphics.ef().es(),i!="splatter"?o.graphics.s(t.Pick.choose(r)):o.graphics.s(t.Pick.choose(r)).ss(t.Pick.choose(e)*d.sizeScale*d.sizeFactor,c)}}),Object.defineProperty(this,"end",{get:function(){return c},set:function(Q){c=Q}}),Object.defineProperty(this,"damp",{get:function(){return l},set:function(Q){l=Q,d.dampX.damp=l,d.dampY.damp=l}}),Object.defineProperty(this,"spread",{get:function(){return a},set:function(Q){a=Q}});var Oe,K;this.setColorRange=function(Q,ce){return n(ce)?(Oe=d.color,K=Q):n(Q)?(Oe=d.color,K=ce):(Oe=Q,K=ce),d};var ge=0;Object.defineProperty(d,"colorRange",{get:function(){return ge},set:function(Q){ge=Q,!n(Oe)&&!n(K)&&(d.color=t.colorRange(Oe,K,Q))}}),Object.defineProperty(this,"borderColor",{get:function(){return s},set:function(Q){s=Q}}),Object.defineProperty(this,"borderWidth",{get:function(){return f},set:function(Q){f=Q}}),Object.defineProperty(this,"pullColor",{get:function(){return $},set:function(Q){if(n(Q||Q==-1))fe(),$=null;else if(n($)){$=Q;var ce=N||zdf.stage;ue(ce)}else $=Q}}),d.setPen=function(Q){d.dampX.immediate(d.x),d.dampY.immediate(d.y),d.lastX=d.lastMidX=d.finishX=d.x,d.lastY=d.lastMidY=d.finishY=d.y,n(Q)&&(Q=i),n(B[Q])&&(Q="line"),d.penType=i=Q;var ce=t.merge(U,B[Q]);for(var G in ce)d[G]!=ce[G]&&(d[G]=ce[G]);return d},d.immediate=function(Q,ce){return n(Q)||(d.x=Q,d.dampX.immediate(d.x),d.lastX=d.lastMidX=d.finishX=d.x),n(ce)||(d.y=ce,d.dampY.immediate(d.y),d.lastY=d.lastMidY=d.finishY=d.y),d},d.clear=function(){for(var Q=[],ce=0;ce<x.numChildren-1;ce++)Q.push(x.getChildAt(ce));return E.push({paper:x,clear:Q}),E.length>d.undoLevels&&E.shift(),d.dispatchEvent("recordUndo"),x.removeAllChildren(),o.graphics.clear(),x.addChild(o),d.dispatchEvent("change"),d.stage&&d.stage.update(),d},this.deleteSegment=function(Q){Q.visible=!1,d.undoLevels>0&&d.saveState(Q)},this.clone=function(){return this.cloneChildren(this.cloneProps(new t.Pen(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q)))},d.dispose=function(Q,ce,G){return n(Q)&&(Q=!0),j.removeEventListener("keydown",d.zimkeydownEvent),j.removeEventListener("keyup",d.zimkeyupEvent),N&&d.nibEvent&&N.off("stagemousemove",d.nibEvent),N&&d.stageDown&&N.off("stagemousedown",d.stageDown),N&&d.stageUp&&N.off("stagemouseup",d.stageUp),N&&d.upEvent&&N.off("stagemouseup",d.upEvent),t.Ticker.remove(d.ticker),d.removeAllEventListeners(),k&&k.removeFrom(),Q&&(d.shape&&d.shape.dispose(),d.paper&&d.paper.dispose(),v&&(d.bitmap&&d.bitmap.dispose(),d.bitmap=null),d.zimContainer_dispose(G),x=o=d.shape=null),!0},X!==!1&&t.styleTransforms(this,ne)},t.extend(t.Pen,t.Container,["dispose","clone"],"zimContainer",!1),t.SoundWave=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="num, input, include, smoothing, min, max, operation, baseline, magnify, reduce, adjust, channel",E;if(E=st(t.SoundWave,arguments,b,this))return E;De("69.95"),this.type="SoundWave",n(e)&&(e=120),n(r)&&(r="mic"),n(i)&&(i=120/1024),n(l)&&(l=.85),n(a)&&(a=r=="mic"?-80:(r.oscillator,-100)),n(s)&&(s=r=="mic"?-40:(r.oscillator,-10)),n(f)&&(f=function(O,_){return O*(.5+_*1/Math.pow(t.SoundWave.bufferLength,.95))}),n(c)&&(c=r=="mic"?0:(r.oscillator,30)),n(x)&&(x=r=="mic"?1:r.oscillator?5:10),n(k)&&(k=0),n(v)&&(v=5),t.SoundWave.bufferLength=1024;var A=e,T=this;T.baseline=c,T.magnify=x,T.reduce=k,T.input=r,T.adjust=v;var h;r.type=="Tone"||r.type=="SynthSound"?h=r.audioContext:h=new(j.AudioContext||j.webkitAudioContext);var w=T.analyser=h.createAnalyser();w.minDecibels=a,w.maxDecibels=s,w.smoothingTimeConstant=l,Object.defineProperty(this,"smoothing",{get:function(){return w.smoothingTimeConstant},set:function(O){w.smoothingTimeConstant=O}}),Object.defineProperty(this,"num",{get:function(){return A},set:function(O){A=O,P=Math.floor(i*t.SoundWave.bufferLength/A),P<1&&tt("ZIM SoundWave: num is too big")}}),this.setInput=function(O){if(T.input=O,O=="mic"){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then(function(m){var $=T.source=h.createMediaStreamSource(m);C($)}).catch(function(m){tt("ZIM SoundWave: Error occured: "+m)}):navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(m){var $=T.source=h.createMediaStreamSource(m);C($)},function(m){tt("ZIM SoundWave: Error occured: "+m)}):tt("ZIM SoundWave: Sorry, mic not supported");return}else if(O.type=="Tone")C(O.compressor);else if(O.type=="SynthSound")C(O.gain);else{if(O.type&&O.type=="sound"){tt("ZIM SoundWave: pass in the result of a zim.asset('somesound').play() for the input");return}var _,Y;O.playbackResource?(_=O.playbackResource,Y=h.createMediaElementSource(_)):(_=O,Y=h.createMediaElementSource(_)),C(Y)}},this.setInput(r);var P,y;function C(O){if(y&&y.disconnect(w),y=O,n(g)||g!==0&&g!==1)O.connect(w),r!="mic"&&w.connect(h.destination);else{var _=new ChannelSplitterNode(h,{numberOfOutputs:2});O.connect(_),_.connect(w,g);var Y=new ChannelMergerNode(h,{numberOfInputs:2});w.connect(Y,0,g),r!="mic"&&Y.connect(h.destination)}if(w.fftSize=t.SoundWave.bufferLength*2,P=Math.floor(i*t.SoundWave.bufferLength/A),P<1){tt("ZIM SoundWave: include param is too small or num param is too big");return}var m=w.frequencyBinCount,$=new Uint8Array(m),I=300,X=0,R=0,q=Math.round(60*T.adjust*.8),J=new t.Damp(I,.01);T.calculate=function(Z){n(Z)&&(Z=!0),w.getByteFrequencyData($);var ne=$.map(f);if(P==1&&!Z)return ne;var U=[],B=0,d;for(d=0;d<=i*t.SoundWave.bufferLength;d++)B+=ne[d],d!=0&&d%P==0&&(U.push(Math.max(0,(B/P-T.baseline)*T.magnify-T.reduce)),B=0);var u=U.length;if(r!="mic"&&(U[0]*=.75,U[1]*=.85,U[2]*=.9,U[u-2]*=.8,U[u-1]*=.75),U[u-1]*=1.3,U[u-2]*=1.2,U[u-3]*=1.1,Z){var o=[];q++,q>=60*T.adjust&&(I=X/q,X=0,R=0,q=0);var S=J.convert(I);for(d=0;d<u;d++)U[d]>R&&(R=U[d]),o[d]=Math.min(1,S!=0?U[d]/S:0);return X+=R,o}return U},setTimeout(function(){T.dispatchEvent("ready")},50)}this.dispose=function(O){return O&&h&&h.close(),w&&w.disconnect(),!0}},t.extend(t.SoundWave,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),t.Synth=function(e,r){De("69.955"),this.type="Synth",n(e)&&(e=.3),n(r)&&(r=220),this.volume=e,this.frequency=r;var i=this,l;this.play=function(a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge){var Q=Array.prototype.slice.call(arguments);if(Q=Q.shift(),!l&&(j.AudioContext||j.webkitAudioContext)&&(l=new(j.AudioContext||j.webkitAudioContext),l.z=l.createBufferSource,l.createBufferSource=function(le){return le==null&&(le=l.z()),le.start=le.start||function(Ae){l.noteOn(Ae)},le}),!!l){for(a=a!=null?nt(a):0,s=s!=null?nt(s):.3,f=f!=null?nt(f):.05,c=c!=null?nt(c):220,x=x!=null?nt(x):0,k=k!=null?nt(k):0,v=v!=null?nt(v):.1,g=g!=null?nt(g):0,b=b!=null?nt(b):1,E=E!=null?nt(E):0,A=A!=null?nt(A):0,T=T!=null?nt(T):0,h=h!=null?nt(h):0,w=w!=null?nt(w):0,P=P!=null?nt(P):0,y=y!=null?nt(y):0,C=C!=null?nt(C):0,O=O!=null?nt(O):0,m=m!=null?nt(m):0,_=_!=null?nt(_):1,Y=Y!=null?nt(Y):0,Z=Z!=null?nt(Z):44100,ne==null&&(ne=99+x*Z),U==null&&(U=k*Z),B==null&&(B=v*Z),d==null&&(d=Y*Z),u==null&&(u=O*Z),o==null&&(o=Math.PI*2),S==null&&(S=function(le){return le>0?1:-1}),F==null&&(F=ne+d+U+B+u),p==null&&(p=E*=500*o/Math.pow(Z,2)),L==null&&(L=c*=(1+f*2*Math.random()-f)*o/Z),we==null&&(we=S(y)*o/4),D==null&&(D=0),N==null&&(N=0),ue==null&&(ue=0),fe==null&&(fe=0),V==null&&(V=0),z==null&&(z=0),se==null&&(se=1),Oe==null&&(Oe=[]),K==null&&(K=l.createBufferSource()),ge==null&&(ge=l.createBuffer(1,F,Z)),K.connect(l.destination);ue<Math.floor(F);Oe[ue++]=z)++V>C*100&&(V=0,z=D*c*Math.sin(N*y*o/Z-we),z=g?g>1?g>2?g>3?Math.sin(Math.pow(z%o,3)):Math.max(Math.min(Math.tan(z),1),-1):1-(2*z/o%2+2)%2:1-4*Math.abs(Math.round(z/o)-z/o):Math.sin(z),z=(w?1-m+m*Math.sin(o*ue/w):1)*S(z)*Math.pow(Math.abs(z),b)*s*i.volume*(ue<ne?ue/ne:ue<ne+d?1-(ue-ne)/d*(1-_):ue<ne+d+U?_:ue<F-u?(F-ue-u)/B*_:0),z=u?z/2+(u>ue?0:(ue<F-u?1:(ue-F)/u)*Oe[ue-u|0]/2):z),D+=1-P+(Math.sin(ue)+1)*1e9%2*P,N+=1-P+(Math.pow(Math.sin(ue),2)+1)*1e9%2*P,c+=E+=A*500*o/Math.pow(Z,3),se&&++se>h*Z&&(c+=T*o/Z,L+=T*o/Z,se=0),w&&++fe>w*Z&&(c=L,E=p,fe=1,se=se||1);ge.getChannelData(0).set(Oe),K.buffer=ge;var ce=new Ge.EventDispatcher;ce.type="SynthSound",ce.audioContext=l,ce.gain=l.createGain(),K.connect(ce.gain),ce.gain.connect(l.destination),ce.pan=l.createStereoPanner(),ce.pan.pan.value=a,K.connect(ce.pan),ce.pan.connect(l.destination),K.start(),ce.duration=Oe.length/Z,ce.playing=!0,ce.stop=function(){clearTimeout(ce.completeID),clearInterval(ce.repeatID),ce.gain.gain.setTargetAtTime(0,l.currentTime,.1),ce.playing=!1,setTimeout(function(){l.close()},.1*1e3)};var G;return ce.repeat=ce.loop=function(le,Ae){G=0,le===!0&&(le=null),n(Ae)&&(Ae=0),clearTimeout(ce.completeID);function re(){return ce.duration+nt(Ae)}return ce.repeatID=t.interval(re,function(){G++,le&&G>=le?(ce.dispatchEvent("complete"),ce.repeatID.clear(),ce.playing=!1):(ce.dispatchEvent("loop"),i.play.apply(i,Q))}),ce},ce.play=function(){return i.play.apply(i,Q),ce.playing=!0,ce},ce.completeID=setTimeout(function(){ce.dispatchEvent("complete")},(Oe.length/Z+.1)*1e3),ce}},this.Tone=function(a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y){var m="volume, note, shape, pan, duration, attack, release, wahAmount, wahRate, wahShape, wahThroat, wahNote, vibratoAmount, vibratoRate, vibratoShape, tremeloAmount, tremeloRate, tremeloShape, startTime, pauseOnBlur",$;if($=st(i.Tone,arguments,m,this))return $;this.type="Tone";var I=this,X;n(a)&&(a=i.volume),n(s)&&(s=i.frequency),n(f)&&(f=t.SINE),n(c)&&(c=0),n(k)&&(k=.02),n(v)&&(v=.05),n(_)&&(_=0),j.AudioContext||j.webkitAudioContext?X=this.audioContext=new(j.AudioContext||j.webkitAudioContext):pt&&tt("Synth tone() needs AudioContext"),a=nt(a),s=nt(s),f=nt(f),c=nt(c),x=nt(x),k=nt(k),v=nt(v),g=nt(g),b=nt(b),E=nt(E),A=nt(A),T=nt(T),h=nt(h),w=nt(w),P=nt(P),y=nt(y),C=nt(C),O=nt(O),_=nt(_);var R=Tt(x);i.duration=x,x&&(x=x*(R=="s"?1:1/1e3)),_&&(Tt(_),_=_*(R=="s"?1:1/1e3)),i.attack=k,i.release=v,i.rampDuration=.02,i.hush=.1;var q=this.note=this.oscillator=X.createOscillator();q.frequency.value=t.Synth.note(s),t.Synth.setShape(q,f);var J=this.filter=X.createBiquadFilter();J.type="bandpass",J.frequency.value=q.frequency.value,J.Q.value=0;var Z=this.gain=q.gain=X.createGain();Z.type="gain",Z.gain.setValueAtTime(0,X.currentTime);var ne=this.compressor=X.createDynamicsCompressor();ne.threshold.setValueAtTime(-50,X.currentTime),ne.knee.setValueAtTime(40,X.currentTime),ne.ratio.setValueAtTime(12,X.currentTime),ne.attack.setValueAtTime(0,X.currentTime),ne.release.setValueAtTime(.25,X.currentTime);var U=this.panNode=X.createStereoPanner();this.panNode.pan.value=c,q.connect(J),J.connect(U),U.connect(Z),Z.connect(ne),ne.connect(X.destination);function B(V,z){n(V)&&(V=X.currentTime),n(z)&&(z=i.attack),q.start(V);var se=j.zdf&&new Date().getTime()-j.zdf.startTime<200?.1:i.attack;Z.gain.setValueAtTime(0,X.currentTime+.1),Z.gain.linearRampToValueAtTime(a*i.hush,X.currentTime+.1+se)}B(_),this.stop=function(V){n(V)&&(V=i.release),Z&&u(Z.gain,0,!0,V),N&&u(N.gain,0,!0,V),L&&u(L.gain,0,!0,V),setTimeout(function(){I.dispatchEvent("complete")},(.6+V+i.rampDuration)*1e3),setTimeout(function(){X&&!X.iamClosed&&(X.iamClosed=!0,X.close())},(V+1)*1e3),setTimeout(function(){o&&I.removeWah()},(V+1)*1e3)},x&&this.stop(_+x-.1);var d=this.notes=[q];this.addNote=function(V,z,se,Oe,K,ge){n(Oe)&&(Oe=!0),n(K)&&(K=!1),n(V)&&(V=.1),n(ge)&&(ge=0);var Q={type:"Note"};Q._volume=V,Q._note=t.Synth.note(z),d.push(Q);var ce=Q.oscillator=X.createOscillator();ce.frequency.value=Q._note,ce.type=t.Synth.setShape(ce,se);var G=Q.gain=X.createGain();return u(G.gain,Q._volume,!0),G.connect(Oe?J:Z),ce.connect(G),L&&K&&L.connect(ce.frequency),ce.start(X.currentTime+ge),Object.defineProperty(Q,"volume",{get:function(){return Q._volume},set:function(le){n(le)||(Q._volume=nt(le),u(Q.gain.gain,Q._volume,!0))}}),Object.defineProperty(Q,"note",{get:function(){return Q._note},set:function(le){n(le)||(Q._note=nt(le),u(Q.oscillator.frequency,t.Synth.note(Q._note)))}}),Q},this.removeNote=function(V){var z=d.indexOf(V);return z>=0&&d.splice(z,1),V.oscillator.disconnect(),V=null,this};function u(V,z,se,Oe){n(z)&&(z=0),n(Oe)&&(Oe=i.rampDuration),se?(V.cancelScheduledValues(X.currentTime),V.linearRampToValueAtTime(V.value,X.currentTime+.02),V.linearRampToValueAtTime(z,X.currentTime+.05+Oe)):(V.cancelScheduledValues(X.currentTime),V.setTargetAtTime(z,X.currentTime,Oe))}this.ramp=function(V,z){u(Z.gain,V*i.hush,!0,z)},this.rampPan=function(V,z){u(U.pan,V,!1,z)},this.animate=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),t.animate.apply(null,arguments),this},this.wiggle=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),t.wiggle.apply(null,arguments),this},t.addWires(this);var o,S;function F(){n(g)&&(g=1e3),n(b)&&(b=1),n(E)&&(E="sine"),n(A)&&(A=5),n(T)?T=I.oscillator.frequency.value:T=t.Synth.note(T),n(S)&&(S=200),I.filter.Q.value=A,o=I.wah=i.oscillator(b,g/2,E,T+g/2+S),o.ticker=t.Ticker.add(function(){I.filter.frequency.value=I.wah.amplitude})}(g||b||!n(E)||!n(A))&&F(),I.removeWah=function(){t.Ticker.remove(o.ticker),o.dispose(),o=I.wah=null,I.filter.Q.value=0};var p,L;function we(){n(w)&&(w=5),n(P)&&(P="sine"),n(h)&&(h=10),p=I.vibrato=X.createOscillator(),L=I.vibratoGain=X.createGain(),L.gain.value=0,p.frequency.value=w,t.Synth.setShape(p,P),p.connect(L),L.connect(q.frequency),p.start(0),L.gain.setValueAtTime(0,X.currentTime+.1),L.gain.linearRampToValueAtTime(h,X.currentTime+.1+i.attack)}(h||w||!n(P))&&we(),I.removeVibrato=function(){u(L.gain,0,!0),setTimeout(function(){L.disconnect(),p.disconnect(),p.stop(),p=null},(i.rampDuration+1)*1e3)};var D,N;function ue(){n(C)&&(C=5),n(O)&&(O="sine"),D=I.tremelo=X.createOscillator(),N=I.tremeloGain=X.createGain(),N.gain.value=0,D.frequency.value=C,t.Synth.setShape(D,O),D.connect(N),N.connect(Z.gain),D.start(0);var V=j.zdf&&new Date().getTime()-j.zdf.startTime<200?.1:i.attack;N.gain.setValueAtTime(0,X.currentTime+.1),N.gain.linearRampToValueAtTime(a*i.hush,X.currentTime+.1+V)}(y||C||!n(O))&&ue(),I.removeTremelo=function(){u(N.gain,0,!0),setTimeout(function(){N.disconnect(),D.disconnect(),D.stop(),D=null},(i.rampDuration+1)*1e3)},Object.defineProperty(this,"volume",{get:function(){return a},set:function(V){if(!n(V)){var z;D?(Z.gain.value?z=N.gain.value/Z.gain.value:z=a?y/a:0,a=nt(V),a=t.constrain(a,.001),u(N.gain,a*z*i.hush,!0)):a=nt(V),u(Z.gain,a*i.hush,!1,i.rampDuration)}}}),this.paused=!1;var fe=a;this.pause=function(V){n(V)&&(V=!0),V?(fe=I.volume,I.volume=0):I.volume=fe},Y&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseOnBlur.push(this)),Object.defineProperty(this,"frequency",{get:function(){return r},set:function(V){n(V)||(r=nt(V),u(q.frequency,V))}}),Object.defineProperty(this,"note",{get:function(){return s},set:function(V){n(V)||(s=nt(V),q.frequency.value=t.Synth.note(s))}}),Object.defineProperty(this,"shape",{get:function(){return f},set:function(V){f=nt(V),t.Synth.setShape(q,f)}}),Object.defineProperty(this,"pan",{get:function(){return c},set:function(V){n(V)||(c=nt(V),u(U.pan,c,!1,.1))}}),Object.defineProperty(this,"currentTime",{get:function(){return X.currentTime},set:function(){pt&&tt("Synth tone() - currentTime is read only")}}),this.wahAmountMin=0,this.wahAmountMax=5e3,Object.defineProperty(this,"wahAmount",{get:function(){return g},set:function(V){n(V)||(g=nt(V),g=t.constrain(g,i.wahAmountMin,i.wahAmountMax),n(o)?F():o.gain=g/2)}}),this.wahRateMin=0,this.wahRateMax=30,Object.defineProperty(this,"wahRate",{get:function(){return b},set:function(V){n(V)||(b=nt(V),b=t.constrain(b,i.wahRateMin,i.wahRateMax),n(o)?F():o.frequency=b)}}),this.wahThroatMin=0,this.wahThroatMax=100,Object.defineProperty(this,"wahThroat",{get:function(){return A},set:function(V){A=nt(V),A=t.constrain(A,i.wahThroatMin,i.wahThroatMax),n(o)?F():J.Q.value=A}}),Object.defineProperty(this,"wahNote",{get:function(){return T},set:function(V){n(V)||(T=nt(V),n(o)?F():o.offset=T+g/2+S)}}),Object.defineProperty(this,"wahAdjust",{get:function(){return S},set:function(V){n(V)||(S=nt(V),n(o)?F():o.offset=T+g/2+S)}}),Object.defineProperty(this,"wahShape",{get:function(){return E},set:function(V){E=nt(V),n(o)?F():o.shape=E}}),Object.defineProperty(this,"tremeloAmount",{get:function(){return y},set:function(V){n(V)||(y=nt(V),n(D)?ue():N.gain.setValueAtTime(y,X.currentTime))}}),Object.defineProperty(this,"tremeloRate",{get:function(){return C},set:function(V){n(V)||(C=nt(V),n(o)?ue():D.frequency.value=C)}}),Object.defineProperty(this,"tremeloShape",{get:function(){return O},set:function(V){O=nt(V),n(D)?ue():t.Synth.setShape(D,O)}}),Object.defineProperty(this,"vibratoAmount",{get:function(){return h},set:function(V){n(V)||(h=nt(V),n(p)?we():L.gain.setValueAtTime(h,X.currentTime))}}),Object.defineProperty(this,"vibratoRate",{get:function(){return w},set:function(V){n(V)||(w=nt(V),n(p)?we():p.frequency.value=w)}}),Object.defineProperty(this,"vibratoShape",{get:function(){return P},set:function(V){P=nt(V),n(p)?we():t.Synth.setShape(p,P)}})},t.extend(this.Tone,Ge.EventDispatcher),this.tone=function(a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Tone,arguments))},this.Oscillator=function(a,s,f,c){var x="frequency, gain, shape, offset",k;if(k=st(i.Oscillator,arguments,x,this))return k;this.type="Oscillator",n(a)&&(a=1),n(s)&&(s=10),n(f)&&(f="sine"),n(c)&&(c=0),this.frequency=nt(a),this.gain=nt(s),this.shape=nt(f),this.shape=="saw"&&(this.shape="sawtooth"),this.offset=nt(c),this.paused=!1;var v=this,g=0,b=t.Ticker.framerate;this.ticker=t.Ticker.add(function(){if(!v.paused){var E=0;v.shape=="sine"?E=Math.sin(v.frequency*(Math.PI*2*(g/b))):v.shape=="square"?(E=Math.sin(v.frequency*(Math.PI*2*(g/b))),E=E<=0?0:1):v.shape=="triangle"?E=2/Math.PI*Math.asin(Math.sin(v.frequency*Math.PI*2*g/b)):v.shape=="sawtooth"||v.shape=="saw"?E=-2/Math.PI*Math.atan(1/Math.tan(v.frequency*Math.PI*g/b)):v.shape=="zap"&&(E=2/Math.PI*Math.atan(1/Math.tan(v.frequency*Math.PI*g/b))),v.amplitude=E*v.gain+v.offset,g++}}),this.pause=function(E){v.paused=E},this.dispose=function(){t.Ticker.remove(this.ticker)}},this.oscillator=function(a,s,f,c){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Oscillator,arguments))}},t.Synth.notes=["C",null,"D",null,"E","F",null,"G",null,"A",null,"B"],t.Synth.major=["C","D","E","F","G","A","B","C4"],t.Synth.minor=["C","D","Eb","F","G","Ab","B","C4"],t.Synth.shapes=["sine","triangle","sawtooth","tan","noise","square"],t.Synth.setShape=function(e,r){if(!n(e)){n(r)&&(r="sine"),r=="saw"&&(r="sawtooth");var i;if(typeof r=="number")r=t.Synth.shapes[r],r||(r="sine");else if(r.real&&r.imag)i=e.context.createPeriodicWave(new Float32Array(r.real),new Float32Array(r.imag));else if(r.constructor==PeriodicWave)i=r;else if(typeof r=="string"){var l=t.Synth.shapes.indexOf(r);if(l<0&&(r="sine"),r=="noise"){for(var a=4096,s=new Float32Array(a),f=new Float32Array(a),c=1;c<a;c+=2)f[c]=t.shuffle([0,.5,1])[0];i=e.context.createPeriodicWave(s,f)}else r=="tan"&&(r="sawtooth")}else r="sine";i?(e.setPeriodicWave(i),r="custom"):e.type=r}},t.Synth.getNote=function(e,r){return n(r)&&(r=0),e*Math.pow(2,r/12)},t.Synth.note=function(e){if(typeof e=="string"){var r=e.substr(0,1).toUpperCase(),i=t.loop(e,function(c){if(!isNaN(c))return Number(c)});i=i!==!0&&!isNaN(i)?i:3;var l=t.Synth.notes.indexOf(r);l<0&&(l=9);var a=e.match(/b/g),s=e.match(/#/g);a=a?a.length:0,s=s?s.length:0;var f=(i-3)*12+l+s-a;return t.Synth.getNote(t.Synth.getNote(220,-9),f)}else return typeof e!="number"&&(e=220),e},t.Synth.wave=function(e,r){if(j.AudioContext||j.webkitAudioContext){var i=new(j.AudioContext||j.webkitAudioContext);if(e.real)r=e.imag,e=e.real;else if(n(r)&&pt){tt("Synth.wave() - pass in asset('wave.json') or real and imag properties");return}return e.constructor!==Float32Array&&(e=new Float32Array(e)),r.constructor!==Float32Array&&(r=new Float32Array(r)),i.createPeriodicWave(e,r)}},t.Synth.drawWave=function(e,r,i,l,a,s,f,c,x){var k="shape, color, thickness, backgroundColor, borderColor, borderWidth, corner, padding, paddingV",v;if(v=st(t.Synth.drawWave,arguments,k))return v;var g=45,b=45;e=nt(e),n(i)&&(i=2),n(r)&&(r=t.darker),n(c)&&(c=8),n(x)&&(x=c);var E=c,A=x,T=new t.Container(g,b);T.mouseChildren=!1,n(l)||(T.backing=new t.Rectangle(g,b,l,a,s,f).addTo(T)),T.shape=new t.Shape(g,b).addTo(T).s(r).ss(i);var h=g-E*2;return e=="square"?T.shape.mt(E,b/2).lt(E,A+3).lt(g/2,A+3).lt(g/2,b-A-3).lt(g-E,b-A-3).lt(g-E,b/2):e=="triangle"?T.shape.mt(E,b/2).lt(E+h/4,A+3).lt(E+h*3/4,b-A-3).lt(g-E,b/2):e=="sawtooth"||e=="saw"?T.shape.mt(E,b/2).lt(g/2,A+2).lt(g/2,b-A-2).lt(g-E,b/2):e=="zap"?T.shape.mt(E,b/2).lt(g/2,b-A-2).lt(g/2,A+2).lt(g-E,b/2):T.shape.mt(E,b/2).bt(g/2,0-15,g/2,b+15,g-E,b/2),T.type=e,T},t.VR=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="content, angle, distance, parallax, parallaxAngle, damp, parallaxDamp, startAngle, negativeParallax, boundaryMarkers, swiper, holder",E;if(E=st(t.VR,arguments,b,this))return E;if(De("69.98"),this.type="VR",!j.zdf){pt&&tt("VR() - please use ZIM Frame");return}var A=j.zdf;(n(g)||!g.getBounds||!g.getBounds().width)&&(g=A.stage),n(r)&&(r=0),n(i)&&(i=100),n(s)&&(s=.5),n(l)&&(l=0),n(a)&&(a=60),n(f)&&(f=.1),n(c)&&(c=0),n(x)&&(x=!1),n(k)&&(k=!0),n(v)&&(v=!0),this.angle=r,this.currentAngle=c,t.mobile()&&(v=!1);var T=this,h=g.width,w=g.height;T.zimContainer_constructor();var P=T.left=new t.Container(h/2,w,null,null,!1),y=new t.Rectangle(h/2,w,"rgba(0,0,0,.01)",null,null,null,null,null,null,!1);P.addChild(y);var C=T.right=P.clone();T.addChild(P,C),C.x=h/2;var O=T.contentLeft=T.content=e,_=T.contentRight=e.clone();if(c!=0)var Y=setTimeout(m,100);else m();function m(){O.addTo(P,null,!1).setMask(P.getChildAt(0)).pos({y:(g.height-O.height)/2,reg:!0}),_.addTo(C,null,!1).setMask(C.getChildAt(0)).pos({y:(g.height-O.height)/2,reg:!0})}var $=[],I=[];function X(Q,ce,G,le){Q.vrMatch=ce,ce.vrMatch=Q,Q.cacheCanvas&&ce.cache(),Q.dep&&!n(Q.depth)&&($.push(Q),I.push(ce),n(G)||G.push(Q),n(le)||le.push(ce),ce.dep(Q.depth)),t.loop(Q,function(Ae,re){X(Ae,ce.getChildAt(re),G,le)})}X(O,_);function R(Q,ce){t.loop(Q,function(G){G.vrChannel=ce,G.vrStartX=G.x,r!=0&&i!=0&&(G.vrAngle=r,G.vrDistance=i),l!=0&&i!=0&&(G.vrParallax=l/100,G.vrParallaxDistance=0,r!=0&&(G.vrParallaxDamp=new t.Damp(0,f))),G.dep(G.depth)})}if(R($,"left"),R(I,"right"),r!=0&&i!=0){var q=new t.Damp(180+c,s);q.immediate(180+c);var J=!1,Z=!1;A.on("deviceorientation",function(Q){ne(q.convert((Q.rotation.z>180?-180:180)+Q.rotation.z+c)-180)}),t.Ticker.always()}function ne(Q){T.currentAngle=Q;var ce=-T.currentAngle*i/r;T.contentLeft.x=ce,T.contentRight.x=ce;var G;Math.round(T.currentAngle)<=-r/2&&!J?(G=new Ge.Event("boundaryout"),G.boundary="left",J=!0,T.dispatchEvent(G)):Math.round(T.currentAngle)>=r/2&&!Z?(G=new Ge.Event("boundaryout"),G.boundary="right",Z=!0,T.dispatchEvent(G)):Math.round(T.currentAngle)>-r/2&&Math.round(T.currentAngle)<r/2&&(G=new Ge.Event("boundaryin"),J?(G.boundary="left",T.dispatchEvent(G),J=!1):Z&&(G.boundary="right",T.dispatchEvent(G),Z=!1))}function U(Q){var ce=Q.parent.localToLocal(Q.vrStartX,0,g),G=Q.vrParallaxDamp.convert(Q.vrChannel=="left"?T.contentLeft.x+ce.x-h/4:T.contentRight.x+ce.x-h/2-h/4);Q.depth<=0&&!x&&(G=0),Q.vrParallaxDistance=Math.max(-i/r*a/2,Math.min(i/r*a/2,G)),Q.dep(Q.depth)}if(l!=0&&i!=0){var B=new t.ProportionDamp(180-a/2,180+a/2,-a/2,a/2,f);B.immediate(180),A.on("deviceorientation",function(Q){var ce=0;r==0&&l!=0&&i!=0&&(ce=B.convert((Q.rotation.z>180?-180:180)+Q.rotation.z)),u(ce)}),t.Ticker.always()}function d(Q,ce){Q.vrParallaxDistance=Q.depth<=0&&!x?0:ce,Q.dep(Q.depth)}function u(Q){r!=0&&i!=0?(t.loop($,U),t.loop(I,U)):(t.loop($,function(ce){d(ce,Q)}),t.loop(I,function(ce){d(ce,Q)}))}v&&i!=0&&(r!=0||l!=0)&&T.added(function(){var Q={swipeAngle:0};T.swiper=new t.Swiper({swipeOn:T,target:Q,property:"swipeAngle",sensitivity:.2,damp:.05,factor:-1,min:-330,max:330}),t.Ticker.add(function(){r!=0&&i!=0&&ne(Q.swipeAngle),l!=0&&i!=0&&u(B.convert(Q.swipeAngle+180))})});var o=localStorage&&localStorage.zimEyeAdjust?Number(localStorage.zimEyeAdjust):0,S=o,F=!1;O.startRegX=O.regX,_.startRegX=_.regX;var p=this.adjuster=new t.Container(800,300,null,null,!1);y=p.backing=new t.Rectangle(p.width,p.height,t.lighter,null,null,null,null,null,null,!1).center(p).alp(1).sha("rgba(0,0,0,.2)",0,0,30),p.strip=new t.Rectangle(p.width,p.height/3,t.white,null,null,null,null,null,null,!1).center(p).alp(1),p.label=new t.Label({text:"slide to adjust center of left and right",size:28,color:t.dark,align:"center",valign:"center"}).center(p).pos({y:50,reg:!0});var L=p.close=new t.Rectangle(50,50,t.light,null,null,null,null,null,null,!1).addTo(p).mov(p.width-70,26),we=new t.Shape(-40,-40,80,80,null,!1);we.graphics.f(t.dark).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),we.center(L).sca(.3),L.cur("pointer"),L.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){T.hideAdjuster(),ue.currentValue=(ue.max-ue.min)/2+S,T.dispatchEvent("closed")});var D=new t.Circle(30,t.dark,null,null,null,null,null,null,!1).center(p).pos({x:p.width/4,reg:!0});D.shape.alpha=.2,new t.Circle(12,t.dark,null,null,null,null,null,!1).center(D);var N=new t.Circle(30,t.dark,null,null,null,null,null,!1).center(p).pos({x:p.width/4*3,reg:!0});N.shape.alpha=.2,new t.Circle(12,t.dark,null,null,null,null,null,null,!1).center(N);var ue=p.slider=new t.Slider({min:0,max:30,step:1,useTicks:!0,style:!1}).centerReg(p).pos({y:p.height-40,reg:!0});ue.currentValue=(ue.max-ue.min)/2+o;var fe=new t.Proportion(ue.min,ue.max,D.x-p.width/4,D.x+p.width/4,-1),V=new t.Proportion(ue.min,ue.max,N.x-p.width/4,N.x+p.width/4);ue.on("change",function(){D.x=fe.convert(ue.currentValue),N.x=V.convert(ue.currentValue)}),new t.Label("closer",24,null,t.silver).centerReg(p).pos({x:ue.x-220,y:ue.y,reg:!0}),new t.Label("farther",24,null,t.silver).centerReg(p).pos({x:ue.x+220,y:ue.y,reg:!0});var z=T.ok=new t.Button({label:"OK",width:90,height:60,corner:0,backgroundColor:t.blue,rollBackgroundColor:t.green,shadowColor:-1,style:!1}).centerReg(p).sca(.8).pos({x:p.width-58,y:ue.y,reg:!0});z.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){localStorage&&(localStorage.zimEyeAdjust=ue.currentValue-(ue.max-ue.min)/2),K(),T.hideAdjuster(),T.dispatchEvent("saved"),T.dispatchEvent("closed")});var se=T.zero=new t.Button({label:">|<",width:90,height:60,corner:0,backgroundColor:t.yellow,rollBackgroundColor:t.green,shadowColor:-1,style:!1}).centerReg(p).sca(.8).pos({x:58,y:ue.y,reg:!0});se.on((Et?t.ACTIONEVENT=="mousedown":j.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){ue.currentValue=(ue.max-ue.min)/2,D.x=fe.convert(ue.currentValue),N.x=V.convert(ue.currentValue)});var Oe=new t.Proportion(0,30,-g.width/4,g.width/4);function K(){var Q=Oe.convert(ue.currentValue);O.regX=O.startRegX+Q,_.regX=_.startRegX-Q}K(),this.showAdjuster=function(){if(F)return T;F=!0,D.x=fe.convert(ue.currentValue),N.x=V.convert(ue.currentValue),S=ue.currentValue-(ue.max-ue.min)/2,p.scaleTo(g,100,100).center(this),g.stage.update()},this.hideAdjuster=function(){if(!F)return T;F=!1,p.removeFrom(this),g.stage.update()},this.position=function(Q,ce,G){le(Q),le(Q.vrMatch);function le(Ae){Ae.vrStartX=ce,Ae.vrParallaxDamp&&Ae.vrParallaxDamp.immediate(ce),Ae.mov(ce,G)}return Q},this.register=function(Q){if(!Q.parent||!Q.parent.vrMatch)return pt&&tt("ZIM VR() - please only register objects already inside content container"),Q;var ce=Q.clone().addTo(Q.parent.vrMatch),G=[],le=[];return X(Q,ce,G,le),R(G,"left"),R(le,"right"),Q},r!=0&&i!=0&&k&&(T.boundaryRight=new t.Container({style:!1}),new t.Circle(24,t.light,null,null,null,null,null,null,!1).addTo(T.boundaryRight).dep(-2),new t.Triangle(16,16,16,t.yellow,t.grey,null,null,null,-3,null,null,!1).rot(-90).center(T.boundaryRight).dep(-6),T.boundaryRight.center(e).mov(i/2+24),T.boundaryLeft=new t.Container({style:!1}),new t.Circle(24,t.light,null,null,null,null,null,null,!1).addTo(T.boundaryLeft).dep(-2),new t.Triangle(16,16,16,t.yellow,t.grey,null,null,null,-3,null,null,!1).rot(90).center(T.boundaryLeft).dep(-6),T.boundaryLeft.center(e).mov(-i/2-24),T.register(T.boundaryRight),T.register(T.boundaryLeft));function ge(Q){var ce=$.indexOf(Q);$.indexOf(Q)>=0&&($.splice(ce,1),I.splice(ce,1)),t.loop(Q,function(G){ge(G)})}this.remove=function(){return t.loop(arguments,function(Q,ce){e.contains(ce)&&(ge(ce),ce.parent.removeChild(ce),ce.vrMatch.parent.removeChild(ce.vrMatch))}),T},this.resize=function(){h=g.width,w=g.height,P.getChildAt(0).widthOnly=C.getChildAt(0).widthOnly=h/2,P.getChildAt(0).heightOnly=C.getChildAt(0).heightOnly=w,C.x=h/2,P.setBounds(0,0,h/2,w),C.setBounds(0,0,h/2,w),c!=0?(clearTimeout(Y),Y=setTimeout(m,100)):m(),p.scaleTo(g,100,100).center(this,null,!1)}},t.extend(t.VR,t.Container,"clone","zimContainer",!1),t.scaX=1,t.scaY=1,t.Frame=function(e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne){var U="scaling, width, height, color, outerColor, ready, assets, path, progress, ticker, rollover, touch, scrollTop, align, valign, canvasID, rollPerSecond, delay, canvasCheck, gpu, gpuObj, nextFrame, nextStage, allowDefault, loadFailObj, sensors, retina, mouseMoveOutside, captureMouse, shim, maxConnections, maxNum, singleTouch",B;if(B=st(t.Frame,arguments,U,this))return B;De("83"),pt&&ri("ZIM FRAME"),this.cjsEventDispatcher_constructor(),this.type="Frame";var d=this;(!j.zdf||!j.zdf.type)&&(j.zimDefaultFrame=j.zdf=j.F=this),j.M=t.mobile();var u=Date;this.startTime=new u().getTime(),n(P)&&(P=!0);var o=!!j.HTMLCanvasElement;if(!o&&P){setTimeout(function(){d.dispatchEvent("failed")},100);return}var S=t.mobile();n(e)&&(e="full"),e=="outside"&&(e="fill"),n(c)||(j.PATH=c),n(v)&&(v=!S),n(g)&&(g=!0),n(b)&&(b=!1),n(E)&&(E="center"),n(A)&&(A="center");var F="";n(T)&&(j.zdf!=this?(F=t.makeID(null,5),T="myCanvas"+F):T="myCanvas");var p=Tt(w);n(h)&&(h=20),n(w)&&(w=S?p=="s"?1:1e3:p=="s"?.03:30),n(y)&&(y=!1),n(Y)&&(Y=!1),n(m)&&(m="circles"),this.loadFailObj=m,n($)&&($=!1),n(I)&&(I=!0),this.retina=I,n(X)&&(X=!1),n(R)&&(R=!0),n(q)&&(q=!1),n(J)&&(J=10),n(ne)&&(ne=!1),ne&&(g=!0);var L=J;d.maxNum=Z,y&&(I=!1),this.retina=I;var we=!1,D=!1;this.leftMouseDown=!1;function N(me){d.leftMouseDown=me.buttons===void 0?me.which===1:me.buttons===1,we&&!d.leftMouseDown&&d.dispatchEvent("mouseupplus"),D&&!d.leftMouseDown&&d.dispatchEvent("mouseupplusonly"),we=D=d.leftMouseDown}var ue=["fit","fill","full"],fe,V,z;if(q){this.shim=!0,q.stage.frame=this;var se=this.canvas=q.canvas;this.scale=q.stage.scaleX;var Oe,K;setTimeout(function(){ge(),K=function(){ge(),Oe&&clearTimeout(Oe),Oe=setTimeout(ge,50)},j.addEventListener("resize",K)},20),fe=q.stage,V=fe.getBounds()?fe.getBounds().width:se.width/fe.scaleX,z=fe.getBounds()?fe.getBounds().height:se.height/fe.scaleY,fe.getBounds()||fe.setBounds(0,0,V,z),l=se.style.backgroundColor,Ye(),ge()}else this.scale=1,this.x=0,this.y=0;function ge(){d.scale=q.stage.scaleX;var me=se.getBoundingClientRect();d.x=me.x+t.scrollX(),d.y=me.y+t.scrollY(),t.scaX=Ge.stageTransformable?1:q.stage.scaleX,t.scaY=Ge.stageTransformable?1:q.stage.scaleY}var Q,ce,G=!1,le,Ae,re=!1,xe=!1,ke=!1;q||(document.readyState==="interactive"||document.readyState==="complete"?setTimeout(function(){ee()},200):document.addEventListener("DOMContentLoaded",ee));var te,pe=!1,he=e=="full"&&typeof InstallTrigger<"u";if(this.swapRotation=!1,S&&!j.parent){var ae=isNaN(j.innerWidth)?j.clientWidth:j.innerWidth,Ee=isNaN(j.innerHeight)?j.clientHeight:j.innerHeight;this.swapRotation=(j.orientation==0||j.orientation==180)&&ae>Ee||Math.abs(j.orientation)==90&&Ee>ae}j.addEventListener("resize",Se);var ie;function Se(){if(q){if(fe.canvas){var me=V=fe.canvas.width,He=z=fe.canvas.height;fe.setBounds(0,0,me,He)}d.dispatchEvent("resize");return}ie=Date.now()+w*(p=="s"?1e3:1),he?pe||(pe=!0,te=t.Ticker.update,t.tickerFrame||(t.Ticker.update=!1,t.tickerFrame=d),it(),et(),clearInterval(d.frameTime),d.frameTime=setInterval(function(){if(Date.now()>ie){clearInterval(d.frameTime),pe=!1,d==t.tickerFrame&&(t.Ticker.update=te);return}it(),et()},50)):(it(),et(),clearInterval(d.frameTime),d.frameTime=setInterval(function(){if(Date.now()>ie){clearInterval(d.frameTime);return}it(),et()},w*(p=="s"?1e3:1)<50?w*(p=="s"?1e3:1)+5:50))}d.loadAssetsCount=0,n(t.assets)&&(t.assets={},t.assetIDs={});var Le=[];Le[0]="h",Le[1]="c",Le[2]="o",Le[3]="p",Le[4]="e";var Ce=!1;function ee(){if(ke)return;if(ke=!0,ue.indexOf(e)==-1){if(le=e,n(Cn(le))){tt("Frame - scaling: HTML tag with id="+e+" must exist");return}Ae=d.tag=Cn(le),d.scaling=e=n(r)||n(i)?"tag":"inline",T.indexOf("myCanvas")==0&&(T=le+"Canvas"),Ae.tagName.toLowerCase()=="canvas"&&(Ce=!0,T=le)}else d.scaling=e;d.canvasID=T,n(r)&&(r=500),n(i)&&(i=500),V=r,z=i,n(a)||(d.outerColor=a),_e(),je(),S?(b&&setTimeout(function(){j.scrollTo(0,0)},50),setTimeout(me,100),w*(p=="s"?1e3:1)!=100&&setTimeout(me,w*(p=="s"?1e3:1))):(re=!0,Me());function me(){it(),re=!0,Me(),et(),fe&&fe.update()}if(n(f))xe=!0,Me();else{var He;f.constructor=={}.constructor&&!(f.audioSprite||f.id||f.data||f.src)?He=d.loadAssets(t.merge(f,{progress:x,queueOnly:!0})):He=d.loadAssets({assets:f,path:c,progress:x,queueOnly:!0}),n(He)||!He.on?(pt&&tt("Frame() - load failed"),xe=!0,Me()):He.on("complete",function(){xe=!0,Me()})}}function Me(){if(re&&xe&&!G)if(fe.width>=1&&fe.height>=1){if(!n(x)&&x.show&&x.hide(),d==j.zdf&&(j.S=fe,j.W=fe.width,j.H=fe.height),s&&typeof s=="function"&&s(d,fe,fe.width,fe.height),!d)return;if(k&&typeof k=="function"){var me=0;if(!d)return;d.updateID=t.Ticker.add(function(){k(++me,d,fe,fe.width,fe.height)}),d.pauseTicker=function(He){n(He)&&(He=!0),He?t.Ticker.remove(d.updateID):t.Ticker.add(d.updateID)}}d.dispatchEvent("ready"),G=!0,et(),fe.update()}else setTimeout(function(){it(),Me()},50)}function _e(){var me;Ce?me=d.canvas=d.tag:(me=d.canvas=document.createElement("canvas"),me.setAttribute("id",T)),me.setAttribute("tabindex",0);var He=t.windowWidth(),at=t.windowHeight(),Qe=j.devicePixelRatio||1;e=="full"||e=="tag"?I?(d.scale=Qe,me.setAttribute("width",He*d.scale),me.setAttribute("height",at*d.scale),e=="full"&&(me.style.width=He+"px",me.style.height=at+"px")):(me.setAttribute("width",He),me.setAttribute("height",at)):(me.setAttribute("width",V),me.setAttribute("height",z));var ct=Cn(T+"Alternative");ct&&me.appendChild(ct),Ce||(e=="tag"||e=="inline"?Ae.appendChild(me):document.body.appendChild(me)),n(l)||(me.style.backgroundColor=l),e=="full"||e=="fit"||e=="fill"?(me.style.position="absolute",Y||(document.body.style.overflow="hidden")):getComputedStyle(me.parentElement).position=="static"&&(me.parentElement.style.position="relative"),me.addEventListener("pointerdown",function(ot){me.setPointerCapture(ot.pointerId),d.dispatchEvent(ot)}),me.addEventListener("pointerup",function(ot){me.releasePointerCapture(ot.pointerId),d.dispatchEvent(ot)}),me.addEventListener("pointermove",function(ot){d.dispatchEvent(ot)}),me.addEventListener("pointerenter",function(ot){d.dispatchEvent(ot)}),me.addEventListener("pointerleave",function(ot){d.dispatchEvent(ot)})}function Ye(){R&&(d.mouseX=0,d.mouseY=0,d.mousedownEvent=fe.on("stagemousedown",function(me){d.mouseX=me.stageX/t.scaX,d.mouseY=me.stageY/t.scaY}),d.mousemoveEvent=fe.on("stagemousemove",function(me){d.mouseX=me.stageX/t.scaX,d.mouseY=me.stageY/t.scaY})),j.removeEventListener("mousedown",N,!0),j.removeEventListener("mousemove",N,!0),j.removeEventListener("mouseup",N),j.addEventListener("mousedown",N,!0),j.addEventListener("mousemove",N,!0),j.addEventListener("mouseup",N)}function je(){it(),ue.indexOf(e)!=-1&&!Y&&(d.zil=Xr()),d.mousedownEvent&&fe&&fe.off("stagemousedown",d.mousedownEvent),d.mousemoveEvent&&fe&&fe.off("stagemousemove",d.mousemoveEvent),fe=y?new t.StageGL(T,C):new t.Stage(T),fe.frame=d,fe.mouseMoveOutside=X,!n(l)&&y&&fe.setClearColor(t.convertColor(l)),fe.setBounds(0,0,V,z),fe.width=V,fe.height=z,I&&it(),v&&fe.enableMouseOver(h),g&&(ne?Ge.Touch.enable(fe,!0,Y):Ge.Touch.enable(fe,!1,Y)),Y&&(fe.preventSelection=!1),O&&(fe.nextStage=O.stage),_&&(fe.nextStage=_),Ye(),fe.on("stagemouseup",function(){D=!1})}function it(){if(d){var me=Cn(T),He=t.windowWidth(),at=t.windowHeight(),Qe,ct,ot,dt;if(Q=d.orientation=He>at?"horizontal":"vertical",Q!=ce&&(ce=Q,d.dispatchEvent("orientation")),S&&b&&setTimeout(function(){j.scrollTo(0,0)},100),!!me){if(e=="fit")d.scale=He/at>=V/z?at/z:He/V;else if(e=="fill")d.scale=He/at>=V/z?He/V:at/z;else if(e=="full"){me.style.left=me.style.top="0px",me.width=V=He,me.height=z=at,fe&&(fe.setBounds(0,0,V,z),I?(ot=j.devicePixelRatio||1,me.width=He*ot,me.height=at*ot,me.style.width=He+"px",me.style.height=at+"px",d.scale=ot,fe.scaleX=fe.scaleY=d.scale):fe.scaleX=fe.scaleY=1,fe.tickOnUpdate=!1,fe.update(),fe.tickOnUpdate=!0,fe.width=V,fe.height=z,y&&fe.updateViewport(V/fe.scaleX,z/fe.scaleY),t.scaX=Ge.stageTransformable?1:fe.scaleX,t.scaY=Ge.stageTransformable?1:fe.scaleY),Y||(t.scrollX(0),t.scrollY(0)),qe();return}else if(e=="tag"){V=Ae.style.width==""?Ae.getAttribute("width")||Ae.offsetWidth:Ae.style.width,z=Ae.style.height==""?Ae.getAttribute("height")||Ae.offsetHeight:Ae.style.height,I?(me.width=V*d.scale,me.height=z*d.scale,me.style.width=V+"px",me.style.height=z+"px",fe&&(fe.scaleX=fe.scaleY=d.scale)):(fe&&(fe.scaleX=fe.scaleY=1),me.width=V,me.height=z),fe&&(fe.tickOnUpdate=!1,fe.update(),fe.tickOnUpdate=!0,fe.setBounds(0,0,V,z),fe.width=V,fe.height=z,y&&fe.updateViewport(V/fe.scaleX,z/fe.scaleY),t.scaX=Ge.stageTransformable?1:fe.scaleX,t.scaY=Ge.stageTransformable?1:fe.scaleY),Ae.style.overflow="hidden",me.style.left=me.style.top="0px",dt=me.getBoundingClientRect(),d.x=dt.x+t.scrollX(),d.y=dt.y+t.scrollY(),qe();return}else if(e=="inline"){if(I){if(document.styleSheets[0])try{for(var $e=document.styleSheets[0].rules||document.styleSheets[0].cssRules,Mt=0;Mt<$e.length;Mt++){var Ct=$e[Mt];if(Ct.selectorText=="#"+T){var xt=Ct.style.getPropertyValue("width");if(xt){var Bt=Hn(me.style.width),Rt=Hn(me.style.height);me.style.width=xt}}}}catch (e8){+function(){}()}var Ht=j.getComputedStyle(me),nn=Hn(Ht.getPropertyValue("width"));Bt&&(me.style.height=Rt*nn/Bt+"px",Ht=j.getComputedStyle(me));var en=Hn(Ht.getPropertyValue("height"));ot=j.devicePixelRatio||1,d.scale=nn/r*ot,me.width=V*d.scale,me.height=z*d.scale,me.style.width=nn+"px",me.style.height=en+"px",fe&&(fe.scaleX=fe.scaleY=d.scale)}else fe&&(fe.scaleX=fe.scaleY=1);fe&&(fe.tickOnUpdate=!1,fe.update(),fe.tickOnUpdate=!0,fe.setBounds(0,0,V,z),fe.width=V,fe.height=z,y&&fe.updateViewport(V/fe.scaleX,z/fe.scaleY),t.scaX=Ge.stageTransformable?1:fe.scaleX,t.scaY=Ge.stageTransformable?1:fe.scaleY),me.style.left=me.style.top="0px",dt=me.getBoundingClientRect(),d.x=dt.x+t.scrollX(),d.y=dt.y+t.scrollY(),qe();return}ct=z*d.scale,Qe=V*d.scale,I?(ot=j.devicePixelRatio||1,d.scale*=ot,me.width=V*d.scale,me.height=z*d.scale,me.style.width=V*d.scale/ot+"px",me.style.height=z*d.scale/ot+"px",fe&&(fe.scaleX=fe.scaleY=d.scale)):(fe&&(fe.scaleX=fe.scaleY=1),me.style.width=Qe+"px",me.style.height=ct+"px"),fe&&(fe.tickOnUpdate=!1,fe.update(),fe.tickOnUpdate=!0),E=="left"?d.x=0:E=="right"?d.x=He-Qe:d.x=(He-Qe)/2,A=="top"?d.y=0:A=="bottom"?d.y=at-ct:d.y=(at-ct)/2,me.style.left=d.x+"px",me.style.top=d.y+"px",Y||(t.scrollX(0),t.scrollY(0)),qe(),fe&&(t.scaX=Ge.stageTransformable?1:fe.scaleX,t.scaY=Ge.stageTransformable?1:fe.scaleY)}}}var Be=Le.reverse().join("");this.update=function(){it(),d.dispatchEvent("update")};function qe(){if(e=="fill"){var me=(Hn(d.canvas.style.width)-t.windowWidth())/2;E=="left"?(d.visibleLeft=0,d.visibleRight=t.windowWidth()/(t.windowWidth()+me*2)*V):E=="right"?(d.visibleLeft=me*2/(t.windowWidth()+me*2)*V,d.visibleRight=V):(d.visibleLeft=me/(t.windowWidth()+me*2)*V,d.visibleRight=(t.windowWidth()+me)/(t.windowWidth()+me*2)*V);var He=(Hn(d.canvas.style.height)-t.windowHeight())/2;A=="top"?(d.visibleTop=0,d.visibleBottom=t.windowHeight()/(t.windowHeight()+He*2)*z):A=="bottom"?(d.visibleTop=He*2/(t.windowHeight()+He*2)*z,d.visibleBottom=z):(d.visibleTop=He/(t.windowHeight()+He*2)*z,d.visibleBottom=(t.windowHeight()+He)/(t.windowHeight()+He*2)*z)}else d.visibleLeft=d.visibleTop=0,d.visibleRight=V,d.visibleBottom=z}function et(){if(!(!G||!d)){d==j.zdf&&(j.W=d.width,j.H=d.height),d.dispatchEvent("resize");var me=new Date().getTime();setTimeout(function(){new Date().getTime()-me>80&&(it(),d==j.zdf&&(j.W=d.width,j.H=d.height),setTimeout(function(){d.dispatchEvent("resize"),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&fe&&(e=="full"||e=="tag")&&fe.update()},100))},100),!t.OPTIMIZE&&(Et||!j.OPTIMIZE)&&fe&&(e=="full"||e=="tag")&&fe.update()}}setTimeout(function(){d&&d.dispatchEvent("orientation")},250);var ve=["ttf","otf","woff2","woff","fnt"];u[Be]=function(){var at=u.now(),me=Math.floor(at/1e3%10),He=(He=at.toString()).substring(0,He.length-2)+(10+me-3)%10+He.substring(He.length-1),at=Math.floor(at/1e4%10);return He=(He=He.substring(0,He.length-1)+(at+1)%10).substring(0,He.length-3)+(me+at+3)%10+He.substring(He.length-2),Number(He)},this.loadAssets=function(me,He,at,Qe,ct,ot,dt,$e,Mt,Ct,xt,Bt){if(n(me))return en();if(n(me.src)){var Rt="assets, path, progress, xhr, time, loadTimeout, outputAudioSprite, crossOrigin, fileType, queueOnly, maxConnections, maxNum",Ht;if(Ht=st(d.loadAssets,arguments,Rt))return Ht}n(He)||(j.PATH=He);var nn=Tt(ct||null);if(!n(at)&&at.type=="ProgressBar"&&n(Qe)&&(Qe=!0),n(Qe)&&(Qe=!0),Array.isArray(me)||(me=[me]),me.length==0)return en();function en(){var qt=new t.Queue;return qt.isLoading=!1,qt.loadAssetsCount=0,setTimeout(function(){qt.dispatchEvent("complete"),d.dispatchEvent("complete")},10),qt}n(ct)&&(ct=0),n(ot)&&(ot=nn=="s"?8:8e3),n(dt)&&(dt=!1),n($e)&&($e="anonymous"),n(Ct)&&(Ct=!1),n(xt)&&(xt=L),n(Bt)&&(Bt=d.maxNum);var kt=!1,Qt=[],Je,gt,It,Xt,Yt,ft=/\.([^.]+)$/i,bt=[],Gt=[],Kt=[],fn=0,Jt=!0;for(It=0;It<me.length;It++){if(Je=me[It],Je.assets){var rn=[];for(me.splice(It,1),Array.isArray(Je.assets)||(Je.assets=[Je.assets]),Xt=0;Xt<Je.assets.length;Xt++){var jt=Je.assets[Xt];if(jt.split){var gn=jt.split("?");gt=gn[0].match(ft)}gt&&ve.indexOf(gt[1])>=0?bt.push(jt):jt.match&&jt.match(/fonts\.googleapis\.com/i)?Gt.push(jt):jt.font?(jt.src?jt.src=Je.path+jt.src:jt.font=Je.path+jt.font,bt.push(jt)):t.assetIDs[jt]?rn.push({id:Je.path+jt,src:Je.path+jt,path:null,loadTimeout:Je.loadTimeout,maxNum:Je.maxNum,noCORSonImage:Je.noCORSonImage}):rn.push({id:jt,src:jt,path:Je.path,loadTimeout:Je.loadTimeout,maxNum:Je.maxNum,noCORSonImage:Je.noCORSonImage})}for(var vt=rn.length-1;vt>=0;vt--)me.splice(It,0,rn[vt]);if(Je=rn[0],Je==null)continue}if(Je.constructor=={}.constructor){var ze=0;for(var wt in Je)ze++;ze==1&&Je.src&&!Je.src.match(/fonts\.googleapis\.com/i)&&(Je=Je.src)}var Wt;if(Je.constructor=={}.constructor)if(Je.audioSprite){Yt=t.copy(Je),Je=Yt.src,qn(Je);var _t=[],tn;for(Xt=0;Xt<Yt.audioSprite.length;Xt++)tn=Yt.audioSprite[Xt],_t.push({id:tn[0],startTime:Math.round(tn[1]*1e3),duration:Math.round((tn[2]-tn[1])*1e3)});delete Yt.audioSprite,Yt.data={audioSprite:_t},Qt.push(Yt)}else if(Je.data&&Je.data.audioSprite)Yt=t.copy(Je),Je=Yt.src,qn(Je),Qt.push(Yt);else if(Je.id){if(Je.path){var Ut,yt;if(Je.path.match(/http/i))Je.src=Je.path+Je.src;else if(Je.path.match(/^\//))Ut=j.location.href,yt=Ut.match(/(.*?)([^/])\/[^/]/),Ut=yt[1]+yt[2],Je.src=Ut+Je.path+Je.src;else{var Vt=j.location.pathname;Ut=j.location.href;var yn=Ut.split(Vt)[0]+Vt;yt=yn.match(/(.*)\//),Je.src=yt[1]+"/"+Je.path+Je.src}delete Je.path}if(Je.noCORSonImage){var $t=new Image;Kt.push($t),$t.src=Je.src,$t.id=Je.id;var an;$t.onload=function(qt){var ln=qt.currentTarget,zt=t.assets[ln.id]=new t.Bitmap({image:ln,style:!1}).expand(0);an=new Ge.Event("assetload"),zt&&typeof zt!="string"&&typeof zt!="number"&&(zt.file=ln.id,zt.src=ln.src),an.asset=zt,cn.dispatchEvent(an),Ct||(an=new Ge.Event("assetload"),an.asset=zt,d.dispatchEvent(an)),cn.loadAssetsCount--,cn.loadAssetsCount==0&&In()}}else{t.assetIDs[Je.id]=Je.src;var Rn=Je.maxNum;n(Rn)&&(Rn=Bt);var Nn=Je.type,Ln=n(Je.loadTimeout)?ot:Je.loadTimeout;Je=Je.src,qn(Je),Wt={src:Je,loadTimeout:Ln*(nn=="s"?1e3:1),data:Rn,type:Nn},n(Mt)||(Wt.type=Mt),Qt.push(Wt)}}else Je.src&&Je.src.match(/fonts\.googleapis\.com/i)?Gt.push(Je):bt.push(Je);else{var zn=qn(Je);zn&&ve.indexOf(zn[1])>=0?(bt.push(Je),fn--):Je.match(/fonts\.googleapis\.com/i)?(Gt.push(Je),fn--):(Wt={src:Je,loadTimeout:ot*(nn=="s"?1e3:1),data:Bt},n(Mt)||(Wt.type=Mt),Qt.push(Wt))}if(kt&&Jt){var Qn=document.createElement("audio");Qn.setAttribute("src",(!n(He)&&!Je.match(/^http:\/\/|https:\/\//i)?He:"")+Je),document.body.appendChild(Qn),Jt=!1}}function qn(qt){if(gt=null,qt.split){var ln=qt.split("?");gt=ln[0].match(ft),gt&&Ge.Sound.SUPPORTED_EXTENSIONS.indexOf(gt[1])>=0&&(kt=!0)}return fn++,gt}d.loadAssetsCount++,d.isLoading=!0;var cn=new t.Queue;cn.isLoading=!0,cn.loadAssetsCount=0,!n(at)&&at.show&&(at.zimActiveLoader=cn,at.show());var xn;if(bt.length>0){var Zn=[],sn,on;for(It=0;It<bt.length;It++){if(on=bt[It],on.font&&!on.src){on.src=on.font,on.font=on.font.split(".")[0];var En=on.font.split("/");on.font=En[En.length-1]}typeof on=="string"&&(on={font:on.split(".")[0],src:on}),sn={src:"url("+(on.src.match(/\//i)?"":He||"")+on.src+")"+(on.type?" format('"+on.type+"')":""),family:on.font},on.weight&&(sn.weight=on.weight),on.style&&(sn.style=on.style),Zn.push(sn)}xn=new Ge.FontLoader({src:Zn},!0),xn.on("complete",Fn),xn.on("error",Fn),xn.load(),cn.loadAssetsCount++}if(Gt.length>0)for(It=0;It<Gt.length;It++)on=Gt[It],typeof on=="string"&&(on={src:on}),sn={src:on.src,type:"fontcss"},cn.loadAssetsCount++,xn=new Ge.FontLoader(sn,!0),xn.on("complete",Fn),xn.on("error",Fn),xn.load();function Fn(){cn.loadAssetsCount--,cn.loadAssetsCount==0&&In()}if(Kt.length>0)for(It=0;It<Kt.length;It++)cn.loadAssetsCount++;function lr(qt,ln){cn.loadAssetsCount--;var zt=ln.item,wn=t.assets[zt.id]=qt;wn.src=zt.src,wn.file=zt.id,wn.item=zt,wn.svg=ln.svg;var On=new Ge.Event("assetload");On.item=zt,On.asset=wn,wn.type="SVG",cn.dispatchEvent(On),Ct||(On=new Ge.Event("assetload"),On.item=zt,On.asset=wn,d.dispatchEvent(On)),cn.loadAssetsCount==0&&In()}var ar=Date.now(),Pn=new Ge.Event("complete");if(fn>0){cn.loadAssetsCount++;var kn=cn.preload=d.preload=new Ge.LoadQueue(Qe,He,$e);xt!=1&&kn.setMaxConnections(xt),kt&&kn.installPlugin(Ge.Sound),kn.on("progress",function(qt){cn.dispatchEvent(qt),Ct||d.dispatchEvent(qt)}),kn.on("error",function(qt){cn.dispatchEvent(qt),Ct||d.dispatchEvent(qt)}),kn.on("fileload",function(qt){if(!qt.result||(qt.result.nodeName=="IMG"||qt.result.nodeName=="SVG")&&!qt.rawResult&&Qe){var ln=new Ge.Event("error");ln=new Ge.Event("error"),ln.item=qt.item,cn.dispatchEvent(ln),ln=new Ge.Event("error"),ln.item=qt.item,d.dispatchEvent(ln)}else{var zt=qt.item,wn=qt.item.type,On=zt.id.match(ft),Tn;if(wn&&wn=="sound"){var $n=[];if(zt.data&&zt.data.audioSprite)for(var Sn=0;Sn<zt.data.audioSprite.length;Sn++)$n.push(zt.data.audioSprite[Sn].id);else $n.push(zt.id);for(Sn=0;Sn<$n.length;Sn++)~function(){var Gn=$n[Sn],dr=qt.item.src,er=qt.item;Tn=t.assets[Gn]={type:"sound",path:He,id:Gn,file:Gn,src:dr,item:er,dispose:function(){delete t.assets[Gn],Tn=null},play:function(hr,pr,Kn,sr,gr,vr,yr){var xr="volume, loop, loopCount, pan, offset, delay, interrupt",vn;if(vn=st(t.assets[Gn].play,arguments,xr))return vn;var mn={volume:hr,loop:pr,loopCount:Kn,pan:sr,offset:gr,delay:vr,interrupt:yr},tr=Tt(mn.offset,null,30);tr=="s"&&(mn.offset&&(mn.offset*=1e3),mn.delay&&(mn.delay*=1e3)),mn.loop===!0&&(mn.loop=-1),mn.loopCount&&(mn.loop=mn.loopCount,delete mn.loopCount);var _n=Ge.Sound.play(Gn,mn);return _n.getStage=function(){return fe},_n.dispose=function(){_n.destroy()},_n}}}()}else if(wn=="image")qt.result.width&&(Tn=t.assets[zt.id]=new t.Bitmap({image:qt.result,width:qt.result.width,height:qt.result.height,style:!1}),zt.avoidCORS&&Tn.expand(0));else if(wn=="svg"){cn.loadAssetsCount++,t.svgToBitmap(qt.result,lr,null,null,{svg:qt.result,item:zt,type:wn,ext:On});return}else Tn=t.assets[zt.id]=qt.result;Tn&&typeof Tn!="string"&&typeof Tn!="number"&&wn!="json"&&wn!="xml"&&(Tn.file=qt.item.id,Tn.src=qt.item.src,Tn.item=qt.item),ln=new Ge.Event("assetload"),ln.item=zt,ln.asset=Tn,cn.dispatchEvent(ln),Ct||(ln=new Ge.Event("assetload"),ln.item=zt,ln.asset=Tn,d.dispatchEvent(ln))}}),d.preloadEvent=kn.on("complete",function(qt){Pn=qt,cn.loadAssetsCount--,cn.loadAssetsCount==0&&In()});try{kn.loadManifest(Qt)}catch (e9){+function(){}()}}function In(){var qt=Date.now();ct=Math.max(0,ct-(qt-ar)),setTimeout(function(){d.loadAssetsCount--,d.loadAssetsCount<=0&&(d.isLoading=!1),cn.isLoading=!1,cn.dispatchEvent(Pn),!n(at)&&at.show&&at.hide(),Ct||d.dispatchEvent(Pn)},ct*(nn=="s"?1e3:1))}return cn},this.ac=function(me,He,at){at?(at.commands||(at.commands=[]),at.commands.push([me,He,at])):(He[0].commands||(He[0].commands=[]),He[0].commands.push([me,He]))},t.asset=this.asset=function(me,He,at,Qe,ct){if(!n(me)){me=nt(me);var ot=t.assetIDs[me];if(ot&&(me=ot),t.assets[me]&&(!t.assets[me].type||t.assets[me].type&&t.assets[me].type.substr(0,2)!="AC"))return t.assets[me];if(j.PATH!=null&&(t.PATH=j.PATH),ct){var dt;return d.loadFailObj=="circles"?dt=d.makeCircles(14):dt=d.loadFailObj,dt&&(dt.type="EmptyAsset",dt.id=me,dt.play=function(){if(pt)return tt("Frame - asset("+me+") not found"),{}}),dt}else{var $e=new t.Container(He,at);t.assets[me]=$e,He&&at?$e.type="ACWD":$e.type="AC";var Mt=d.loadAssets({assets:me,path:me.split("/").length==1?t.PATH:null,queueOnly:!0,maxNum:Qe}),Ct=me.split(".");return Ge.Sound.SUPPORTED_EXTENSIONS.indexOf(Ct[Ct.length-1])>=0&&($e.play=function(){return $e.playParams=arguments,$e.proxy=new Ge.EventDispatcher,Object.defineProperty($e.proxy,"volume",{get:function(){return $e.sound?$e.sound.volume:null},set:function(xt){$e.volume=xt,$e.sound&&($e.sound.volume=xt)}}),Object.defineProperty($e.proxy,"pan",{get:function(){return $e.sound?$e.sound.pan:null},set:function(xt){$e.pan=xt,$e.sound&&($e.sound.pan=xt)}}),$e.proxy}),Mt.on("complete",function(){me.id?me=me.id:me.src&&(me=me.src);var xt=d.asset(me,null,null,null,!0),Bt=me.split("."),Rt;if(Ge.Sound.SUPPORTED_EXTENSIONS.indexOf(Bt[Bt.length-1])>=0)$e.play=xt.play,$e.type="Sound",$e.src=xt.src,$e.item=xt.item,$e.playParams&&($e.sound=$e.play.apply(null,$e.playParams),$e.volume!=null&&($e.sound.volume=$e.volume),$e.pan!=null&&($e.sound.pan=$e.pan),$e.sound.on("complete",function(){$e.proxy.dispatchEvent("complete")}));else if(xt.type=="Bitmap"||xt.type=="Image"||xt.type=="Pic"){if(xt.type=="Bitmap"?(xt.addTo($e),$e.bitmap=xt,$e.image=xt.image,$e.id=xt.id,$e.item=xt.item):($e.bitmap=xt.getChildAt(0).clone(),$e.bitmap.addTo($e),$e.image=$e.bitmap.image,$e.id=$e.bitmap.id,$e.item=$e.bitmap.item),$e.mouseChildren=!1,$e.type="Image",$e.commands)for(Rt=0;Rt<$e.commands.length;Rt++)$e.commands[Rt][2]?$e[$e.commands[Rt][0]].apply($e,$e.commands[Rt][1]):t[$e.commands[Rt][0]].apply($e,$e.commands[Rt][1]);$e.commands=null,$e.stage&&$e.stage.update()}else if(xt.type=="EmptyAsset"){if(xt.addTo($e),$e.mouseChildren=!1,$e.type="EmptyAsset",$e.commands)for(Rt=0;Rt<$e.commands.length;Rt++)$e.commands[Rt][2]?$e[$e.commands[Rt][0]].apply($e,$e.commands[Rt][1]):t[$e.commands[Rt][0]].apply($e,$e.commands[Rt][1]);$e.commands=null,$e.stage&&$e.stage.update()}else if(xt.type=="SVG"){if(xt.addTo($e),$e.mouseChildren=!1,$e.type="SVG",$e.bitmap=xt,$e.svg=xt.svg,$e.commands)for(Rt=0;Rt<$e.commands.length;Rt++)$e.commands[Rt][2]?$e[$e.commands[Rt][0]].apply($e,$e.commands[Rt][1]):t[$e.commands[Rt][0]].apply($e,$e.commands[Rt][1]);$e.commands=null,$e.stage&&$e.stage.update()}t.assets[me]=$e,$e.dispatchEvent("assetLoad"),$e.dispatchEvent("complete")}),Mt.on("error",function(xt){var Bt=new Ge.Event("error");Bt.id=xt.id,Bt.item=xt.item,$e.dispatchEvent(Bt)}),$e}}},t.asset.getIDs=function(){var me=[];for(var He in t.assetIDs)me.push(He);return me},t.image=function(me,He,at,Qe,ct){return me.match(/^htt/i)&&(me="https://cors.zimjs.com/"+me),t.asset(me,He,at,Qe,ct)},t.zimObjectIDs={},t.object=this.object=function(me){return t.zimObjectIDs[me]},t.object.getNames=function(){var me=[];for(var He in t.zimObjectIDs)me.push(He);return me},j.zns||(j.asset=this.asset,j.image=t.image,j.object=this.object),this.setDefault=function(){return j.zimDefaultFrame=j.zdf=j.F=d,j.S=fe,j.W=fe.width,j.H=fe.height,d},Object.defineProperty(d,"isDefault",{get:function(){return j.zdf==d},set:function(){tt("Frame(): isDefault is read only - see setDefault()")}}),Object.defineProperty(d,"stage",{get:function(){return fe},set:function(){tt("Frame(): stage is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(d,"width",{get:function(){return V},set:function(){tt("Frame(): width is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(d,"height",{get:function(){return z},set:function(){tt("Frame(): height is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(this,"color",{get:function(){return l},set:function(me){l=me,n(me)?d.canvas.style.backgroundColor="default":(d.canvas.style.backgroundColor=l,!n(l)&&y&&fe.setClearColor(t.convertColor(l)))}});var Pe;Object.defineProperty(this,"outerColor",{get:function(){return Pe},set:function(me){Pe=me,cr("body").css({backgroundColor:Pe})}}),Object.defineProperty(d,"allowDefault",{get:function(){return Y},set:function(me){me?(fe.preventSelection=!1,document.body.style.overflow="visible",d.zil&&(j.removeEventListener("keydown",d.zil[0]),j.removeEventListener("wheel",d.zil[1]),j.removeEventListener("DOMMouseScroll",d.zil[2]),d.zil=null)):(fe.preventSelection=!0,fe.enableDOMEvents(!0),(e=="full"||e=="fit"||e=="fill")&&(document.body.style.overflow="hidden"),n(d.zil)&&(d.zil=Xr())),Y=me,fe.__touch&&(fe.__touch.preventDefault=!Y)}});var oe;Object.defineProperty(d,"cursors",{get:function(){return oe},set:function(me){oe=me&&me.constructor=={}.constructor?me:null,oe?Fe(oe):Ze()}}),d.cursorTypes=["none","auto","pointer","text","wait","crosshair","default","help","move","progress","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize","context-menu","cell","vertical-text","alias","copy","no-drop","not-allowed","ew-resize","ns-resize","nesw-resize","nwse-resize","col-resize","row-resize","all-scroll","grab","grabbing","zoom-in","zoom-out"],d.cursorList=new t.Dictionary(!0);function Fe(me){t.loop(me,function(ot,dt){dt.noMouse&&dt.noMouse()}),d.pme&&Ze(),t.loop(d.cursorList,function(ot){!ot._cursor&&ot.cursor&&me[ot.cursor]&&(ot._cursor=ot.cursor,d.cursorList.add(ot,ot._cursor),ot.cursor="none")}),me.default&&(document.body.style.cursor="none"),d.pme=d.on("pointermove",function(ot){if(d.cursorObj){var dt=d.cursorObj,$e=d.stage.getObjectUnderPoint(d.mouseX,d.mouseY,1);$e&&($e._cursor||$e.cursor)?ct($e):me.default?(Xe("none"),d.cursorObj=me.default,me.default.addTo(d.stage)):Xe(),d.cursorObj!=dt&&dt.removeFrom&&dt.removeFrom(),d.cursorObj.x=d.mouseX,d.cursorObj.y=d.mouseY,d.cursorObj.top(),t.Ticker.isUpdating(d.stage)||d.stage.update()}});var He=!1;if(d.mouseX!=0&&d.mouseY!=0){He=!0;var at=d.stage.getObjectUnderPoint(d.mouseX,d.mouseY,1);at&&(at._cursor||at.cursor)?(Wn("setting"),ct(at)):me.default?(Xe("none"),me.default.x=d.mouseX,me.default.y=d.mouseY,d.cursorObj=me.default,d.cursorObj.mouseChildren=!1,d.cursorObj.mouseEnabled=!1,me.default.addTo(d.stage)):Xe(),d.stage.update()}function Qe(ot){Xe("none"),d.cursorObj=ot,d.cursorObj.x=d.mouseX,d.cursorObj.y=d.mouseY,d.cursorObj.mouseChildren=!1,d.cursorObj.mouseEnabled=!1,d.cursorObj.addTo(d.stage)}d.pee=d.on("pointerenter",function(ot){if(He){He=!1;return}setTimeout(function(){var dt=d.stage.getObjectUnderPoint(d.mouseX,d.mouseY,1);dt&&(dt._cursor||dt.cursor)||(me.default?Qe(me.default):Xe(),d.stage.update())},50)}),d.smo=d.stage.on("mouseover",function(ot){ct(ot.target)});function ct(ot){var dt=d.cursorsExclude;if(dt&&(Array.isArray(dt)||(dt=[dt]),dt.includes(ot))){ot.cursor=d.cursorTypes.includes(ot._cursor)?ot._cursor:"default";return}if(ot._cursor&&me[ot._cursor]){if(me[ot._cursor]==d.cursorObj)return;d.cursorObj&&d.cursorObj.removeFrom(),Qe(me[ot._cursor])}else if(me.default&&(!ot.cursor||!d.cursorTypes.includes(ot.cursor))){if(me.default==d.cursorObj)return;d.cursorObj&&d.cursorObj.removeFrom(),Qe(me.default)}else d.cursorTypes.includes(ot.cursor)||(ot.cursor="default"),d.cursorObj&&d.cursorObj.removeFrom();d.stage.update()}d.ple=d.on("pointerdown",function(ot){d.cursorObj&&t.interval(.001,function(){d.cursorObj&&d.cursorObj.top(),d.stage.update()},2,!0)}),d.pde=d.on("pointerleave",function(ot){He=!1,d.cursorObj&&d.cursorObj.removeFrom(),d.stage.update()}),d.smu=d.stage.on("mouseout",function(ot){d.cursorObj&&d.cursorObj.removeFrom(),me.default?Qe(me.default):Xe()})}function Ze(){d.pme&&d.off("pointermove",d.pme),d.pee&&d.off("pointerenter",d.pee),d.ple&&d.off("pointerdown",d.ple),d.pde&&d.off("pointerleave",d.pde),d.smo&&d.stage.off("mouseover",d.smo),d.smu&&d.stage.off("mouseout",d.smu),d.pme=d.pee=d.ple=d.pde=d.smo=d.smu=null,t.loop(d.cursorList,function(me,He){He!==!0&&(me.cursor=He),me._cursor=null}),t.loop(d.cursorList,function(me){d.cursorList.add(me,!0)}),d.cursorObj&&(d.cursorObj.dispose(),d.cursorObj=null,d.stage.update()),Xe()}function Xe(me){me!="none"&&(d.cursorObj=null),d.canvas.parentElement&&(d.canvas.parentElement.style.cursor=me||"default")}function We(me){d.dispatchEvent(me)}j.addEventListener("contextmenu",We,!1);var de=new Ge.Event("keydown");this.eventRemove=de.remove;function Ve(me){me.remove=d.eventRemove,d.altKey=me.altKey,d.ctrlKey=me.ctrlKey,d.metaKey=me.metaKey,d.shiftKey=me.shiftKey,d.dispatchEvent(me)}j.addEventListener("keydown",Ve);function be(me){d.altKey=me.altKey,d.ctrlKey=me.ctrlKey,d.metaKey=me.metaKey,d.shiftKey=me.shiftKey,me.remove=d.eventRemove,d.dispatchEvent(me)}j.addEventListener("keyup",be);function Te(me){d.dispatchEvent(me)}j.addEventListener("wheel",Te);function Re(me){me.remove=d.eventRemove,d.dispatchEvent(me)}$&&j.DeviceMotionEvent&&j.addEventListener("devicemotion",Re);function Ne(me){me.remove=d.eventRemove;var He=360-me.alpha;Math.abs(He-Ue)>180-45&&Math.abs(He-Ue)<180+45&&(rt=rt==0?180:0),Ue=He,me.rotation={x:me.beta,y:me.gamma,z:(He+rt)%360},d.dispatchEvent(me)}if($&&j.DeviceOrientationEvent){var Ue=0,rt=0;j.addEventListener("deviceorientation",Ne)}this.isFullscreen=!!document.fullscreenElement,this.htmlobc=cr("html").css("backgroundColor"),this.fullscreen=function(me){if(n(me)&&(me=!0),me){if(document.fullscreenElement)return;var He=d.canvas.parent?d.canvas.parent:document.body;He.requestFullscreen?He.requestFullscreen():He.webkitRequestFullscreen?He.webkitRequestFullscreen():He.mozRequestFullscreen?He.mozRequestFullscreen():He.msRequestFullscreen&&He.msRequestFullscreen()}else{if(!document.fullscreenElement)return;document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}this.isFullscreen=me},document.addEventListener("fullscreenchange",function(){d.isFullscreen=!!document.fullscreenElement,document.fullscreenElement?(cr("html").css("backgroundColor",d.color),d.dispatchEvent("fullscreenenter")):(cr("html").css("backgroundColor",d.htmlobc?d.htmlobc:"transparent"),d.dispatchEvent("fullscreenexit"))}),this.remakeCanvas=function(me,He){if(e!="full"){n(me)&&(me=V),n(He)&&(He=z),Cn(T)&&Cn(T).parentNode.removeChild(Cn(T)),V=me,z=He;for(var at=[],Qe=0;Qe<d.stage.numChildren;Qe++)at.push(d.stage.getChildAt(Qe));for(_e(),je(),Qe=0;Qe<at.length;Qe++)d.stage.addChild(at[Qe])}},this.follow=function(me,He,at,Qe,ct,ot,dt,$e,Mt,Ct,xt,Bt,Rt,Ht){var nn="obj, boundary, damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, lag",en;if(en=st(d.follow,arguments,nn))return en;if(d.followObj=null,d.followTicker&&t.Ticker.remove(d.followTicker),n(me))return;me.dirX=me.dirY=0,d.followObj=me,me.followDampX=null,me.followDampY=null,n(He)&&(He=new t.Boundary(0,0,d.stage.width,d.stage.height)),d.followBoundary=He,n(at)&&(at=.05),n(Qe)&&(Qe=at),n(ct)&&(ct=0),n(ot)&&(ot=0),n(dt)&&(dt=0),n($e)&&($e=0),n(Mt)&&(Mt=.02),n(Ct)&&(Ct=Mt),n(xt)&&(xt=!0),n(Bt)&&(Bt=!0),n(Rt)&&(Rt=!1),n(Ht)&&(Ht=!1),me.parent?kt():me.on("added",kt);function kt(){var Qt=me.parent;d.frameBorderLock=Rt,xt&&(d.followDampX=new t.Damp(Qt.x,at),d.offsetDampX=new t.Damp(He.x+ct+(He.width-ct-ot)/2,Mt)),Bt&&(d.followDampY=new t.Damp(Qt.y,Qe),d.offsetDampY=new t.Damp(He.y+dt+(He.height-dt-$e)/2,Ct)),d.followTicker=t.Ticker.add(function(){var Je=d.followBoundary;if(xt){var gt=Je.x+ct+(Je.width-ct-ot)/2;d.followOffsetX=[Ht?Je.x+Je.width-ct:gt,gt,Ht?Je.x+ct:gt],d.followObj&&(Qt.x=d.followDampX.convert(d.offsetDampX.convert(d.followOffsetX[me.motionController?me.motionController.dirX+1:1])-me.x))}if(Bt){var It=Je.y+dt+(Je.height-dt-$e)/2;d.followOffsetY=[Ht?Je.y+Je.height-$e:It,It,Ht?Je.y+dt:It],d.followObj&&(Qt.y=d.followDampY.convert(d.offsetDampY.convert(d.followOffsetY[me.motionController?me.motionController.dirY+1:1])-me.y))}d.frameBorderLock&&(Qt.x>d.followBoundary.x&&(Qt.x=d.followBoundary.x),Qt.y>d.followBoundary.y&&(Qt.y=d.followBoundary.y),Qt.x<d.followBoundary.x+d.followBoundary.width-Qt.width&&(Qt.x=d.followBoundary.x+d.followBoundary.width-Qt.width),Qt.y<d.followBoundary.y+d.followBoundary.height-Qt.height&&(Qt.y=d.followBoundary.y+d.followBoundary.height-Qt.height))})}return me},n(t.blurCheck)&&t.setBlurDetect(),this.keyboardMessage=function(me,He,Ct,Qe,ct){var ot="color, backgroundColor, message, response, percent",dt;if(dt=st(d.keyboardMessage,arguments,ot))return dt;n(me)&&(me=t.yellow),n(He)&&(He="black"),n(Ct)&&(Ct="PRESS SCREEN FOR KEYBOARD CONTROL"),n(Qe)&&(Qe="YOU HAVE KEYBOARD CONTROL"),n(ct)&&(ct=80);function $e(){try{return window.self!==window.top}catch (e10){return!0}}var Mt=$e();Mt&&(d.canvas.style.pointerEvents="none");var Ct=new t.Label({text:Ct,size:40,color:me,backgroundColor:He,paddingV:15,paddingH:30,shiftV:1,align:CENTER}).scaleTo(d.stage,ct).ske(10).reg(CENTER).pos(0,50,CENTER,BOTTOM);document.addEventListener("mousedown",xt),document.addEventListener("pointerdown",xt);function xt(){Mt&&(d.canvas.style.pointerEvents="auto"),document.removeEventListener("mousedown",xt),document.removeEventListener("pointerdown",xt),Ct&&(Ct.text=Qe,Ct.animate({props:{alpha:0},wait:1,call:()=>{Ct.dispose(),Ct=null}}),d.stage.update())}return Ct},this.dispose=function(){d.zil&&d.zil.length&&(j.removeEventListener("keydown",d.zil[0]),j.removeEventListener("wheel",d.zil[1]),j.removeEventListener("DOMMouseScroll",d.zil[2])),se&&se.removeAllEventListeners(),K&&j.removeEventListener("resize",K),j.removeEventListener("resize",Se),j.removeEventListener("contextmenu",We),j.removeEventListener("keydown",Ve),j.removeEventListener("keyup",be),j.removeEventListener("wheel",Te),j.removeEventListener("devicemotion",Re),j.removeEventListener("deviceorientation",Ne),j.removeEventListener("mousedown",N,!0),j.removeEventListener("mousemove",N,!0),j.removeEventListener("mouseup",N),Y||(document.body.style.overflow="auto"),me(fe);function me(He){if(He.dispose)He.dispose();else{if(He.removeAllEventListeners(),He.numChildren)for(var at=He.numChildren-1;at>=0;at--)me(He.getChildAt(at));He.parent&&He.parent.removeChild(He)}He=null}return Cn(T)&&Cn(T).parentNode.removeChild(Cn(T)),d==t.tickerFrame&&(t.tickerFrame=null),d===j.zdf&&(j.zdf=j.S=j.W=j.H=null),fe=null,d=null,!0},this.makeCircles=function(me,He){n(me)&&(me=100);var at=[t.orange,t.green,t.pink,t.blue,t.brown,t.dark],Qe,ct;if(He)for(Qe=new t.Container({style:!1}),Qe.radius=me,ct=0;ct<at.length;ct++)Qe.addChild(new t.Circle(Qe.radius/at.length*(at.length-ct),at[ct],null,null,null,null,null,null,!1));else{Qe=new t.Shape({style:!1});var ot=Qe.graphics;for(Qe.radius=me,ct=0;ct<at.length;ct++)ot.f(at[ct]).dc(0,0,Qe.radius/at.length*(at.length-ct));Qe.setBounds(-Qe.radius,-Qe.radius,Qe.radius*2,Qe.radius*2)}return Qe},this.madeWith=function(me,He,at,Qe,ct,ot,dt){var $e="color, text, edges, box, slats, borderColor, borderWidth",Mt;if(Mt=st(d.madeWith,arguments,$e))return Mt;n(me)&&(me=t.dark),n(He)&&(He="Made with ZIM");var Ct=new t.Container,xt=Ct.icon=d.makeIcon(at,Qe,ct,ot,dt).sca(.5).alp(.92).hov(1).addTo(Ct).tap(function(){xt.alp(.92),xt.stage.update(),ir("https://zimjs.com","_blank")});return Ct.label=new t.Label(He,16,null,me).sca(.7).pos(0,-19,t.CENTER,t.BOTTOM,Ct),Ct},this.makeIcon=function(me,He,at,Qe,ct){var ot="edges, box, slats, borderColor, borderWidth",dt;if(dt=st(d.makeIcon,arguments,ot))return dt;var $e=new t.Container(-20,-13,102,120).reg(-20,-13);n(me)&&(me=t.light),n(He)&&(He=t.dark),at===!0&&(at=[t.silver,t.silver,t.silver,t.silver,t.silver]),new t.Rectangle($e.width,$e.height,He,Qe,ct).loc(-20,-13,$e);var Mt=[[at?at[0]:"#E474C3","AieA0IAAgCIAmhlIEXAAIg5Bng",41.7,19.5],[at?at[1]:"#50C5B7","AiSAzIAnhlID+AAIg5Blg",35.3,33.2],[at?at[2]:"#F48E25","AiFA0IAmhnIDlAAIg5Bng",28.9,46.7],[at?at[3]:"#EBCD36","Ah4AzIAmhlIDLAAIg5Blg",22.4,60.5],[at?at[4]:"#ABD140","AhrA0IAAgFIAlhiICxAAIg5Bng",16.1,74.3],[me,"AlGHRIAnhnIH+AAIgbBngAlGlpIAnhnIJmAAIg5Bng",32.7,46.5]];return t.loop(Mt,function(Ct){var xt=new t.Shape().addTo($e);xt.graphics.f(Ct[0]).p(Ct[1]),xt.setTransform(Ct[2],Ct[3])}),$e.mouseChildren=!1,$e},this.makeAbstract=function(me){n(me)&&(me="black");var He=[[115.8,103.55,"#4ACBEB","Am6GkIAAtHIN0AAIAAClIrZAAIAAKig"],[127.55,73.3,"#A1E543","AAjLSIAAp6IEiAAIAAJ6gAlELOIAAp2IEiAAIAAJ2gAlEihIAAowIKEAAIAAIwg"],[32.55,73.05,"#B545E4","Ak6LQIAA2fIJ1AAIAAWfg"]],at=new t.Rectangle(200,200);t.loop(He,function(ct){var ot=new t.Shape().f(ct[2]).p(ct[3]);ot.setTransform(ct[0]+20,ct[1]+27),ot.addTo(at)},!0);var Qe=new t.Container;return at.sca(.4).addTo(Qe),Qe.mouseChildren=!1,Qe},this.makeCat=function(me){n(me)&&(me=246);var He=[[16.95,241.15,0,"black",[1.5,2,1],"AgKAhIAVhB"],[58.65,244.378,0,"#A7A7A7",[3,2,1],"AmYAAIMxAB"],[105.64,107.14,"#EF7988",0,0,"AAEArQgNAAgjghQgiggAFgIQAFgJBEgCQBEgDAGAGQAHAIgfAkQgfAlgPAAIAAAAg"],[104.84,111.34,0,"black",[1,1,1],"AABA2IAPAYQAJAPAJAGQAKAHAMAAQAbAAAXgWQAQgPAVghQAVghAAgcQAAgnglgYQgbgSgxgCIgrACAAJADIgIAzAhphVQgXAVgMAWQgKAQgIAiQgIAkAFAMQALAfAqAOQAmANAcgIQANgEANgQQALgNAGgT"],[105.05,111.4,"#757B74",0,0,"AheBrQgvgRgQgeQgPgdAQgkQAZg8AEgFQAXgfA8gGQBVgKA+ATQBRAZgYBEQgVA/gnAZQgUAOgZAKQgJAJgVgbQgUgegCAAQgDAAgWAgQgWAUgZAAQgMAAgNgEg"],[86.18,93,"black",0,0,"Aj7g0QiYg0i9AyQA0g3BcgRQBagQBfAaQBkAbBEBBQBNBHASBpQhgiYibg0gAFxiDQAzgdA6AMQA9AMA2A4QgHgBAAACQAAAAgBABQAAAAAAAAQgBAAgBAAQAAAAgBgBQh8gshOAzQhIAvhBCYQALjABzhCg"],[78.5,63.23,"#705F6C","black",[1,1,1],"AHAg5IgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDZQg2g4g9gMQg6gMgzAdQhzBCgLDBQBBiZBIgvQBNgzB9AsQAEACAAgCQAAgCAHABgAqdBuIAAnsIDmHEQgegMgsgBQhXgChFA3gAoEDzQA0g3BdgRQBagQBeAaQBkAbBFBBQBMBIASBpQhfiYibg1QiYg0i+Ayg"],[86.28,98.01,"black","black",[1,1,1],"AJSh/QgEADgHgDQgFgBgBAFQgNBXhNA9QhTBEhagZQgGgCgPAFQgUAHgEAAQCNAeBchOQBGg7AWhigApRhnQAFABAIAAQAGABAAAAQBFBsCVA7QCpBDCrgzQACAAAHAJQAEAFAFAJQjAAzitg/Qing9g/iHg"],[96.95,97.3,"#0C0436",0,0,"AlZBJQgVgVAAgeQAAgcAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAcQAAAegVAVQgVAVgdAAQgeAAgVgVgAD1AcQgVgVAAgdQAAgdAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAdQAAAdgVAVQgVAVgdAAQgeAAgVgVg"],[96.88,97.2,"#EA9424",0,0,"AlpBYQgbgbAAgnQAAglAbgbQAbgbAnAAQAmAAAbAbQAbAbAAAlQAAAngbAbQgbAbgmAAQgnAAgbgbgADnArQgbgbAAgmQAAgmAbgbQAbgbAmAAQAnAAAbAbQAbAbAAAmQAAAmgbAbQgbAbgnAAQgmAAgbgbg"],[96.88,97.2,"#AFCE3A",0,0,"AlzBiQgggfAAgtQAAgrAggfQAfggAtAAQAsAAAgAgQAfAfAAArQAAAtgfAfQggAggsAAQgtAAgfgggADcA1QgfgfAAgsQAAgsAfgfQAgggAsAAQAtAAAfAgQAgAfAAAsQAAAsggAfQgfAggtAAQgsAAggggg"],[78.5,64.1,0,"black",[1,1,1],"AHAhCIgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDQQg2g4g9gMQg6gMgzAdQhzBCgLDBQCqAvBlhgQBJhFAGhagAoADiQAlgiBTgOQBYgOBaARQDrAsA0DTQjAAziog/Qihg+hAiIgAqdBlIAAnsIDmHEQgegMgsgBQhXgChFA3g"],[86.375,93.9,"#EACE35",0,0,"AltB+Qiig9g/iIQAkghBTgOQBZgPBaARQDrAtA0DRQhWAXhSAAQhkAAhcgjgADxB2QALjABzhBQAzgeA6AMQA9ANA2A4QgGBYhJBGQhEBAhiAAQgxAAg4gQg"],[73.45,154.83,"black","black",[2,1,1],"AkjjDIByAMQB/ANBEAFQB/AICXgSIgKFzQj4hflLiNQgDgBAFiag"],[79.42,123.62,"#A7A7A7","black",[2,1,1],"AEBpxIgBgBQAYiNAeiQQA8kgAfgMQAggNBLEqQAlCVAfCXIAXARQAbAXAZAcQBQBZAZBnQAZBngUB+QgKA/gPArQgeASgrAWQhYAuhFAXQg8AUh0AWIhoASIAAQzItygCQAvhKA1hoQBqjRAjiXQAri/AOjLIAFimQgegHhTgeQhEgZhgg/IhTg7QgekPgQkUQggonBEgWQBFgWCbEtQAkBGA3B9QAbA9AYA3QASAqAQAmIgjhQIABAAIJmgYIBUACIBQAK"]],at=new t.Container(157.5,246);t.loop(He,function(ct){var ot=new t.Shape().f(ct[2]).s(ct[3]).ss(ct[4]?ct[4][0]:null,ct[4]?ct[4][1]:null,ct[4]?ct[4][2]:null).p(ct[5]);ot.setTransform(ct[0],ct[1]),ot.addTo(at)},!0);var Qe=new t.Container;return at.sca(me/246).addTo(Qe).mov(0,-.4),S&&Qe.cache(),Qe.mouseChildren=!1,Qe}},t.extend(t.Frame,Ge.EventDispatcher,null,"cjsEventDispatcher",!1),t.Queue=function(){this.cjsEventDispatcher_constructor(),this.type="Queue",this.isLoading=!0},t.extend(t.Queue,Ge.EventDispatcher,null,"cjsEventDispatcher"),t.Pic=function(e,r,i,l,a,s,f){var c="file, width, height, noCors, style, group, inherit",x;if(x=st(t.Pic,arguments,c,this))return x;De("83.03"),this.group=s;var k=a===!1?{}:t.getStyle("Pic",this.group,f);if(n(e)&&(e=k.file!=null?k.file:null),n(l)&&(l=k.noCors!=null?k.noCors:!1),n(e)){pt&&tt("ZIM Pic - needs a file");return}this.zimContainer_constructor(r,i);var v=this,g=e;e=v.file=t.Pick.choose(e),r&&i?this.type="ACWD":this.type="AC";var b=l?t.image(e):t.asset(e);v.mouseChildren=!1,b.type=="Bitmap"||b.type=="Image"?(b.type=="Bitmap"?v.bitmap=b.clone().addTo(v):v.bitmap=b.getChildAt(0).clone().addTo(v),v.id=b.id,v.image=v.bitmap.image,v.src=v.bitmap.src,v.item=v.bitmap.item,v.setBounds(null),v.type="Pic",setTimeout(function(){v.dispatchEvent("ready"),v.dispatchEvent("complete")},20)):b.on("complete",function(){if(v.bitmap=b.getChildAt(0).clone().addTo(v),v.id=b.id,v.setBounds(null),v.type="Pic",v.commands)for(var E=0;E<v.commands.length;E++)v.commands[E][2]?v[v.commands[E][0]].apply(v,v.commands[E][1]):t[v.commands[E][0]].apply(v,v.commands[E][1]);v.image=v.bitmap.image,v.src=v.bitmap.src,v.item=v.bitmap.item,v.commands=null,v.dispatchEvent("ready"),v.dispatchEvent("complete"),v.stage&&v.stage.update()}),v.keyOut=function(E,A,T){return v.type=="AC"&&j.zdf?(j.zdf.ac("keyOut",arguments,v),v):(v.bitmap&&v.bitmap.keyOut(E,A,T),v.stage&&v.stage.update(),v)},a!==!1&&t.styleTransforms(this,k),v.clone=function(E){return this.cloneProps(new t.Pic(E?e:g,r,i,l,a,this.group,f))}},t.extend(t.Pic,t.Container,["clone"],"zimContainer",!1),t.Aud=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="file, volume, loop, loopCount, pan, offset, delay, interrupt, maxNum, style, group, inherit",E;if(E=st(t.Aud,arguments,b,this))return E;De("83.05"),this.cjsEventDispatcher_constructor(),this.type="Aud",this.group=v;var A=k===!1?{}:t.getStyle(this.type,this.group,g);if(n(e)&&(e=A.file!=null?A.file:null),n(e)){pt&&tt("ZIM Sound - needs a file");return}n(r)&&(r=A.volume!=null?A.volume:1),n(i)&&(i=A.loop!=null?A.loop:!1),n(l)&&(l=A.loopCount!=null?A.loopCount:null),n(a)&&(a=A.pan!=null?A.pan:0),n(s)&&(s=A.offset!=null?A.offset:0),n(f)&&(f=A.delay!=null?A.delay:0),n(c)&&(c=A.interrupt!=null?A.interrupt:"none"),n(x)&&(x=A.maxNum!=null?A.maxNum:null);var T=this;e=T.file=t.Pick.choose(e);var h=T.sound=t.asset(e,null,null,x);h.type=="AC"?h.on("complete",function(){T.src=h.src,T.item=h.item,T.dispatchEvent("ready"),T.dispatchEvent("complete")}):setTimeout(function(){T.src=h.src,T.item=h.item,T.dispatchEvent("ready"),T.dispatchEvent("complete")},20),T.volume=r,T.loop=i,T.loopCount=l,T.pan=a,T.offset=s,T.delay=f,T.interrupt=c,T.maxNum=x,T.play=function(w,P,y,C,O,_,Y){var m="volume, loop, loopCount, pan, offset, delay, interrupt",$;return($=st(T.play,arguments,m))?$:(n(w)&&(w=T.volume),n(P)&&(P=T.loop),n(y)&&(y=T.loopCount),n(C)&&(C=T.pan),n(O)&&(O=T.offset),n(_)&&(_=T.delay),n(Y)&&(Y=T.interrupt),T.sound.play(w,P,y,C,O,_,Y))},T.dispose=function(){return T.sound&&T.sound.dispose(),T.sound=null,!0}},t.extend(t.Aud,Ge.EventDispatcher,null,"cjsEventDispatcher"),t.Vid=function(e,r,i,l,a,s,f,c,x,k,v,g){var b="file, width, height, scaling, volume, loop, align, valign, type, style, group, inherit",E;if(E=st(t.Vid,arguments,b,this))return E;De("83.07"),this.group=v;var A=k===!1?{}:t.getStyle("Vid",this.group,g);if(n(e)&&(e=A.file!=null?A.file:null),n(e)){pt&&tt("ZIM Vid - needs a file");return}n(r)&&(r=A.width!=null?A.width:null),n(i)&&(i=A.height!=null?A.height:null),n(l)&&(l="fit"),n(s)&&(s=A.loop!=null?A.loop:!1),n(a)&&(a=A.volume!=null?A.volume:1),n(f)&&(f=A.align!=null?A.align:"center"),n(c)&&(c=A.valign!=null?A.valign:"center"),n(x)&&(x=A.type!=null?A.type:"video/mp4"),this.zimContainer_constructor(r,i),r&&i?this.type="ACWD":this.type="AC";var T=this,h,w=e;e=t.Pick.choose(e),T.file=e,j.PATH!=null&&(t.PATH=j.PATH);var P="";e.split("/").length==1&&t.PATH&&(P=t.PATH),this.mouseChildren=!1;var y=T.source=document.createElement("video");document.body.appendChild(y),y.style.display="none",y.setAttribute("autoplay","autoplay"),y.setAttribute("playsinline","playsinline"),y.setAttribute("crossorigin","anonymous"),s&&y.setAttribute("loop","loop");var C=T.innerSource=document.createElement("source");e.split("?").length==1&&(e+="?playsinline=1"),C.setAttribute("src",P+e),C.setAttribute("type",x),y.appendChild(C),_();var O=0;function _(){O++>5&&T.dispatchEvent("error"),y.addEventListener("stalled",_),y.addEventListener("error",_),y.addEventListener("canplay",Y)}function Y(){T.type="Vid",y.removeEventListener("stalled",_),y.removeEventListener("error",_),y.removeEventListener("canplay",Y),y.pause();var m=y.videoWidth,$=y.videoHeight;if(T.setBounds(0,0,r||m,i||$),h=T.bitmap=new t.Bitmap(y,m,$).addTo(T),h.setBounds(0,0,m,$),h.scaleTo(T,100,100,l).pos(0,0,f,c,T),T.commands)for(var I=0;I<T.commands.length;I++)T.commands[I][2]?T[T.commands[I][0]].apply(T,T.commands[I][1]):t[T.commands[I][0]].apply(T,T.commands[I][1]);T.commands=null,T.dispatchEvent("ready")}T.videoPaused=!0,T.play=function(){if(!h){pt&&tt("ZIM Vid - no file found");return}if(y.play(),y.volume=a,T.videoPaused=!1,!T.ticker)if(T.keyObj){var m=T.keyObj.color,$=T.keyObj.tolerance,I=T.keyObj.replacement;T.ticker=t.Ticker.add(function(){h.keyOut(m,$,I)})}else T.ticker=t.Ticker.add(function(){});return T},T.keyOut=function(m,$,I){return T.ticker?(t.Ticker.remove(T.ticker),T.ticker=t.Ticker.add(function(){h.keyOut(m,$,I)})):T.keyObj={color:m,tolerance:$,replacement:I},T},T.pause=function(m){return n(m)&&(m=!0),T.videoPaused=m,m?(y.pause(),T.ticker&&t.Ticker.remove(T.ticker)):(T.ticker&&t.Ticker.add(T.ticker),y.play()),T},Object.defineProperty(this,"duration",{get:function(){return y.duration},set:function(){}}),Object.defineProperty(this,"currentTime",{get:function(){return y.currentTime},set:function(m){y.currentTime=m}}),Object.defineProperty(this,"volume",{get:function(){return y.volume},set:function(m){a=m,y.volume=m}}),k!==!1&&t.styleTransforms(this,A),T.clone=function(m){return this.cloneProps(new t.Vid(m?e:w,r,i,l,a,s,f,c,x,k,this.group,g))},T.dispose=function(m,$,I){this.ticker&&t.Ticker.remove(this.ticker);var X=T.stage;return T.bitmap.dispose(),h=T.bitmap=null,y.pause(),y.removeAttribute("src"),y.load(),y.remove(),y=null,I||this.zimContainer_dispose(!0),X&&X.update(),!0}},t.extend(t.Vid,t.Container,["clone","dispose"],"zimContainer",!1),t.SVG=function(e,r,i,l,a,s,f,c,x,k,v){var g="svg, width, height, bitmap, splitTypes, geometric, showControls, interactive, style, group, inherit",b;if(b=st(t.SVG,arguments,g,this))return b;De("83.09"),this.group=k;var E=x===!1?{}:t.getStyle("SVG",this.group,v);if(n(e)&&(e=E.svg!=null?E.svg:null),n(e)){pt&&tt("ZIM SVG - needs a svg value");return}n(l)&&(l=E.bitmap!=null?E.bitmap:!0),n(a)&&(a=E.splitTypes!=null?E.splitTypes:!1),n(s)&&(s=E.geometric!=null?E.geometric:!0),n(f)&&(f=E.showControls!=null?E.showControls:!0),n(c)&&(c=E.interactive!=null?E.interactive:!0),this.zimContainer_constructor(r,i);var A=this;l&&(this.mouseChildren=!1);var T=e;e=t.Pick.choose(e),r&&i?this.type="ACWD":this.type="AC";var h=t.assets[e];if(h&&(A.src=h.src,A.file=h.file,A.item=h.item,A.svg=h.svg),h&&h.type=="Bitmap")A.type="SVG",A.bitmap=h.clone(),P();else if(h&&h.type=="AC")h.on("complete",function(){A.type="SVG",A.bitmap=h.bitmap.clone(),P(n(r)&&n(i))});else if(h&&h.type=="ACWB")n(r)&&n(i)&&A.setBounds(0,0,h.width,h.height),h.on("complete",function(){A.type="SVG",A.bitmap=h.bitmap.clone(),P()});else if(h&&h.type=="SVG")A.type="SVG",h.bitmap?A.bitmap=h.bitmap.clone():A.bitmap=h.clone(),P();else if(e&&e.match(/<svg/i)&&(A.svg=e),A.svg&&A.svg.match(/<svg/i))A.type="SVG",P();else{var w=t.asset(e);w.on("complete",function(){A.type="SVG",w.bitmap&&(A.src=w.bitmap.src,A.file=w.bitmap.file,A.item=w.bitmap.item,A.svg=w.bitmap.svg,A.bitmap=w.bitmap.clone()),P(n(r)&&n(i))})}function P(C){if(l)A.bitmap?(A.svg=A.bitmap.svg,A.bitmap.addTo(A),C&&y(),setTimeout(function(){A.dispatchEvent("ready"),A.dispatchEvent("complete")},20)):t.svgToBitmap(A.svg,function(Y){A.bitmap=Y,A.bitmap.addTo(A),y(),A.dispatchEvent("ready"),A.dispatchEvent("complete"),A.stage&&A.stage.update()});else if(A.bitmap&&(A.svg=A.bitmap.svg),e.match(/<svg/i)||h&&h.type=="SVG"||C){var O=new t.SVGContainer(A.svg);O.loop(function(Y){Y&&Y.addTo(A)},!0),C&&y(),setTimeout(function(){A.dispatchEvent("ready"),A.dispatchEvent("complete")},20)}else{var _=t.asset(e);_.on("complete",function(){var Y=new t.SVGContainer(_);Y.loop(function(m){m&&m.addTo(A)},!0),y(),A.dispatchEvent("ready"),A.dispatchEvent("complete"),A.stage&&A.stage.update()})}}function y(){if(n(r)&&n(i)&&A.setBounds(null),A.type="SVG",A.commands)for(var C=0;C<A.commands.length;C++)A.commands[C][2]?A[A.commands[C][0]].apply(A,A.commands[C][1]):t[A.commands[C][0]].apply(A,A.commands[C][1]);A.commands=null}A.keyOut=function(C,O,_){return A.type=="AC"&&j.zdf?(j.zdf.ac("keyOut",arguments,A),A):(A.bitmap&&A.bitmap.keyOut(C,O,_),A.stage&&A.stage.update(),A)},x!==!1&&t.styleTransforms(this,E),A.clone=function(C){return this.cloneProps(new t.SVG(C?e:T,r,i,l,a,s,f,c,x,this.group,v))}},t.extend(t.SVG,t.Container,["clone"],"zimContainer",!1),t.SensorAsk=function(e,r,i,l,a,s,f){var c="callback, sensorType, color, backgroundColor, style, group, inherit",x;if(x=st(t.SensorAsk,arguments,c,this))return x;De("83.01"),this.group=s;var k=a===!1?{}:t.getStyle("SensorAsk",this.group,f);if(n(r)&&(r=k.sensorType!=null?k.sensorType:"deviceorientation"),r!="devicemotion"&&(r="deviceorientation"),this.sensorType=r,!n(e)){n(i)&&(i=k.color!=null?k.color:t.dark),n(l)&&(l=k.backgroundColor!=null?k.backgroundColor:t.lighter),this.zimPane_constructor("",l,i,200,200,!1,null,!0,100,black.toAlpha(.3),null,null,null,!1,!1),this.type="SensorAsk";var v=this;if(Style.addGroup("sensorAsk",{width:100,color:i,rollColor:l,corner:10,backgroundColor:t.faint,rollBackgroundColor:i,borderColor:i,borderWidth:2}),v.yes=new t.Button({label:"YES",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,TOP,this).tap(function(){v.hide(!0);var b=DeviceMotionEvent;r!="devicemotion"&&(b=DeviceOrientationEvent),b.requestPermission().then(function(E){E!="denied"?e(!0):e(!1)})}),v.label=new t.Label("Use sensor?",null,null,i,null,null,null,"center").sca(.9).centerReg(this),v.no=new t.Button({label:"NO",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,BOTTOM,this).tap(function(){v.hide(!1),e(!1)}),new t.Circle(110,t.clear,i,1).center(this).alp(.8),new t.Circle(120,t.clear,i,1).center(this).alp(.5),new t.Circle(130,t.clear,i,1).center(this).alp(.2),a!==!1&&t.styleTransforms(this,k),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function")v.show();else{let b=function(E){r=="deviceorientation"?E.alpha==null||E.alpha==0&&E.beta==0&&E.gamma==0?e(!1):e(!0):!E.acceleration||E.acceleration.x==null||E.acceleration.x==0&&E.acceleration.y==0&&E.acceleration.z==0?e(!1):e(!0),g=!0,j.removeEventListener(r,b)};var g=!1;j.addEventListener(r,b),setTimeout(function(){g||e(!1)},100)}}},t.extend(t.SensorAsk,t.Pane,null,"zimPane",!1),t.colorsHex=["#fb4758","#f58e25","#ebcb35","#acd241","#50c4b7","#993399","#e472c4","#d1a170","#112233","#000000","#111111","#222222","#333333","#444444","#555555","#555555","#666666","#777777","#888888","#999999","#aaaaaa","#bbbbbb","#cccccc","#dddddd","#eeeeee","#ffffff","rgba(0,0,0,.01)","rgba(0,0,0,0)"],t.colors=["red","orange","yellow","green","blue","purple","pink","brown","interstellar","black","darker","licorice","dark","charcoal","grey","gray","granite","tin","pewter","silver","fog","mist","light","moon","lighter","white","faint","clear"],dn=0;dn<t.colors.length;dn++)t[t.colors[dn]]=t.colorsHex[dn];return String.prototype.darken=function(e){return t.darken(this,e)},String.prototype.lighten=function(e){return t.lighten(this,e)},String.prototype.toColor=function(e,r){return t.toColor(this,e,r)},String.prototype.toAlpha=function(e){return t.toAlpha(this,e)},t.FIT="fit",t.FILL="fill",t.FULL="full",t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.MIDDLE="middle",t.START="start",t.END="end",t.TOP="top",t.BOTTOM="bottom",t.OVER="over",t.UNDER="under",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.BOTH="both",t.RADIAL="radial",t.UP="up",t.DOWN="down",t.NEXT="next",t.PREV="prev",t.AUTO="auto",t.AVE="ave",t.DEFAULT="default",t.ALL="all",t.NONE="none",t.GET="get",t.POST="post",t.LOCALSTORAGE="localStorage",t.SOCKET="socket",t.TO="to",t.FROM="from",t.SINE="sine",t.SQUARE="square",t.TRIANGLE="triangle",t.SAW="saw",t.SAWTOOTH="saw",t.ZAP="zap",t.DISTILL=!1,t.distillery=[],t.distill=function(){!j.zns&&t&&(t.DISTILL||j.DISTILL)&&t.distillery.push("83.3","83.35");function e(r,i,l){return l.indexOf(r)===i}t.distillery.length>0?(t.distillery=t.distillery.filter(e),tt("zim.distill() - go to https://zimjs.com/distill and enter the following:"),Wn(t.distillery.join(" "))):tt("must set zim.DISTILL = true;")},t.parseAudioSprite=function(e,r){if(De("83.25"),!(n(e)||n(e.resources)||n(e.spritemap))){var i=e,l=i.resources[0],a=i.spritemap,s=[],f,c={src:l,data:{}};for(var x in a)f=a[x],s.push({id:x,startTime:Math.round(f.start*1e3),duration:Math.round((f.end-f.start)*1e3)});return c.data.audioSprite=s,r&&tt(JSON.stringify(c)),c}},t.previewAudioSprite=function(e,r,i){if(De("83.26"),!n(e)){if(n(r)&&(r=3),typeof i>"u"){if(n(j.zdf))return;var i=j.zdf}var l=i.width,a=e,s=[],f=[];if(a.constructor=={}.constructor)a.resources&&(a=t.parseAudioSprite(a)),a.audioSprite?t.loop(a.audioSprite,function(x){s.push(x[0].substr(0,r)),f.push(x[0])}):a.data&&a.data.audioSprite&&t.loop(a.data.audioSprite,function(x){s.push(x.id.substr(0,r)),f.push(x.id)});else return;var c=new t.Tabs({tabs:s,width:l,currentEnabled:!0}).addTo();return c.on("change",function(){i.asset(f[c.selectedIndex]).play()}),c}},t.svgToBitmap=function(e,r,i,l,a){if(De("83.27"),!n(e.draggable)){var s=new DOMParser;e=e.innerHTML?s.parseFromString(e.innerHTML,"text/xml"):e;var f=e.getElementsByTagName("svg"),c=f?e.getElementsByTagName("svg")[0]:null;e=c}if(!XMLSerializer&&pt){tt("ZIM svgToBitmap() - sorry, not supported in Browser");return}var x=typeof e=="string"?e:new XMLSerializer().serializeToString(e);if(x){var k=x.split(">")[0];if(k.length>1){var v=k.split(/width/i);if(v.length==1){var g=100,b=100,E=k.split(/viewBox/i);if(E.length>1){var A=E[1].split('"')[1];if(A){var T=A.split(" ");T.length>1&&(g=T[T.length-2],b=T[T.length-1])}}x=x.replace(/svg /i,'svg  width="'+g+'" height="'+b+'" ')}}x.match(/xmlns/i)||(x=x.replace(/svg /i,"svg  xmlns='http://www.w3.org/2000/svg' "))}var h=self.URL||self.webkitURL||self,w=new Image;w.onload=function(){var y=new t.Bitmap(w,i,l);r(y,a),h.revokeObjectURL(P)};var P=h.createObjectURL(new document.Blob([x],{type:"image/svg+xml"}));w.src=P},t.makeContent=function(e,r,i){De("83.29");var l;if(n(i)&&(i=t.dark),typeof e=="string"||typeof e=="number")e=this.message=new t.Label(e,null,null,i);else if(e.constructor=={}.constructor){var a=e;a.buttonScale||(a.buttonScale=.5),n(a.spacingH)&&(a.spacingH=20*a.buttonScale),n(a.spacingV)&&(a.spacingV=20);var s=a.spacingH,f=a.spacingV;a.align||(a.align="center"),e=new t.Container;var c=new ei(10,f).addTo(e);if(a.header&&a.header.pos(0,f,"left","top",e),a.message)var x=new t.Label(a.message,null,null,n(a.color)?i:a.color).loc(0,e.height+(a.header?f:0),e);if(a.display&&a.display.pos(0,-a.display.height-(a.header||a.message?f:0),"left","bottom",e),a.buttons){Array.isArray(a.buttons)||(a.buttons=[a.buttons]);for(var k=a.length*100,v=new t.Container().loc(0,e.height+(a.header||a.message||a.display?f:0),e),g=0;g<a.buttons.length;g++){var b=a.buttons[g],E=b.call||function(){};b.button||(b.button=new t.Button({width:b.width,label:b.label,backgroundColor:b.backgroundColor||b.bgColor,color:b.color,rollBackgroundColor:b.rollBackgroundColor||b.rollBgColor,rollColor:b.rollColor})),b.button.call=E,b.button.sca(a.buttonScale).loc(g==0?0:v.width+s,0,v).tap(function(T){T.target.call(T.target)})}}for(l=0;l<e.numChildren;l++){var A=e.getChildAt(l);A.lastY=A.y,a.align=="center"?A.center(e).loc(null,A.lastY):a.align=="right"&&A.pos(0,null,"right")}if(r&&typeof r=="number"&&(e.width=Math.min(e.width,r-s*2-(a.scrollBar===!0?12:a.scrollBar>0?a.scrollBar:0))),new t.Container(10,f).pos(0,-c.height,"center","bottom",e).bot(),c.top(),e.config=a,e.header=a.header,e.message=x,e.text=a.message,e.display=a.display,a.buttons)for(e.buttons=[],l=0;l<v.numChildren;l++)e.buttons.push(v.getChildAt(l))}return e},t}(ye||{});function De(t){ye&&(ye.DISTILL||j.DISTILL)&&ye.distillery.push(t)}function Un(t,Tt,Pt,Ot,St,mt){if(De("83.3"),t&&t.noDrag)return t;mt!==!0&&(mt=null);var Dt={drag:function(Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h){return hn(arguments)?(arguments[0].obj=this,ye.drag(arguments[0])):ye.drag(this,Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h)},noDrag:function(Ke){return ye.noDrag(this,Ke)},mouse:function(){return ye.mouse(this)},noMouse:function(){return ye.noMouse(this)},effect:function(Ke,e,r,i,l){return ye.effect(this,Ke,e,r,i,l)},noEffect:function(Ke,e){return ye.noEffect(this,Ke,e)},updateEffects:function(Ke){return ye.updateEffects(this,Ke)},wire:function(Ke,e,r,i,l,a,s){return hn(arguments)?(arguments[0].source=this,ye.wire(arguments[0])):ye.wire(this,Ke,e,r,i,l,a,s)},noWire:function(Ke,e,r){return hn(arguments)?(arguments[0].source=this,ye.noWire(arguments[0])):ye.noWire(this,Ke,e,r)},wired:function(Ke,e,r,i,l,a,s){return hn(arguments)?(arguments[0].target=this,ye.wired(arguments[0])):ye.wired(this,Ke,e,r,i,l,a,s)},noWired:function(Ke,e,r){return hn(arguments)?(arguments[0].target=this,ye.noWired(arguments[0])):ye.noWired(this,Ke,e,r)},bind:function(Ke,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.bind(arguments[0])):ye.bind(this,Ke,e,r,i,l)},noBind:function(Ke,e,r,i){return hn(arguments)?(arguments[0].obj=this,ye.noBind(arguments[0])):ye.noBind(this,Ke,e,r,i)},dragBoundary:function(Ke){return ye.dragBoundary(this,Ke)},dragRect:function(Ke){return ye.dragBoundary(this,Ke)},transform:function(Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X){return hn(arguments)?(arguments[0].obj=this,ye.transform(arguments[0])):ye.transform(this,Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X)},setSwipe:function(Ke){return ye.setSwipe(this,Ke)},gesture:function(Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E){return hn(arguments)?(arguments[0].obj=this,ye.gesture(arguments[0])):ye.gesture(this,Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E)},noGesture:function(Ke,e,r){return hn(arguments)?(arguments[0].obj=this,ye.noGesture(arguments[0])):ye.noGesture(this,Ke,e,r)},gestureBoundary:function(Ke,e){return ye.gestureBoundary(this,Ke,e)},gestureRect:function(Ke,e){return ye.gestureBoundary(this,Ke,e)},addPhysics:function(Ke,e,r,i,l,a,s,f,c,x,k){return hn(arguments)?(arguments[0].obj=this,ye.addPhysics(arguments[0])):ye.addPhysics(this,Ke,e,r,i,l,a,s,f,c,x,k)},removePhysics:function(){return ye.removePhysics(this)},hitTestPoint:function(Ke,e,r){return ye.hitTestPoint(this,Ke,e,r)},hitTestReg:function(Ke,e){return ye.hitTestReg(this,Ke,e)},hitTestRect:function(Ke,e,r,i){return ye.hitTestRect(this,Ke,e,r,i)},hitTestCircle:function(Ke,e,r,i){return ye.hitTestCircle(this,Ke,e,r,i)},hitTestCircleRect:function(Ke,e){return ye.hitTestCircleRect(this,Ke,e)},hitTestCircles:function(Ke,e){return ye.hitTestCircles(this,Ke,e)},hitTestBounds:function(Ke,e,r){return ye.hitTestBounds(this,Ke,e,r)},boundsToGlobal:function(Ke,e,r,i){return ye.boundsToGlobal(this,Ke,e,r,i)},resetBounds:function(Ke,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.resetBounds(arguments[0])):ye.resetBounds(this,Ke,e,r,i,l)},hitTestPath:function(Ke,e,r,i,l){return ye.hitTestPath(this,Ke,e,r,i,l)},hitTestGrid:function(Ke,e,r,i,l,a,s,f,c,x,k,v){return ye.hitTestGrid(this,Ke,e,r,i,l,a,s,f,c,x,k,v)},animate:function(Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le){return Ke&&(Ke.props||Ke.obj)&&hn(arguments)?(arguments[0].target=this,ye.animate(arguments[0])):ye.animate(this,Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E,A,T,h,w,P,y,C,O,_,Y,m,$,I,X,R,q,J,Z,ne,U,B,d,u,o,S,F,p,L,we,D,N,ue,fe,V,z,se,Oe,K,ge,Q,ce,G,le)},pauseAnimate:function(){return this},stopAnimate:function(){return this},wiggle:function(Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E){return hn(arguments)?(arguments[0].target=this,ye.wiggle(arguments[0])):ye.wiggle(this,Ke,e,r,i,l,a,s,f,c,x,k,v,g,b,E)},loop:function(Ke,e,r,i,l,a,s,f,c,x){return hn(arguments)?(arguments[0].obj=this,ye.loop(arguments[0])):ye.loop(this,Ke,e,r,i,l,a,s,f,c,x)},copyMatrix:function(Ke){return ye.copyMatrix(this,Ke)},duplicate:function(Ke){return ye.duplicate(this,Ke)},cur:function(Ke){return ye.cur(this,Ke)},sha:function(Ke,e,r,i){return ye.sha(this,Ke,e,r,i)},pos:function(Ke,e,r,i,l,a,s,f,c,x){return hn(arguments)?(arguments[0].obj=this,ye.pos(arguments[0])):ye.pos(this,Ke,e,r,i,l,a,s,f,c,x)},loc:function(Ke,e,r,i,l,a,s){return hn(arguments)?(arguments[0].obj=this,ye.loc(arguments[0])):ye.loc(this,Ke,e,r,i,l,a,s)},mov:function(Ke,e){return hn(arguments)?(arguments[0].obj=this,ye.mov(arguments[0])):ye.mov(this,Ke,e)},top:function(){return ye.top(this)},bot:function(){return ye.bot(this)},ord:function(Ke){return ye.ord(this,Ke)},dep:function(Ke){return ye.dep(this,Ke)},nam:function(Ke){return ye.nam(this,Ke)},alp:function(Ke){return ye.alp(this,Ke)},vis:function(Ke){return ye.vis(this,Ke)},ble:function(Ke){return ye.ble(this,Ke)},dye:function(Ke){return ye.dye(this,Ke)},hov:function(Ke,e){return ye.hov(this,Ke,e)},rot:function(Ke,e,r){return ye.rot(this,Ke,e,r)},siz:function(Ke,e,r){return ye.siz(this,Ke,e,r)},ske:function(Ke,e){return ye.ske(this,Ke,e)},reg:function(Ke,e,r){return ye.reg(this,Ke,e,r)},sca:function(Ke,e){return ye.sca(this,Ke,e)},scaleTo:function(Ke,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.scaleTo(arguments[0])):ye.scaleTo(this,Ke,e,r,i,l)},fit:function(Ke,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.fit(arguments[0])):ye.fit(this,Ke,e,r,i,l)},outline:function(Ke,e,r){return hn(arguments)?(arguments[0].obj=this,ye.outline(arguments[0])):ye.outline(this,Ke,e,r)},blendmodes:function(Ke){return ye.blendmodes(this,Ke)},addTo:function(Ke,e,r){return hn(arguments)?(arguments[0].obj=this,ye.addTo(arguments[0])):ye.addTo(this,Ke,e,r)},removeFrom:function(Ke){return ye.removeFrom(this,Ke)},added:function(Ke,e,r){return ye.added(this,Ke,e,r)},movement:function(Ke,e){return ye.movement(this,Ke,e)},noMovement:function(){return ye.noMovement(this)},tap:function(Ke,e,r,i,l,a,s,f,c){return hn(arguments)?(arguments[0].obj=this,ye.tap(arguments[0])):ye.tap(this,Ke,e,r,i,l,a,s,f,c)},noTap:function(){return ye.noTap(this)},hold:function(Ke,e,r,i){return ye.hold(this,Ke,e,r,i)},noHold:function(){return ye.noHold(this)},change:function(Ke,e){return ye.change(this,Ke,e)},noChange:function(){return ye.noChange(this)},centerReg:function(Ke,e,r){return hn(arguments)?(arguments[0].obj=this,ye.centerReg(arguments[0])):ye.centerReg(this,Ke,e,r)},center:function(Ke,e,r){return hn(arguments)?(arguments[0].obj=this,ye.center(arguments[0])):ye.center(this,Ke,e,r)},place:function(Ke){return ye.place(this,Ke)},placeReg:function(Ke){return ye.placeReg(this,Ke)},expand:function(Ke,e,r,i){return hn(arguments)?(arguments[0].obj=this,ye.expand(arguments[0])):ye.expand(this,Ke,e,r,i)},setMask:function(Ke,e){return ye.setMask(this,Ke,e)},cloneProps:function(Ke){return Ke.type=this.type,Ke.group=this.group,Ke.style=this.style,Ke.alpha=this.alpha,Ke.rotation=this.rotation,Ke.mouseEnabled=this.mouseEnabled,Ke.mouseChildren=this.mouseChildren,Ke.tickEnabled=this.tickEnabled,Ke.x=this.x,Ke.y=this.y,Ke.scaleX=this.scaleX,Ke.scaleY=this.scaleY,Ke.skewX=this.skewX,Ke.skewY=this.skewY,Ke.name&&(Ke.name=this.name),Ke.regX=this.regX*Ke.width/(this.width||1),Ke.regY=this.regY*Ke.height/(this.height||1),Ke.visible=this.visible,Ke.shadow=this.shadow,(!this.type||this.type=="Shape")&&ye.copyMatrix(Ke,this),Ke.compositeOperation=this.compositeOperation,Ke.snapToPixel=this.snapToPixel,this.filters&&this.filters.length>0&&(Ke.filters=this.filters.slice(0),Ke.cache()),Ke.mask=this.mask,Ke.hitArea=this.hitArea,(!this.type||this.type=="Shape"||this.type=="Blob"||this.type=="Squiggle")&&this._bounds&&Ke.setBounds(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height),Ke},cloneChildren:function(Ke,e){Ke.children.length&&Ke.removeAllChildren();for(var r=Ke.children,i=0,l=this.children.length;i<l;i++){var a=this.children[i].clone(e);a.parent=Ke,r.push(a)}return Ke}};if(!n(mt)){mt=[];for(var Zt in Dt)mt.push(Zt);return mt}for(var At in Dt)Object.prototype.hasOwnProperty.call(Dt,At)&&(t[At]=Dt[At]);if(ye&&(t.cjsLocalToGlobal=t.localToGlobal,t.cjsGlobalToLocal=t.globalToLocal,t.cjsLocalToLocal=t.localToLocal,t.localToGlobal=function(Ke,e){return ye.localToGlobal(Ke,e,t,t.cjsLocalToGlobal)},t.globalToLocal=function(Ke,e){return ye.globalToLocal(Ke,e,t,t.cjsGlobalToLocal)},t.localToLocal=function(Ke,e,r){return ye.localToLocal(Ke,e,r,t)},t.hueBatch||ye.displayBase(t)),!n(Tt)&&!n(Pt)&&!n(Ot)&&!n(St)?Tt=Tt:!n(Tt)&&!n(Pt)&&(Ot=Tt,St=Pt,Tt=0,Pt=0),!n(Tt)&&!n(Pt)&&!n(Ot)&&!n(St))t.setBounds(Tt,Pt,Ot,St);else if(t.nominalBounds!=null&&t.getBounds&&t.getBounds()==null){var Nt=t.nominalBounds;t.setBounds(Nt.x,Nt.y,Nt.width,Nt.height)}return t.parent&&t.parent.actionFrames&&!t.parent.addPhysics&&Un(t.parent,zdf?zdf.width:null,zdf?zdf.height:null),t}var mi;function Ai(t){De("83.35"),document.Window=Window,document.Blob=Blob,mi="ignore",n(t)&&(t=[]),Array.isArray(t)||(t=[t]);var Tt=Un(null,null,null,null,null,!0),Pt=["loop","stopAnimate","pauseAnimate","animate","wiggle","wire","wired"];for(var Ot in ye)(Tt.indexOf(Ot)==-1||Pt.indexOf(Ot)>=0)&&t.indexOf(Ot)==-1&&(window[Ot]=ye[Ot])}ye.fastFrame=function(t,Tt){if(De("83.355"),Ge=t,n(j.zdf))return Tt.frame=new ye.Frame({shim:{stage:Tt,canvas:Tt.canvas}}),j.zimDefaultFrame=j.zdf=Tt.frame,ye.scaX=Ge.stageTransformable?1:Tt.scaleX,ye.scaY=Ge.stageTransformable?1:Tt.scaleY,Tt.frame};ye.addWires=function(t){return De("83.365"),t.wire=function(){return Array.prototype.unshift.call(arguments,t),ye.wire.apply(null,arguments),t},t.noWire=function(){return Array.prototype.unshift.call(arguments,t),ye.noWire.apply(null,arguments),t},t.wired=function(){return Array.prototype.unshift.call(arguments,t),ye.wired.apply(null,arguments),t},t.noWired=function(){return Array.prototype.unshift.call(arguments,t),ye.noWired.apply(null,arguments),t},t};ye.setBlurDetect=function(){De("83.36"),ye.blurCheck=!0,ye.pauseAnimateOnBlur=!0,ye.pauseOnBlur=[],ye.blurDetect=function(){var t,Tt,Pt={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(t in Pt)if(t in document){Tt=Pt[t];break}return function(Ot){return Ot&&document.addEventListener(Tt,Ot),!document[t]}}(),ye.blurDetect(function(){var t,Tt,Pt;if(ye.blurDetect())setTimeout(function(){if(ye.pauseOnBlur)for(t=0;t<ye.pauseOnBlur.length;t++)Tt=ye.pauseOnBlur[t],Tt.pauseOnBlurPaused||Tt.pause(!1);if(ye.pauseAnimateOnBlur&&ye.animatedObjects){var Ot=[],St;for(t=0;t<ye.animatedObjects.objects.length;t++){Tt=ye.animatedObjects.objects[t];var mt=ye.copy(Tt.tweenStates);if(!Tt.tweenStates)Tt.pauseAnimate(!1);else if(n(mt.all)||mt.all){if(Tt.pauseAnimate(!1),!Tt.dynamicAnimation)for(Pt in mt)Pt!="all"&&mt[Pt]===!1&&Tt.pauseAnimate(!0,Pt)}else{Tt.pauseAnimate(!0);for(Pt in mt)Pt!="all"&&mt[Pt]&&Tt.pauseAnimate(!1,Pt)}Tt.type=="Sprite"&&(Tt.paused=!0),Tt.parent&&Tt.parent.type=="Particles"&&Tt.parent.emitter&&Tt.parent.emitter.focusWarm&&(St=Tt.parent.emitter,Ot.indexOf(Tt.parent.emitter)<0&&Ot.push(Tt.parent.emitter))}if(Ot.length>0)for(t=0;t<Ot.length;t++)Ot[t].doWarm(Ot[t].focusWarm)}},300),j.zdf&&j.zdf.dispatchEvent("tabfocus");else{if(ye.pauseOnBlur)for(t=0;t<ye.pauseOnBlur.length;t++)Tt=ye.pauseOnBlur[t],Tt.pauseOnBlurPaused=Tt.paused,Tt.pause(!0);ye.pauseAnimateOnBlur&&ye.animatedObjects&&ye.pauseAnimate(!0,"pauseOnBlur"),j.zdf&&j.zdf.dispatchEvent("tabblur")}})};var ai=!1;ye=function(t){t.ZIMON={stringify:function(Pt,Ot){if(De("83.39"),n(Pt))return;if(!ai){pt&&tt("ZIMON - set ZIMONON=true before using ZIMON.stringify()");return}return Pt=t.copy(Pt),St(Pt),JSON.stringify({obj:Pt,key:Ot,zimon:1,info:"https://zimjs.com/zimon/"});function St(mt,Dt,Zt){if(!n(mt))if(Array.isArray(mt))t.loop(mt,function(Nt,Ke){St(Nt,mt,Ke)});else if(mt.constructor=={}.constructor)t.loop(mt,function(Nt,Ke){St(Ke,mt,Nt)});else if(mt.type){var At={zimon:mt.type};mt.arguments&&(At.args=Array.prototype.slice.call(mt.arguments),St(At.args)),mt.type=="series"&&(At.args=Array.prototype.slice.call(mt.array),St(At.args)),Ot&&Ot[mt.type]&&Ot[mt.type].props&&(At.props=[],t.loop(Ot[mt.type].props,function(Nt){At.props.push(mt[Nt])})),Dt?Dt[Zt]=At:Pt=At}else typeof mt!="string"&&typeof mt!="number"&&typeof mt!="boolean"&&mt!==null&&pt&&tt("ZIMON - potentially bad JSON value"+mt)}},parse:function(Pt,Ot){if(De("83.39"),n(Pt))return;var St=JSON.parse(Pt),mt=St.obj;return Ot=St.key,Zt(mt),mt;function Dt(At){try{return Function("return("+At+")")()}catch (e11){return pt&&tt("ZIMON - bad function scope or name: "+At),null}}function Zt(At,Nt,Ke){if(!n(At)){if(Array.isArray(At))t.loop(At,function(s,f){Zt(s,At,f)});else if(n(At.zimon)&&At.constructor=={}.constructor)t.loop(At,function(s,f){Zt(f,At,s)});else if(At.zimon){var e=At.zimon,r="";Ot&&(Ot[e]&&Ot[e].scope?r=Ot[e].scope+".":Ot.scope&&(r=Ot.scope+"."));var i=Dt(r+e),l=At.args;n(l)&&(l=[]),Zt(l);var a;At.type=="series"?a=t.series(l):a=i?new(i.bind.apply(i,[null].concat(Array.prototype.slice.call(l)))):null,Nt?Nt[Ke]=a:mt=a,Ot&&Ot[e]&&Ot[e].props&&a&&t.loop(Ot[e].props,function(s,f){n(At.props[f])||(a[s]=At.props[f])})}}}}},t.Wonder=function(Pt,Ot,St,mt,Dt){var Zt="wid, client, app, notes, server",At;if(At=st(t.Wonder,arguments,Zt,this))return At;if(De("82"),n(Pt)){tt("zim.Wonder() - please provide Wonder ID (see https://zimjs.com/wonder/)");return}n(Dt)&&(Dt="https://wonder.zimjs.org/wonder");var Nt=this;n(t.wonderSession)&&(t.wonderSession="W"+t.rand(1e5,999999));var Ke=[],e=setInterval(i,1e3),r=0;function i(){Ke.length>0&&(t.async(Dt+"?wonder="+JSON.stringify(Ke)),Ke=[],r++)}var l,a=setInterval(function(){r>28&&(Ke.push({id:Pt,c:Ot,a:St,n:mt,k:l,t:"e",v:"frequency max - terminated",s:t.wonderSession}),tt("zim.Wonder() - frequency max - terminated"),Nt.dispose()),r=0},30*1e3);this.countsOff={},this.timesOff={},this.ordersOff={};function s(x,k){return n(x)?(tt("zim.Wonder "+k+" - please provide a keyword"),!1):!Nt[k+"sOff"][x]}this.count=function(x){s(x,"count")&&(l=x,Ke.push({id:Pt,c:Ot,a:St,n:mt,k:x,t:"c",v:1,s:t.wonderSession}))};var f={};this.timeStart=function(x){s(x,"time")&&(Nt.timeEnd(x),l=x,f[x]=new Date().getTime())};var c={};this.timePause=function(x){s(x,"time")&&(c[x]||(c[x]=new Date().getTime()))},this.timeUnpause=function(x){if(s(x,"time")&&c[x]){var k=new Date().getTime()-c[x];f[x]&&(f[x]+=k),delete c[x]}},this.timeEnd=function(x){if(s(x,"time")&&f[x]){var k=c[x]?c[x]:new Date().getTime(),v=Math.round((k-f[x])/1e3);delete c[x],delete f[x],Ke.push({id:Pt,c:Ot,a:St,n:mt,k:x,t:"t",v,s:t.wonderSession})}},this.order=function(x,k){if(s(x,"order")){if(l=x,n(k)){tt("zim.Wonder order() - please provide an item");return}Ke.push({id:Pt,c:Ot,a:St,n:mt,k:x,t:"o",v:k,s:t.wonderSession})}},this.countOff=function(x){Nt.countsOff[x]=1},this.countOn=function(x){delete Nt.countOff[x]},this.timeOff=function(x){Nt.timesOff[x]=1},this.timeOn=function(x){delete Nt.timesOff[x]},this.orderOff=function(x){Nt.ordersOff[x]=1},this.orderOn=function(x){delete Nt.ordersOff[x]},this.dispose=function(){return i(),clearInterval(e),clearInterval(a),!0}},t.VERSION="015/zim",t.getLatestVersions=function(Pt){De("82.2");var Ot="https://zimjs.com/live/getLatestVersions.php";function St(mt){Pt(JSON.parse(mt))}t.async(Ot,St,"returnLatestVersions")},typeof Ge<"u"&&(t.PWA=function(Pt,Ot,St,mt,Dt,Zt,At){var Nt="call, label, backgroundColor, color, backdropColor, pane, noScale",Ke;if(Ke=st(t.PWA,arguments,Nt,this))return Ke;De("82.4"),this.cjsEventDispatcher_constructor(),this.type="PWA";var e,r=this,i=j.M=="ios"?`In Safari, please add to
home screen as an app`:`Please add to
home screen as an app`;if(n(Ot)&&(Ot=new t.Label({text:i,align:t.LEFT,lineHeight:44,color:mt})),n(St)&&(St=t.yellow),n(Zt)){Zt=new t.Pane({width:1200,height:230,content:Ot,backgroundColor:St,backdropColor:Dt});var l=new t.Container;new t.Shape().s(t.dark).ss(3,1,0,3).p("AAAj0IAAFJAA8hoIBuAAIAAFdIlTAAIAAldIBuAA").sca(1.7).addTo(l),new t.Shape().s(t.dark).ss(3,1,0,3).p("AhGAlIBGhGIBHBG").sca(1.7).addTo(l).mov(0,-38);var a=new t.Tile([l,Ot],2,1,40,0,!0);a.width>zdf.stage.width*.7&&(a.width=zdf.stage.width*.7),a.setBounds(-70,-10,480,100),l.mov(-30,35),a.center(Zt)}M&&!(j.matchMedia("(display-mode: standalone)").matches||j.navigator.standalone||document.referrer.includes("android-app://"))?s():(Pt&&Pt.constructor===Function&&Pt(),setTimeout(function(){r.dispatchEvent("ready")},20));function s(){r.pane=e=Zt.show(),e.on("close",function(){Pt&&Pt.constructor===Function&&Pt(),r.scaleEvent&&f.off("resize",r.scaleEvent),r.dispatchEvent("ready"),j.zdf.stage.update()});var f=f||j.zdf;f&&!At&&(e.scaleTo(f.stage,105).center(),(f.scaling=="full"||f.scaling=="tag")&&(r.scaleEvent=f.on("resize",function(){e.scaleTo(f.stage,105).center()})),f.stage.update())}this.show=function(){return s(),this}},t.extend(t.PWA,Ge.EventDispatcher,null,"cjsEventDispatcher",!1)),t.QR=function(Pt,Ot,St,mt,Dt,Zt){var At="url, color, backgroundColor, size, clickable, correctLevel",Nt;if(Nt=st(t.QR,arguments,At,this))return Nt;De("82.5"),n(Pt)&&(Pt="https://zimjs.com"),n(mt)&&(mt=256),n(Ot)&&(Ot=t.black),n(St)&&(St=t.white),n(Dt)&&(Dt=!0),n(Zt)&&(Zt=2);var Ke=document.createElement("div");if(typeof QRCode>"u"){tt("ZIM QR - needs qrcode.js library - see docs");return}var e=new QRCode(Ke,{text:Pt,width:mt,height:mt,colorDark:Ot,colorLight:St,correctLevel:Zt});this.zimBitmap_constructor(e._oDrawing._oContext.canvas),Dt&&this.cur().on("click",function(){ir(Pt,"_blank")}),Ke=null},t.extend(t.QR,t.Bitmap,null,"zimBitmap",!1),t.GIF=function(Pt,Ot,St,mt){var Dt="file, width, height, startPaused",Zt;if(Zt=st(t.GIF,arguments,Dt,this))return Zt;if(De("82.7"),typeof gifler>"u"){tt("ZIM GIF - needs gifler.js library - see docs");return}n(Ot)&&(Ot=100),n(St)&&(St=100);var At=this;At.paused=!1,this.zimBitmap_constructor(null,Ot,St),this.cache();var Nt,Ke,e;if(j.PATH!=null&&(t.PATH=j.PATH),Pt.match(/http/)||Pt.match(/^\//)?e=Pt:e=(t.PATH?t.PATH:"")+Pt,At.gifler=gifler(e).animate(this.cacheCanvas).then(function(a){At.animator=a,mt&&(Nt=setInterval(function(){At.animator.running()&&(Ke=setTimeout(function(){At.animator.stop(),At.paused=!0},.1),clearInterval(Nt))},.05))}),!At.ticker)if(At.keyObj){var r=At.keyObj.color,i=At.keyObj.tolerance,l=At.keyObj.replacement;At.ticker=t.Ticker.add(function(){At.keyOut(r,i,l)})}else At.ticker=t.Ticker.add(function(){});At.keyOut=function(a,s,f){return At.ticker?(t.Ticker.remove(At.ticker),At.ticker=t.Ticker.add(function(){At.keyOut(a,s,f)})):At.keyObj={color:a,tolerance:s,replacement:f},At},this.pause=function(a){return n(a)&&(a=!0),At.animator&&(Nt&&clearInterval(Nt),Ke&&clearTimeout(Ke),a&&At.animator.running()?(At.animator.stop(),t.Ticker.remove(At.ticker)):!a&&!At.animator.running()&&(At.animator.start(),t.Ticker.add(At.ticker))),At.paused=a,At},this.stop=function(){At.dispose()},this.reset=function(){return At.animator.reset(),At.paused&&(At.animator.start(),t.Ticker.add(At.ticker)),At},this.clone=function(){return this.cloneProps(new t.GIF(Pt,Ot,St,mt))},this.dispose=function(){At.animator.stop(),At.parent&&At.removeFrom(),t.Ticker.remove(At.ticker),t.gD(this)}},t.extend(t.GIF,t.Bitmap,["clone","dispose","keyOut"],"zimBitmap",!1),t.Theme={set:function(Pt,Ot,St,mt,Dt){var Zt="name, lightenRatio, tint, tintRatio, exclude",At;if(At=st(t.Theme.set,arguments,Zt))return At;De("82.8"),n(Pt)&&(Pt="zim");var Nt=Pt.toLowerCase();n(Ot)&&(Ot=0),St==-1&&(St=null),n(mt)&&(mt=0),Dt==-1&&(Dt=null),!n(Dt)&&!Array.isArray(Dt)&&(Dt=[Dt]),t.THEME=window.THEME={name:Nt,lightenRatio:Ot,tint:St,tintRatio:mt,exclude:Dt};var Ke={},e,r=t.colors.slice(0,8),i=t.colors.slice(8,25);Nt=="zim"?t.loop(t.colors,function(l,a){l=="clear"||l=="faint"||(Ke[l]=t.colorsHex[a])}):Nt=="html"?(t.loop(r,function(l){Ke[l]=l}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8]})):Nt=="future"?(e=["f25019","fd8918","ffc955","1dcfae","00a5ab","007175","00969b","d6b361"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor("#1dcfae",.4-a*.025)})):Nt=="invert"?(Ke={},t.loop(t.colorsHex,function(l,a,s){if(a==s-2)return 1;Ke[t.colors[a]]=t.invertColor(l)})):Nt=="greyscale"?(e=["222222","aaaaaa","dddddd","888888","333333","111111","777777","bbbbbb"],t.loop(r,function(l,a){Ke[l]="#"+e[a]})):Nt=="neon"?(e=["FF3624","ff6f00","e2f705","a3f307","05f9e2","ED0AF5","ff33c9","e16d00"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor("#000",.9)}),Ke.light=t.lighter,Ke.moon=t.lighter,Ke.lighter=t.white,Ke.white=t.white):Nt=="seventies"?(e=["e5771e","f4a127","ffecb4","6F8212","75c8ae","5a3d2b","956e4e","4c3607"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor(a<8?"#344f00":"#f4a127",.8-a*.04)})):Nt=="warm"?(e=["965746","c07768","ffecb4","8da279","6da0b1","745c58","9a7e79","be8858"],t.loop(r,function(l,a){Ke[l]="#"+e[a]}),t.loop(i,function(l,a){Ke[l]=t.colorsHex[a+8].toColor(a<8?"#4e352e":"#745c58",.8-a*.05)})):Nt.constructor=={}.constructor&&(Ke=Nt,t.loop(Ke,function(l){t.colors.indexOf(l)==-1&&delete Ke[l]})),t.loop(Dt,function(l){l.toLowerCase()=="colors"?t.loop(t.colors,function(a,s){if(s>=8)return 1;Dt.push(a)}):(l.toLowerCase()=="greys"||l.toLowerCase()=="grays")&&t.loop(t.colors,function(a,s){s<8||Dt.push(a)})}),t.loop(Ke,function(l,a){Dt&&Dt.indexOf(l)!=-1||(St&&(a=a.toColor(St,mt)),Ot!=0&&(a=a.lighten(Ot)),Et||(window[l]=a),t[l]=a)})},apply:function(Pt,Ot,St,mt,Dt){var Zt="name, lightenRatio, tint, tintRatio, exclude",At;if(At=st(t.Theme.apply,arguments,Zt))return At;if(localStorage){n(Pt)&&(Pt="zim");var Nt=Pt.toLowerCase();n(Ot)&&(Ot=0),n(St)&&(St=-1),n(mt)&&(mt=0),n(Dt)?Dt=-1:Array.isArray(Dt)||(Dt=[Dt]),localStorage.setItem(Tt,JSON.stringify({name:Nt,lightenRatio:Ot,tint:St,tintRatio:mt,exclude:Dt})),window.location.reload()}else tt("ZIM applyTheme() - needs localStorage")},clear:function(){localStorage&&localStorage.getItem(Tt)&&localStorage.removeItem(Tt),window.location.reload()}};var Tt=window.location.href.replace(/[.\/:]/g,"");return localStorage&&localStorage.getItem(Tt)?(t.THEME=window.THEME=JSON.parse(localStorage.getItem(Tt)),t.Theme.set(ur.name,ur.lightenRatio,ur.tint,ur.tintRatio,ur.exclude)):t.THEME=window.THEME=null,t}(ye||{});var $r=[["zog",Wn],["zid",Cn],["zss",xi],["zgo",ir],["zum",Hn],["zot",n],["zop",wi],["zil",Xr],["zet",cr],["zob",st],["zik",nt],["zta",Ci],["zor",Ti],["zogg",ri],["zogp",yi],["zogb",Yr],["zogr",ii],["zogy",tt],["zogo",li],["zogl",Er],["zogd",Pr],["zimplify",Ai],["zimify",Un]];for(dn=0;dn<$r.length;dn++)Jn=$r[dn],j[Jn[0]]=ye[Jn[0]]=Jn[1];var Jn,jr=[["FIT",ye.FIT],["FILL",ye.FILL],["FULL",ye.FULL],["LEFT",ye.LEFT],["RIGHT",ye.RIGHT],["CENTER",ye.CENTER],["MIDDLE",ye.MIDDLE],["START",ye.START],["END",ye.END],["TOP",ye.TOP],["BOTTOM",ye.BOTTOM],["OVER",ye.OVER],["UNDER",ye.UNDER],["HORIZONTAL",ye.HORIZONTAL],["VERTICAL",ye.VERTICAL],["BOTH",ye.BOTH],["RADIAL",ye.RADIAL],["UP",ye.UP],["DOWN",ye.DOWN],["NEXT",ye.NEXT],["PREV",ye.PREV],["AUTO",ye.AUTO],["AVE",ye.AVE],["DEFAULT",ye.DEFAULT],["ALL",ye.ALL],["NONE",ye.NONE],["GET",ye.GET],["POST",ye.POST],["LOCALSTORAGE",ye.LOCALSTORAGE],["SOCKET",ye.SOCKET],["TO",ye.TO],["FROM",ye.FROM],["SINE",ye.SINE],["SQUARE",ye.SQUARE],["TRIANGLE",ye.TRIANGLE],["SAW",ye.SAW],["SAWTOOTH",ye.SAWTOOTH],["ZAP",ye.ZAP],["TAU",ye.TAU],["DEG",ye.DEG],["RAD",ye.RAD],["PHI",ye.PHI]];for(dn=0;dn<jr.length;dn++)Jn=jr[dn],j[Jn[0]]=Jn[1];var Jn;for(dn=0;dn<ye.colors.length;dn++)j[ye.colors[dn]]=ye.colorsHex[dn];j.zim=ye;var Mi=ye;var Ii=ye.chop,Oi= exports.shuffle =ye.shuffle,Si= exports.pluck =ye.pluck,bi= exports.rand =ye.rand,Li= exports.seedRandom =ye.seedRandom,Bi= exports.odds =ye.odds,Di= exports.rarity =ye.rarity,Ri= exports.repeats =ye.repeats,_i= exports.series =ye.series,Yi= exports.loop =ye.loop,Xi= exports.getTIME =ye.getTIME,zr= exports.timeout =ye.timeout,ki= exports.interval =ye.interval,Ni= exports.async =ye.async,Fi= exports.couple =ye.couple,Gi= exports.decouple =ye.decouple,Vi= exports.convertColor =ye.convertColor,Wi= exports.colorRange =ye.colorRange,Ui= exports.lighten =ye.lighten,Qi= exports.darken =ye.darken,qi= exports.toColor =ye.toColor,Zi= exports.toAlpha =ye.toAlpha,Ki= exports.toBW =ye.toBW,Hi= exports.invertColor =ye.invertColor,Ji= exports.zimEase =ye.zimEase,$i= exports.spline =ye.spline,ji= exports.pointAlongCurve =ye.pointAlongCurve,zi= exports.distanceAlongCurve =ye.distanceAlongCurve,el= exports.closestPointAlongCurve =ye.closestPointAlongCurve,tl= exports.transformPoints =ye.transformPoints,nl= exports.trimEndPoints =ye.trimEndPoints,rl= exports.reversePoints =ye.reversePoints,il= exports.appendPoints =ye.appendPoints,ll= exports.prependPoints =ye.prependPoints,al= exports.splitPoints =ye.splitPoints,sl= exports.makeID =ye.makeID,ol= exports.makeSyllable =ye.makeSyllable,fl= exports.makePrimitive =ye.makePrimitive,ul= exports.makeMath =ye.makeMath,cl= exports.swapProperties =ye.swapProperties,dl= exports.mobile =ye.mobile,hl= exports.vee =ye.vee,pl= exports.extend =ye.extend,gl= exports.copy =ye.copy,vl= exports.merge =ye.merge,yl= exports.sortObject =ye.sortObject,xl= exports.arraysEqual =ye.arraysEqual,wl= exports.arrayMinMax =ye.arrayMinMax,Cl= exports.isEmpty =ye.isEmpty,Tl= exports.isJSON =ye.isJSON,ml= exports.isPick =ye.isPick,Al= exports.decimals =ye.decimals,kl= exports.countDecimals =ye.countDecimals,El= exports.sign =ye.sign,Pl= exports.constrain =ye.constrain,Ml= exports.dist =ye.dist,Il= exports.rectIntersect =ye.rectIntersect,Ol= exports.boundsAroundPoints =ye.boundsAroundPoints,Sl= exports.angle =ye.angle,bl= exports.smoothStep =ye.smoothStep,Ll= exports.unicodeToUTF =ye.unicodeToUTF,Bl= exports.capitalizeFirst =ye.capitalizeFirst,Dl= exports.Ajax =ye.Ajax,Rl= exports.Noise =ye.Noise,_l= exports.Point =ye.Point,Yl= exports.Bezier =ye.Bezier,Xl= exports.Boundary =ye.Boundary,Nl= exports.GradientColor =ye.GradientColor,Fl= exports.RadialColor =ye.RadialColor,Gl= exports.BitmapColor =ye.BitmapColor,Vl= exports.Damp =ye.Damp,Wl= exports.Proportion =ye.Proportion,Ul= exports.ProportionDamp =ye.ProportionDamp,Ql= exports.Dictionary =ye.Dictionary,ql= exports.Hierarchy =ye.Hierarchy,Zl= exports.Pick =ye.Pick,Kl= exports.scrollX =ye.scrollX,Hl= exports.scrollY =ye.scrollY,Jl= exports.windowWidth =ye.windowWidth,$l= exports.windowHeight =ye.windowHeight,jl= exports.browserZoom =ye.browserZoom,zl= exports.getQueryString =ye.getQueryString,ea= exports.swapHTML =ye.swapHTML,ta= exports.urlEncode =ye.urlEncode,na= exports.urlDecode =ye.urlDecode,ra= exports.setCookie =ye.setCookie,ia= exports.getCookie =ye.getCookie,la= exports.deleteCookie =ye.deleteCookie,aa= exports.Stage =ye.Stage,sa= exports.StageGL =ye.StageGL,ei= exports.Container =ye.Container,oa= exports.Shape =ye.Shape,fa= exports.Bitmap =ye.Bitmap,ua= exports.Sprite =ye.Sprite,ca= exports.MovieClip =ye.MovieClip,da= exports.SVGContainer =ye.SVGContainer,ha= exports.CustomShape =ye.CustomShape,pa= exports.Circle =ye.Circle,Mn= exports.Rectangle =ye.Rectangle,ga= exports.Triangle =ye.Triangle,va= exports.Poly =ye.Poly,ya= exports.Line =ye.Line,xa= exports.Squiggle =ye.Squiggle;var wa=ye.Flare,Ca= exports.MultiFlare =ye.MultiFlare,Ta= exports.FlareBox =ye.FlareBox,ti= exports.Label =ye.Label,ma= exports.LabelOnPath =ye.LabelOnPath,Aa= exports.LabelOnArc =ye.LabelOnArc,ka= exports.LabelLetters =ye.LabelLetters,Ea= exports.Emoji =ye.Emoji,Pa= exports.Button =ye.Button,Ma= exports.CheckBox =ye.CheckBox,Ia= exports.RadioButtons =ye.RadioButtons,Oa= exports.Toggle =ye.Toggle,Sa= exports.Tip =ye.Tip,ba= exports.Pane =ye.Pane,La= exports.Panel =ye.Panel;var Ba=ye.Page,Da= exports.Central =ye.Central,Ra= exports.Layer =ye.Layer,_a= exports.Waiter =ye.Waiter,Ya= exports.ProgressBar =ye.ProgressBar,Xa= exports.Indicator =ye.Indicator,Na= exports.TextInput =ye.TextInput,Fa= exports.List =ye.List,Ga= exports.Stepper =ye.Stepper,Va= exports.Slider =ye.Slider,Wa= exports.Selector =ye.Selector,Ua= exports.Dial =ye.Dial,Qa= exports.Tabs =ye.Tabs,qa= exports.Pad =ye.Pad,Za= exports.NumPad =ye.NumPad,Ka= exports.DPad =ye.DPad,Ha= exports.Radial =ye.Radial,Ja= exports.RadialMenu =ye.RadialMenu,$a= exports.ColorPicker =ye.ColorPicker,ja= exports.EmojiPicker =ye.EmojiPicker,za= exports.TextEditor =ye.TextEditor,es= exports.Keyboard =ye.Keyboard,ts= exports.Organizer =ye.Organizer,ns= exports.Connectors =ye.Connectors,rs= exports.Marquee =ye.Marquee,is= exports.Carousel =ye.Carousel,ls= exports.Loader =ye.Loader,as= exports.TextArea =ye.TextArea,ss= exports.Tag =ye.Tag,os= exports.localToGlobal =ye.localToGlobal,fs= exports.globalToLocal =ye.globalToLocal,us= exports.localToLocal =ye.localToLocal,cs= exports.addTo =ye.addTo,ds= exports.removeFrom =ye.removeFrom,hs= exports.added =ye.added,ps= exports.centerReg =ye.centerReg,gs= exports.center =ye.center,vs= exports.place =ye.place,ys= exports.placeReg =ye.placeReg,xs= exports.pos =ye.pos,ws= exports.loc =ye.loc,Cs= exports.mov =ye.mov,Ts= exports.sca =ye.sca,ms= exports.alp =ye.alp,As= exports.vis =ye.vis,ks= exports.ble =ye.ble,Es= exports.dye =ye.dye,Ps= exports.hov =ye.hov,Ms= exports.rot =ye.rot,Is= exports.siz =ye.siz,Os= exports.ske =ye.ske,Ss= exports.reg =ye.reg,bs= exports.top =ye.top,Ls= exports.bot =ye.bot,Bs= exports.ord =ye.ord,Ds= exports.cur =ye.cur,Rs= exports.sha =ye.sha,_s= exports.dep =ye.dep,Ys= exports.nam =ye.nam,Xs= exports.movement =ye.movement,Ns= exports.noMovement =ye.noMovement,Fs= exports.tap =ye.tap,Gs= exports.noTap =ye.noTap,Vs= exports.hold =ye.hold,Ws= exports.noHold =ye.noHold,Us= exports.change =ye.change,Qs= exports.noChange =ye.noChange,qs= exports.drag =ye.drag,Zs= exports.noDrag =ye.noDrag,Ks= exports.dragBoundary =ye.dragBoundary,Hs= exports.mouse =ye.mouse,Js= exports.noMouse =ye.noMouse,$s= exports.wire =ye.wire,js= exports.noWire =ye.noWire,zs= exports.wired =ye.wired,eo= exports.noWired =ye.noWired,to= exports.bind =ye.bind,no= exports.noBind =ye.noBind,ro= exports.transform =ye.transform,io= exports.gesture =ye.gesture,lo= exports.noGesture =ye.noGesture,ao= exports.gestureBoundary =ye.gestureBoundary,so= exports.effect =ye.effect,oo= exports.updateEffects =ye.updateEffects,fo= exports.noEffect =ye.noEffect,uo= exports.addPhysics =ye.addPhysics,co= exports.removePhysics =ye.removePhysics,ho= exports.hitTestPoint =ye.hitTestPoint,po= exports.hitTestReg =ye.hitTestReg,go= exports.hitTestRect =ye.hitTestRect,vo= exports.hitTestCircle =ye.hitTestCircle,yo= exports.hitTestCircleRect =ye.hitTestCircleRect,xo= exports.hitTestCircles =ye.hitTestCircles,wo= exports.hitTestBounds =ye.hitTestBounds,Co= exports.hitTestPath =ye.hitTestPath,To= exports.hitTestGrid =ye.hitTestGrid,mo= exports.animate =ye.animate,Ao= exports.stopAnimate =ye.stopAnimate,ko= exports.pauseAnimate =ye.pauseAnimate,Eo= exports.wiggle =ye.wiggle,Po= exports.scaleTo =ye.scaleTo,Mo= exports.fit =ye.fit,Io= exports.boundsToGlobal =ye.boundsToGlobal,Oo= exports.resetBounds =ye.resetBounds,So= exports.copyMatrix =ye.copyMatrix,bo= exports.duplicate =ye.duplicate,Lo= exports.expand =ye.expand,Bo= exports.setSwipe =ye.setSwipe,Do= exports.setMask =ye.setMask,Ro= exports.outline =ye.outline,_o= exports.blendmodes =ye.blendmodes,Yo= exports.Pages =ye.Pages,Xo= exports.Arrow =ye.Arrow,No= exports.HotSpots =ye.HotSpots,Fo= exports.HotSpot =ye.HotSpot,Go= exports.Guide =ye.Guide,Vo= exports.Grid =ye.Grid,Wo= exports.Wrapper =ye.Wrapper,ni= exports.Tile =ye.Tile,Uo= exports.Pack =ye.Pack,Qo= exports.Beads =ye.Beads,qo= exports.Layout =ye.Layout,Zo= exports.Accessibility =ye.Accessibility,Ko= exports.TextureActive =ye.TextureActive,Ho= exports.TextureActives =ye.TextureActives,Jo= exports.TextureActivesManager =ye.TextureActivesManager,$o= exports.Manager =ye.Manager,jo= exports.ResizeManager =ye.ResizeManager,zo= exports.TransformManager =ye.TransformManager,ef= exports.GuideManager =ye.GuideManager,tf= exports.GridManager =ye.GridManager,nf= exports.LayoutManager =ye.LayoutManager,rf= exports.SelectionSet =ye.SelectionSet,lf= exports.SelectionManager =ye.SelectionManager,af= exports.Bind =ye.Bind,sf= exports.Swipe =ye.Swipe,of= exports.Swiper =ye.Swiper,ff= exports.MotionController =ye.MotionController,uf= exports.GamePad =ye.GamePad,cf= exports.Portal =ye.Portal,df= exports.Physics =ye.Physics,hf= exports.TimeLine =ye.TimeLine,pf= exports.BlurEffect =ye.BlurEffect,gf= exports.GlowEffect =ye.GlowEffect,vf= exports.ShadowEffect =ye.ShadowEffect,yf= exports.ColorEffect =ye.ColorEffect,xf= exports.MultiEffect =ye.MultiEffect,wf= exports.AlphaEffect =ye.AlphaEffect,Cf= exports.Pixel =ye.Pixel,Tf= exports.Parallax =ye.Parallax,mf= exports.Flipper =ye.Flipper,Af= exports.Book =ye.Book,kf= exports.Scrambler =ye.Scrambler,Ef= exports.Scroller =ye.Scroller,Pf= exports.Dynamo =ye.Dynamo,Mf= exports.Accelerator =ye.Accelerator,If= exports.Emitter =ye.Emitter,Of= exports.Generator =ye.Generator,Sf= exports.Pen =ye.Pen,bf= exports.SoundWave =ye.SoundWave,Lf= exports.Synth =ye.Synth,Bf= exports.VR =ye.VR,Df= exports.Frame =ye.Frame,Rf= exports.Pic =ye.Pic,_f= exports.Aud =ye.Aud,Yf= exports.Vid =ye.Vid,Xf= exports.SVG =ye.SVG,Nf= exports.SensorAsk =ye.SensorAsk,Ff= exports.distill =ye.distill,Gf= exports.parseAudioSprite =ye.parseAudioSprite,Vf= exports.previewAudioSprite =ye.previewAudioSprite,Wf= exports.svgToBitmap =ye.svgToBitmap,Uf= exports.makeContent =ye.makeContent,Qf= exports.fastFrame =ye.fastFrame,qf= exports.addWires =ye.addWires,Zf= exports.setBlurDetect =ye.setBlurDetect,Kf= exports.Wonder =ye.Wonder,Hf= exports.getLatestVersions =ye.getLatestVersions,Jf= exports.PWA =ye.PWA,$f= exports.QR =ye.QR,jf= exports.GIF =ye.GIF,ur= exports.THEME =ye.THEME;exports.Accelerator = Mf; exports.Accessibility = Zo; exports.Ajax = Dl; exports.AlphaEffect = wf; exports.Arrow = Xo; exports.Aud = _f; exports.Beads = Qo; exports.Bezier = Yl; exports.Bind = af; exports.Bitmap = fa; exports.BitmapColor = Gl; exports.Blob = gi; exports.BlurEffect = pf; exports.Book = Af; exports.Boundary = Xl; exports.Button = Pa; exports.Carousel = is; exports.Central = Da; exports.CheckBox = Ma; exports.Circle = pa; exports.ColorEffect = yf; exports.ColorPicker = $a; exports.Connectors = ns; exports.Container = ei; exports.CustomShape = ha; exports.DPad = Ka; exports.Damp = Vl; exports.Dial = Ua; exports.Dictionary = Ql; exports.Dynamo = Pf; exports.Emitter = If; exports.Emoji = Ea; exports.EmojiPicker = ja; exports.Flare = wa; exports.FlareBox = Ta; exports.Flipper = mf; exports.Frame = Df; exports.GIF = jf; exports.GamePad = uf; exports.Generator = Of; exports.GlowEffect = gf; exports.GradientColor = Nl; exports.Grid = Vo; exports.GridManager = tf; exports.Guide = Go; exports.GuideManager = ef; exports.Hierarchy = ql; exports.HotSpot = Fo; exports.HotSpots = No; exports.Indicator = Xa; exports.Keyboard = es; exports.Label = ti; exports.LabelLetters = ka; exports.LabelOnArc = Aa; exports.LabelOnPath = ma; exports.Layer = Ra; exports.Layout = qo; exports.LayoutManager = nf; exports.Line = ya; exports.List = Fa; exports.Loader = ls; exports.Manager = $o; exports.Marquee = rs; exports.MotionController = ff; exports.MovieClip = ca; exports.MultiEffect = xf; exports.MultiFlare = Ca; exports.Noise = Rl; exports.NumPad = Za; exports.Organizer = ts; exports.PWA = Jf; exports.Pack = Uo; exports.Pad = qa; exports.Page = Ba; exports.Pages = Yo; exports.Pane = ba; exports.Panel = La; exports.Parallax = Tf; exports.Pen = Sf; exports.Physics = df; exports.Pic = Rf; exports.Pick = Zl; exports.Pixel = Cf; exports.Point = _l; exports.Poly = va; exports.Portal = cf; exports.ProgressBar = Ya; exports.Proportion = Wl; exports.ProportionDamp = Ul; exports.QR = $f; exports.Radial = Ha; exports.RadialColor = Fl; exports.RadialMenu = Ja; exports.RadioButtons = Ia; exports.Rectangle = Mn; exports.ResizeManager = jo; exports.SVG = Xf; exports.SVGContainer = da; exports.Scrambler = kf; exports.Scroller = Ef; exports.SelectionManager = lf; exports.SelectionSet = rf; exports.Selector = Wa; exports.SensorAsk = Nf; exports.ShadowEffect = vf; exports.Shape = oa; exports.Slider = Va; exports.SoundWave = bf; exports.Sprite = ua; exports.Squiggle = xa; exports.Stage = aa; exports.StageGL = sa; exports.Stepper = Ga; exports.Swipe = sf; exports.Swiper = of; exports.Synth = Lf; exports.THEME = ur; exports.Tabs = Qa; exports.Tag = ss; exports.TextArea = as; exports.TextEditor = za; exports.TextInput = Na; exports.TextureActive = Ko; exports.TextureActives = Ho; exports.TextureActivesManager = Jo; exports.Tile = ni; exports.TimeLine = hf; exports.Tip = Sa; exports.Toggle = Oa; exports.TransformManager = zo; exports.Triangle = ga; exports.VR = Bf; exports.Vid = Yf; exports.Waiter = _a; exports.Window = vi; exports.Wonder = Kf; exports.Wrapper = Wo; exports.addPhysics = uo; exports.addTo = cs; exports.addWires = qf; exports.added = hs; exports.alp = ms; exports.angle = Sl; exports.animate = mo; exports.appendPoints = il; exports.arrayMinMax = wl; exports.arraysEqual = xl; exports.async = Ni; exports.bind = to; exports.ble = ks; exports.blendmodes = _o; exports.bot = Ls; exports.boundsAroundPoints = Ol; exports.boundsToGlobal = Io; exports.browserZoom = jl; exports.capitalizeFirst = Bl; exports.center = gs; exports.centerReg = ps; exports.change = Us; exports.chop = Ii; exports.closestPointAlongCurve = el; exports.colorRange = Wi; exports.constrain = Pl; exports.convertColor = Vi; exports.copy = gl; exports.copyMatrix = So; exports.countDecimals = kl; exports.couple = Fi; exports.cur = Ds; exports.darken = Qi; exports.decimals = Al; exports.decouple = Gi; exports.default = Mi; exports.deleteCookie = la; exports.dep = _s; exports.dist = Ml; exports.distanceAlongCurve = zi; exports.distill = Ff; exports.drag = qs; exports.dragBoundary = Ks; exports.duplicate = bo; exports.dye = Es; exports.effect = so; exports.expand = Lo; exports.extend = pl; exports.fastFrame = Qf; exports.fit = Mo; exports.gesture = io; exports.gestureBoundary = ao; exports.getCookie = ia; exports.getLatestVersions = Hf; exports.getQueryString = zl; exports.getTIME = Xi; exports.globalToLocal = fs; exports.hitTestBounds = wo; exports.hitTestCircle = vo; exports.hitTestCircleRect = yo; exports.hitTestCircles = xo; exports.hitTestGrid = To; exports.hitTestPath = Co; exports.hitTestPoint = ho; exports.hitTestRect = go; exports.hitTestReg = po; exports.hold = Vs; exports.hov = Ps; exports.interval = ki; exports.invertColor = Hi; exports.isEmpty = Cl; exports.isJSON = Tl; exports.isPick = ml; exports.lighten = Ui; exports.loc = ws; exports.localToGlobal = os; exports.localToLocal = us; exports.loop = Yi; exports.makeContent = Uf; exports.makeID = sl; exports.makeMath = ul; exports.makePrimitive = fl; exports.makeSyllable = ol; exports.merge = vl; exports.mobile = dl; exports.mouse = Hs; exports.mov = Cs; exports.movement = Xs; exports.nam = Ys; exports.noBind = no; exports.noChange = Qs; exports.noDrag = Zs; exports.noEffect = fo; exports.noGesture = lo; exports.noHold = Ws; exports.noMouse = Js; exports.noMovement = Ns; exports.noTap = Gs; exports.noWire = js; exports.noWired = eo; exports.odds = Bi; exports.ord = Bs; exports.outline = Ro; exports.parseAudioSprite = Gf; exports.pauseAnimate = ko; exports.place = vs; exports.placeReg = ys; exports.pluck = Si; exports.pointAlongCurve = ji; exports.pos = xs; exports.prependPoints = ll; exports.previewAudioSprite = Vf; exports.rand = bi; exports.rarity = Di; exports.rectIntersect = Il; exports.reg = Ss; exports.removeFrom = ds; exports.removePhysics = co; exports.repeats = Ri; exports.resetBounds = Oo; exports.reversePoints = rl; exports.rot = Ms; exports.sca = Ts; exports.scaleTo = Po; exports.scrollX = Kl; exports.scrollY = Hl; exports.seedRandom = Li; exports.series = _i; exports.setBlurDetect = Zf; exports.setCookie = ra; exports.setMask = Do; exports.setSwipe = Bo; exports.sha = Rs; exports.shuffle = Oi; exports.sign = El; exports.siz = Is; exports.ske = Os; exports.smoothStep = bl; exports.sortObject = yl; exports.spline = $i; exports.splitPoints = al; exports.stopAnimate = Ao; exports.svgToBitmap = Wf; exports.swapHTML = ea; exports.swapProperties = cl; exports.tap = Fs; exports.timeout = zr; exports.toAlpha = Zi; exports.toBW = Ki; exports.toColor = qi; exports.top = bs; exports.transform = ro; exports.transformPoints = tl; exports.trimEndPoints = nl; exports.unicodeToUTF = Ll; exports.updateEffects = oo; exports.urlDecode = na; exports.urlEncode = ta; exports.vee = hl; exports.vis = As; exports.wiggle = Eo; exports.windowHeight = $l; exports.windowWidth = Jl; exports.wire = $s; exports.wired = zs; exports.zimEase = Ji; exports.zimify = Un; exports.zimplify = Ai;
/*! ZIM - JavaScript Canvas Framework - Code Creativity
https://zimjs.com (c) 2023 modified MIT License
Donations welcome https://zimjs.com/donate
Node module - also see ES6 modules at https://zimjs.com/cdn
*/
