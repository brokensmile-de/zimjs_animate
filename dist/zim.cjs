"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } }var pi=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(Tt,Pt)=>(typeof require<"u"?require:Tt)[Pt]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});require('@danzen/createjs');var ee=window||{},Fe=ee.createjs,Et=ee.zns,vt=ee.zon==null?!0:ee.zon,gi,vi,dn,Wn=vt?console.log.bind(console):function(){},jn=" border:thin solid black; color: black",ri=vt?console.log.bind(console,"%c Z ","background: #acd241;"+jn):function(){},yi=vt?console.log.bind(console,"%c Z ","background: #e472c4;"+jn):function(){},Yr=vt?console.log.bind(console,"%c Z ","background: #50c4b7;"+jn):function(){},ii=vt?console.log.bind(console,"%c Z ","background: #fb4758;"+jn):function(){},tt=vt?console.log.bind(console,"%c Z ","background: #ebcb35;"+jn):function(){},li=vt?console.log.bind(console,"%c Z ","background: #f58e25;"+jn):function(){},Er=vt?console.log.bind(console,"%c Z ","background: #eeeeee;"+jn):function(){},Pr=vt?console.log.bind(console,"%c Z ","background: #444444; border:thin solid black; color: white"):function(){};function Cn(t){return De("1"),document.getElementById(t)}function xi(t){if(De("2"),document.getElementById(t))return document.getElementById(t).style;vt&&tt("zss(): id not found")}function ir(t,Tt,Pt,It,Ot,mt){if(De("3"),n(Tt)&&Tt!=""||Tt=="_self")ee.location.href=t;else{var Rt="";return Pt&&(Rt+="width="+Pt+","),It&&(Rt+="height="+It+","),Ot&&(Rt+="fullscreen=yes,"),mt&&(Rt+="modal=yes,alwaysRaised=yes"),ee.open(t,Tt,Rt)}}function Hn(t){if(De("4"),!n(t))return Number(String(t).replace(/[^\d.-]/g,""))}function n(t){return t==null}function wi(t){De("5"),!n(t)&&(t.stopImmediatePropagation&&t.stopImmediatePropagation(),ee.event&&(ee.event.cancelBubble=!0))}function Xr(){return De("6"),ee.zilK&&(ee.removeEventListener("keydown",ee.zilK),ee.removeEventListener("wheel",ee.zilW),ee.removeEventListener("DOMMouseScroll",ee.zilS)),ee.zilK=function(t){t||(t=event),t.keyCode&&t.keyCode>=32&&t.keyCode<=40&&t.preventDefault()},ee.zilW=function(t){t||(t=event),t.preventDefault()},ee.zilS=ee.zilW,ee.addEventListener("keydown",ee.zilK,{passive:!1}),ee.addEventListener("wheel",ee.zilW,{passive:!1}),ee.addEventListener("DOMMouseScroll",ee.zilS,{passive:!1}),[ee.zilK,ee.zilW,ee.zilS]}function cr(t,Tt){De("6.1");function Pt(){var It=this;this.on=function(Ot,mt){if(!(n(t)||n(Ot)||n(mt)))for(var Rt=It.tags,Zt=0;Zt<Rt.length;Zt++)Rt[Zt].addEventListener(Ot,mt)},this.off=function(Ot,mt){if(!(n(t)||n(Ot)||n(mt)))for(var Rt=It.tags,Zt=0;Zt<Rt.length;Zt++)Rt[Zt].removeEventListener(Ot,mt)},Object.defineProperty(It,"tags",{get:function(){return n(t)?[]:typeof t=="string"||t instanceof String?(Tt&&li(t,document.querySelector(t)),Tt?[document.querySelector(t)]:document.querySelectorAll(t)):typeof t.innerHTML=="string"?[t]:[]},set:function(){}}),this.css=function(Ot,mt){for(var Rt=It.tags,Zt=0;Zt<Rt.length;Zt++)if(arguments.length==1&&arguments[0].constructor==={}.constructor)for(var At in Ot)Rt[Zt].style[At]=Ot[At];else{if(arguments.length==1)return It.tags[0].style[Ot];Rt[Zt].style[Ot]=mt}},this.prop=function(Ot,mt){if(!n(Ot)){for(var Rt=It.tags,Zt=[],At=0;At<Rt.length;At++)if(n(mt))if(Ot.constructor==={}.constructor)for(var Nt in Ot)Rt[At][Nt]=Ot[Nt];else Zt.push(Rt[At][Ot]);else Rt[At][Ot]=mt;if(n(mt))return Zt}}}return new Pt}function hn(t){return t.length==1&&t[0]!=null&&t[0].constructor==={}.constructor}function st(t,Tt,Pt,It){var Ot=ye&&(ye.ZIMONON||ai);if(hn(Tt)){De("7");var mt=Tt[0],Rt;for(var Zt in mt)(Rt=Zt.match(/^(.+)gColor$/))&&(mt[Rt[1]+"ackgroundColor"]=mt[Zt],delete mt[Zt]);var At=n(Pt)?t.toString().split(/\n/,1)[0].match(/\((.*)\)/)[1].replace(/\s+/g,"").split(","):Pt.replace(/\s+/g,"").split(","),Nt=[],qe,e;for(qe=0;qe<At.length;qe++)e=At[qe].split("=")[0],At[qe]=e,Nt.push(mt[e]);for(qe in mt)At.indexOf(qe)<0&&vt&&tt(t,"bad argument "+qe);var r;return(r=Object.prototype.isPrototypeOf.call(t.prototype,It)?new(t.bind.apply(t,[null].concat(Nt))):t.apply(null,Nt))?(Ot&&!r.arguments&&(r.arguments=[mt]),r):!0}else Ot&&It&&Tt&&n(It.arguments)&&(It.arguments=Array.prototype.slice.call(Tt))}function nt(t){if(De("7.5"),De("17.6"),!n(t))return ye.Pick.choose(t)}var Ci=console.table&&vt?console.table.bind(console):function(){},Ti=function(){for(var t=0;t<arguments.length;t++)if(!n(arguments[t]))return arguments[t]},ye=function(t){t.chop=function(e,r,i,l,a,s){if(De("7.8"),!n(e)){n(r)&&(r=3),n(i)&&(i=3),n(l)&&(l=!0),n(a)&&(a=0),n(s)&&(s=1),e.getBounds||(e=new t.Bitmap(e));var f=e.getBounds();n(f)&&tt("ZIM chop() - obj must have bounds");var u=f.width/r,y=f.height/i,k=a,g=[];return t.loop(i,function(O){t.loop(r,function(T){var E=new t.Bitmap(e,u+k*2,y+k*2,T*u-k,O*y-k,s);a!=0?(E.setBounds(k,k,u,y),E.regX=k,E.regY=k):E.setBounds(k,k,u,y),g.push(E)})}),l?new t.Tile(g,r,i,0,0,!0).sca(e.scaleX,e.scaleY):g}},t.shuffle=function(e,r){if(De("8"),!n(e)){Array.isArray(e)||(e=Object.values(arguments));var i=e.length,l,a;if(i==0)return e;if(r){for(var s=t.copy(e);t.arraysEqual(s,e);)t.shuffle(e);return e}else{for(;--i;)l=Math.floor(Math.random()*(i+1)),a=e[i],e[i]=e[l],e[l]=a;return e}}},t.pluck=function(e,r){if(De("9.26"),n(e)||e.length==0)return null;Array.isArray(e)||(e=Object.values(arguments));var i=Math.floor(Math.random()*e.length),l=e[i];return r&&e.splice(i,1),l},t.rand=function(e,r,i,l){if(De("9"),n(e)&&n(r))return Math.random();(n(e)||isNaN(e))&&(e=0),(n(r)||isNaN(r))&&(r=0),(e%1!=0||r%1!=0)&&(i=!1),n(i)&&(i=!0),l&&Math.random()>.5&&(e*=-1,r*=-1),i&&(e>r?e++:r>e&&r++);var a;return e==0&&r==0?0:(r==0?a=Math.random()*e:a=Math.min(e,r)+Math.random()*(Math.max(e,r)-Math.min(e,r)),i?Math.floor(a):a)},t.seedRandom=function(e){return De("9.01"),function(r,i,l,a,s,f,u,y,k){function g(b){var X,Y=b.length,m=this,j=0,S=m.i=m.j=0,_=m.S=[];for(Y||(b=[Y++]);a>j;)_[j]=j++;for(j=0;a>j;j++)_[j]=_[S=v&S+b[j%Y]+(X=_[j])],_[S]=X;(m.g=function(R){for(var U,Z=0,K=m.i,ne=m.j,V=m.S;R--;)U=V[K=v&K+1],Z=Z*a+V[v&(V[K]=V[ne=v&ne+U])+(V[ne]=U)];return m.i=K,m.j=ne,Z})(a)}function O(b,X){var Y,m=[],j=typeof b;if(X&&j=="object")for(Y in b)try{m.push(O(b[Y],X-1))}catch (e2){+function(){}()}return m.length?m:j=="string"?b:b+"\0"}function T(b,X){for(var Y,m=b+"",j=0;j<m.length;)X[v&j]=v&(Y^=19*X[v&j])+m.charCodeAt(j++);return A(X)}function E(b){try{return C?A(C.randomBytes(a)):(r.crypto.getRandomValues(b=new Uint8Array(a)),A(b))}catch (e3){return[+new Date,r,(b=r.navigator)&&b.plugins,r.screen,A(i)]}}function A(b){return String.fromCharCode.apply(0,b)}var C,d=l.pow(a,s),x=l.pow(2,f),P=2*x,v=a-1,w=l["seed"+k]=function(b,X,Y){var m=[];X=X==1?{entropy:!0}:X||{};var j=T(O(X.entropy?[b,A(i)]:_nullishCoalesce(b, () => (E())),3),m),S=new g(m);return T(A(S.S),i),(X.pass||Y||function(_,R,U){return U?(l[k]=_,R):_})(function(){for(var _=S.g(s),R=d,U=0;x>_;)_=(_+U)*a,R*=a,U=S.g(1);for(;_>=P;)_/=2,R/=2,U>>>=1;return(_+U)/R},j,"global"in X?X.global:this==l)};if(T(l[k](),i),u&&u.exports){u.exports=w;try{C=pi("crypto")}catch (e4){}}else y&&y.amd&&y(function(){return w})}(this,[],Math,256,6,52,typeof module=="object"&&module,typeof define=="function"&&define,"random"),t.randomO||(t.randomO=Math.random),n(e)?Math.random=t.randomO:Math.seedrandom(e),e},t.odds=function(e){return De("9.1"),(n(e)||isNaN(e))&&(e=50),Math.random()<=e/100},t.rarity=function(e,r,i,l){if(De("9.2"),n(e)||e.constructor!={}.constructor)return[];n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!1);var a=[];return t.loop(e,function(s,f){var u=t.colors.indexOf(s);u!=-1&&(s=t.colorsHex[u]);var y;Array.isArray(f)?(+s==+s?s=new Number(s):s=new String(s),s._payload=f[1],s.dynamicPayload=l,Object.defineProperty(s,"payload",{get:function(){return!this.dynamicPayload&&this._lastPayload!=null?this._lastPayload:(this._lastPayload=t.Pick.choose(this._payload),this._lastPayload)},set:function(k){this._lastPayload=null,this._payload=k}}),y=f[0],t.loop(y,function(){a.push(s)})):(y=f,t.loop(y,function(){+s==+s&&(s=+s),a.push(s)}))}),r&&t.shuffle(a),a},t.repeats=function(e,r){if(De("9.25"),n(e)||!Array.isArray(e))return 0;var i={},l=0,a=0;return t.loop(e,function(s){i[s]!=null?(i[s]++,a++):i[s]=0,i[s]>l&&(l=i[s])}),r?a:l},t.series=function(){De("13.61");var e,r;if(arguments[0]==null)return null;if(arguments.length==0)return function(){};arguments.length==1&&Array.isArray(arguments[0])?e=arguments[0]:arguments.length==1&&arguments[0].constructor=={}.constructor?(r=arguments[0],n(r.min)&&(r.min=0),n(r.max)&&(r.max=1),n(r.step)&&(r.step=1),e=[],t.loop(Math.floor(Math.abs(r.max-r.min)+r.step),function(d){e.push(d+r.min)},null,null,r.step),r=null):e=Array.prototype.slice.call(arguments);var i=0,l=1,a=1,s=0,f=0,u=!1,y=!1,k=!1,g=!1,O=!1,T,E,A=function(d,x){if(s&&f%s!=0)return f++,E;f++;var P=e.length,v;if((g||O)&&i%P==0&&t.shuffle(e),v=e[(P*10+i)%P],i==0&&(T=v),O&&i%P==0&&P>1)for(;v==E;)t.shuffle(e),v=e[(P*10+i)%P];return u?l>0&&i+l*a>=P?(l=-1,i=P-1-(i+a-(P-1))):l<0&&i+l*a<0?(l=1,i=a-i):i+=l*a:y?l>0&&i+l*a>=P?(l=-1,i=P-1-(i+a-(P-1))+a):l<0&&i+l*a<0?(l=1,i=a-i-a):i+=l*a:k?l>0&&i+l*a>=P?i=P-1:l<0&&i+l*a<0?i=0:i+=l*a:i+=l*a,E=v,t.isPick(v)?v.noPick&&x?v:t.Pick.choose(v):v},C=A.original=t.copy(e);return A.array=e,A.type="series",Object.defineProperty(A,"index",{get:function(){var d=e.length;return(d*10+i)%d},set:function(d){i=d,f=0}}),Object.defineProperty(A,"length",{get:function(){return e.length},set:function(){}}),A.jump=function(d){return i=d,A},A.reverse=function(d){return n(d)&&(d=!0),d?l=-1:l=1,i=e.length-1,A},A.bounce=function(d){n(d)&&(d=!0);var x=e.length;return i=(x*10+i)%x,u=d,A},A.flip=function(d){n(d)&&(d=!0);var x=e.length;return i=(x*10+i)%x,y=d,A},A.step=function(d){return n(d)&&(d=1),a=Math.floor(d),A},A.every=function(d){return n(d)&&(d=1),s=Math.abs(d),f=0,A},A.constrain=function(d){return n(d)&&(d=!0),k=d,A},A.random=function(d){return n(d)&&(d=!0),d||(e=C),g=d==!0,A},A.mix=function(d){return n(d)&&(d=!0),d||(e=C),O=d==!0,A},A.shuffle=function(d){return n(d)&&(d=!0),d?t.shuffle(e):e=C,A},A},t.makeSeries=function(e){if(De("13.6"),n(e))return function(){};var r=0,i=function(){return e[r++%e.length]};return i.array=e,i},t.loop=function(e,r,i,l,a,s,f,u,y,k){var g="obj, call, reverse, interval, step, start, end, immediate, complete, completeParams",O;if(O=st(t.loop,arguments,g))return O;if(De("9.5"),n(e)||n(r))return;n(i)&&(i=!1),n(l)&&(l=0),(n(a)||a<=0)&&(a=1),n(u)&&(u=!0),e.constructor===Number&&(e=Number(e)),e.constructor===String&&(e=String(e));var T=l==0&&y&&typeof y=="function",E=typeof e=="number"?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":typeof e=="string"?"string":e instanceof NodeList?"nodelist":e instanceof HTMLCollection?"htmlcollection":e.type&&e.type=="Dictionary"?"Dictionary":"invalid";if(E=="invalid")return;var A,C,d,x;if(E=="number"||E=="string"||E=="array"||E=="nodelist"||E=="htmlcollection"||E=="Dictionary"){if(E=="Dictionary"){var P=t.copy(e.values);e=t.copy(e.objects)}if(A=E=="number"?e:e.length,C=w(A-1),C==0)return;if(i)if(l===0){for(d=s;d>=f;d-=a)if(E=="number"?x=r(d,C,s,f,e):E=="array"||E=="string"?x=r(e[d],d,C,s,f,e):E=="Dictionary"?x=r(e[d],P[d],d,C,s,f,e):x=r(e.item(d),d,C,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(d=b.count,u||d--,a&&(d*=a),d=s-d,E=="number"?x=r(d,C,s,f,e):E=="array"||E=="string"?x=r(e[d],d,C,s,f,e):E=="Dictionary"?x=r(e[d],P[d],d,C,s,f,e):x=r(e.item(d),d,C,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},C,u,null,null,y,k);else if(l===0){for(d=s;d<=f;d+=a)if(E=="number"?x=r(d,C,s,f,e):E=="array"||E=="string"?x=r(e[d],d,C,s,f,e):E=="Dictionary"?x=r(e[d],P[d],d,C,s,f,e):x=r(e.item(d),d,C,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(d=b.count,u||d--,a&&(d*=a),E=="number"?x=r(d,C,s,f,e,b):E=="array"||E=="string"?x=r(e[d],d,C,s,f,e,b):E=="Dictionary"?x=r(e[d],P[d],d,C,s,f,e):x=r(e.item(d),d,C,s,f,e,b),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},C,u,null,null,y,k);return T&&y(k),!0}else if(E=="object"){A=0;var v=[];for(d in e)A++,v.push(d);if(C=w(A-1),C==0)return;if(i)if(l===0){for(d=s;d>=f;d-=a)if(x=r(v[d],e[v[d]],d,C,s,f,e),typeof x<"u")return x}else t.interval(l,function(b){if(d=b.count,u||d--,a&&(d*=a),d=s-d,x=r(v[d],e[v[d]],d,C,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},C,u,null,null,y,k);else if(l===0){for(d=s;d<=f;d+=a)if(x=r(v[d],e[v[d]],d,C,s,f,e),typeof x<"u")return x}else t.interval(l,function(b){if(d=b.count,u||d--,a&&(d*=a),x=r(v[d],e[v[d]],d,C,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},C,u,null,null,y,k);return T&&y(k),!0}function w(b){return n(s)&&(s=i?b:0),n(f)&&(f=i?0:b),i&&f>s||!i&&s>f||(s<0&&f)<0||s>b&&f>b?0:(s=Math.max(0,Math.min(s,b)),f=Math.max(0,Math.min(f,b)),Math.floor((i?s-f:f-s)/a)+1)}};function Tt(e,r,i,l,a){t.timeCheck||(De("9.99"),t.timeCheck=!0);var s=n(ee.TIME)?n(t.TIME)?"seconds":t.TIME:ee.TIME;return s&&s.toLowerCase&&(s=s.toLowerCase()),s!="milliseconds"&&s!="ms"&&(s="seconds"),r&&r.toLowerCase&&(r=r.toLowerCase()),(r=="ms"||r=="milliseconds"||r=="seconds"||r=="s")&&(s=r),n(e)?s.charAt(0):(s=="ms"&&(s="milliseconds"),s=="s"&&(s="seconds"),s=s.charAt(0),a||Pt(e,s,i,l),s)}function Pt(e,r,i,l){n(i)&&(i=10),n(l)&&(l=9),!(!t.TIMECHECK&&!ee.TIMECHECK)&&(r!="m"&&e>i||r=="m"&&e<l)&&vt&&tt("TIME - warning: time is in "+(r=="m"?"milliseconds":"seconds")+" ("+e+")")}if(t.timeout=function(e,r,i,l){var a="time, call, pauseOnBlur, timeUnit",s;if(s=st(t.timeout,arguments,a,this))return s;if(De("9.7"),!n(r)&&typeof r=="function"){var f=t.interval(e,r,1,!1,i,l);return f.type="timeoutObj",f}},t.interval=function(e,r,i,l,a,s,f,u){var y="time, call, total, immediate, pauseOnBlur, timeUnit, complete, completeParams",k;if(k=st(t.interval,arguments,y,this))return k;if(De("9.8"),n(r)||typeof r!="function")return;var g=Tt(e,s);if(n(e)&&(e=g=="s"?1:1e3),n(l)&&(l=!1),!n(i)&&(isNaN(i)||i<=0))return;n(i)&&(i=-1);var O={count:0,total:i,paused:!1,time:e,active:!0,timeUnit:s};a&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseOnBlur.push(O));function T(){O.startTime=Date.now(),O.interval=t.Pick.choose(O.time),O.id=setTimeout(function(){O.paused||O.active&&(O.count++,r(O),T(),E())},O.interval*(g=="s"?1e3:1))}l&&setTimeout(function(){r(O),E()},10);function E(){i!=-1&&O.count>=(l?O.total-1:O.total)&&(f&&typeof f=="function"&&f(u),O.clear())}var A;return O.type="intervalOjbect",O.pause=function(C,d,x){n(C)&&(C=!0),C?(clearTimeout(A),clearTimeout(O.id),cancelAnimationFrame(O.rid),O.pauseTimeLeft=O.interval-(Date.now()-O.startTime)/(g=="s"?1e3:1)):(O.paused||O.pause(!0),A=setTimeout(function(){O.count++,r(O),T(),E()},d?0:(x?O.interval:O.pauseTimeLeft)*(g=="s"?1e3:1)),O.pauseTimeLeft=null),O.paused=C},O.next=function(){O.count++,r(O),E()},O.clear=function(){O.active=!1,clearTimeout(A),cancelAnimationFrame(O.rid),clearTimeout(O.id);var C=O.count;for(var d in O)delete O[d];O.active=!1,O.count=C,O.pause=function(){},O.clear=function(){}},T(),O},t.async=function(e,r,i,l,a){if(De("29"),!n(e)){var s=document.createElement("script"),f=Tt(l);n(l)&&(l=f=="s"?2:2e3);var u;r?(i?u=i:u=r.toString().split(/\n/,1)[0].match(/^function\s?([^\s(]*)/)[1],t.asyncList||(t.asyncList={}),t.asyncList[u]||(t.asyncList[u]=[]),t.asyncList[u].push(r),t.async[u]=function(){var y=s,k=!1,g=setTimeout(function(){k=a,typeof r=="function"&&r("asyncError",a?"cancelled":"timeout")},l*(f=="s"?1e3:1));return function(O){clearTimeout(g),t.asyncList[u]&&(r=t.asyncList[u].shift()),typeof r=="function"&&!k&&r(O),y&&y.parentNode.removeChild(y),y=null}}()):(t.async.z_s&&t.async.z_s.parentNode&&t.async.z_s.parentNode.removeChild(t.async.z_s),t.async.z_s=s),e.match(/\?/)||(e+="?"),s.setAttribute("src",e+"&r="+Math.random()),document.getElementsByTagName("head")[0].appendChild(s)}},t.couple=function(e){if(De("29.2"),!t.isJSON(e))return e;var r=JSON.parse(e),i={};for(var l in r){var a=r[l];for(var s in a)i[l+"_"+s]=a[s]}return JSON.stringify(i)},t.decouple=function(e){if(De("29.3"),!t.isJSON(e))return e;var r=JSON.parse(e),i={};for(var l in r){var a=l.split("_",2);if(a.length!=2)return e;i[a[0]]||(i[a[0]]={}),i[a[0]][a[1]]=r[l]}return JSON.stringify(i)},t.convertColor=function(e,r,i){if(t.convertColorCheck||(De("27.5"),t.convertColorCheck=!0),n(r)&&(r="hex"),n(e)||!e.toLowerCase)return;e=nt(e),e=e.toLowerCase(),r=r.toLowerCase();var l=["black","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],a=["000000","f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"];if(r=="zim"){var s=t.colorsHex.indexOf(e);return s<0?e:t.colors[t.colorsHex.indexOf(e)]}r=="hsv"&&r=="hsl";var f,u;if(f=e.match(/rgba\((.*)\)/)){u=f[1].split(",");var y=u.pop();if(n(i)&&(i=y),r=="array")return u.push(y),u;if(e="rgb("+u.join(",")+")",r=="rgb")return e;if(r=="hsl")return O(u[0],u[1],u[2])}function k(P){var v=Number(P).toString(16);return v.length<2&&(v="0"+v),v}function g(P,v,w,b,X){return(X-b)*(P-v)/(w-v)+b}function O(P,v,w){P/=255,v/=255,w/=255;let b=Math.max(P,v,w),X=b-Math.min(P,v,w),Y=X?b===P?(v-w)/X:b===v?2+(w-P)/X:4+(P-v)/X:0;return[60*Y<0?60*Y+360:60*Y,100*(X?b<=.5?X/(2*b-X):X/(2-(2*b-X)):0),100*(2*b-X)/2]}function T(P){var v=P.split(","),w=k(v[0]),b=k(v[1]),X=k(v[2]),Y=n(Y)?"":k(Math.round(Number(v[3])*255));return[w,b,X,Y]}n(i)&&(i=1);var E,A,C;if(f=e.match(/rgb\((.*)\)/))return r=="rgba"?"rgba("+f[1]+","+i+")":r=="hex"?(E=i!=1?","+i:"",A=T(f[1]+E),"#"+A[0]+A[1]+A[2]+A[3]):r=="hexnumber"?(E=i!=1?","+i:0,A=T(f[1]+E),parseInt(A[0]+""+A[1]+A[2],16)):r=="string"?(e=T(f[1]).join("").toLowerCase(),C=a.indexOf(e),C==-1?"#"+e:l[C]):r=="array"?(E=i!=1?","+i:0,T(f[1]+E)):r=="hsl"?(u=f[1].split(","),O(u[0],u[1],u[2])):e;function d(P){var v;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(P)?(v=P.substring(1).split(""),v.length==3&&(v=[v[0],v[0],v[1],v[1],v[2],v[2]]),v="0x"+v.join(""),r=="rgb"?"rgb("+[v>>16&255,v>>8&255,v&255]+")":r=="array"?[v>>16&255,v>>8&255,v&255,i]:"rgba("+[v>>16&255,v>>8&255,v&255].join(",")+","+i+")"):/^#([A-Fa-f0-9]{4}){1,2}$/.test(P)?(v=P.substring(1).split(""),v.length==8&&(i=v.slice(-2).join(""),v=v.slice(0,6)),v.length==4&&(i=v[3]+""+v[3],v=[v[0],v[0],v[1],v[1],v[2],v[2]]),i=parseInt(i,16)/255,v="0x"+v.join(""),r=="rgb"?"rgb("+[v>>16&255,v>>8&255,v&255]+")":"rgba("+[v>>16&255,v>>8&255,v&255].join(",")+","+i+")"):r=="rgb"?"rgb(0,0,0)":"rgba(0,0,0,1)"}if(r=="hsl")return t.convertColor(t.convertColor(e,"rgb"),"hsl");if(r=="array"||r=="rgb"||r=="rgba")return e.charAt(0)=="#"?d(e):d(t.convertColor(e));if(r=="hex"){if(e.charAt(0)=="#")if(i!=1)if(E=k(Math.round(i*255)),e.length==4||e.length==5){var x=e.split("");return x[1]=x[1]+""+x[1],x[2]=x[2]+""+x[2],x[3]=x[3]+""+x[3],x[4]=E,x.join("")}else return e.length==9?e.substring(0,l.length-2)+E:e+E;else return e}else if(r=="hexnumber"){if(e.charAt(0)=="#")return parseInt(e.replace(/^#/,""),16)}else e.charAt(0)=="#"&&(e=e.replace("#",""),e.length==3&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)));return r=="string"?(C=a.indexOf(e),C==-1?"#"+e:l[C]):r=="hexnumber"?parseInt(a[l.indexOf(e.toLowerCase())!=-1?l.indexOf(e):0],16):(E=i!=1?k(Math.round(i*255)):"","#"+a[l.indexOf(e.toLowerCase())!=-1?l.indexOf(e):0]+E)},t.colorRange=function(e,r,i){t.colorRangeCheck||(De("27.6"),t.colorRangeCheck=!0),n(i)&&(i=.5),i=Math.max(0,Math.min(1,i)),n(e)&&(e="white"),n(r)&&(r="black");var l=e,a=r,s=t.convertColor(e,"rgb"),f=t.convertColor(r,"rgb");e=s.substring(4,s.length-1).split(","),r=f.substring(4,f.length-1).split(",");var u,y="#",k;if(i==0)y=l;else if(i==1)y=a;else for(var g=0;g<e.length;g++)u=r[g]-e[g],k=Math.floor(parseInt(e[g],10)+u*i).toString(16),k.length<2&&(k="0"+k),y+=k;return y},t.lighten=function(e,r){return t.lightenCheck||(De("27.65"),t.lightenCheck=!0),n(r)&&(r=.5),r>=0?t.colorRange(String(e),"#FFFFFF",r):t.colorRange(String(e),"#000000",-r)},t.darken=function(e,r){return n(r)&&(r=.5),t.darkenCheck||(De("27.66"),t.darkenCheck=!0),r>=0?t.colorRange(String(e),"#000000",r):t.colorRange(String(e),"#ffffff",-r)},t.toColor=function(e,r,i){return t.toColorCheck||(De("27.67"),t.toColorCheck=!0),n(i)&&(i=.5),t.colorRange(String(e),r,i)},t.toAlpha=function(e,r){return t.toAlphaCheck||(De("27.68"),t.toAlphaCheck=!0),n(r)&&(r=.5),t.convertColor(String(e),"rgba",r)},t.toBW=function(e){if(e.indexOf("#")===0&&(e=e.slice(1)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length!==6)return tt("ZIM toBW() - needs hex input"),e;var r=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);return r*.299+i*.587+l*.114>186?"#000000":"#FFFFFF"},t.invertColor=function(e){if(t.invertColorCheck||(De("27.86"),t.invertColorCheck=!0),e.indexOf("#")===0&&(e=e.slice(1)),e.length===3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length!==6)return tt("ZIM invertColor() - needs hex input"),e;var r=parseInt(e.slice(0,2),16),i=parseInt(e.slice(2,4),16),l=parseInt(e.slice(4,6),16);r=(255-r).toString(16),i=(255-i).toString(16),l=(255-l).toString(16);function a(s,f){f=f||2;var u=new Array(f).join("0");return(u+s).slice(-f)}return"#"+a(r)+a(i)+a(l)},t.zimEase=function(e,r,i,l,a){De("27.69");var s=!1;n(a)&&(a=!0);var f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y;if(e){if(Array.isArray(e[1])){s=!0,Y=e[1],e=e[0];var m=0,j=Y[0],S=Y[1],_=Y[2],R=Y[3],U=1,Z=5*(j-m),K=10*(S-m)-4*Z,ne=10*(_-m)+30*(j-S),V=5*(R+m)-20*(_+j)+30*S,D=U-m-V-ne-K-Z}f=0,u=e[0],y=e[1],k=e[2],g=e[3],O=1,T=5*(u-f),E=10*(y-f)-4*T,A=10*(k-f)+30*(u-y),C=5*(g+f)-20*(k+u)+30*y,d=O-f-C-A-E-T}else r?(d=r[0],C=r[1],A=r[2],E=r[3],T=r[4],u=T/5,y=(E+4*T)/10,k=(A+6*T+3*E)/10,g=(C+4*T+3*E+2*A)/5):(d=0,C=0,A=0,E=0,T=1);return i?(b=function(){return t.zimEase(null,[d,C,A,E,T],!0)},X={reverse:b,points:[u,y,k,g],polynomials:[d,C,A,E,T]},X.noPick=function(c){if(a){if(c<.025)return 0;if(c>.975)return 1}return c<.5?(c*=2,x=c*100,P=100,v=(x/=P)*x,w=v*x,(d*w*v+C*v*v+A*w+E*v+T*x)/2):(c=1-(c-.5)*2,x=c*100,P=100,v=(x/=P)*x,w=v*x,1-(d*w*v+C*v*v+A*w+E*v+T*x)/2)}):s?(b=function(){return vt&&tt("zimEase - multi array points cannot be reversed"),t.zimEase(null,[d,C,A,E,T])},X={reverse:b,points:[[u,y,k,g],[j,S,_,R]],polynomials:[[d,C,A,E,T],[D,V,ne,K,Z]]},X.noPick=function(c){if(a){if(c<.025)return 0;if(c>.975)return 1}return c<.5?(c*=2,x=c*100,P=100,v=(x/=P)*x,w=v*x,(d*w*v+C*v*v+A*w+E*v+T*x)/2):(c=(c-.5)*2,x=c*100,P=100,v=(x/=P)*x,w=v*x,.5+(D*w*v+V*v*v+ne*w+K*v+Z*x)/2)}):(b=function(){return t.zimEase(null,[d,C,A,E,T],null,!0)},X={reverse:b,points:[u,y,k,g],polynomials:[d,C,A,E,T]},l?X.noPick=function(c){if(a){if(c<.025)return 0;if(c>.975)return 1}return x=100-c*100,P=100,v=(x/=P)*x,w=v*x,1-(d*w*v+C*v*v+A*w+E*v+T*x)}:X.noPick=function(c){if(a){if(c<.025)return 0;if(c>.975)return 1}return x=c*100,P=100,v=(x/=P)*x,w=v*x,d*w*v+C*v*v+A*w+E*v+T*x}),X.noPick.reverse=b,X},t.spline=function(e,r,i,l,a){De("27.695"),n(e)&&(e=[]),n(r)&&(r=1),n(i)&&(i=!1),n(a)&&(a=i);var s;function f(R,U){if(!Array.isArray(R[0]))for(s=0;s<R.length;s++)R[s]=[R[s].x,R[s].y];if(U){var Z=R[R.length-1],K=R[R.length-2],ne=R[0],V=R[1];R.unshift(Z),R.unshift(K),R.push(ne),R.push(V)}var D=[];for(s=0;s<R.length;s++)D.push(R[s][0],R[s][1]);return D}e=f(e,i);var u=e.length,y=u-4,k=i?e[2]:e[0],g=i?e[3]:e[1],O="M"+[k,g];l&&l.mt(k,g);var T=i?2:0,E=i?u-4:u-2,A=2;for(s=T;s<E;s+=A){var C=s?e[s-2]:e[0],d=s?e[s-1]:e[1],x=e[s+0],P=e[s+1],v=e[s+2],w=e[s+3],b=s!==y?e[s+4]:v,X=s!==y?e[s+5]:w,Y=x+(v-C)/6*r,m=P+(w-d)/6*r,j=v-(b-x)/6*r,S=w-(X-P)/6*r;O+="C"+[Y,m,j,S,v,w],l&&l.bt(Y,m,j,S,v,w)}if(a){var _=O.split("C");_.pop(),O=_.join("C")}return O},t.pointAlongCurve=function(e,r,i,l){if(De("27.7"),!(!e||!e[0]||!e[1]||!e[2]||!e[3])){n(l)&&(l=!1);var a=new t.Bezier(e[0],e[1],e[2],e[3]),s,f,u,y,k,g;if(l?(s=a.mx(r),f=a.my(r)):(s=a.x(r),f=a.y(r)),i){var O=r-.05,T=r+.05;O<0&&(O=0),T>1&&(T=1),l?(u=a.mx(O),y=a.my(O),k=a.mx(T),g=a.my(T)):(u=a.x(O),y=a.y(O),k=a.x(T),g=a.y(T));var E=t.angle(u,y,k,g);return{x:s,y:f,angle:E}}return{x:s,y:f}}},t.distanceAlongCurve=function(e){De("27.8");var r=t.dist(e[0],e[3]),i=t.dist(e[0],e[1])+t.dist(e[1],e[2])+t.dist(e[2],e[3]);return(r+i)/2},t.closestPointAlongCurve=function(e,r,i,l,a){De("27.9");var s=1e7,f,u=0,y=0;return n(i)&&(i=10),t.loop(r,function(k,g){var O=new t.Bezier(k[0],k[1],k[2],k[3]);t.loop(i,function(T,E){var A={x:O.x(T/E),y:O.y(T/E)},C=t.dist(e,A);C<s&&(s=C,f=A,u=g,y=T)})}),a?(u*i+y)/(r.length*i)*100:l?f:u},t.transformPoints=function(e,r,i,l,a){if(De("27.95"),!(n(e)||!Array.isArray(e))){n(l)&&(l=0),n(a)&&(a=0),e=t.copy(e);var s=l,f=a;r=="rotation"&&(l!=0&&(e=t.transformPoints(e,"x",-s)),a!=0&&(e=t.transformPoints(e,"y",-f)));for(var u,y=0;y<e.length;y++)if(u=e[y],!!Array.isArray(u)){if(r=="x")u[0]+=i;else if(r=="y")u[1]+=i;else if(r=="scaleX")u[0]=(u[0]-l)*i+l,u[4]=u[4]*i,u[6]=u[6]*i;else if(r=="scaleY")u[1]=(u[1]-a)*i+a,u[5]=u[5]*i,u[7]=u[7]*i;else if(r=="scale")u[0]=(u[0]-l)*i+l,u[4]=u[4]*i,u[6]=u[6]*i,u[1]=(u[1]-a)*i+a,u[5]=u[5]*i,u[7]=u[7]*i;else if(r=="rotation"){var k=i*Math.PI/180,g=u[0],O=u[1];u[0]=g*Math.cos(k)-O*Math.sin(k),u[1]=O*Math.cos(k)+g*Math.sin(k),g=u[4],O=u[5],u[4]=g*Math.cos(k)-O*Math.sin(k),u[5]=O*Math.cos(k)+g*Math.sin(k),g=u[6],O=u[7],u[6]=g*Math.cos(k)-O*Math.sin(k),u[7]=O*Math.cos(k)+g*Math.sin(k)}}return r=="rotation"&&(l!=0&&(e=t.transformPoints(e,"x",s)),a!=0&&(e=t.transformPoints(e,"y",f))),e}},t.trimPointEnds=function(e){De("27.97"),e[0][4]=0,e[0][5]=0,e[0][8]="free",e[e.length-1][6]=0,e[e.length-1][7]=0,e[e.length-1][8]="free"},t.reversePoints=function(e){return De("27.975"),e.reverse(),t.loop(e,function(r){var i=r[6];r[6]=r[4],r[4]=i;var l=r[7];r[7]=r[5],r[5]=l}),e},t.appendPoints=function(e,r,i){return De("27.98"),n(e)&&n(r)?[]:n(e)?r:(n(r)||(e[e.length-1][6]=r[0][6],e[e.length-1][7]=r[0][7],i&&(e[e.length-1][8]=i),r.shift(),e=e.concat(r)),e)},t.prependPoints=function(e,r,i){return De("27.985"),n(e)&&n(r)?[]:n(e)?r:(n(r)||(r[r.length-1][6]=e[0][6],r[r.length-1][7]=e[0][7],i&&(e[e.length-1][8]=i),e.shift(),e=r.concat(e)),e)},t.splitPoints=function(e,r,i){if(De("27.99"),!n(e)&&(n(r)&&(r=Math.floor(e.length/2)),!(r<0||r>e.length-1))){n(i)&&(i=!0);var l=t.copy(e.slice(0,r+1)),a=t.copy(e.slice(r));return i&&(t.trimPointEnds(l),t.trimPointEnds(a)),[l,a]}},t.makeID=function(e,r,i){De("13.5"),n(e)&&(e="mixed"),n(r)&&(r=5),n(i)&&(i="uppercase");var l,a=[2,3,4,5,6,7,8,9],s="abcdefghjkmnpqrstuvwxyz".split("");e.constructor===Array?l=e:e=="numbers"?l=a:e=="letters"?l=s:l=a.concat(s);for(var f="",u,y,k=0;k<r;k++)u=l[Math.floor(Math.random()*l.length)],y=Math.random(),i=="uppercase"||i=="mixed"&&y>.5?u.toUpperCase&&(u=u.toUpperCase()):u.toLowerCase&&(u=u.toLowerCase()),f+=String(u);return f},t.makeSyllable=function(e,r){De("13.55");var i="bcdfghjklmnprstvwxz",l="aeiouaeiouaeiouy";n(e)&&(e=3),n(r)&&(r=t.rand()<.3);function a(u){var y=t.rand(u.length-1),k=u.substring(y,y+1);return k}var s="",f=r?l:i;return t.loop(e,function(){s+=a(f),f=f==l?i:l}),s},t.makePrimitive=function(e){De("13.56");function r(i){return Array.isArray(i)?(t.loop(i,function(l){l=r(l)}),i):i.constructor==={}.constructor?(t.loop(i,function(l,a){i[l]=r(a)}),i):i instanceof String?String(i):i instanceof Number?Number(i):i instanceof Boolean?!!i:i}return r(e)},t.makeMath=function(){De("13.565");for(var e=Object.getOwnPropertyNames(Math),r=0;r<e.length;r++)ee[e[r]]=Math[e[r]]},t.swapProperties=function(e,r,i){if(De("17.1"),n(r)||n(i)||n(r[e])||n(i[e]))return!1;var l=i[e];return i[e]=r[e],r[e]=l,!0},t.mobile=function(e){return De("28"),!n(ee.MOBILE)&&ee.MOBILE!="default"?ee.MOBILE:!n(t.MOBILE)&&t.MOBILE!="default"?t.MOBILE:(n(e)&&(e=!0),/ip(hone|od|ad)/i.test(navigator.userAgent)?"ios":/android|nexus/i.test(navigator.userAgent)?"android":/blackberry/i.test(navigator.userAgent)?"blackberry":/nokia|phone|mobile/i.test(navigator.userAgent)?"windows":/opera mini|webos/i.test(navigator.userAgent)?"other":e&&ee.orientation!==void 0?/safari/i.test(navigator.userAgent)?"ios":!0:!1)},t.vee=function(e){return De("28.5"),!n(e)&&(e.type=="Pick"||Array.isArray(e)||e.constructor=={}.constructor&&(!n(e.max)||!n(e.noPick))||typeof e=="function")},t.extend=function(e,r,i,l,a){var s="subclass, superclass, override, prefix, prototype",f;if(f=st(t.extend,arguments,s))return f;if(n(e)||n(r)){vt&&e!=t.StageGL&&tt("zim.extend() - please supply a class and its superclass");return}n(l)&&(l="super"),n(i)&&(i=[]),Array.isArray(i)||(i=[i]),n(a)&&(a=!0);var u={};for(var y in e.prototype)Object.defineProperty(u,y,Object.getOwnPropertyDescriptor(e.prototype,y));function k(){this.constructor=e}k.prototype=r.prototype,e.prototype=new k;for(y in u)Object.defineProperty(e.prototype,y,Object.getOwnPropertyDescriptor(u,y));var g=e.prototype,O=Object.getPrototypeOf&&Object.getPrototypeOf(g)||g.__proto__;if(O){g[(l+="_")+"constructor"]=O.constructor;for(var T,E=0;E<i.length;E++)T=i[E],typeof O[T]=="function"&&(g[l+T]=O[T]);if(a)for(T in O)Object.prototype.hasOwnProperty.call(g,T)&&typeof O[T]=="function"&&(g[l+T]=O[T])}return e},t.copy=function(e,r,i){if(t.copyCheck||(De("10"),t.copyCheck=!0),n(r)&&(r=!1),n(i)&&(i=!0),e==null||!(e instanceof Array||e.constructor=={}.constructor))return r&&e!=null&&e.clone&&e.type&&(e.type!="Container"&&e.type!="Stage"&&e.type!="StageGL"||i)?e.clone():e;if(e instanceof Array){for(var l=[],a=0;a<e.length;a++)l[a]=t.copy(e[a],r,i);return l}if(e.constructor=={}.constructor){var s={};for(var f in e){var u=t.copy(e[f],r,i);Object.prototype.hasOwnProperty.call(e,f)&&(s[f]=u)}return s}},t.merge=function(){t.mergeCheck||(De("12"),t.mergeCheck=!0);var e={},r,i;for(r=0;r<arguments.length;r++)for(i in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],i)&&(e[i]=arguments[r][i]);return e},t.sortObject=function(e,r,i){De("12.1");var l=function(u){return u[r]},a=Object.entries(e).sort(function(u,y){return i?l(u[1])<l(y[1])?1:l(u[1])>l(y[1])?-1:0:l(u[1])>l(y[1])?1:l(u[1])<l(y[1])?-1:0}),s=new Map(a),f={};return s.forEach((u,y)=>{f[y]=u}),f},t.arraysEqual=function(e,r,i){if(De("11"),n(e)||n(r)||(n(i)&&(i=!0),e.length!=r.length))return!1;for(var l=0;l<e.length;l++)if(e[l]instanceof Array&&r[l]instanceof Array){if(!t.arraysEqual(e[l],r[l],i))return!1}else{if(i&&e[l]!=r[l])return!1;if(!i)return t.arraysEqual(e.sort(),r.sort(),!0)}return!0},t.arrayMinMax=function(e){if(De("11.2"),!Array.isArray(e))return{min:null,max:null};for(var r=e[0],i=e[0],l=e.length;l--;)r=e[l]<r?e[l]:r,i=e[l]>i?e[l]:i;return r=isNaN(r)?null:r,i=isNaN(i)?null:i,{min:r,max:i}},t.isEmpty=function(e){if(t.zimEmptyCheck||(De("11.5"),t.zimEmptyCheck=!0),!n(e)){var r=0;for(var i in e){r++;break}return r==0}},t.isPick=function(e){if(t.zimPickCheck||(De("11.7"),t.zimPickCheck=!0),!n(e))return Array.isArray(e)||e.constructor=={}.constructor&&(e.min!=null&&e.max!=null||e.noPick)||e.constructor===Function&&(e.array!=null||e()!=null)},t.isJSON=function(e){if(De("11.6"),typeof e!="string")return!1;try{return JSON.parse(e),!0}catch (e5){return!1}},t.parseJSON=function(e){De("11.65");function r(l){l=l.trim();try{return new Function("return "+l)()}catch (e6){return tt("JSON did not parse"),null}}var i;try{i=JSON.parse(e)}catch (e7){i=r(e)}return i},t.zut=function(e){if(n(e)||typeof e=="object")return!0},t.decimals=function(e,r,i,l,a,s,f){if(t.zimDecimalCheck||(De("13"),t.zimDecimalCheck=!0),n(e))return 0;n(r)&&(r=1),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=!0),n(s)&&(s=!1);var u=Math.round(e*Math.pow(10,r))/Math.pow(10,r);if(s){var y=u-Math.floor(u);u=t.decimals(Math.floor(u)+y*60/100,2)}var k=t.sign(u),g,O,T;if(i>0)for(g=String(u).indexOf("."),O=String(u).length,g<0&&(g=O++,u+="."),T=0;T<i-(O-g-1);T++)u+="0";if(l>1){k==-1&&(u=u.substr(1,u.length-1)),g=String(u).indexOf("."),O=String(u).length;var E=g<0?O:g;for(T=0;T<l-E;T++)u="0"+u;k==-1&&(u="-"+u)}return l==0&&(u=u.toString().replace(/^0\./,".")),i+l>0&&!a&&Number(u)==0&&(u=0),s&&(u=String(u).replace(".",":")),t.zut(f)?u:null},t.countDecimals=function(e){return t.zimCountDecimalsCheck||(De("13.05"),t.zimCountDecimalsCheck=!0),e%1?e.toString().split(".")[1].length:0},t.sign=function(e){return t.zimSignCheck||(De("13.1"),t.zimSignCheck=!0),e?e<0?-1:1:0},t.constrain=function(e,r,i,l){if(De("13.2"),!n(e)){if(n(r)&&(r=0),n(i)&&(i=Number.MAX_VALUE),i<r){var a=r;i=r,r=a}return n(l)&&(l=!1),l&&e<0?Math.max(-i,Math.min(e,-r)):Math.max(r,Math.min(e,i))}},t.dist=function(e,r,i,l){if(t.zimDistCheck||(De("13.3"),t.zimDistCheck=!0),!(n(e)||n(r)))return!n(e.x)&&!n(r.x)?(l=r.y,i=r.x,r=e.y,e=e.x):(n(i)&&(i=0),n(l)&&(l=0)),Math.sqrt(Math.pow(i-e,2)+Math.pow(l-r,2))},t.rectIntersect=function(e,r,i){return t.zimRectIntersectCheck||(De("13.32"),t.zimRectIntersectCheck=!0),n(i)&&(i=0),!(e.x>=r.x+r.width+i||e.x+e.width+i<=r.x||e.y>=r.y+r.height+i||e.y+e.height+i<=r.y)},t.boundsAroundPoints=function(e){t.zimBoundsAroundPointsCheck||(De("13.34"),t.zimBoundsAroundPointsCheck=!0);for(var r=1e4,i=1e4,l=-1e4,a=-1e4,s=0;s<e.length;s++){var f=e[s];f.x<r&&(r=f.x),f.x>l&&(l=f.x),f.y<i&&(i=f.y),f.y>a&&(a=f.y)}return{x:r,y:i,width:l-r,height:a-i}},t.angle=function(e,r,i,l){if(t.angleCheck||(De("13.4"),t.angleCheck=!0),!(n(e)||n(r)))return n(i)&&(i=e,e=0),n(l)&&(l=r,r=0),(Math.atan2(l-r,i-e)*180/Math.PI+360)%360},t.TAU=Math.PI*2,t.DEG=180/Math.PI,t.RAD=Math.PI/180,t.PHI=Math.pow(5,.5)*.5+.5,t.smoothStep=function(e,r,i){De("13.7");var l=t.constrain((e-r)/(i-r),0,1);return l*l*l*(l*(l*6-15)+10)},t.unicodeToUTF=function(e){if(De("13.75"),!!e){e!=" "&&(e=e.replace(/^\s+/g,""));var r,i="",l="";return r=e.charCodeAt(0),i=r,l=e.charCodeAt(1),l>=56320&&l<=57343&&(r=(i-55296)*1024+(l-56320)+65536),i=i.toString(16),l=l.toString(16),r=r.toString(16),"\\u"+i+"\\u"+l}},t.capitalizeFirst=function(e){return De("13.78"),e.charAt(0).toUpperCase()+e.slice(1)},t.Ajax=function(e,r,i,l){De("13.8");var a=new XMLHttpRequest;this.master=e,this.couple=r,this.lock=i,this.unique=l;var s=this;this.get=function(f,u){var y=n(s.master)?"":"&master="+encodeURI(e),k=n(s.lock)?"":"&lock="+encodeURI(i),g=s.unique?"&unique=true":"";a.open("GET",f+y+k+g,!0),a.onload=function(){a.status==200?u(t.isJSON(a.responseText)?JSON.parse(a.responseText):a.responseText):u(null,"Error: "+a.status)},a.send()},this.post=function(f,u,y,k,g){var O="url, data, command, extra, callback",T;if(T=st(s.post,arguments,O))return T;if(!n(f)){a.open("POST",f,!0),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onload=function(){var P=a.responseText;t.isJSON(P)&&(s.couple&&(P=t.decouple(P)),P=JSON.parse(P)),g(P)},t.isJSON(u)||(u=JSON.stringify(u)),s.couple&&(u=t.couple(u));var E=n(s.master)?"":"&master="+encodeURIComponent(s.master),A=n(s.lock)?"":"&lock="+encodeURIComponent(s.lock),C=s.unique?"&unique=true":"",d=n(y)?"":"&command="+encodeURIComponent(y),x=n(k)?"":"&extra="+encodeURIComponent(k);a.send("data="+encodeURIComponent(u)+E+A+d+x+C)}},this.put=function(f,u,y){a.open("PUT",f,!0),a.setRequestHeader("Content-type","application/json"),a.onload=function(){y(t.isJSON(a.responseText)?JSON.parse(a.responseText):s.http.responseText)},a.send(JSON.stringify(u))}},t.Noise=function(e){"use strict";De("13.9"),n(e)&&(e=Math.random()*1e6);var r=e;this.seed=e;var i=this,l={};l.NORM_2D=1/47,l.NORM_3D=1/103,l.NORM_4D=1/30,l.SQUISH_2D=(Math.sqrt(2+1)-1)/2,l.SQUISH_3D=(Math.sqrt(3+1)-1)/3,l.SQUISH_4D=(Math.sqrt(4+1)-1)/4,l.STRETCH_2D=(1/Math.sqrt(2+1)-1)/2,l.STRETCH_3D=(1/Math.sqrt(3+1)-1)/3,l.STRETCH_4D=(1/Math.sqrt(4+1)-1)/4,l.base2D=[[1,1,0,1,0,1,0,0,0],[1,1,0,1,0,1,2,1,1]],l.base3D=[[0,0,0,0,1,1,0,0,1,0,1,0,1,0,0,1],[2,1,1,0,2,1,0,1,2,0,1,1,3,1,1,1],[1,1,0,0,1,0,1,0,1,0,0,1,2,1,1,0,2,1,0,1,2,0,1,1]],l.base4D=[[0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,4,1,1,1,1],[1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1],[3,1,1,1,0,3,1,1,0,1,3,1,0,1,1,3,0,1,1,1,2,1,1,0,0,2,1,0,1,0,2,1,0,0,1,2,0,1,1,0,2,0,1,0,1,2,0,0,1,1]],l.gradients2D=[5,2,2,5,-5,2,-2,5,5,-2,2,-5,-5,-2,-2,-5],l.gradients3D=[-11,4,4,-4,11,4,-4,4,11,11,4,4,4,11,4,4,4,11,-11,-4,4,-4,-11,4,-4,-4,11,11,-4,4,4,-11,4,4,-4,11,-11,4,-4,-4,11,-4,-4,4,-11,11,4,-4,4,11,-4,4,4,-11,-11,-4,-4,-4,-11,-4,-4,-4,-11,11,-4,-4,4,-11,-4,4,-4,-11],l.gradients4D=[3,1,1,1,1,3,1,1,1,1,3,1,1,1,1,3,-3,1,1,1,-1,3,1,1,-1,1,3,1,-1,1,1,3,3,-1,1,1,1,-3,1,1,1,-1,3,1,1,-1,1,3,-3,-1,1,1,-1,-3,1,1,-1,-1,3,1,-1,-1,1,3,3,1,-1,1,1,3,-1,1,1,1,-3,1,1,1,-1,3,-3,1,-1,1,-1,3,-1,1,-1,1,-3,1,-1,1,-1,3,3,-1,-1,1,1,-3,-1,1,1,-1,-3,1,1,-1,-1,3,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,3,1,1,-1,1,3,1,-1,1,1,3,-1,1,1,1,-3,-3,1,1,-1,-1,3,1,-1,-1,1,3,-1,-1,1,1,-3,3,-1,1,-1,1,-3,1,-1,1,-1,3,-1,1,-1,1,-3,-3,-1,1,-1,-1,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,3,1,-1,-1,1,3,-1,-1,1,1,-3,-1,1,1,-1,-3,-3,1,-1,-1,-1,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,3,-1,-1,-1,1,-3,-1,-1,1,-1,-3,-1,1,-1,-1,-3,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3,-1,-1,-1,-1,-3],l.lookupPairs2D=[0,1,1,0,4,1,17,0,20,2,21,2,22,5,23,5,26,4,39,3,42,4,43,3],l.lookupPairs3D=[0,2,1,1,2,2,5,1,6,0,7,0,32,2,34,2,129,1,133,1,160,5,161,5,518,0,519,0,546,4,550,4,645,3,647,3,672,5,673,5,674,4,677,3,678,4,679,3,680,13,681,13,682,12,685,14,686,12,687,14,712,20,714,18,809,21,813,23,840,20,841,21,1198,19,1199,22,1226,18,1230,19,1325,23,1327,22,1352,15,1353,17,1354,15,1357,17,1358,16,1359,16,1360,11,1361,10,1362,11,1365,10,1366,9,1367,9,1392,11,1394,11,1489,10,1493,10,1520,8,1521,8,1878,9,1879,9,1906,7,1910,7,2005,6,2007,6,2032,8,2033,8,2034,7,2037,6,2038,7,2039,6],l.lookupPairs4D=[0,3,1,2,2,3,5,2,6,1,7,1,8,3,9,2,10,3,13,2,16,3,18,3,22,1,23,1,24,3,26,3,33,2,37,2,38,1,39,1,41,2,45,2,54,1,55,1,56,0,57,0,58,0,59,0,60,0,61,0,62,0,63,0,256,3,258,3,264,3,266,3,272,3,274,3,280,3,282,3,2049,2,2053,2,2057,2,2061,2,2081,2,2085,2,2089,2,2093,2,2304,9,2305,9,2312,9,2313,9,16390,1,16391,1,16406,1,16407,1,16422,1,16423,1,16438,1,16439,1,16642,8,16646,8,16658,8,16662,8,18437,6,18439,6,18469,6,18471,6,18688,9,18689,9,18690,8,18693,6,18694,8,18695,6,18696,9,18697,9,18706,8,18710,8,18725,6,18727,6,131128,0,131129,0,131130,0,131131,0,131132,0,131133,0,131134,0,131135,0,131352,7,131354,7,131384,7,131386,7,133161,5,133165,5,133177,5,133181,5,133376,9,133377,9,133384,9,133385,9,133400,7,133402,7,133417,5,133421,5,133432,7,133433,5,133434,7,133437,5,147510,4,147511,4,147518,4,147519,4,147714,8,147718,8,147730,8,147734,8,147736,7,147738,7,147766,4,147767,4,147768,7,147770,7,147774,4,147775,4,149509,6,149511,6,149541,6,149543,6,149545,5,149549,5,149558,4,149559,4,149561,5,149565,5,149566,4,149567,4,149760,9,149761,9,149762,8,149765,6,149766,8,149767,6,149768,9,149769,9,149778,8,149782,8,149784,7,149786,7,149797,6,149799,6,149801,5,149805,5,149814,4,149815,4,149816,7,149817,5,149818,7,149821,5,149822,4,149823,4,149824,37,149825,37,149826,36,149829,34,149830,36,149831,34,149832,37,149833,37,149842,36,149846,36,149848,35,149850,35,149861,34,149863,34,149865,33,149869,33,149878,32,149879,32,149880,35,149881,33,149882,35,149885,33,149886,32,149887,32,150080,49,150082,48,150088,49,150098,48,150104,47,150106,47,151873,46,151877,45,151881,46,151909,45,151913,44,151917,44,152128,49,152129,46,152136,49,152137,46,166214,43,166215,42,166230,43,166247,42,166262,41,166263,41,166466,48,166470,43,166482,48,166486,43,168261,45,168263,42,168293,45,168295,42,168512,31,168513,28,168514,31,168517,28,168518,25,168519,25,280952,40,280953,39,280954,40,280957,39,280958,38,280959,38,281176,47,281178,47,281208,40,281210,40,282985,44,282989,44,283001,39,283005,39,283208,30,283209,27,283224,30,283241,27,283256,22,283257,22,297334,41,297335,41,297342,38,297343,38,297554,29,297558,24,297562,29,297590,24,297594,21,297598,21,299365,26,299367,23,299373,26,299383,23,299389,20,299391,20,299584,31,299585,28,299586,31,299589,28,299590,25,299591,25,299592,30,299593,27,299602,29,299606,24,299608,30,299610,29,299621,26,299623,23,299625,27,299629,26,299638,24,299639,23,299640,22,299641,22,299642,21,299645,20,299646,21,299647,20,299648,61,299649,60,299650,61,299653,60,299654,59,299655,59,299656,58,299657,57,299666,55,299670,54,299672,58,299674,55,299685,52,299687,51,299689,57,299693,52,299702,54,299703,51,299704,56,299705,56,299706,53,299709,50,299710,53,299711,50,299904,61,299906,61,299912,58,299922,55,299928,58,299930,55,301697,60,301701,60,301705,57,301733,52,301737,57,301741,52,301952,79,301953,79,301960,76,301961,76,316038,59,316039,59,316054,54,316071,51,316086,54,316087,51,316290,78,316294,78,316306,73,316310,73,318085,77,318087,77,318117,70,318119,70,318336,79,318337,79,318338,78,318341,77,318342,78,318343,77,430776,56,430777,56,430778,53,430781,50,430782,53,430783,50,431e3,75,431002,72,431032,75,431034,72,432809,74,432813,69,432825,74,432829,69,433032,76,433033,76,433048,75,433065,74,433080,75,433081,74,447158,71,447159,68,447166,71,447167,68,447378,73,447382,73,447386,72,447414,71,447418,72,447422,71,449189,70,449191,70,449197,69,449207,68,449213,69,449215,68,449408,67,449409,67,449410,66,449413,64,449414,66,449415,64,449416,67,449417,67,449426,66,449430,66,449432,65,449434,65,449445,64,449447,64,449449,63,449453,63,449462,62,449463,62,449464,65,449465,63,449466,65,449469,63,449470,62,449471,62,449472,19,449473,19,449474,18,449477,16,449478,18,449479,16,449480,19,449481,19,449490,18,449494,18,449496,17,449498,17,449509,16,449511,16,449513,15,449517,15,449526,14,449527,14,449528,17,449529,15,449530,17,449533,15,449534,14,449535,14,449728,19,449729,19,449730,18,449734,18,449736,19,449737,19,449746,18,449750,18,449752,17,449754,17,449784,17,449786,17,451520,19,451521,19,451525,16,451527,16,451528,19,451529,19,451557,16,451559,16,451561,15,451565,15,451577,15,451581,15,451776,19,451777,19,451784,19,451785,19,465858,18,465861,16,465862,18,465863,16,465874,18,465878,18,465893,16,465895,16,465910,14,465911,14,465918,14,465919,14,466114,18,466118,18,466130,18,466134,18,467909,16,467911,16,467941,16,467943,16,468160,13,468161,13,468162,13,468163,13,468164,13,468165,13,468166,13,468167,13,580568,17,580570,17,580585,15,580589,15,580598,14,580599,14,580600,17,580601,15,580602,17,580605,15,580606,14,580607,14,580824,17,580826,17,580856,17,580858,17,582633,15,582637,15,582649,15,582653,15,582856,12,582857,12,582872,12,582873,12,582888,12,582889,12,582904,12,582905,12,596982,14,596983,14,596990,14,596991,14,597202,11,597206,11,597210,11,597214,11,597234,11,597238,11,597242,11,597246,11,599013,10,599015,10,599021,10,599023,10,599029,10,599031,10,599037,10,599039,10,599232,13,599233,13,599234,13,599235,13,599236,13,599237,13,599238,13,599239,13,599240,12,599241,12,599250,11,599254,11,599256,12,599257,12,599258,11,599262,11,599269,10,599271,10,599272,12,599273,12,599277,10,599279,10,599282,11,599285,10,599286,11,599287,10,599288,12,599289,12,599290,11,599293,10,599294,11,599295,10],l.p2D=[0,0,1,-1,0,0,-1,1,0,2,1,1,1,2,2,0,1,2,0,2,1,0,0,0],l.p3D=[0,0,1,-1,0,0,1,0,-1,0,0,-1,1,0,0,0,1,-1,0,0,-1,0,1,0,0,-1,1,0,2,1,1,0,1,1,1,-1,0,2,1,0,1,1,1,-1,1,0,2,0,1,1,1,-1,1,1,1,3,2,1,0,3,1,2,0,1,3,2,0,1,3,1,0,2,1,3,0,2,1,3,0,1,2,1,1,1,0,0,2,2,0,0,1,1,0,1,0,2,0,2,0,1,1,0,0,1,2,0,0,2,2,0,0,0,0,1,1,-1,1,2,0,0,0,0,1,-1,1,1,2,0,0,0,0,1,1,1,-1,2,3,1,1,1,2,0,0,2,2,3,1,1,1,2,2,0,0,2,3,1,1,1,2,0,2,0,2,1,1,-1,1,2,0,0,2,2,1,1,-1,1,2,2,0,0,2,1,-1,1,1,2,0,0,2,2,1,-1,1,1,2,0,2,0,2,1,1,1,-1,2,2,0,0,2,1,1,1,-1,2,0,2,0],l.p4D=[0,0,1,-1,0,0,0,1,0,-1,0,0,1,0,0,-1,0,0,-1,1,0,0,0,0,1,-1,0,0,0,1,0,-1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,-1,0,0,-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,2,1,1,0,0,1,1,1,-1,0,1,1,1,0,-1,0,2,1,0,1,0,1,1,-1,1,0,1,1,0,1,-1,0,2,0,1,1,0,1,-1,1,1,0,1,0,1,1,-1,0,2,1,0,0,1,1,1,-1,0,1,1,1,0,-1,1,0,2,0,1,0,1,1,-1,1,0,1,1,0,1,-1,1,0,2,0,0,1,1,1,-1,0,1,1,1,0,-1,1,1,1,4,2,1,1,0,4,1,2,1,0,4,1,1,2,0,1,4,2,1,0,1,4,1,2,0,1,4,1,1,0,2,1,4,2,0,1,1,4,1,0,2,1,4,1,0,1,2,1,4,0,2,1,1,4,0,1,2,1,4,0,1,1,2,1,2,1,1,0,0,3,2,1,0,0,3,1,2,0,0,1,2,1,0,1,0,3,2,0,1,0,3,1,0,2,0,1,2,0,1,1,0,3,0,2,1,0,3,0,1,2,0,1,2,1,0,0,1,3,2,0,0,1,3,1,0,0,2,1,2,0,1,0,1,3,0,2,0,1,3,0,1,0,2,1,2,0,0,1,1,3,0,0,2,1,3,0,0,1,2,2,3,1,1,1,0,2,1,1,1,-1,2,2,0,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,2,0,0,0,2,3,1,0,1,1,2,1,-1,1,1,2,2,0,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,2,0,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,2,0,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,2,0,0,2,3,1,1,1,0,2,1,1,1,-1,2,0,0,2,0,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,2,0,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,2,0,2,3,1,1,0,1,2,1,1,-1,1,2,0,0,0,2,2,3,1,0,1,1,2,1,-1,1,1,2,0,0,0,2,2,3,0,1,1,1,2,-1,1,1,1,2,0,0,0,2,2,1,1,1,-1,0,1,1,1,0,-1,0,0,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,0,0,0,0,0,2,1,-1,1,1,0,1,0,1,1,-1,0,0,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,0,0,0,0,0,2,1,-1,1,0,1,1,0,1,-1,1,0,0,0,0,0,2,1,-1,0,1,1,1,0,-1,1,1,0,0,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,2,0,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,2,0,0,0,2,1,1,-1,0,1,1,1,0,-1,1,2,2,0,0,0,2,1,1,1,-1,0,1,1,1,0,-1,2,0,2,0,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,2,0,0,2,1,-1,1,0,1,1,0,1,-1,1,2,0,2,0,0,2,1,1,-1,1,0,1,1,0,1,-1,2,0,0,2,0,2,1,-1,1,1,0,1,0,1,1,-1,2,0,0,2,0,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,2,0,2,1,1,-1,0,1,1,1,0,-1,1,2,0,0,0,2,2,1,-1,1,0,1,1,0,1,-1,1,2,0,0,0,2,2,1,-1,0,1,1,1,0,-1,1,1,2,0,0,0,2,3,1,1,0,0,0,2,2,0,0,0,2,1,1,1,-1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,1,-1,3,1,0,0,1,0,2,0,0,2,0,2,1,1,1,-1,3,1,1,0,0,0,2,2,0,0,0,2,1,1,-1,1,3,1,0,1,0,0,2,0,2,0,0,2,1,1,-1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,1,-1,1,3,1,1,0,0,0,2,2,0,0,0,2,1,-1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,1,-1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,1,-1,1,1,3,1,0,1,0,0,2,0,2,0,0,2,-1,1,1,1,3,1,0,0,1,0,2,0,0,2,0,2,-1,1,1,1,3,1,0,0,0,1,2,0,0,0,2,2,-1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,4,1,1,1,1,3,3,2,0,1,0,3,1,0,2,0,4,1,1,1,1,3,3,0,2,1,0,3,0,1,2,0,4,1,1,1,1,3,3,2,0,0,1,3,1,0,0,2,4,1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,4,1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,4,1,1,1,1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,1,-1,3,3,2,0,1,0,3,1,0,2,0,2,1,1,1,-1,3,3,0,2,1,0,3,0,1,2,0,2,1,1,1,-1,3,3,2,1,0,0,3,1,2,0,0,2,1,1,-1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,1,-1,1,3,3,0,2,0,1,3,0,1,0,2,2,1,1,-1,1,3,3,2,0,1,0,3,1,0,2,0,2,1,-1,1,1,3,3,2,0,0,1,3,1,0,0,2,2,1,-1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,1,-1,1,1,3,3,0,2,1,0,3,0,1,2,0,2,-1,1,1,1,3,3,0,2,0,1,3,0,1,0,2,2,-1,1,1,1,3,3,0,0,2,1,3,0,0,1,2,2,-1,1,1,1];function a(P){var v=new Uint32Array(1);return v[0]=P[0]*1664525+1013904223,v}function s(P,v,w){this.dx=-v-P*l.SQUISH_2D,this.dy=-w-P*l.SQUISH_2D,this.xsb=v,this.ysb=w}function f(P,v,w,b){this.dx=-v-P*l.SQUISH_3D,this.dy=-w-P*l.SQUISH_3D,this.dz=-b-P*l.SQUISH_3D,this.xsb=v,this.ysb=w,this.zsb=b}function u(P,v,w,b,X){this.dx=-v-P*l.SQUISH_4D,this.dy=-w-P*l.SQUISH_4D,this.dz=-b-P*l.SQUISH_4D,this.dw=-X-P*l.SQUISH_4D,this.xsb=v,this.ysb=w,this.zsb=b,this.wsb=X}var y=[],k,g,O,T,E,A;for(k=0;k<l.p2D.length;k+=4){for(T=l.base2D[l.p2D[k]],E=null,A=null,g=0;g<T.length;g+=3)A=new s(T[g],T[g+1],T[g+2]),E===null?y[k/4]=A:E.next=A,E=A;A.next=new s(l.p2D[k+1],l.p2D[k+2],l.p2D[k+3])}for(this.lookup2D=[],k=0;k<l.lookupPairs2D.length;k+=2)this.lookup2D[l.lookupPairs2D[k]]=y[l.lookupPairs2D[k+1]];var C=[];for(k=0;k<l.p3D.length;k+=9){for(T=l.base3D[l.p3D[k]],E=null,A=null,g=0;g<T.length;g+=4)A=new f(T[g],T[g+1],T[g+2],T[g+3]),E===null?C[k/9]=A:E.next=A,E=A;A.next=new f(l.p3D[k+1],l.p3D[k+2],l.p3D[k+3],l.p3D[k+4]),A.next.next=new f(l.p3D[k+5],l.p3D[k+6],l.p3D[k+7],l.p3D[k+8])}for(this.lookup3D=[],k=0;k<l.lookupPairs3D.length;k+=2)this.lookup3D[l.lookupPairs3D[k]]=C[l.lookupPairs3D[k+1]];var d=[];for(k=0;k<l.p4D.length;k+=16){for(T=l.base4D[l.p4D[k]],E=null,A=null,g=0;g<T.length;g+=5)A=new u(T[g],T[g+1],T[g+2],T[g+3],T[g+4]),E===null?d[k/16]=A:E.next=A,E=A;A.next=new u(l.p4D[k+1],l.p4D[k+2],l.p4D[k+3],l.p4D[k+4],l.p4D[k+5]),A.next.next=new u(l.p4D[k+6],l.p4D[k+7],l.p4D[k+8],l.p4D[k+9],l.p4D[k+10]),A.next.next.next=new u(l.p4D[k+11],l.p4D[k+12],l.p4D[k+13],l.p4D[k+14],l.p4D[k+15])}for(this.lookup4D=[],k=0;k<l.lookupPairs4D.length;k+=2)this.lookup4D[l.lookupPairs4D[k]]=d[l.lookupPairs4D[k+1]];this.perm=new Uint8Array(256),this.perm2D=new Uint8Array(256),this.perm3D=new Uint8Array(256),this.perm4D=new Uint8Array(256);var x=new Uint8Array(256);for(k=0;k<256;k++)x[k]=k;for(e=new Uint32Array(1),e[0]=r,e=a(a(a(e))),k=255;k>=0;k--)e=a(e),O=new Uint32Array(1),O[0]=(e[0]+31)%(k+1),O[0]<0&&(O[0]+=k+1),this.perm[k]=x[O[0]],this.perm2D[k]=this.perm[k]&14,this.perm3D[k]=this.perm[k]%24*3,this.perm4D[k]=this.perm[k]&252,x[O[0]]=x[k];this.simplex1D=function(P){return i.simplex2D(P,1)},this.simplex2D=function(P,v){var w=(P+v)*l.STRETCH_2D,b=[P+w,v+w],X=b[0],Y=b[1],m=[Math.floor(X),Math.floor(Y)],j=m[0],S=m[1],_=(j+S)*l.SQUISH_2D,R=[P-(j+_),v-(S+_)],U=R[0],Z=R[1],K=[X-j,Y-S],ne=K[0],V=K[1],D=ne+V,c=new Uint32Array(4);c[0]=ne-V+1,c[1]=D,c[2]=D+V,c[3]=D+ne;for(var h=c[0]|c[1]<<1|c[2]<<2|c[3]<<4,o=i.lookup2D[h],I=0;typeof o<"u";){var N=[U+o.dx,Z+o.dy],p=N[0],L=N[1],we=2-p*p-L*L;if(we>0){var B=[j+o.xsb,S+o.ysb],F=B[0],fe=B[1],se=i.perm2D[i.perm[F&255]+fe&255],Q=l.gradients2D[se]*p+l.gradients2D[se+1]*L;we*=we,I+=we*we*Q}o=o.next}return I*l.NORM_2D},this.simplex3D=function(P,v,w){var b=(P+v+w)*l.STRETCH_3D,X=[P+b,v+b,w+b],Y=X[0],m=X[1],j=X[2],S=[Math.floor(Y),Math.floor(m),Math.floor(j)],_=S[0],R=S[1],U=S[2],Z=(_+R+U)*l.SQUISH_3D,K=[P-(_+Z),v-(R+Z),w-(U+Z)],ne=K[0],V=K[1],D=K[2],c=[Y-_,m-R,j-U],h=c[0],o=c[1],I=c[2],N=h+o+I,p=new Uint32Array(7);p[0]=o-I+1,p[1]=h-o+1,p[2]=h-I+1,p[3]=N,p[4]=N+I,p[5]=N+o,p[6]=N+h;for(var L=p[0]|p[1]<<1|p[2]<<2|p[3]<<3|p[4]<<5|p[5]<<7|p[6]<<9,we=i.lookup3D[L],B=0;typeof we<"u";){var F=[ne+we.dx,V+we.dy,D+we.dz],fe=F[0],se=F[1],Q=F[2],te=2-fe*fe-se*se-Q*Q;if(te>0){var le=[_+we.xsb,R+we.ysb,U+we.zsb],Ae=le[0],J=le[1],Te=le[2],G=i.perm3D[i.perm[i.perm[Ae&255]+J&255]+Te&255],ce=l.gradients3D[G]*fe+l.gradients3D[G+1]*se+l.gradients3D[G+2]*Q;te*=te,B+=te*te*ce}we=we.next}return B*l.NORM_3D},this.simplex4D=function(P,v,w,b){var X=(P+v+w+b)*l.STRETCH_4D,Y=[P+X,v+X,w+X,b+X],m=Y[0],j=Y[1],S=Y[2],_=Y[3],R=[Math.floor(m),Math.floor(j),Math.floor(S),Math.floor(_)],U=R[0],Z=R[1],K=R[2],ne=R[3],V=(U+Z+K+ne)*l.SQUISH_4D,D=P-(U+V),c=v-(Z+V),h=w-(K+V),o=b-(ne+V),I=[m-U,j-Z,S-K,_-ne],N=I[0],p=I[1],L=I[2],we=I[3],B=N+p+L+we,F=new Uint32Array(11);F[0]=L-we+1,F[1]=p-L+1,F[2]=p-we+1,F[3]=N-p+1,F[4]=N-L+1,F[5]=N-we+1,F[6]=B<<6,F[7]=B+we,F[8]=B+L,F[9]=B+p,F[10]=B+N;for(var fe=F[0]|F[1]<<1|F[2]<<2|F[3]<<3|F[4]<<4|F[5]<<5|F[6]<<6|F[7]<<8|F[8]<<11|F[9]<<14|F[10]<<17,se=i.lookup4D[fe],Q=0;typeof se<"u";){var te=[D+se.dx,c+se.dy,h+se.dz,o+se.dw],le=te[0],Ae=te[1],J=te[2],Te=te[3],G=2-le*le-Ae*Ae-J*J-Te*Te;if(G>0){var ce=[U+se.xsb,Z+se.ysb,K+se.zsb,ne+se.wsb],q=ce[0],ue=ce[1],ge=ce[2],ie=ce[3],xe=i.perm4D[i.perm[i.perm[i.perm[q&255]+ue&255]+ge&255]+ie&255],Se=l.gradients4D[xe]*le+l.gradients4D[xe+1]*Ae+l.gradients4D[xe+2]*J+l.gradients4D[xe+3]*Te;G*=G,Q+=G*G*Se}se=se.next}return Q*l.NORM_4D}},typeof Fe<"u"&&(t.Point=function(e,r,i,l,a,s,f,u,y,k){De("13.45"),n(e)&&(e=0),n(r)&&(r=0),n(i)&&(i=0),n(l)&&(l=0),n(a)&&(a=0),n(s)&&(s=0),n(f)&&(f=0),n(u)&&(u=0),n(y)&&(y=0),n(k)&&(k=0),this.createjsPoint_constructor(e,r),this.type="Point",this.x=e,this.y=r,this.z=i,this.q=l,this.r=a,this.s=s,this.t=f,this.u=u,this.v=y,this.w=k,this.angle=function(g){return this.createjsPoint_angle(g)*180/Math.PI},this.project=function(g,O){return this.createjsPoint_project(g*Math.PI/180,O)}},t.extend(t.Point,Fe.Point,["angle","project"],"createjsPoint")),t.Bezier=function(r,i,l,a){De("13.47"),this.a=r,this.b=i,this.c=l,this.d=a,this.len=100,this.arcLengths=new Array(this.len+1),this.arcLengths[0]=0;for(var s=this.x(0),f=this.y(0),u=0,y=1;y<=this.len;y+=1){var k=this.x(y*.01),g=this.y(y*.01),O=s-k,T=f-g;u+=Math.sqrt(O*O+T*T),this.arcLengths[y]=u,s=k,f=g}this.length=u},t.Bezier.prototype={map:function(e){for(var r=e*this.arcLengths[this.len],i=0,l=this.len,a=0;i<l;)a=i+((l-i)/2|0),this.arcLengths[a]<r?i=a+1:l=a;this.arcLengths[a]>r&&a--;var s=this.arcLengths[a];return s===r?a/this.len:(a+(r-s)/(this.arcLengths[a+1]-s))/this.len},mx:function(e){return this.x(this.map(e))},my:function(e){return this.y(this.map(e))},x:function(e){return(1-e)*(1-e)*(1-e)*this.a.x+3*((1-e)*(1-e))*e*this.b.x+3*(1-e)*(e*e)*this.c.x+e*e*e*this.d.x},y:function(e){return(1-e)*(1-e)*(1-e)*this.a.y+3*((1-e)*(1-e))*e*this.b.y+3*(1-e)*(e*e)*this.c.y+e*e*e*this.d.y}},t.Boundary=function(e,r,i,l){De("13.46"),e.x&&(l=e.height,i=e.width,r=e.y,e=e.x),!(n(e)||n(r)||n(i)||n(l))&&(this.x=e,this.y=r,this.width=i,this.height=l,this.contract=function(a,s,f,u){return n(a)?this:(n(s)&&(s=a),n(f)?f=a*2:f=f+a,n(u)?u=s*2:u=u+s,this.x+=a,this.y+=s,this.width-=f,this.height-=u,this)})},t.GradientColor=function(e,r,i,l,a,s){if(De("13.465"),this.type="GradientColor",this.colors=n(e)?["black","white"]:e,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=n(r)?0:r,!Array.isArray(this.ratios)){this.angle=this.ratios,this.ratios=[];for(var f=0;f<this.colors.length;f++)this.ratios.push(f/(this.colors.length-1))}!n(i)&&(n(l)||n(a)||n(s))?(this.angle=i,i=null):n(this.angle)&&n(i)&&n(l)&&n(a)&&n(s)?this.angle=0:(this.x0=n(i)?0:i,this.y0=n(l)?0:l,this.x1=n(a)?0:a,this.y1=n(s)?100:s)},t.RadialColor=function(e,r,i,l,a,s,f,u){if(De("13.466"),this.type="RadialColor",this.colors=n(e)?["black","white"]:e,Array.isArray(this.colors)||(this.colors=[this.colors,this.colors]),this.colors.length==1&&this.colors.push(this.colors[0]),this.ratios=r,!Array.isArray(this.ratios)){this.ratios=[];for(var y=0;y<this.colors.length;y++)this.ratios.push(y/(this.colors.length-1))}this.x0=i,this.y0=l,this.r0=a,this.x1=s,this.y1=f,this.r1=u},t.BitmapColor=function(e,r,i){De("13.467"),this.type="BitmapColor",typeof e=="string"&&ee.asset&&(e=ee.asset(e)),e.type!="Bitmap"&&e.bitmap&&(e=e.bitmap),this.image=e.type=="Bitmap"?e.image:e,this.repetition=r,this.matrix=i},t.Damp=function(e,r){De("14");var i="startValue, damp",l;if(l=st(t.Damp,arguments,i,this))return l;this.lastValue=n(e)?0:e,this.damp=n(r)?.1:r},t.Damp.prototype.convert=function(e){return this.lastValue=this.lastValue+(e-this.lastValue)*this.damp},t.Damp.prototype.immediate=function(e){return this.lastValue=e,this},t.Proportion=function(e,r,i,l,a,s,f){var u="baseMin, baseMax, targetMin, targetMax, factor, targetRound, clamp",y;if(y=st(t.Proportion,arguments,u,this))return y;De("15"),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=1),n(s)&&(s=!1),n(f)&&(f=!0);var k,g;this.convert=function(O){if(n(O)&&(O=e),!(isNaN(O)||r-e==0))return f&&(O=Math.max(O,e),O=Math.min(O,r)),k=(O-e)/(r-e),a>0?g=i+(l-i)*k:g=l-(l-i)*k,s&&(g=Math.round(g)),g}},t.ProportionDamp=function(e,r,i,l,a,s,f,u){var y="baseMin, baseMax, targetMin, targetMax, damp, factor, targetRound, clamp",k;if(k=st(t.ProportionDamp,arguments,y,this))return k;De("16"),n(i)&&(i=0),n(l)&&(l=1),n(a)&&(a=.1),n(s)&&(s=1),n(f)&&(f=!1),n(u)&&(u=!0),this.damp=a;var g=this,O,T,E,A,C,d=0,x=0;O=e,x=i;var P=setInterval(v,20);function v(){isNaN(O)||r-e==0||(u&&(O=Math.max(O,e),O=Math.min(O,r)),T=(O-e)/(r-e),E=l-i,s>0?A=i+E*T:A=l-E*T,d=A,C=d-x,x+=C*g.damp)}this.immediate=function(w){return g.convert(w),v(),x=A,f&&(x=Math.round(x)),g},this.immediateValue=function(w){return d=x=w,g},this.convert=function(w){return O=w,f?Math.round(x):x},this.dispose=function(){return clearInterval(P),!0}},t.Dictionary=function(e){De("17"),this.length=0,this.unique=e;var r=this.objects=[],i=this.values=[];this.type="Dictionary",this.add=function(l,a){n(l)||(n(a)&&(a=!0),this.unique&&this.remove(l),r.push(l),i.push(a),this.length++)},this.at=function(l){if(!n(l)){var a=r.indexOf(l);return a>-1?i[a]:null}},this.remove=function(l){if(n(l))return!1;var a=r.indexOf(l);return a>-1?(r.splice(a,1),i.splice(a,1),this.length--,!0):!1},this.clear=function(){return r=this.objects=[],i=this.values=[],this.length=null,this},this.dispose=function(){return r=null,i=null,this.length=null,!0}},t.Hierarchy=function(e,r){De("17.5");var i=this;if(n(e))return;n(r)&&(r=!1);var l;i.processSimple=function(u){var y=0,k={};function g(O,T,E,A){if(n(O)||(u=O),u.constructor=={}.constructor){var C;u.list&&(C=u,u=u.list),A&&C&&t.loop(C,function(d,x){d!="list"&&(A[d]=x)}),t.loop(u,function(d,x){var P={},v=T["id"+y]={obj:d,level:E,open:r,opened:!1,list:P};y++,g(x,P,E+1,v)})}else Array.isArray(u)&&t.loop(u,function(d){T["id"+y]={obj:d},y++})}return g(e,k,0),l=y,k},i.processComplex=function(u){var y=0;function k(g,O){t.loop(g,function(T,E){E.level=O,n(E.open)&&(E.open=r),n(E.opened)&&(E.opened=!1),E.list&&k(E.list,O+1),y++})}return k(u,0),l=y,u},n(e.id0)?i.data=i.processSimple(e):i.data=i.processComplex(e),i.getLinearList=function(u){return n(u)&&(u=i.data),a(u)[0]},i.getLinearIDs=function(u){return n(u)&&(u=i.data),a(u)[1]};function a(u){var y=[],k=[];function g(O,T){t.loop(O,function(E,A){y.push(A.obj),k.push(E),A.open&&g(A.list,T+1)})}return g(u,0),[y,k]}i.getData=function(u){var y;function k(g){t.loop(g,function(O,T){if(O==u)return y=T,y;k(T.list)})}return k(i.data),y},i.getNextSibling=function(u){var y,k;function g(O){t.loop(O,function(T,E){if(!k&&y)return k=T,k;T==u?y=E:g(E.list)})}return g(i.data),k},i.getPrevSibling=function(u){var y=[],k;function g(O,T){t.loop(O,function(E,A){if(E==u)return k=y[T]||y[T-1],k;y[T]=E,g(A.list,T+1)})}return g(i.data,0),k},i.insertBefore=function(u,y,k){return s("insertBefore",u,y,k)},i.insertAfter=function(u,y,k){return s("insertAfter",u,y,k)},i.removeItem=function(u){return s("removeItem",null,u)},i.replaceItem=function(u,y){var k=i.getData(y);return k.obj=u,s("replaceItem")};function s(u,y,k,g){var O=0,T={},E=i.data;function A(C,d,x,P){t.loop(C,function(v,w){if(!(u=="removeItem"&&v==k)){var b,X,Y;u=="insertBefore"&&v==k&&(O=f(d,O,x,y,g)),b={},X=w.list,w.list=b,w.opened=!1,w.open=!1,Y=d["id"+O]=w,Y.obj.type&&Y.obj.type=="TabsButton"&&(Y.obj=Y.obj.text),O++,A(X,b,x+1),u=="insertAfter"&&v==k&&(O=f(d,O,x,y,g))}})}return A(E,T,0),l=O,T}function f(u,y,k,g,O){if(O){var T={};Array.isArray(g)&&(g=g[0]),u["id"+y]={obj:g,level:k,open:!1,opened:!1,list:T},y++,Array.isArray(O)||(O=[O]),t.loop(O,function(E){T["id"+y]={obj:E,level:k+1,open:!1,opened:!1,list:{}},y++})}else Array.isArray(g)||(g=[g]),t.loop(g,function(E){u["id"+y]={obj:E,level:k,open:!1,opened:!1,list:{}},y++});return y}i.getParent=function(u){var y=i.data;function k(g,O){var T=t.loop(g,function(E,A){if(E==u)return l-=1,O;if(A.list&&!t.isEmpty(A.list))return k(A.list,E)});if(T!==!0)return T}return k(y)},Object.defineProperty(i,"length",{get:function(){return l},set:function(){vt&&tt("Hierarchy() - length is read only")}})},t.Pick=function(e){t.pickCheck||(De("17.6"),t.pickCheck=!0),this.choices=e,this.num=function(i){for(var l=[],a=0;a<i;a++)l.push(t.Pick.choose(this));return this.choices=t.Pick.series(l),this};var r=this;this.loop=function(i,l){for(var a,s=0;s<i;s++)if(a=l(t.Pick.choose(r),s,i),typeof a<"u")return a}},t.Pick.prototype.type="Pick",t.Pick.series=function(){return t.pickCheck||(De("17.6"),t.pickCheck=!0),t.series.apply(null,arguments)},t.Pick.rand=function(e,r,i,l){return t.pickCheck||(De("17.6"),t.pickCheck=!0),t.rand(e,r,i,l)},t.Pick.choose=function(e,r,i){if(t.pickCheck||(De("17.6"),t.pickCheck=!0),r==null&&(r=!0),e==null)return e;if(e.type=="Pick"||r){var l=e.choices||e,a;return Array.isArray(l)?(a=l[Math.floor(Math.random()*l.length)],t.Pick.choose(a)):l.constructor==={}.constructor?n(l.noPick)?n(l.max)?l:(n(l.integer)&&(l.integer=!1),a=t.Pick.rand(l.min,l.max,l.integer,l.negative),a):l.noPick:l instanceof Function?(l.count==null?l.count=0:l.count++,t.Pick.choose(l(i,!0))):e}else return e},t.Pick.getMinMax=function(e){return!n(e.min)&&!n(e.max)?e:Array.isArray(e)?t.arrayMinMax(e):e.type=="series"?t.arrayMinMax(e.array):{min:null,max:null}},t.scrollX=function(e,r){return De("18"),t.abstractScroll("X","Left",e,r)},t.scrollY=function(e,r){return De("19"),t.abstractScroll("Y","Top",e,r)},t.abstractScroll=function(e,r,i,l){De("20");var a=Tt(l),s=e=="X"?"Y":"X";if(n(i))return document.documentElement&&document.documentElement["scroll"+r]||document.body["scroll"+r];if(n(l))ee.scrollTo(t["scroll"+s](),i);else{var f=50,u=l*(a=="s"?1e3:1);u<f&&(u=f);var y=u/f,k=t["scroll"+e](),g=i-k,O=g/y,T=0,E=setInterval(function(){T++,k+=O,ee.scrollTo(t["scroll"+s](),k),T>=y&&(ee.scrollTo(t["scroll"+s](),i),clearInterval(E))},f)}return i},t.windowWidth=function(){De("21");var e=isNaN(ee.innerWidth)?ee.clientWidth:ee.innerWidth,r=isNaN(ee.innerHeight)?ee.clientHeight:ee.innerHeight;if(t.mobile()&&!n(ee.orientation)&&!ee.parent&&(e>r&&Math.abs(ee.orientation)!=90||r>e&&Math.abs(ee.orientation)==90)){var i=e;e=r,r=i}return ee.zdf&&ee.zdf.swapRotation?r:e},t.windowHeight=function(){De("22");var e=isNaN(ee.innerWidth)?ee.clientWidth:ee.innerWidth,r=isNaN(ee.innerHeight)?ee.clientHeight:ee.innerHeight;if(t.mobile()&&!n(ee.orientation)&&!ee.parent&&(e>r&&Math.abs(ee.orientation)!=90||r>e&&Math.abs(ee.orientation)==90)){var i=e;e=r,r=i}return ee.zdf&&ee.zdf.swapRotation?e:r},t.browserZoom=function(){if(t.zimBZ)return n(t.zimBZA)?t.decimals((ee.devicePixelRatio||1)/t.zimBZ1,2):t.zimBZA;if(De("22.2"),t.zimBZ=!0,typeof e>"u")if(ee.zdf)var e=ee.zdf;else return t.zimBZA=1,1;if(e.retina)t.zimBZ1=ee.devicePixelRatio||1;else return t.zimBZA=1,1},t.getQueryString=function(e){if(De("22.5"),n(e)&&(e=location.search.replace("?","")),e=="")return{};for(var r=e.split("&"),i={},l=0;l<r.length;l++){var a=r[l].split("=");typeof i[a[0]]>"u"?i[a[0]]=decodeURIComponent((a[1]+"").replace(/\+/g,"%20")):typeof i[a[0]]=="string"?i[a[0]]=[i[a[0]],decodeURIComponent((a[1]+"").replace(/\+/g,"%20"))]:i[a[0]].push(decodeURIComponent((a[1]+"").replace(/\+/g,"%20")))}return i},t.swapHTML=function(e,r){return De("17.2"),t.swapProperties("innerHTML",Cn(e),Cn(r))},t.urlEncode=function(e){return De("23"),e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")},t.urlDecode=function(e){return De("24"),decodeURIComponent((e+"").replace(/\+/g,"%20"))},t.setCookie=function(e,r,i){if(De("25"),!(n(e)||n(r))){var l;if(i){var a=new Date;a.setTime(a.getTime()+i*24*60*60*1e3),l="; expires="+a.toGMTString()}else l="";return document.cookie=e+"="+escape(r)+l+"; path=/",!0}},t.getCookie=function(e){De("26");for(var r=document.cookie.split(/;\s*/),i=new Array,l,a=0;a<r.length;a++)l=r[a].split("="),i[l[0]]=l[1];if(!(typeof i[e]>"u"))return unescape(i[e])},t.deleteCookie=function(e){return De("27"),n(t.getCookie(e))?!1:(t.setCookie(e,"",-1),!0)},Fe==null)return vt&&ii("ZIM >= 4.3.0 requires createjs namespace to be loaded (import createjs before zim)"),t;t.localToGlobal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null)){var s=a.call(l,r,i),f=l.stage;if(!ee.zdf){if(!f)return s;ee.zdf={stage:f,canvas:f.canvas}}return s.x/=t.scaX,s.y/=t.scaY,s}},t.globalToLocal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null)){var s=l.stage;if(!ee.zdf){if(!s)return a.call(l,r,i);ee.zdf={stage:s,canvas:s.canvas}}r*=t.scaX,i*=t.scaY;var f=a.call(l,r,i);return f}},t.localToLocal=function(r,i,l,a){if(t.coordinatesCheck||(De("50.43"),t.coordinatesCheck=!0),!(r==null||i==null||l==null)){var s=a.localToGlobal(r,i),f=a.stage;if(!ee.zdf){if(!f)return l.globalToLocal(s.x,s.y);ee.zdf={stage:f,canvas:f.canvas}}if(f||(f=ee.zdf.stage),l==f)return s;if(s)return l.globalToLocal(s.x,s.y)}},t.displayBase=function(e){t.zimDBCheck||(De("50.432"),t.zimDBCheck=!0);var r=e;if(Object.defineProperty(e,"width",{enumerable:!0,get:function(){var u=this.getBounds();return n(u)?null:Math.abs(u.width*this.scaleX)},set:function(u){if(e.scaleDimensions!==!1){var y=this.getBounds();if(n(y)||y.width==0){vt&&tt("DisplayObject() - width needs bounds set with setBounds()");return}var k=u/y.width;this.scaleX=this.scaleY=k}else{var g=e.width!=0?e.height/e.width:0;e.setWidth(u),e.setHeight(u*g),e.drawShape()}}}),Object.defineProperty(e,"height",{enumerable:!0,get:function(){var u=this.getBounds();return n(u)?null:Math.abs(u.height*this.scaleY)},set:function(u){if(e.scaleDimensions!==!1){var y=this.getBounds();if(n(y)||y.height==0){vt&&tt("DisplayObject() - height needs bounds set with setBounds()");return}var k=u/y.height;this.scaleX=this.scaleY=k}else{var g=e.height!=0?e.width/e.height:0;e.setHeight(u),e.setWidth(u*g),e.drawShape()}}}),Object.defineProperty(e,"widthOnly",{enumerable:!0,get:function(){var u=this.getBounds();return n(u)?null:Math.abs(u.width*this.scaleX)},set:function(u){if(e.scaleDimensions!==!1){var y=this.getBounds();if((n(y)||y.width==0)&&vt){tt("DisplayObject() - widthOnly needs bounds set with setBounds()");return}var k=u/y.width;this.scaleX=k}else e.setWidth(u),e.drawShape()}}),Object.defineProperty(e,"heightOnly",{enumerable:!0,get:function(){var u=this.getBounds();return n(u)?null:Math.abs(u.height*this.scaleY)},set:function(u){if(e.scaleDimensions!==!1){var y=this.getBounds();if((n(y)||y.height==0)&&vt){tt("DisplayObject() - heightOnly needs bounds set with setBounds()");return}var k=u/y.height;this.scaleY=k}else e.setHeight(u),e.drawShape()}}),Object.defineProperty(e,"level",{enumerable:!0,get:function(){return this.parent?this.parent.getChildIndex(this):null},set:function(u){this.parent&&this.parent.setChildIndex(this,Math.max(0,Math.min(u,this.parent.numChildren-1)))}}),Object.defineProperty(e,"depth",{enumerable:!0,get:function(){return this._depth},set:function(u){if(this._depth=u,!n(this.vrChannel)){var y=this.vrParallaxDistance?u*this.vrParallax*this.vrParallaxDistance:0;this.vrChannel=="left"?this.x=this.vrStartX+u+y:this.vrChannel=="right"&&(this.x=this.vrStartX-u+y)}}}),Object.defineProperty(e,"blendMode",{enumerable:!0,get:function(){return this.compositeOperation},set:function(u){this.compositeOperation=u}}),!r.name){var i;Object.defineProperty(r,"name",{get:function(){return i},set:function(u){i=u,t.zimObjectIDs[u]=r}})}r._draggable,Object.defineProperty(r,"draggable",{get:function(){return this._draggable},set:function(u){u!=this._draggable&&(this._draggable=u,this._draggable?this.drag():this.noDrag())}});var l,a;r.on("mousedown",function(u){u.target.stage&&(l=u.target.stage.frame,l.allowDefault&&(a=!0,l.allowDefault=!1))}),r.on("pressup",function(){l&&a&&(l.allowDefault=!0)});for(var s=["hue","saturation","brightness","contrast"],f=0;f<s.length;f++)-function(){for(var u=s[f],y=0;y<2;y++)-function(){var k=y==0?"":"Batch";Object.defineProperty(r,u+k,{get:function(){return r.effects&&r.effects.multi?r.effects.multi[u]:0},set:function(g){!r.effects||!r.effects.multi?r.effect(new t.MultiEffect(u=="hue"?g:0,u=="saturation"?g:0,u=="brightness"?g:0,u=="contrast"?g:0)):r.effects.multi[u]=g,k==""&&r.updateEffects()}})}()}()},t.gD=function(e){if(t.zimGDCheck||(De("50.435"),t.zimGDCheck=!0),!!e){if(e.z_bc){var r=e.z_bc;r.width=r.height=1,r.getContext&&r.getContext("2d").clearRect(0,0,1,1),delete e.z_bc}t.KEYFOCUS==e&&(t.KEYFOCUS=null),ee.KEYFOCUS==e&&(ee.KEYFOCUS=null),e.veeObj&&(e.veeObj=null),e.draggable&&e.noDrag(),e.zimTweens&&e.stopAnimate(),e.zimWire&&e.noWire(),e.zimWired&&e.noWired(),e.zimClickHoldDownEvent&&e.noHold(),e.transformControls&&e.transformControls.dispose(),e.zimClickDownEvent&&(e.zimClickDownEvent=null),e.zimClickUpEvent&&(e.zimClickUpEvent=null),e.physics&&e.removePhysics(),e.name&&t.zimObjectIDs[e.name]==e&&delete t.zimObjectIDs[e.name]}},t.Stage=function(e,r,i){if(De("50.44"),!n(e)){var l=e.tagName=="CANVAS"?e:Cn(e);n(l)||(this.cjsStage_constructor(e),this.setBounds(0,0,l.width,l.height),this.type="Stage",ee.zdf||(ee.zimDefaultFrame=ee.zdf={stage:this}),i?Fe.Touch.enable(this,!0):r&&Fe.Touch.enable(this,!1),this.cache=function(a,s,f,u,y,k){if(n(f))if(n(a)){var g=this.getBounds();if(!n(g)){var O=this.borderWidth>0?this.borderWidth/2:0;a=g.x-O,s=g.y-O,f=g.width+O*2,u=g.height+O*2}}else f=a,u=s,a=0,s=0;return this.cjsStage_cache(a,s,f,u,y,k),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(a){var s=a.clone();s.type="pressdown",a.target.dispatchEvent(s)},void 0,!1,void 0,!0),this.loop=function(a,s,f,u,y,k){return t.loop(this,a,s,f,u,y,k)},this.hitTestGrid=function(a,s,f,u,y,k,g,O,T,E,A,C){return t.hitTestGrid(this,a,s,f,u,y,k,g,O,T,E,A,C)},this.disposeAllChildren=function(){for(var a=this.numChildren-1;a>=0;a--){var s=this.getChildAt(a);s.dispose&&s.dispose()}return this},this.frame=ee.zdf,Fe&&!Fe.stageTransformable&&(ee.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(a){this.cjsStage_scaleX=a,this.cjsStage_scaleY=a,t.scaX=Fe.stageTransformable?1:a,t.scaY=Fe.stageTransformable?1:a}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(a){this.cjsStage_scaleX=a,t.scaX=Fe.stageTransformable?1:a}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(a){this.cjsStage_scaleY=a,t.scaY=Fe.stageTransformable?1:a}}),this.localToGlobal=function(a,s){return t.localToGlobal(a,s,this,this.cjsStage_localToGlobal)},this.globalToLocal=function(a,s){return t.globalToLocal(a,s,this,this.cjsStage_globalToLocal)},this.localToLocal=function(a,s,f){return t.localToLocal(a,s,f,this)}))}},t.extend(t.Stage,Fe.Stage,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStage",!1),t.StageGL=function(e,r,i,l){if(De("50.45"),!n(e)){var a=e.tagName=="CANVAS"?e:Cn(e);n(a)||(this.cjsStageGL_constructor(e,r),this.setBounds(0,0,a.width,a.height),this.type="StageGL",ee.zdf||(ee.zdf={stage:this}),l?Fe.Touch.enable(this,!0):i&&Fe.Touch.enable(this,!1),this.cache=function(s,f,u,y,k,g){if(n(u))if(n(s)){var O=this.getBounds();if(!n(O)){var T=this.borderWidth>0?this.borderWidth/2:0;s=O.x-T,f=O.y-T,u=O.width+T*2,y=O.height+T*2}}else u=s,y=f,s=0,f=0;return this.cjsStageGL_cache(s,f,u,y,k,g),this.z_bc=this.cacheCanvas,this},this.on("mousedown",function(s){var f=s.clone();f.type="pressdown",s.target.dispatchEvent(f)},void 0,!1,void 0,!0),this.loop=function(s,f,u,y,k,g){return t.loop(this,s,f,u,y,k,g)},this.hitTestGrid=function(s,f,u,y,k,g,O,T,E,A,C,d){return t.hitTestGrid(this,s,f,u,y,k,g,O,T,E,A,C,d)},this.disposeAllChildren=function(){for(var s=this.numChildren-1;s>=0;s--){var f=this.getChildAt(s);f.dispose&&f.dispose()}return this},this.frame=ee.zdf,Fe&&!Fe.stageTransformable&&(ee.zdf.retina||typeof exportRoot<"u")&&(Object.defineProperty(this,"scale",{get:function(){return this.cjsStage_scale},set:function(s){this.cjsStage_scaleX=s,this.cjsStage_scaleY=s,t.scaX=Fe.stageTransformable?1:s,t.scaY=Fe.stageTransformable?1:s}}),Object.defineProperty(this,"scaleX",{get:function(){return this.cjsStage_scaleX},set:function(s){this.cjsStage_scaleX=s,t.scaX=Fe.stageTransformable?1:s}}),Object.defineProperty(this,"scaleY",{get:function(){return this.cjsStage_scaleY},set:function(s){this.cjsStage_scaleY=s,t.scaY=Fe.stageTransformable?1:s}}),this.localToGlobal=function(s,f){return t.localToGlobal(s,f,this,this.cjsStageGL_localToGlobal)},this.globalToLocal=function(s,f){return t.globalToLocal(s,f,this,this.cjsStageGL_globalToLocal)},this.localToLocal=function(s,f,u){return t.localToLocal(s,f,u,this)}))}},t.extend(t.StageGL,Fe.StageGL,["cache","localToLocal","localToGlobal","globalToLocal"],"cjsStageGL",!1),t.Container=function(e,r,i,l,a,s,f){var u="a, b, c, d, style, group, inherit",y;if(y=st(t.Container,arguments,u,this))return y;t.containerCheck||(De("50.5"),De("50.435"),t.containerCheck=!0),this.cjsContainer_constructor(),this.type="Container",this.group=s;var k=this,g=a===!1?{}:t.getStyle(this.type,this.group,f);n(e)&&(e=g.a!=null?g.a:null),n(r)&&(r=g.b!=null?g.b:null),n(i)&&(i=g.c!=null?g.c:null),n(l)&&(l=g.d!=null?g.d:null);var O=T(e,r,i,l);function T(A,C,d,x){var P=[];return n(A)?P=[A,C,d,x]:n(C)?A.x?P=[A.x,A.y,A.width,A.height]:(P[0]=0,P[1]=0,P[2]=A,P[3]=A):n(d)?(P[0]=0,P[1]=0,P[2]=A,P[3]=C):(P[0]=A,P[1]=C,P[2]=d,P[3]=x),n(P[3])&&(P[3]=P[2]),P}n(e)||this.setBounds(O[0],O[1],O[2],O[3]),this.cache=function(A,C,d,x,P,v,w,b,X){if(k.type=="AC"&&ee.zdf)return ee.zdf.ac("cache",arguments,k),k;var Y="a,b,c,d,scale,options,margin,rtl,willReadFrequently",m;if(m=st(k.cache,arguments,Y))return m;var j=k.getBounds();if(n(d))if(n(A)){if(!n(j)){var S=k.borderWidth>0?k.borderWidth/2:0;A=j.x-S,C=j.y-S,d=j.width+S*2,x=j.height+S*2}}else d=A,x=C,A=0,C=0;return k.type=="Triangle"&&(A-=k.borderWidth?k.borderWidth:0,d+=k.borderWidth?k.borderWidth*2:0,C-=k.borderWidth?k.borderWidth:0,x+=k.borderWidth?k.borderWidth*2:0),n(w)&&(w=0),k.cjsContainer_cache(A-w,C-w,d+w*2,x+w*2,P,v,b,X),j&&k.setBounds(j.x,j.y,j.width,j.height),k.z_bc=k.canvas=k.cacheCanvas,k},this.uncache=function(){return k.cjsContainer_uncache(),k},this.childrenToBitmap=function(){var A=this.cacheCanvas,C=new t.Bitmap(this.cache().cacheCanvas);return A||this.uncache(),this.removeAllChildren(),C.addTo(this),this};var E=ee.zdf||1;Fe&&!Fe.stageTransformable&&E.retina&&(this.localToGlobal=function(A,C){return t.localToGlobal(A,C,this,this.cjsContainer_localToGlobal)},this.globalToLocal=function(A,C){return t.globalToLocal(A,C,this,this.cjsContainer_globalToLocal)},this.localToLocal=function(A,C,d){return t.localToLocal(A,C,d,this)}),this.setBounds=function(A,C,d,x){var P=T(A,C,d,x);return k.cjsContainer_setBounds(P[0],P[1],P[2],P[3]),k},this.getBounds=function(A){return A?k.boundsToGlobal(null,null,null,A):k.cjsContainer_getBounds()},this.disposeAllChildren=function(){for(var A=this.numChildren-1;A>=0;A--){var C=this.getChildAt(A);C.dispose&&C.dispose()}return this},t.displayBase(k),a!==!1&&t.styleTransforms(this,g),this.clone=function(A){if(this.type=="AC"&&ee.zdf)return vt&&tt("ZIM asset() - cannot clone lazy-loaded asset - use Frame() assets parameter or loadAssets() method"),ee.zdf.ac("clone",arguments,this),this;var C=this.getBounds();return n(C)&&(C={x:null,y:null,width:null,height:null}),this.cloneChildren(this.cloneProps(new t.Container(C.x,C.y,C.width,C.height,a,this.group,f)),A)},this.hasProp=function(A){return!n(this[A])||Object.prototype.hasOwnProperty.call(this,A)}},t.Container.prototype.dispose=function(e){return It(this,e),!0},t.Container.prototype.specialColor=function(e,r,i){if(r.type=="GradientColor"){if(!n(r.angle))if(i.width){var l=i.getBounds();if(r.angle+=360*1e5,r.angle%=360,i.type=="Circle"){var a=l.width/2*Math.cos(r.angle*RAD),s=l.width/2*Math.sin(r.angle*RAD);r.x0=-a,r.y0=-s,r.x1=a,r.y1=s}else{var f=r.angle%90,u=l.width*Math.sin(f*RAD),y=u*Math.sin(f*RAD),k=-u*Math.cos(f*RAD),g=l.height*Math.sin(f*RAD),O=l.width+g*Math.cos(f*RAD),T=g*Math.sin(f*RAD),E=l.height*Math.sin(f*RAD),A=-E*Math.cos(f*RAD),C=l.height-E*Math.sin(f*RAD);r.angle>=0&&r.angle<90?(r.x0=l.x+y,r.y0=l.y+k,r.x1=l.x+O,r.y1=l.y+T):r.angle>=90&&r.angle<180?(r.x0=l.x+y,r.y0=l.y+k,r.x1=l.x+A,r.y1=l.y+C):r.angle>=180&&r.angle<270?(r.x0=l.x+O,r.y0=l.y+T,r.x1=l.x+y,r.y1=l.y+k):(r.x0=l.x+A,r.y0=l.y+C,r.x1=l.x+y,r.y1=l.y+k)}}else{e.style=r.colors[0];return}e.linearGradient(r.colors,r.ratios,r.x0,r.y0,r.x1,r.y1)}else if(r.type=="RadialColor"){if(n(r.x0))if(i.width){var l=i.getBounds();r.r0=0,i.type=="Circle"?(r.x0=0,r.y0=0,r.r1=l.width/2):(r.x0=l.x+l.width/2,r.y0=l.y+l.height/2,r.r1=Math.sqrt(Math.pow(l.width/2,2)+Math.pow(l.height/2,2))),r.x1=r.x0,r.y1=r.y0}else{e.style=r.colors[0];return}e.radialGradient(r.colors,r.ratios,r.x0,r.y0,r.r0,r.x1,r.y1,r.r1)}else r.type=="BitmapColor"&&e.bitmap(r.image,r.repetition,r.matrix)};function It(e,r){if(e&&t.gD(e),!r&&e&&e.dispose&&e.dispose!==t.Container.prototype.dispose&&e.dispose(null,null,!0),e&&e.addChild&&(e.dispatchEvent("removed"),e.removeAllEventListeners(),e.numChildren))for(var i=e.numChildren-1;i>=0;i--)It(e.getChildAt(i));e&&e.parent&&e.parent.removeChild(e)}t.extend(t.Container,Fe.Container,["cache","uncache","setBounds","getBounds","clone","localToLocal","localToGlobal","globalToLocal"],"cjsContainer",!1),Un(t.Container.prototype),t.Shape=function(e,r,i,l,a,s,f,u,y){var k="a, b, c, d, graphics, optimize, style, group, inherit",g;if(g=st(t.Shape,arguments,k,this))return g;De("50.6"),this.cjsShape_constructor(a),this.type="Shape",this.group=u;var O=f===!1?{}:t.getStyle(this.type,this.group,y),T=this;n(e)&&(e=O.a!=null?O.a:null),n(r)&&(r=O.b!=null?O.b:null),n(i)&&(i=O.c!=null?O.c:null),n(l)&&(l=O.d!=null?O.d:null),n(a)&&(a=O.graphics!=null?O.graphics:null),n(s)&&(s=O.optimize!=null?O.optimize:!1);var E=A(e,r,i,l);function A(P,v,w,b){var X=[];return n(P)?X=[P,v,w,b]:n(v)?P.x?X=[P.x,P.y,P.width,P.height]:(X[0]=0,X[1]=0,X[2]=P,X[3]=P):n(w)?(X[0]=0,X[1]=0,X[2]=P,X[3]=v):(X[0]=P,X[1]=v,X[2]=w,X[3]=b),n(X[3])&&(X[3]=X[2]),X}if(n(e)||this.setBounds(E[0],E[1],E[2],E[3]),!s)for(var C=["mt","lt","a","at","bt","ct","qt","cp","c","f","lf","rf","bf","ef","ss","sd","s","ls","rs","bs","es","dr","rr","rc","dc","de","dp","pg","p"],d=0;d<C.length;d++)~function(){var P=d;T[C[P]]=function(){return C[P]=="ct"?T.graphics.curveTo.apply(T.graphics,arguments):T.graphics[C[P]].apply(T.graphics,arguments),T}}();Object.defineProperty(T,"command",{get:function(){return T.graphics.command},set:function(){}}),this.cache=function(P,v,w,b,X,Y,m,j,S){var _="a,b,c,d,scale,options,margin,rtl,willReadFrequently",R;if(R=st(T.cache,arguments,_))return R;var U=T.getBounds();if(n(w))if(n(P)){if(!n(U)){var Z=T.borderWidth>0?T.borderWidth/2:0;P=U.x-Z,v=U.y-Z,w=U.width+Z*2,b=U.height+Z*2}}else w=P,b=v,P=0,v=0;return n(m)&&(m=0),T.cjsShape_cache(P-m,v-m,w+m*2,b+m*2,X,Y,j,S),T.z_bc=T.canvas=T.cacheCanvas,T},this.setBounds=function(P,v,w,b){var X=A(P,v,w,b);return this.cjsShape_setBounds(X[0],X[1],X[2],X[3]),this},this.getBounds=function(P){return P?T.boundsToGlobal(null,null,null,P):T.cjsShape_getBounds()},f!==!1&&t.styleTransforms(this,O),this.clone=function(P){n(P)&&(P=!0);var v=this.getBounds();n(v)&&(v={x:null,y:null,width:null,height:null});var w=T.cloneProps(new t.Shape(v.x,v.y,v.width,v.height,a,f,u,y));return P?w.graphics=T.graphics.clone():w.graphics=T.graphics,w};var x=ee.zdf||1;Fe&&!Fe.stageTransformable&&x.retina&&(this.localToGlobal=function(P,v){return t.localToGlobal(P,v,this,this.cjsShape_localToGlobal)},this.globalToLocal=function(P,v){return t.globalToLocal(P,v,this,this.cjsShape_globalToLocal)},this.localToLocal=function(P,v,w){return t.localToLocal(P,v,w,this)}),this.hasProp=function(P){return!n(this[P])||Object.prototype.hasOwnProperty.call(this,P)},t.displayBase(T),this.dispose=function(){t.gD(this),this.graphics.c(),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.Shape,Fe.Shape,["cache","clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsShape",!1),Un(t.Shape.prototype),t.Bitmap=function(e,r,i,l,a,s,f,u,y){var k="image, width, height, left, top, scale, style, group, inherit",g;if(g=st(t.Bitmap,arguments,k,this))return g;De("50.7"),this.group=u;var O=f===!1?{}:t.getStyle("Bitmap",this.group,y);n(s)&&(s=O.scale!=null?O.scale:1),n(r)&&(r=O.width!=null?O.width:e?e.width:100),n(i)&&(i=O.height!=null?O.height:e?e.height:100),n(l)&&(l=O.left!=null?O.left:0),n(a)&&(a=O.top!=null?O.top:0);var T=!1,E=e;if(!n(e)&&e.uncache){T=!0;var A=e.cacheCanvas,C=e;e.cache(l,a,r,i,s),this.z_bc=e=e.cacheCanvas}this.cjsBitmap_constructor(e),C&&!A&&C.uncache();var d=this;this.type="Bitmap",!n(r)&&!n(i)&&this.setBounds(0,0,r,i),this.drawImageData=function(w,b,X,Y,m,j){if(n(w)&&(w=0),n(b)&&(b=0),n(X)&&(X=0),n(Y)&&(Y=0),n(m)&&(m=r),n(j)&&(j=i),!d.proxyCanvas){var S=d.proxyCanvas=document.createElement("canvas");S.setAttribute("width",r),S.setAttribute("height",i),d.proxyContext=S.getContext("2d"),e=E=d.image=S}d.proxyContext&&d.proxyContext.putImageData(d.imageData,w,b,X,Y,m,j)},ee.zdf&&(ee.zdf.canvas.getContext("2d")?this.imageData=ee.zdf.canvas.getContext("2d").createImageData(r,i):this.imageData=document.createElement("canvas").getContext("2d").createImageData(r,i),n(e)&&d.drawImageData(),e&&e.match&&e.match(/data:image/i)&&setTimeout(function(){d.stage&&d.stage.update(),setTimeout(function(){d.stage&&d.stage.update()},50)},50)),e&&e.nodeName&&e.nodeName.toLowerCase()!="video"&&(T?d.sourceRect={x:0,y:0,width:r*s,height:i*s}:d.sourceRect={x:l,y:a,width:r,height:i});function x(w,b,X,Y){var m=[];return n(w)?m=[w,b,X,Y]:n(b)?w.x?m=[w.x,w.y,w.width,w.height]:(m[0]=0,m[1]=0,m[2]=w,m[3]=w):n(X)?(m[0]=0,m[1]=0,m[2]=w,m[3]=b):(m[0]=w,m[1]=b,m[2]=X,m[3]=Y),n(m[3])&&(m[3]=m[2]),m}this.setBounds=function(w,b,X,Y){var m=x(w,b,X,Y);return d.cjsBitmap_setBounds(m[0],m[1],m[2],m[3]),d},this.getBounds=function(w){return w?d.boundsToGlobal(null,null,null,w):d.cjsBitmap_getBounds()},this.cache=function(w,b,X,Y,m,j,S,_){var R="a,b,c,d,scale,options,rtl,willReadFrequently",U;if(U=st(d.cache,arguments,R))return U;var Z;if(n(X))if(n(w)){if(Z=this.getBounds(),!n(Z)){var K=this.borderWidth>0?this.borderWidth/2:0;w=Z.x-K,b=Z.y-K,X=Z.width+K*2,Y=Z.height+K*2}}else X=w,Y=b,w=0,b=0;return Z=d.getBounds(),d.cjsBitmap_cache(w,b,X,Y,m,j,S,_),d.setBounds(Z.x,Z.y,Z.width,Z.height),d.z_bc=d.canvas=d.cacheCanvas,d},this.clone=function(){var w=this.cloneProps(new t.Bitmap(E,r,i,l,a,s,f,this.group,y));return w.cloned=!0,w.src=d.src,w.file=d.file,w.image=d.image,w.svg=d.svg,w.item=d.item,w};var P=ee.zdf||1;Fe&&!Fe.stageTransformable&&P.retina&&(this.localToGlobal=function(w,b){return t.localToGlobal(w,b,this,this.cjsBitmap_localToGlobal)},this.globalToLocal=function(w,b){return t.globalToLocal(w,b,this,this.cjsBitmap_globalToLocal)},this.localToLocal=function(w,b,X){return t.localToLocal(w,b,X,this)}),this.hasProp=function(w){return!n(this[w])||Object.prototype.hasOwnProperty.call(this,w)};var v;this.getColorAt=function(w,b,X){v||(d.cache(null,null,null,null,null,null,null,!0),v=d.cacheCanvas.getContext("2d"),d.uncache());var Y=v.getImageData(w,b,1,1).data;return Y[3]/=255,X?Y:"rgba("+Y[0]+","+Y[1]+","+Y[2]+","+Y[3]+")"},this.keyOut=function(w,b,X){n(w)&&(w="#389b26"),n(b)&&(b=.1),Array.isArray(w)||(w=[w]),Array.isArray(b)||(b=[b]),!n(X)&&!Array.isArray(X)&&(X=[X]);var Y,m,j=[],S=[],_=[];for(Y=0;Y<w.length;Y++)j[Y]=t.convertColor(w[Y],"array"),b[Y]!=null?S[Y]=b[Y]*255:S[Y]=b[0]*255,X&&(X[Y]!=null?(_[Y]=t.convertColor(X[Y],"array"),_[Y][3]*=255):(_[Y]=t.convertColor(X[0],"array"),_[Y][3]*=255));d.cacheCanvas&&d.updateCache(),v||(d.cache(null,null,null,null,null,null,null,!0),v=d.cacheCanvas.getContext("2d"));var R=v.getImageData(l,a,r,i),U=R.data,Z=U.length/4;if(X)for(Y=0;Y<Z;Y++){var K=U[Y*4+0],ne=U[Y*4+1],V=U[Y*4+2];for(m=0;m<w.length;m++)K>j[m][0]-S[m]&&K<j[m][0]+S[m]&&ne>j[m][1]-S[m]&&ne<j[m][1]+S[m]&&V>j[m][2]-S[m]&&V<j[m][2]+S[m]&&(U[Y*4+0]=_[m][0],U[Y*4+1]=_[m][1],U[Y*4+2]=_[m][2],U[Y*4+3]=_[m][3])}else for(Y=0;Y<Z;Y++){var K=U[Y*4+0],ne=U[Y*4+1],V=U[Y*4+2];for(m=0;m<w.length;m++)K>j[m][0]-S[m]&&K<j[m][0]+S[m]&&ne>j[m][1]-S[m]&&ne<j[m][1]+S[m]&&V>j[m][2]-S[m]&&V<j[m][2]+S[m]&&(U[Y*4+3]=0)}return v.putImageData(R,a,l),this},t.displayBase(d),f!==!1&&t.styleTransforms(this,O),this.doDispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.cloned||this.id&&(this.stage&&this.stage.frame?P=this.stage.frame:P=ee.zdf,P&&P.assets&&P.assets[this.id]&&delete P.assets[this.id],t.assets[this.id]&&delete t.assets[this.id]),this.parent&&this.parent.removeChild(this)}},t.Bitmap.fromData=function(e,r){var i=100,l=100,a=new Image;a.onload=function(){i=a.naturalWidth,l=a.naturalHeight,n(i)&&(i=a.width),n(l)&&(l=a.height);var s=new t.Bitmap(e,i,l);setTimeout(function(){r(s)},50)},a.src=e},t.extend(t.Bitmap,Fe.Bitmap,["cache","clone","dispose","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsBitmap",!1),t.Bitmap.prototype.dispose=function(){return this.doDispose()},Un(t.Bitmap.prototype),t.Sprite=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v){var w="image, cols, rows, count, offsetX, offsetY, spacingX, spacingY, width, height, animations, json, id, globalControl, spriteSheet, label, frame, style, group, inherit",b;if(b=st(t.Sprite,arguments,w,this))return b;De("50.8"),this.type="Sprite",this.group=P;var X=x===!1?{}:t.getStyle(this.type,this.group,v),Y=this,m;if(n(d)&&(d=X.frame!=null?X.frame:ee.zdf),e&&typeof e=="string"&&(e=d.asset(e)),n(O)&&!n(e)){n(r)&&(r=X.cols!=null?X.cols:1),n(i)&&(i=X.rows!=null?X.rows:1),n(l)&&(l=X.count!=null?X.count:r*i),n(a)&&(a=X.offsetX!=null?X.offsetX:0),n(s)&&(s=X.offsetY!=null?X.offsetY:0),n(f)&&(f=X.spacingX!=null?X.spacingX:0),n(u)&&(u=X.spacingY!=null?X.spacingY:0),n(y)&&(y=X.width!=null?X.width:e.width),n(k)&&(k=X.height!=null?X.height:e.height),e.bitmap&&(e=e.bitmap);var j=(y-a+f)/r-f,S=(k-s+u)/i-u,_=[],R=0;e:for(var U=0;U<i;U++)for(var Z=0;Z<r;Z++){if(++R>l)break e;_.push([a+Z*(j+f),s+U*(S+u),j,S])}h(e,_,g)}else if(A)m=A,g=m.animations;else if(O){var d=Y.stage?Y.stage.frame:ee.zdf;typeof O=="string"&&(O=d.asset(O));var K,ne,V;if(O.frames&&!Array.isArray(O.frames)){K=[];for(ne in O.frames)V=O.frames[ne].frame,K.push([V.x,V.y,V.w,V.h]);O.frames=K}if(O.frames&&!Array.isArray(O.frames[0])){for(K=[],ne=0;ne<O.frames.length;ne++){var V=O.frames[ne].frame;K.push([V.x,V.y,V.w,V.h])}O.frames=K}if(!O.images&&O.meta&&O.meta.image&&(O.images=[O.meta.image]),_=O.frames,g=O.animations,!n(e))h(e,_,g);else{var D=O.images?O.images[0]:null;if(!D||!D.split)m=new Fe.SpriteSheet(O);else{var c=[];t.loop(O.images,function(L){var we=L.split("/").pop();d.asset(we)&&d.asset(we).type!="EmptyAsset"?c.push(d.asset(we)):d.asset(L)&&d.asset(L).type!="EmptyAsset"||d.asset(L).type!="EmptyAsset"?c.push(d.asset(L)):vt&&tt("Sprite() - please preload Sprite in Frame or with loadAssets")}),h(c,_,g)}}}else return;function h(p,L,we){Array.isArray(p)||(p=[p]),t.loop(p,function(F,fe){p[fe]=F.image});var B={images:p,frames:L,animations:we||[]};m=new Fe.SpriteSheet(B)}this.animations=g,this.cjsSprite_constructor(m,C),n(C)||this.stop(),n(T)&&(T=t.makeID()),this.id=T,n(E)&&(E=!0),Y.globalControl=E;var o=0,I;this.parseFrames=function(p,L,we,B){var F=[],fe=Number.MAX_VALUE,se=0;if(n(p))n(L)&&(L=0),n(we)&&(we=Y.totalFrames-1),J(L,we);else{if(n(Y.animations)||n(Y.animations[p]))return[];var Q=Y.animations[p];te(Q)}function te(ge){Array.isArray(ge)?le(ge):ge.constructor=={}.constructor?Ae(ge):isNaN(ge)||F.push({f:Math.floor(ge),s:1})}function le(ge){J(ge[0],ge[1],ge[3]),ge[2]&&!n(Y.animations[ge[2]])&&te(Y.animations[ge[2]])}function Ae(ge){if(!n(ge.frames)){n(ge.speed)&&(ge.speed=1);for(var ie=0;ie<ge.frames.length;ie++)ge.speed<fe&&(fe=ge.speed),ge.speed>se&&(se=ge.speed),F.push({f:ge.frames[ie],s:ge.speed});ge.next&&!n(Y.animations[ge.next])&&te(Y.animations[ge.next])}}function J(ge,ie,xe){n(xe)&&(xe=1);var Se;if(ie>ge)for(Se=ge;Se<=ie;Se++)z(Se);else for(Se=ie;Se<=ge;Se++)z(ge-(Se-ie));function z(pe){xe<fe&&(fe=xe),xe>se&&(se=xe),F.push({f:pe,s:xe})}}if(B)return F;fe=t.constrain(t.decimals(fe),.1),se=t.constrain(t.decimals(se),.1);for(var Te=[],G=fe!=se,ce,q=0;q<F.length;q++)if(ce=F[q],G)for(var ue=0;ue<t.constrain(Math.round(fe<1?ce.s/fe:ce.s),.1);ue++)Te.push(ce.f);else Te.push(ce.f);return Te},this.run=function(p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue,ge,ie,xe,Se,z,pe,de,oe,Be,$,Me,be){var me="time, label, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startFrame, endFrame, tweek, id, globalControl, pauseOnBlur",re;if(re=st(Y.run,arguments,me))return re;var ke=Tt(),Re;n(Be)&&(Be=1),n($)||(Y.id=$),n(Me)||(Y.globalControl=Me);var Ye;if(Array.isArray(L)){var $e,it;Re=[],Ye=0;for(var Le,Ze=0;Ze<L.length;Ze++){$e=L[Ze],$e.lookup=Y.parseFrames($e.label,$e.startFrame,$e.endFrame),Ze==0&&(Le=$e.lookup[0]),delete $e.startFrame,delete $e.endFrame,$e.obj=t.merge($e.obj,{normalizedFrame:$e.lookup.length-1}),$e.set=t.merge($e.set,{normalizedFrames:{noPick:$e.lookup},normalizedFrame:0}),n($e.wait)&&($e.wait=Ye*Be),it=$e.label,delete $e.label,Re.push($e),Ye=0;var ze=n($e.time)?p:$e.time;oe-de>0&&(Ye=ze/(oe-de)/2)}if(Re.length==0)return this;Re.length==1?(p=Re[0].time,L=it,ve()):Y.gotoAndStop(Le)}else ve();function ve(){I=Y.parseFrames(L,de,oe),o=0,Y.gotoAndStop(I[o]),de=oe=null,Re={normalizedFrame:I.length-1}}n(p)&&(p=ke=="s"?1:1e3),Y.running&&Y.stopAnimate(Y.id),Y.running=!0,Array.isArray(Re)||(Ye=0,oe-de>0&&(Ye=p/Math.abs(oe-de)/2),I&&I.length>0&&(Ye=p/I.length/2),!n(Q)&&n(le)&&(le=Ye*Be),!n(q)&&n(ue)&&(ue=Ye*Be));var Pe=function(){Y.running=!1,Y.stop(),we&&typeof we=="function"&&we(B||Y)};return t.animate({target:Y,obj:Re,time:p,ease:"linear",call:Pe,params:B,wait:F,waitedCall:fe,waitedParams:se,loop:Q,loopCount:te,loopWait:le,loopPick:ce,loopCall:Ae,loopParams:J,loopWaitCall:Te,loopWaitParams:G,rewind:q,rewindWait:ue,rewindCall:ge,rewindParams:ie,rewindWaitCall:xe,rewindWaitParams:Se,rewindTime:z,rewindEase:pe,override:!1,pauseOnBlur:be,id:Y.id}),Y.runPaused=!1,Y.pauseAnimate(!1),Y},this.runPaused=!0,this.pauseRun=function(p){return n(p)&&(p=!0),Y.runPaused=p,Y.globalControl?t.pauseAnimate(p,Y.id):Y.pauseAnimate(p,Y.id),Y},this.stopRun=function(){return Y.runPaused=!0,Y.running=!1,Y.globalControl?t.stopAnimate(Y.id):Y.stopAnimate(Y.id),Y},Object.defineProperty(this,"frame",{get:function(){return this.currentFrame},set:function(p){p=Math.round(p),this.paused?this.gotoAndStop(p):this.gotoAndPlay(p)}}),Object.defineProperty(this,"normalizedFrame",{get:function(){return o},set:function(p){o=Math.round(p),this.gotoAndStop(I[o])}}),Object.defineProperty(this,"normalizedFrames",{get:function(){return I},set:function(p){I=p}}),Object.defineProperty(this,"totalFrames",{get:function(){return m.getNumFrames()},set:function(){tt("zim.Sprite - totalFrames is read only")}}),x!==!1&&t.styleTransforms(this,X),this.clone=function(){var p=this.cloneProps(new t.Sprite(e,r,i,l,a,s,f,u,y,k,g,O,null,E,A,C,d,x,this.group,v));return Y.frame>=0&&p.run({startFrame:Y.frame,endFrame:Y.frame}),p},Fe&&!Fe.stageTransformable&&d.retina&&(this.localToGlobal=function(p,L){return t.localToGlobal(p,L,this,this.cjsSprite_localToGlobal)},this.globalToLocal=function(p,L){return t.globalToLocal(p,L,this,this.cjsSprite_globalToLocal)},this.localToLocal=function(p,L,we){return t.localToLocal(p,L,we,this)}),this.hasProp=function(p){return!n(this[p])||Object.prototype.hasOwnProperty.call(this,p)},t.displayBase(Y);function N(p,L,we,B){var F=[];return n(p)?F=[p,L,we,B]:n(L)?p.x?F=[p.x,p.y,p.width,p.height]:(F[0]=0,F[1]=0,F[2]=p,F[3]=p):n(we)?(F[0]=0,F[1]=0,F[2]=p,F[3]=L):(F[0]=p,F[1]=L,F[2]=we,F[3]=B),n(F[3])&&(F[3]=F[2]),F}this.setBounds=function(p,L,we,B){var F=N(p,L,we,B);return Y.cjsSprite_setBounds(F[0],F[1],F[2],F[3]),Y},this.getBounds=function(p){return p?Y.boundsToGlobal(null,null,null,p):Y.cjsSprite_getBounds()},this.dispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.Sprite,Fe.Sprite,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsSprite",!1),Un(t.Sprite.prototype),t.MovieClip=function(e,r,i,l,a,s,f){var u="mode, startPosition, loop, labels, style, group, inherit",y;if(y=st(t.MovieClip,arguments,u,this))return y;De("50.9"),this.type="MovieClip",this.group=s;var k=a===!1?{}:t.getStyle(this.type,this.group,f);n(e)&&(e=k.mode!=null?k.mode:null),n(r)&&(r=k.startPosition!=null?k.startPosition:null),n(i)&&(i=k.loop!=null?k.loop:null),n(l)&&(l=k.labels!=null?k.labels:null),this.cjsMovieClip_constructor(e,r,i,l),a!==!1&&t.styleTransforms(this,k),this.clone=function(){return this.cloneProps(new t.MovieClip(e,r,i,l,a,this.group,f))},this.hasProp=function(T){return!n(this[T])||Object.prototype.hasOwnProperty.call(this,T)};var g=ee.zdf||1;Fe&&!Fe.stageTransformable&&g.retina&&(this.localToGlobal=function(T,E){return t.localToGlobal(T,E,this,this.cjsMovieClip_localToGlobal)},this.globalToLocal=function(T,E){return t.globalToLocal(T,E,this,this.cjsMovieClip_globalToLocal)},this.localToLocal=function(T,E,A){return t.localToLocal(T,E,A,this)}),t.displayBase(this);function O(T,E,A,C){var d=[];return n(T)?d=[T,E,A,C]:n(E)?T.x?d=[T.x,T.y,T.width,T.height]:(d[0]=0,d[1]=0,d[2]=T,d[3]=T):n(A)?(d[0]=0,d[1]=0,d[2]=T,d[3]=E):(d[0]=T,d[1]=E,d[2]=A,d[3]=C),n(d[3])&&(d[3]=d[2]),d}this.setBounds=function(T,E,A,C){var d=O(T,E,A,C);return that.cjsMovieClip_setBounds(d[0],d[1],d[2],d[3]),that},this.getBounds=function(T){return T?that.boundsToGlobal(null,null,null,T):that.cjsMovieClip_getBounds()},this.dispose=function(){t.gD(this),this.dispatchEvent("removed"),this.removeAllEventListeners(),this.parent&&this.parent.removeChild(this)}},t.extend(t.MovieClip,Fe.MovieClip,["clone","setBounds","getBounds","localToLocal","localToGlobal","globalToLocal"],"cjsMovieClip",!1),Un(t.MovieClip.prototype),t.SVGContainer=function(e,r,i,l,a,s,f,u){var y="svg, splitTypes, geometric, showControls, interactive, style, group, inherit",k;if(k=st(t.SVGContainer,arguments,y,this))return k;De("50.95"),this.group=f;var g=s===!1?{}:t.getStyle("SVGContainer",this.group,u);e&&e.type=="Bitmap"&&(e=e.svg);var O=this,T=new t.Point(0,0),E;function A(){function N(Ae,J){return F(Ae)||B(Ae,J)||L(Ae,J)||p()}function p(){throw new TypeError("Invalid")}function L(Ae,J){if(Ae){if(typeof Ae=="string")return we(Ae,J);var Te=Object.prototype.toString.call(Ae).slice(8,-1);if(Te==="Object"&&Ae.constructor&&(Te=Ae.constructor.name),Te==="Map"||Te==="Set")return Array.from(Ae);if(Te==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Te))return we(Ae,J)}}function we(Ae,J){(J==null||J>Ae.length)&&(J=Ae.length);for(var Te=0,G=new Array(J);Te<J;Te++)G[Te]=Ae[Te];return G}function B(Ae,J){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Ae)))){var Te=[],G=!0,ce=!1,q=void 0;try{for(var ue=Ae[Symbol.iterator](),ge;!(G=(ge=ue.next()).done)&&(Te.push(ge.value),!(J&&Te.length===J));G=!0);}catch(ie){ce=!0,q=ie}finally{try{!G&&ue.return!=null&&ue.return()}finally{if(ce)throw q}}return Te}}function F(Ae){if(Array.isArray(Ae))return Ae}var fe=Math.PI*2,se=function(J,Te,G,ce,q,ue,ge){var ie=J.x,xe=J.y;ie*=Te,xe*=G;var Se=ce*ie-q*xe,z=q*ie+ce*xe;return{x:Se+ue,y:z+ge}},Q=function(J,Te){var G=Te===1.5707963267948966?.551915024494:Te===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(Te/4),ce=Math.cos(J),q=Math.sin(J),ue=Math.cos(J+Te),ge=Math.sin(J+Te);return[{x:ce-q*G,y:q+ce*G},{x:ue+ge*G,y:ge-ue*G},{x:ue,y:ge}]},te=function(J,Te,G,ce){var q=J*ce-Te*G<0?-1:1,ue=J*G+Te*ce;return ue>1&&(ue=1),ue<-1&&(ue=-1),q*Math.acos(ue)},le=function(J,Te,G,ce,q,ue,ge,ie,xe,Se,z,pe){var de=Math.pow(q,2),oe=Math.pow(ue,2),Be=Math.pow(z,2),$=Math.pow(pe,2),Me=de*oe-de*$-oe*Be;Me<0&&(Me=0),Me/=de*$+oe*Be,Me=Math.sqrt(Me)*(ge===ie?-1:1);var be=Me*q/ue*pe,me=Me*-ue/q*z,re=Se*be-xe*me+(J+G)/2,ke=xe*be+Se*me+(Te+ce)/2,Re=(z-be)/q,Ye=(pe-me)/ue,$e=(-z-be)/q,it=(-pe-me)/ue,Le=te(1,0,Re,Ye),Ze=te(Re,Ye,$e,it);return ie===0&&Ze>0&&(Ze-=fe),ie===1&&Ze<0&&(Ze+=fe),[re,ke,Le,Ze]};return function(J){var Te=J.px,G=J.py,ce=J.cx,q=J.cy,ue=J.rx,ge=J.ry,ie=J.xAxisRotation,xe=ie===void 0?0:ie,Se=J.largeArcFlag,z=Se===void 0?0:Se,pe=J.sweepFlag,de=pe===void 0?0:pe,oe=[];if(ue===0||ge===0)return[];var Be=Math.sin(xe*fe/360),$=Math.cos(xe*fe/360),Me=$*(Te-ce)/2+Be*(G-q)/2,be=-Be*(Te-ce)/2+$*(G-q)/2;if(Me===0&&be===0)return[];ue=Math.abs(ue),ge=Math.abs(ge);var me=Math.pow(Me,2)/Math.pow(ue,2)+Math.pow(be,2)/Math.pow(ge,2);me>1&&(ue*=Math.sqrt(me),ge*=Math.sqrt(me));var re=le(Te,G,ce,q,ue,ge,z,de,Be,$,Me,be),ke=N(re,4),Re=ke[0],Ye=ke[1],$e=ke[2],it=ke[3],Le=Math.abs(it)/(fe/4);Math.abs(1-Le)<1e-7&&(Le=1);var Ze=Math.max(Math.ceil(Le),1);it/=Ze;for(var ze=0;ze<Ze;ze++)oe.push(Q($e,it)),$e+=it;return oe.map(function(ve){var Pe=se(ve[0],ue,ge,$,Be,Re,Ye),ae=Pe.x,Ne=Pe.y,Ke=se(ve[1],ue,ge,$,Be,Re,Ye),Xe=Ke.x,Qe=Ke.y,he=se(ve[2],ue,ge,$,Be,Re,Ye),Ge=he.x,Ie=he.y;return{x1:ae,y1:Ne,x2:Xe,y2:Qe,x:Ge,y:Ie}})}}n(r)&&(r=!1),n(i)&&(i=!0);var C,d;function x(N){t.loop(N,function(p){var L=p.tagName.toLowerCase();if(L=="path"&&I(p),L=="circle"&&v("circle",p),L=="rect"&&v("rect",p),L=="ellipse"&&v("ellipse",p),L=="line"&&v("line",p),L=="polygon"&&v("polygon",p),L=="polyline"&&v("polyline",p),L=="g"){var we=p.getAttribute("style"),B,F,fe,se,Q;if(we){var te=P(we);B=te[0],F=te[1],fe=te[2],se=te[3],Q=te[4]}c=p.getAttribute("transform"),S=p.getAttribute("fill")?p.getAttribute("fill"):n(B)?j:B,R=p.getAttribute("stroke")?p.getAttribute("stroke"):n(F)?_:F,Z=p.getAttribute("stroke-width")?p.getAttribute("stroke-width"):n(fe)?U:fe,ne=p.getAttribute("fill-opacity")?p.getAttribute("fill-opacity"):n(se)?K:se,D=p.getAttribute("stroke-opacity")?p.getAttribute("stroke-opacity"):n(Q)?V:Q}x(p.children),p.tagName.toLowerCase()=="g"&&(S=j,R=_,Z=U,ne=K,D=V,c=null)})}function P(N){var p=N.split(";"),L,we,B,F,fe;return t.loop(p,function(se){se=se.replace(/,/g,"");var Q=se.split(":"),te=Q[0].trim().toLowerCase(),le=Q[1].trim().toLowerCase().replace("px","");te=="fill"&&(L=le),te=="stroke"&&(we=le),te=="stroke-width"&&(B=le),te=="opacity"&&(F=le,fe=le),te=="fill-opacity"&&(F=le),te=="stroke-opacity"&&(fe=le)}),[L,we,B,F,fe]}function v(N,p){var L,we=o(p),B=we[0],F=we[1],fe=we[2],se=we[5],Q=we[6];if(N=="circle"){var te=Number(p.getAttribute("r").trim()),le=te*.5523;i?L=new t.Circle(Number(p.getAttribute("r")),B,F,fe):L=new t.Blob(B,F,fe,4,te,le,"mirror",null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else if(N=="rect")if(i)L=new t.Rectangle(Number(p.getAttribute("width")),Number(p.getAttribute("height")),B,F,fe,Number(p.getAttribute("rx")));else{var Ae=Number(p.getAttribute("width")),J=Number(p.getAttribute("height")),Te=Number(p.getAttribute("rx")),G=Number(p.getAttribute("ry"));if(Te&&G){var ce=Te*.5523,q=G*.5523;L=new t.Blob(B,F,fe,[[Te,0,0,0,-ce,0,0,0,"free"],[Ae-Te,0,0,0,0,0,ce,0,"free"],[Ae,G,0,0,0,-q,0,0,"free"],[Ae,J-G,0,0,0,0,0,q,"free"],[Ae-Te,J,0,0,ce,0,0,0,"free"],[Te,J,0,0,0,0,-ce,0,"free"],[0,J-G,0,0,0,q,0,0,"free"],[0,G,0,0,0,0,0,-q,"free"]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else L=new t.Blob(B,F,fe,[[0,0],[Ae,0],[Ae,J],[0,J]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else if(N=="line")L=new t.Squiggle(F,fe,[[Number(p.getAttribute("x1")),Number(p.getAttribute("y1"))],[Number(p.getAttribute("x2")),Number(p.getAttribute("y2"))]],null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a);else if(N=="polygon"||N=="polyline"){var ue=p.getAttribute("points");ue=ue.replace(/-/g," -"),ue=ue.replace(/\s+/g," ");var ge=[];if(ue.indexOf(",")!=-1)t.loop(ue.split(" "),function(Se){var z=Se.split(",");ge.push([Number(z[0].trim()),Number(z[1].trim())])});else{var ie;t.loop(ue.split(" "),function(Se,z){(z+1)%2==0&&ge.push([ie,Se.trim()]),ie=Se.trim()})}N=="polygon"?L=new Blob(B,F,fe,ge):L=new t.Squiggle(F,fe,ge,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a)}else N=="ellipse"&&(L=new t.Blob(B,F,fe,b(0,0,Number(p.getAttribute("rx")),Number(p.getAttribute("ry"))),null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a));L.loc(se,Q,O);var xe=p.getAttribute("transform");(xe||c)&&w(L,xe||c),a&&(L.type=="Rectangle"||L.type=="Circle")&&L.transform({showReg:!1,visible:l})}function w(N,p){var L=p.split(")");t.loop(L,function(we){if(we!=""){var B=we.trim().split("("),F=B[0].trim().toLowerCase(),fe=B[1].trim().toLowerCase().replace("px","").replace("deg","");if(F=="translate"){var se=fe.split(",");N.mov(Number(se[0].trim()),se[1]?Number(se[1].trim()):0)}if(F=="scale"){var Q=fe.split(",");N.type=="Blob"||N.type=="Squiggle"?Q.length==1?N.transformPoints("scale",Number(Q[0].trim())):Q.length==2&&(N.transformPoints("scaleX",Number(Q[0].trim())),N.transformPoints("scaleY",Number(Q[1].trim()))):Q.length==1?N.sca(Number(Q[0].trim())):Q.length==2&&N.sca(Number(Q[0].trim()),Number(Q[1].trim()))}if(F=="rotate"){var te=fe.split(",");te.length==1?te.push(0,0):te.length==2&&te.push(0),N.rot(Number(te[0].trim()),Number(te[1].trim()),Number(te[2].trim()))}F=="skewX"&&(N.skewX=fe),F=="skewY"&&(N.skewY=fe)}})}function b(N,p,L,we){var B=.5522848,F=L*B,fe=we*B,se=N+L,Q=p+we,te=[[N-L,p,0,0,N,Q+fe-we,N,p-fe,"mirror"],[N,p-we,0,0,N-F,p,se+F-L,p,"mirror"],[se,p,0,0,N,p-fe,N+F-F,Q+fe-we,"mirror"],[N,Q,0,0,se-L+F,p,N-F,p,"mirror"]];return te}if(!n(e)){if(e.replace&&(e=e.replace(/style\s?=[^"]*"[^"]*"/ig,"")),n(e.draggable))e.getAttribute||(C=new DOMParser,e=C.parseFromString(e,"image/svg+xml").documentElement),d=this.svg=e;else{C=new DOMParser,e=e.innerHTML?C.parseFromString(e.innerHTML,"text/xml"):e;var X=e.getElementsByTagName("svg");d=this.svg=X?e.getElementsByTagName("svg")[0]:null}var Y,m;if(n(d)||(Y=d.getAttribute("width"),m=d.getAttribute("height")),Y&&(Y=Number(Y.trim())),m&&(m=Number(m.trim())),this.zimContainer_constructor(Y,m),this.type="SVGContainer",n(d))return;var j=t.black,S=t.black,_=t.black,R=t.black,U=2,Z=2,K=1,ne=1,V=1,D=1,c,h=e.getElementsByTagName("svg");h.length==0&&(h=[e]),x(h)}function o(N){var p,L,we,B,F,fe=N.getAttribute("style");if(fe){var se=P(fe);p=se[0],L=se[1],we=se[2],B=se[3],F=se[4]}p=N.getAttribute("fill")?N.getAttribute("fill"):n(p)?S:p,L=N.getAttribute("stroke")?N.getAttribute("stroke"):n(L)?R:L,we=N.getAttribute("stroke-width")?N.getAttribute("stroke-width"):n(we)?Z:we,B=N.getAttribute("fill-opacity")?N.getAttribute("fill-opacity"):n(B)?ne:B,F=N.getAttribute("stroke-opacity")?N.getAttribute("stroke-opacity"):n(F)?D:F;var Q=N.getAttribute("x")?N.getAttribute("x"):0;Q=N.getAttribute("cx")?N.getAttribute("cx"):Q;var te=N.getAttribute("y")?N.getAttribute("y"):0;return te=N.getAttribute("cy")?N.getAttribute("cy"):te,!n(B)&&!n(p)&&(p=t.convertColor(p,"rgba",Number(B))),!n(F)&&!n(L)&&(L=t.convertColor(L,"rgba",Number(F))),[p,L,Number(we),Number(B),Number(F),Number(Q),Number(te)]}function I(N,p){n(p)&&(p=!0);var L=["M","m","L","l","H","h","V","v","C","c","S","s","Q","q","T","t","A","a","z","Z"],we=["m","l","h","v","c","s","q","t","a","z"],B=new t.Point(0,0),F;if(n(N.getAttribute)?F=N:F=N.getAttribute("d"),F=F.replace(/,/g," "),F=F.replace(/([a-zA-Z])/g," $1 "),F=F.replace(/-/g," -"),F=F.replace(/\s+/g," "),F=F.replace(/\.(\d*)\./g,".$1 ."),p)var fe=o(N),se=fe[0],Q=fe[1],te=fe[2];var le,Ae,J=[],Te=[0,0],G=new t.Point(0,0),ce=new t.Point(0,0,0,0),q=new t.Point(0,0,0,0,0,0),ue=new t.Point(0,0,0,0,0,0,0),ge=F.split(" "),ie=ge.slice(1,ge.length),xe=[],Se=!1,z,pe,de=!1,oe,Be="squiggle",$=null;t.loop(ie,function(be,me){if(me==0&&(T.x=0,T.y=0,Te=[0,0],z="",pe=""),L.indexOf(be)==-1){oe=="lxo"&&(oe="lx",xe.push("l"),Se=!0),oe=="lyo"&&(oe="ly",Se=!0),oe=="Lxo"&&(oe="Lx",xe.push("L"),Se=!0),oe=="Lyo"&&(oe="Ly",Se=!0),Ae=Number(be),Ae=Math.round(Ae*100)/100,oe=="X"?(T.x=Ae,oe="Y"):oe=="Y"?(T.y=Ae,oe="Lxo",J.push([T.x,T.y])):oe=="x"?(T.x=T.x+Ae,oe="y"):oe=="y"&&(T.y=T.y+Ae,oe="lxo",J.push([T.x,T.y])),oe=="H"||oe=="h"?(B.x=J[J.length-1][0],B.y=J[J.length-1][1],B.x=B.x+(oe=="h"?Ae:Ae-T.x),J.push([B.x,B.y]),oe="Lx"):(oe=="V"||oe=="v")&&(B.x=J[J.length-1][0],B.y=J[J.length-1][1],B.y=B.y+(oe=="v"?Ae:Ae-T.y),J.push([B.x,B.y]),oe="lx"),oe=="Lx"?(G.x=Ae,oe="Ly"):oe=="Ly"?(G.y=Ae,B.x=G.x,B.y=G.y,J.push([B.x,B.y]),oe="Lx"):oe=="lx"?(xe.length>0&&(B.x!=0&&B.y!=0?(T.x=B.x,T.y=B.y):(T.x=B.x+T.x,T.y=B.y+T.y)),G.x=T.x+Ae,Se?oe="lyo":oe="ly"):oe=="ly"&&(G.y=T.y+Ae,B.x=G.x,B.y=G.y,J.push([B.x,B.y]),oe="lx");var re;if(oe=="qx"||oe=="Qx"?(J.length>0?(T.x=J[J.length-1][0],T.y=J[J.length-1][1]):(T.x=0,T.y=0),ce.x=oe=="qx"?T.x+Ae:Ae,oe=oe=="qx"?"qy":"Qy"):oe=="qy"||oe=="Qy"?(ce.y=oe=="qy"?T.y+Ae:Ae,oe=oe=="qy"?"qz":"Qz",de&&(de=!1,re=J[J.length-1],re[6]=-re[4],re[7]=-re[5],re[8]="mirror",B.x=ce.x,B.y=ce.y,J[J.length]=[B.x,B.y,0,0,-re[6],re[7],0,0,"free"],oe=oe=="qy"?"qx":"Qx")):oe=="qz"||oe=="Qz"?(ce.z=oe=="qz"?T.x+Ae:Ae,oe=oe=="qz"?"qq":"Qq"):(oe=="qq"||oe=="Qq")&&(ce.w=oe=="qq"?T.y+Ae:Ae,re=J[J.length-1],B.x=re[0],B.y=re[1],J.length==1?(re[2]=0,re[3]=0,re[4]=0,re[5]=0,re[6]=2/3*(ce.x-B.x),re[7]=2/3*(ce.y-B.y),re[8]="free"):J[J.length]=[B.x,B.y,0,0,0,0,2/3*(ce.x-B.x),2/3*(ce.y-B.y),"free"],B.x=ce.z,B.y=ce.w,J[J.length]=[B.x,B.y,0,0,2/3*(ce.x-B.x),2/3*(ce.y-B.y),0,0,"free"],oe=oe=="qq"?"qx":"Qx"),oe=="cx"||oe=="Cx")J.length>0?(T.x=J[J.length-1][0],T.y=J[J.length-1][1]):(T.x=0,T.y=0),q.x=oe=="cx"?T.x+Ae:Ae,oe=oe=="cx"?"cy":"Cy";else if(oe=="cy"||oe=="Cy")q.y=oe=="cy"?T.y+Ae:Ae,oe=oe=="cy"?"cz":"Cz";else if(oe=="cz"||oe=="Cz")q.z=oe=="cz"?T.x+Ae:Ae,oe=oe=="cz"?"cq":"Cq";else if(oe=="cq"||oe=="Cq")q.q=oe=="cq"?T.y+Ae:Ae,oe=oe=="cq"?"cr":"Cr",de&&(z=="s"?pe="s":pe="S",re=J[J.length-1],re[2]=0,re[3]=0,n(re[4])&&(re[4]=0),n(re[5])&&(re[5]=0),re[6]=-re[4],re[7]=-re[5],re[8]="mirror",B.x=q.z,B.y=q.q,J[J.length]=[B.x,B.y,0,0,q.x-B.x,q.y-B.y,0,0,"free"],oe=oe=="cr"?"cx":"Cx");else if(oe=="cr"||oe=="Cr")q.r=oe=="cr"?T.x+Ae:Ae,oe=oe=="cr"?"cs":"Cs";else if(oe=="cs"||oe=="Cs")q.s=oe=="cs"?T.y+Ae:Ae,re=J[J.length-1],J.length==1&&(re[2]=0,re[3]=0,re[4]=0,re[5]=0),re[6]=q.x-re[0],re[7]=q.y-re[1],re[8]="free",B.x=q.r,B.y=q.s,J[J.length]=[B.x,B.y,0,0,q.z-B.x,q.q-B.y,0,0,"free"],oe=oe=="cs"?"cx":"Cx";else if(oe=="ax"||oe=="Ax")J.length>0?(T.x=J[J.length-1][0],T.y=J[J.length-1][1]):(T.x=0,T.y=0),ue.x=Ae,oe=oe=="ax"?"ay":"Ay";else if(oe=="ay"||oe=="Ay")ue.y=Ae,oe=oe=="ay"?"az":"Az";else if(oe=="az"||oe=="Az")ue.z=Ae,oe=oe=="az"?"aq":"Aq";else if(oe=="aq"||oe=="Aq")ue.q=Ae,oe=oe=="aq"?"ar":"Ar";else if(oe=="ar"||oe=="Ar")ue.r=Ae,oe=oe=="ar"?"as":"As";else if(oe=="as"||oe=="As")ue.s=oe=="as"?T.x+Ae:Ae,oe=oe=="as"?"at":"At";else if(oe=="at"||oe=="At"){ue.t=oe=="at"?T.y+Ae:Ae,E||(E=A());var ke=E({px:T.x,py:T.y,cx:ue.s,cy:ue.t,rx:ue.x,ry:ue.y,xAxisRotation:ue.z,largeArcFlag:ue.q,sweepFlag:ue.r});t.loop(ke,function(Re,Ye){re=J[J.length-1],J.length==1&&(re[2]=0,re[3]=0,re[4]=0,re[5]=0),Ye==0&&J.length==1?(re[6]=Re.x1-B.x-T.x,re[7]=Re.y1-B.y-T.y):(re[6]=Re.x1-B.x,re[7]=Re.y1-B.y),re[8]="free",B.x=Re.x,B.y=Re.y,J[J.length]=[B.x,B.y,0,0,Re.x2-B.x,Re.y2-B.y,0,0,"free"]}),oe=oe=="at"?"ax":"Ax"}}else xe.push(be),be!="s"&&(de=!1),xe.length>1&&(be=="M"||be=="m")&&(Me(xe),be=="M"?(T.x=0,T.y=0):(T.x=J[J.length-1][0],T.y=J[J.length-1][1]),J=[],xe=[],xe.push(be)),be=="M"?oe="X":be=="m"?oe="x":be=="L"?(oe="Lx",r&&$&&$!="l"&&Me(xe),$="l"):be=="l"?(oe="lx",r&&$&&$!="l"&&Me(xe),$="l"):be=="H"?(oe="H",r&&$&&$!="l"&&Me(xe),$="l"):be=="h"?(oe="h",r&&$&&$!="l"&&Me(xe),$="l"):be=="V"?(oe="V",r&&$&&$!="l"&&Me(xe),$="l"):be=="v"?(oe="v",r&&$&&$!="l"&&Me(xe),$="l"):be=="C"?(oe="Cx",r&&$&&$!="c"&&Me(xe),$="c"):be=="c"?(oe="cx",r&&$&&$!="c"&&Me(xe),$="c"):be=="S"?(de=!0,oe="Cx",r&&$&&$!="c"&&Me(xe),$="c"):be=="s"?(de=!0,oe="cx",r&&$&&$!="c"&&Me(xe),$="c"):be=="Q"?(oe="Qx",r&&$&&$!="q"&&Me(xe),$="q"):be=="q"?(oe="qx",r&&$&&$!="q"&&Me(xe),$="q"):be=="T"?(de=!0,oe="Qx",r&&$&&$!="q"&&Me(xe),$="q"):be=="t"?(de=!0,oe="qx",r&&$&&$!="q"&&Me(xe),$="q"):be=="A"?(oe="Ax",r&&$&&$!="a"&&Me(),$="a"):be=="a"?(oe="ax",r&&$&&$!="a"&&Me(),$="a"):(be=="z"||be=="Z")&&(Be="blob")});function Me(){z=xe[xe.length-1],J.length>=2&&(z=="z"||z=="Z")&&(Be="blob"),Be=="squiggle"?le=new t.Squiggle(Q,te,J,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a):le=new t.Blob(se,Q,te,J,null,null,null,null,l,null,null,null,null,null,null,null,null,null,null,null,null,null,a),le.loc(0,0,O),z=xe[xe.length-1],pe=xe[xe.length-2],we.indexOf(z)>=0?(Te[0]=J[J.length-1][0],Te[1]=J[J.length-1][1],T.x=J[J.length-1][0],T.y=J[J.length-1][1],J=[],J.push([Te[0],Te[1]])):(Te=[0,0],J=[[0,0]]),xe=[],z!="z"&&z!="Z"&&xe.push(z),B.x=0,B.y=0;var be=N.getAttribute("transform");(be||c)&&w(le,be||c)}return p&&Me(),J}O.processPath=function(N){return I(N,!1)},s!==!1&&t.styleTransforms(this,g),this.clone=function(){return O.cloneProps(new t.SVGContainer(e,r,i,l,a,s,this.group,u))}},t.extend(t.SVGContainer,t.Container,"clone","zimContainer",!1),t.CustomShape=function(e,r,i,l){t.zimCustomShapeCheck||(De("50.97"),t.zimCustomShapeCheck=!0),this.zimContainer_constructor(e,r,i,l,!1);var a=this;this.mouseChildren=!1,a._dashedOffset=5,Object.defineProperty(a,"color",{get:function(){return a._color},set:function(s){n(s)&&(s="black"),a._color=s,s&&s.type?a.specialColor(a.colorCommand,s,a):a.colorCommand.style=s}}),this.setColorRange=function(s,f){return n(f)?(a.startColor=a.color,a.endColor=s):n(s)?(a.startColor=a.color,a.endColor=f):(a.startColor=s,a.endColor=f),a},a._colorRange=0,Object.defineProperty(a,"colorRange",{get:function(){return a._colorRange},set:function(s){a._colorRange=s,!n(a.startColor)&&!n(a.endColor)&&(a.color=t.colorRange(a.startColor,a.endColor,s))}}),Object.defineProperty(a,"borderColor",{get:function(){return a._borderColor},set:function(s){a._borderColor=s,s&&!a.borderWidth&&(a.borderWidth=1),a.borderColorCommand?s&&s.type?a.specialColor(a.borderColorCommand,s,a):a.borderColorCommand.style=s:a.drawShape()}}),Object.defineProperty(a,"borderWidth",{get:function(){return a._borderWidth},set:function(s){s>0||(s=0),a._borderWidth=s,!a.borderWidthCommand||a._borderWidth==0?(a.borderWidthCommand=null,a.drawShape()):(a.borderWidthCommand.width=a._borderWidth,a._dashed&&(a.borderDashedCommand.segments=a._dashed,a.borderDashedCommand.offset=a._dashedOffset))}}),Object.defineProperty(a,"thickness",{get:function(){return a._thickness},set:function(s){s>0||(s=0),a._thickness=s,!a.thicknessCommand||a._thickness==0?a.drawShape():(a.thicknessCommand.width=a._thickness,a._dashed&&(a.dashedCommand.segments=a._dashed,a.dashedCommand.offset=a._dashedOffset))}}),Object.defineProperty(a,"dashed",{get:function(){return a._dashed},set:function(s){a._dashed=s,s&&!Array.isArray(a._dashed)&&(a.dashed=[10,10]);var f;if(a.type=="Squiggle"||a.type=="Line"){if(!a.thicknessCommand||a._thickness==0)return;f=a.dashedCommand}else{if(!a.borderWidthCommand||a._borderWidth==0)return;f=a.borderDashedCommand}f?a._dashed?(f.segments=a._dashed,f.offset=a._dashedOffset):(f.segments=null,f.offset=null):a.drawShape()}}),Object.defineProperty(a,"dashedOffset",{get:function(){return a._dashedOffset},set:function(s){isNaN(s)&&(s=5),a._dashedOffset=s;var f;if(a.type=="Squiggle"||a.type=="Line"){if(!a.thicknessCommand||a._thickness==0)return;f=a.dashedCommand}else{if(!a.borderWidthCommand||a._borderWidth==0)return;f=a.borderDashedCommand}f?a._dashed?(f.segments=a._dashed,f.offset=a._dashedOffset):(f.segments=null,f.offset=null):a.drawShape()}}),Object.defineProperty(a,"corner",{get:function(){return a._corner},set:function(s){a._corner=s,a.drawShape()}}),this.linearGradient=function(s,f,u,y,k,g){return this.linearGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.linearGradient(s,f,u,y,k,g),this},this.radialGradient=function(s,f,u,y,k,g,O,T){return this.radialGradientParams=Array.prototype.slice.call(arguments),this.colorCommand.radialGradient(s,f,u,y,k,g,O,T),this},this.cloneAll=function(s,f,u,y){var k=this.getBounds();n(k)&&(k={x:null,y:null,width:null,height:null});var g=this.cloneChildren(this.cloneProps(new t.Container(k.x,k.y,k.width,k.height,f,u,y)),s);return g.mouseChildren=!1,g.type=this.type,g}},t.extend(t.CustomShape,t.Container,null,"zimContainer",!1),t.Circle=function(e,r,i,l,a,s,f,u,y,k,g){var O="radius, color, borderColor, borderWidth, dashed, percent, percentClose, strokeObj, style, group, inherit",T;if(T=st(t.Circle,arguments,O,this))return T;De("51"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Circle",this.group=k;var E=y===!1?{}:t.getStyle(this.type,this.group,g);n(e)&&(e=E.radius!=null?E.radius:50),n(a)&&(a=E.dashed!=null?E.dashed:!1),n(i)&&(i=E.borderColor!=null?E.borderColor:null),n(l)&&(l=E.borderWidth!=null?E.borderWidth:null),i<0||l<0?i=l=null:i!=null&&l==null&&(l=1),n(r)&&(r=E.color!=null?E.color:l>0?"rgba(0,0,0,0)":t.black),n(s)&&(s=E.percent!=null?E.percent:100),n(f)&&(f=E.percentClose!=null?E.percentClose:!0),n(u)&&(u=E.strokeObj!=null?E.strokeObj:{});var A=C(e,r,i,l,s);this.veeObj={radius:A[0],color:A[1],borderColor:A[2],borderWidth:A[3],percent:A[4]};function C(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),s=t.Pick.choose(s);var d=this;d._radius=e,d._color=r,d._borderColor=i,d._borderWidth=l,d._dashed=a,d._dashed&&!Array.isArray(d._dashed)&&(d._dashed=[10,10]);var x=this.shape=new Fe.Shape;this.addChild(x);var P=x.graphics;d.drawShape=function(){P.c(),d.colorCommand=P.f(d._color).command,d._color&&d._color.type&&d.specialColor(d.colorCommand,d._color,d),(n(d._borderWidth)||d._borderWidth>0)&&(!n(d._borderColor)||!n(d._borderWidth))&&(n(d._borderColor)&&(d._borderColor=t.black),d.borderColorCommand=P.s(d._borderColor).command,d._borderColor&&d._borderColor.type&&d.specialColor(d.borderColorCommand,d._borderColor,d),d.borderWidthCommand=P.ss(d._borderWidth,u.caps,u.joints,u.miterLimit,u.ignoreScale).command,d._dashed&&(d.borderDashedCommand=P.sd(Array.isArray(d._dashed)?d._dashed:[10,10],d._dashedOffset).command));var v=d._radius*2;if(typeof s=="number"&&s>=0&&s<100){var w=360*s/100/2;P.arc(0,0,d._radius,(-w-90)*Math.PI/180,(w-90)*Math.PI/180,!1),f&&P.cp(),v=d._radius-Math.cos(w*Math.PI/180)*d._radius}else P.dc(0,0,d._radius);d.setBounds(-d._radius,-d._radius,d._radius*2,v)},d.drawShape(),r.type&&(d.color=r),Object.defineProperty(d,"radius",{get:function(){return d._radius},set:function(v){d._radius=v,d.drawShape()}}),Object.defineProperty(d,"percentage",{get:function(){return s},set:function(v){s=v,d.drawShape()}}),Object.defineProperty(d,"percentClose",{get:function(){return f},set:function(v){f=v,d.drawShape()}}),y!==!1&&t.styleTransforms(this,E),this.clone=function(v){var w=d.cloneProps(new t.Circle(v||!t.isPick(A[0])?d.radius:A[0],v||!t.isPick(A[1])?d.color:A[1],v||!t.isPick(A[2])?d.borderColor:A[2],v||!t.isPick(A[3])?d.borderWidth:A[3],d.dashed,v||!t.isPick(A[4])?s:A[4],f,u,y,this.group,g));return d.linearGradientParams&&w.linearGradient.apply(w,d.linearGradientParams),d.radialGradientParams&&w.radialGradient.apply(w,d.radialGradientParams),w}},t.extend(t.Circle,t.CustomShape,"clone","zimCustomShape",!1),t.Rectangle=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="width, height, color, borderColor, borderWidth, corner, dashed, strokeObj, scaleDimensions, style, group, inherit",E;if(E=st(t.Rectangle,arguments,T,this))return E;De("52"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Rectangle",this.group=g;var A=k===!1?g!=null?t.getStyle(null,null,O,this.group):{}:t.getStyle(this.type,this.group,O);n(e)&&(e=A.width!=null?A.width:null),n(r)&&(r=A.height!=null?A.height:n(e)?100:e),n(e)&&(e=r),n(s)&&(s=A.corner!=null?A.corner:0),n(f)&&(f=A.dashed!=null?A.dashed:!1),n(l)&&(l=A.borderColor!=null?A.borderColor:null),n(a)&&(a=A.borderWidth!=null?A.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(i)&&(i=A.color!=null?A.color:a>0?"rgba(0,0,0,0)":t.black),n(u)&&(u=A.strokeObj!=null?A.strokeObj:{}),n(y)&&(y=A.scaleDimensions!=null?A.scaleDimensions:!0);var C=d(e,r,i,l,a);this.veeObj={width:C[0],height:C[1],color:C[2],borderColor:C[3],borderWidth:C[4]};function d(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),a=t.Pick.choose(a);var x=this;x._color=i,x._borderColor=l,x._borderWidth=a,x._dashed=f,x._dashed&&!Array.isArray(x._dashed)&&(x._dashed=[10,10]),x._corner=s,x.scaleDimensions=y,x.setWidth=function(w){e=w},x.setHeight=function(w){r=w};var P=this.shape=new Fe.Shape;this.addChild(P);var v=P.graphics;x.drawShape=function(){if(v.c(),x.colorCommand=v.f(x._color).command,i&&i.type&&x.specialColor(x.colorCommand,i,x),(n(x._borderWidth)||x._borderWidth>0)&&(!n(x._borderColor)||!n(x._borderWidth))&&(n(x._borderColor)&&(x._borderColor=t.black),x.borderColorCommand=v.s(x._borderColor).command,x._borderColor&&x._borderColor.type&&x.specialColor(x.borderColorCommand,x._borderColor,x),x.borderWidthCommand=v.ss(x._borderWidth,u.caps,u.joints,u.miterLimit,u.ignoreScale).command,x._dashed&&(x.borderDashedCommand=v.sd(Array.isArray(x._dashed)?x._dashed:[10,10],x._dashedOffset).command)),Array.isArray(x._corner)){var w=x._corner;Array.isArray(w)&&w.length==2&&(w=[w,w,w,w]);for(var b=[],X=!1,Y=0;Y<w.length;Y++)Array.isArray(w[Y])?(X=!0,b.push(w[Y])):b.push([w[Y],w[Y]]);w=b,X?v.mt(0,w[0][1]).curveTo(0,0,w[0][0],0).lt(e-w[1][0],0).curveTo(e,0,e,w[1][1]).lt(e,r-w[2][1]).curveTo(e,r,e-w[2][0],r).lt(w[3][0],r).curveTo(0,r,0,r-w[3][1]).cp():v.rc(0,0,e,r,x._corner[0],x._corner[1],x._corner[2],x._corner[3])}else x._corner>0?v.rr(0,0,e,r,x._corner):v.r(0,0,e,r);x.setBounds(0,0,e,r),i.type&&(x.color=i)},x.drawShape(),(k!==!1||g!=null)&&t.styleTransforms(this,A),this.clone=function(w,b){var X=n(b)?k:b,Y=x.cloneProps(new t.Rectangle(w||!t.isPick(C[0])?e:C[0],w||!t.isPick(C[1])?r:C[1],w||!t.isPick(C[2])?x.color:C[2],w||!t.isPick(C[3])?x.borderColor:C[3],w||!t.isPick(C[4])?x.borderWidth:C[4],s,x._dashed,u,x.scaleDimensions,X,this.group,O));return Y}},t.extend(t.Rectangle,t.CustomShape,"clone","zimCustomShape",!1),t.Triangle=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E){var A="a, b, c, color, borderColor, borderWidth, corner, center, adjust, dashed, strokeObj, style, group, inherit",C;if(C=st(t.Triangle,arguments,A,this))return C;De("53"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Triangle",this.group=T;var d=O===!1?{}:t.getStyle(this.type,this.group,E);n(e)&&(e=d.a!=null?d.a:100),n(r)&&(r=d.b!=null?d.b:e),n(i)&&(i=d.c!=null?d.c:e),r==-1&&(r=Math.sqrt(Math.pow(e,2)+Math.pow(i,2))),i==-1&&(i=Math.sqrt(Math.pow(e,2)+Math.pow(r,2))),n(f)&&(f=d.corner!=null?d.corner:0),n(u)&&(u=d.center!=null?d.center:!0),n(y)&&(y=d.adjust!=null?d.adjust:0),n(a)&&(a=d.borderColor!=null?d.borderColor:null),n(s)&&(s=d.borderWidth!=null?d.borderWidth:null),a<0||s<0?a=s=null:a!=null&&s==null&&(s=1),n(l)&&(l=d.color!=null?d.color:s>0?"rgba(0,0,0,0)":t.black),n(y)&&(y=d.adjust!=null?d.adjust:0),n(g)&&(g=d.strokeObj!=null?d.strokeObj:{});var x=P(e,r,i,l,a,s);this.veeObj={a:x[0],b:x[1],c:x[2],color:x[3],borderColor:x[4],borderWidth:x[5]};function P(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),this.a=e,this.b=r,this.c=i,l=t.Pick.choose(l),a=t.Pick.choose(a),s=t.Pick.choose(s);var v=this;v._color=l,v._borderColor=a,v._borderWidth=s,v._dashed=k,v._dashed&&!Array.isArray(v._dashed)&&(v._dashed=[10,10]),v._corner=f;var w=[e,r,i];w.sort(function(_,R){return R-_});var b=w[0],X=w[1],Y=w[2],m=[w.indexOf(e),w.indexOf(r),w.indexOf(i)];if(b>X+Y){tt("zim display - Triangle(): invalid triangle lengths");return}var j=this.shape=new Fe.Shape;this.adjusted=y,this.addChild(j);var S=j.graphics;v.drawShape=function(){var _=[];Array.isArray(v._corner)?_=v._corner:_.push(v._corner,v._corner,v._corner);for(var R=0;R<3;R++)(_[R]<0||typeof _[R]!="number")&&(_[R]=0);S.c(),v.colorCommand=S.f(v._color).command,v._color&&v._color.type&&v.specialColor(v.colorCommand,v._color,v),(n(v._borderWidth)||v._borderWidth>0)&&(!n(v._borderColor)||!n(v._borderWidth))&&(n(v._borderColor)&&(v._borderColor=t.black),v.borderColorCommand=S.s(v._borderColor).command,v._borderColor&&v._borderColor.type&&v.specialColor(v.borderColorCommand,v._borderColor,v),v.borderWidthCommand=S.ss(v._borderWidth,g.caps,g.joints,g.miterLimit,g.ignoreScale).command,v._dashed&&(v.borderDashedCommand=S.sd(Array.isArray(v._dashed)?v._dashed:[10,10],v._dashedOffset).command)),v.one={x:0,y:0},v.two={x:e,y:0};var U=Math.acos((Math.pow(X,2)+Math.pow(Y,2)-Math.pow(b,2))/(2*X*Y))*180/Math.PI,Z=Math.asin(X*Math.sin(U*Math.PI/180)/b)*180/Math.PI,K=180-U-Z,ne=[U,Z,K];v.angles=[ne[m[1]],ne[m[2]],ne[m[0]]];var V=v.angles[1],D=Math.cos(V*Math.PI/180)*r,c=Math.sin(V*Math.PI/180)*r,h=Math.max(e,e-D),o=c;v.setBounds(0,y,h,o),j.y=o,v.three={x:e-D,y:0-c};var I=e*_[0]/(_[0]+_[1]||1);S.mt(I,0).at(e,0,e-D,0-c,_[1]).at(e-D,0-c,0,0,_[2]).at(0,0,e,0,_[0]).lt(I,0),S.cp(),u&&(v.regX=h/2,v.regY=o/2),y&&(v.shape.y+=y)},v.drawShape(),l.type&&(v.color=l),O!==!1&&t.styleTransforms(this,d),this.clone=function(_,R){var U=n(R)?O:R,Z=v.cloneProps(new t.Triangle(_||!t.isPick(x[0])?e:x[0],_||!t.isPick(x[1])?r:x[1],_||!t.isPick(x[2])?i:x[2],_||!t.isPick(x[3])?v.color:x[3],_||!t.isPick(x[4])?v.borderColor:x[4],_||!t.isPick(x[5])?v.borderWidth:x[5],f,u,y,k,g,U,this.group,E));return v.linearGradientParams&&Z.linearGradient.apply(Z,v.linearGradientParams),v.radialGradientParams&&Z.radialGradient.apply(Z,v.radialGradientParams),Z}},t.extend(t.Triangle,t.CustomShape,"clone","zimCustomShape"),t.Poly=function(e,r,i,l,a,s,f,u,y,k,g){var O="radius, sides, pointSize, color, borderColor, borderWidth, dashed, strokeObj, style, group, inherit",T;if(T=st(t.Poly,arguments,O,this))return T;De("53.1"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Poly",this.group=k;var E=y===!1?{}:t.getStyle(this.type,this.group,g);n(e)&&(e=E.radius!=null?E.radius:50),n(r)&&(r=E.sides!=null?E.sides:5),n(i)&&(i=E.pointSize!=null?E.pointSize:0),n(f)&&(f=E.dashed!=null?E.dashed:!1),n(a)&&(a=E.borderColor!=null?E.borderColor:null),n(s)&&(s=E.borderWidth!=null?E.borderWidth:null),a<0||s<0?a=s=null:a!=null&&s==null&&(s=1),n(l)&&(l=E.color!=null?E.color:s>0?"rgba(0,0,0,0)":t.black),n(u)&&(u=E.strokeObj!=null?E.strokeObj:{});var A=C(e,r,i,l,a,s);this.veeObj={radius:A[0],sides:A[1],pointSize:A[2],color:A[3],borderColor:A[4],borderWidth:A[5]};function C(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),a=t.Pick.choose(a),s=t.Pick.choose(s);var d=this;d._radius=e,d._color=l,d._sides=r,d._pointSize=i,d._borderColor=a,d._borderWidth=s,d._dashed=f,d._dashed&&!Array.isArray(d._dashed)&&(d._dashed=[10,10]);var x=this.shape=new Fe.Shape;this.addChild(x),x.rotation=-90;var P=x.graphics;d.drawShape=function(){P.c(),d.colorCommand=P.f(d._color).command,d._color&&d._color.type&&d.specialColor(d.colorCommand,d._color,d),(n(d._borderWidth)||d._borderWidth>0)&&(!n(d._borderColor)||!n(d._borderWidth))&&(n(d._borderColor)&&(d._borderColor=t.black),d.borderColorCommand=P.s(d._borderColor).command,d._borderColor&&d._borderColor.type&&d.specialColor(d.borderColorCommand,d._borderColor,d),d.borderWidthCommand=P.ss(d._borderWidth,u.caps,u.joints,u.miterLimit,u.ignoreScale).command,d._dashed&&(d.borderDashedCommand=P.sd(Array.isArray(d._dashed)?d._dashed:[10,10],d._dashedOffset).command)),P.dp(0,0,d._radius,d._sides,d._pointSize),d.setBounds(-d._radius,-d._radius,d._radius*2,d._radius*2)},d.drawShape(),l.type&&(d.color=l),Object.defineProperty(d,"radius",{get:function(){return d._radius},set:function(v){d._radius=v,d.drawShape()}}),Object.defineProperty(d,"sides",{get:function(){return d._sides},set:function(v){d._sides=v,d.drawShape()}}),Object.defineProperty(d,"pointSize",{get:function(){return d._pointSize},set:function(v){d._pointSize=v,d.drawShape()}}),y!==!1&&t.styleTransforms(this,E),this.clone=function(v){var w=d.cloneProps(new t.Poly(v||!t.isPick(A[0])?d.radius:A[0],v||!t.isPick(A[1])?d.sides:A[1],v||!t.isPick(A[2])?d.pointSize:A[2],v||!t.isPick(A[3])?d.color:A[3],v||!t.isPick(A[4])?d.borderColor:A[4],v||!t.isPick(A[5])?d.borderWidth:A[5],d.dashed,u,y,this.group,g));return d.linearGradientParams&&w.linearGradient.apply(w,d.linearGradientParams),d.radialGradientParams&&w.radialGradient.apply(w,d.radialGradientParams),w}},t.extend(t.Poly,t.CustomShape,"clone","zimCustomShape",!1),t.Line=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A){var C="length, thickness, color, startHead, endHead, dashed, strokeObj, lineType, lineOrientation, curveH, curveV, points, style, group, inherit",d;if(d=st(t.Line,arguments,C,this))return d;De("53.15"),this.zimCustomShape_constructor(null,null,null,null,!1),this.type="Line",this.group=E;var x=T===!1?{}:t.getStyle(this.type,this.group,A);n(e)&&(e=x.length!=null?x.length:100),n(s)&&(s=x.dashed!=null?x.dashed:!1),n(r)&&(r=x.thickness!=null?x.thickness:3),n(i)&&(i=x.color!=null?x.color:t.black),n(l)&&(l=x.startHead!=null?x.startHead:null),n(a)&&(a=x.endHead!=null?x.endHead:null),n(f)&&(f=x.strokeObj!=null?x.strokeObj:{}),n(u)&&(u=x.lineType!=null?x.lineType:"straight"),u!=="corner"&&u!="curve"&&(u="straight"),n(y)&&(y=x.lineOrientation!=null?x.lineOrientation:"auto"),y!=="vertical"&&y!="horizontal"&&(y="auto"),n(k)&&(k=x.curveH!=null?x.curveH:20),n(g)&&(g=x.curveV!=null?x.curveV:20),n(f)&&(f=x.strokeObj!=null?x.strokeObj:{});var P=v(e,i,r,l,a);this.veeObj={length:P[0],color:P[1],thickness:P[2],startHead:P[3],endHead:P[4]};function v(){return arguments}e=t.Pick.choose(e),i=t.Pick.choose(i),r=t.Pick.choose(r),l=t.Pick.choose(l),a=t.Pick.choose(a),l&&l.clone&&(l=l.clone()),a&&a.clone&&(a=a.clone());var w=this;w._length=e,w._color=i,w._thickness=r,w._dashed=s,w._dashed&&!Array.isArray(w._dashed)&&(w._dashed=[10,10]),w._startX=0,w._startY=0,w._endX=e,w._endY=0,w._startHead=l,w._endHead=a,w._points=O,w._lineOrientation=y,w.angle=0,w.lineType=u,w._startHead&&b("start",w._startHead),w._endHead&&b("end",w._endHead);function b(m,j){if(j=="triangle"||j=="arrow"){var S=w["_"+m+"Head"]=new t.Triangle(r*4,r*4,r*4,i);S.rotation=90}else j=="circle"&&(w["_"+m+"Head"]=new t.Circle(r*2.2,i));n(w["_"+m+"Head"].startAngle)&&(w["_"+m+"Head"].startAngle=w["_"+m+"Head"].rotation)}l=w._startHead,a=w._endHead,l&&l.type=="Triangle"&&(l.startRegY=l.regY),a&&a.type=="Triangle"&&(a.startRegY=a.regY);var X=this.shape=new Fe.Shape;this.addChild(X);var Y=X.graphics;w.drawShape=function(m,j){Y.c(),w.colorCommand=Y.s(w._color).command,i&&i.type&&w.specialColor(w.colorCommand,i,w),w.thicknessCommand=Y.ss(w._thickness,f.caps,f.joints,f.miterLimit,f.ignoreScale).command,w._dashed&&(w.dashedCommand=Y.sd(Array.isArray(w._dashed)?w._dashed:[10,10],w._dashedOffset).command);var S,_;if(w._points){var R=w._points[0];w._startX=R[0],w._startY=R[1];var U=w._points[w._points.length-1],Z=[U[U.length-2],U[U.length-1]];w._endX=Z[0],w._endY=Z[1],Y.mt(R[0],R[1]);for(var K=1;K<w._points.length;K++){var ne=w._points[K];K==1&&(S=[w._startX,w._startY,ne[0],ne[1]]),ne.length==2?Y.lt(ne[0],ne[1]):ne.length==4?Y.qt(ne[0],ne[1],ne[2],ne[3]):ne.length==6&&Y.bt(ne[0],ne[1],ne[2],ne[3],ne[4],ne[5])}if(ne.length>=4)_=[ne[ne.length-4],ne[ne.length-3],w._endX,w._endY];else{var V=w._points[w._points.length-2];_=[V[V.lenth-2],V[V.lenth-1],w._endX,w._endY]}}else{var D=w._startX,c=w._startY,h=w._endX,o=w._endY,I;if(w.lineType=="straight"?(l&&l.type=="Triangle"&&(l.regY=0,I=t.dist(D,c,h,o),I!=0&&(D=D+w._startHead.height/2*(h-D)/I),I!=0&&(c=c+w._startHead.height/2*(o-c)/I)),a&&a.type=="Triangle"&&(a.regY=0,I=t.dist(D,c,h,o),I!=0&&(h=h-w._endHead.height/2*(h-D)/I),I!=0&&(o=o-w._endHead.height/2*(o-c)/I))):(m?w._lineOrientation=="horizontal"||w.autoOrientation=="horizontal"?l&&l.type=="Triangle"&&(l.regY=0,h>D?D=Math.min(h,D+w._startHead.height/2):D=Math.max(h,D-w._startHead.height/2)):l&&l.type=="Triangle"&&(l.regY=0,o>c?c=Math.min(o,c+w._startHead.height/2):c=Math.max(o,c-w._startHead.height/2)):l&&l.type=="Triangle"&&(l.regY=l.startRegY),j?w._lineOrientation=="horizontal"||w.autoOrientation=="horizontal"?a&&a.type=="Triangle"&&(a.regY=0,h>D?h-=w._endHead.height/2:h+=w._endHead.height/2):a&&a.type=="Triangle"&&(a.regY=0,o>c?o-=w._endHead.height/2:o+=w._endHead.height/2):a&&a.type=="Triangle"&&(a.regY=a.startRegY)),w.lineType=="straight")Y.mt(D,c).lt(h,o),S=_=[D,c,h,o];else if(w.lineType=="corner"){var N=D+(h-D)*.4,p=c+(o-c)*.4;w._lineOrientation=="auto"&&(w.autoOrientation=Math.abs(D-h)>Math.abs(c-o)?"horizontal":"vertical"),w._lineOrientation=="horizontal"||w.autoOrientation=="horizontal"?(S=_=[D,c,N,c],Y.mt(D,c).lt(N,c).lt(N,o).lt(h,o)):(S=_=[D,c,D,p],Y.mt(D,c).lt(D,p).lt(h,p).lt(h,o))}else{var L=D>h?-1:1,we=c>o?-1:1,B=D,F=c,fe=Math.abs(D-h),se=Math.abs(c-o),Q=Math.min(k,fe*.5),te=Math.min(g,se*.5);w._lineOrientation=="auto"&&(w.autoOrientation=Math.abs(D-h)>Math.abs(c-o)?"horizontal":"vertical");var le,Ae,J,Te;w._lineOrientation=="horizontal"||w.autoOrientation=="horizontal"?(le=se-te*2,Ae=(fe-Q*2)/2,Y.mt(B,F),Ae>0&&(B=B+Ae*L,Y.lt(B,F)),Te=F,F=F+te*we,B=B+Q*L,Y.qt(B,Te,B,F),S=_=[D,c,B,c],le>0&&(F=F+le*we,Y.lt(B,F)),F=F+te*we,J=B,B=B+Q*L,Y.qt(J,F,B,F),Ae>0&&(B=B+Ae*L,Y.lt(B,F))):(le=fe-Q*2,Ae=(se-te*2)/2,Y.mt(B,F),Ae>0&&(F=F+Ae*we,Y.lt(B,F)),J=B,B=B+Q*L,F=F+te*we,Y.qt(J,F,B,F),S=_=[D,c,D,F],le>0&&(B=B+le*L,Y.lt(B,F)),B=B+Q*L,Te=F,F=F+te*we,Y.qt(B,Te,B,F),Ae>0&&(F=F+Ae*we,Y.lt(B,F)))}}if(w.setBounds(Math.min(w._startX,w._endX),Math.min(w._startY,w._endY),Math.abs(w._startX-w._endX),Math.abs(w._startY-w._endY)),w._length=Math.sqrt(Math.pow(w._startX-w._endX,2)+Math.pow(w._startY-w._endY,2)),w.angle=Math.atan2(w._endY-w._startY,w._endX-w._startX)*180/Math.PI,w._startHead&&w._startHead.loc){w._startHead.loc(w._startX,w._startY,w);var G=Math.atan2(S[3]-S[1],S[2]-S[0])*180/Math.PI;w._startHead.rotation=G-180+w._startHead.startAngle}if(w._endHead&&w._endHead.loc){w._endHead.loc(w._endX,w._endY,w);var ce=Math.atan2(_[3]-_[1],_[2]-_[0])*180/Math.PI;w._endHead.rotation=ce+w._endHead.startAngle}},w.drawShape(),i.type&&(w.color=i),this.setPoints=function(m,j,S,_,R,U){return Array.isArray(m)&&n(j)?(w.points=m,w):(m&&!n(m.x)?(w._startX=n(m.x)?w._startX:m.x,w._startY=n(m.y)?w._startY:m.y,j&&(w._endX=n(j.x)?w._endX:j.x,w._endY=n(j.y)?w._endY:j.y)):(w._startX=n(m)?w._startX:m,w._startY=n(j)?w._startY:j,w._endX=n(S)?w._endX:S,w._endY=n(_)?w._endY:_),w.drawShape(R,U),w)},this.from=function(m,j,S){n(S)&&(S=!0);var _,R;if(m&&m.parent&&w.parent&&S){var U=m.parent.localToLocal(m.x,m.y,w.parent);_=U.x,R=U.y}return m&&!n(m.x)?(w._startX=n(_)?n(m.x)?w._startX:m.x:_,w._startY=n(R)?n(m.y)?w._startY:m.y:R):(w._startX=n(m)?w._startX:m,w._startY=n(j)?w._startY:j),w.drawShape(),w},this.to=function(m,j,S){n(S)&&(S=!0);var _,R;if(m&&m.parent&&w.parent&&S){var U=m.parent.localToLocal(m.x,m.y,w.parent);_=U.x,R=U.y}return m&&!n(m.x)?(w._endX=n(_)?n(m.x)?w._endX:m.x:_,w._endY=n(R)?n(m.y)?w._endY:m.y:R):(w._endX=n(m)?w._endX:m,w._endY=n(j)?w._endY:j),w.drawShape(),w},Object.defineProperty(w,"length",{get:function(){return w._length},set:function(m){var j=w.length!=0?m/w.length:0;if(!isNaN(j)){var S=w.scaleX,_=w.scaleY;w.scaleX*=j,w.scaleY*=j;var R=w.localToGlobal(w._startX,w._startY),U=w.localToGlobal(w._endX,w._endY);w.scaleX=S,w.scaleY=_;var Z=w.globalToLocal(R.x,R.y),K=w.globalToLocal(U.x,U.y);w.setPoints(Z,K)}}}),Object.defineProperty(w,"startPoint",{get:function(){return new t.Point(w._startX,w._startY)},set:function(m){w._startX=n(m.x)?w._startX:m.x,w._startY=n(m.y)?w._startY:m.y,w.drawShape()}}),Object.defineProperty(w,"endPoint",{get:function(){return new t.Point(w._endX,w._endY)},set:function(m){w._endX=n(m.x)?w._endX:m.x,w._endY=n(m.y)?w._endY:m.y,w.drawShape()}}),Object.defineProperty(w,"startHead",{get:function(){return w._startHead},set:function(m){w._startHead=m,w.drawShape()}}),Object.defineProperty(w,"endHead",{get:function(){return w._endHead},set:function(m){w._endHead=m,w.drawShape()}}),Object.defineProperty(w,"startX",{get:function(){return w._startX},set:function(m){w._startX=m||0,w.drawShape()}}),Object.defineProperty(w,"startY",{get:function(){return w._startY},set:function(m){w._startY=m||0,w.drawShape()}}),Object.defineProperty(w,"endX",{get:function(){return w._endX},set:function(m){w._endX=m||0,w.drawShape()}}),Object.defineProperty(w,"endY",{get:function(){return w._endY},set:function(m){w._endY=m||0,w.drawShape()}}),Object.defineProperty(w,"points",{get:function(){return w._points},set:function(m){m&&(w._points=m,w.drawShape())}}),Object.defineProperty(w,"lineOrientation",{get:function(){return w._lineOrientation},set:function(m){m&&(w._lineOrientation=m,w.drawShape())}}),T!==!1&&t.styleTransforms(this,x),this.clone=function(m){var j=m||!t.isPick(P[3])?w._startHead:P[3];j&&j.clone&&(j=j.clone(),j.rotation=w._startHead.startAngle);var S=m||!t.isPick(P[4])?w._endHead:P[4];S&&S.clone&&(S=S.clone(),S.rotation=w._endHead.startAngle);var _=w.cloneProps(new t.Line(m||!t.isPick(P[0])?w.length:P[0],m||!t.isPick(P[2])?w.thickness:P[2],m||!t.isPick(P[1])?w.color:P[1],j,S,w.dashed,f,u,w._lineOrientation,k,g,t.copy(O),T,this.group,A));return w.points?_.setPoints(w.points):_.setPoints(w._startX,w._startY,w._endX,w._endY),w.linearGradientParams&&_.linearGradient.apply(_,w.linearGradientParams),w.radialGradientParams&&_.radialGradient.apply(_,w.radialGradientParams),_}},t.extend(t.Line,t.CustomShape,"clone","zimCustomShape",!1),t.Squiggle=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j){var S="color, thickness, points, length, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",_;if(_=st(t.Squiggle,arguments,S,this))return _;De("53.2"),this.group=m;var R=Y===!1?{}:t.getStyle("Squiggle",this.group,j);if(n(r)&&(r=R.thickness!=null?R.thickness:6),n(l)&&(l=R.length!=null?R.length:300),n(i)&&(i=R.points!=null?R.points:5),typeof i=="string"){var U=new t.SVGContainer;i=U.processPath(i)}var Z=typeof i!="number",K=typeof i=="number"?i:i.length;if(K==0)return;n(a)&&(a=R.controlLength!=null?R.controlLength:l/K),this.zimCustomShape_constructor(l,a,null,null,!1),this.type="Squiggle",this.mouseChildren=!0,n(T)&&(T=R.dashed!=null?R.dashed:!1),n(e)&&(e=R.color!=null?R.color:t.blue),e.style&&(this.colorCommand=e,e=t.black),n(s)&&(s=R.controlType!=null?R.controlType:null);var ne=s;n(s)&&(s="mirror"),n(f)&&(f=R.lockControlType!=null?R.lockControlType:!1),n(b)&&(b=R.interactive!=null?R.interactive:!0),n(u)&&(u=R.showControls!=null?R.showControls:b);var V=u;n(y)&&(y=R.lockControls!=null?R.lockControls:!b),n(k)&&(k=R.handleSize!=null?R.handleSize:t.mobile()?20:10),n(g)&&(g=R.allowToggle!=null?R.allowToggle:b),n(O)&&(O=R.move!=null?R.move:b),n(A)&&(A=R.circleColor!=null?R.circleColor:t.light),n(C)&&(C=R.circleBorderColor!=null?R.circleBorderColor:t.dark),n(d)&&(d=R.stickColor!=null?R.stickColor:t.darker),n(x)&&(x=R.stickThickness!=null?R.stickThickness:1),n(P)&&(P=R.selectColor!=null?R.selectColor:t.white),n(v)&&(v=R.selectPoints!=null?R.selectPoints:b),this.circleColor=A,this.circleBorderColor=C,this.stickColor=d,this.stickThickness=x,n(E)&&(E=R.onTop!=null?R.onTop:!0),n(w)&&(w=R.editPoints!=null?R.editPoints:b),n(X)&&(X=R.strokeObj!=null?R.strokeObj:{});var D=c(e);this.veeObj={color:D[0]};function c(){return arguments}e=t.Pick.choose(e);var h=this,o;this.types=["mirror","straight","free","none"],this.interactive=b,this.num=K,this.onTop=E,this.move=O,this.editPoints=w,this.allowToggle=g,this.lockControlType=f,this.selectPoints=v,this.lockControls=y;var I,N,p;h._color=e,h._thickness=r,h._dashed=T,h._dashed&&!Array.isArray(h._dashed)&&(h._dashed=[10,10]);var L,we,B,F,fe=h.move,se=2,Q,te;ne&&typeof i!="number"&&t.loop(i,function(ie){ie[8]=ne,ne=="none"&&(ie[4]=ie[5]=ie[6]=ie[7]=0)}),le();function le(){te&&te.removeAllEventListeners(),h.num=K=typeof i=="number"?i:i.length,K=Math.max(2,K),a=l/K,L=h.shape=new t.Shape({style:!1}).addTo(h);var ie=h.sticks=new t.Shape({style:!1}).addTo(h);k<=0&&ie.removeFrom();var xe=L.graphics;xe.c();var Se=ie.graphics;Se.c();var z=k/10*8,pe=k;h.selectPoints?(h.selectedBalls=new t.SelectionSet,h.selectedRect1s=new t.SelectionSet,h.selectedRect2s=new t.SelectionSet,h.selectionManager=new t.SelectionManager([h.selectedBalls,h.selectedRect1s,h.selectedRect2s],"ctrl",!1)):h.selectionManager=new t.SelectionManager(null,"ctrl");var de=t.mobile();te=h.controls=new t.Container({style:!1}).addTo(h),h.interactive&&te.drag({onTop:!de}),I=[],p=[],N=[];var oe,Be,$,Me,be,me,re,ke,Re;for(oe=0;oe<K;oe++){if(Me=new t.Container({style:!1}).addTo(te),Me.num=oe,typeof i=="number"){var Ye=t.Pick.choose(a);$=new t.Container(Ye,r,null,null,!1).addTo(h).loc({x:oe*l/(K-1)-Ye/2,y:oe%2*Ye}),re=new t.Circle(z,h.selectPoints&&h.selectedBalls.isSelected(oe)?P:h.circleColor,h.circleBorderColor,2,null,null,null,null,!1).centerReg($).loc({x:Ye/2,y:0}),be=new t.Rectangle(pe,pe,h.selectPoints&&h.selectedRect1s.isSelected(oe)?P:Pe(s),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg($).loc({x:0,y:0}),me=new t.Rectangle(pe,pe,h.selectPoints&&h.selectedRect2s.isSelected(oe)?P:Pe(s),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg($).loc({x:Ye,y:0});var $e=$.localToLocal(re.x,re.y,te);re.x=$e.x,re.y=$e.y,re.addTo(Me,null,!1);var it=$.localToLocal(be.x,be.y,te);be.x=s=="none"?0:it.x-re.x,be.y=s=="none"?0:it.y-re.y,be.addTo(Me,null,!1);var Le=$.localToLocal(me.x,me.y,te);me.x=s=="none"?0:Le.x-re.x,me.y=s=="none"?0:Le.y-re.y,me.addTo(Me,null,!1),Me.x=re.x,Me.y=re.y,re.x=0,re.y=0,s=="none"&&re.addTo(Me,null,!1)}else Re=i[oe],ke=Re[8]?Re[8]:s,Me.loc({x:Re[0],y:Re[1]}),re=new t.Circle(z,h.circleColor,h.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(Me).loc({x:Re[2],y:Re[3]}),be=new t.Rectangle(pe,pe,Pe(ke),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(Me,0).loc({x:Re[4],y:Re[5]}),me=new t.Rectangle(pe,pe,Pe(ke),k==0?null:t.dark,k==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(Me,0).loc({x:Re[6],y:Re[7]});re.mySet=Me,re.rect1=be,re.rect2=me,re.index=oe,de?re.on("mousedown",ze):re.on("dblclick",ve),be.ball=re,be.other=me,me.ball=re,me.other=be,k==0&&(re.expand(10),be.expand(10),me.expand(10)),de&&(re.expand(),be.expand(),me.expand()),Be=[Me,re,be,me,Re?Re[8]:s],I.push(Be),N.push(re),p.push(Me)}var Ze=!1;function ze(he){Ze?(he.preventDefault(),ve(he)):(Ze=!0,setTimeout(function(){Ze=!1},300))}function ve(he){if(!h.lockControlType){var Ge=he.target,Ie=I[Ge.index][4]?I[Ge.index][4]:s;Math.abs(Ge.rect1.x)<=2&&Math.abs(Ge.rect1.y)<=2&&Math.abs(Ge.rect2.x)<=2&&Math.abs(Ge.rect2.y)<=2&&(Ie="none"),Ie=="none"&&Ge.parent.addChildAt(Ge,0),Ie=h.types[(h.types.indexOf(Ie)+(h.shiftKey?-1:1)+h.types.length)%h.types.length],Ie=="none"&&(Ge.rect1.x=Ge.rect1.y=Ge.rect2.x=Ge.rect2.y=0,Ge.parent.addChild(Ge),he.stopImmediatePropagation()),I[Ge.index][4]=Ie,Ge.rect1.color=Pe(Ie),Ge.rect2.color=Pe(Ie),h.drawShape(),e.type&&(h.color=e);var _e=new Fe.Event("change");_e.controlType="bezierSwitch",h.dispatchEvent(_e),Ge.stage.update()}}function Pe(he){var Ge={straight:"#e472c4",free:"#ebcb35",none:"#50c4b7"};return Ge[he]?Ge[he]:"#993399"}var ae=t.mobile();h.drawShape=function(){xe.c();var he=ae?10:6,Ge,Ie,_e,Je,Oe,Ve,rt,Ce,We,lt,Ue,ct,ot,dt,et;if(r<he)for(xe.s("rgba(0,0,0,.01)").ss(he),Je=I[0][0],We=Je.localToLocal(I[0][1].x,I[0][1].y,L),xe.mt(We.x,We.y),Ge=0;Ge<I.length;Ge++)Ie=Ge,_e=(Ge+1)%I.length,Je=I[Ie][0],Oe=I[Ie][1],Ve=I[Ie][2],rt=I[Ie][3],Ce=I[_e][0],lt=I[_e][1],Ue=I[_e][2],ot=Je.localToLocal(rt.x,rt.y,L),dt=Ce.localToLocal(Ue.x,Ue.y,L),et=Ce.localToLocal(lt.x,lt.y,L),Ge!=I.length-1&&xe.bt(ot.x,ot.y,dt.x,dt.y,et.x,et.y);for(h.colorCommand||(h.colorCommand=xe.s(h._color).command,e&&e.type&&h.specialColor(h.colorCommand,e,h)),h.thicknessCommand||(h.thicknessCommand=xe.ss(h._thickness,X.caps,X.joints,X.miterLimit,X.ignoreScale).command),h._dashed&&(h.dashedCommand||(h.dashedCommand=xe.sd(Array.isArray(h._dashed)?h._dashed:[10,10],h._dashedOffset).command)),Je=I[0][0],We=Je.localToLocal(I[0][1].x,I[0][1].y,L),xe.mt(We.x,We.y),Se.c().s(h.stickColor).ss(h.stickThickness),Ge=0;Ge<I.length;Ge++)Ie=Ge,_e=(Ge+1)%I.length,Je=I[Ie][0],Oe=I[Ie][1],Ve=I[Ie][2],rt=I[Ie][3],Ce=I[_e][0],lt=I[_e][1],Ue=I[_e][2],ot=Je.localToLocal(rt.x,rt.y,L),dt=Ce.localToLocal(Ue.x,Ue.y,L),et=Ce.localToLocal(lt.x,lt.y,L),Ge!=I.length-1&&xe.bt(ot.x,ot.y,dt.x,dt.y,et.x,et.y),We=Je.localToLocal(Oe.x,Oe.y,L),ct=Je.localToLocal(Ve.x,Ve.y,L),Ge==0&&(Ve.visible=0),Ge!=0&&Se.mt(We.x,We.y).lt(ct.x,ct.y),Ge!=I.length-1&&Se.mt(We.x,We.y).lt(ot.x,ot.y),Ge==I.length-1&&(rt.visible=0);h._dashed&&xe.append(h.dashedCommand),xe.append(h.thicknessCommand),xe.append(h.colorCommand)},h.drawShape(),e.type&&(h.color=e);var Ne;te.on("mousedown",function(he){if(o=he.target.stage,!h.lockControls){if(h.selectPoints&&(h.keyFocus=!0),Ne={x:he.target.x,y:he.target.y},he.target.rect1)re=he.target,re.startX=re.x,re.startY=re.y,re.rect1.startX=re.rect1.x,re.rect1.startY=re.rect1.y,re.rect2.startX=re.rect2.x,re.rect2.startY=re.rect2.y;else{var Ge=he.target;Ge.startX=Ge.x,Ge.startY=Ge.y,re=Ge.ball;var Ie=re.index,_e=s;if(n(I[Ie][4])||(_e=I[Ie][4]),_e=="straight"){var Je=Ge.other,Oe=Je.x-re.x,Ve=Je.y-re.y;Je.stickLength=Math.sqrt(Math.pow(Oe,2)+Math.pow(Ve,2))}}if(h.selectPoints){var rt=h.selectionManager.currentSet;if(rt&&rt.selections&&rt.selections.length>0)for(oe=0;oe<rt.selections.length;oe++){var Ce=h.pointObjects[rt.selections[oe]];Ce[1].startX=Ce[1].x,Ce[1].startY=Ce[1].y,Ce[2].startX=Ce[2].x,Ce[2].startY=Ce[2].y,Ce[3].startX=Ce[3].x,Ce[3].startY=Ce[3].y}}}}),h.selectPoints&&te.tap(function(he){if(he.target.rect1){var Ge=he.target;h.selectedBalls.toggle(Ge.parent.num)}else{var Ie=he.target;Ie.color="white",Ge=Ie.ball,Ge.rect1==Ie?h.selectedRect1s.toggle(Ge.parent.num):h.selectedRect2s.toggle(Ge.parent.num)}for(oe=0;oe<h.pointObjects.length;oe++){var _e=h.pointObjects[oe];_e[1].color=h.selectedBalls.isSelected(oe)?P:h.circleColor,_e[2].color=h.selectedRect1s.isSelected(oe)?P:Pe(_e[4]),_e[3].color=h.selectedRect2s.isSelected(oe)?P:Pe(_e[4])}o.update()}),te.on("pressmove",function(he){if(!h.lockControls)if(h.selectPoints){var Ge=Ae();if(Ge.indexOf(he.target)==-1)Q(he.target),h.drawShape();else if(Ge.length>0){for(var Ie=he.target.x-he.target.startX,_e=he.target.y-he.target.startY,Je=0;Je<Ge.length;Je++){var Oe=Ge[Je];Oe.x=Oe.startX+Ie,Oe.y=Oe.startY+_e,Q(Oe)}h.drawShape()}}else Q(he.target),h.drawShape()}),te.on("pressup",function(he){if(!h.lockControls){var Ge=he.target.x!=Ne.x||he.target.y!=Ne.y,Ie=new Fe.Event("change");he.target.rect1?(Ie.controlType="bezierPoint",Ke(he.target)):Ie.controlType="bezierHandle",Ge&&h.dispatchEvent(Ie)}});function Ke(he){if(h.selectPoints){var Ge=Ae();if(Ge&&Ge.indexOf(he)==-1)J(he);else if(Ge&&Ge.length>0)for(var Ie=0;Ie<Ge.length;Ie++)J(Ge[Ie]);else J(he)}else J(he)}h.changeControl=function(he,Ge,Ie,_e,Je,Oe,Ve,rt,Ce){var We="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",lt;if(lt=st(h.changeControl,arguments,We))return lt;if(n(he)){for(oe=0;oe<I.length;oe++)h.changeControl(oe,Ge,Ie,_e,Je,Oe,Ve,rt);return}var Ue=I[he];Ue[4]=Ge,Ge=="none"?(n(Ve)||(Ue[2].x=Ve),n(rt)||(Ue[2].y=rt),Ue[2].x=Ue[1].x,Ue[2].y=Ue[1].y,Ue[3].x=Ue[1].x,Ue[3].y=Ue[1].y,Ue[1].parent.addChild(Ue[1])):(n(Ie)||(Ue[2].x=Ie),n(_e)||(Ue[2].y=_e),n(Je)||(Ue[3].x=Je),n(Oe)||(Ue[3].y=Oe),n(Ve)||(Ue[1].x=Ve),n(rt)||(Ue[1].y=rt),Ue[1].parent.addChildAt(Ue[1],0)),Ce&&(h.update(),o&&o.update())},h.transformPoints=function(he,Ge,Ie,_e,Je){return n(Je)&&(Je=!0),h.points=t.transformPoints(h.points,he,Ge,Ie,_e),Je&&h.approximateBounds(),h},h.traverse=function(he,Ge,Ie,_e,Je){var Oe=t.copy(h.segmentRatios);Oe.unshift(0),n(Ie)&&(Ie=Ge+1);var Ve=Oe[Ge]*100,rt=Oe[Ie]*100,Ce;!Je&&Ve>rt?Ce=100-Ve+rt:!Je&&Ve<rt?Ce=rt-Ve:Je&&Ve>rt?Ce=-(Ve-rt):Je&&Ve<rt&&(Ce=-(100-rt+Ve));var We=new Fe.Event("traversed");return We.obj=he,he.animate({ease:"linear",props:{path:h,startPercent:Ve,percent:Ce},time:_e,call:function(){h.dispatchEvent(We)}}),h},h.reversePoints=function(){return i=t.copy(h.points),h.points=t.reversePoints(t.copy(h.points)),h.update(),h},h.appendPoints=function(he,Ge){var Ie=t.copy(h.points);return h.points=t.appendPoints(Ie,he,Ge),h.update(),h},h.prependPoints=function(he,Ge){var Ie=t.copy(h.points);return h.points=t.rependPoints(Ie,i,Ge),h.update(),h},h.splitPoints=function(he){var Ge=t.copy(h.points);if(!(he<1||he>Ge.length-1)){var Ie=t.splitPoints(Ge,he),_e=Ie[0],Je=Ie[1],Oe=h.clone();return h.points=_e,h.update(),Oe.points=Je,h.parent&&Oe.addTo(h.parent),Oe}},h.makeBlob=function(he,Ge){n(he)&&(he="mirror"),n(Ge)&&(Ge=5);var Ie=t.copy(h.points);t.loop(Ie,function(Je,Oe,Ve){Je[8]||(Je[8]="mirror"),Oe==0&&(he=="free"&&(Je[4]=Je[5]=0),Je[8]=he),Oe==Ve-1&&(he=="free"&&(Je[6]=Je[7]=0),Je[8]=he)}),Math.abs(Ie[0][0]-Ie[Ie.length-1][0])<Ge&&Math.abs(Ie[0][1]-Ie[Ie.length-1][1])<Ge&&(Ie[0][4]=Ie[Ie.length-1][4],Ie[0][5]=Ie[Ie.length-1][5],Ie.pop());var _e=new t.Blob({points:Ie,borderColor:h.color,borderWidth:h.thickness,showControls:h.controlsVisible,interactive:h.interactive,onTop:h.onTop,dashed:h.dashed,stickColor:h.stickColor,stickThickness:h.stickThickness});return _e},h.update=function(he){return he?h.points=h.pointsAdjusted:h.drawShape(),h.zimAnimateChanged=!0,h},h.interactive&&(O&&L.drag({onTop:!1}),we=L.on("mousedown",function(he){o=he.target.stage,Ne={x:L.x,y:L.y},h.selectPoints&&(h.keyFocus=!0),Xe()}),B=L.on("pressmove",function(){te.x=L.x,te.y=L.y,ie.x=L.x,ie.y=L.y}),F=L.on("pressup",function(){var he=L.x!=Ne.x||L.y!=Ne.y,Ge=L.localToLocal(h.regX,h.regY,h.parent);if(h.x=Ge.x,h.y=Ge.y,te.x=te.y=ie.x=ie.y=L.x=L.y=0,he){var Ie=new Fe.Event("change");Ie.controlType="move",h.dispatchEvent(Ie)}o&&o.update()}),h.move||G(!0));function Xe(){if(h.onTop){var he=h.parent.numChildren-1;h.parent.getChildAt(he).type=="Keyboard"&&he--,h.parent.setChildIndex(h,he)}}h.toggleEvent=h.on("mousedown",function(){h.allowToggle&&(V||(h.showControls(),h.dispatchEvent("controlsshow")))}),h.added(function(){o=h.stage,h.toggleStageEvent&&o.off("stagemousedown",h.toggleStageEvent),h.toggleStageEvent=o.on("stagemousedown",function(he){!h.allowToggle||!h.stage||V&&!h.hitTestPoint(he.stageX/t.scaX,he.stageY/t.scaY,!1)&&(h.hideControls(),h.dispatchEvent("controlshide"))})}),h.clickEvent=h.on("click",function(){h.ctrlKey&&setTimeout(function(){h.clone(!0).addTo(h.stage).mov(0,100),h.allowToggle&&(h.hideControls(),h.dispatchEvent("controlshide"));var he=new Fe.Event("change");he.controlType="move",h.dispatchEvent(he),h.stage.update()},50)}),h.hideControls=function(){return h.toggled=!1,te.visible=!1,ie.visible=!1,V=!1,h.stage&&h.stage.update(),!h.allowToggle&&h.move&&G(),h},u||h.hideControls(),h.showControls=function(){return h.toggled=!0,te.visible=!0,ie.visible=!0,V=!0,te.x=L.x,te.y=L.y,ie.x=L.x,ie.y=L.y,h.addChildAt(L,0),h.move&&!h.allowToggle&&Te(),h.stage&&h.stage.update(),h},h.toggle=function(he){return he===!0?h.showControls():he===!1||V?h.hideControls():h.showControls(),h},h.recordData=function(he){n(he)&&(he=!1);var Ge={type:"Squiggle",index:h.parent?h.parent.getChildIndex(h):-1,x:h.x,y:h.y,points:h.getPoints(),color:h.color,thickness:h.thickness,move:h.move,allowToggle:h.allowToggle,controlsVisible:V};return he?JSON.stringify(Ge):Ge},h.setData=function(he,Ge){if(!n(he)){if(Ge)try{he=JSON.parse(he)}catch (e8){return}var Ie=he.index;n(Ie)&&(Ie=-1),delete he.index;var _e=he.points;n(_e)||h.setPoints(_e),delete he.points,h.num=_e.length;for(var Je in he)h[Je]=he[Je];return h.parent&&h.parent.setChildIndex(h,Ie),h.update(),h}},h.getPoints=function(he){n(he)&&(he=!1);var Ge=h.points;if(he){if(!h.pane){var Ie=h.pane=new t.Pane({container:h.stage,width:Math.min(500,h.stage.width-20),height:Math.min(500,h.stage.height-20),draggable:!0}),_e=h.textArea=new t.TextArea(Math.min(400,h.stage.width-70),Math.min(400,h.stage.height-70));_e.centerReg(Ie)}h.textArea.text=JSON.stringify(Ge),h.pane.show()}return Ge},h.recordPoints=h.getPoints,h.setPoints=function(he){for(var Ge,Ie,_e=0;_e<he.length;_e++)Ge=I[_e],Ie=he[_e],!n(Ge)&&(Ge[0].x=Ie[0],Ge[0].y=Ie[1],Ge[1].x=Ie[2],Ge[1].y=Ie[3],Ge[2].x=Ie[4],Ge[2].y=Ie[5],Ge[3].x=Ie[6],Ge[3].y=Ie[7],Ge[4]=Ie[8]);return h.update(),h},Y!==!1&&t.styleTransforms(h,R),h.clone=function(he,Ge){var Ie=[],_e=!1;t.loop(h.pointControls,function(Oe){Oe.scaleX+Oe.scaleY+Oe.regX+Oe.regY+Oe.rotation!=2&&(_e=!0),Ie.push([Oe.scaleX,Oe.scaleY,Oe.regX,Oe.regY,Oe.rotation])});var Je=h.cloneProps(new t.Squiggle(Ge?h.colorCommand:he||!t.isPick(D[0])?h.color:D[0],h.thickness,h.getPoints(),l,a,s,f,te.visible,y,k,h.allowToggle,h.move,T,E,h.circleColor,h.circleBorderColor,h.stickColor,h.stickThickness,P,v,h.editPoints,b,X,Y,h.group,j));return _e&&(t.loop(Je.pointControls,function(Oe,Ve){Oe.scaleX=Ie[Ve][0],Oe.scaleY=Ie[Ve][1],Oe.regX=Ie[Ve][2],Oe.regY=Ie[Ve][3],Oe.rotation=Ie[Ve][4]}),Je.update()),h.linearGradientParams&&Je.linearGradient.apply(Je,h.linearGradientParams),h.radialGradientParams&&Je.radialGradient.apply(Je,h.radialGradientParams),Je},h.shape.on("mousedown",function(he){o=he.target.stage,h.editPoints&&(h.controlsVisible?(h.pressX=he.stageX/t.scaX,h.pressY=he.stageY/t.scaX):(h.pressX=null,h.pressY=null))}),h.addPointFactor=10,h.addMinDistance=15,h.shape.on("pressup",function(he){if(h.editPoints&&h.pressX&&Math.abs(h.pressX-he.stageX/t.scaX)<se&&Math.abs(h.pressY-he.stageY/t.scaY)<se){h.selectPoints&&(h.lastPoints=t.copy(h.points));var Ge=h.points,Ie=h.globalToLocal(he.stageX/t.scaX,he.stageY/t.scaY),_e=t.closestPointAlongCurve(Ie,h.segmentPoints);if(h.editPoints=="anywhere")Ge.splice(_e+1,0,[Ie.x,Ie.y,0,0,0,0,0,0]),h.points=Ge,h.changeControl({index:_e+1,type:"mirror",update:!0});else{var Je=h.pointsAdjusted,Oe=h.getSegmentPoint(Je[_e],Je[(_e+1)%Je.length]),Ve=t.distanceAlongCurve(Oe),rt=Math.round(Ve/h.addPointFactor),Ce=h.interpolate(rt,_e,!1,Ge),We=1e4,lt;if(t.loop(Ce,function(dt,et){var St=t.dist(dt,Ie);St<We&&(We=St,lt=et)}),We<h.addMinDistance){var Ue=h.segmentRatios,ct=Ue[_e],ot=_e>0?Ue[_e-1]:0;h.addPoint(100*(ot+(ct-ot)*(lt/(rt+1))))}}h.lastSelectedIndex=_e+1,h.lastSelected=h.controls.getChildAt(h.lastSelectedIndex),h.stage.update()}}),h.controls.on("click",function(he){h.lastSelected=he.target.parent,h.lastSelectedIndex=h.controls.getChildIndex(he.target.parent),h.editPoints&&h.selectionManager.shiftKey&&Qe(he)});function Qe(he){if(he.target.type=="Circle"){var Ge=h.lastSelectedIndex=h.controls.getChildIndex(he.target.parent);if(h.controls.numChildren<=2)return;var Ie=h.points;h.selectPoints&&(h.lastPoints=t.copy(Ie)),Ie.splice(Ge,1),h.points=Ie,h.stage.update(),h.lastSelected=h.lastSelectedIndex=null}}h.controls.hold(Qe),V||h.hideControls(),h.dispatchEvent("update")}function Ae(){var ie=[],xe=h.selectionManager.currentSet;if(xe&&xe.selections&&xe.selections.length>0)for(var Se=0;Se<xe.selections.length;Se++){var z=h.pointObjects[xe.selections[Se]];if(xe==h.selectedBalls)ie.push(z[1]);else if(xe==h.selectedRect1s)ie.push(z[2]);else if(xe==h.selectedRect2s)ie.push(z[3]);else continue}return ie}function J(ie){if(ie.type=="Circle"){var xe=ie,Se=xe.mySet,z=xe.rect1,pe=xe.rect2;z.x-=xe.x,z.y-=xe.y,pe.x-=xe.x,pe.y-=xe.y,Se.x+=xe.x,Se.y+=xe.y,xe.x=0,xe.y=0}}h.selectionManager.on("keydown",function(ie){if(h.selectPoints&&h.keyFocus&&ie.keyCode>=37&&ie.keyCode<=40){var xe=Ae();if(xe.length>0){for(var Se=0;Se<xe.length;Se++){var z=xe[Se];ie.keyCode==37?z.x-=h.selectionManager.shiftKey?10:1:ie.keyCode==39?z.x+=h.selectionManager.shiftKey?10:1:ie.keyCode==38?z.y-=h.selectionManager.shiftKey?10:1:ie.keyCode==40&&(z.y+=h.selectionManager.shiftKey?10:1),Q(z)}h.drawShape(),h.dispatchEvent("update"),h.stage&&h.stage.update()}}}),h.selectionManager.on("keyup",function(ie){if(h.selectPoints&&h.keyFocus&&ie.keyCode>=37&&ie.keyCode<=40){var xe=Ae();if(xe.length>0)for(var Se=0;Se<xe.length;Se++)J(xe[Se])}}),h.selectionManager.on("undo",function(){if(h.selectPoints&&h.keyFocus&&h.lastPoints){var ie=t.copy(h.lastPoints);h.lastPoints=t.copy(h.points),h.points=ie,h.stage&&h.stage.update()}}),Q=function(ie){if(!h.lockControls){var xe;if(ie.rect1){xe=ie;var Se=xe.x-xe.startX,z=xe.y-xe.startY;xe.rect1.x=xe.rect1.startX+Se,xe.rect1.y=xe.rect1.startY+z,xe.rect2.x=xe.rect2.startX+Se,xe.rect2.y=xe.rect2.startY+z}else{var pe=ie,de=pe.other;xe=pe.ball;var oe=xe.index,Be=s;if(n(I[oe][4])||(Be=I[oe][4]),Be=="straight"||Be=="mirror"){var $=pe.x-xe.x,Me=pe.y-xe.y;if(Be=="mirror")de.x=xe.x-$,de.y=xe.y-Me;else{var be=Math.atan2(Me,$),me=-de.stickLength*Math.cos(be+Math.PI),re=-de.stickLength*Math.sin(be+Math.PI);de.x=xe.x-me,de.y=xe.y-re}}}}},Object.defineProperty(h,"move",{get:function(){return O},set:function(ie){O!=ie&&(O=ie,ie?Te():G())}}),Object.defineProperty(h,"interactive",{get:function(){return b},set:function(ie){b=ie,V=b,h.allowToggle=b,h.editPoints=b,h.lockControls=!b,h.selectPoints=b,h.move=b;var xe=h.points;h.points=xe}}),Object.defineProperty(h,"allowToggle",{get:function(){return g},set:function(ie){g!=ie&&(g=ie,g?h.move&&Te():!V&&h.move&&G())}});function Te(){h.move!="always"&&(fe||(fe=!0,L.drag({onTop:!1}),we=L.on("mousedown",we),B=L.on("pressmove",B),F=L.on("pressup",F)))}function G(ie){h.move!="always"&&(!ie&&!fe||(fe=!1,L.noDrag(),L.off("mousedown",we),L.off("pressmove",B),L.off("pressup",F)))}var ce=y;Object.defineProperty(h,"lockControls",{get:function(){return ce},set:function(ie){ce=ie,ie?(h.controls.mouseChildren=!1,h.controls.mouseEnabled=!1):(h.controls.mouseChildren=!0,h.controls.mouseEnabled=!0)}}),h.lockControls=ce,Object.defineProperty(h,"controlsVisible",{get:function(){return V},set:function(ie){V=ie,ie?h.showControls():h.hideControls()}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==h},set:function(){t.KEYFOCUS=h}}),t.KEYFOCUS||q();function q(){if(h.selectPoints){h.keyFocus=!0;var ie=document.activeElement;ie&&ie.blur()}}Object.defineProperty(h,"points",{get:function(){for(var ie=[],xe,Se,z=0;z<I.length;z++)Se=I[z],xe=[t.decimals(Se[0].x),t.decimals(Se[0].y),t.decimals(Se[1].x),t.decimals(Se[1].y),t.decimals(Se[2].x),t.decimals(Se[2].y),t.decimals(Se[3].x),t.decimals(Se[3].y)],Se[4]&&Se[4]!=="mirror"&&xe.push(Se[4]),ie.push(xe);return ie},set:function(ie){var xe=h.x,Se=h.y,z=h.visible,pe=[],de=!1;t.loop(h.pointControls,function(oe){oe.scaleX+oe.scaleY+oe.regX+oe.regY+oe.rotation!=2&&(de=!0),pe.push([oe.scaleX,oe.scaleY,oe.regX,oe.regY,oe.rotation])}),h.dispose(!0),i=ie,le(),h.lockControls=ce,h.x=xe,h.y=Se,h.visible=z,de&&(t.loop(h.pointControls,function(oe,Be){oe.scaleX=pe[Be][0],oe.scaleY=pe[Be][1],oe.regX=pe[Be][2],oe.regY=pe[Be][3],oe.rotation=pe[Be][4]}),h.update())}}),Object.defineProperty(h,"pointsAdjusted",{get:function(){var ie=[],xe,Se,z,pe=h.pointObjects;return t.loop(pe.length,function(de){if(z=pe[de],Se=I[de],z[0].rotation==0&&z[0].scaleX==0&&z[0].scaleY==0)xe=[t.decimals(Se[0].x),t.decimals(Se[0].y),t.decimals(Se[1].x),t.decimals(Se[1].y),t.decimals(Se[2].x),t.decimals(Se[2].y),t.decimals(Se[3].x),t.decimals(Se[3].y)];else{var oe=z[0].localToLocal(z[2].x,z[2].y,z[0].parent),Be=z[0].localToLocal(z[3].x,z[3].y,z[0].parent);xe=[t.decimals(Se[0].x),t.decimals(Se[0].y),t.decimals(Se[1].x),t.decimals(Se[1].y),t.decimals(oe.x-Se[0].x),t.decimals(oe.y-Se[0].y),t.decimals(Be.x-Se[0].x),t.decimals(Be.y-Se[0].y)]}Se[4]&&Se[4]!=="mirror"&&xe.push(Se[4]),ie.push(xe)}),ie},set:function(){vt&&tt("Squiggle() - pointsAdjusted is read only")}}),Object.defineProperty(h,"pointObjects",{get:function(){return I},set:function(){vt&&tt("Squiggle() - pointObjects is read only - but its contents can be manipulated - use squiggle.update() after changes")}}),Object.defineProperty(h,"pointControls",{get:function(){return p},set:function(){vt&&tt("Squiggle() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(h,"pointCircles",{get:function(){return N},set:function(){vt&&tt("Squiggle() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(h,"segmentPoints",{get:function(){var ie=[],xe=h.pointsAdjusted;return t.loop(xe.length-1,function(Se){var z=h.getSegmentPoint(xe[Se],xe[Se+1]);ie.push(z)}),ie},set:function(){vt&&tt("Squiggle() - segmentPoints is read only")}}),Object.defineProperty(h,"segmentRatios",{get:function(){var ie=[],xe=0;t.loop(h.segmentPoints,function(pe){var de=t.distanceAlongCurve(pe);ie.push(de),xe+=de});var Se=[],z=0;return t.loop(ie,function(pe){var de=pe/xe;z+=de,Se.push(z)}),Se},set:function(){vt&&tt("Squiggle() - segmentRatios is read only")}}),h.approximateBounds=function(ie,xe,Se){n(ie)&&(ie=80),n(Se)&&(Se=0),ie/=h.num;var z=h.interpolate(ie,null,!0,null,!0),pe=t.boundsAroundPoints(z);if(h.setBounds(pe.x-Se,pe.y-Se,pe.width+Se*2,pe.height+Se*2),xe){if(!h.parent)return vt&&tt("approximateBounds() - add to stage to first to see points"),h;h.hitPathPoints?h.hitPathPoints.removeAllChildren():h.hitPathPoints=new t.Container().addTo(),h.hitPathPoints.top();for(var de=0;de<z.length;de++){var oe=z[de];oe=h.localToGlobal(oe.x,oe.y),new t.Circle(3).loc(oe.x,oe.y,h.hitPathPoints)}}return h},h.getPointAngle=function(ie){var xe=h.pointObjects[ie][0],Se=h.pointObjects[ie][2],z=h.pointObjects[ie][3],pe,de;return xe==h.stage?(pe=new t.Point(Se.x,Se.y),de=new t.Point(z.x,z.y)):(pe=xe.localToGlobal(Se.x,Se.y),de=xe.localToGlobal(z.x,z.y)),t.angle(pe.x,pe.y,de.x,de.y)},h.getSegmentPoint=function(ie,xe){if(!(n(ie)||n(xe))){(ie[2]!=0||ie[3]!=0)&&(ie[4]-=ie[2],ie[5]-=ie[3],ie[6]-=ie[2],ie[7]-=ie[3],ie[0]+=ie[2],ie[1]+=ie[3],ie[2]=0,ie[3]=0),(xe[2]!=0||xe[3]!=0)&&(xe[4]-=xe[2],xe[5]-=xe[3],xe[6]-=xe[2],xe[7]-=xe[3],xe[0]+=xe[2],xe[1]+=xe[3],xe[2]=0,xe[3]=0);var Se={x:ie[0],y:ie[1]},z={x:ie[0]+ie[6],y:ie[1]+ie[7]},pe={x:xe[0]+xe[4],y:xe[1]+xe[5]},de={x:xe[0],y:xe[1]};return(te.x!=0||te.y!=0)&&(Se.x+=te.x,z.x+=te.x,pe.x+=te.x,de.x+=te.x,Se.y+=te.y,z.y+=te.y,pe.y+=te.y,de.y+=te.y),[Se,z,pe,de]}},h.getAdjacentSegmentData=function(ie){n(ie)&&(ie=0);var xe=h.pointsAdjusted;return h.num==2?[[h.getSegmentPoint(xe[0],xe[1])],[0]]:ie==0?[[h.getSegmentPoint(xe[0],xe[1]),h.getSegmentPoint(xe[1],xe[2])],[0,1]]:ie>=h.num-2?[[h.getSegmentPoint(xe[h.num-3],xe[h.num-2]),h.getSegmentPoint(xe[h.num-2],xe[h.num-1])],[h.num-3,h.num-2]]:[[h.getSegmentPoint(xe[ie-1],xe[ie]),h.getSegmentPoint(xe[ie],xe[ie+1]),h.getSegmentPoint(xe[ie+1],xe[ie+2])],[ie-1,ie,ie+1]]},h.getCurvePoint=function(ie,xe,Se,z,pe){(n(ie)||isNaN(ie))&&(ie=0),n(xe)&&(xe=h.segmentRatios),n(Se)&&(Se=h.segmentPoints),n(z)&&(z=!1),n(pe)&&(pe=!1);var de=xe,oe=Se,Be=t.loop(de,function(ke,Re){if(ke>=ie)return Re}),$=Be>0?de[Be-1]:0,Me=Be>0?de[Be]-de[Be-1]:de[Be];if(Me){var be=(ie-$)/Me,me=t.pointAlongCurve(oe[Be],be,z,!0),re=h.localToGlobal(me.x,me.y);return re.angle=me.angle,re.z=Be,n(re)?void 0:re}};function ue(ie,xe,Se){return{x:ie.x+(xe.x-ie.x)*Se,y:ie.y+(xe.y-ie.y)*Se}}function ge(ie,xe,Se,z,pe,de,oe,Be){var $=ie.length-1,Me=0,be=0;z==100&&h.type=="Squiggle"&&(z=99.99),z=(z+1e5)%100,t.loop(Se,function(Pe,ae){if(z/100<Pe)return $=ae,be=Pe,!0;Me=Pe});var me=h.segmentPoints[$],re=be>0?(z/100-Me)/(be-Me):0,ke=t.pointAlongCurve(me,re,null,Be),Re=[ke.x,ke.y,0,0];if(!de){if(oe){h.interpolatedPoints.push({x:ke.x,y:ke.y,r:z/100});return}if(pe!="none"){var Ye=ue(me[0],me[1],re),$e=ue(me[1],me[2],re),it=ue(me[2],me[3],re),Le=ue(Ye,$e,re),Ze=ue($e,it,re);Re[4]=Le.x-ke.x,Re[5]=Le.y-ke.y,Re[6]=Ze.x-ke.x,Re[7]=Ze.y-ke.y;var ze=h.localToLocal(Ye.x,Ye.y,xe[$]);ie[$][6]=ze.x,ie[$][7]=ze.y;var ve=h.localToLocal(it.x,it.y,xe[($+1)%ie.length]);ie[($+1)%ie.length][4]=ve.x,ie[($+1)%ie.length][5]=ve.y}pe&&(Re[8]=pe),ie.splice($+1,0,Re)}}this.addPoint=function(ie,xe){n(ie)&&(ie=100);var Se=h.points,z=h.segmentRatios,pe=h.pointControls;return xe=xe||ne,ge(Se,pe,z,ie,xe),h.points=Se,h.num=Se.length,h},this.removePoint=function(ie){if(!(n(ie)||ie<0)){var xe=t.copy(h.points);return xe.splice(ie,1),h.points=xe,h.stage&&h.stage.update(),h}},this.addPoints=function(ie,xe,Se,z,pe,de,oe){n(de)&&(de=t.copy(h.points));var Be=t.copy(h.segmentRatios),$=0;if(pe&&(h.interpolatedPoints=[]),z)var Me=Be.length*ie;return t.loop(Be,function(be,me){pe&&ge(de,h.pointControls,h.segmentRatios,$*100,xe,!n(Se)&&me!=Se,pe,oe);var re=z?Math.round(Me*(be-$)):ie,ke=1/(re+1);t.loop(re,function(Re){var Ye=$+(be-$)*ke*(Re+1);ge(de,h.pointControls,h.segmentRatios,Ye*100,xe,!n(Se)&&me!=Se,pe,oe),!pe&&ie>0&&(h.points=de)}),$=be}),pe&&h.type=="Squiggle"&&ge(de,h.pointControls,h.segmentRatios,100,xe,!1,pe,oe),h.stage&&h.stage.update(),h.num=de.length,h},this.interpolate=function(ie,xe,Se,z,pe){return n(ie)&&(ie=1),h.addPoints(ie,"none",xe,Se,!0,z,pe),h.interpolatedPoints},Z&&h.approximateBounds(),this.dispose=function(ie,xe,Se){if(h.shape){if(t.gD(h),o&&h.toggleStageEvent&&o.off("stagemousedown",h.toggleStageEvent),h.controls.noDrag(),h.controls.removeAllEventListeners(),h.selectPoints&&h.selectionManager&&h.selectionManager.dispose(),h.selectedBalls=null,h.selectedRect1s=null,h.selectedRect2s=null,h.selectionManager=null,h.off("mousedown",h.toggleEvent),h.off("click",h.clickEvent),ie){h.shape.dispose(),h.shape=null;for(var z=0;z<h.points.length;z++)h.pointObjects[z][0].removeAllEventListeners(),h.pointObjects[z][1].removeAllEventListeners(),h.pointObjects[z][2].removeAllEventListeners(),h.pointObjects[z][3].removeAllEventListeners();h.controls.removeFrom(h),h.sticks.dispose(),I=null,N=null}else h.removeAllEventListeners(),I=null,N=null,Se||this.zimCustomShape_dispose(!0);return!0}}},t.extend(t.Squiggle,t.CustomShape,["clone","dispose"],"zimCustomShape",!1),t.Blob=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S){var _="color, borderColor, borderWidth, points, radius, controlLength, controlType, lockControlType, showControls, lockControls, handleSize, allowToggle, move, dashed, onTop, circleColor, circleBorderColor, stickColor, stickThickness, selectColor, selectPoints, editPoints, interactive, strokeObj, style, group, inherit",R;if(R=st(t.Blob,arguments,_,this))return R;De("53.5"),this.group=j;var U=m===!1?{}:t.getStyle("Blob",this.group,S);n(a)&&(a=U.radius!=null?U.radius:100),this.zimCustomShape_constructor(-a,-a,a*2,a*2,!1),this.type="Blob",this.mouseChildren=!0,n(E)&&(E=U.dashed!=null?U.dashed:!1),n(r)&&(r=U.borderColor!=null?U.borderColor:null),n(i)&&(i=U.borderWidth!=null?U.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(e)&&(e=U.color!=null?U.color:i>0?"rgba(0,0,0,0)":t.green),e.style&&(this.colorCommand=e,e=t.black),r&&r.style&&(this.borderColorCommand=r,r=t.black),n(l)&&(l=U.points!=null?U.points:4);var Z=typeof l!="number",K=typeof l=="number"?l:l.length,ne=s;n(s)&&(s=U.controlLength!=null?U.controlLength:a*4/K),n(f)&&(f=U.controlType!=null?U.controlType:null);var V=f;n(f)&&(f="straight"),n(u)&&(u=U.lockControlType!=null?U.lockControlType:!1),n(X)&&(X=U.interactive!=null?U.interactive:!0),n(y)&&(y=U.showControls!=null?U.showControls:X);var D=y;n(k)&&(k=U.lockControls!=null?U.lockControls:!X),n(g)&&(g=U.handleSize!=null?U.handleSize:t.mobile()?20:10),n(O)&&(O=U.allowToggle!=null?U.allowToggle:X),n(T)&&(T=U.move!=null?U.move:X),n(C)&&(C=U.circleColor!=null?U.circleColor:t.light),n(d)&&(d=U.circleBorderColor!=null?U.circleBorderColor:t.dark),n(x)&&(x=U.stickColor!=null?U.stickColor:t.darker),n(P)&&(P=U.stickThickness!=null?U.stickThickness:1),n(v)&&(v=U.selectColor!=null?U.selectColor:t.white),n(w)&&(w=U.selectPoints!=null?U.selectPoints:X),this.circleColor=C,this.circleBorderColor=d,this.stickColor=x,this.stickThickness=P,n(A)&&(A=U.onTop!=null?U.onTop:!0),n(b)&&(b=U.editPoints!=null?U.editPoints:X),n(Y)&&(Y=U.strokeObj!=null?U.strokeObj:{});var c=h(e,r);this.veeObj={color:c[0],borderColor:c[1]};function h(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r);var o=this;this.interactive=X,this.num=K,this.editPoints=b,this.selectPoints=w,this.lockControls=k,this.onTop=A,this.move=T,this.allowToggle=O,this.lockControlType=u,this.types=["mirror","straight","free","none"];var I,N,p;o._color=e,o._borderColor=r,o._borderWidth=i,o._dashed=E,o._dashed&&!Array.isArray(o._dashed)&&(o._dashed=[10,10]);var L,we,B,F,fe,se=o.move,Q=2,te,le;l=Ae(l);function Ae(z){(z=="circle"||z=="rectangle"||z=="triangle")&&(z=="circle"&&(z=new t.Circle(a)),z=="rectangle"&&(z=new t.Rectangle(a*2,a*2).centerReg({add:!1})),z=="triangle"&&(z=new t.Triangle(a*2,a*2,a*2)));var pe;if(z.type=="Circle"||z.type=="Rectangle"||z.type=="Triangle"||z.type=="Flare"){var de=z.getBounds();if(z.type=="Circle")pe=4,ne=s=a*2*.5523;else if(z.type=="Rectangle")z.centerReg({add:!1}),pe=[[de.x-de.width/2,de.y-de.height/2],[de.x+de.width/2,de.y-de.height/2],[de.x+de.width/2,de.y+de.height/2],[de.x-de.width/2,de.y+de.height/2]],o.setBounds(de.x-de.width/2,de.y-de.height/2,de.width,de.height),o.regX=z.regX-de.width/2,o.regY=z.regY-de.height/2;else if(z.type=="Triangle")pe=[[z.three.x-z.width/2,z.three.y+z.height/2+z.adjusted],[z.two.x-z.width/2,z.two.y+z.height/2+z.adjusted],[z.one.x-z.width/2,z.one.y+z.height/2+z.adjusted]],o.setBounds(de.x-de.width/2,de.y-de.height/2,de.width,de.height);else if(z.type=="Flare"){var oe=de.width/2+de.x,Be=de.height/2+de.y;pe=[];var $=t.copy(z.points),Me={x:null,y:null};t.loop($,(be,me)=>{var re=Math.round(be.x),ke=Math.round(be.y);re==Me.x&&ke==Me.y||(Me={x:re,y:ke},pe.push([re-oe,be.y-Be]))}),o.setBounds(-z.width/2,-z.height/2,z.width,z.height)}return pe}else return z}if(typeof l=="string"){var J=new t.SVGContainer;l=J.processPath(l),l[0][0]==l[l.length-1][0]&&l[0][1]==l[l.length-1][1]&&(l[0][4]=l[l.length-1][4],l[0][5]=l[l.length-1][5],l.pop())}V&&typeof l!="number"&&t.loop(l,function(z){z[8]=V,V=="none"&&(z[4]=z[5]=z[6]=z[7]=0)}),Te();function Te(){if(le&&le.removeAllEventListeners(),o.selectPoints?(o.selectedBalls=new t.SelectionSet,o.selectedRect1s=new t.SelectionSet,o.selectedRect2s=new t.SelectionSet,o.selectionManager=new t.SelectionManager([o.selectedBalls,o.selectedRect1s,o.selectedRect2s],"ctrl",!1)):o.selectionManager=new t.SelectionManager(null,"ctrl"),K=typeof l=="number"?l:l.length,K<=0)return;n(ne)&&(s=a*4/K),L=o.shape=new t.Shape({style:!1}).addTo(o);var z=o.sticks=new t.Shape({style:!1}).addTo(o);g<=0&&z.removeFrom();var pe=L.graphics;pe.c();var de=z.graphics;de.c();var oe=g/10*8,Be=g,$=t.mobile();le=o.controls=new t.Container({style:!1}).addTo(o),o.interactive&&le.drag({onTop:!$}),I=[],p=[],N=[];var Me,be,me,re,ke,Re,Ye,$e,it;for(Me=0;Me<K;Me++){if(re=new t.Container({style:!1}).addTo(le),re.num=Me,typeof l=="number"){var Le=t.Pick.choose(s);me=new t.Container(Le,a,null,null,!1).reg(Le/2,a).addTo(o),me.rotation=Me/K*360,Ye=new t.Circle(oe,o.selectPoints&&o.selectedBalls.isSelected(Me)?v:o.circleColor,o.circleBorderColor,2,null,null,null,null,!1).centerReg(me).loc({x:Le/2,y:0}),ke=new t.Rectangle(Be,Be,o.selectPoints&&o.selectedRect1s.isSelected(Me)?v:Ke(f),g==0?null:t.dark,g==0?null:2,null,null,null,null,!1).centerReg(me).loc({x:0,y:0}),Re=new t.Rectangle(Be,Be,o.selectPoints&&o.selectedRect2s.isSelected(Me)?v:Ke(f),g==0?null:t.dark,g==0?null:2,null,null,null,null,!1).centerReg(me).loc({x:Le,y:0});var Ze=me.localToLocal(Ye.x,Ye.y,le);Ye.x=Ze.x,Ye.y=Ze.y,Ye.addTo(re,null,!1);var ze=me.localToLocal(ke.x,ke.y,le);ke.x=f=="none"?0:ze.x-Ye.x,ke.y=f=="none"?0:ze.y-Ye.y,ke.addTo(re,null,!1);var ve=me.localToLocal(Re.x,Re.y,le);Re.x=f=="none"?0:ve.x-Ye.x,Re.y=f=="none"?0:ve.y-Ye.y,Re.addTo(re,null,!1),re.x=Ye.x,re.y=Ye.y,Ye.x=0,Ye.y=0,f=="none"&&Ye.addTo(re,null,!1)}else it=l[Me],$e=it[8]?it[8]:f,re.loc({x:it[0],y:it[1]}),Ye=new t.Circle(oe,o.circleColor,o.circleBorderColor,2,null,null,null,null,!1).centerReg({add:!1}).addTo(re).loc({x:it[2],y:it[3]}),ke=new t.Rectangle(Be,Be,Ke($e),g==0?null:t.dark,g==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(re,0).loc({x:it[4],y:it[5]}),Re=new t.Rectangle(Be,Be,Ke($e),g==0?null:t.dark,g==0?null:2,null,null,null,null,!1).centerReg({add:!1}).addTo(re,0).loc({x:it[6],y:it[7]});Ye.mySet=re,Ye.rect1=ke,Ye.rect2=Re,Ye.index=Me,g==0&&(Ye.expand(10),ke.expand(10),Re.expand(10)),$?Ye.on("mousedown",ae):Ye.on("dblclick",Ne),ke.ball=Ye,ke.other=Re,Re.ball=Ye,Re.other=ke,$&&(Ye.expand(),ke.expand(),Re.expand()),be=[re,Ye,ke,Re,it?it[8]:f],I.push(be),N.push(Ye),p.push(re)}var Pe=!1;function ae(Ie){Pe?(Ie.preventDefault(),Ne(Ie)):(Pe=!0,setTimeout(function(){Pe=!1},300))}function Ne(Ie){if(!o.lockControlType){var _e=Ie.target,Je=I[_e.index][4]?I[_e.index][4]:f;Math.abs(_e.rect1.x)<=2&&Math.abs(_e.rect1.y)<=2&&Math.abs(_e.rect2.x)<=2&&Math.abs(_e.rect2.y)<=2&&(Je="none"),Je=="none"&&_e.parent.addChildAt(_e,0),Je=o.types[(o.types.indexOf(Je)+(o.shiftKey?-1:1)+o.types.length)%o.types.length],Je=="none"&&(_e.rect1.x=_e.rect1.y=_e.rect2.x=_e.rect2.y=0,_e.parent.addChild(_e),Ie.stopImmediatePropagation()),I[_e.index][4]=Je,_e.rect1.color=Ke(Je),_e.rect2.color=Ke(Je),o.drawShape();var Oe=new Fe.Event("change");Oe.controlType="bezierSwitch",o.dispatchEvent(Oe),_e.stage.update()}}function Ke(Ie){var _e={mirror:"#993399",free:"#ebcb35",none:"#50c4b7"};return _e[Ie]?_e[Ie]:"#e472c4"}o.drawShape=function(){var Ie,_e,Je,Oe,Ve,rt,Ce,We,lt,Ue,ct,ot,dt;pe.c(),o.colorCommand||(o.colorCommand=pe.f(o._color).command,e&&e.type&&o.specialColor(o.colorCommand,e,o)),(n(o._borderWidth)||o._borderWidth>0)&&(!n(o._borderColor)||!n(o._borderWidth))&&(n(o._borderColor)&&(o._borderColor=t.black),o.borderColorCommand||(o.borderColorCommand=pe.s(o._borderColor).command,o._borderColor&&o._borderColor.type&&o.specialColor(o.borderColorCommand,o._borderColor,o)),o.borderWidthCommand||(o.borderWidthCommand=pe.ss(o._borderWidth,Y.caps,Y.joints,Y.miterLimit,Y.ignoreScale).command),o._dashed&&(o.borderDashedCommand||(o.borderDashedCommand=pe.sd(Array.isArray(o._dashed)?o._dashed:[10,10],o._dashedOffset).command))),Je=I[0][0],Ce=Je.localToLocal(I[0][1].x,I[0][1].y,L),pe.mt(Ce.x,Ce.y),de.c().s(o.stickColor).ss(o.stickThickness);for(var et=0;et<I.length;et++)Ie=et,_e=(et+1)%I.length,Je=I[Ie][0],Ye=I[Ie][1],Oe=I[Ie][2],Ve=I[Ie][3],rt=I[_e][0],We=I[_e][1],lt=I[_e][2],ct=Je.localToLocal(Ve.x,Ve.y,L),ot=rt.localToLocal(lt.x,lt.y,L),dt=rt.localToLocal(We.x,We.y,L),pe.bt(ct.x,ct.y,ot.x,ot.y,dt.x,dt.y),Ce=Je.localToLocal(Ye.x,Ye.y,L),Ue=Je.localToLocal(Oe.x,Oe.y,L),de.mt(Ce.x,Ce.y).lt(Ue.x,Ue.y),de.mt(Ce.x,Ce.y).lt(ct.x,ct.y);pe.cp(),pe.append(o.colorCommand),o._dashed&&pe.append(o.borderDashedCommand),o.borderWidthCommand&&pe.append(o.borderWidthCommand),o.borderColorCommand&&pe.append(o.borderColorCommand)},o.drawShape(),e.type&&(o.color=e);var Xe;le.on("mousedown",function(Ie){if(!o.lockControls){o.selectPoints&&(o.keyFocus=!0),Xe={x:Ie.target.x,y:Ie.target.y};var _e;if(Ie.target.rect1)_e=Ie.target,_e.startX=_e.x,_e.startY=_e.y,_e.rect1.startX=_e.rect1.x,_e.rect1.startY=_e.rect1.y,_e.rect2.startX=_e.rect2.x,_e.rect2.startY=_e.rect2.y;else{var Je=Ie.target;Je.startX=Je.x,Je.startY=Je.y,_e=Je.ball;var Oe=_e.index,Ve=f;if(n(I[Oe][4])||(Ve=I[Oe][4]),Ve=="straight"){var rt=Je.other,Ce=rt.x-_e.x,We=rt.y-_e.y;rt.stickLength=Math.sqrt(Math.pow(Ce,2)+Math.pow(We,2))}}if(o.selectPoints){var lt=o.selectionManager.currentSet;if(lt&&lt.selections&&lt.selections.length>0)for(var Ue=0;Ue<lt.selections.length;Ue++){var ct=o.pointObjects[lt.selections[Ue]];ct[1].startX=ct[1].x,ct[1].startY=ct[1].y,ct[2].startX=ct[2].x,ct[2].startY=ct[2].y,ct[3].startX=ct[3].x,ct[3].startY=ct[3].y}}}}),o.selectPoints&&le.tap(function(Ie){var _e;if(Ie.target.rect1)_e=Ie.target,o.selectedBalls.toggle(_e.parent.num);else{var Je=Ie.target;Je.color="white",_e=Je.ball,_e.rect1==Je?o.selectedRect1s.toggle(_e.parent.num):o.selectedRect2s.toggle(_e.parent.num)}for(var Oe=0;Oe<o.pointObjects.length;Oe++){var Ve=o.pointObjects[Oe];Ve[1].color=o.selectedBalls.isSelected(Oe)?v:o.circleColor,Ve[2].color=o.selectedRect1s.isSelected(Oe)?v:Ke(Ve[4]),Ve[3].color=o.selectedRect2s.isSelected(Oe)?v:Ke(Ve[4])}Ie.target.stage.update()}),le.on("pressmove",function(Ie){if(!o.lockControls)if(o.selectPoints){var _e=G();if(_e.indexOf(Ie.target)==-1)te(Ie.target),o.drawShape();else if(_e.length>0){for(var Je=Ie.target.x-Ie.target.startX,Oe=Ie.target.y-Ie.target.startY,Ve=0;Ve<_e.length;Ve++){var rt=_e[Ve];rt.x=rt.startX+Je,rt.y=rt.startY+Oe,te(rt)}o.drawShape()}}else te(Ie.target),o.drawShape()}),le.on("pressup",function(Ie){if(!o.lockControls){var _e=Ie.target.x!=Xe.x||Ie.target.y!=Xe.y,Je=new Fe.Event("change");Ie.target.rect1?(Je.controlType="bezierPoint",Qe(Ie.target)):Je.controlType="bezierHandle",_e&&o.dispatchEvent(Je)}});function Qe(Ie){if(o.selectPoints){var _e=G();if(_e&&_e.indexOf(Ie)==-1)ce(Ie);else if(_e&&_e.length>0)for(var Je=0;Je<_e.length;Je++)ce(_e[Je]);else ce(Ie)}else ce(Ie)}o.changeControl=function(Ie,_e,Je,Oe,Ve,rt,Ce,We,lt){var Ue="index, type, rect1X, rect1Y, rect2X, rect2Y, circleX, circleY, update",ct;if(ct=st(o.changeControl,arguments,Ue))return ct;if(n(Ie)){for(var ot=0;ot<I.length;ot++)o.changeControl(ot,_e,Je,Oe,Ve,rt,Ce,We);return o}var dt=I[Ie];return dt[4]=_e,_e=="none"?(n(Ce)||(dt[1].x=Ce),n(We)||(dt[1].y=We),dt[2].x=dt[1].x,dt[2].y=dt[1].y,dt[3].x=dt[1].x,dt[3].y=dt[1].y,dt[1].parent.addChild(dt[1])):(n(Ce)||(dt[1].x=Ce),n(We)||(dt[1].y=We),n(Je)||(dt[2].x=Je),n(Oe)||(dt[2].y=Oe),n(Ve)||(dt[3].x=Ve),n(rt)||(dt[3].y=rt),dt[1].parent.addChildAt(dt[1],0)),dt[2].color=Ke(_e),dt[3].color=Ke(_e),lt&&(o.update(),o.stage&&o.stage.update()),o},o.transformPoints=function(Ie,_e,Je,Oe,Ve){return n(Ve)&&(Ve=!0),o.points=t.transformPoints(o.points,Ie,_e,Je,Oe),Ve&&o.approximateBounds(),o},o.traverse=function(Ie,_e,Je,Oe,Ve){var rt=t.copy(o.segmentRatios);rt.unshift(0),n(Je)&&(Je=_e+1);var Ce=rt[_e]*100,We=rt[Je]*100,lt;!Ve&&Ce>We?lt=100-Ce+We:!Ve&&Ce<We?lt=We-Ce:Ve&&Ce>We?lt=-(Ce-We):Ve&&Ce<We&&(lt=-(100-We+Ce));var Ue=new Fe.Event("traversed");return Ue.obj=Ie,Ie.animate({ease:"linear",props:{path:o,startPercent:Ce,percent:lt},time:Oe,call:function(){o.dispatchEvent(Ue)}}),o},o.reversePoints=function(Ie){return n(Ie)&&(Ie=!0),l=t.copy(o.points),l.reverse(),Ie&&l.unshift(l.pop()),t.loop(l,function(_e){var Je=_e[6];_e[6]=_e[4],_e[4]=Je;var Oe=_e[7];_e[7]=_e[5],_e[5]=Oe}),o.points=l,o.update(),o},o.splitPoints=function(Ie){var _e=t.copy(o.points);if(!(Ie<1||Ie>_e.length-1)){var Je=t.copy(_e.slice(0,Ie+1)),Oe=t.copy(_e.slice(Ie));t.trimPointEnds(Je),t.trimPointEnds(Oe);var Ve=o.clone();return o.points=Je,o.update(),Ve.points=Oe,o.parent&&Ve.addTo(o.parent),Ve}},o.makeSquiggle=function(Ie){var _e=t.copy(o.points);n(Ie)&&(Ie=0),Ie=(Ie+_e.length*1e3)%_e.length;var Je=t.copy(_e.slice(Ie)),Oe=t.copy(_e.slice(0,Ie+1));_e=Je.concat(Oe),t.trimPointEnds(_e);var Ve=new t.Squiggle({points:_e,color:o.borderColor,thickness:o.borderWidth,showControls:o.controlsVisible,interactive:o.interactive,onTop:o.onTop,dashed:o.dashed,stickColor:o.stickColor,stickThickness:o.stickThickness});return Ve},o.update=function(Ie){return Ie?o.points=o.pointsAdjusted:o.drawShape(),o.zimAnimateChanged=!0,o},o.move&&o.interactive&&L.drag({onTop:!1}),we=L.on("mousedown",function(Ie){fe=Ie.target.stage,Xe={x:L.x,y:L.y},o.selectPoints&&(o.keyFocus=!0),he()}),B=L.on("pressmove",function(){le.x=L.x,le.y=L.y,z.x=L.x,z.y=L.y}),F=L.on("pressup",function(){var Ie=L.x!=Xe.x||L.y!=Xe.y,_e=L.localToLocal(o.regX,o.regY,o.parent);if(o.x=_e.x,o.y=_e.y,le.x=le.y=z.x=z.y=L.x=L.y=0,Ie){var Je=new Fe.Event("change");Je.controlType="move",o.dispatchEvent(Je)}fe.update()}),T||ue(!0);function he(){if(o.onTop){var Ie=o.parent.numChildren-1;o.parent.getChildAt(Ie).type=="Keyboard"&&Ie--,o.parent.setChildIndex(o,Ie)}}o.toggleEvent=o.on("mousedown",function(){o.allowToggle&&(D||(o.showControls(),o.dispatchEvent("controlsshow")))}),o.added(function(){fe=o.stage,o.toggleStageEvent&&o.stage.off("stagemousedown",o.toggleStageEvent),o.toggleStageEvent=o.stage.on("stagemousedown",function(Ie){!o.allowToggle||!o.stage||D&&!o.hitTestPoint(Ie.stageX/t.scaX,Ie.stageY/t.scaY,!1)&&(o.hideControls(),o.dispatchEvent("controlshide"))})}),o.clickEvent=o.on("click",function(){o.ctrlKey&&setTimeout(function(){o.clone(!0).addTo(o.stage).mov(100),o.allowToggle&&(o.hideControls(),o.dispatchEvent("controlshide"));var Ie=new Fe.Event("change");Ie.controlType="move",o.dispatchEvent(Ie),o.stage.update()},50)}),o.hideControls=function(){return o.toggled=!1,le.visible=!1,z.visible=!1,D=!1,o.stage&&o.stage.update(),!o.allowToggle&&o.move&&ue(),o},D||o.hideControls(),o.showControls=function(){return o.toggled=!0,le.visible=!0,z.visible=!0,D=!0,le.x=L.x,le.y=L.y,z.x=L.x,z.y=L.y,o.addChildAt(L,0),o.move&&!o.allowToggle&&q(),o.stage&&o.stage.update(),o},o.toggle=function(Ie){return Ie===!0?o.showControls():Ie===!1||D?o.hideControls():o.showControls(),o},o.recordData=function(Ie){n(Ie)&&(Ie=!1);var _e={type:"Blob",index:o.parent?o.parent.getChildIndex(o):-1,x:o.x,y:o.y,points:o.getPoints(),color:o.color,borderColor:o.borderColor,borderWidth:o.borderWidth,move:o.move,allowToggle:o.allowToggle,controlsVisible:D};return Ie?JSON.stringify(_e):_e},o.setData=function(Ie,_e){if(!n(Ie)){if(_e)try{Ie=JSON.parse(Ie)}catch (e9){return}var Je=Ie.index;n(Je)&&(Je=-1),delete Ie.index;var Oe=Ie.points;n(Oe)||o.setPoints(Oe),delete Ie.points,this.num=Oe.length;for(var Ve in Ie)o[Ve]=Ie[Ve];return o.parent&&o.parent.setChildIndex(o,Je),o}},o.getPoints=function(Ie){n(Ie)&&(Ie=!1);var _e=o.points;if(Ie){if(!Je){var Je=o.pane=new t.Pane({displayClose:!1,container:o.stage,width:Math.min(500,o.stage.width-20),height:Math.min(500,o.stage.height-20),draggable:!0}),Oe=o.textArea=new t.TextArea(Math.min(400,o.stage.width-70),Math.min(400,o.stage.height-70));Oe.centerReg(Je)}Je.show(),Oe.text=JSON.stringify(_e)}return _e},o.recordPoints=o.getPoints,o.setPoints=function(Ie){for(var _e,Je,Oe=0;Oe<Ie.length;Oe++)_e=I[Oe],Je=Ie[Oe],!n(_e)&&(_e[0].x=Je[0],_e[0].y=Je[1],_e[1].x=Je[2],_e[1].y=Je[3],_e[2].x=Je[4],_e[2].y=Je[5],_e[3].x=Je[6],_e[3].y=Je[7],_e[4]=Je[8],_e[2].color=Ke(_e[4]),_e[3].color=Ke(_e[4]));return o.update(),o},m!==!1&&t.styleTransforms(o,U),o.clone=function(Ie,_e){var Je=[],Oe=!1;t.loop(o.pointControls,function(rt){rt.scaleX+rt.scaleY+rt.regX+rt.regY+rt.rotation!=2&&(Oe=!0),Je.push([rt.scaleX,rt.scaleY,rt.regX,rt.regY,rt.rotation])});var Ve=o.cloneProps(new t.Blob(_e?o.colorCommand:Ie||!t.isPick(c[0])?o.color:c[0],_e?o.borderColorCommand:Ie||!t.isPick(c[1])?o.borderColor:c[1],o.borderWidth,o.getPoints(),a,s,f,u,le.visible,k,g,o.allowToggle,o.move,E,A,o.circleColor,o.circleBorderColor,o.stickColor,o.stickThickness,v,w,o.editPoints,X,Y,m,o.group,S));return Oe&&(t.loop(Ve.pointControls,function(rt,Ce){rt.scaleX=Je[Ce][0],rt.scaleY=Je[Ce][1],rt.regX=Je[Ce][2],rt.regY=Je[Ce][3],rt.rotation=Je[Ce][4]}),Ve.update()),o.linearGradientParams&&Ve.linearGradient.apply(Ve,o.linearGradientParams),o.radialGradientParams&&Ve.radialGradient.apply(Ve,o.radialGradientParams),Ve},o.shapeMousedownEvent=o.shape.on("mousedown",function(Ie){fe=Ie.target.stage,o.editPoints&&(o.controlsVisible?(o.pressX=Ie.stageX/t.scaX,o.pressY=Ie.stageY/t.scaY):(o.pressX=null,o.pressY=null))}),o.addPointFactor=10,o.addMinDistance=15,o.shapePressupEvent=o.shape.on("pressup",function(Ie){if(o.editPoints&&o.pressX&&Math.abs(o.pressX-Ie.stageX/t.scaX)<Q&&Math.abs(o.pressY-Ie.stageY/t.scaY)<Q){o.selectPoints&&(o.lastPoints=t.copy(o.points));var _e=o.points,Je=o.globalToLocal(Ie.stageX/t.scaX,Ie.stageY/t.scaY),Oe=t.closestPointAlongCurve(Je,o.segmentPoints);if(o.editPoints=="anywhere")_e.splice(Oe+1,0,[Je.x,Je.y,0,0,0,0,0,0]),o.points=_e,o.changeControl({index:Oe+1,type:"mirror",update:!0});else{var Ve=o.pointsAdjusted,rt=o.getSegmentPoint(Ve[Oe],Ve[(Oe+1)%Ve.length]),Ce=t.distanceAlongCurve(rt),We=Math.round(Ce/o.addPointFactor),lt=o.interpolate(We,Oe,!1,_e),Ue=1e4,ct;if(t.loop(lt,function(St,ht){if(ht!=0){var gt=t.dist(St,Je);gt<Ue&&(Ue=gt,ct=ht)}}),Ue<o.addMinDistance){var ot=o.segmentRatios,dt=ot[Oe],et=Oe>0?ot[Oe-1]:0;o.addPoint(100*(et+(dt-et)*(ct/(We+1))))}}o.lastSelectedIndex=Oe+1,o.lastSelected=o.controls.getChildAt(o.lastSelectedIndex),o.stage.update()}}),o.controlsClickEvent=o.controls.on("click",function(Ie){o.lastSelected=Ie.target.parent,o.lastSelectedIndex=o.controls.getChildIndex(Ie.target.parent),o.editPoints&&o.selectionManager.shiftKey&&Ge(Ie)});function Ge(Ie){if(Ie.target.type=="Circle"){var _e=o.lastSelectedIndex=o.controls.getChildIndex(Ie.target.parent);if(o.controls.numChildren<=2)return;var Je=o.points;o.selectPoints&&(o.lastPoints=t.copy(Je)),Je.splice(_e,1),o.points=Je,o.stage.update(),o.lastSelected=o.lastSelectedIndex=null}}o.controls.hold(Ge),D||o.hideControls(),o.dispatchEvent("update")}function G(){var z=[],pe=o.selectionManager.currentSet;if(pe&&pe.selections&&pe.selections.length>0)for(var de=0;de<pe.selections.length;de++){var oe=o.pointObjects[pe.selections[de]];if(pe==o.selectedBalls)z.push(oe[1]);else if(pe==o.selectedRect1s)z.push(oe[2]);else if(pe==o.selectedRect2s)z.push(oe[3]);else continue}return z}function ce(z){if(o.selectPoints&&z.type=="Circle"){var pe=z,de=pe.mySet,oe=pe.rect1,Be=pe.rect2;oe.x-=pe.x,oe.y-=pe.y,Be.x-=pe.x,Be.y-=pe.y,de.x+=pe.x,de.y+=pe.y,pe.x=0,pe.y=0}}o.selectionManager.on("keydown",function(z){if(o.selectPoints&&o.keyFocus&&z.keyCode>=37&&z.keyCode<=40){var pe=G();if(pe.length>0){for(var de=0;de<pe.length;de++){var oe=pe[de];z.keyCode==37?oe.x-=o.selectionManager.shiftKey?10:1:z.keyCode==39?oe.x+=o.selectionManager.shiftKey?10:1:z.keyCode==38?oe.y-=o.selectionManager.shiftKey?10:1:z.keyCode==40&&(oe.y+=o.selectionManager.shiftKey?10:1),te(oe)}o.drawShape(),o.dispatchEvent("update"),o.stage&&o.stage.update()}}}),o.selectionManager.on("keyup",function(z){if(o.selectPoints&&o.keyFocus&&z.keyCode>=37&&z.keyCode<=40){var pe=G();if(pe.length>0)for(var de=0;de<pe.length;de++)ce(pe[de])}}),o.selectionManager.on("undo",function(){if(o.selectPoints&&o.keyFocus&&o.lastPoints){var z=t.copy(o.lastPoints);o.lastPoints=t.copy(o.points),o.points=z,o.stage&&o.stage.update()}}),te=function(z){if(!o.lockControls){var pe;if(z.rect1){pe=z;var de=pe.x-pe.startX,oe=pe.y-pe.startY;pe.rect1.x=pe.rect1.startX+de,pe.rect1.y=pe.rect1.startY+oe,pe.rect2.x=pe.rect2.startX+de,pe.rect2.y=pe.rect2.startY+oe}else{var Be=z,$=Be.other;pe=Be.ball;var Me=pe.index,be=f;if(n(I[Me][4])||(be=I[Me][4]),be=="straight"||be=="mirror"){var me=Be.x-pe.x,re=Be.y-pe.y;if(be=="mirror")$.x=pe.x-me,$.y=pe.y-re;else{var ke=Math.atan2(re,me),Re=-$.stickLength*Math.cos(ke+Math.PI),Ye=-$.stickLength*Math.sin(ke+Math.PI);$.x=pe.x-Re,$.y=pe.y-Ye}}}}},Object.defineProperty(o,"move",{get:function(){return T},set:function(z){T!=z&&(T=z,z?q():ue())}}),Object.defineProperty(o,"interactive",{get:function(){return X},set:function(z){X=z,D=X,o.allowToggle=X,o.editPoints=X,o.lockControls=!X,o.selectPoints=X,o.move=X;var pe=o.points;o.points=pe}}),Object.defineProperty(o,"allowToggle",{get:function(){return O},set:function(z){O!=z&&(O=z,O?o.move&&q():!D&&o.move&&ue())}});function q(){o.move!="always"&&(se||(se=!0,L.drag({onTop:!1}),we=L.on("mousedown",we),B=L.on("pressmove",B),F=L.on("pressup",F)))}function ue(z){o.move!="always"&&(!z&&!se||(se=!1,L.noDrag(),L.off("mousedown",we),L.off("pressmove",B),L.off("pressup",F)))}Object.defineProperty(o,"controlsVisible",{get:function(){return D},set:function(z){D=z,z?o.showControls():o.hideControls()}});var ge=k;Object.defineProperty(o,"lockControls",{get:function(){return ge},set:function(z){ge=z,z?(o.controls.mouseChildren=!1,o.controls.mouseEnabled=!1):(o.controls.mouseChildren=!0,o.controls.mouseEnabled=!0)}}),o.lockControls=ge,ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==o},set:function(){t.KEYFOCUS=o}}),o.selectPoints&&!t.KEYFOCUS&&ie();function ie(){o.keyFocus=!0;var z=document.activeElement;z&&z.blur()}Object.defineProperty(o,"points",{get:function(){for(var z=[],pe,de,oe=0;oe<I.length;oe++)de=I[oe],pe=[t.decimals(de[0].x),t.decimals(de[0].y),t.decimals(de[1].x),t.decimals(de[1].y),t.decimals(de[2].x),t.decimals(de[2].y),t.decimals(de[3].x),t.decimals(de[3].y)],de[4]&&de[4]!=="straight"&&pe.push(de[4]),z.push(pe);return z},set:function(z){var pe=o.x,de=o.y,oe=o.visible,Be=[],$=!1;t.loop(o.pointControls,function(Me){Me.scaleX+Me.scaleY+Me.regX+Me.regY+Me.rotation!=2&&($=!0),Be.push([Me.scaleX,Me.scaleY,Me.regX,Me.regY,Me.rotation])}),o.dispose(!0),l=Ae(z),o.shape&&(o.shape.graphics.clear(),o.sticks.graphics.clear(),o.controls.noDrag(),o.removeAllChildren(),delete o.shape,delete o.sticks,delete o.controls),o.visible=!1,Te(),o.lockControls=ge,o.x=pe,o.y=de,o.visible=oe,$&&(t.loop(o.pointControls,function(Me,be){Me.scaleX=Be[be][0],Me.scaleY=Be[be][1],Me.regX=Be[be][2],Me.regY=Be[be][3],Me.rotation=Be[be][4]}),o.update())}}),Object.defineProperty(o,"pointsAdjusted",{get:function(){var z=[],pe,de,oe,Be=o.pointObjects;return t.loop(Be.length,function($){if(oe=Be[$],de=I[$],oe[0].rotation==0&&oe[0].scaleX==0&&oe[0].scaleY==0)pe=[t.decimals(de[0].x),t.decimals(de[0].y),t.decimals(de[1].x),t.decimals(de[1].y),t.decimals(de[2].x),t.decimals(de[2].y),t.decimals(de[3].x),t.decimals(de[3].y)];else{var Me=oe[0].localToLocal(oe[2].x,oe[2].y,oe[0].parent),be=oe[0].localToLocal(oe[3].x,oe[3].y,oe[0].parent);pe=[t.decimals(de[0].x),t.decimals(de[0].y),t.decimals(de[1].x),t.decimals(de[1].y),t.decimals(Me.x-de[0].x),t.decimals(Me.y-de[0].y),t.decimals(be.x-de[0].x),t.decimals(be.y-de[0].y)]}de[4]&&de[4]!=="mirror"&&pe.push(de[4]),z.push(pe)}),z},set:function(){vt&&tt("Blob() - pointsAdjusted is read only")}}),Object.defineProperty(o,"pointObjects",{get:function(){return I},set:function(){vt&&tt("Blob() - pointObjects is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"pointControls",{get:function(){return p},set:function(){vt&&tt("Blob() - pointControls is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"pointCircles",{get:function(){return N},set:function(){vt&&tt("Blob() - pointCircles is read only - but its contents can be manipulated - use blob.update() after changes")}}),Object.defineProperty(o,"segmentPoints",{get:function(){var z=o.pointsAdjusted,pe=[];return t.loop(z.length,function(de,oe){var Be=o.getSegmentPoint(z[de],z[de<oe-1?de+1:0]);pe.push(Be)}),pe},set:function(){vt&&tt("Blob() - segmentPoints is read only")}}),Object.defineProperty(o,"segmentRatios",{get:function(){var z=[],pe=0;t.loop(o.segmentPoints,function(Be){var $=t.distanceAlongCurve(Be);z.push($),pe+=$});var de=[],oe=0;return t.loop(z,function(Be){var $=Be/pe;oe+=$,de.push(oe)}),de},set:function(){vt&&tt("Blob() - segmentRatios is read only")}}),o.approximateBounds=function(z,pe){n(z)&&(z=80),z/=o.num;var de=o.interpolate(z,null,!0,null,!0),oe=t.boundsAroundPoints(de);if(o.setBounds(oe.x,oe.y,oe.width,oe.height),pe){if(!o.parent)return vt&&tt("approximateBounds() - add to stage to first to see points"),o;o.hitPathPoints?o.hitPathPoints.removeAllChildren():o.hitPathPoints=new t.Container().addTo(),o.hitPathPoints.top();for(var Be=0;Be<de.length;Be++){var $=de[Be];$=o.localToGlobal($.x,$.y),new t.Circle(3).loc($.x,$.y,o.hitPathPoints)}}return o},o.getPointAngle=function(z){var pe=o.pointObjects[z][0],de=o.pointObjects[z][2],oe=o.pointObjects[z][3],Be,$;return pe==o.stage?(Be=new t.Point(de.x,de.y),$=new t.Point(oe.x,oe.y)):(Be=pe.localToGlobal(de.x,de.y),$=pe.localToGlobal(oe.x,oe.y)),t.angle(Be.x,Be.y,$.x,$.y)},o.getSegmentPoint=function(z,pe){if(!(n(z)||n(pe))){(z[2]!=0||z[3]!=0)&&(z[4]-=z[2],z[5]-=z[3],z[6]-=z[2],z[7]-=z[3],z[0]+=z[2],z[1]+=z[3],z[2]=0,z[3]=0),(pe[2]!=0||pe[3]!=0)&&(pe[4]-=pe[2],pe[5]-=pe[3],pe[6]-=pe[2],pe[7]-=pe[3],pe[0]+=pe[2],pe[1]+=pe[3],pe[2]=0,pe[3]=0);var de={x:z[0],y:z[1]},oe={x:z[0]+z[6],y:z[1]+z[7]},Be={x:pe[0]+pe[4],y:pe[1]+pe[5]},$={x:pe[0],y:pe[1]};return(le.x!=0||le.y!=0)&&(de.x+=le.x,oe.x+=le.x,Be.x+=le.x,$.x+=le.x,de.y+=le.y,oe.y+=le.y,Be.y+=le.y,$.y+=le.y),[de,oe,Be,$]}},o.getAdjacentSegmentData=function(z){n(z)&&(z=0);var pe=o.pointsAdjusted;if(o.num==2)return[[o.getSegmentPoint(pe[0],pe[1]),o.getSegmentPoint(pe[1],pe[0])],[0,1]];if(z==0)return[[o.getSegmentPoint(pe[o.num-1],pe[0]),o.getSegmentPoint(pe[0],pe[1]),o.getSegmentPoint(pe[1],pe[2])],[o.num-1,0,1]];if(z>=o.num-1)return[[o.getSegmentPoint(pe[o.num-2],pe[o.num-1]),o.getSegmentPoint(pe[o.num-1],pe[0]),o.getSegmentPoint(pe[0],pe[1])],[o.num-2,o.num-1,0]];var de=z+2>=o.num?0:z+2;return[[o.getSegmentPoint(pe[z-1],pe[z]),o.getSegmentPoint(pe[z],pe[z+1]),o.getSegmentPoint(pe[z+1],pe[de])],[z-1,z,z+1]]},o.getCurvePoint=function(z,pe,de,oe){n(pe)&&(pe=o.segmentRatios),n(de)&&(de=o.segmentPoints),n(oe)&&(oe=!1);var Be=pe,$=de,Me=t.loop(Be,function(Ye,$e){if(Ye>=z)return $e}),be=Me>0?Be[Me-1]:0,me=Me>0?Be[Me]-Be[Me-1]:Be[Me],re=(z-be)/me,ke=t.pointAlongCurve($[Me],re,oe,!0);if(!n(ke)){var Re=o.localToGlobal(ke.x,ke.y);return Re.angle=ke.angle,Re.z=Me,n(Re)?void 0:Re}};function xe(z,pe,de){return{x:z.x+(pe.x-z.x)*de,y:z.y+(pe.y-z.y)*de}}function Se(z,pe,de,oe,Be,$,Me,be){var me=z.length-1,re=0,ke=0;oe==100&&o.type=="Squiggle"&&(oe=99.99),oe=(oe+1e5)%100,t.loop(de,function(Ke,Xe){if(oe/100<Ke)return me=Xe,ke=Ke,!0;re=Ke});var Re=o.segmentPoints[me],Ye=ke>0?(oe/100-re)/(ke-re):0,$e=t.pointAlongCurve(Re,Ye,null,be),it=[$e.x,$e.y,0,0];if(!$){if(Me){o.interpolatedPoints.push({x:$e.x,y:$e.y,r:oe/100});return}if(Be!="none"){var Le=xe(Re[0],Re[1],Ye),Ze=xe(Re[1],Re[2],Ye),ze=xe(Re[2],Re[3],Ye),ve=xe(Le,Ze,Ye),Pe=xe(Ze,ze,Ye);it[4]=ve.x-$e.x,it[5]=ve.y-$e.y,it[6]=Pe.x-$e.x,it[7]=Pe.y-$e.y;var ae=o.localToLocal(Le.x,Le.y,pe[me]);z[me][6]=ae.x,z[me][7]=ae.y;var Ne=o.localToLocal(ze.x,ze.y,pe[(me+1)%z.length]);z[(me+1)%z.length][4]=Ne.x,z[(me+1)%z.length][5]=Ne.y}Be&&(it[8]=Be),z.splice(me+1,0,it)}}this.addPoint=function(z,pe){n(z)&&(z=100);var de=o.points,oe=o.segmentRatios,Be=o.pointControls;return pe=pe||V,Se(de,Be,oe,z,pe),o.points=de,o.num=de.length,o},this.removePoint=function(z){if(!(n(z)||z<0)){var pe=t.copy(o.points);return pe.splice(z,1),o.points=pe,o.stage&&o.stage.update(),o}},this.addPoints=function(z,pe,de,oe,Be,$,Me){n($)&&($=t.copy(o.points));var be=t.copy(o.segmentRatios),me=0;if(Be&&(o.interpolatedPoints=[]),oe)var re=be.length*z;return t.loop(be,function(ke,Re){Be&&Se($,o.pointControls,o.segmentRatios,me*100,pe,!n(de)&&Re!=de,Be,Me);var Ye=oe?Math.round(re*(ke-me)):z,$e=1/(Ye+1);t.loop(Ye,function(it){var Le=me+(ke-me)*$e*(it+1);Se($,o.pointControls,o.segmentRatios,Le*100,pe,!n(de)&&Re!=de,Be,Me),!Be&&z>0&&(o.points=$)}),me=ke}),Be&&o.type=="Squiggle"&&Se($,o.pointControls,o.segmentRatios,100,pe,null,Be,Me),o.stage&&o.stage.update(),o.num=$.length,o},this.interpolate=function(z,pe,de,oe,Be){return n(z)&&(z=1),o.addPoints(z,"none",pe,de,!0,oe,Be),o.interpolatedPoints},Z&&o.approximateBounds(),this.dispose=function(z,pe,de){if(o.shape){if(t.gD(o),fe&&o.toggleStageEvent&&fe.off("stagemousedown",o.toggleStageEvent),o.controls.noDrag(),o.controls.removeAllEventListeners(),o.selectPoints&&o.selectionManager&&o.selectionManager.dispose(),o.selectedBalls=null,o.selectedRect1s=null,o.selectedRect2s=null,o.selectionManager=null,o.off("mousedown",o.toggleEvent),o.off("click",o.clickEvent),z){o.shape.dispose(),o.shape=null;for(var oe=0;oe<o.points.length;oe++)o.pointObjects[oe][0].removeAllEventListeners(),o.pointObjects[oe][1].removeAllEventListeners(),o.pointObjects[oe][2].removeAllEventListeners(),o.pointObjects[oe][3].removeAllEventListeners();o.controls.removeFrom(o),o.sticks.dispose(),I=null,N=null}else o.removeAllEventListeners(),I=null,N=null,de||this.zimCustomShape_dispose(!0);return!0}}},t.extend(t.Blob,t.CustomShape,["clone","dispose"],"zimCustomShape",!1),gi= exports.Blob =t.Blob,t.Flare=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne){var V="color, borderColor, borderWidth, crossAngle, thickness, thicknessA, thicknessB, pin, startX, startY, lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close, dashed, strokeObj, spineColor, spineBorderWidth, spineBorderColor, spineDashed, spineStrokeObj, closeColor, closeBorderWidth, closeBorderColor, closeDashed, closeStrokeObj, style, group, inherit",D;if(D=st(t.Flare,arguments,V,this))return D;De("53.6"),this.zimContainer_constructor(),this.type="Flare",this.group=K;var c=Z===!1?{}:t.getStyle(this.type,this.group,ne),h=this;n(r)&&(r=c.borderColor!=null?c.borderColor:null),n(i)&&(i=c.borderWidth!=null?c.borderWidth:null),r<0||i<0?r=i=null:r!=null&&i==null&&(i=1),n(e)&&(e=c.color!=null?c.color:i>0?"rgba(0,0,0,0)":t.black),(n(i)||i>0)&&(!n(r)||!n(i))&&n(r)&&(r=t.black),n(l)&&(l=c.crossAngle!=null?c.crossAngle:0);var o=l;l-=90,n(a)&&(a=c.thickness!=null?c.thickness:null),n(s)&&(s=c.thicknessA!=null?c.thicknessA:null),n(f)&&(f=c.thicknessB!=null?c.thicknessB:null),n(a)?n(f)&&!n(s)?f=s:n(s)&&!n(f)?s=f:f=s=10:n(f)&&!n(s)?f=a-s:n(s)&&!n(f)?s=a-f:f=s=a/2,h.thickness=s+f,n(C)&&(C=c.cross!=null?c.cross:!0),n(d)&&(d=c.crossColors!=null?c.crossColors:null),!n(d)&&!Array.isArray(d)&&(d=[d]),n(x)&&(x=c.close!=null?c.close:!1),n(y)&&(y=c.startX!=null?c.startX:0),n(k)&&(k=c.startY!=null?c.startY:0),n(g)&&(g=c.lengths!=null?c.lengths:[200]),Array.isArray(g)||(g=[g]),n(O)&&(O=c.angles!=null?c.angles:[0]),Array.isArray(O)||(O=[O]),n(T)&&(T=c.anglesA!=null?c.anglesA:[10]),Array.isArray(T)||(T=[T]),n(E)&&(E=c.anglesB!=null?c.anglesB:t.copy(T)),Array.isArray(E)||(E=[E]),n(A)&&(A=c.anglesEnd!=null?c.anglesEnd:[0]),Array.isArray(A)||(A=[A]),n(v)&&(v=c.strokeObj!=null?c.strokeObj:{miterLimit:2}),n(X)&&(X=c.spineBorderColor!=null?c.spineBorderColor:null),n(b)&&(b=c.spineBorderWidth!=null?c.spineBorderWidth:null),X<0||b<0?X=b=null:X!=null&&b==null&&(b=1),n(w)&&(w=c.spineColor!=null?c.spineColor:b>0?"rgba(0,0,0,0)":t.black),n(Y)&&(Y=c.spineDashed!=null?c.spineDashed:null),n(m)&&(m=c.spineStrokeObj!=null?c.spineStrokeObj:{miterLimit:2}),(n(b)||b>0)&&(!n(X)||!n(b))&&n(X)&&(X=r||t.black),n(_)&&(_=c.closeBorderColor!=null?c.closeBorderColor:null),n(S)&&(S=c.closeBorderWidth!=null?c.closeBorderWidth:null),_<0||S<0?_=S=null:_!=null&&S==null&&(S=1),n(j)&&(j=c.closeColor!=null?c.closeColor:S>0?"rgba(0,0,0,0)":null),n(R)&&(R=c.closeDashed!=null?c.closeDashed:null),n(U)&&(U=c.closeStrokeObj!=null?c.closeStrokeObj:{miterLimit:2}),(n(S)||S>0)&&(!n(_)||!n(S))&&n(_)&&(_=r||t.black),this.thicknessA=s,this.thicknessB=f,this.cross=C,this.close=x,this.lengths=g,this.angles=O,this.anglesA=T,this.anglesB=E,this.anglesEnd=A,this.crossColors=d,I(g,O,T,E,A,C,d,x),e.type&&(h.color=e);function I(B,F,fe,se,Q,te,le,Ae){h.removeAllChildren();var J=h.shape=new t.Shape().addTo(h);if(h.colorCommand=J.c().f(e).command,e&&e.type&&h.specialColor(h.colorCommand,e,h),(n(i)||i>0)&&(!n(r)||!n(i))&&(n(r)&&(r=t.black),h.borderColorCommand=J.s(r).command,r&&r.type&&h.specialColor(h.borderColorCommand,r,h),h.borderWidthCommand=J.ss(i,v.caps,v.joints,v.miterLimit,v.ignoreScale).command,P&&(h.borderDashedCommand=J.sd([10,10],5).command)),J.mt(0,0),b>0){var Te=h.spineShape=new t.Shape().addTo(h);h.spineColorCommand=Te.c().f(w).command,w&&w.type&&h.specialColor(h.spineColorCommand,w,h),(n(b)||b>0)&&(!n(X)||!n(b))&&(n(X)&&(X=t.black),h.spineBorderColorCommand=Te.s(X).command,X&&X.type&&h.specialColor(h.spineBorderColorCommand,X,h),h.spineBorderWidthCommand=Te.ss(b,m.caps,m.joints,m.miterLimit,m.ignoreScale).command,Y&&(h.spineBorderDashedCommand=Te.sd([10,10],5).command))}if(!n(j)){var G=h.closeShape=new t.Shape().addTo(h);h.closeColorCommand=G.c().f(j).command,j&&j.type&&h.specialColor(h.closeColorCommand,j,h),(n(S)||S>0)&&(!n(_)||!n(S))&&(n(_)&&(_=t.black),h.closeBorderColorCommand=G.s(_).command,_&&_.type&&h.specialColor(h.closeBorderColorCommand,_,h),h.closeBorderWidthCommand=G.ss(S,U.caps,U.joints,U.miterLimit,U.ignoreScale).command,R&&(h.closeBorderDashedCommand=G.sd([10,10],5).command)),J.mt(0,0)}var ce=y,q=k,ue=l,ge=ue-180,ie=s,xe=f,Se=Math.max(B.length,F.length,fe.length,se.length,Q.length),z,pe,de=ge,oe=[],Be=[],$=[];h.points=[];var Me=h.pinPoints=[];t.loop(Se,function(re){var ke=be(re),Re=Math.cos(ke.a*t.RAD),Ye=Math.sin(ke.a*t.RAD),$e=new t.Point(ce+ke.A.x*Re-ke.A.y*Ye,q+ke.A.x*Ye+ke.A.y*Re),it=new t.Point(ce+ke.B.x*Re-ke.B.y*Ye,q+ke.B.x*Ye+ke.B.y*Re),Le=new t.Point(ce+ke.C.x*Re-ke.C.y*Ye,q+ke.C.x*Ye+ke.C.y*Re),Ze=new t.Point(ce+ke.D.x*Re-ke.D.y*Ye,q+ke.D.x*Ye+ke.D.y*Re);oe.push($e,it),Be.unshift(Le,Ze),$.push([$e,it,Le,Ze]);var ze=new t.Point(ce+ke.F.x*Re-ke.F.y*Ye,q+ke.F.x*Ye+ke.F.y*Re),ve=new t.Point(ce+ke.E.x*Re-ke.E.y*Ye,q+ke.E.x*Ye+ke.E.y*Re);re==0&&h.pinPoints.push(ze),h.pinPoints.push(ve),ce=ve.x,q=ve.y,ie=ke.tA,xe=ke.tB}),h.points=oe.concat(Be),te?(h.crossCommands=[],t.loop($,function(re,ke){J.mt(re[0].x,re[0].y),!n(le)&&!n(le[ke])&&(J.f(le[ke]),h.crossCommands[ke]=J.f(le[ke]).command,le[ke]&&le[ke].type&&h.specialColor(h.crossCommands[ke],le[ke],h),J.mt(re[0].x,re[0].y)),J.lt(re[1].x,re[1].y).lt(re[2].x,re[2].y).lt(re[3].x,re[3].y).cp()}),Ae&&J.mt($[$.length-1][1].x,$[$.length-1][1].y).lt($[$.length-1][2].x,$[$.length-1][2].y).lt($[0][3].x,$[0][3].y).lt($[0][0].x,$[0][0].y).cp()):(t.loop(oe,function(re,ke){ke==0?J.mt(re.x,re.y):J.lt(re.x,re.y)}),Ae&&(J.lt(oe[0].x,oe[0].y),J.cp()),t.loop(Be,function(re,ke){ke==0&&Ae?J.mt(re.x,re.y):J.lt(re.x,re.y)}),Ae&&J.lt(Be[0].x,Be[0].y),J.cp()),Te&&(t.loop(Me,function(re,ke){ke==0?Te.mt(re.x,re.y):Te.lt(re.x,re.y)}),Ae&&Te.lt(Me[0].x,Me[0].y).cp()),n(j)||(t.loop(Be,function(re,ke){ke==0?G.mt(re.x,re.y):G.lt(re.x,re.y)}),Ae&&G.lt(Be[0].x,Be[0].y).cp());function be(re){var ke=F[re],Re=B[re],Ye=fe[re],$e=se[re],it=Q[re];if(le)var Le=le[re];n(ke)&&(ke=de,h.angles[re]=ke),n(Re)&&(Re=200,h.lengths[re]=Re),n(Ye)&&(Ye=0,h.anglesA[re]=Ye),n($e)&&($e=0,h.anglesB[re]=$e),n(it)&&(it=0,h.anglesEnd[re]=it),le&&n(Le)&&(Le=e,h.crossColors[re]=Le),it=it+90;var Ze=180-it,ze=Math.cos((de-ke)*t.RAD),ve=Math.sin((de-ke)*t.RAD),Pe=new t.Point(0,0),ae=new t.Point(Re,0);if(n(z))var Ne=new t.Point(Math.cos(ue*t.RAD)*ie,Math.sin(ue*t.RAD)*ie);else Ne=new t.Point(z.x*ze-z.y*ve,z.x*ve+z.y*ze);var Ke=me(Re,Ne.x,Ne.y,Ye,Ze),Xe=new t.Point(Re-Ke.x,-Ke.y),Qe;n(pe)?Qe=new t.Point(Math.cos(ge*t.RAD)*ie,Math.sin(ge*t.RAD)*xe):Qe=new t.Point(pe.x*ze-pe.y*ve,pe.x*ve+pe.y*ze);var he=me(Re,Qe.x,Qe.y,$e,it),Ge=new t.Point(Re-he.x,he.y);return z=new t.Point(Xe.x-Re,Xe.y),pe=new t.Point(Ge.x-Re,Ge.y),de=ke,{a:ke,A:Ne,B:Xe,C:Ge,D:Qe,E:ae,F:Pe,tA:Ke.t,tB:he.t}}function me(re,ke,Re,Ye,$e){var it=$e-90,Le=90-it,Ze=180-Ye-Le,ze=Math.tan(it*t.RAD)*Re,ve=re-ke-ze,Pe=ve/Math.sin(Ze*t.RAD)*Math.sin(Ye*t.RAD),ae=Math.sqrt(Math.pow(Re,2)+Math.pow(ze,2)),Ne=Pe+ae,Ke=Ne*Math.sin(it*t.RAD),Xe=Ne*Math.cos(it*t.RAD);return{x:Ke,y:Xe,t:Ne}}}this.add=function(B,F,fe,se,Q,te,le,Ae){var J="lengths, angles, anglesA, anglesB, anglesEnd, cross, crossColors, close",Te;return(Te=st(h.add,arguments,J))?Te:(n(te)||(h.cross=te),n(Ae)||(h.close=Ae),n(B)||(Array.isArray(B)||(B=[B]),n(h.lengths)?h.lengths=B:h.lengths=h.lengths.concat(B)),n(F)||(Array.isArray(F)||(F=[F]),n(h.angles)?h.angles=F:h.angles=h.angles.concat(F)),n(fe)||(Array.isArray(fe)||(fe=[fe]),n(h.anglesA)?h.anglesA=fe:h.anglesA=h.anglesA.concat(fe)),n(se)||(Array.isArray(se)||(se=[se]),n(h.anglesB)?h.anglesB=se:h.anglesB=h.anglesB.concat(se)),n(Q)||(Array.isArray(Q)||(Q=[Q]),n(h.anglesEnd)?h.anglesEnd=Q:h.anglesEnd=h.anglesEnd.concat(Q)),n(le)||(n(h.crossColors)?vt&&tt("Flare() - must set crossColor for original object parameters"):(Array.isArray(le)||(le=[le]),n(h.crossColors)?h.crossColors=le:h.crossColors=h.crossColors.concat(le))),h.remake(),h)},this.remake=function(){return s=this.thicknessA,f=this.thicknessB,I(h.lengths,h.angles,h.anglesA,h.anglesB,h.anglesEnd,h.cross,h.crossColors,h.close),h},Object.defineProperty(h,"color",{get:function(){return e},set:function(B){n(B)&&(B=t.black),e=B,B&&B.type?h.specialColor(h.colorCommand,B,h):h.colorCommand.style=B}});var N,p;this.setColorRange=function(B,F){return n(F)?(N=h.color,p=B):n(B)?(N=h.color,p=F):(N=B,p=F),h};var L=0;Object.defineProperty(h,"colorRange",{get:function(){return L},set:function(B){L=B,!n(N)&&!n(p)&&(h.color=t.colorRange(N,p,B))}}),Object.defineProperty(h,"borderColor",{get:function(){return r},set:function(B){r=B,h.borderColorCommand?B&&B.type?h.specialColor(h.borderColorCommand,B,h):h.borderColorCommand.style=B:I()}}),Object.defineProperty(h,"borderWidth",{get:function(){return i},set:function(B){B>0||(B=0),i=B,!h.borderWidthCommand||i==0?I():(h.borderWidthCommand.width=i,P&&(h.borderDashedCommand.segments=[20,10],h.borderDashedCommand.offset=5))}}),Object.defineProperty(h,"spineColor",{get:function(){return w},set:function(B){n(B)&&(B=t.black),w=B,h.spineColorCommand?B&&B.type?h.specialColor(h.spineColorCommand,B,h):h.spineColorCommand.style=B:I()}}),Object.defineProperty(h,"spineBorderColor",{get:function(){return X},set:function(B){X=B,h.spineBorderColorCommand?B&&B.type?h.specialColor(h.spineBorderColorCommand,B,h):h.spineBorderColorCommand.style=B:I()}}),Object.defineProperty(h,"spineBorderWidth",{get:function(){return b},set:function(B){B>0||(B=0),b=B,!h.spineBorderWidthCommand||b==0?I():(h.spineBorderWidthCommand.width=b,Y&&(h.spineBorderDashedCommand.segments=[20,10],h.spineBorderDashedCommand.offset=5))}}),Object.defineProperty(h,"closeColor",{get:function(){return j},set:function(B){n(B)&&(B=t.black),j=B,h.closeColorCommand?B&&B.type?h.specialColor(h.closeColorCommand,B,h):h.closeColorCommand.style=B:I()}}),Object.defineProperty(h,"closeBorderColor",{get:function(){return _},set:function(B){_=B,h.closeBorderColorCommand?B&&B.type?h.specialColor(h.closeBorderColorCommand,B,h):h.closeBorderColorCommand.style=B:I()}}),Object.defineProperty(h,"closeBorderWidth",{get:function(){return S},set:function(B){B>0||(B=0),S=B,!h.closeBorderWidthCommand||S==0?I():(h.closeBorderWidthCommand.width=S,R&&(h.closeBorderDashedCommand.segments=[20,10],h.closeBorderDashedCommand.offset=5))}}),Object.defineProperty(h,"pin",{get:function(){return u},set:function(B){B>0||(B=0),B>h.pinPoints.length-1&&(u=0),u=B;var F=h.pinPoints[u];F&&(h.regX=F.x,h.regY=F.y)}});var we=t.boundsAroundPoints(h.points);this.setBounds(we.x,we.y,we.width,we.height),n(u)||(h.pin=u),this.mouseChildren=!1,Z!==!1&&t.styleTransforms(this,c),this.clone=function(){return h.cloneProps(new t.Flare(e,r,i,o,t.copy(a),t.copy(s),t.copy(f),u,y,k,t.copy(g),t.copy(O),t.copy(T),t.copy(E),t.copy(A),C,t.copy(d),x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,this.group,ne))}},t.extend(t.Flare,t.Container,["clone"],"zimContainer",!1),t.MultiFlare=function(e,r,i,l,a,s,f){var u="flares, pins, angles, endToEnd, style, group, inherit",y;if(y=st(t.MultiFlare,arguments,u,this))return y;De("53.7"),this.zimContainer_constructor(),this.type="MultiFlare",this.group=s;var k=a===!1?{}:t.getStyle(this.type,this.group,f),g=this;n(e)&&(e=k.flares!=null?k.flares:[]),Array.isArray(e)||(e=[e]),n(r)&&(r=k.pins!=null?k.pins:null),n(i)&&(i=k.angles!=null?k.angles:null),n(l)&&(l=k.endToEnd!=null?k.endToEnd:!1),g.flares=e,g.pins=r,g.angles=i,g.endToEnd=l,g.mouseChildren=!1,g.add=function(O,T){return n(O)||(n(T)&&(T=!0),Array.isArray(O)||(O=[O]),t.loop(O,function(E){T?g.flares.push(E.clone()):g.flares.push(E)}),g.remake(),g.stage&&g.stage.update()),g},g.remove=function(O){return n(O)||(Array.isArray(O)||(O=[O]),t.loop(O,function(T){var E=g.flares.indexOf(T);E>=0&&g.flares.splice(E,1)}),g.remake(),g.stage&&g.stage.update()),g},g.remake=function(){g.removeAllChildren(),t.loop(g.flares,function(O,T){if(r&&!n(r[T])&&(O.pin=r[T]),i&&!n(i[T])&&(O.rotation=i[T]),O.addTo(g),g.flares.push(O),l&&T>0){var E=e[T-1],A=E.pinPoints[E.pinPoints.length-1],C=E.localToLocal(A.x,A.y,g),d=O.pinPoints[0],x=O.localToLocal(d.x,d.y,g);O.mov(C.x-x.x,C.y-x.y)}})},g.remake(),a!==!1&&t.styleTransforms(this,k),this.clone=function(){return g.cloneProps(new t.MultiFlare(t.copy(e,!0),t.copy(r),t.copy(i),l,a,this.group,f))}},t.extend(t.MultiFlare,t.Container,["clone"],"zimContainer",!1),t.FlareBox=function(e,r,i,l,a,s,f,u,y,k,g){var O="width, height, color, borderColor, borderWidth, flares, corners, pins, style, group, inherit",T;if(T=st(t.FlareBox,arguments,O,this))return T;De("53.8"),this.group=k;var E=y===!1?{}:t.getStyle("FlareBox",this.group,g);n(e)&&(e=E.width!=null?E.width:220),n(r)&&(r=E.height!=null?E.height:80),this.zimContainer_constructor(e,r),this.type="FlareBox";var A=this;if(this.mouseChildren=!1,n(l)&&(l=E.borderColor!=null?E.borderColor:null),n(a)&&(a=E.borderWidth!=null?E.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(i)&&(i=E.color!=null?E.color:a>0?"rgba(0,0,0,0)":t.black),(n(a)||a>0)&&(!n(l)||!n(a))&&n(l)&&(l=t.black),n(s)&&(s=E.flares!=null?E.flares:null),n(f)&&(f=E.corners!=null?E.corners:null),n(u)&&(u=E.pins!=null?E.pins:null),A.backing=new t.Rectangle(e,r,i,l,a).addTo(this),!n(s)){if(s.type!="MultiFlare"){if(!Array.isArray(s)){if(s.type!="Flare")return;s=[s]}s=new t.MultiFlare(s,u)}s.addTo(A),A.multiFlare=s,A.flares=A.multiFlare.flares,s.loop(function(C,d){u&&!n(u[d])?C.pin=u[d]:n(C.pin)&&(C.pin=0),f&&!n(f[d])?C.corner=f[d]:n(C.corner)&&(C.corner=0),C.corner==1?C.loc(e,0):C.corner==2?C.loc(e,r):C.corner==3?C.loc(0,r):C.loc(0,0),C.rot((C.corner-C.pin)*90)}),y!==!1&&t.styleTransforms(this,E),this.clone=function(){return A.cloneProps(new t.FlareBox(e,r,i,l,a,t.copy(s,!0),t.copy(f),t.copy(u),y,this.group,g))}}},t.extend(t.FlareBox,t.Container,["clone"],"zimContainer",!1),t.Label=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D){var c="text, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, bold, italic, variant, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, splitWords, style, group, inherit",h;if(h=st(t.Label,arguments,c,this))return h;De("54"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Label",this.group=V;var o=ne===!1?{}:t.getStyle(this.type,this.group,D);n(e)&&(e=o.text!=null?o.text:"LABEL"),n(r)&&(r=o.size!=null?o.size:36),n(i)&&(i=o.font!=null?o.font:"arial"),n(l)&&(l=o.color!=null?o.color:t.black),n(k)&&(k=o.bold!=null?o.bold:!1),n(g)&&(g=o.italic!=null?o.italic:!1);var I=N(e,r,i,l,k,g);this.veeObj={text:I[0],size:I[1],font:I[2],color:I[3],bold:I[4],italic:I[5]};function N(){return arguments}e=t.Pick.choose(e);var p=!1;e===""&&(e=" ",p=!0),r=t.Pick.choose(r),i=t.Pick.choose(i),i=i.replace("+"," ");var L=["ttf","otf","woff2","woff","fnt"],we=i.split(".");we.length>0&&L.indexOf(we[1])!=-1&&(i=we[0]),l=t.Pick.choose(l),k=t.Pick.choose(k),g=t.Pick.choose(g),n(a)&&(a=o.rollColor!=null?o.rollColor:null),(n(s)||s=="ignore")&&(s=o.shadowColor!=null&&s!="ignore"?o.shadowColor:-1),(n(f)||f=="ignore")&&(f=o.shadowBlur!=null&&f!="ignore"?o.shadowBlur:14),n(u)&&(u=o.align!=null?o.align:"left"),n(y)&&(y=o.valign!=null?o.valign:"top"),(!n(C)||!n(o.outlineColor))&&n(d)&&(d=o.outlineWidth!=null?o.outlineWidth:Math.round(r*.2)),(!n(d)||!n(o.outlineWidth))&&n(C)&&(C=o.outlineColor!=null?o.outlineColor:t.black),n(d)&&(d=o.outlineWidth!=null?o.outlineWidth:0),(n(x)||x=="ignore")&&(x=o.backgroundColor!=null&&x!="ignore"?o.backgroundColor:null),n(P)&&(P=o.backgroundBorderColor!=null&&P!="ignore"?o.backgroundBorderColor:null),n(v)&&(v=o.backgroundBorderWidth!=null&&v!="ignore"?o.backgroundBorderWidth:null),(n(X)||X=="ignore")&&(X=o.padding!=null&&X!="ignore"?o.padding:10),n(Y)&&(Y=o.paddingH!=null?o.paddingH:X),n(m)&&(m=o.paddingV!=null?o.paddingV:X),n(j)&&(j=o.shiftH!=null?o.shiftH:0),n(S)&&(S=o.shiftV!=null?o.shiftV:0),n(O)&&(O=o.variant!=null?o.variant:!1),n(T)&&(T=o.lineWidth!=null?o.lineWidth:null),n(E)&&(E=o.lineHeight!=null?o.lineHeight:null),(n(A)||A=="ignore")&&(A=o.backing!=null&&A!="ignore"?o.backing.clone():null),n(_)&&(_=o.rollPersist!=null?o.rollPersist:!1),o.labelWidth!=null&&(T=o.labelWidth),n(R)||(T=R),u=="middle"&&(u="center"),n(U)&&(U=o.labelHeight!=null?o.labelHeight:null),n(Z)&&(Z=o.maxSize!=null?o.maxSize:null),r=Z?Math.min(r,Z):r,n(K)&&(K=o.splitWords!=null?o.splitWords:!1);var B=ee.zdf&&ee.zdf.retina,F=this;this.mouseChildren=!1,this.paddingV=m,this.paddingH=Y,ee.DIR&&ee.DIR=="rtl"||!ee.DIR&&t.DIR=="rtl"?u=="start"?u="right":u=="end"&&(u="left"):u=="start"?u="left":u=="end"&&(u="right");var fe=[];fe[0]=g?"italic":"normal",fe[1]=O?"small-caps":"normal",fe[2]=k?"bold":"normal",fe[3]=r+"px",fe[4]=i;var se=fe.join(" ");e=String(e);var Q,te=!1,le=T,Ae=U;if(n(A)&&n(x)){var J=new Fe.Shape;F.hitArea=J}else le&&(le=le-Y*2),Ae&&(Ae=Ae-m*2);function Te(re){var ke=new Fe.Text(re,se,l);return ke.lineWidth=le,ke.lineHeight=E,ke}Q=Te(e);function G(re,ke,Re){var Ye=Math.ceil(le/ke*Re.length),$e=Re.substr(0,Ye),it=Te($e),Le=it.getMeasuredWidth();if(Le>le)for(;Le>le;)Ye--,$e=Re.substr(0,Ye),it=Te($e),Le=it.getMeasuredWidth();else if(Le<le){for(;Le<le;)Ye++,$e=Re.substr(0,Ye),it=Te($e),Le=it.getMeasuredWidth();Ye--,$e=Re.substr(0,Ye)}var Ze=Re.substr(Ye,Re.length);return{endIndex:Ye,start:$e,end:Ze}}if(K&&le>r*1.2)for(var ce=Q.getMetrics(),q=0;ce.width>le&&q<1e3;)q++,t.loop(ce.lines,function(re,ke){re=re.replace(/^[\s\t]+/,"");var Re=Te(re),Ye=Re.getMeasuredWidth();if(Ye>le){var $e=G(Re,Ye,re);return ce.lines[ke]=$e.start,ce.lines.length>ke+1?($e.end.trim(),ce.lines[ke+1]=$e.end+" "+ce.lines[ke+1]):ce.lines.push($e.end),Q=Te(ce.lines.join(" ")),ce=Q.getMetrics(),!1}});if(this.label=Q,Q.textAlign=u,Q.textBaseline="alphabetic",d>0){var ue=this.outlineLabel=Q.clone();ue.color=C,ue.outline=d}s!=-1&&f>0&&(Q.shadow=new Fe.Shadow(s,3,3,f)),this.addChild(Q);function ge(){F.removeChild(F.background),F.background=new t.Rectangle(F.getBounds().width+Y*2,F.getBounds().height+m*2,x,P,v,w,b,null,null,!1),t.center(F.background,F,0),F.setBounds(F.background.x,F.background.y,F.background.width,F.background.height)}function ie(){var re=Q.getBounds(),ke=re.y,Re=re.height;if(le&&!Ae){var Ye=re.x,$e=le;u=="right"?Ye=re.x-le+re.width:u=="center"&&(Ye=-le/2),Q.setBounds(Ye,ke,$e,Re),re=Q.getBounds()}var it;y=="baseline"?it=re.y:y=="top"?(Q.y=r-r/6,it=0):y=="center"||y=="middle"?(it=-re.height/2,Q.y=r*.3):it=-re.height,F.setBounds(re.x,it,o.width?o.width-X*2:re.width,o.height?o.height-X*2:re.height),F.hitArea&&F.hitArea.graphics.c().f("black").r(F.getBounds().x,F.getBounds().y,F.getBounds().width,F.getBounds().height),(y=="center"||y=="middle")&&(t.pos(Q,null,0),t.mov(Q,0,1)),U||(A?te&&z():n(x)||ge()),y!="baseline"&&!B&&(Q.y+=r/32),pe()}if(ie(),!n(A)){if(A.type=="Pattern"){if(F.backing=new t.Container(F.width+Y*2,F.height+m*2,null,null,!1).centerReg(null,null,!1),s!=-1&&f>0){var xe=new t.Rectangle(F.width+Y*2-2,F.height+m-2,"#666",null,null,w,null,null,null,!1).center(F.backing);xe.shadow=new Fe.Shadow(s,3,3,f)}var Se=new t.Rectangle(F.width+Y*2,F.height+m*2,x,null,null,w,null,null,null,!1).addTo(F.backing);A.centerReg(Se),A.setMask(Se),F.backing.pattern=A}else F.backing=A;F.backing.center(F,0),A=F.backing,z(),te=!0}function z(){var re=A.boundsToGlobal(),ke=F.boundsToGlobal(re,!0);F.setBounds(ke.x,ke.y,ke.width,ke.height)}function pe(){t.pos(Q,u=="left"||u=="right"?A||F.background?Y:0:null,y=="top"||y=="baseline"||y=="bottom"?A||F.background?m:0:null,u=="right",y=="bottom"),Q.x+=j,Q.y+=S}pe();function de(){ue&&(ue.x=Q.x,ue.y=Q.y,F.addChildAt(ue,F.background||F.backing?1:0))}de(),Object.defineProperty(F,"text",{get:function(){var re=Q.text==" "&&p?"":Q.text;return re},set:function(re){p=!1,re===""&&(re=" ",p=!0),Q.text=String(re),Q.setBounds(null),F.setBounds(null),ie(),ue&&(ue.text=String(re)),!n(T)&&!n(U)&&(me(),ue&&de())}}),Object.defineProperty(F,"size",{get:function(){return r},set:function(re){r=Z?Math.min(re,Z):re,fe[3]=r+"px",this.label.font=fe.join(" "),ue&&(ue.font=fe.join(" ")),Q.setBounds(null),F.setBounds(null),ie(),de()}}),Object.defineProperty(F,"bold",{get:function(){return!!this.label.font.match("bold")},set:function(re){k=re,fe[2]=re?"bold":"normal",this.label.font=fe.join(" "),ue&&(ue.font=fe.join(" "))}}),Object.defineProperty(F,"italic",{get:function(){return!!this.label.font.match("italic")},set:function(re){g=re,fe[0]=re?"italic":"normal",this.label.font=fe.join(" "),ue&&(ue.font=fe.join(" "))}}),Object.defineProperty(F,"variant",{get:function(){return!!this.label.font.match("small-caps")},set:function(re){O=re,fe[1]=re?"small-caps":"normal",this.label.font=fe.join(" "),ue&&(ue.font=fe.join(" "))}}),Object.defineProperty(F,"font",{get:function(){return fe[4]},set:function(re){n(re)||(i=re,fe[4]=re,this.label.font=fe.join(" "),ue&&(ue.font=fe.join(" ")))}}),Object.defineProperty(F,"align",{get:function(){return u},set:function(re){n(re)||(u=re,this.label.textAlign=u,ue&&(ue.textAlign=u),ie(),de())}}),Object.defineProperty(F,"valign",{get:function(){return y},set:function(re){n(re)||(y=re,ie(),de())}}),Object.defineProperty(F,"color",{get:function(){return l},set:function(re){a==l&&(a=re),l=re,Q.color=l,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&F.stage&&F.stage.update()}}),Object.defineProperty(F,"colorOnly",{get:function(){return l},set:function(re){l=re,Q.color=l,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&F.stage&&F.stage.update()}});var oe,Be;this.setColorRange=function(re,ke){return n(ke)?(oe=F.color,Be=re):n(re)?(oe=F.color,Be=ke):(oe=re,Be=ke),F};var $=0;Object.defineProperty(F,"colorRange",{get:function(){return $},set:function(re){$=re,!n(oe)&&!n(Be)&&(F.color=t.colorRange(oe,Be,re))}}),Object.defineProperty(F,"backgroundColor",{get:function(){return x},set:function(re){x=re,F.background?F.background.color=re:F.backing?F.backing.color=re:ge(),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&F.stage&&F.stage.update()}}),Object.defineProperty(F,"outlineColor",{get:function(){return C},set:function(re){C=re,ue&&(ue.color=C),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&F.stage&&F.stage.update()}}),Object.defineProperty(F,"rollColor",{get:function(){return a},set:function(re){!F.mouseoverEvent&&re&&Me(),re==null&&F.mouseoverEvent&&be(),a=re}}),this._enabled=!0,Object.defineProperty(F,"enabled",{get:function(){return F._enabled},set:function(re){Ot(F,re),Q.color=l,F.mouseChildren=!1,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&F.stage&&F.stage.update()}}),this.showRollColor=function(re){return n(re)&&(re=!0),re?Q.color=a:Q.color=l,F.stage&&F.stage.update(),F};function Me(){F.mouseoverEvent=F.on("mouseover",function(){F.showRollColor&&F.showRollColor()}),F.mouseoutEvent=F.on("mouseout",function(){F.rollPersist||F.showRollColor(!1)}),F.pressupEvent=F.on("pressup",function(){F.rollPersist&&F.showRollColor(!1)})}function be(){F.off("mouseover",F.mouseoverEvent),F.off("mouseout",F.mouseoutEvent),F.off("pressup",F.pressupEvent)}a&&Me(),Object.defineProperty(F,"labelWidth",{get:function(){return T},set:function(re){re>0&&(T=re,le=T,(!n(A)||!n(x))&&le&&(le=le-Y*2),F.label.lineWidth=le,ue&&(ue.lineWidth=le),Q.setBounds(null),F.setBounds(null),ie(),U&&me(),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&F.stage&&F.stage.update())}}),Object.defineProperty(F,"labelHeight",{get:function(){return U},set:function(re){re>0&&(U=re,Ae=U,(!n(A)||!n(x))&&Ae&&(Ae=Ae-m*2),T&&me(),F.setBounds(null),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&F.stage&&F.stage.update())}}),!n(T)&&!n(U)&&me();function me(){F.size=Z||200;for(var re=0;E<Ae/2&&(F.height>Ae||F.width>le)&&(re++,F.size=F.size/2,!(re>50)););for(re=0;F.height<=Ae&&F.width<=le&&(re++,F.size=Math.ceil(F.size+1),!(re>50)););F.size=F.size-1,de(),Q.setBounds(null);var ke=Q.getBounds(),Re=ke.y,Ye=ke.height;Ae&&(y=="bottom"?Re=Re-Ae+Ye:(y=="center"||y=="middle")&&(Re=(Re+Re-Ae+Ye)/2),Ye=Ae),Q.setBounds(ke.x,Re,ke.width,Ye),F.setBounds(null),ke=F.getBounds(),F.setBounds(ke.x,ke.y,ke.width,ke.height),A?te&&z():n(x)||ge()}ne!==!1&&t.styleTransforms(this,o),this.clone=function(re){return F.cloneProps(new t.Label(re||!t.isPick(I[0])?F.text:I[0],re||!t.isPick(I[1])?r:I[1],re||!t.isPick(I[2])?i:I[2],re||!t.isPick(I[3])?l:I[3],a,s,f,u,y,re||!t.isPick(I[4])?k:I[4],re||!t.isPick(I[5])?g:I[5],O,T,E,n(A)?null:A.clone(re),C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,this.group,D))}},t.extend(t.Label,t.Container,"clone","zimContainer"),t.LabelOnPath=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="label, path, percentAngle, percents, showPath, allowToggle, interactive, onTop, rtl, style, group, inherit",E;if(E=st(t.LabelOnPath,arguments,T,this))return E;De("54.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelOnPath",this.group=g;var A=k===!1?{}:t.getStyle(this.type,this.group,O);n(e)&&(e=A.label!=null?A.label:new t.Label("Label on Path")),n(r)&&(r=A.path!=null?A.path:new t.Squiggle({points:[[0,0,0,0,-86,57,86,-57],[300,150,0,0,-133,21,133,-21]]})),n(i)&&(i=A.percentAngle!=null?A.percentAngle:100),n(l)&&(l=A.percents!=null?A.percents:null),n(a)&&(a=A.showPath!=null?A.showPath:!0),n(s)&&(s=A.allowToggle!=null?A.allowToggle:!0),n(f)&&(f=A.interactive!=null?A.interactive:!0),n(u)&&(u=A.onTop!=null?A.onTop:!1),n(y)&&(y=A.rtl!=null?A.rtl:ee.DIR=="rtl"||t.DIR=="rtl"),y&&r.reversePoints();var C=e.color;r.addTo(this);var d=this;this.path=r,this.allowToggle=s,r.interactive=f,typeof e=="string"&&(e=new t.Label(e));var x=r.alpha;a||r.alp(0),r.onTop=u;var P=this.letters=new t.Container().addTo(this);if(!l){l=[];for(var v=0;v<e.text.length;v++)l.push(t.decimals(1/(e.text.length-(r.type=="Blob"?0:1))*100*v))}this.percents=l;function w(){var X;for(X=P.numChildren-1;X>=0;X--)P.getChildAt(X).dispose();for(d.numLetters=e.text.length,X=0;X<d.numLetters;X++){var Y=e.clone();Y.text=e.text[X],Y.centerReg(P).reg(null,Y.height),Y.text!=""&&Y.text!=" "&&Y.expand(0),d.allowToggle&&Y.cur("pointer"),Y.on("mousedown",function(){d.allowToggle&&d.toggle()})}d.resize()}this.resize=function(){for(var X=r.segmentRatios,Y=r.segmentPoints,m=0;m<this.numLetters;m++){var j=r.getCurvePoint(l[m]/100,X,Y,!0);if(j){var S=this.globalToLocal(j.x,j.y);S&&(P.getChildAt(m).loc(S).rot((j.angle>180?j.angle-360:j.angle)*i/100),y&&(P.getChildAt(m).rotation+=180))}}return this},w(),this.showPath=function(X){return this.toggle(!0),r.toggle(X),this},this.hidePath=function(){return this.toggle(!1),this},Object.defineProperty(d,"text",{get:function(){return e.text},set:function(X){e.text=X,l=[];for(var Y=0;Y<e.text.length;Y++)l.push(t.decimals(1/(e.text.length-(r.type=="Blob"?0:1))*100*Y));w()}}),Object.defineProperty(this,"color",{get:function(){return C},set:function(X){C=X;for(var Y=0;Y<d.letters.numChildren;Y++)d.letters.getChildAt(Y).color=C;d.stage&&d.stage.update()}}),Object.defineProperty(d,"interactive",{get:function(){return f},set:function(X){f=X,r.interactive=X,this.ticker&&t.Ticker.remove(this.ticker),f&&(this.ticker=t.Ticker.add(function(){d.resize()}))}}),this.interactive&&(this.ticker=t.Ticker.add(function(){d.resize()}));var b=d.toggled=a;this.toggle=function(X){if(this.allowToggle)return n(X)?b=!b:X?b=!0:b=!1,b?(r.alp(x),this.interactive&&(r.showControls(),P.mouseEnabled=!1,P.mouseChildren=!1,P.cur("default"),this.controlHideEvent&&r.off("controlshide",this.controlHideEvent),this.controlHideEvent=r.on("controlshide",function(){P.mouseEnabled=!0,P.mouseChildren=!0,P.cur("pointer"),x=r.alpha,r.alp(0),b=!1,d.toggled=b,d.stage&&d.stage.update()},null,!0))):(x=r.alpha,r.alp(0),P.mouseEnabled=!0,P.mouseChildren=!0,P.cur("pointer")),d.toggled=b,d.stage&&d.stage.update(),d},d.toggle(!0),k!==!1&&t.styleTransforms(this,A),this.clone=function(){return d.cloneProps(new t.LabelOnPath(d.label.clone(),d.path.clone(),i,t.copy(l),a,s,f,u,y,k,this.group,O))},this.dispose=function(X,Y,m){return this.ticker&&t.Ticker.remove(this.ticker),m||this.zimContainer_dispose(!0),!0}},t.extend(t.LabelOnPath,t.Container,["clone","dispose"],"zimContainer",!1),t.LabelOnArc=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x){var P="label, size, font, color, radius, flip, spacing, letterSpacing, angles, showCircle, arcColor, arcBorderColor, arcBorderWidth, radiusSpread, rtl, style, group, inherit",v;if(v=st(t.LabelOnArc,arguments,P,this))return v;De("54.55"),this.group=d;var w=C===!1?{}:t.getStyle("LabelOnArc",this.group,x);n(r)&&(r=w.size!=null?w.size:30),n(e)&&(e=w.label!=null?w.label:new t.Label("Label on Arc",r)),n(i)&&(i=w.font!=null?w.font:"verdana"),n(l)&&(l=w.color!=null?w.color:t.white),n(a)&&(a=w.radius!=null?w.radius:100),n(s)&&(s=w.flip!=null?w.flip:!1),n(f)&&(f=w.spacing!=null?w.spacing:0),n(u)&&(u=w.letterSpacing!=null?w.letterSpacing:5),n(y)&&(y=w.angles!=null?w.angles:null);var b=!n(y),X=t.copy(y);n(k)&&(k=w.showCircle!=null?w.showCircle:!1),n(g)&&(g=w.arcColor!=null?w.arcColor:null),n(O)&&(O=w.arcBorderColor!=null?w.arcBorderColor:null),n(T)&&(T=w.arcBorderWidth!=null?w.arcBorderWidth:null),n(E)&&(E=w.radiusSpread!=null?w.radiusSpread:!1),n(A)&&(A=w.rtl!=null?w.rtl:ee.DIR=="rtl"||t.DIR=="rtl");var Y=this.outerRadius=a+f+e.height;this.innerRadius=a+f,this.zimContainer_constructor(-Y,-Y,Y*2,Y*2,!1),this.type="LabelOnArc";var m=this;e.type!="Label"&&(e=new t.Label(e,r,i,l)),e.text;var j,S,_,R,U,Z;function K(){if(m.disposeAllChildren(),s){var D=e.text.split("").reverse().join("");e.text=D}j=m.letters=new t.Container(m.width,m.height).centerReg(m),m.numLetters=e.text.length,m.letterHeight=e.height,S=m.labels=[];var c;for(c=0;c<m.numLetters;c++){var h=e.clone();S.push(h),h.text=e.text[c],h.letterHolder=new t.Container(h.width,h.height),h.centerReg(h.letterHolder).rot(s?180:0)}if(A&&S.reverse(),R=m.circle=new t.Circle(a),k&&R.addTo(m),_=m.arc=new t.Shape().addTo(m),ne(),y){for(U=0,c=0;c<y.length;c++)U+=y[c];U+=y[y.length-1]/2}V()}K();function ne(){U=0,Z=[0];for(var D=0;D<m.numLetters;D++){var c=S[D],h=Math.atan((c.width+u)/2/(a+f))*180/Math.PI*2;Z.push(h),U+=h,c.letterHolder.centerReg(j).reg(null,a+f+c.height+(s?c.height*.13:0))}m.circle.radius=a,(g||O||T)&&(T>0&&n(O)?O=t.black:n(T)&&!n(O)&&(T=2),_.graphics.c().f(null).s(O).ss(T).arc(0,0,a,(m.startAngle-90)*Math.PI/180,(m.startAngle-90+U)*Math.PI/180))}function V(){var D;if(!b)for(y=[],D=0;D<Z.length-1;D++)y[D]=Math.round((Z[D]+Z[D+1])/2*100)/100;m.angles=y,m.startAngle=-U/2;var c=m.startAngle;for(D=0;D<j.numChildren;D++){var h=j.getChildAt(D);c=h.rotation=c+y[D]}}Object.defineProperty(this,"radius",{get:function(){return a},set:function(D){a=D,ne(),!b&&!E&&V()}}),Object.defineProperty(this,"color",{get:function(){return l},set:function(D){l=D;for(var c=0;c<m.labels.length;c++)m.labels[c].color=l;m.stage&&m.stage.update()}}),Object.defineProperty(m,"text",{get:function(){return e.text},set:function(D){e.text=D,X?y=t.copy(X):y=null,K()}}),C!==!1&&t.styleTransforms(this,w),this.clone=function(){return m.cloneProps(new t.LabelOnArc(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,this.group,x))}},t.extend(t.LabelOnArc,t.Container,"clone","zimContainer",!1),t.LabelLetters=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A){var C="label, align, valign, letterSpacing, letterSpacings, lineSpacing, lineSpacings, lineHeight, lineAlign, lineValign, cache, rtl, style, group, inherit",d;if(d=st(t.LabelLetters,arguments,C,this))return d;De("54.57"),this.group=E;var x=T===!1?{}:t.getStyle("LabelLetters",this.group,A);n(e)&&(e=x.label!=null?x.label:new t.Label("Label Letters")),n(r)&&(r=x.align!=null?x.align:"center"),n(i)&&(i=x.valign!=null?x.valign:"center"),n(l)&&(l=x.letterSpacing!=null?x.letterSpacing:5),n(a)&&(a=x.letterSpacings!=null?x.letterSpacings:null),n(u)&&(u=x.lineHeight!=null?x.lineHeight:null),n(s)&&(s=x.lineSpacing!=null?x.lineSpacing:5),n(f)&&(f=x.lineSpacings!=null?x.lineSpacings:null),n(O)&&(O=x.rtl!=null?x.rtl:!1),n(y)&&(y=x.lineAlign!=null?x.lineAlign:O?"right":"left"),n(k)&&(k=x.lineValign!=null?x.lineValign:"bottom"),n(g)&&(g=x.cache!=null?x.cache:!1),this.zimContainer_constructor(null,null,null,null,!1),this.type="LabelLetters";var P=this,v=P.letterData=[],w,b;e.type!="Label"?(b=X(e),v=b.data,e=new t.Label(b.text)):(b=X(e.text),v=b.data,e.text=b.text),P.text=b.original,P._color=e.color,ee.DIR&&ee.DIR=="rtl"||!ee.DIR&&t.DIR=="rtl"?y=="start"?y="right":y=="end"&&(y="left"):y=="start"?y="left":y=="end"&&(y="right");function X(ue){var ge=[];function ie(Be){return Be.split("").reverse().join("")}if(O){Ae=-1,ue=ue.replace(/[\u0591-\u07FF]+/ig,ie),ue=ue.replace(/([^\u0591-\u07FF ])([\u0591-\u07FF])/ig,"$1-!!-$2"),ue=ue.replace(/([\u0591-\u07FF])([^\u0591-\u07FF ])/ig,"$1-!!-$2"),ue=ue.replace(/([^\u0591-\u07FF]) ([\u0591-\u07FF])/ig,"$1-!!- -!!-$2"),ue=ue.replace(/([\u0591-\u07FF]) ([^\u0591-\u07FF])/ig,"$1-!!- -!!-$2");var xe=ue.split(/-!!-/g);t.loop(xe,function(Be,$){Be.match(/[\u0591-\u07FF]/i)&&(xe[$]=Be.split(" ").reverse().join(" "))}),ue=xe.join("")}ue=ue.replace(/\n|\r/g,"<br>"),ue=ue.replace(/<strong>|<strong \/>|<strong\/>/gi,"<b>"),ue=ue.replace(/<\/strong>/gi,"</b>"),ue=ue.replace(/<em>|<em \/>|<em\/>/gi,"<i>"),ue=ue.replace(/<\/em>/gi,"</i>"),ue=ue.replace(/\\n|\\r/g,"<br>"),ue=ue.replace(/<br>|<br \/>|<br\/>(<\/br>)?/gi,"<br>"),ue=ue.replace(/<b/gi,"<b"),ue=ue.replace(/<i/gi,"<i"),ue=ue.replace(/<u/gi,"<u"),ue=ue.replace(/<br/gi,"<br"),ue=ue.replace(/<a/gi,"<a"),ue=ue.replace(/<font/gi,"<font");var Se=[/<(a|i|u|f|br|\/a|\/i|\/u|\/f|\/b)[^>]*>/g,/<(a|i|u|f|br|\/a|\/i|\/u|\/f|b)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|\/a)[^>]*>/g,/<(b|i|u|f|br|\/b|\/i|\/u|\/f|a)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|\/i)[^>]*>/g,/<(b|a|u|f|br|\/b|\/a|\/u|\/f|i)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|\/u)[^>]*>/g,/<(b|a|i|f|br|\/b|\/a|\/i|\/f|u)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,/<(b|a|i|u|br|\/b|\/a|\/i|\/u|f)[^>]*>/g],z=["b","a","i","u","font"],pe;t.loop(z,function(Be,$){pe=ue.replace(Se[$*2],"");var Me;Be=="font"?Me=pe.split("<font "):Be=="a"?Me=pe.split("<a "):Me=pe.split("<"+Be+">"),oe(Me,Be,0),pe=ue.replace(Se[$*2+1],""),Me=pe.split("</"+Be+">"),oe(Me,Be,1)}),pe=ue.replace(/<br>/gi,"@^#"),pe=pe.replace(/<(b|a|i|u|f|\/b|\/a|\/i|\/u|\/f)[^>]*>/g,"");var de=pe.split("@^#");w=de.join(`
`),pe=de.join(""),oe(de,"br",0);function oe(Be,$,Me){if(Be.length>1)if(($=="font"||$=="a")&&Me==0){var be=Be[0].length;t.loop(Be,function(re,ke){if(ke!=0){var Re=ge[be];Re||(ge[be]=[]),Re=ge[be];var Ye=re.split(">");Re[Me]?Re[Me].push($+" "+Ye[0]):Re[Me]=[$+" "+Ye[0]],be+=Ye[1].length}})}else{Be.pop();var me=0;t.loop(Be,function(re){me+=re.length;var ke=ge[me];ke||(ge[me]=[]),ke=ge[me],ke[Me]?ke[Me].push($):ke[Me]=[$]})}}return{text:pe,data:ge,original:w}}P.numLetters=e.text.length;var Y=!n(a);a&&!Array.isArray(a)&&(a=null);var m;if(a)for(m=0;m<P.numLetters;m++)n(a[m])&&(a[m]=l);else for(a=[],m=0;m<P.numLetters;m++)a.push(l);if(P.letterSpacings=a,f&&!Array.isArray(f)&&(f=null),f)for(m=0;m<P.numLetters-1;m++)n(f[m])&&(f[m]=s);else for(f=[],m=0;m<P.numLetters-1;m++)f.push(s);P.lineSpacings=f,P.labels=[],P.lines=[[]];var j=[],S=[],_=[0],R=0,U=0,Z=0,K=0,ne=0,V=v,D=!1,c=!1,h=!1,o=!1,I=!1,N=!1,p=!1,L=!1,we=!1,B=!1,F=!1,fe=!1;for(P.rolls=[[]],m=0;m<P.numLetters;m++){o=!1,V[m]&&(V[m][1]&&(V[m][1].indexOf("b")>=0&&(D=!1),V[m][1].indexOf("i")>=0&&(c=!1),V[m][1].indexOf("u")>=0&&(h=!1),t.loop(V[m][1],function(ue){if(ue.match(/^font/i)){I=!1,F=!1,fe&&P.rolls.push([]),fe=!1,N=!1,L=!1,p=!1;return}if(ue.match(/^a/i)){we=!1,B=!1;return}})),V[m][0]&&(V[m][0].indexOf("b")>=0&&(D=!0),V[m][0].indexOf("i")>=0&&(c=!0),V[m][0].indexOf("u")>=0&&(h=!0),o=0,t.loop(V[m][0],function(ue){ue=="br"&&o++}),t.loop(V[m][0],function(ue){var ge,ie;if(ue.match(/^font/i)){ge=ue.match(/ color\s?=\s?(\S*)/i),ge&&(I=ge[1],ie=t.colors.indexOf(I),ie>=0&&(I=t.colorsHex[ie]),I=I.replace(/'/g,"")),ge=ue.match(/size\s?=\s?(\S*)/i),ge&&(N=ge[1]),ge=ue.match(/backgroundColor\s?=\s?(\S*)/i),ge&&(F=ge[1],ie=t.colors.indexOf(F),ie>=0&&(F=t.colorsHex[ie]),F=F.replace(/'/g,"")),ge=ue.match(/rollBackgroundColor\s?=\s?(\S*)/i),ge&&(fe=ge[1],ie=t.colors.indexOf(fe),ie>=0&&(fe=t.colorsHex[ie]),fe=fe.replace(/'/g,"")),ge=ue.match(/group\s?=\s?(\S*)/i),ge&&(p=ge[1]),ge=ue.match(/family\s?=\s?(.*)/i),ge&&(L=ge[1],L=L.split(/\ssize\s?=|\scolor\s?=|\sgroup\s?=/i)[0]);return}if(ue.match(/^a/i)){ge=ue.match(/href\s?=\s?(\S*)/i),ge&&(we=ge[1]),ge=ue.match(/target\s?=\s?(\S*)/i),ge&&(B=ge[1]);return}})));var se;p?se=new t.Label({text:e.text[m],group:p}):(se=e.clone(),se.text=e.text[m]),P.labels.push(se),D&&(se.bold=!0),c&&(se.italic=!0),I&&(se.color=I),F&&(se.backgroundColor=F);var Q=Y||n(se.backgroundColor)?a[m]:-.5;fe&&(se.rollIndex=P.rolls.length-1,se.zrbc=fe,se.zobc=se.backgroundColor,P.rolls[se.rollIndex].push(se),se.expand(0),se.on("mouseover",te),se.on("mouseout",le)),we&&(se.expand(Q,0),se.zurl=we,se.ztar=B,se.cur(),se.on("click",function(ue){var ge=ue.currentTarget;le(ue),ge.ztar||(ge.ztar="_self"),ir(ge.zurl,ge.ztar)})),L&&(se.font=L),N&&(se.size=N),o&&(R+=(n(u)?Z:u)+f[K],_.push(R),S.push(n(u)?Z:u),j.push(U),ne=Math.max(ne,U)),o&&(o>1&&t.loop(o-1,function(){P.lines.push([]),R+=(n(u)?Z:u)+f[K],_.push(R),S.push(n(u)?Z:u),j.push(0),K++}),Z=0,U=0,P.lines.push([]),K++),U+=se.width+Q,Z=Math.max(Z,se.height),m==P.numLetters-1&&(j.push(U),S.push(Z),ne=Math.max(ne,U)),P.lines[K].push(se),h&&(se.underline=new t.Line(se.width+Q+1,1,se.color).center(se,this).mov(0,se.height/2))}function te(ue){var ge=ue.currentTarget,ie=P.rolls[ge.rollIndex];t.loop(ie,function(xe){xe.backgroundColor=ge.zrbc}),ge.stage&&ge.stage.update()}function le(ue){var ge=ue.currentTarget,ie=P.rolls[ge.rollIndex];t.loop(ie,function(xe){xe.backgroundColor=ge.zobc}),ge.stage&&ge.stage.update()}for(var Ae=0,J=0;J<P.lines.length;J++){var Te=P.lines[J];U=j[J],Z=S[J],R=_[J];var G,ce;for(y=="left"?G=0:y=="right"?G=ne-U:G=(ne-U)/2,ce=R,m=0;m<Te.length;m++){Ae++,g&&se.cache(),se=Te[m],se.regX=r=="left"?0:r=="right"?se.width:se.width/2,se.regY=i=="top"?0:i=="bottom"?se.height:se.height/2;var q=ce+(i=="top"?0:i=="bottom"?se.height:se.height/2);k=="center"||k=="middle"?q+=(S[J]-se.height)/2:k=="bottom"&&(q+=S[J]-se.height),Q=Y||n(se.backgroundColor)?a[Ae-1]:-.5,r=="left"?(se.loc(G,q,this),G=se.x+se.width+Q):r=="right"?(se.loc(G+se.width,q,this),G=se.x+Q):(se.loc(G+se.width/2,q,this),G=se.x+se.width/2+Q)}}this.getBounds()||this.setBounds(0,0,0,0),this.regX=this.getBounds().x,this.regY=this.getBounds().y,Object.defineProperty(this,"color",{get:function(){return this._color},set:function(ue){this._color=ue;for(var ge=0;ge<P.numChildren;ge++)P.getChildAt(ge).color=this._color;P.stage&&P.stage.update()}}),this.dispose=function(){t.gD(this),t.loop(P.labels,function(ue){ue.removeFrom(),ue.dispose()}),P.removeFrom()},T!==!1&&t.styleTransforms(this,x),this.clone=function(){return P.cloneProps(new t.LabelLetters(e,r,i,l,a,s,f,u,y,k,g,O,T,this.group,A))}},t.extend(t.LabelLetters,t.Container,"clone","zimContainer",!1),t.Emoji=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d){var x="code, size, monochrome, italic, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backing, padding, paddingH, paddingV, shiftH, shiftV, style, group, inherit",P;if(P=st(t.Emoji,arguments,x,this))return P;De("54.58"),this.group=C;var v=A===!1?{}:t.getStyle("Emoji",this.group,d);n(e)&&(e=v.code!=null?v.code:"\u{1F642}"),n(r)&&(r=v.size!=null?v.size:30),n(i)&&(i=v.monochrome!=null?v.monochrome:!1),n(l)&&(l=v.italic!=null?v.italic:!1),(n(a)||a=="ignore")&&(a=v.backgroundColor!=null&&a!="ignore"?v.backgroundColor:null),n(s)&&(s=v.backgroundBorderColor!=null&&s!="ignore"?v.backgroundBorderColor:null),n(f)&&(f=v.backgroundBorderWidth!=null&&f!="ignore"?v.backgroundBorderWidth:null),(n(k)||k=="ignore")&&(k=v.padding!=null&&k!="ignore"?v.padding:10),n(g)&&(g=v.paddingH!=null?v.paddingH:k),n(O)&&(O=v.paddingV!=null?v.paddingV:k),n(T)&&(T=v.shiftH!=null?v.shiftH:0),n(E)&&(E=v.shiftV!=null?v.shiftV:0);var w=b(e,r);this.veeObj={code:w[0],size:w[1]};function b(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),e.substring(0,2)=="U+"&&(e=t.unicodeToUTF(e)),this.zimLabel_constructor(e,r,null,null,null,null,null,null,null,null,l,null,null,null,y,null,null,a,null,null,u,null,k,g,O,T,E),this.type="Emoji",this.code=e,this.size=r;var X=this,Y=this.getBounds(),m=5,j=3;this.bounds=this.setBounds(Y.x+j,Y.y-m+1,Y.width-j*2,Y.height+m),i&&(this.saturation=-100);var S=i;Object.defineProperty(X,"monochrome",{get:function(){return S},set:function(_){_!=S&&(S=_,_&&(this.saturation=_?-100:0))}}),this.cache=function(_,R,U,Z){return n(_)?(R=this.getBounds(),this.zimLabel_cache(R.x-20,R.y-20,R.width+40,R.height+40)):this.zimLabel_cache(_,R,U,Z),X.z_bc=X.canvas=X.cacheCanvas,this},A!==!1&&t.styleTransforms(this,v),this.clone=function(_){return X.cloneProps(new t.Emoji(_||!t.isPick(w[0])?e:w[0],_||!t.isPick(w[1])?X.size:w[1],i,l,a,s,f,u,y,k,g,O,T,E,A,X.group,d))}},t.extend(t.Emoji,t.Label,["clone","cache"],"zimLabel",!1),t.Button=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue,ge,ie,xe,Se,z,pe,de,oe,Be,$,Me){var be="width, height, label, backgroundColor, rollBackgroundColor, downBackgroundColor, color, rollColor, downColor, borderColor, borderWidth, rollBorderColor, downBorderColor, backing, rollBacking, downBacking, icon, rollIcon, downIcon, corner, dashed, shadowColor, shadowBlur, gradient, gloss, align, valign, indent, indentH, indentV, hitPadding, autoPadding, autoPaddingH, autoPaddingV, rollPersist, toggle, toggleBackgroundColor, rollToggleBackgroundColor, downToggleBackgroundColor, toggleColor, rollToggleColor, downToggleColor, toggleBacking, rollToggleBacking, downToggleBacking, toggleIcon, rollToggleIcon, downToggleIcon, toggleEvent, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, downWaitBackgroundColor, waitColor, rollWaitColor, downWaitColor, waitBacking, rollWaitBacking, downWaitBacking, waitIcon, rollWaitIcon, downWaitIcon, waitModal, waitEnabled, style, group, inherit",me;if(me=st(t.Button,arguments,be,this))return me;De("55"),this.group=$;var re=Be===!1?{}:t.getStyle("Button",$,Me);n(e)&&(e=re.width!=null?re.width:200),n(r)&&(r=re.height!=null?re.height:60),n(ee.M)&&(ee.M=t.mobile());var ke=f,Re=u,Ye=y;n(f)&&(f=re.color!=null?re.color:t.white),n(u)&&(u=re.rollColor!=null?re.rollColor:t.white),n(K)&&(K=re.autoPadding!=null?re.autoPadding:20),n(ne)&&(ne=re.autoPaddingH!=null?re.autoPaddingH:K),n(V)&&(V=re.autoPaddingV!=null?re.autoPaddingV:K),n(j)&&(j=re.align!=null?re.align:"center"),n(S)&&(S=re.valign!=null?re.valign:"center"),n(i)&&(n(d)?i=re.label!=null?re.label:"PRESS":i=""),typeof i=="string"||typeof i=="number"?i=new t.Label({text:i,size:re.size!=null?re.size:36,font:re.font!=null?re.font:"arial",color:re.color!=null&&ke==null?re.color:f,rollColor:re.rollColor&&Re==null!=null?re.rollColor:u,align:j,valign:S,rollPersist:re.rollPersist!=null?re.rollPersist:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",shiftV:re.shiftV!=null?re.shiftV:0,shiftH:re.shiftH!=null?re.shiftH:0,style:!1,group:this.group}):(n(ke)||(i.color=ke),f=i.color,(n(i.rollColor)||!n(Re))&&(i.rollColor=u),u=i.rollColor),n(y)&&(y=re.downColor!=null?re.downColor:u),e=="auto"&&(e=i.width+ne*2),r=="auto"&&(r=i.height+V*2),this.zimContainer_constructor(e,r,null,null,!1),this.type="Button",n(l)&&(l=re.backgroundColor!=null?re.backgroundColor:t.purple),n(a)&&(a=re.rollBackgroundColor!=null?re.rollBackgroundColor:l.lighten(.2)),n(s)&&(s=re.downBackgroundColor!=null?re.downBackgroundColor:a);var $e=it(l,a,s,f,u,y);this.veeObj={backgroundColor:$e[0],rollBackgroundColor:$e[1],downBackgroundColor:$e[2],color:$e[3],rollColor:$e[4],downColor:$e[5]};function it(){return arguments}l=nt(l),a=nt(a),s=nt(s),f=nt(f),u=nt(u),y=nt(y);var Le=k,Ze=g;n(k)&&(k=re.borderColor!=null?re.borderColor:null),n(g)&&(g=re.borderWidth!=null?re.borderWidth:null),k<0||g<0?k=g=null:k!=null&&g==null&&(g=1),n(O)&&(O=re.rollBorderColor!=null?re.rollBorderColor:k),n(T)&&(T=re.downBorderColor!=null?re.downBorderColor:O),n(v)&&(v=re.corner!=null?re.corner:10),n(b)&&(b=re.shadowColor!=null?re.shadowColor:"rgba(0,0,0,.3)"),n(X)&&(X=re.shadowBlur!=null?re.shadowBlur:14),n(Z)&&(Z=re.hitPadding!=null?re.hitPadding:0),n(_)&&(_=re.indent!=null?re.indent:10),n(R)&&(R=re.indentH!=null?re.indentH:_),n(U)&&(U=re.indentV!=null?re.indentV:_),n(Y)&&(Y=re.gradient!=null?re.gradient:0),n(m)&&(m=re.gloss!=null?re.gloss:0);var ze=(!n(c)||!n(we)||!n(B)||!n(F)||!n(fe)||!n(se)||!n(Q))&&n(le)&&n(ge)&&n(ie);ze&&n(te)&&(te=ee.M?"mousedown":"click"),n(D)&&(D=re.rollPersist!=null?re.rollPersist:!1),this.rollPersist=D,n(w)&&(w=re.dashed!=null?re.dashed:!1),!n(c)&&c.type=="Label"&&vt&&tt("Button() - do not pass Label to toggle parameter - just pass a String"),n(h)&&(h=re.toggleBackgroundColor!=null?re.toggleBackgroundColor:l),n(o)&&(o=re.rollToggleBackgroundColor!=null?re.rollToggleBackgroundColor:a),n(I)&&(I=re.downToggleBackgroundColor!=null?re.downToggleBackgroundColor:o),n(N)&&(N=re.toggleColor!=null?re.toggleColor:i.color),n(p)&&(p=re.rollToggleColor!=null?re.rollToggleColor:i.rollColor),n(L)&&(L=re.downToggleColor!=null?re.downToggleColor:i.rollToggleColor),n(J)&&(J=re.waitBackgroundColor!=null?re.waitBackgroundColor:l),n(Te)&&(Te=re.rollWaitBackgroundColor!=null?re.rollWaitBackgroundColor:a),n(G)&&(G=re.downWaitBackgroundColor!=null?re.downWaitBackgroundColor:a),n(ce)&&(ce=re.waitColor!=null?re.waitColor:i.color),n(q)&&(q=re.rollWaitColor!=null?re.rollWaitColor:i.rollColor),n(ue)&&(ue=re.downWaitColor!=null?re.downWaitColor:q);var ve=this;this.mouseChildren=!1,this.cur("pointer"),ve.focus=!1,ve.rolled=!1;var Pe=Tt(Ae);n(E)&&(E=re.backing!=null?re.backing.clone():null),n(E)?ve.backing=new t.Rectangle(e,r,l,null,null,v,w,null,null,!1).centerReg(null,null,!1):ve.backing=E,ve.rollBacking=n(A)?re.rollBacking!=null?re.rollBacking.clone():null:A,ve.downBacking=n(C)?re.downBacking!=null?re.downBacking.clone():null:C,ve.waitBacking=n(ge)?re.waitBacking!=null?re.waitBacking.clone():null:ge,ve.rollWaitBacking=n(ie)?re.rollWaitBacking!=null?re.rollWaitBacking.clone():null:ie,ve.downWaitBacking=n(xe)?re.downWaitBacking!=null?re.downWaitBacking.clone():null:xe,ve.toggleBacking=n(we)?re.toggleBacking!=null?re.toggleBacking.clone():null:we,ve.rollToggleBacking=n(B)?re.rollToggleBacking!=null?re.rollToggleBacking.clone():null:B,ve.downToggleBacking=n(F)?re.downToggleBacking!=null?re.downToggleBacking.clone():null:F;var ae=["backing","rollBacking","downBacking","toggleBacking","rollToggleBacking","downToggleBacking","waitBacking","rollWaitBacking","downWaitBacking"],Ne,Ke,Xe;for(Xe=0;Xe<ae.length;Xe++)Ne=ae[Xe],Ke=ve[Ne],Ke&&(Ke.type=="Pattern"?Ke=Qe(Ne,Ke):b!=-1&&X>0&&(Ke.shadow=new Fe.Shadow(b,3,3,X)),Ke.x=e/2,Ke.y=r/2);ve.addChild(ve.backing),g&&(ve.border=new t.Rectangle(e,r,"rgba(0,0,0,0)",k,g,v,w,null,null,!1),ve.addChild(ve.border));function Qe(ft,bt){if(ve[ft]=new t.Container(e,r,null,null,!1).centerReg(null,null,!1),b!=-1&&X>0){var Gt=new t.Rectangle(e-2,r-2,"#666",null,null,v,null,null,null,!1).center(ve[ft]);Gt.shadow=new Fe.Shadow(b,3,3,X)}var Kt=ve[ft].mask=new t.Rectangle(e,r,ft.indexOf("roll")>=0?a:l,null,null,v,null,null,null,!1).addTo(ve[ft]);return bt.centerReg(Kt),bt.setMask(Kt.shape),ve[ft].pattern=bt,ve[ft]}ve.icon=n(d)?re.icon!=null?re.icon.clone():null:d,ve.rollIcon=n(x)?re.rollIcon!=null?re.rollIcon.clone():null:x,ve.downIcon=n(P)?re.downIcon!=null?re.downIcon.clone():null:P,ve.waitIcon=n(Se)?re.waitIcon!=null?re.waitIcon.clone():null:Se,ve.rollWaitIcon=n(z)?re.rollWaitIcon!=null?re.rollWaitIcon.clone():null:z,ve.downWaitIcon=n(pe)?re.downWaitIcon!=null?re.downWaitIcon.clone():null:pe,ve.toggleIcon=n(fe)?re.toggleIcon!=null?re.toggleIcon.clone():null:fe,ve.rollToggleIcon=n(se)?re.rollToggleIcon!=null?re.rollToggleIcon.clone():null:se,ve.downToggleIcon=n(Q)?re.downToggleIcon!=null?re.downToggleIcon.clone():null:Q;var he=["icon","rollIcon","downIcon","toggleIcon","rollToggleIcon","downToggleIcon","waitIcon","rollWaitIcon","downWaitIcon"];for(Xe=0;Xe<he.length;Xe++){var Ge=he[Xe],Ie=ve[Ge];Ie&&(Ie.x=e/2,Ie.y=r/2)}if(ve.icon&&ve.addChild(ve.icon),Array.isArray(v)||(v=[v,v,v,v]),Y>0){var _e=new Fe.Shape;_e.graphics.lf(["rgba(255,255,255,"+Y+")","rgba(0,0,0,"+Y+")"],[0,1],0,0,0,r-g),_e.graphics.rc(g/2,g/2,e-g,r-g,v[0],v[1],v[2],v[3]),this.addChild(_e)}if(m>0){var Je=new Fe.Shape;Je.graphics.f("rgba(255,255,255,"+m+")"),Je.graphics.rc(g/2,g/2,e-g,(r-g)/2,v[0],v[1],0,0),Je.graphics.f("rgba(0,0,0,"+m+")"),Je.graphics.rc(g/2,r/2,e-g,(r-g)/2,0,0,v[2],v[3]),this.addChild(Je)}var Oe,Ve;Z>0&&rt();function rt(){Ve=new Fe.Shape,Ve.graphics.f("#000").r(-Z,-Z,e+Z*2,r+Z*2),ve.hitArea=Oe=Ve}this.addChild(i),i.center(this),i.y+=1,this.label=i,t.pos(i,j=="left"||j=="right"?R:null,S=="top"||S=="bottom"?U:null,j=="right",S=="bottom");var Ce=i.color;if(this.toggled=!1,ze){var We=i.text,lt=i.color,Ue=i.rollColor;this.on(te,function(){ve.toggled=!ve.toggled,ct()})}function ct(){ve.toggled?(n(c)||(ve.label.text=c===!0?We:c),n(N)||(ve.label.colorOnly=Ce=N),n(p)||(ve.label.rollColor=p),ve.rolled?(ve.rollToggleBacking?kt("rollToggleBacking"):ve.toggleBacking&&kt("toggleBacking"),ve.rollToggleIcon?kt("rollToggleIcon"):ve.toggleIcon&&kt("toggleIcon"),n(E)&&n(ve.rollToggleBacking)&&(ve.backing.color=o)):(ve.toggleBacking&&kt("toggleBacking"),ve.toggleIcon&&kt("toggleIcon"),n(E)&&(ve.backing.color=h))):(ve.label.colorOnly=Ce=lt,ve.label.rollColor=Ue,ve.rolled&&ve.label.showRollColor(!0),ve.label.text=We,ot()),ve.stage&&ve.stage.update()}function ot(){ve.pressed?(n(E)&&ve.backing&&!ve.downBacking&&(ve.backing.color=s),ve.downBacking?kt("downBacking"):ve.rollBacking?kt("rollBacking"):ve.backing&&kt("backing"),ve.downIcon?kt("downIcon"):ve.rollIcon?kt("rollIcon"):ve.icon?kt("icon"):kt("icon",null)):ve.rolled?(n(E)&&ve.backing&&!ve.rollBacking&&(ve.backing.color=a),ve.rollBacking?kt("rollBacking"):ve.backing&&kt("backing"),ve.rollIcon?kt("rollIcon"):ve.icon?kt("icon"):kt("icon",null)):(n(E)&&ve.backing&&(ve.backing.color=l),ve.backing&&kt("backing"),ve.icon,kt("icon"))}this.toggle=function(ft){return ze?(n(ft)?ve.toggled=!ve.toggled:ve.toggled=ft,ct(),ve):(vt&&tt("Button() - can't toggle with wait parameters provided"),ve)};var dt=!1;ve.waiting=!1;var et=!1,St,ht,gt=ve.label.color,Bt=ve.label.rollColor,Dt,Ht,nn=this.on("mousedown",function(){dt=!0,en()});function en(){(!n(le)||!n(ge)||!n(ie))&&!ve.waiting&&(et=!0,n(oe)&&(oe=!0),de&&(Ht=ve.stage.on("stagemousedown",function(ft){ve.hitTestPoint(ft.stageX/t.scaX,ft.stageY/t.scaY)||ve.clearWait()},null,!0)),setTimeout(function(){ve.waiting=!0},50),ht=i.text,n(ce)||(ve.label.colorOnly=Ce=ce),n(q)||(ve.label.rollColor=q),Dt=ve.enabled,!oe&&ve.enabled&&(ve.enabled=!1),n(le)||(ve.label.text=le),ve.rolled?(n(E)&&!ve.rollWaitBacking&&(ve.backing.color=Te),ve.rollWaitBacking?kt("rollWaitBacking"):ve.waitBacking&&kt("waitBacking"),ve.rollWaitIcon?kt("rollWaitIcon"):ve.waitIcon&&kt("waitIcon")):(n(E)&&!ve.waitBacking&&(ve.backing.color=J),ve.waitBacking&&kt("waitBacking"),ve.waitIcon&&kt("waitIcon")),n(Ae)&&(Ae=Pe=="s"?5:5e3),St&&St.clear(),St=t.timeout(Ae,function(){ve.enabled||(ve.enabled=Dt),ve.clearWait(),ve.dispatchEvent("waited")}),ve.stage&&ve.stage.update())}this.wait=en,this.clearWait=function(){return St&&(Ht&&ve.stage.off("stagemousedown",Ht),St.clear(),ve.label.text=ht,ot(),ve.label.colorOnly=Ce=gt,ve.label.rollColor=Bt,setTimeout(function(){ve.waiting=!1},55),et=!1,ve.stage&&ve.stage.update()),ve},this.removeWait=function(){return ve.clearWait(),le=null,ve.waitBacking=null,ve.rollWaitBacking=null,ve.off("mousedown",nn),ve};function kt(ft,bt){var Gt;if(ft.indexOf("con")>=0){for(Gt=0;Gt<he.length;Gt++){var Kt=he[Gt],fn=ve[Kt];ve.removeChild(fn)}ve[ft]&&ve.addChildAt(ve[ft],1)}else{if(!ve[ft]&&!bt)return;for(Gt=0;Gt<ae.length;Gt++){var Jt=ae[Gt],rn=ve[Jt];ve.removeChild(rn)}ve[ft]&&ve.addChildAt(ve[ft],0)}}var Qt=!1;this.on("mouseover",function(ft){ve.stage&&ve.stage.frame.leftMouseDown&&!yt||He()});function He(){ve.rolled=!0,Qt=!0,et?(ve.pressed&&ve.downWaitBacking?kt("downWaitBacking"):ve.pressed&&ve.downBacking?kt("downBacking"):ve.rollWaitBacking?kt("rollWaitBacking"):ve.waitBacking?kt("waitBacking"):ve.rollBacking?kt("rollBacking"):kt("backing"),ve.pressed&&ve.downWaitIcon?kt("downWaitIcon"):ve.rollWaitIcon?kt("rollWaitIcon"):ve.waitIcon?kt("waitIcon"):ve.rollIcon?kt("rollIcon"):kt("icon",!0)):ze&&ve.toggled?(ve.pressed&&ve.downToggleBacking?kt("downToggleBacking"):ve.pressed&&ve.downBacking?kt("downBacking"):ve.rollToggleBacking?kt("rollToggleBacking"):ve.toggleBacking?kt("toggleBacking"):ve.rollBacking?kt("rollBacking"):kt("backing"),ve.pressed&&ve.downToggleIcon?kt("downToggleIcon"):ve.rollToggleIcon?kt("rollToggleIcon"):ve.toggleIcon?kt("toggleIcon"):ve.rollIcon?kt("rollIcon"):kt("icon",!0)):(ve.pressed&&ve.downBacking?kt("downBacking"):ve.rollBacking?kt("rollBacking"):kt("backing"),ve.pressed&&ve.downIcon?kt("downIcon"):ve.rollIcon?kt("rollIcon"):kt("icon",!0)),ve.pressed?n(E)&&ve.backing?ve.backing.color=s:E&&!n(E.mask)&&ve.backing&&(ve.backing.mask.color=s):n(E)&&ve.backing?ve.backing.color=a:E&&!n(E.mask)&&ve.backing&&(ve.backing.mask.color=a),ve.border&&(ve.border.borderColor=ve.pressed?T:O),ve.pressed?ve.label.colorOnly=y:ve.label.showRollColor?ve.label.showRollColor():ve.label.colorOnly=Ce,ve.stage&&ve.stage.update()}var yt=!1;this.on("mousedown",function(){ve.pressed=yt=!0,He(),ve.rolled}),this.on("pressup",function(){ve.pressed=yt=dt=!1,Qt?He():ve.rollPersist&&Xt(),ee.M&&Mt()}),this.on("pressmove",function(){var ft=ve.stage?ve.stage.frame:ee.zdf,bt=ve.hitTestPoint(ft.mouseX,ft.mouseY);yt&&!bt?(Mt(),yt=!1):!yt&&bt&&(He(),yt=!0)}),this.on("mouseout",Mt);function Mt(){Qt=!1,ve.rollPersist&&dt||Xt()}function Xt(){ve.rolled=!1,et||ve.waiting?(n(E)&&ve.backing&&n(ve.waitBacking)&&(ve.backing.color=n(J)?l:J),ve.waitBacking?kt("waitBacking"):ve.backing&&kt("backing"),ve.waitIcon?kt("waitIcon"):ve.icon?kt("icon"):kt("icon",null)):ve.toggled&&ze?(n(E)&&ve.backing&&n(ve.toggleBacking)&&(ve.backing.color=h),ve.toggleBacking?kt("toggleBacking"):ve.backing&&kt("backing"),ve.toggleIcon?kt("toggleIcon"):ve.icon?kt("icon"):kt("icon",null)):(n(E)&&ve.backing?ve.backing.color=l:E&&!n(E.mask)&&ve.backing&&(ve.backing.mask.color=l),ve.backing&&kt("backing"),ve.icon?kt("icon"):kt("icon",null)),ve.border&&(ve.border.borderColor=k),ve.label.colorOnly=Ce,ve.label.showRollColor&&ve.label.showRollColor(!1),ve.stage&&ve.stage.update()}ve.removeRoll=Xt,ve.rollBacking&&ve.rollBacking.removeFrom(),Object.defineProperty(ve,"text",{get:function(){var ft=i.text==" "?"":i.text;return ft},set:function(ft){i.text=ft,We&&(We=ft),i.center(this),i.y+=1,t.pos(i,j=="left"||j=="right"?R:null,S=="top"||S=="bottom"?U:null,j=="right",S=="bottom")}}),Object.defineProperty(ve,"color",{get:function(){return f},set:function(ft){f=ft,lt&&(lt=f),ve.label&&!n(ve.label.color)&&(ve.label.color=Ce=f),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&ve.stage&&ve.stage.update()}}),Object.defineProperty(ve,"rollColor",{get:function(){return u},set:function(ft){u=ft,Ue&&(Ue=u),ve.label&&(ve.label.rollColor=u)}}),Object.defineProperty(ve,"downColor",{get:function(){return y},set:function(ft){y=ft,originalDownColor&&(originalDownColor=y),ve.label&&(ve.label.downColor=y)}}),Object.defineProperty(ve,"backgroundColor",{get:function(){return l},set:function(ft){l=ft,ve.backing.color?ve.backing.color=l:ve.backing.mask&&(ve.backing.mask.color=l),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&ve.stage&&ve.stage.update()}}),Object.defineProperty(ve,"rollBackgroundColor",{get:function(){return a},set:function(ft){a=ft,ve.rollBacking&&ve.rollBacking.color?ve.rollBacking.color=a:ve.rollBacking&&ve.rollBacking.mask&&(ve.rollBacking.mask.color=a)}}),Object.defineProperty(ve,"toggleBackgroundColor",{get:function(){return h},set:function(ft){h=ft,ve.toggleBacking&&ve.toggleBacking.color?ve.toggleBacking.color=h:ve.toggleBacking&&ve.toggleBacking.mask&&(ve.toggleBacking.mask.color=h)}}),Object.defineProperty(ve,"rollToggleBackgroundColor",{get:function(){return o},set:function(ft){o=ft,ve.rollToggleBacking&&ve.rollToggleBacking.color?ve.rollToggleBacking.color=o:ve.rollToggleBacking&&ve.rollToggleBacking.mask&&(ve.rollToggleBacking.mask.color=o)}}),Object.defineProperty(ve,"downBackgroundColor",{get:function(){return s},set:function(ft){s=ft,ve.downBacking&&ve.downBacking.color?ve.downBacking.color=s:ve.downBacking&&ve.downBacking.mask&&(ve.downBacking.mask.color=s)}}),Object.defineProperty(ve,"borderColor",{get:function(){return k},set:function(ft){k=ft,ve.rolled||(ve.backing&&ve.backing.borderColor&&(ve.backing.borderColor=ft),ve.border&&(ve.border.borderColor=ft))}}),Object.defineProperty(ve,"rollBorderColor",{get:function(){return O},set:function(ft){O=ft,ve.rolled&&(ve.backing&&ve.backing.borderColor&&(ve.backing.borderColor=ft),ve.border&&(ve.border.borderColor=ft))}}),Object.defineProperty(ve,"hitPadding",{get:function(){return Z},set:function(ft){Z=ft,Z==0?Oe&&(this.hitArea=null):rt()}}),this._enabled=!0,this.startMouseChildren=this.mouseChildren,Object.defineProperty(ve,"enabled",{get:function(){return ve._enabled},set:function(ft){ve._enabled&&(ve.startMouseChildren=ve.mouseChildren),ft?(Ot(ve,ft),ve.mouseChildren=ve.startMouseChildren):(Xt(),Ot(ve,ft));var bt=i.color;i.color=Ce=bt,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&ve.stage&&ve.stage.update()}}),this.setBacking=function(ft,bt){Yt(ft,bt)},this.setIcon=function(ft,bt){Yt(ft,bt)};function Yt(ft,bt){return n(ft)||(ve.contains(ve[ft])&&(ve.removeChild(ve[ft]),bt&&ve.addChildAt(bt,ft.indexOf("con")>=0?ve.numChildren-1:0),ve.stage&&ve.stage.update()),bt?(n(E)&&ft=="backing"&&(E=bt),bt.type=="Pattern"&&(bt=Qe(ft,bt)),ve[ft]=bt,ve[ft].x=e/2,ve[ft].y=r/2):ve[ft]=null,ot()),ve}Be!==!1&&t.styleTransforms(this,re),this.clone=function(ft){var bt=new t.Button(e,r,i.clone(),ft||!t.isPick($e[0])?l:$e[0],ft||!t.isPick($e[1])?a:$e[1],ft||!t.isPick($e[2])?s:$e[2],ft||!t.isPick($e[3])?f:$e[3],ft||!t.isPick($e[4])?u:$e[4],ft||!t.isPick($e[5])?y:$e[5],Le,Ze,O,T,n(E)?null:ve.backing.clone(),n(A)?null:ve.rollBacking.clone(),n(C)?null:ve.downBacking.clone(),n(d)?null:d.clone(),n(x)?null:x.clone(),n(P)?null:P.clone(),v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,n(we)?null:we.clone(),n(B)?null:B.clone(),n(F)?null:F.clone(),n(fe)?null:fe.clone(),n(se)?null:se.clone(),n(Q)?null:Q.clone(),te,le,Ae,J,Te,G,ce,q,ue,n(ge)?null:ge.clone(),n(ie)?null:ie.clone(),n(xe)?null:xe.clone(),n(Se)?null:Se.clone(),n(z)?null:z.clone(),n(pe)?null:pe.clone(),de,oe,Be,this.group,Me);return ve.cloneProps(bt)},this.doDispose=function(ft,bt,Gt){return ve.icon&&ve.icon.dispose(),ve.rollIcon&&ve.rollIcon.dispose(),ve.downIcon&&ve.downIcon.dispose(),ve.waitIcon&&ve.waitIcon.dispose(),ve.rollWaitIcon&&ve.rollWaitIcon.dispose(),ve.downWaitIcon&&ve.downWaitIcon.dispose(),ve.toggleIcon&&ve.toggleIcon.dispose(),ve.rollToggleIcon&&ve.rollToggleIcon.dispose(),ve.downToggleIcon&&ve.downToggleIcon.dispose(),ve.icon=ve.rollIcon=ve.downIcon=ve.waitIcon=ve.rollWaitIcon=ve.downWaitIcon=ve.toggleIcon=ve.rollToggleIcon=ve.downToggleIcon=null,Gt||this.zimContainer_dispose(!0),!0}},t.extend(t.Button,t.Container,["clone","dispose"],"zimContainer",!1),t.Button.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.CheckBox=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C){var d="size, label, startChecked, color, backgroundColor, borderColor, borderWidth, corner, margin, indicatorType, indicatorColor, tap, rtl, style, group, inherit",x;if(x=st(t.CheckBox,arguments,d,this))return x;De("56"),this.zimContainer_constructor(null,null,null,null,!1),this.type="CheckBox",this.group=A;var P=E===!1?{}:t.getStyle(this.type,this.group,C);n(e)&&(e=P.size!=null?P.size:60),n(r)&&(r=P.label!=null?P.label:null),n(i)&&(i=P.startChecked!=null?P.startChecked:!1),n(l)&&(l=P.color!=null?P.color:t.darker),n(a)&&(a=P.backgroundColor!=null?P.backgroundColor:t.white.toAlpha(.8)),n(s)&&(s=P.borderColor!=null?P.borderColor:t.darker),n(f)&&(f=P.borderWidth!=null?P.borderWidth:e/10),s<0||f<0?s=f=null:s!=null&&f==null&&(f=e/10),n(u)&&(u=P.corner!=null?P.corner:0),n(y)&&(y=P.margin!=null?P.margin:e/5),k!="box"&&k!="square"&&k!="x"&&(k=P.indicatorType!=null?P.indicatorType:"check"),n(g)&&(g=P.indicatorColor!=null?P.indicatorColor:f>0?s:t.black),this.setBounds(-y,-y,e+y*2,e+y*2),n(O)&&(O=P.tap!=null?P.tap:!1),n(T)&&(T=P.rtl!=null?P.rtl:ee.DIR=="rtl");var v=this;this.cur("pointer");var w=b(r,i);this.veeObj={label:w[0],startChecked:w[1]};function b(){return arguments}r=t.Pick.choose(r),i=t.Pick.choose(i);var X=i;(typeof r=="string"||typeof r=="number")&&(r=new t.Label({text:r,size:e*5/6,color:l,valign:"center",align:T?"right":"left",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:E,group:this.group}));var Y=this.box=new t.Rectangle(e,e,a,null,null,u),m=this.box2=new t.Rectangle(e*5/7,e*5/7,"rgba(0,0,0,0)",s,f,u);m.x=e/7,m.y=e/7,this.addChild(Y,m);var j=e;r&&(r.center(v),this.label=r,T?(r.x=-y,this.setBounds(-r.width-y*2,-y,e+y*3+r.getBounds().width,Math.max(e+y*2,r.getBounds().height)),j=e+r.width+y,this.regX=e):(r.x=v.getBounds().width,this.setBounds(-y,-y,e+y*4+r.getBounds().width,Math.max(e+y*2,r.getBounds().height)),j=r.x+r.width));var S=new t.Shape({style:!1}),_=S.graphics;_.f("rgba(0,0,0,.01)").r(this.getBounds().x,this.getBounds().y,j+y*2,this.getBounds().height),this.hitArea=S;var R=new t.Shape({style:!1}),U=R.graphics;k=="check"?U.f(g).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"):k=="box"||k=="square"?U.f(g).dr(-35,-35,70,70):U.f(g).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg");var Z=95;R.setBounds(-Z/2,-Z/2,Z,Z);var K=e/(Z+66);R.scaleX=R.scaleY=K,R.alpha=.9,R.x=e/2,R.y=e/2,X&&this.addChild(R),O?this.tap(ne):this.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",ne),Object.defineProperty(v,"checked",{get:function(){return X},set:function(V){v.setChecked(V)}}),this.toggle=function(V){n(V)&&(V=!X),v.setChecked(V)},Object.defineProperty(v,"toggled",{get:function(){return X},set:function(V){v.setChecked(V)}}),Object.defineProperty(v,"text",{get:function(){return r?r.text:null},set:function(V){r&&(r.text=V,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&v.stage&&v.stage.update())}}),Object.defineProperty(R,"indicatorColor",{get:function(){return g},set:function(V){X&&v.removeChild(R),R=new Fe.Shape,U=R.graphics,g=V,U.f(g).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg"),R.scaleX=R.scaleY=K,R.alpha=.9,R.x=e/2,R.y=e/2,X&&v.addChild(R),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&v.stage&&v.stage.update()}}),Object.defineProperty(v,"indicator",{get:function(){return R},set:function(){tt("ZIM CheckBox - check is read only")}}),this._enabled=!0,Object.defineProperty(v,"enabled",{get:function(){return v._enabled},set:function(V){Ot(v,V)}});function ne(){X=!X,v.setChecked(X),v.dispatchEvent("change")}this.setChecked=function(V){return n(V)&&(V=!0),X=V,X?v.addChild(R):v.removeChild(R),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&v.stage&&v.stage.update(),v},E!==!1&&t.styleTransforms(this,P),this.clone=function(V){return v.cloneProps(new t.CheckBox(e,V||!t.isPick(w[0])?r?r.clone():null:w[0],V||!t.isPick(w[1])?i:w[1],l,a,s,f,u,y,k,g,O,T,E,this.group,C))}},t.extend(t.CheckBox,t.Container,"clone","zimContainer",!1),t.RadioButtons=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C){var d="size, buttons, vertical, color, backgroundColor, borderColor, borderWidth, spacing, margin, always, indicatorColor, selectedIndex, rtl, style, group, inherit",x;if(x=st(t.RadioButtons,arguments,d,this))return x;De("57"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadioButtons",this.group=A;var P=E===!1?{}:t.getStyle(this.type,this.group,C);n(e)&&(e=P.size!=null?P.size:60),e=Math.max(5,e),n(r)&&(r=P.buttons!=null?P.buttons:["A","B","C"]),n(i)&&(i=P.vertical!=null?P.vertical:!0),n(l)&&(l=P.color!=null?P.color:t.darker),n(a)&&(a=P.backgroundColor!=null?P.backgroundColor:"rgba(255,255,255,.8)"),n(s)&&(s=P.borderColor!=null?P.borderColor:t.darker),n(f)&&(f=P.borderWidth!=null?P.borderWidth:e/9),s<0||f<0?s=f=null:s!=null&&f==null&&(f=e/10),n(u)&&(u=i?P.spacing!=null?P.spacing:e*.2:P.spacing!=null?P.spacing:e),n(y)&&(y=P.margin!=null?P.margin:e/5),n(k)&&(k=P.always!=null?P.always:!1),n(g)&&(g=P.indicatorColor!=null?P.indicatorColor:f>0?s:t.black),n(T)&&(T=P.rtl!=null?P.rtl:ee.DIR=="rtl");var v=this;this.cur("pointer"),this.labels=[],this.indicators=[];var w=0,b;if(typeof r=="string"){var X=r;r=[];for(var Y=0;Y<X.length;Y++)r.push({label:X[Y]})}var m=new t.Container({style:!1});this.addChild(m);function j(Z){var K=m.getChildIndex(Z.target);k&&v.selectedIndex==K||(v.setSelected(K),v.dispatchEvent("change"))}R();for(var S,_=0;_<m.numChildren;_++)S=m.getChildAt(_),S.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",j);function R(){var Z,K=!1,ne;for(ne=r.length-1;ne>=0;ne--)Z=r[ne],Z.selected&&Z.selected===!0&&(K?Z.selected="false":(K=!0,v.id=Z.id));m.removeAllChildren(),v.buttons=[];var V,D=0;for(ne=0;ne<r.length;ne++){if(Z=r[ne],typeof Z=="string"||typeof Z=="number"){var c={selected:!1,label:new t.Label({text:Z,size:e*5/6,color:P.color!=null?P.color:l,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",style:E,group:v.group})};Z=c}(Z.label&&typeof Z.label=="string"||typeof Z.label=="number")&&(Z.label=new t.Label({text:Z.label,size:P.size!=null?P.size:e*5/6,color:P.color!=null?P.color:l,valign:"center",style:E})),v.labels.push(Z.label),Z.index=ne,r[ne]=Z,V=U(Z.selected,Z.label),V.type="RadioButton",V.obj=Z,Z.selected&&(b=V.obj),m.addChild(V),i?(V.y=D,D+=V.getBounds().height+u):(V.x=D,D+=V.getBounds().width+u)}}function U(Z,K){var ne=new t.Container({style:!1});v.buttons.push(ne),ne.mouseChildren=!1,ne.setBounds(-y,-y,e+y*2,e+y*2);var V=new t.Shape({style:!1}),D=V.graphics;D.f(a).dc(e/2,e/2,e/1.85),D.s(s).ss(f).dc(e/2,e/2,e/2-e/2/5),ne.addChild(V);var c=ne.check=new t.Circle(e/5.2,g,null,null,null,null,null,null,!1);v.indicators.push(c),c.mouseEnabled=!1,c.alpha=.95,c.regX=c.regY=-e/2;var h=e;K&&(w==0&&(w=K.width),ne.addChild(K),K.y=e/2,ne.text=K.text,T?(K.x=-K.width-y,ne.setBounds(-K.width-y,-y,e+y*2+K.getBounds().width,Math.max(e+y*2,K.getBounds().height)),h=K.width+y+e):(K.x=ne.getBounds().width,ne.setBounds(-y,-y,e+y*2+K.getBounds().width,Math.max(e+y*2,K.getBounds().height)),h=K.x+K.width)),Z&&(ne.addChild(c),v.label=K,v.label&&(v.text=K.text));var o=new t.Shape({style:!1});return D=o.graphics,D.f("rgba(0,0,0,.01)").r(ne.getBounds().x,ne.getBounds().y,h+y*2,ne.getBounds().height),ne.hitArea=o,ne}this.getBounds()||this.setBounds(0,0,e,e),T?(this.setBounds(-y*2-w,-y,this.getBounds().width+y*2,this.getBounds().height),this.regX=i?e+y:this.getBounds().width-w-y*3):this.setBounds(-y,-y,this.getBounds().width+y*2,this.getBounds().height),this.setSelected=function(Z){if(n(Z)&&(Z=-1),!(Z!=-1&&!m.getChildAt(Z))){for(var K,ne=0;ne<m.numChildren;ne++)K=m.getChildAt(ne),K.removeChild(K.check);if(Z>=0){K=m.getChildAt(Z);var V=-2;b&&(V=b.index),b=K.obj}return Z==-1||V==b.index?(b=null,v.id=null,v.label=null,v.text=""):(K.addChild(K.check),v.id=b.id,v.label=b.label,v.label&&(v.text=v.label.text)),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&v.stage&&v.stage.update(),v}},Object.defineProperty(v,"selected",{get:function(){return b},set:function(){tt("ZIM RadioButton - selected is read only")}}),Object.defineProperty(v,"selectedIndex",{get:function(){return b?b.index:-1},set:function(Z){var K=Z;v.selectedIndex!=Z&&v.setSelected(K)}}),this._enabled=!0,Object.defineProperty(v,"enabled",{get:function(){return v._enabled},set:function(Z){Ot(v,Z)}}),n(O)&&(O=P.selectedIndex!=null?P.selectedIndex:0),v.selectedIndex=O,E!==!1&&t.styleTransforms(this,P),this.clone=function(){for(var Z=t.copy(r),K=0;K<Z.length;K++)Z[K].label=Z[K].label.clone();return v.cloneProps(new t.RadioButtons(e,Z,i,l,a,s,f,u,y,k,g,O,T,E,this.group,C))}},t.extend(t.RadioButtons,t.Container,"clone","zimContainer",!1),t.Toggle=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b){var X="width, height, label, startToggled, backgroundColor, margin, indicatorType, indicatorColor, tap, toggleBackgroundColor, color, borderColor, borderWidth, corner, indicatorCorner, shadowColor, shadowBlur, time, labelLeft, style, group, inherit",Y;if(Y=st(t.Toggle,arguments,X,this))return Y;De("57.5"),this.group=w;var m=v===!1?{}:t.getStyle("Toggle",this.group,b);n(e)&&(e=m.width!=null?m.width:80),n(r)&&(r=m.height!=null?m.height:50),this.zimContainer_constructor(e,r,null,null,!1),this.type="Toggle",n(a)&&(a=m.backgroundColor!=null?m.backgroundColor:t.purple),n(s)&&(s=m.margin!=null?m.margin:10),n(f)&&(f=m.indicatorType!=null?m.indicatorType:"circle"),n(u)&&(u=m.indicatorColor!=null?m.indicatorColor:t.white),n(k)&&(k=m.toggleBackgroundColor!=null?m.toggleBackgroundColor:a.lighten(.3)),n(g)&&(g=m.color!=null?m.color:t.darker),n(O)&&(O=m.borderColor!=null?m.borderColor:null),n(T)&&(T=m.borderWidth!=null?m.borderWidth:null),O<0||T<0?O=T=null:O!=null&&T==null&&(T=1),n(E)&&(E=m.corner!=null?m.corner:f!="circle"?0:25),n(A)&&(A=m.indicatorCorner!=null?m.indicatorCorner:0),n(C)&&(C=m.shadowColor!=null?m.shadowColor:"rgba(0,0,0,.3)"),n(d)&&(d=m.shadowBlur!=null?m.shadowBlur:14),n(l)&&(l=m.startToggled!=null?m.startToggled:!1);var j=Tt(x);n(x)&&(x=m.time!=null?m.time:j=="s"?.1:100),n(i)&&(i=m.label!=null?m.label:null),n(P)&&(P=m.labelLeft!=null?m.labelLeft:null);var S=this;S.cur("pointer"),(typeof i=="string"||typeof i=="number")&&(i=this.label=new t.Label({text:i,size:m.size||r*5/6,color:g,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),(typeof P=="string"||typeof P=="number")&&(P=this.labelLeft=new t.Label({text:P,size:m.size||r*5/6,color:g,valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),this.background=new t.Rectangle(e,r,a,O,T,E).addTo(this),f=="rectangle"||f=="square"?this.indicator=new t.Rectangle(r*.65,r*.65,u,null,null,A).center(this.background).pos(r*.2,null,l):this.indicator=new t.Circle(r*.35,u).center(this.background).pos(r*.175,null,l);var _=l;S.background.color=_?k:a,C!=-1&&d>0&&(this.background.shadow=new Fe.Shadow(C,3,3,d)),i&&(this.addChild(i),i.x=e+2+s+T,i.y=r/2,this.label=i,this.setBounds(-s,-s,e+s*3+T+i.getBounds().width,Math.max(r+s*2,i.getBounds().height))),P&&(this.addChild(P),P.x=0,S.background.x+=P.width+3+s+T,S.label.x+=P.width+3+s+T,P.y=r/2,this.labelLeft=P,this.setBounds(-s,-s,S.getBounds().width+P.width+3+s+T,S.getBounds().height)),this.expand(t.mobile()?20:10),this.tap(function(Z){if(P){var K=S.localToGlobal(P.width+3+s+T+e/2,0);if(Z.stageX/t.scaX<K.x-e/2&&!_||Z.stageX/t.scaX>=K.x+e/2&&_)return}_=!_,U(),S.dispatchEvent("change")},t.mobile()?20:10);var R=new t.Swipe(this,20,j=="s"?.2:200);R.on("swipe",function(Z){if(Z.swipeX!=0){{if(Z.swipeX==1&&_)return;if(Z.swipeX==-1&&!_)return}_=!_,U(),S.dispatchEvent("change")}});function U(Z){var K=S.indicator.x,ne=x;if(Z===!0&&(ne=0),f=="rectangle"||f=="square"?(S.indicator.pos(r*.2,null,_),x>0&&S.indicator.animate({props:{x:K},from:!0,time:ne})):(S.indicator.pos(r*.175,null,_),x>0&&S.indicator.animate({props:{x:K},from:!0,time:ne})),S.background.color=_?k:a,S.text=_?S.label?S.label.text:"on":S.labelLeft?S.labelLeft.text:"off",S.zimAccessibility){var V="Toggle set to "+(_?S.label?S.label.text+".":"on.":S.labelLeft?S.labelLeft.text+".":"off.");setTimeout(function(){S.zimAccessibility.talk(V)},50)}}Object.defineProperty(S,"textLeft",{get:function(){return P?P.text:null},set:function(Z){P&&(P.text=Z,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&S.stage&&S.stage.update())}}),S.toggle=function(Z,K){var ne=_;return n(Z)&&(Z=!0),_=Z,ne!=_&&U(K),S},S.text=_?S.label?S.label.text:"on":S.labelLeft?S.labelLeft.text:"off",Object.defineProperty(S,"toggled",{get:function(){return _},set:function(Z){S.toggle(Z)}}),this._enabled=!0,Object.defineProperty(S,"enabled",{get:function(){return S._enabled},set:function(Z){Ot(S,Z)}}),v!==!1&&t.styleTransforms(this,m),this.clone=function(){return S.cloneProps(new t.Toggle(e,r,i?i.clone():"",l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P?P.clone():"",v,this.group,b))}},t.extend(t.Toggle,t.Container,"clone","zimContainer",!1),t.Tip=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F){var fe="text, tipAlign, tipValign, margin, marginH, marginV, outside, target, delay, time, mouseClose, size, font, color, rollColor, shadowColor, shadowBlur, align, valign, lineWidth, lineHeight, backing, outlineColor, outlineWidth, backgroundColor, backgroundBorderColor, backgroundBorderWidth, corner, backgroundDashed, padding, paddingH, paddingV, shiftH, shiftV, rollPersist, labelWidth, labelHeight, maxSize, bold, italic, variant, splitWords, style, group, inherit",se;if(se=st(t.Tip,arguments,fe,this))return se;De("57.6"),this.group=B;var Q=we===!1?{}:t.getStyle("Tip",this.group,F);n(e)&&(e=Q.text!=null?Q.text:"Here's a tip!"),n(l)&&(l=Q.margin!=null?Q.margin:40),n(a)&&(a=Q.marginH!=null?Q.marginH:l),n(s)&&(s=Q.marginV!=null?Q.marginV:l),n(r)&&(r=Q.tipAlign!=null?Q.tipAlign:"right"),n(i)&&(i=Q.tipValign!=null?Q.tipValign:"bottom"),n(f)&&(f=Q.outside!=null?Q.outside:!1),n(m)&&(m=Q.backgroundColor!=null?Q.backgroundColor:t.blue),n(E)&&(E=Q.color!=null?Q.color:t.white),n(_)&&(_=Q.corner!=null?Q.corner:25),n(R)&&(R=Q.backgroundDashed!=null?Q.backgroundDashed:null),n(U)&&(U=Q.padding!=null?Q.padding:10),n(Z)&&(Z=Q.paddingH!=null?Q.paddingH:U),n(K)&&(K=Q.paddingV!=null?Q.paddingV:U),(n(C)||C=="ignore")&&(C=Q.shadowColor!=null&&C!="ignore"?Q.shadowColor:"rgba(0,0,0,.3)"),(n(d)||d=="ignore")&&(d=Q.shadowBlur!=null&&d!="ignore"?Q.shadowBlur:1),n(y)&&(y=Q.delay!=null?Q.delay:0);var te=Tt(k);n(k)&&(k=Q.time!=null?Q.time:te=="s"?2:2e3),n(g)&&(g=Q.mouseClose!=null?Q.mouseClose:!0),this.zimLabel_constructor(e,O,T,E,A,null,null,x,P,I,N,p,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,L,we,B,t.copy(Q)),this.type="Tip",f&&(a=-a,s=-s);var le=this;le.tipAlign=r,le.tipValign=i,this.background.sha(C,3,5,d),this.show=function(Ae,J){var Te=Tt(J);if(n(Ae)&&(Ae=y),n(J)&&(J=k),n(u))if(ee.zdf)u=ee.zdf.stage;else return le;else if(u.getBounds){if(n(u.stage))return tt("zim display - Waiter(): The container must have a stage property"),le}else return tt("zim Tip(): Please pass in a reference to a container with bounds set as parameter to Tip"),le;Ae>0?le.showID=t.timeout(Ae,G):G();function G(){var ce;u.boundsToGlobal?ce=u.boundsToGlobal():ce=u.getBounds();var q=new t.Container(ce.x,ce.y,ce.width,ce.height);q.zimTemp=!0,q.loc(0,0,u.stage),le.pos(a,s,le.tipAlign,le.tipValign,q),f&&(le.tipAlign=="right"?le.x+=le.width:le.tipAlign=="left"&&(le.x-=le.width),le.tipValign=="bottom"?le.y+=le.height:le.tipValign=="top"&&(le.y-=le.height)),le.addTo(q.stage),q.zimTemp&&q.removeFrom&&(q.removeFrom(),q=null),q=le.stage,le.timeoutID&&le.timeoutID.clear(),le.timeoutID=t.timeout(J,function(){le.hide(),q.stage.update()}),g&&(le.upID&&q.stage.off("stagemouseup",le.upID),le.upID=q.stage.on("stagemouseup",function(){le.hide(),q.stage&&q.stage.update()})),q.stage&&q.stage.update()}return le},this.hide=function(){return this.removeFrom(),this.timeoutID&&this.timeoutID.clear(),this.upID&&u.stage&&u.stage.off("stagemouseup",this.upID),le},this.clear=function(){le.showID&&le.showID.clear(),le.hide()},this.dispose=function(Ae,J,Te){le.upID&&le.stage&&le.stage.off("stagemouseup",le.upID),Te||this.zimLabel_dispose(!0)},we!==!1&&t.styleTransforms(this,Q),this.clone=function(){return le.cloneProps(new t.Tip(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,L,we,this.group,F))}},t.extend(t.Tip,t.Label,["dispose","clone"],"zimLabel",!1),t.Pane=function(N,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U){var Z="content, backgroundColor, color, width, height, draggable, resets, modal, corner, backdropColor, shadowColor, shadowBlur, center, displayClose, backdropClose, backing, fadeTime, container, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, close, closeColor, autoPadding, autoPaddingH, autoPaddingV, style, group, inherit";if(N&&!N.header&&!N.message&&!N.display&&!N.buttons){var K;if(K=st(t.Pane,arguments,Z,this))return K}De("58"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pane";var ne="zim display - Pane(): Please pass in a reference to a container with bounds set as first parameter";if(n(x))if(ee.zdf)x=ee.zdf.stage;else{tt(ne);return}else if(x.getBounds){if(n(x.getStage)){tt("zim display - Pane(): The container must have a stage property");return}}else{tt(ne);return}this.group=R;var V=_===!1?{}:t.getStyle(this.type,this.group,U);n(l)&&(l=V.width!=null?V.width:"auto"),n(a)&&(a=V.height!=null?V.height:"auto"),n(N)&&(N=V.content!=null?V.content:" "),(typeof N=="string"||typeof N=="number")&&(N=new t.Label({text:N,size:V.size!=null?V.size:40,align:V.align!=null?V.align:"center",valign:V.valign!=null?V.valign:"center",color:V.color!=null?V.color:i,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).noMouse());var D=this.content=N;n(r)&&(r=V.backgroundColor!=null?V.backgroundColor:t.white),n(s)&&(s=V.draggable!=null?V.draggable:!1),n(f)&&(f=V.resets!=null?V.resets:!0),n(u)&&(u=V.modal!=null?V.modal:!0),n(y)&&(y=V.corner!=null?V.corner:20),n(P)&&(P=V.titleBar!=null?V.titleBar:null),n(v)&&(v=V.titleBarColor!=null?V.titleBarColor:null),n(w)&&(w=V.titleBarBackgroundColor!=null?V.titleBarBackgroundColor:null),n(b)&&(b=V.titleBarHeight!=null?V.titleBarHeight:null),n(k)&&(k=V.backdropColor!=null?V.backdropColor:"rgba(0,0,0,.2)"),n(g)&&(g=V.shadowColor!=null?V.shadowColor:"rgba(0,0,0,.3)"),n(O)&&(O=V.shadowBlur!=null?V.shadowBlur:20),n(T)&&(T=V.center!=null?V.center:!0),n(E)&&(E=V.displayClose!=null?V.displayClose:!0),s&&(E=!1),n(A)&&(A=V.backdropClose!=null?V.backdropClose:!0),n(d)&&(d=V.fadeTime!=null?V.fadeTime:0),n(X)&&(X=V.close!=null?V.close:!1),n(Y)&&(Y=V.closeColor!=null?V.closeColor:t.grey),n(m)&&(m=V.autoPadding!=null?V.autoPadding:70),n(j)&&(j=V.autoPaddingH!=null?V.autoPaddingH:m),n(S)&&(S=V.autoPaddingV!=null?V.autoPaddingV:m);var c=this.backdrop=new t.Shape({style:!1}),h=c.graphics;h.f(k),h.drawRect(-5e3,-5e3,1e4,1e4);var o=this;if(this.add=function(G,ce,q,ue){var ge="obj, index, center, replace",ie;return(ie=st(o.add,arguments,ge,o))?ie:(n(q)&&(q=!0),n(ue)&&(ue=!0),typeof G=="string"&&(G=new ti(G,null,null,i).noMouse()),ue&&o.contentContainer.removeAllChildren(),q?G.center(o.contentContainer,ce):G.addTo(o.contentContainer,ce),o)},D){var I=t.makeContent(D,l,t.dark),p=["header","message","text","display","buttons","config"];p.forEach(function(ce){I[ce]&&(o[ce]=I[ce])}),o.label=o.message,l=="auto"&&(l=I.width+j*2),a=="auto"&&(a=I.height+S*2)}var N=o.contentContainer=new t.Container(l,a);I&&o.add(I,null,!0),this.setBounds(-l/2,-a/2,l,a);var p=["header","message","text","display","buttons","config"];N&&p.forEach(function(G){N[G]&&(o[G]=N[G])}),o.label=o.message,o.container=x,c.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",A?we:function(G){G.stopImmediatePropagation()});var L=new t.Dictionary(!0);function we(G){o.dispatchEvent("closing"),setTimeout(function(){le(),o.dispatchEvent("close")},10),G.stopImmediatePropagation()}c.on("mousedown",function(G){G.stopImmediatePropagation()}),this.addChild(c),u||c.noMouse();var B;if(n(C))B=this.backing=new t.Rectangle({width:l,height:a,color:r,corner:y,style:!1});else{if(C.type=="Pattern"){var F=C;B=new t.Rectangle(l,a,r,null,null,y,null,null,null,!1),F.centerReg(B),F.setMask(B.shape)}else B=C;o.display=o.backing=B}if(E&&(B.cur("pointer"),B.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",we)),g!=-1&&O>0&&(B.shadow=new Fe.Shadow(g,8,8,O)),B.on("click",function(G){G.stopImmediatePropagation()}),this.resetX,this.resetY,s){B.cur("pointer");var fe,se;B.on("mousedown",function(G){isNaN(o.resetX)&&(o.resetX=o.x),isNaN(o.resetY)&&(o.resetY=o.y),fe=G.stageX/t.scaX-o.x,se=G.stageY/t.scaY-o.y,B.cur("pointer")}),B.on("pressmove",function(G){var ce=Te(G.stageX/t.scaX-fe,G.stageY/t.scaY-se);o.x=ce.x,o.y=ce.y;for(var q,ue=0;ue<o.numChildren;ue++)q=o.getChildAt(ue),(q.type=="TextArea"||q.type=="Loader"||q.type=="Tag")&&q.resize();o.stage.update()}),this.on("pressup",function(){B.cur("pointer"),o.stage&&o.stage.update()})}if(B.centerReg(this),N&&N.center(this),!n(P)){typeof P=="string"&&(P=new t.Label(P,null,null,v));var Q=o.titleBarLabel=P;n(b)&&(b=Q.height*1.5),n(v)&&(v=t.black),n(w)&&(w="rgba(0,0,0,.2)"),o.titleBar=P=new t.Container(l,b,null,null,!1).centerReg(o).mov(0,-a/2+b/2),P.mouseEnabled=!1,P.mouseChildren=!1,o.titleBar.backing=new t.Rectangle(l,b,w,null,null,[y*.95,y*.95,0,0],null,null,null,!1).addTo(P),Q.center(P).pos({x:Math.max(y/2,10),reg:!0})}X&&(X=o.close=new t.Shape(-40,-40,80,80,null,!1),X.graphics.f(Y).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),P?X.addTo(o).scaleTo(P,null,50).mov(l/2-Math.max(y/2,10)-X.width/2,-a/2+b/2).expand(40):X.addTo(o).sca(.3).mov(l/2-X.width-3,-a/2+X.height).expand(40),X.cur("pointer"),X.expand(),X.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",we)),Object.defineProperty(o,"text",{get:function(){if(o.message){var G=o.message.text==" "?"":o.message.text;return G}else if(o.content.text){var G=o.content.text==" "?"":o.content.text;return G}},set:function(G){o.message?o.message.text=G:o.content.text&&(o.content.text=G)}}),this._enabled=!0,Object.defineProperty(o,"enabled",{get:function(){return o._enabled},set:function(G){Ot(o,G)}}),this.hide=function(G,ce){return n(G)||(o.closeParams=G),le(),ce&&(o.dispatchEvent("close"),o.dispatchEvent("change")),o},this.on("removed",te);function te(){o.toggled=!1;var G,ce;for(ce=0;ce<o.numChildren;ce++)if(G=o.getChildAt(ce),G.type=="TextArea"||G.type=="Loader"||G.type=="Tag"){var q={obj:G,depth:o.getChildIndex(G)};L.add(G,q)}for(ce=o.numChildren-1;ce>=0;ce--)G=o.getChildAt(ce),(G.type=="TextArea"||G.type=="Loader"||G.type=="Tag")&&o.removeChild(G);if(!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&o.container.stage.update(),f&&(isNaN(o.resetX)||(o.x=o.resetX),isNaN(o.resetY)||(o.y=o.resetY)),o.zimAccessibility){var ue=o.zimAccessibility;ue.resize(o),Ae?Ae.focus():o.zimTabTag.nextSibling.focus(),setTimeout(function(){ue.talk("Pane has been closed.")},50)}}function le(){d>0?o.animate({obj:{alpha:0},time:d,call:function(){G(),o.dispatchEvent("fadedout")}}):G();function G(){o.container.removeChild(o),o.closeCall&&o.closeCall(o.closeParams),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&o.container.stage.update(),f&&(isNaN(o.resetX)||(o.x=o.resetX),isNaN(o.resetY)||(o.y=o.resetY))}}var Ae;this.show=function(G,ce){return n(G)||(o.closeCall=G),n(ce)||(o.closeParams=ce),T&&isNaN(o.resetX)&&(o.x=o.container.getBounds().width/2,o.y=o.container.getBounds().height/2),o.container.addChild(o),d>0?(o.alpha=0,o.animate({props:{alpha:1},time:d,call:function(){o.dispatchEvent("fadedin")}})):setTimeout(function(){o.container.stage&&o.container.stage.update()},10),o},this.on("added",J);function J(){for(var G=0;G<L.length;G++)o.addChildAt(L.values[G].obj,L.values[G].depth);if(o.zimAccessibility){var ce=o.zimAccessibility;setTimeout(function(){ce.activatedObject&&(Ae=ce.activatedObject.zimTabTag)},50),ce.resize(o),ce.tabIndex=o.zimTabIndex}o.toggled=!0}function Te(G,ce){return G=Math.max(l/2,Math.min(o.container.getBounds().width-l/2,G)),ce=Math.max(a/2,Math.min(o.container.getBounds().height-a/2,ce)),{x:G,y:ce}}this.toggle=function(G){return G===!0?o.show():G===!1||o.container.contains(o)?o.hide():o.show(),o},_!==!1&&t.styleTransforms(this,V),this.clone=function(){var G=o.contentContainer.x,ce=o.contentContainer.y,q=o.cloneProps(new t.Pane(t.copy(N),r,i,l,a,s,f,u,y,k,g,O,T,E,A,n(C)?null:C.clone(),d,o.container,P,v,w,b,X,Y,m,j,S,_,this.group,U));return q.contentContainer.x=G,q.contentContainer.y=ce,q}},t.extend(t.Pane,t.Container,"clone","zimContainer",!1),t.Panel=function(e,r,o,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S){var _="width, height, content, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, close, closeColor, next, nextColor, extraButton, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",R;if(R=st(t.Panel,arguments,_,this))return R;De("57.7"),this.group=j;var U=m===!1?{}:t.getStyle("Panel",this.group,S);n(e)&&(e=U.width!=null?U.width:250),n(r)&&(r=U.height!=null?U.height:300),this.zimContainer_constructor(e,r,null,null,!1),this.type="Panel",n(o)&&(o=U.content!=null?U.content:null);var Z=this.content=o;n(l)&&(l=U.titleBar!=null?U.titleBar:"PANEL"),n(a)&&(a=U.titleBarColor!=null?U.titleBarColor:t.white),n(s)&&(s=U.titleBarBackgroundColor!=null?U.titleBarBackgroundColor:t.grey),n(f)&&(f=U.titleBarHeight!=null?U.titleBarHeight:30),n(u)&&(u=U.backgroundColor!=null?U.backgroundColor:t.lighter),n(y)&&(y=U.borderColor!=null?U.borderColor:t.pewter),n(k)&&(k=U.borderWidth!=null?U.borderWidth:null),y<0||k<0?y=k=null:y!=null&&k==null&&(k=1),n(g)&&(g=U.corner!=null?U.corner:5),n(v)&&(v=U.align!=null?U.align:"left"),n(w)&&(w=U.shadowColor!=null?U.shadowColor:"rgba(0,0,0,.3)"),n(b)&&(b=U.shadowBlur!=null?U.shadowBlur:14),n(X)&&(X=U.draggable!=null?U.draggable:!1),n(Y)&&(Y=U.boundary!=null?U.boundary:null),n(O)&&(O=U.close!=null?U.close:!1),n(T)&&(T=U.closeColor!=null?U.closeColor:n(a)?t.grey:a),n(E)&&(E=U.next!=null?U.next:t.vee(l)),n(A)&&(A=U.nextColor!=null?U.nextColor:n(a)?t.grey:a),Array.isArray(g)||(g=[g,g,g,g]),n(d)&&(d=U.collapse!=null?U.collapse:!1),n(x)&&(x=U.collapseColor!=null?U.collapseColor:n(a)?t.grey:a),n(P)&&(P=U.collapsed!=null?U.collapsed:!1);var K=this,ne=this.background=new t.Rectangle(e,r,u,y,k,g).addTo(this);w!=-1&&b>0&&(this.background.shadow=new Fe.Shadow(w,3,3,b));var V=l,D=t.Pick.choose(V),c=t.Pick.choose(a),h=t.Pick.choose(s),o=K.contentContainer=new t.Container(e,r-f).addTo(K).mov(0,f);typeof D=="string"&&(D=new t.Label({text:D,color:c,size:U.size!=null?U.size:20,bold:U.bold!=null?U.bold:!1,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var I=K.titleBarLabel=D;n(h)&&(h="rgba(0,0,0,.2)"),K.titleBar=l=new t.Container(e,f,null,null,!1).loc(0,0,K);var N=K.titleBar.backing=new t.Rectangle(e+k,f,h,null,null,[g[0]*.95,g[1]*.95,0,0],!0,null,null,!1).center(l);if(l&&B(),K.label=D,K.text=D.text,O){var p=K.closeIcon=new t.Shape(-40,-40,80,80,null,!1);p.graphics.f(T).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),l?(p.centerReg(l).scaleTo(l,null,50),p.pos(Math.max(g[1]/2,15),null,!0)):p.addTo(K).sca(.3).mov(e/2-p.width-3,-r/2+O.height),p.expand(40),p.cur("pointer"),p.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var Q=K.stage;K.removeFrom(),K.dispatchEvent("close"),Q.update()})}if(this.add=function(Q,te,le,Ae){var J="obj, index, center, replace",Te;return(Te=st(K.add,arguments,J,K))?Te:(Ae&&K.contentContainer.removeAllChildren(),le?Q.center(K.contentContainer,te):Q.addTo(K.contentContainer,te),K)},Z){var L=t.makeContent(Z,e),we=["header","message","text","display","buttons","config"];we.forEach(function(Q){L[Q]&&(K[Q]=L[Q])}),K.label=K.message,K.add(L,null,!0)}this.nextPanel=function(Q,te){var le=n(Q)||n(V.array)?t.Pick.choose(V):V.array[Q],Ae=n(Q)||n(a.array)?t.Pick.choose(a):a.array[Q],J=n(Q)||n(s.array)?t.Pick.choose(s):s.array[Q],Te=n(Q)||n(u.array)?t.Pick.choose(u):u.array[Q],G=n(Q)||n(y.array)?t.Pick.choose(y):y.array[Q];typeof le=="string"&&(le=new t.Label({text:le,color:Ae,size:U.size!=null?U.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),K.label=le,K.text=le.text,I.removeFrom(),I=K.titleBarLabel=le,B(),N.color=J,K.background.color=Te,K.background.borderColor=G,te&&K.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&K.stage&&K.stage.update()};function B(){v=="right"?I.center(l).pos(Math.max(g[0]/2,10),null,!0):v=="center"||v=="middle"?I.center(l):I.center(l).loc(Math.max(g[0]/2,10)),I.mov(0,2)}if(X&&(l.cur("pointer"),l.on("mousedown",function(){K.drag({rect:Y,currentTarget:!0})}),l.on("pressup",function(){K.noDrag(!1)})),E>0){var F=K.nextIcon=new t.Shape(-20,-20,40,40,null,!1);F.graphics.f(a).p("AiJieIETCeIkTCfg"),F.centerReg(l).scaleTo(l,null,70).alp(.8).hov(1).expand(),F.pos(Math.max(g[1]/2,15),null,!0),p&&F.mov(-p.width-8),F.cur("pointer"),F.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){K.nextPanel(),K.dispatchEvent("change")})}if(n(C)||(C=K.extraButton=new t.Button({label:"R",width:50,height:50,corner:5,group:"PanelExtra"}).scaleTo(l,null,70).centerReg(l).expand(),C.pos(Math.max(g[1]/2,15),null,!0),p&&C.mov(-p.width-8),F&&C.mov(-F.width-8)),d){se=P,K.collapse=function(Q){if(n(Q)&&(Q=!0),Q==se)return K;Q?(fe.rot(180),ne.visible=!1,o.visible=!1,se=!0,K.dispatchEvent("collapse")):(fe.rot(0),ne.visible=!0,o.visible=!0,se=!1,K.dispatchEvent("expand")),K.stage&&K.stage.update()},K.collapseEvent=K.titleBar.on("dblclick",function(){K.collapsed=!K.collapsed}),n(x)&&(x=t.grey);var fe=K.collapseIcon=new t.Triangle(90,90,90,t.faint,x,16);fe.centerReg(K).scaleTo(l,null,41).pos({x:e-Math.max(g[1]/2,15)-fe.width/2-4,y:f/2,reg:!0}).expand(40),C&&fe.mov(-C.width-8),p&&fe.mov(-p.width-8),F&&fe.mov(-F.width-8),fe.cur("pointer"),fe.expand();var se=!1;fe.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){se?K.collapse(!1):K.collapse(!0)})}K.overlay=new t.Rectangle(e,r,null,null,null,g).alp(.3),Object.defineProperty(K,"panelHeight",{get:function(){return K.background.height},set:function(Q){ne.removeFrom(),ne=this.background=new t.Rectangle(e,Q,u,y,k,g).addTo(this).bot(),w!=-1&&b>0&&(this.background.shadow=new Fe.Shadow(w,3,3,b)),K.setBounds(e,Q),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&K.stage&&K.stage.update()}}),Object.defineProperty(K,"collapsed",{get:function(){return se},set:function(Q){K.collapse&&K.collapse(Q)}}),this._enabled=!0,Object.defineProperty(K,"enabled",{get:function(){return K._enabled},set:function(Q){Ot(K,Q),Q?K.overlay.removeFrom():K.overlay.addTo(K),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&K.stage&&K.stage.update()}}),P&&(P=!1,K.collapsed=!0),m!==!1&&t.styleTransforms(this,U),this.clone=function(){return K.cloneProps(new t.Toggle(e,r,l?l.clone():"",a,s,f,u,y,k,g,O,T,E,A,C,d,x,K.collapsed,v,w,b,X,Y,m,this.group,S))},this.doDispose=function(Q,te,le){return d&&this.titleBar.off("dblclick",this.collapseEvent),le||this.zimContainer_dispose(!0),!0}},t.extend(t.Panel,t.Container,["clone","dispose"],"zimContainer",!1),t.Panel.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.Window=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le){var Ae="width, height, content, backgroundColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, slide, slideFactor, slideSnap, slideSnapDamp, interactive, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, cancelCurrentDrag, fullSize, fullSizeColor, resizeHandle, collapse, collapseColor, collapsed, optimize, resizeBoundary, resizeVisible, continuous, style, group, inherit",J;if(J=st(t.Window,arguments,Ae,this))return J;De("58.1"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Window",this.group=te;var Te=Q===!1?{}:t.getStyle(this.type,this.group,le);n(e)&&(e=Te.width!=null?Te.width:300),n(r)&&(r=Te.height!=null?Te.height:200),n(l)&&(l=Te.backgroundColor!=null?Te.backgroundColor:t.dark);var G=a,ce=s;n(a)&&(a=Te.borderColor!=null?Te.borderColor:t.silver),n(s)&&(s=Te.borderWidth!=null?Te.borderWidth:1),n(f)&&(f=Te.padding!=null?Te.padding:0),n(u)&&(u=Te.corner!=null?Te.corner:0),n(y)&&(y=Te.swipe!=null?Te.swipe:!0),n(k)&&(k=Te.scrollBarActive!=null?Te.scrollBarActive:!0),n(g)&&(g=Te.scrollBarDrag!=null?Te.scrollBarDrag:!1),n(O)&&(O=Te.scrollBarColor!=null?Te.scrollBarColor:a),n(T)&&(T=Te.scrollBarAlpha!=null?Te.scrollBarAlpha:.3),n(E)&&(E=Te.scrollBarFade!=null?Te.scrollBarFade:!0),n(A)&&(A=Te.scrollBarH!=null?Te.scrollBarH:!0),n(C)&&(C=Te.scrollBarV!=null?Te.scrollBarV:!0),g&&(E=Te.scrollBarFade!=null?Te.scrollBarFade:!1),n(d)&&(d=Te.slide!=null?Te.slide:!0),n(x)&&(x=Te.slideFactor!=null?Te.slideFactor:.9),n(P)&&(P=Te.slideSnap!=null?Te.slideSnap:"vertical"),n(w)&&(w=Te.interactive!=null?Te.interactive:!0),n(b)&&(b=Te.shadowColor!=null?Te.shadowColor:"rgba(0,0,0,.3)"),n(X)&&(X=Te.shadowBlur!=null?Te.shadowBlur:20),n(m)&&(m=Te.paddingV!=null?Te.paddingV:f),n(Y)&&(Y=Te.paddingH!=null?Te.paddingH:f),n(j)&&(j=Te.scrollWheel!=null?Te.scrollWheel:!0),n(S)&&(S=Te.damp!=null?Te.damp:null),n(_)&&(_=Te.titleBar!=null?Te.titleBar:null),n(R)&&(R=Te.titleBarColor!=null?Te.titleBarColor:null),n(U)&&(U=Te.titleBarBackgroundColor!=null?Te.titleBarBackgroundColor:null),n(Z)&&(Z=Te.titleBarHeight!=null?Te.titleBarHeight:null),n(K)&&(K=Te.draggable!=null?Te.draggable:null),n(ne)&&(ne=Te.boundary!=null?Te.boundary:null),n(V)&&(V=Te.onTop!=null?Te.onTop:null),n(D)&&(D=Te.close!=null?Te.close:null),n(c)&&(c=Te.closeColor!=null?Te.closeColor:null),n(h)&&(h=Te.cancelCurrentDrag!=null?Te.cancelCurrentDrag:!1),n(o)&&(o=Te.fullSize!=null?Te.fullSize:null),n(I)&&(I=Te.fullSizeColor!=null?Te.fullSizeColor:null),n(N)&&(N=Te.resizeHandle!=null?Te.resizeHandle:null),n(p)&&(p=Te.collapse!=null?Te.collapse:!1),n(L)&&(L=Te.collapseColor!=null?Te.collapseColor:null),n(we)&&(we=Te.collapsed!=null?Te.collapsed:!1),n(B)&&(B=Te.optimize!=null?Te.optimize:!0),n(F)&&(F=Te.resizeBoundary!=null?Te.resizeBoundary:null),n(fe)&&(fe=Te.resizeVisible!=null?Te.resizeVisible:!1),n(se)&&(se=Te.continuous!=null?Te.continuous:!1),se!="horizontal"&&se!="vertical"&&(se=!1),this.continuous=se,_===!1&&(_=null),n(_)||(n(Z)&&(Z=30),r=r-Z);var q=this;q.optimize=B,this.scrollX=this.scrollY=this.scrollXMax=this.scrollYMax=0;var ue=this.backing=new t.Shape({style:!1});this.addChild(ue);var ge=new Fe.Shape;ge.type="WindowBacking";var ie=ge.graphics;if(this.addChild(ge),i)var xe=q.content=i;i=this.contentContainer=new t.Container({style:!1}),this.addChild(i),i.mask=ge;var Se;if(!w)var z=new Fe.Shape;if(s>0){var pe=new Fe.Shape;this.addChild(pe)}var de=_?0:u,oe=0;function Be(){q.setBounds(0,0,e,r),ue.graphics.c().f(l).rc(0,0,e,r,de,de,u,u),b!=-1&&X>0&&(ue.shadow=new Fe.Shadow(b,4,4,X)),s>0&&(u?pe.graphics.c().s(a).ss(s,"square","miter").rc(0,0,e,r,de,de,u,u):pe.graphics.c().s(a).ss(s,"square","miter").dr(0,0,e,r)),n(Ke)||(Ke.widthOnly=q.width+s,Ne.widthOnly=q.width+s-1,q.setBounds(0,-Z,q.width,r+Z)),Xe&&(_?(Xe.pos({x:e-Math.max(u/2,10)-Xe.width/2,y:Z/2,reg:!0}),Ne.widthOnly=Xe.x-15,oe=q.width-Ne.width):Xe.pos(Math.max(u/2,10)/2,Xe.height/2,!0,!1,q)),Oe&&(Oe.pos({x:e-Math.max(u/2,10)-Oe.width/2,y:Z/2,reg:!0}),Xe&&Oe.mov(-Xe.width-10),_&&(Ne.widthOnly=Oe.x-15),oe=q.width-Ne.width),Ce&&(Ce.pos({x:e-Math.max(u/2,10)-Ce.width/2,y:Z/2,reg:!0}),Xe&&Ce.mov(-Xe.width-10),Oe&&Ce.mov(-Oe.width-10),_&&(Ne.widthOnly=Ce.x-15),oe=q.width-Ne.width)}Be();var $=this.scrollBar={};if($.color=O,$.size=6,$.minSize=$.size*2,$.spacing=3.5+s/2,$.margin=0,$.corner=$.size/2,$.showTime=.5,$.fadeTime=3,k){var Me=$.horizontal=new t.Shape({style:!1}),be=Me.graphics;Me.alpha=T,this.addChild(Me),g&&Me.drag({localBoundary:!0});var me=$.vertical=new t.Shape({style:!1}),re=me.graphics;me.alpha=T,this.addChild(me),g&&me.drag({localBoundary:!0})}var ke,Re,Ye,$e,it,Le,Ze,ze,ve,Pe=!1;if(this.update=function(){k&&(be.clear(),re.clear()),it=k?$.size+$.spacing*2:0,Le=i.getBounds()?i.getBounds().width:0,Ze=i.getBounds()?i.getBounds().height:0,Ye=A&&Le>e-Y&&(k||y===!0||y=="auto"||y=="horizontal"),$e=C&&Ze>r-m&&(k||y===!0||y=="auto"||y=="vertical"),q.scrollXMax=Le+Y*2-e+($e?it+$.margin:0),q.scrollYMax=Ze+m*2-r+(Ye?it+$.margin:0),ie.clear();var xt=s/2,je=s/2,Ct=e-($e&&k?$.size+$.spacing*2:0)-($e?0:s),Wt=r-(Ye&&k?$.size+$.spacing*2:0)-(Ye?0:s),_t=u*(.1+u/100);ie.f("rgba(0,0,0,0)").rc(xt,je,Ct,Wt,Ye&&k&&!_?_t:de,$e&&k&&!_?_t:de,$e&&k?_t:Math.max(_t,u-s/2),Ye&&k?_t:Math.max(_t,u-s/2)),ge.setBounds(q.getBounds().x,q.getBounds().y,q.getBounds().width,q.getBounds().height),t.expand(ge,0),w||(z.graphics.c().f("red").dr(xt,je,Ct,Wt),i.hitArea=z);var tn=Math.max(u,Math.min($.corner,$.spacing)),Ut=tn+s/2,wt=tn+($e?it:0)+s/2,Vt=tn+s/2,yn=tn+(Ye?it:0)+s/2,$t,an;Ye&&k&&($t=Math.max($.minSize,(e-Ut-wt)*(e-Ut-wt)/(Le+Y+$.margin)),be.f($.color).rr(0,0,$t,$.size,$.corner),Me.x=Ut,Me.y=r-$.size-$.spacing,ke=new t.Proportion(-q.scrollXMax,0,Ut,e-$t-wt,-1),g&&(Me.setBounds(0,0,$t,$.size),an=new Fe.Rectangle(Ut,Me.y,e-$t-Ut-wt,0),Me.dragBoundary(an),Me.proportion=new t.Proportion(an.x,an.x+an.width,0,-q.scrollXMax),Me.off("pressmove",ze),ze=Me.on("pressmove",function(){q.dispatchEvent("scrolling"),z&&(z.x=-i.x,z.y=-i.y),i.x=Me.proportion.convert(Me.x),gt()}))),$e&&k&&($t=Math.max($.minSize,(r-Vt-yn)*(r-Vt-yn)/(Ze+m+$.margin)),re.f($.color).rr(0,0,$.size,$t,$.corner),me.x=e-$.size-$.spacing,me.y=Vt,Re=new t.Proportion(-q.scrollYMax,0,Vt,r-$t-yn,-1),g&&(me.setBounds(0,0,$.size,$t),an=new Fe.Rectangle(me.x,Vt,0,r-$t-Vt-yn),me.dragBoundary(an),me.proportion=new t.Proportion(an.y,an.y+an.height,0,-q.scrollYMax),me.off("pressmove",ve),ve=me.on("pressmove",function(){S&&(Pe=!0),q.dispatchEvent("scrolling"),z&&(z.x=-i.x,z.y=-i.y),S?Jt=me.proportion.convert(me.y):i.y=me.proportion.convert(me.y),gt()}))),Bt(),clearTimeout(q.d2Timeout),q.d2Timeout=setTimeout(function(){Me&&Me.proportion&&(i.x=Me.proportion.convert(Me.x)),me&&me.proportion&&(i.y=me.proportion.convert(me.y))},50),clearTimeout(q.dTimeout),q.dTimeout=setTimeout(function(){et()},300),et(),gt()},this.resize=function(xt,je){n(xt)&&(xt=e),n(je)&&(je=r);var Ct=Math.max(20,u*2);_&&(Ct=Math.max(oe,Ct)),xt<Ct&&(xt=Ct),je<20&&(je=20),e=xt,r=je,Be();for(var Wt=0;Wt<i.numChildren;Wt++){var _t=i.getChildAt(Wt);_t.type=="Wrapper"&&ct(_t)}return N&&Ue(),q.update(),Jt=i.y,S&&jt.immediate(Jt),q.dispatchEvent("resize"),q},!n(_)){n(K)&&(K=!0),typeof _=="string"&&(_=new t.Label({text:_,color:R,size:Te.size!=null?Te.size:20,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}));var ae=q.titleBarLabel=_;ae.noMouse(),n(U)&&(U="rgba(0,0,0,.2)"),q.titleBar=_=new t.Container(e,Z,null,null,!1).centerReg(q).mov(0,-r/2-Z/2);var Ne=new t.Rectangle(_.width-1,_.height,red).alp(0).addTo(_);ae.setMask(Ne,!0);var Ke=q.titleBar.backing=new t.Rectangle(e+s,Z,U,null,null,[u*.95,u*.95,0,0],!0,null,!1,!1).center(_);ae.center(_).pos({x:Math.max(u/2,Math.max(10,f)),reg:!0}),q.regX=0,q.regY=-Z,q.setBounds(0,-Z,e,r+Z),K?(_.cur("pointer"),_.on("mousedown",function(){q.drag({rect:ne,currentTarget:!0,onTop:V})}),_.on("pressup",function(){q.noDrag(!1)})):_.on("mousedown",function(){})}if(D){n(c)&&(c=t.grey);var Xe=q.closeIcon=new t.Shape(-40,-40,80,80,null,!1);Xe.graphics.f(c).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),_?Xe.centerReg(q).scaleTo(_,null,50).pos({x:e-Math.max(u/2,10)-Xe.width/2,y:Z/2,reg:!0}).expand(40):Xe.sca(.3).pos(Math.max(u/2,10)/2,Xe.height/2,!0,!1,q).expand(40),Xe.cur("pointer"),Xe.expand(),Xe.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){var xt=q.stage;q.removeFrom(),q.dispatchEvent("close"),xt&&xt.update()})}var Qe,he,Ge,Ie,_e,Je;if(!n(_)){if(o){q.fullSize=function(xt){if(n(xt)&&(xt=!0),xt==he||!q.parent)return q;xt?(Ge=q.width,Ie=q.height,_e=q.x,Je=q.y,q.resize(q.parent.width,q.parent.height),q.x=0,q.y=0,he=!0,Ve.alpha=1,Oe.getChildAt(0).alpha=.01,q.dispatchEvent("fullsize")):(q.resize(Ge,Ie-_.height),q.x=_e,q.y=Je,he=!1,Ve.alpha=0,Oe.getChildAt(0).alpha=1,q.dispatchEvent("originalsize")),q.stage&&q.stage.update()},n(I)&&(I=t.grey);var Oe=q.fullSizeIcon=new t.Rectangle(80,80,t.faint,I,16),Ve=new t.Shape().s(I).ss(16).mt(-19.6,-20.6).lt(-19.6,-40).lt(40,-40).lt(40,20.7).lt(19.6,20.7).lt(19.6,40).lt(-40,40).lt(-40,-20.6).lt(-19.6,-20.6).lt(19.6,-20.6).lt(19.6,20.7).addTo(Oe).mov(40,40).alp(0);Oe.centerReg(q).scaleTo(_,null,42).pos({x:e-Math.max(u/2,10)-Oe.width/2,y:Z/2,reg:!0}).expand(40),Xe&&Oe.mov(-Xe.width-10),Oe.cur("pointer"),Oe.expand(),he=!1,Ge=e,Ie=r,_e=q.x,Je=q.y,Oe.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){he?q.fullSize(!1):q.fullSize(!0)})}var rt=t.copy(q.getBounds(),!0);if(p){Qe=we,q.collapse=function(xt){if(n(xt)&&(xt=!0),xt==Qe)return q;xt?(Ce.rot(180),q.backing.visible=!1,q.contentContainer.visible=!1,ge.visible=!1,Me&&(Me.visible=!1),Me&&(me.visible=!1),pe&&(pe.visible=!1),Qe=!0,Ke.sha(b,5,5,X),N&&(q.resizeHandle.visible=!1),q.setBounds(rt.x,rt.y,rt.width,_.height),q.dispatchEvent("collapse")):(Ce.rot(0),q.backing.visible=!0,q.contentContainer.visible=!0,ge.visible=!0,Me&&(Me.visible=!0),Me&&(me.visible=!0),pe&&(pe.visible=!0),Qe=!1,Ke.sha(null),N&&(q.resizeHandle.visible=!0),q.setBounds(rt.x,rt.y,rt.width,rt.height),q.dispatchEvent("expand")),q.stage&&q.stage.update()},n(L)&&(L=t.grey);var Ce=q.collapseIcon=new t.Triangle(90,90,90,t.faint,L,16);Ce.centerReg(q).scaleTo(_,null,42).pos({x:e-Math.max(u/2,10)-Ce.width/2,y:Z/2,reg:!0}).expand(40),Xe&&Ce.mov(-Xe.width-10),Oe&&Ce.mov(-Oe.width-10),Ce.cur("pointer"),Ce.expand(),Qe=!1,Ge=e,Ie=r,_e=q.x,Je=q.y,Ce.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){Qe?q.collapse(!1):q.collapse(!0)})}}if(N){var We=new ei().loc(0,0,q).mov(q.width,q.height-(q.titleBar?q.titleBar.height:0)),lt=q.resizeHandle=new t.Rectangle(25,25,t.grey,t.white).alp(fe?.5:.01).centerReg().rot(45).loc(0,0,We).drag({boundary:F,localBoundary:!0});lt.on("mouseover",function(){lt.alp(.5),lt.stage&&lt.stage.update()}),lt.on("mousedown",function(){lt.pressing=!0}),lt.on("mouseout",function(){lt.pressing||(fe||lt.alp(.01),lt.stage&&lt.stage.update())}),lt.on("pressmove",function(){q.resize(Math.max(50,We.x+lt.x),Math.max(50,We.y+lt.y))}),lt.on("pressup",function(){lt.pressing=!1,fe||lt.alp(.01),Ue(),lt.stage&&lt.stage.update()}),q.titleBar&&q.titleBar.on("pressup",Ue)}function Ue(xt){q.resizeHandle.loc(0,0,We).top().mov(-We.x+q.width,-We.y+q.height-(q.titleBar?q.titleBar.height:0))}function ct(xt){xt.align=="right"?(xt.x=Y,xt.resize(q.width-($e?$.size+$.spacing*2:Y)-Y*2)):(xt.align=="center"||xt.align=="middle",xt.resize(q.width-($e?$.size+$.spacing*2:0)-Y*2)),xt.alpha=xt.wrapperLastAlpha}if(Be(),this.add=function(xt,je,Ct,Wt){var _t="obj, index, center, replace",tn;if(tn=st(q.add,arguments,_t,q))return tn;var Ut=xt;if(!Ut.getBounds()){tt("Window.add() - please add content with bounds set");return}return gn(Ut),n(je)&&(je=i.numChildren),Wt&&(je=0,q.removeAll()),Ct?(Ut.center(q).addTo(i,je).mov(0,Z?Z/2:0),i.height>q.height-(Z||0)&&Ut.loc(null,0),i.width>q.width&&Ut.loc(0)):Ut.addTo(i,je),Ut.type=="Wrapper"&&(me.alpha=0,A=!1,Ut.wrapperLastAlpha=Ut.alpha,Ut.alpha=0,this.added(function(){ct(Ut),q.resize(),Me.alpha=1,me.alpha=1})),Ut.x==0&&(Ut.x=Y),Ut.y==0&&(Ut.y=m),q.update(),q},xe){var ot=t.makeContent(xe,e),dt=["header","message","text","display","buttons","config"];dt.forEach(function(xt){ot[xt]&&(q[xt]=ot[xt])}),q.label=q.message,q.add(ot,0,!0)}this.remove=function(xt){return i.removeChild(xt),q.update(),q},this.removeAll=function(){return i.removeAllChildren(),q.update(),q};function et(xt){se||(n(Se)&&(Se=q.stage||ee.zdf.stage),n(xt)&&(xt=!0),xt?t.dragBoundary(i,new Fe.Rectangle(0,0,Ye?-q.scrollXMax:0,$e?-q.scrollYMax:0)):t.dragBoundary(i,new Fe.Rectangle(-1e3,-1e3,Se.width+2e3,Se.height+2e3)))}var St=!1;y&&i.on("mousedown",function(){St||t.Ticker.add(ht,i.stage),St=!0,Ye&&k&&E&&t.animate(Me,{alpha:T},$.showTime),$e&&k&&E&&t.animate(me,{alpha:T},$.showTime)});function ht(){Jt=i.y,S&&jt.immediate(Jt),k?Bt():q.dispatchEvent("scrolling")}function gt(){q.optimize&&(Se=q.stage,i.loop(function(xt){!xt.hitTestBounds||!xt.stage||(xt.hitTestBounds(q,300)?(xt.visible=!0,xt.loop&&xt.loop(function(je){je.hitTestBounds&&(je.hitTestBounds(q,300)?je.visible=!0:je.visible=!1)})):xt.visible=!1)}))}function Bt(){gt(),q.dispatchEvent("scrolling"),z&&(z.x=-i.x,z.y=-i.y),Ye&&k&&(Me.x=ke.convert(i.x)),$e&&k&&(me.y=Re.convert(i.y))}this.on("added",function(){Dt(50)},null,!0);function Dt(xt){n(xt)&&(xt=100),gn(q),y&&setTimeout(function(){i&&(t.drag({obj:i,currentTarget:!0,axis:se,localBoundary:!0,slide:d,slideFactor:x,slideSnap:A&&(y===!0||y=="auto"||y=="horizontal")||C&&(y===!0||y=="auto"||y=="vertical")?P:!1}),i.removeAllEventListeners("slidestart"),i.on("slidestart",function(){q.dispatchEvent("slidestart")}),i.removeAllEventListeners("slidestop"),!k&&B&&(q.zDE&&i.off(q.zDE),q.zDE=i.on("mousedown",()=>{q.zTI&&t.Ticker.remove(gt)}),q.zME&&i.off(q.zME),q.zME=i.on("pressmove",gt),q.zSTA&&i.off(q.zSTA),q.zSTA=i.on("slidestart",function(){q.zTI=t.Ticker.add(gt)}),q.zSTO&&i.off(q.zSTO),q.zSTO=i.on("slidestop",function(je){q.zTI&&t.Ticker.remove(q.zTI)})),i.on("slidestop",function(je){d&&nn(je),q.dispatchEvent("slidestop")}),i.getBounds()&&i.getBounds().width>0&&et())},xt)}this.cancelCurrentDrag=function(){q.contentContainer&&q.contentContainer.noDrag(!1),setTimeout(function(){i&&(t.drag({obj:i,currentTarget:!0,localBoundary:!0,slide:d,slideFactor:x,slideSnap:A&&(y===!0||y=="auto"||y=="horizontal")||C&&(y===!0||y=="auto"||y=="vertical")?P:!1}),i.getBounds()&&i.getBounds().width>0&&et())},300)};var Ht;this.added(function(xt){Se=xt,Ht=Se.on("stagemousemove",function(je){q.windowMouseX=je.stageX/t.scaX,q.windowMouseY=je.stageY/t.scaY})}),d?i.on("slidestop",nn):i.on("mousedown",function(){i.stage.on("stagemouseup",nn,null,!0)}),h&&(q.blurEvent=function(){q.cancelCurrentDrag(),nn()},document.WW.addEventListener("blur",q.blurEvent));function nn(){t.Ticker.remove(ht),St=!1,Ye&&E&&k&&t.animate(Me,{alpha:0},$.fadeTime),$e&&E&&k&&t.animate(me,{alpha:0},$.fadeTime)}var en=!1,kt,Qt=0,He=0,yt=0,Mt=0,Xt=300,Yt=2;function ft(){kt=Date.now(),t.Ticker.add(Gt,i.stage)}function bt(){en||(q.dispatchEvent("hoverout"),en=!0),t.Ticker.remove(Gt)}function Gt(){if(!i.stage){en||(q.dispatchEvent("hoverout"),en=!0),t.Ticker.remove(Gt);return}Math.abs(Qt-q.windowMouseX)>Yt||Math.abs(He-q.windowMouseY)>Yt?(en||(q.dispatchEvent("hoverout"),en=!0),kt=Date.now(),Qt=q.windowMouseX,He=q.windowMouseY):Date.now()-kt>Xt&&((Math.abs(yt-q.windowMouseX)>Yt||Math.abs(Mt-q.windowMouseY)>Yt)&&(q.contentMouse=i.globalToLocal(q.windowMouseX,q.windowMouseY),q.dispatchEvent("hoverover"),yt=q.windowMouseX,Mt=q.windowMouseY,en=!1),kt=Date.now())}if(w){var Kt,fn;i.on("mousedown",function(xt){Se=xt.target.stage,Kt=xt.stageX/t.scaX,fn=Date.now()}),i.on("click",function(xt){Date.now()-fn<600&&Math.abs(xt.stageX/t.scaX-Kt)<5&&(q.contentMouse=i.globalToLocal(xt.stageX/t.scaX,xt.stageY/t.scaY),q.dispatchEvent("select"))}),i.on("mouseover",ft),i.on("mouseout",bt)}var Jt=q.scrollY;q.scrollWindow=function(je){if($e&&q.stage&&q.hitTestPoint(q.windowMouseX,q.windowMouseY)&&q.contains(q.stage.getObjectUnderPoint(q.windowMouseX*t.scaX,q.windowMouseY*t.scaY))){n(je)&&(je=event);var Ct=je.detail?je.detail*-19:je.wheelDelta;n(Ct)&&(Ct=je.deltaY*-19),Jt+=Ct,Jt=Math.max(-q.scrollYMax,Math.min(0,Jt)),S||(q.scrollY=Jt,i.stage.update()),Pe=!1}B&&gt()},j&&(ee.addEventListener("mousewheel",q.scrollWindow),ee.addEventListener("wheel",q.scrollWindow),ee.addEventListener("DOMMouseScroll",q.scrollWindow));var rn=!1,jt;function gn(xt){S&&!rn&&xt.stage&&(rn=!0,jt=new t.Damp(q.scrollY,S),q.dampTicker=t.Ticker.add(function(){if(!St){if(q.scrollY!=null&&Jt!=null&&q.scrollY!=Jt&&Math.round(q.scrollY)==Math.round(Jt)){Pe=!1;return}n(Jt)||(i.y=jt.convert(Jt)),Pe||Bt()}},xt.stage))}this._enabled=!0,Object.defineProperty(q,"enabled",{get:function(){return q._enabled},set:function(xt){xt?Dt():(clearTimeout(q.dTimeout),t.noDrag(i)),Ot(q,xt)}}),this._scrollEnabled=!0,Object.defineProperty(q,"scrollEnabled",{get:function(){return q._scrollEnabled},set:function(xt){xt?(Dt(),g&&(ze&&(Me.mouseEnabled=!0),ve&&(me.mouseEnabled=!0)),ee.addEventListener("mousewheel",q.scrollWindow),ee.addEventListener("wheel",q.scrollWindow),ee.addEventListener("DOMMouseScroll",q.scrollWindow)):(clearTimeout(q.dTimeout),t.noDrag(i),g&&(ze&&(Me.mouseEnabled=!1),ve&&(me.mouseEnabled=!1)),ee.removeEventListener("mousewheel",q.scrollWindow),ee.removeEventListener("wheel",q.scrollWindow),ee.removeEventListener("DOMMouseScroll",q.scrollWindow)),q._scrollEnabled=xt}}),Object.defineProperty(q,"scrollX",{get:function(){return i.x},set:function(xt){i.x=xt,clearTimeout(q.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Bt()}}),Object.defineProperty(q,"scrollY",{get:function(){return i.y},set:function(xt){i.y=xt,i.y=Jt=xt,S&&jt.immediate(Jt),clearTimeout(q.d2Timeout),i.zimDragImmediate&&i.zimDragImmediate(i.x,i.y),Bt()}}),Object.defineProperty(q,"backgroundColor",{get:function(){return l},set:function(xt){l=xt,Be()}}),Object.defineProperty(q,"borderColor",{get:function(){return a},set:function(xt){a=xt,Be()}}),Object.defineProperty(q,"borderWidth",{get:function(){return s},set:function(xt){s=xt,Be()}}),Object.defineProperty(q,"fullSized",{get:function(){return he},set:function(xt){q.fullSize&&q.fullSize(xt)}}),Object.defineProperty(q,"collapsed",{get:function(){return Qe},set:function(xt){q.collapse&&q.collapse(xt)}}),we&&(Qe=!1,q.collapsed=!0),q.titleBar&&(q.collapseEvent=q.titleBar.on("dblclick",function(){q.collapsed=!q.collapsed})),Q!==!1&&t.styleTransforms(this,Te),this.clone=function(xt){n(xt)&&(xt=!0);var je=q.cloneProps(new t.Window(e,r,null,l,G,ce,f,u,y,k,g,$.color,T,E,A,C,d,x,P,v,w,b,X,Y,m,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le));return xt&&(q.contentContainer.cloneChildren(je.contentContainer),je.update()),je},this.doDispose=function(xt,je,Ct){return j&&(ee.removeEventListener("mousewheel",q.scrollWindow),ee.removeEventListener("wheel",q.scrollWindow),ee.removeEventListener("DOMMouseScroll",q.scrollWindow)),i&&(q.zDE&&i.off(q.zDE),q.zME&&i.off(q.zME),q.zSTA&&i.off(q.zSTA),q.zSTO&&i.off(q.zSTO),q.zTI&&t.Ticker.remove(q.zTI)),q.titleBar&&q.titleBar.removeAllEventListeners(),Ht&&Se&&Se.off("stagemousemove",Ht),q.resizeHandle&&q.resizeHandle.removeAllEventListeners(),q.blurEvent&&ee.removeEventListener("blur",q.blurEvent),typeof Gt<"u"&&t.Ticker.remove(Gt),n(ht)||t.Ticker.remove(ht),Ct||this.zimContainer_dispose(!0),i=q.contentContainer=null,!0}},t.extend(t.Window,t.Container,["clone","dispose"],"zimContainer",!1),t.Window.prototype.dispose=function(e){return this.doDispose(null,null,e)},vi= exports.Window =t.Window,t.Page=function(e,r,i,l,a,s,f,u,y,k,g){var O="width, height, color, color2, angle, pattern, scalePattern, cache, style, group, inherit",T;if(T=st(t.Page,arguments,O,this))return T;De("58.3"),this.group=k;var E=y===!1?{}:t.getStyle("Page",this.group,g);n(e)&&(e=E.width!=null?E.width:ee.zdf.width),n(r)&&(r=E.height!=null?E.height:ee.zdf.height),this.zimContainer_constructor(0,0,e,r,!1),this.type="Page";var A=this;n(a)&&(a=E.angle!=null?E.angle:90),n(i)&&(i=E.color!=null?E.color:t.light),n(l)&&(l=E.color2!=null?E.color2:null),n(s)&&(s=E.pattern!=null?E.pattern:null),n(f)&&(f=E.scalePattern!=null?E.scalePattern:"fill"),n(u)&&(u=E.cache!=null?E.cache:!1),n(l)||(i=new t.GradientColor([i,l],[0,1],a),l=null);var C=this.backing=new t.Rectangle({width:e,height:r,color:i,scaleDimensions:!1,style:!1}).addTo(this);n(u)&&(!n(l)||!n(s))&&(u=!0),u&&C.cache(),n(s)||(this.pattern=s.addTo(this),f&&s.scaleTo(this,100,100,f).center(this),u&&s.cache()),Object.defineProperty(A,"color",{get:function(){return i},set:function(d){n(d)&&(d=t.black),i=d,A.backing.color=d}}),y!==!1&&t.styleTransforms(this,E),this.clone=function(d){n(d)&&(d=!1),i.type&&(l=null);var x=A.cloneProps(new t.Page(e,r,i,l,vertical,s,f,u,y,k,g));return d&&A.cloneChildren(x),x}},t.extend(t.Page,t.Container,["clone"],"zimContainer",!1),t.Central=function(e,r,i,l,a){De("58.4"),this.group=l;var s=i===!1?{}:t.getStyle("Central",this.group,a);n(e)&&(e=s.width!=null?s.width:1024),n(r)&&(r=s.height!=null?s.height:768),this.zimContainer_constructor(-e/2,-r/2,e,r);var f=this,u=zimDefaultFrame;f.resizeEvent=u.on("resize",function(){f.scale=u.height/r,f.parent&&f.centerReg(f.parent)}),f.added(function(){f.parent&&f.centerReg(f.parent)}),f.dispose=function(y,k,g){return u.off("resize",f.resizeEvent),f.zimContainer_dispose(y,k,g)},i!==!1&&t.styleTransforms(this,s)},t.extend(t.Central,t.Container,["dispose"],"zimContainer",!1),t.Layer=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U){var Z="width, height, titleBar, titleBarContainer, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, borderWidth, borderColor, dashed, transformObject, titleBarWidth, titleBarHeight, titleBarX, titleBarY, titleBarDraggable, close, closeColor, closeBackgroundColor, closeIndicatorColor, anchor, onTop, style, group, inherit",K;if(K=st(t.Layer,arguments,Z,this))return K;De("58.5"),this.group=R;var ne=_===!1?{}:t.getStyle("Layer",this.group,U);n(e)&&(e=ne.width!=null?ne.width:500),n(r)&&(r=ne.height!=null?ne.height:500),this.zimContainer_constructor(0,0,e,r,!1),this.type="Layer";var V=this;V.distX=40,V.distY=0,n(i)&&(i=ne.titleBar!=null?ne.titleBar:"LAYER");var D=i,c=i,h=!0;n(a)&&(a=ne.backgroundColor!=null?ne.backgroundColor:t.lighter),n(s)&&(s=ne.rollBackgroundColor!=null?ne.rollBackgroundColor:t.white),n(f)&&(f=ne.selectedBackgroundColor!=null?ne.selectedBackgroundColor:t.granite),n(y)&&(y=ne.color!=null?ne.color:t.granite),n(k)&&(k=ne.rollColor!=null?ne.rollColor:t.granite),n(g)&&(g=ne.selectedColor!=null?ne.selectedColor:t.moon),n(T)&&(T=ne.borderWidth!=null?ne.borderWidth:1),n(E)&&(E=ne.borderColor!=null?ne.borderColor:a),(E<0||T<0)&&(E=T=null),n(A)&&(A=ne.dashed!=null?ne.dashed:!0),n(C)&&(C=ne.titleBar!=null?ne.titleBar:null),n(d)&&(d=ne.titleBarWidth!=null?ne.titleBarWidth:100);var o=d;if(n(x)&&(x=ne.titleBarHeight!=null?ne.titleBarHeight:40),n(P)&&(P=ne.titleBarX!=null?ne.titleBarX:null),n(v)&&(v=ne.titleBarY!=null?ne.titleBarY:null),n(w)&&(w=ne.titleBarDraggable!=null?ne.titleBarDraggable:!0),n(b)&&(b=ne.close!=null?ne.close:!0),n(X)&&(X=ne.closeColor!=null?ne.closeColor:f),n(Y)&&(Y=ne.closeBackgroundColor!=null?ne.closeBackgroundColor:f),n(m)&&(m=ne.closeIndicatorColor!=null?ne.closeIndicatorColor:g),n(j)&&(j=ne.anchor!=null?ne.anchor:!0),n(S)&&(S=ne.onTop!=null?ne.onTop:!0),w||(j=!1),V.anchor=j,b&&(d+=30),C=t.merge({borderColor:f},C,{onTop:S,events:!0,visible:!1,ghostColor:E,ghostWidth:T,ghostDashed:A,ghostHidden:!0}),n(l)&&(l=ne.titleBarContainer!=null?ne.titleBarContainer:null),n(l))if(ee.zdf)l=ee.zdf.stage;else{tt("zim Layer(): Please pass in a reference to a container with bounds set.");return}V.active=!1,V.turnOff=function(){V.active=!1,b&&(V.checkBox.visible=!1),V.transformControls.remove(),V.mouseChildren=!0,V.button.backgroundColor=a,V.button.rollBackgroundColor=s,V.button.color=y,V.button.rollColor=y,V.transformControls.allowToggleOff(),V.resizeChildren&&V.resizeChildren()},V.turnOn=function(){V.active=!0,b&&(V.checkBox.visible=!0,V.checkBox.checked=!0),V.button.backgroundColor=f,V.button.rollBackgroundColor=f,V.button.color=g,V.button.rollColor=g,V.mouseChildren=!1,V.transformControls.add(),V.transformControls.allowToggleOn()};var I;V.titleBarPos=function(L,we){if(V.titleBar)return V.titleBar.pos?(V.titleBar.pos(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9]),I.update()):(V.distX=L,V.distY=we),h=!1,V};var N=V.visible;V.visible=!1;var p=Tt();this.added(function(L){I=L,V.transform(C),T>=0&&V.transformControls.hideGhost(),setTimeout(function(){function we(){return V.localToLocal(0,0,l)}V.visible=N,T>=0&&setTimeout(function(){V.transformControls.showGhost(),V.stage&&V.stage.update()},200),I=L;var B=V.titleBar=new t.Container(d,x).reg(0,x).loc(V,null,l).mov(V.distX,V.distY);w&&B.drag({all:!0,boundary:new t.Boundary(0,x,l.width-d,l.height-x),localBoundary:!0}),(V.distX!=40||V.distY!=0)&&B.pos(V.distX,V.distY),b&&(V.checkBox=new t.CheckBox({borderColor:X,backgroundColor:Y,indicatorColor:m,size:20,startChecked:!0}).center(B).pos(0,null,!0).change(function(){V.turnOff(),V.dispatchEvent("transformhide")}),V.checkBox.visible=!1),B.mouseChildren=!0,B.layer=V,V.resetTitleBar=function(){V.distX=40,V.distY=0,h=!0,V.move(!0),V.stage&&V.stage.update()},(typeof c=="string"||typeof c=="number")&&(c=new t.Label({text:c,color:y,rollColor:k,size:ne.size!=null?ne.size:18,group:this.group})),V.label=c,V.label.center(B),V.button=new t.Button({shadowBlur:-1,width:o,height:x-1,label:V.label,color:y,rollColor:k,backgroundColor:a,rollBackgroundColor:s,corner:ne.corner!=null?ne.corner:0,inherit:t.copy(ne)}).addTo(B),V.button.on("mousedown",function(){l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()}),V.active||(V.turnOn(),V.dispatchEvent("transformshow")),B.top()}),V.button.on("pressmove",function(){F()}),V.button.on("pressup",function(){F(!0);var J=V.localToLocal(0,0,l);V.distX=B.x-J.x,V.distY=B.y-J.y,B.top(),!se()&&w&&(J=V.localToGlobal(0,0),V.button.hitTestPoint(J.x,J.y)&&V.resetTitleBar())});function F(J){if(h&&w){var Te=l.localToLocal(B.x-V.distX,B.y-V.distY,V.parent),G=V.localToLocal(V.regX,V.regY,V.parent),ce=V.localToLocal(0,0,V.parent);V.x=Te.x+(G.x-ce.x),V.y=Te.y+(G.y-ce.y),V.transformControls.resize(J),fe(V),V.stage&&V.stage.update()}}function fe(J){J.loop(function(Te){Te.type=="Layer"&&(V.titleBarDraggable&&Te.move(),Te.transformControls.ghost&&Te.transformControls.resize(),fe(Te))})}V.button.on("dblclick",function(){w&&V.resetTitleBar()}),V.turnOff(),V.on("transformed",function(J){(J.transformType=="move"||J.transformType=="size"||J.transformType=="stretch"||J.transformType=="rotate")&&(w&&V.move(),fe(V))});function se(){if(B.x==0||B.y==B.height||B.x==l.width-B.width||B.y==l.height)return!0}V.move=function(J){!J&&!h&&V.anchor&&se()||(B.loc(we()).mov(V.distX,V.distY),B.x<0&&(h=!1,B.x=0),B.y<B.height&&(h=!1,B.y=B.height),B.x>l.width-B.width&&(h=!1,B.x=l.width-B.width),B.y>l.height&&(h=!1,B.y=l.height),V.anchor||(h=!0))},V.on("transformhide",function(){V.turnOff(),l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()})}),V.resizeChildren=function(J){V.transformControls.resize(J),V.loop(function(Te){Te.transformControls&&(Te.transformControls.visible&&Te.transformControls.hide(),Te.type=="Layer"?Te.resizeChildren():Te.transformControls.resize())})},V.resize=function(J){return V.move(),V.resizeChildren(J),V},V.toggled=!1;function Q(){V.toggled?(l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()}),V.turnOn(),V.dispatchEvent("transformshow")):(B.top(),V.turnOff(),l.loop(function(J){J&&J!=B&&J.layer&&J.layer.turnOff&&J.layer.active&&J.layer.turnOff()}),V.dispatchEvent("transformhide")),V.stage&&V.stage.update()}if(V.toggle=function(J){return n(J)?V.toggled=!V.toggled:V.toggled=J,Q(),V},Object.defineProperty(V,"titleBarDraggable",{get:function(){return w},set:function(J){w=J,w?B.drag({all:!0,boundary:t.Boundary(0,40,l.width-d,l.height-x),localBoundary:!0}):B.noDrag(!1)}}),V.stageUpEvent=I.on("stagemouseup",function(){V.transformControls.visible&&B.top()}),!n(P)||!n(v)){h=!1;var te=n(P)?B.x:P,le=n(v)?B.y-x:v;V.titleBarStartX=P,V.titleBarStartY=v,V.titleBarPos(te,le);var Ae=V.parent.localToLocal(V.x,V.y,l);V.distX=B.x-Ae.x,V.distY=B.y-Ae.y}},50)},p=="s"?.05:50),_!==!1&&t.styleTransforms(this,ne),this.clone=function(){return V.cloneProps(new t.Layer(e,r,D,l,a,s,f,u,y,k,g,O,T,E,A,C,o,x,P,v,w,b,X,Y,m,j,S,_,this.group,U))},this.dispose=function(L,we,B){return V.stageUpEvent&&I.off("stagemouseup",V.stageUpEvent),l&&l.loop(function(F){F.layer=null}),V.transformControls.dispose(),V.transformControls=null,B||this.zimContainer_dispose(!0),V.titleBar.layer=null,V.titleBar.dispose(),V.checkBox=V.button=null,i=V.titleBar=C=null,!0}},t.extend(t.Layer,t.Container,["clone","dispose"],"zimContainer",!1),t.Waiter=function(e,r,i,l,a,s,f,u,y,k,g){var O="container, speed, foregroundColor, backgroundColor, corner, shadowColor, shadowBlur, fadeTime, style, group, inherit",T;if(T=st(t.Waiter,arguments,O,this))return T;De("59"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Waiter",this.group=k;var E=y===!1?{}:t.getStyle(this.type,this.group,g),A=Tt(r);n(r)&&(r=E.speed!=null?E.speed:A=="s"?.6:600),n(i)&&(i=E.foregroundColor!=null?E.foregroundColor:t.white),n(l)&&(l=E.backgroundColor!=null?E.backgroundColor:"orange"),n(a)&&(a=E.corner!=null?E.corner:16),n(s)&&(s=E.shadowColor!=null?E.shadowColor:"rgba(0,0,0,.3)"),n(f)&&(f=E.shadowBlur!=null?E.shadowBlur:14),n(u)&&(u=E.fadeTime!=null?E.fadeTime:0);var C=40,d=3,x=C*.6/2,P=(C-x*2)/2,v=d*(x*2+P)+P;this.setBounds(-v/2,-C/2,v,C);var w=this,b,X=this.display=new t.Shape({style:!1});this.addChild(X),X.setBounds(0,0,v,C),X.regX=v/2,X.regY=C/2;var Y=X.graphics;Y.f(l);var m=a;Array.isArray(m)||(m=[a,a,a,a]),Y.rc(0,0,v,C,m[0],m[1],m[2],m[3]),s!=-1&&f>0&&(X.shadow=new Fe.Shadow(s,3,3,f)),X.on("click",function(Z){Z.stopImmediatePropagation()});var j=new t.Container({style:!1});this.addChild(j);for(var S,_=0;_<d;_++)S=new Fe.Shape,S.graphics.f(i).dc(0,0,x),S.x=(_-(d-1)/2)*(x*2+P),j.addChild(S),S.cache(-x,-x,x*2,x*2),S.alpha=0;this.hide=function(){u>0?w.animate({obj:{alpha:0},time:u,call:Z}):Z();function Z(){if(w.parent&&w.parent.removeChild(w),b=w.stage,b&&b.update(),w.zimAccessibility){var K=w.zimAccessibility;K.resize(w),R?R.focus():w.zimTabTag.nextSibling.focus(),setTimeout(function(){K.talk("Waiter has finished.")},50)}}return w.toggled=!1,w};var R,U=[];this.show=function(){var Z="zim display - Waiter(): Please pass in a reference to a container with bounds set as first parameter to Waiter";if(n(e))if(ee.zdf)e=ee.zdf.stage;else{tt(Z);return}else if(e.getBounds){if(n(e.stage)){tt("zim display - Waiter(): The container must have a stage property");return}}else{tt(Z);return}for(var K,ne=0,V=r*(A=="s"?1e3:1),D=0;D<j.numChildren;D++)j&&U.push(setTimeout(function(){K=j.getChildAt(ne),Fe.Tween.get(K,{loop:!0}).to({alpha:1},V/d/2).wait(V/d).to({alpha:0},V/d).wait(V-V/d-V/d/2),ne++},D*V/d));if(w.ticker=Fe.Ticker.on("tick",function(){e.stage.update()}),w.x=e.getBounds().width/2,w.y=e.getBounds().height/2,e.addChild(w),u>0&&(w.alpha=0,w.animate({alpha:1},u)),w.zimAccessibility){var c=w.zimAccessibility;setTimeout(function(){c.activatedObject&&(R=c.activatedObject.zimTabTag)},50),c.resize(w),c.talk(w.zimTabTag.getAttribute("aria-label"))}return w.toggled=!0,w},w.toggle=function(Z){return Z===!0?w.show():Z===!1||w.parent?w.hide():w.show(),w},y!==!1&&t.styleTransforms(this,E),this.clone=function(){return w.cloneProps(new t.Waiter(e,r,i,l,a,s,f,u,y,this.group,g))},this.dispose=function(Z,K,ne){w.ticker&&Fe.Ticker.off("tick",w.ticker),Fe.Tween.removeTweens(w),w.removeFrom();for(var V=0;V<j.numChildren;V++){var D=j.getChildAt(V);clearInterval(U[V]),Fe.Tween.removeTweens(D)}return ne||this.zimContainer_dispose(!0),!0}},t.extend(t.Waiter,t.Container,["clone","dispose"],"zimContainer",!1),t.ProgressBar=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b){var X="barType, foregroundColor, backgroundColor, borderColor, borderWidth, padding, label, color, labelPosition, percentage, corner, shadowColor, shadowBlur, backing, delay, fastClose, container, autoHide, width, style, group, inherit",Y;if(Y=st(t.ProgressBar,arguments,X,this))return Y;De("59.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ProgressBar",this.group=w;var m=v===!1?{}:t.getStyle(this.type,this.group,b);n(r)&&(r=m.foregroundColor!=null?m.foregroundColor:t.green),n(i)&&(i=m.backgroundColor!=null?m.backgroundColor:t.charcoal),n(l)&&(l=m.borderColor!=null?m.borderColor:i),n(a)&&(a=m.borderWidth!=null?m.borderWidth:null),n(y)&&(y=m.labelPosition!=null?m.labelPosition:"bottom"),n(e)&&(e=m.barType!=null?m.barType:"circle"),n(s)&&(s=m.padding!=null?m.padding:e=="circle"?2:-.5),n(g)&&(g=m.corner!=null?m.corner:15),n(O)&&(O=m.shadowColor!=null?m.shadowColor:"rgba(0,0,0,.3)"),n(T)&&(T=m.shadowBlur!=null?m.shadowBlur:14),n(E)&&(E=m.backing!=null?m.backing.clone():null),n(C)&&(C=m.fastClose!=null?m.fastClose:!0),l<0||a<0?l=a=null:l!=null&&a==null&&(e=="circle"?a=10:a=2);var j=Tt(A);n(A)&&(A=m.delay!=null?m.delay:j=="s"?.1:100),n(x)&&(x=m.autoHide!=null?m.autoHide:!0),n(f)&&(f=m.label!=null?m.label:null),n(u)&&(u=m.color!=null?m.color:r),n(P)&&(P=m.width!=null?m.width:e=="circle"?40:200),(typeof f=="string"||typeof f=="number")&&(f=new t.Label({text:f,color:u,backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group})),!n(k)&&n(f)&&(f=new t.Label("")),this.label=f;var S=30,_=this,R=0;_.visible=!1,setTimeout(function(){_.visible=!0,_.stage&&_.stage.update()},A);var U;if(e=="circle")P=P/2,E=this.backing=new t.Circle(P,"rgba(0,0,0,0)",i,a,null,null,null,null,!1).addTo(_),U=this.bar=new t.Shape({style:!1}).addTo(_).loc(E.x,E.y).rot(-90);else{if(O!=-1&&T>0){var Z=new t.Rectangle(P-2,S-2,i,null,null,g,null,null,null,!1).addTo(this);Z.shadow=new Fe.Shadow(O,3,3,T)}E=D(E);var K=g;Array.isArray(K)||(K=[g,g,g,g]);var ne=(s+a/2)*1.2;U=this.bar=new t.Rectangle(P-(s+a/2)*1.8,S-(s+a/2)*1.8,r,null,null,[K[0]-ne,K[1]-ne,K[2]-ne,K[3]-ne],null,null,null,!1).center(this);var V=this.mask=new t.Rectangle(P-(s+a/2)*1.8,S-(s+a/2)*1.8,null,null,null,null,null,null,null,!1).center(this).alp(0).sca(0,1);U.setMask(V)}function D(I){var N;if(_.backing?(N=_.getChildIndex(_.backing),_.removeChild(_.backing)):N=_.numChildren,_.border&&_.removeChild(_.border),!n(I)&&I.type=="Pattern"){var p=I;I=_.backing=new t.Rectangle(P,S,i,null,null,g,null,null,null,!1).addTo(_,N),I.pattern=p,p.center(I),p.setMask(I.shape),a&&(_.border=new t.Rectangle(P,S,"rgba(0,0,0,0)",l,a,g,null,null,null,!1).addTo(_,N+1))}else I=_.backing=n(I)?new t.Rectangle(P,S,i,l,a,g,null,null,null,!1).addTo(_,N):E.addTo(_,N);return I}_.setBacking=function(I){D(I),_.stage&&_.stage.update()},E.on("click",function(I){I.stopImmediatePropagation()}),n(f)||(f.scaleX=f.scaleY=.8,f.startText=f.text,n(k)||(f.text=f.startText+"  0%"),f.center(_),y=="above"?f.y-=60:f.y+=60,f.alpha=.8),this.hide=function(){var I=_.stage;if(_.parent&&_.parent.removeChild(_),_.backing.type=="Pattern"&&_.backing.pauseInterval&&_.backing.pauseInterval(),I&&I.update(),_.zimAccessibility){var N=_.zimAccessibility;N.resize(_),c?c.focus():_.zimTabTag.nextSibling.focus(),setTimeout(function(){N.talk("Progress Bar has finished.")},50)}return _.toggled=!1,_};var c;this.show=function(){var I="zim display - ProgressBar(): Please pass in a reference to a container with bounds set as first parameter of the ProgressBar";if(n(d))if(ee.zdf)d=ee.zdf.stage;else{tt(I);return}else if(d.getBounds){if(n(d.stage)){tt("zim display - Waiter(): The container must have a stage property");return}}else{tt(I);return}if(_.timeOut&&clearTimeout(_.timeOut),h(0),_.zimActiveLoader&&_.zimActiveLoader.on("progress",function(p){R=p.progress*100,h(R)}),_.center(d),_.backing.type=="Pattern"&&_.backing.pauseInterval&&_.backing.pauseInterval(!1),_.zimAccessibility){var N=_.zimAccessibility;setTimeout(function(){N.activatedObject&&(c=N.activatedObject.zimTabTag)},50),N.resize(_),N.talk(_.zimTabTag.getAttribute("aria-label"))}return _.toggled=!0,_},_.toggle=function(I){return I===!0?_.show():I===!1||_.parent?_.hide():_.show(),_},_.run=function(I,N){n(N)||(x=N),n(I)&&(I=j=="s"?3:3e3),Pt(I,j);var p=I*(j=="s"?1e3:1);_.runInterval&&clearInterval(_.runInterval),_.percent=0;var L=Date.now();return _.runInterval=setInterval(function(){_.percent=(Date.now()-L)/p*100,_.percent>=100&&(_.percent=100,clearInterval(_.runInterval))},30),_},_.dispatched=!1;function h(I){e=="circle"?U.graphics.c().mt(0,0).s(r).ss(a-s*2+.5).a(0,0,P,0,360*I/100*Math.PI/180):(V.sca(I/100,1),U.setMask(V)),n(k)||(f.text=f.startText+" "+Math.min(Math.round(I),100)+"%"),x&&C&&Math.round(I)>=100&&(_.timeOut=setTimeout(function(){_.hide()},200)),!_.dispatched&&Math.round(I)>=100&&(_.dispatchEvent("complete"),_.dispatched=!0,setTimeout(function(){_&&(_.dispatched=!1)},100)),_.stage&&_.stage.update()}Object.defineProperty(_,"percent",{get:function(){return R},set:function(I){R=I,h(I)}});var o=_.getBounds();_.setBounds(o.x-5,o.y-5,o.width+10,o.height+10),v!==!1&&t.styleTransforms(this,m),this.clone=function(){return _.cloneProps(new t.ProgressBar(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,this.group,b))},this.dispose=function(I,N,p){return _.backing.type=="Pattern"&&_.backing.clearInterval&&_.backing.clearInterval(),_.runInterval&&clearInterval(_.runInterval),p||this.zimContainer_dispose(!0),!0}},t.extend(t.ProgressBar,t.Container,["clone","dispose"],"zimContainer",!1),t.Indicator=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w){var b="width, height, num, foregroundColor, backgroundColor, borderColor, borderWidth, backdropColor, corner, indicatorType, fill, scale, lightScale, interactive, shadowColor, shadowBlur, selectedIndex, backgroundAlpha, style, group, inherit",X;if(X=st(t.Indicator,arguments,b,this))return X;De("60"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Indicator",this.group=v;var Y=P===!1?{}:t.getStyle(this.type,this.group,w);n(e)&&(e=Y.width!=null?Y.width:300),n(r)&&(r=Y.height!=null?Y.height:50),n(i)&&(i=Y.num!=null?Y.num:6),n(k)&&(k=Y.indicatorType!=null?Y.indicatorType:"dot"),n(l)&&(l=Y.foregroundColor!=null?Y.foregroundColor:k=="star"?t.yellow:k=="heart"?t.red:t.orange),n(a)&&(a=Y.backgroundColor!=null?Y.backgroundColor:t.granite),a<0&&(a=Y.backgroundColor!=null?Y.backgroundColor:"rgba(0,0,0,.01)"),n(s)&&(s=Y.borderColor!=null?Y.borderColor:null),n(f)&&(f=Y.borderWidth!=null?Y.borderWidth:null),s<0||f<0?s=f=null:s!=null&&f==null&&(f=1),n(u)&&(u=Y.backdropColor!=null?Y.backdropColor:-1),n(y)&&(y=Y.corner!=null?Y.corner:0),n(g)&&(g=Y.fill!=null?Y.fill:!1),n(O)&&(O=Y.scale!=null?Y.scale:1),n(T)&&(T=Y.lightScale!=null?Y.lightScale:1),n(E)&&(E=Y.interactive!=null?Y.interactive:!1),n(A)&&(A=Y.shadowColor!=null?Y.shadowColor:"rgba(0,0,0,.3)"),n(C)&&(C=Y.shadowBlur!=null?Y.shadowBlur:5),n(x)&&(x=Y.backgroundAlpha!=null?Y.backgroundAlpha:.2);var m=(Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",j=this;this.lights=[];var S;if(u!=-1){var _=j.backdrop=new t.Rectangle(e,r,u,s,f,y,null,null,null,!1);this.addChild(_)}var R=this.lightsContainer=new t.Container({style:!1});this.addChild(R);var U,Z=r*.5,K=e/(i+1),ne=new Fe.Shape,V=!1;k=="square"||k=="box"||k.type=="Emoji"?ne.graphics.f("black").dr(-K/2/T+Z/2,-r/2+Z/2,K/T,r):ne.graphics.f("black").dr(-K/2/T,-r/2,K/T,r);for(var D=0;D<i;D++)k=="square"||k=="box"?(U=new t.Rectangle(Z,Z,a,s,f,null,null,null,null,!1),U.regX=U.width/2,U.regY=U.height/2):k=="star"?U=new t.Poly(Z*.6,5,.5,a,s,f,null,null,!1):k=="heart"?U=new t.Blob({points:[[0,-40.7,0,0,-57.3,-76.6,41.8,-80.3,"mirror"],[100,0,0,0,23.7,-45.4,-23.7,45.4,"mirror"],[0,100,0,0,0,0,0,0,"mirror"],[-100,0,0,0,21.9,48.2,-21.9,-48.2,"mirror"]],color:a,interactive:!1}).transformPoints("scale",.15):k.type=="Emoji"?(V=!0,U=k.clone().reg("center","center"),U.myCache=!1):U=new t.Circle(Z/2,a,s,f,null,null,null,null,!1),this.lights.push(U),U.znum=D,U.scaleX=U.scaleY=T,U.hitArea=ne,U.x=K+K*D,U.y=r/2,R.addChild(U);R.setBounds(0,0,e,r),R.regX=R.x=e/2,R.regY=R.y=r/2,this.addChild(R),A!=-1&&C>0&&(R.shadow=new Fe.Shadow(A,2,2,C)),E&&(R.cur("pointer"),j.lightsEvent=R.on(m,function(h){if(S==h.target.znum){if(S>0)return;if(S==0){S=-1,c(S),j.dispatchEvent("change");return}}S=h.target.znum,c(S),j.dispatchEvent("change")})),R.scaleX=R.scaleY=O;function c(h){h>=i&&(h=-1);for(var o,I=0;I<i;I++){g&&I<h?o=l:o=a,I==h&&(o=l);var N=R.getChildAt(I);V&&(N.alpha=o==l?1:x),N.color=o}j.zimAccessibility&&j.zimAccessibility.changeTitle(j),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&j.stage&&j.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return S},set:function(h){S=Math.floor(h),S=t.constrain(S,-1,i-1),c(S)}}),Object.defineProperty(this,"num",{get:function(){return i},set:function(){vt&&tt("Indicator() - num is read only")}}),this._enabled=!0,Object.defineProperty(j,"enabled",{get:function(){return j._enabled},set:function(h){Ot(j,h)}}),n(d)&&(d=Y.selectedIndex!=null?Y.selectedIndex:0),j.selectedIndex=d,P!==!1&&t.styleTransforms(this,Y),this.dispose=function(h,o,I){I||(j.lightsEvent&&R.off(m,j.lightsEvent),this.zimContainer_dispose())},this.clone=function(){return j.cloneProps(new t.Indicator(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,this.group,w))}},t.extend(t.Indicator,t.Container,["clone","dispose"],"zimContainer",!1),t.TextInput=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p){var L="width, height, placeholder, text, size, font, color, backgroundColor, borderColor, borderWidth, maxLength, password, selectionColor, selectionAlpha, cursorColor, cursorSpeed, shadowColor, shadowBlur, align, corner, padding, paddingH, paddingV, shiftH, shiftV, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, readOnly, inputType, rtl, uppercase, placeholderInstant, keyboardShift, style, group, inherit",we;if(we=st(t.TextInput,arguments,L,this))return we;De("54.2"),this.group=N;var B=I===!1?{}:t.getStyle("TextInput",this.group,p);n(a)&&(a=B.size!=null?B.size:36),(n(w)||w=="ignore")&&(w=B.padding!=null&&w!="ignore"?B.padding:5),n(b)&&(b=B.paddingH!=null?B.paddingH:w),n(X)&&(X=B.paddingV!=null?B.paddingV:w),n(e)&&(e=B.width!=null?B.width:300),n(r)&&(r=B.height!=null?B.height:a+X*2),n(i)&&(i=B.placeholder!=null?B.placeholder:null),n(l)&&(l=B.text!=null?B.text:""),n(s)&&(s=B.font!=null?B.font:"arial"),n(f)&&(f=B.color!=null?B.color:t.dark),n(u)&&(u=B.backgroundColor!=null?B.backgroundColor:t.lighter),n(y)&&(y=B.borderColor!=null?B.borderColor:null),n(k)&&(k=B.borderWidth!=null?B.borderWidth:null);var F=fe(e,r,i,l,f,u,y);this.veeObj={width:F[0],height:F[1],placeholder:F[2],text:F[3],color:F[4],backgroundColor:F[5],borderColor:F[6]};function fe(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i),l=t.Pick.choose(l),f=t.Pick.choose(f),u=t.Pick.choose(u),y=t.Pick.choose(y),n(T)&&(T=B.selectionColor!=null?B.selectionColor:f),n(E)&&(E=B.selectionAlpha!=null?B.selectionAlpha:.2),n(A)&&(A=B.cursorColor!=null?B.cursorColor:f),n(C)&&(C=B.cursorSpeed!=null?B.cursorSpeed:.5),n(d)&&(d=B.shadowColor!=null?B.shadowColor:"rgba(0,0,0,.3)"),n(x)&&(x=B.shadowBlur!=null?B.shadowBlur:20),n(P)&&(P=B.align!=null?B.align:"left"),n(v)&&(v=B.corner!=null?B.corner:0),n(Y)&&(Y=B.shiftH!=null?B.shiftH:0),n(O)&&(O=B.password!=null?B.password:!1),n(m)&&(m=B.shiftV!=null?B.shiftV:O?a*.25:0),n(g)&&(g=B.maxLength!=null?B.maxLength:P=="center"?Math.floor(e/a)*1.8:null),n(j)&&(j=B.scrollBarActive!=null?B.scrollBarActive:!1),n(S)&&(S=B.scrollBarDrag!=null?B.scrollBarDrag:!1),n(_)&&(_=B.scrollBarColor!=null?B.scrollBarColor:y),n(R)&&(R=B.scrollBarAlpha!=null?B.scrollBarAlpha:.3),n(U)&&(U=B.scrollBarFade!=null?B.scrollBarFade:!0),n(Z)&&(Z=B.scrollBarH!=null?B.scrollBarH:!0),n(K)&&(K=B.scrollBarV!=null?B.scrollBarV:!0),n(ne)&&(ne=B.readOnly!=null?B.readOnly:!1),n(V)&&(V=B.inputType!=null?B.inputType:"text"),S&&(U=B.scrollBarFade!=null?B.scrollBarFade:!1),n(D)&&(D=B.rtl!=null?B.rtl:ee.DIR=="rtl"||t.DIR=="rtl"?"rtl":null),n(c)&&(c=B.uppercase!=null?B.uppercase:null),n(o)&&(o=B.keyboardShift!=null?B.keyboardShift:null),c&&(l&&(l=l.toUpperCase()),i&&(i=i.toUpperCase())),n(h)&&(h=B.placeholderInstant!=null?B.placeholderInstant:!0);function se(){return ee.DIR&&ee.DIR=="rtl"||!ee.DIR&&t.DIR=="rtl"?P=="start"?P="right":P=="end"&&(P="left"):P=="start"?P="left":P=="end"&&(P="right"),P}P=se(P),this.zimWindow_constructor(e,r,null,u,y,k,w,v,!1,j,S,_,R,U,Z,K,!1,null,null,!1,!0,d,x,b,X,!0,null,null,null,null,null,!1,null,null,null,null,null,null,null,null,null,null,null,null,I,N,t.copy(B)),this.type="TextInput";var Q=this;this.placeholderLabel=new t.Label({text:i||"",size:a,color:f,font:s,shiftH:Y,shiftV:m,valign:"top"}).alp(.5),l==""&&this.add(this.placeholderLabel);var te=new t.Rectangle({width:e-w*2,height:r-w*2,color:t.clear,style:!1}).center(this);this.cur("text");var le=this.label=new t.TextInput.LabelInput(l,a,g,O,T,E,A,C,s,f,null,null,null,P,"top",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,Y,m,null,null,null,null,V,D,c,h,I,N,p);this.add(le),le.setMask(te),this.htmlTag=this.label.hiddenInput,this.selection=this.label.selection,this.blinker=this.label.blinker,P=="right"?(le.x=e-b,this.placeholderLabel.x=e-this.placeholderLabel.width-b):P=="center"&&(le.x=e/2,this.placeholderLabel.x=(e-this.placeholderLabel.width)/2),le.ogx=le.x,Q.placeholderLabel.x=le.x,Q.placeholderLabel.align=P;var Ae=new t.Rectangle({width:w,height:r,color:t.clear,style:!1}).addTo(this).expand(0);Ae.on("mousedown",function(ue){le.onMousedown(ue),ue.stopImmediatePropagation()}),Ae.on("pressmove",function(ue){le.onPressmove(ue),ue.stopImmediatePropagation()}),Ae.on("dblclick",function(ue){le.onDblclick(ue),ue.stopImmediatePropagation()});var J=new t.Rectangle({width:w,height:r,color:t.clear,style:!1}).pos(0,0,t.RIGHT,t.TOP,this).expand(0);J.on("mousedown",function(ue){le.onMousedown(ue),ue.stopImmediatePropagation()}),J.on("pressmove",function(ue){le.onPressmove(ue),ue.stopImmediatePropagation()}),J.on("dblclick",function(ue){le.onDblclick(ue),ue.stopImmediatePropagation()});var Te=le.text;this.on("mousedown",function(ue){le.onMousedown(ue),Te=le.text}),this.on("pressmove",function(ue){le.onPressmove(ue),ue.stopImmediatePropagation()}),this.on("dblclick",function(ue){le.onDblclick(ue),ue.stopImmediatePropagation()}),this.added(function(ue){ue.on("stagemousedown",function(ge){Q.hitTestPoint(ge.stageX,ge.stageY)||(le.focus=!1,le.text!=Te&&Q.dispatchEvent("change"),Te=le.text)})});var G=Q.stage?stage.y:0;this.label.on("focus",function(){if(ee.M&&o){Q.re&&Q.stage.frame.off("resize",Q.re),Q.re=Q.stage.frame.on("resize",function(){Q.stage&&ue>Q.stage.height/4&&(Q.stage.y=Q.stage.scaleY*(Q.stage.height/4-ue),Q.stage.update())});var ue=Q.label.localToGlobal(0,0).y;Q.stage&&ue>Q.stage.height/4&&(Q.stage.y=Q.stage.scaleY*(Q.stage.height/4-ue),Q.stage.update())}h&&Q.placeholderLabel.parent&&(Q.placeholderLabel.removeFrom(),Q.stage&&Q.stage.update()),Q.dispatchEvent("focus")}),this.label.on("blur",function(){ee.M&&o&&Q.stage&&(Q.re&&Q.stage.frame.off("resize",Q.re),Q.stage.y=G,Q.stage.update()),h&&le.text==""&&!Q.placeholderLabel.parent&&(Q.add(Q.placeholderLabel),Q.stage&&Q.stage.update()),Q.dispatchEvent("blur")});function ce(){le.text!=""&&Q.placeholderLabel.parent&&(Q.placeholderLabel.removeFrom(),Q.stage&&Q.stage.update()),le.text==""&&!Q.placeholderLabel.parent&&(Q.add(Q.placeholderLabel),Q.stage&&Q.stage.update())}this.label.on("input",function(){ce(),Q.dispatchEvent("input")}),this.label.on("keydown",function(ue){this.label.deleteKey=ue.detail==46,Q.dispatchEvent("keydown")}),this.label.on("blinker",function(){var ue=Q.localToGlobal(0,0).x,ge=ue+e-b-le.blinker.width,ie=le.blinker,xe=ie.localToGlobal(0,0).x,Se=le.localToGlobal(0,0).x-1,z=le.x+le.blinker.x,pe=t.constrain(z,b,e-b-le.blinker.width);if(z!=pe&&(le.x-=z-pe),P=="left")le.width<Q.width?le.x=le.ogx:ge<xe||le.oldWidth==le.width?le.x-=z-pe:le.oldWidth>le.width&&this.label.deleteKey!=!0&&(le.x+=Math.abs(ie.oldX-xe)+le.blinker.width+b);else if(P=="right")le.width<Q.width?le.x=le.ogx:ge<xe||le.oldWidth==le.width?le.x-=z-pe:le.oldWidth>le.width&&this.label.deleteKey==!0&&xe<Se-Q.width&&(le.x-=Math.abs(ie.oldX-xe)+le.blinker.width+b);else if(P=="center"){if(le.width<Q.width)le.x=le.ogx;else if(ge<xe)le.x-=z-pe;else if(le.oldWidth==le.width)le.x-=z-pe;else if(le.oldWidth>le.width&&ge>xe){var de=ue+Q.width*.5;this.label.deleteKey!=!0?le.x+=le.blinker.width+b:le.x-=le.blinker.width+b}}le.oldWidth=le.width,ie.oldX=xe,Q.stage&&Q.stage.update()}),Object.defineProperty(Q,"text",{get:function(){return le.hiddenInput.value},set:function(ue){Te=ue,le.setText(ue),ce(),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==Q},set:function(){t.KEYFOCUS=Q}}),t.KEYFOCUS||q(),this.on("mousedown",function(){q()});function q(){Q.keyFocus=!0}Object.defineProperty(Q,"readOnly",{get:function(){return ne},set:function(ue){ne=ue,Q.htmlTag.setAttribute("readonly",ne)}}),ne&&(Q.readOnly=!0),Object.defineProperty(Q,"focus",{get:function(){return le.focus},set:function(ue){le.focus=ue}}),Object.defineProperty(Q,"color",{get:function(){return le.color},set:function(ue){le.color=latestColor=ue,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(Q,"size",{get:function(){return le.size},set:function(ue){le.size=ue,le.hiddenInput.style.fontSize=ue+"px",!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(Q,"align",{get:function(){return le.align},set:function(ue){le.align=P=se(ue),P=="right"?le.x=e-le.width:P=="center"?le.x=e/2:le.x=0,Q.placeholderLabel.x=le.x,Q.placeholderLabel.align=P,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(Q,"font",{get:function(){return le.font},set:function(ue){le.font=ue,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),Object.defineProperty(Q,"selectionAlpha",{get:function(){return le.selectionAlpha},set:function(ue){le.selectionAlpha=ue,le.selection.alpha!=0&&(le.selection.alpha=ue),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&Q.stage&&Q.stage.update()}}),I!==!1&&t.styleTransforms(this,B),this.clone=function(ue){return Q.cloneProps(new t.TextInput(ue||!t.isPick(F[0])?e:F[0],ue||!t.isPick(F[1])?r:F[1],ue||!t.isPick(F[2])?i:F[2],ue||!t.isPick(F[3])?l:F[3],a,s,ue||!t.isPick(F[4])?f:F[4],ue||!t.isPick(F[5])?u:F[5],ue||!t.isPick(F[6])?y:F[6],k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,this.group,p))}},t.extend(t.TextInput,t.Window,"clone","zimWindow",!1),t.TextInput.LabelInput=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we){this.zimLabel_constructor(e,r,y,k,null,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,null,D,c,null,h,p,L,we),this.type="LabelInput",n(k)&&(k=t.dark),n(a)&&(a=k),n(s)&&(s=.2),this.selectionAlpha=s,n(f)&&(f=k),n(u)&&(u=.5),this.hiddenInput=document.createElement("INPUT"),this.hiddenInput.setAttribute("id",t.makeID()),this.hiddenInput.value=e,o=="text"&&l&&(o="password"),this.hiddenInput.type=o,o=="number"&&(this.hiddenInput.pattern="[^(0-9).-+*/%$]*",this.hiddenInput.inputmode="numeric"),i>0&&(this.hiddenInput.maxLength=i),this.hiddenInput.autocapitalize="off",this.hiddenInput.autocorrect="off",this.hiddenInput.autocomplete="off",this.hiddenInput.spellcheck=!1,this.hiddenInput.style.position="absolute",this.hiddenInput.style.overflow="hidden",this.hiddenInput.style.touchAction="none",this.hiddenInput.style.left="-99999px",this.hiddenInput.style.top="-99999px",this.hiddenInput.style.zIndex=-999,this.hiddenInput.style.opacity=0,this.hiddenInput.style.width="1px",this.hiddenInput.style.height="1px",this.hiddenInput.style.fontSize="1px",this.onFocus=function(){this.stage&&(F=this.stage.frame),F.zil&&ee.removeEventListener("keydown",F.zil[0]),this.blinker.alp(1).replayTween(),this.selection.alp(.2),this.positionBlinkerAndSelection(),this.dispatchEvent("focus")},this.onBlur=function(){this.stage&&(F=this.stage.frame),F.zil&&ee.addEventListener("keydown",F.zil[0]),this.positionBlinkerAndSelection(),this.blinker.pauseAnimate(!0).alp(0),this.selection.alp(0),this.hiddenInput.type=o,this.dispatchEvent("blur")},this.onInput=function(){N&&(this.hiddenInput.value=this.hiddenInput.value.toUpperCase());var fe=this.hiddenInput.value;o=="number"&&(fe=fe.replace(/[^(0-9).\-+*/%$]*/g,""),this.hiddenInput.value=fe),this.text=this.hiddenInput.type=="password"?fe.replace(/./g,"*"):fe,this.measureText(),this.dispatchEvent("input")},this.onSelect=function(){this.positionBlinkerAndSelection(),this.focus&&this.blinker.replayTween()};var B=this;this.onKeydown=function(fe){this.deleteKey=fe.code=="Backspace"||fe.code=="Delete",this.blinker.replayTween(),setTimeout(function(){let se=new CustomEvent("keydown",{detail:fe.keyCode});B.positionBlinkerAndSelection.call(B),B.dispatchEvent(se)},10)},this.onMousedown=function(fe){var se=this.text.length,Q=this.eventPositionGlobalToLocal(fe);this.focus||(this.hiddenInput.focus(),(o=="number"||o=="email")&&(this.hiddenInput.type="text"));var te=this.mapPointToIndex(Q);I?this.hiddenInput.setSelectionRange(se-te,se-te):this.hiddenInput.setSelectionRange(te,te),this.positionBlinkerAndSelection()},this.onPressmove=function(fe){var se=this.text.length;this.focus||this.hiddenInput.focus();var Q=this.eventPositionGlobalToLocal(fe),te;I?te=se-this.mapPointToIndex(Q):te=this.mapPointToIndex(Q),this.hiddenInput.selectionStart===this.hiddenInput.selectionEnd?this.hiddenInput.selectionStart<=te?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,te,I?"backward":"forward"):this.hiddenInput.setSelectionRange(te,this.hiddenInput.selectionEnd,I?"forward":"backward"):this.hiddenInput.selectionDirection===(I?"backward":"forward")?this.hiddenInput.setSelectionRange(this.hiddenInput.selectionStart,te,I?"backward":"forward"):this.hiddenInput.setSelectionRange(te,this.hiddenInput.selectionEnd,I?"forward":"backward"),this.positionBlinkerAndSelection()},this.onDblclick=function(){this.hiddenInput.select(),this.positionBlinkerAndSelection()},this.positionBlinkerAndSelection=function(){var fe=this.text.length;if(this.focus){var se=this.backing||this.background?this.paddingH:0,Q=this.backing||this.background?this.paddingV:0;if(this.hiddenInput.selectionStart!==this.hiddenInput.selectionEnd){var te,le;I?(te=this.textWidthArray[fe-this.hiddenInput.selectionStart],le=this.textWidthArray[fe-this.hiddenInput.selectionEnd],this.selection.widthOnly=le-te,this.selection.pos(le+se-1+K,Q+ne)):(te=this.textWidthArray[this.hiddenInput.selectionStart],le=this.textWidthArray[this.hiddenInput.selectionEnd],this.selection.widthOnly=le-te,this.selection.pos(te+se-1+K,Q+ne)),this.selection.heightOnly=this.textHeight,this.selection.alp(this.selectionAlpha)}else this.selection.alp(0);this.blinker.heightOnly=this.textHeight;var Ae=this.hiddenInput.selectionDirection==="backward"?this.hiddenInput.selectionStart:this.hiddenInput.selectionEnd;Ae||(Ae=0),I&&(Ae=fe-Ae),this.blinker.pos(this.textWidthArray[Ae]+se-1+(E=="right"&&this.text==""?this.width:E=="center"&&this.text==""?this.width/2:0)+K,Q+ne),this.dispatchEvent("blinker")}this.stage&&this.stage.update()},this.eventPositionGlobalToLocal=function(fe){var se=this.globalToLocal(fe.stageX/t.scaX,fe.stageY/t.scaY);return E=="right"?se.x-=this.label.x-this.width:E=="center"?se.x-=(this.label.x-this.width)/2:se.x-=this.label.x,se.y-=this.label.y,se},this.mapPointToIndex=function(fe){for(var se=this.textWidthArray.length-1,Q=0;Q<this.textWidthArray.length-1;Q++){var te=(this.textWidthArray[Q]+this.textWidthArray[Q+1])/2;if(fe.x<=te){se=Q;break}}return se},this.measureText=function(){var fe=this.label.clone(),se=this.text;I&&(se=se.split("").reverse().join(""));for(var Q=0;Q<se.length&&Q<this.previousMeasuredText.length&&se[Q]===this.previousMeasuredText[Q];)Q++;for(this.textWidthArray=this.textWidthArray.slice(0,Q+1),Q++;Q<=se.length;Q++)fe.text=se.slice(0,Q),this.textWidthArray.push(fe.getMeasuredWidth());this.previousMeasuredText=se,this.textHeight=fe.getMeasuredLineHeight()},this.setText=function(fe){N&&(fe=fe.toUpperCase()),this.hiddenInput.value=fe,this.onInput()},Object.defineProperty(this,"focus",{get:function(){return document.activeElement===B.hiddenInput},set:function(fe){fe===!0?B.hiddenInput.focus():B.hiddenInput.blur()}});var F;this.added(function(fe){F=fe.frame,B.hiddenInput.addEventListener("focus",B.onFocus.bind(B)),B.hiddenInput.addEventListener("blur",B.onBlur.bind(B))}),this.hiddenInput.addEventListener("input",this.onInput.bind(this)),this.hiddenInput.addEventListener("select",this.onSelect.bind(this)),this.hiddenInput.addEventListener("keydown",this.onKeydown.bind(this)),document.body.appendChild(this.hiddenInput),this.on("mousedown",this.onMousedown.bind(this)),this.on("pressmove",this.onPressmove.bind(this)),this.on("dblclick",this.onDblclick.bind(this)),this.cur("text"),this.blinker=new t.Rectangle({width:2,height:1,color:f,style:!1}).animate({obj:{alpha:0},wait:u,time:.1,rewind:!0,rewindWait:u,loop:!0,loopWait:u}).pauseAnimate(!0).alp(0).addTo(this),this.selection=new t.Rectangle({width:1,height:1,color:a,style:!1}).alp(0).addTo(this),this.textWidthArray=[0],this.previousMeasuredText="",this.textHeight=null,this.measureText()},t.extend(t.TextInput.LabelInput,t.Label,null,"zimLabel",!1),t.List=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue,ge,ie,xe,Se,z,pe,de,oe,Be,$,Me,be,me,re,ke,Re,Ye,$e,it,Le,Ze,ze){var ve="width, height, list, viewNum, vertical, currentSelected, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, spacing, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, downColor, selectedColor, selectedRollColor, borderColor, borderWidth, padding, corner, swipe, scrollBarActive, scrollBarDrag, scrollBarColor, scrollBarAlpha, scrollBarFade, scrollBarH, scrollBarV, scrollBarOverlay, slide, slideFactor, slideSnap, slideSnapDamp, shadowColor, shadowBlur, paddingH, paddingV, scrollWheel, damp, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, draggable, boundary, onTop, close, closeColor, collapse, collapseColor, collapsed, excludeCustomTap, organizer, checkBox, pulldown, clone, cancelCurrentDrag, selectedIndex, noScale, pulldownToggle, optimize, keyEnabled, resizeHandle, resizeBoundary, resizeVisible, continuous, style, group, inherit",Pe;if(Pe=st(t.List,arguments,ve,this))return Pe;De("60.5"),this.group=Ze;var ae=Le===!1?{}:t.getStyle("List",this.group,ze);n(e)&&(e=ae.width!=null?ae.width:300);var Ne=r;n(r)&&(r=ae.height!=null?ae.height:n(pe)?200:200+pe.height),n(i)&&(i=i=ae.list!=null?ae.list:["Option 1","Option 2","Option 3","Option 4","Option 5","Option 6","Option 7","Option 8","Option 9","Option 10"]),i.length==0&&(i=["%-&"]),this.originalList=i,n(l)&&(l=ae.viewNum!=null?ae.viewNum:5),n(a)&&(a=ae.vertical!=null?ae.vertical:!0),n(s)&&(s=ae.currentSelected!=null?ae.currentSelected:!0);var Ke=!n(f)||!n(y);n(de)&&(de=ae.checkBox!=null?ae.checkBox:!1),n(f)&&(f=ae.align!=null?ae.align:de?"left":"center"),n(u)&&(u=ae.valign!=null?ae.valign:"center"),n(y)&&(y=ae.labelAlign!=null?ae.labelAlign:f),n(k)&&(k=ae.labelValign!=null?ae.labelValign:u),n(E)&&(E=ae.indent!=null?ae.indent:de?0:10),n(g)&&(g=ae.labelIndent!=null?ae.labelIndent:E),n(O)&&(O=ae.labelIndentH!=null?ae.labelIndentH:g),n(T)&&(T=ae.labelIndentV!=null?ae.labelIndentV:g),n(A)&&(A=ae.spacing!=null?ae.spacing:2),n(w)&&(w=ae.backdropColor!=null?ae.backdropColor:t.dark),n(C)&&(C=ae.backgroundColor!=null?ae.backgroundColor:t.tin),n(d)&&(d=ae.rollBackgroundColor!=null?ae.rollBackgroundColor:t.grey),n(x)&&(x=ae.downBackgroundColor!=null?ae.downBackgroundColor:d),n(P)&&(P=ae.selectedBackgroundColor!=null?ae.selectedBackgroundColor:t.charcoal),n(v)&&(v=ae.selectedRollBackgroundColor!=null?ae.selectedRollBackgroundColor:t.grey),n(b)&&(b=ae.color!=null?ae.color:t.white),n(X)&&(X=ae.rollColor!=null?ae.rollColor:b),n(Y)&&(Y=ae.downColor!=null?ae.downColor:X),n(m)&&(m=ae.selectedColor!=null?ae.selectedColor:b),n(j)&&(j=ae.selectedRollColor!=null?ae.selectedRollColor:X),n(w)&&(w=ae.backdropColor!=null?ae.backdropColor:w);var Xe=S,Qe=_;n(S)&&(S=ae.borderColor!=null?ae.borderColor:t.silver),n(_)&&(_=ae.borderWidth!=null?ae.borderWidth:1),n(R)&&(R=ae.padding!=null?ae.padding:A),n(U)&&(U=ae.corner!=null?ae.corner:0),n(Z)&&(Z=ae.swipe!=null?ae.swipe:!0),n(K)&&(K=ae.scrollBarActive!=null?ae.scrollBarActive:!0),n(ne)&&(ne=ae.scrollBarDrag!=null?ae.scrollBarDrag:!0),n(V)&&(V=ae.scrollBarColor!=null?ae.scrollBarColor:S),n(D)&&(D=ae.scrollBarAlpha!=null?ae.scrollBarAlpha:.3),n(c)&&(c=ae.scrollBarFade!=null?ae.scrollBarFade:!0),n(h)&&(h=ae.scrollBarH!=null?ae.scrollBarH:!a),n(o)&&(o=ae.scrollBarV!=null?ae.scrollBarV:a),ne&&(c=ae.scrollBarFade!=null?ae.scrollBarFade:!1),n(I)&&(I=ae.scrollBarOverlay!=null?ae.scrollBarOverlay:!0),n(N)&&(N=ae.slide!=null?ae.slide:!0),n(p)&&(p=ae.slideFactor!=null?ae.slideFactor:.95),n(L)&&(L=ae.slideSnap!=null?ae.slideSnap:a?"vertical":"horizontal"),n(B)&&(B=ae.shadowColor!=null?ae.shadowColor:"rgba(0,0,0,.3)"),n(F)&&(F=ae.shadowBlur!=null?ae.shadowBlur:20),n(se)&&(se=ae.paddingV!=null?ae.paddingV:R),n(fe)&&(fe=ae.paddingH!=null?ae.paddingH:R),n(Q)&&(Q=ae.scrollWheel!=null?ae.scrollWheel:!0),n(le)&&(le=ae.titleBar!=null?ae.titleBar:null),n(Ae)&&(Ae=ae.titleBarColor!=null?ae.titleBarColor:null),n(J)&&(J=ae.titleBarBackgroundColor!=null?ae.titleBarBackgroundColor:null),n(Te)&&(Te=ae.titleBarHeight!=null?ae.titleBarHeight:35),n(G)&&(G=ae.draggable!=null?ae.draggable:null),n(ce)&&(ce=ae.boundary!=null?ae.boundary:null),n(q)&&(q=ae.onTop!=null?ae.onTop:null),n(ue)&&(ue=ae.close!=null?ae.close:null),n(ge)&&(ge=ae.closeColor!=null?ae.closeColor:null),n(ie)&&(ie=ae.collapse!=null?ae.collapse:null),n(xe)&&(xe=ae.collapseColor!=null?ae.collapseColor:null),n(z)&&(z=ae.excludeCustomTap!=null?ae.excludeCustomTap:!1),n(de)&&(de=ae.checkBox!=null?ae.checkBox:!1),n(oe)&&(oe=ae.pulldown!=null?ae.pulldown:!1),n(me)&&(me=ae.pulldownToggle!=null?ae.pulldownToggle:!1),n(be)&&(be=ae.noScale!=null?ae.noScale:!1),n(Be)&&(Be=ae.clone!=null?ae.clone:!1),n(re)&&(re=ae.optimize!=null?ae.optimize:!0),n(ke)&&(ke=ae.keyEnabled!=null?ae.keyEnabled:null),n(Re)&&(Re=ae.resizeHandle!=null?ae.resizeHandle:null),n(Ye)&&(Ye=ae.resizeBoundary!=null?ae.resizeBoundary:null),n($e)&&($e=ae.resizeVisible!=null?ae.resizeVisible:!1),n(it)&&(it=ae.continuous!=null?ae.continuous:!1),le===!1&&(le=null),this.vertical=a;var he=this,Ge=r;ee.DIR&&ee.DIR=="rtl"||!ee.DIR&&t.DIR=="rtl"?f=="start"?f="right":f=="end"&&(f="left"):f=="start"?f="left":f=="end"&&(f="right");var Ie;it?(he.continuous=!0,Ie=t.copy(i),t.loop(i.length,function(He){i[He].clone?Ie.push(i[He].clone()):Ie.push(i[He])})):Ie=i,de&&t.loop(Ie,function(He,yt){Ie[yt]!="%-&"&&(Ie[yt]=t.List.checkItem(He,null,e,"left",10,10,A,b,X,m,j,C,d,P,v))});var _e=Tt(),Je;if(Ie.constructor=={}.constructor){var Oe=n(Ie.shade)?n(ae.shade)?.2:ae.shade:Ie.shade,Ve=n(Ie.dim)?n(ae.dim)?.1:ae.dim:Ie.dim,rt=n(Ie.shift)?n(ae.shift)?15:ae.shift:Ie.shift,Ce=n(Ie.bloom)?n(ae.bloom)?!1:ae.bloom:Ie.bloom,We=n(Ie.whither)?n(ae.whither)?!1:ae.whither:Ie.whither,lt=n(Ie.open)?n(ae.open)?!1:ae.open:Ie.open,Ue=n(Ie.expander)?n(ae.expander)?"plus":ae.expander:Ie.expander;Ue=Ue.toLowerCase(),Ue=="arrows"&&(Ue="arrow"),Ue!="none"&&Ue!="arrow"&&(Ue="plus"),Ce===!0&&(Ce=_e=="s"?.01:10),We===!0&&(We=_e=="s"?.01:10),Pt(Ce),Pt(We),rt===!0&&(rt=15),Oe===!0&&(Oe=.2),Ve===!0&&(Ve=.1);var ct=n(Ie.subStyles)?n(ae.subStyles)?{}:ae.subStyles:Ie.subStyles;n(Ie.menu)||(Ie=Ie.menu),Je=he.tree=new t.Hierarchy(Ie),Ie=Je.getLinearList(),Ke||(f=y="left")}oe&&(l=n(Je)?Ie.length:Je.length,n(Ne)&&(r=l*e/620*100+(l+1)*A+(n(le)?0:Te)),_=0,P=C,w=t.clear,Z=!1);var ot=0,dt=0;t.loop(Ie,function(He){He.type=="ListItem"&&(He.width=e-A*2),be&&(He.width&&(ot+=He.width),He.height&&(dt+=He.height))}),ot&&(ot+=A*(Ie.length-1)),dt&&(dt+=A*(Ie.length-1)),this.align=f,this.valign=u,this.indent=E,n(pe)||(r=r-pe.height,pe.list=he,he.organizer=pe,pe.setButtons(),Te+=pe.height),it&&(K=!1),this.zimWindow_constructor(e,r,null,w,S,_,R,U,Z,K,ne,V,D,c,h,o,N,p,L,we,!0,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue,ge,$,!1,null,Re,ie,xe,Se,re,Ye,$e,it?a?"vertical":"horizontal":null,Le,Ze,t.copy(ae)),this.type="List",n(le)||(this.titleBarLabel.pos(null,Te-30,null,!0),n(Te)&&(Te=30),r=r-Te),n(pe)||pe.addTo(he).loc(0,-pe.height),ot&&be?(he.itemWidth=a?e-(K?I?0:6:0):ot/Ie.length,he.itemHeight=a?dt/Ie.length:r-(K?I?0:6:0)):(he.itemWidth=a?e-(K?I?0:6:0):e/l,he.itemHeight=a?r/l:r-(K?I?0:6:0));var et,St=t.copy(ae);delete St.borderWidth,delete St.borderColor;function ht(He){et=he.tabs=new t.Tabs({width:a?he.itemWidth:he.itemWidth*Ie.length,height:a?he.itemHeight*Ie.length:he.itemHeight,tabs:He,spacing:A,vertical:a,backgroundColor:C,rollBackgroundColor:d,downBackgroundColor:x,selectedBackgroundColor:P,selectedRollBackgroundColor:v,color:b,rollColor:X,downColor:Y,selectedColor:m,selectedRollColor:j,backdropColor:w,currentEnabled:!0,currentSelected:s,align:f,valign:u,labelAlign:y,labelValign:k,labelIndent:g,labelIndentH:O,labelIndentV:T,indent:E,useTap:!0,excludeCustomTap:z,keyWrap:!1,keyEnabled:ke,style:Le,group:Ze,inherit:St}).siz(a?e-fe*2:null,a?null:r-se*2).mov(a?0:fe,a?se:0),he.add(et),t.loop(et.labels,function(yt){yt&&(yt.backgroundColor=t.clear)})}ht(t.copy(Ie,Be)),it&&he.on("scrolling",function(){var He=he.tabs.localToLocal(0,0,he);a&&(He.y>=-he.tabs.buttons[0].height&&(he.tabs.y-=he.tabs.height/2+A/2),He.y-he.tabs.buttons[he.tabs.buttons.length-1].height<=r-he.tabs.height&&(he.tabs.y+=he.tabs.height/2+A/2))});function gt(He,yt,Mt){He.listZID=yt,He.label&&(Oe&&new t.Rectangle(rt*(Mt.level+1),He.height).alp(Oe).pos(0,0,he.align=="right",!1,He),Ve&&new t.Rectangle(He.width,He.height).alp((Mt.level+1)*Ve).addTo(He).bot().ord(1),rt&&he.align!="center"&&(He.label.x+=(he.align=="right"?-1:1)*rt*(Mt.level+1)));var Xt=Je.getData(yt);Xt.obj=He,Xt.list&&!t.isEmpty(Xt.list)&&(He.expander=new t.Label({size:Ue=="arrow"?22:36,text:Xt.open?Ue=="arrow"?"\u25B2":"-":Ue=="arrow"?"\u25BC":"+",align:"center",color:t.convertColor(b,"rgba",.6)}).center(He).alp(Ue=="none"?0:.7).pos(15,null,he.align!="right").mov(0,Xt.open?-3:0))}function Bt(){if(!(!he.selected||!he.selected.expander)){var He=Je.getData(he.selected.listZID),yt;if(He.open){he.selected.expander&&(he.selected.expander.text=Ue=="arrow"?"\u25BC":"+",he.selected.expander.mov(0,3)),He.open=!1;var Mt=Je.getNextSibling(he.selected.listZID),Xt;n(Mt)?Xt=he.items.length-1:Xt=t.loop(he.items,function(Kt,fn){if(Kt.listZID==Mt)return fn-1}),We?(yt=0,he.enabled=!1,t.interval(We,function(Kt){he.removeAt(1,he.selectedIndex+Xt-he.selectedIndex-yt),yt++,Kt.total==Kt.count+1&&(he.enabled=!0,he.dispatchEvent("collapsed"))},Xt-he.selectedIndex,!0)):(he.removeAt(Xt-he.selectedIndex,he.selectedIndex+1),he.dispatchEvent("collapsed"))}else{He.open=!0,he.selected.expander&&(he.selected.expander.text=Ue=="arrow"?"\u25B2":"-",he.selected.expander.mov(0,-3));var Yt=Je.getLinearList(He.list),ft=Je.getLinearIDs(He.list),bt;if(He.opened)Array.isArray(Yt)&&(Ce?(yt=0,he.enabled=!1,t.interval(Ce,function(Kt){he.addAt(Yt[yt],he.selectedIndex+1+yt),bt=new Fe.Event("bloom"),bt.item=Yt[yt],he.dispatchEvent(bt),Kt.total==Kt.count+1&&(he.enabled=!0,bt=new Fe.Event("expanded"),bt.items=Yt,he.dispatchEvent(bt)),yt++},Yt.length,!0)):(he.addAt(Yt,he.selectedIndex+1),bt=new Fe.Event("expanded"),bt.items=Yt,he.dispatchEvent(bt)));else{He.opened=!0;var Gt=ct[He.level];n(Gt)&&(Gt={}),Array.isArray(Yt)&&(Ce?(yt=0,he.enabled=!1,t.interval(Ce,function(Kt){he.addAt(Yt[yt],he.selectedIndex+1+yt,{backgroundColor:Gt.backgroundColor,color:Gt.color,rollBackgroundColor:Gt.rollBackgroundColor,rollColor:Gt.rollColor,selectedBackgroundColor:Gt.selectedBackgroundColor,selectedColor:Gt.selectedColor,selectedRollBackgroundColor:Gt.selectedRollBackgroundColor,selectedRollColor:Gt.selectedRollColor});var fn=ft[yt],Jt=he.items[he.selectedIndex+1+yt];Gt.borderColor&&(Jt.borderColor=Gt.borderColor),gt(Jt,fn,He),Jt.label&&(Jt.label.backgroundColor=t.clear),bt=new Fe.Event("bloom"),bt.item=Jt,he.dispatchEvent(bt),Kt.total==Kt.count+1&&(he.enabled=!0,bt=new Fe.Event("expanded"),bt.items=Yt,he.dispatchEvent(bt)),yt++,he.stage&&he.stage.update()},Yt.length,!0)):(he.addAt(Yt,he.selectedIndex+1,{backgroundColor:Gt.backgroundColor,color:Gt.color,rollBackgroundColor:Gt.rollBackgroundColor,rollColor:Gt.rollColor,selectedBackgroundColor:Gt.selectedBackgroundColor,selectedColor:Gt.selectedColor,selectedRollBackgroundColor:Gt.selectedRollBackgroundColor,selectedRollColor:Gt.selectedRollColor}),t.loop(ft,function(Kt,fn){var Jt=he.items[he.selectedIndex+1+fn];gt(Jt,Kt,He),Jt.label&&(Jt.label.backgroundColor=t.clear)}),bt=new Fe.Event("expanded"),bt.items=Yt,he.dispatchEvent(bt)))}}}}he.expandList=function(He){return he.selectedIndex=He,he.selected&&Bt(),he.selected};var Dt;if(Je){me&&he.added(function(He){Dt=He,he.stageToggleEvent=Dt.on("stagemousedown",function(){var yt=Dt.getObjectUnderPoint(Dt.frame.mouseX,Dt.frame.mouseY);if(!(yt&&he.contains(yt))&&!(!he.enabled||!he.selected)){var Mt=Je.getData(he.selected.listZID);Mt.open&&Bt()}})});var Ht=Je.getLinearIDs();t.loop(Ht,function(He,yt){he.tabs.buttons[yt].listZID=He}),t.loop(he.tabs.buttons,function(He){var yt=Je.getData(He.listZID);t.isEmpty(yt.list)||(He.expander=new t.Label({size:Ue=="arrow"?22:36,text:Ue=="arrow"?"\u25BC":"+",align:"center",color:t.convertColor(b,"rgba",.6)}).center(He).alp(Ue=="none"?0:.7).pos(15,null,he.align!="right"))});var nn=lt;he.toggle=function(He){if(n(He))He=!nn;else if(He==nn)return;he.selectedIndex=0,nn=He,Bt()},Object.defineProperty(he,"toggled",{get:function(){return nn},set:function(He){nn!=He&&he.toggle()}}),he.tap(Bt)}var en;et.tap(function(He){He.target.selectedIndex!=he.selectedIndex&&(he.selectedIndex=et.selectedIndex,he.dispatchEvent("change"),me&&(he.selectedIndex=0),He.preventDefault())}),et.on("keychange",function(He){if(He.target.selectedIndex!=he.selectedIndex){he.selectedIndex=et.selectedIndex;var yt;setTimeout(function(){a?(yt=he.selected.y+he.scrollY,(yt<0||yt>he.height-he.selected.height)&&he.animateTo(he.selectedIndex,_e=="ms"?100:.1)):(yt=he.selected.x+he.scrollX,(yt<0||yt>he.width-he.selected.width)&&he.animateTo(he.selectedIndex,_e=="ms"?100:.1))},100),he.dispatchEvent("change")}}),this.getItemIndex=function(He){return he.items.indexOf(He)},this.animateTo=function(He,yt){n(He)&&(He=0),n(yt)&&(yt=.05);var Mt=Tt(yt);he.selectedIndex=He;var Xt=kt(He),Yt;return a?(Yt=Math.abs(he.scrollY-Xt)/he.itemHeight,he.animate({scrollY:Xt},Yt*yt/(Mt=="s"?1:1e3))):(Yt=Math.abs(he.scrollX-Xt)/he.itemWidth,he.animate({scrollX:Xt},Yt*yt/(Mt=="s"?1:1e3))),he},this.addAt=function(He,yt,Mt,Xt){if(n(He))return he;if(he.tabs.loop(function(ft){ft.visible=!0}),He.type=="ListItem"?He.width=e-A*2:Array.isArray(He)&&t.loop(He,function(ft){ft.type=="ListItem"&&(ft.width=e-A*2)}),Xt)if(Array.isArray(He)){var Yt=[];t.loop(He,function(ft){ft.clone?Yt.push(He.clone()):Yt.push(t.copy(He,Xt))}),he.tabs.addAt(Yt,yt,Mt)}else He.clone?he.tabs.addAt(He.clone(),yt,Mt):he.tabs.addAt(t.copy(He,Xt),yt,Mt);else de&&(Array.isArray(He)||(He=[He]),t.loop(He,function(ft,bt){typeof ft=="string"&&(He[bt]=t.List.checkItem(ft,null,e,"left",10,10,A,b,X,m,j,C,d,P,v))})),he.tabs.addAt(He,yt,Mt);return he.update(),he},this.removeAt=function(He,yt){it&&he.tabs.removeAt(He,yt+i.length),he.tabs.removeAt(He,yt),he.tabs.loop(function(Xt){Xt.visible=!0}),en=he.tabs.selectedIndex;var Mt=et.getBounds();return et.setBounds(0,0,Mt.width,Mt.height),Mt.height<r&&(he.scrollY=0),he.update(),he},Ie[0]=="%-&"&&Ie.length==1&&he.removeAt(1,0),this.clear=function(){return he.tabs.removeAt(he.length,0),he.contentContainer.x=0,he.contentContainer.y=0,he.update(),he},this.setCheck=function(He,yt){n(He)&&(He=0),n(yt)&&(yt=!0),he.items[He].checkBox.checked=yt,he.items[He].content.zimOut()},this.getCheck=function(He){return n(He)&&(He=0),he.items[He].checkBox.checked},this.setChecks=function(He){return t.loop(he.items,function(yt){yt.checkBox.checked=He,yt.content.zimOut()}),he},Object.defineProperty(he,"items",{get:function(){return he.tabs.buttons},set:function(){vt&&tt("List() - items is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(he,"list",{get:function(){return he.tabs.buttons},set:function(){vt&&tt("List() - list is read only - use addAt() and removeAt() to change")}}),Object.defineProperty(he,"length",{get:function(){return he.tabs.buttons.length},set:function(){vt&&tt("List() - length is read only")}}),Object.defineProperty(he,"selectedIndex",{get:function(){return it?(en+i.length)%i.length:en},set:function(He){et.selectedIndex=He,he.label=et.label,he.selected=et.selected,en=He,!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&he.stage&&he.stage.update()}}),s&&(he.selectedIndex=0),Object.defineProperty(he,"selectedIndexPlusPosition",{get:function(){return it?(en+i.length)%i.length:en},set:function(He){he.selectedIndex=He,en=He,a?he.scrollY=kt(He)-2:he.scrollX=kt(He),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&he.stage&&he.stage.update()}});function kt(He){if(a){var yt=-(he.itemHeight+A)*He+r/2-he.itemHeight/2;return(he.itemHeight+A)*he.length<r&&(yt=0),yt>0&&(yt=0),(he.itemHeight+A)*he.length>r&&yt<-he.tabs.height+r-se*2&&(yt=-he.tabs.height+r-se*2),yt}else{var Mt=-(he.itemWidth+A)*He+e/2-he.itemWidth/2;return(he.itemWidth+A)*he.length<e&&(Mt=0),Mt>0&&(Mt=0),(he.itemWidth+A)*he.length>e&&Mt<-he.tabs.width+e-fe*2&&(Mt=-he.tabs.width+e-fe*2),Mt}}Object.defineProperty(he,"text",{get:function(){return he.label?he.label.text:null},set:function(He){he.label&&(he.label.text=He)}}),Object.defineProperty(he,"bloom",{get:function(){return Ce},set:function(He){Ce=He}}),Object.defineProperty(he,"currentValue",{get:function(){return he.label?he.label.text:null},set:function(He){var yt=t.loop(he.list,function(Mt,Xt){var Yt;Mt.label&&(Yt=Mt.label.text),Mt.type=="Label"&&(Yt=Mt.text);var ft=new RegExp(He,"i");if(Yt&&Yt.match(ft))return Xt});yt!==!0&&(he.selectedIndexPlusPosition=yt)}}),Object.defineProperty(he,"itemDown",{get:function(){return he.tabs.buttonDown},set:function(){}}),Object.defineProperty(he,"itemsText",{get:function(){for(var He=[],yt=0;yt<he.tabs.buttons.length;yt++){var Mt=he.tabs.buttons[yt].label;Mt&&!n(Mt.text)?He.push(Mt.text):He.push(null)}return He},set:function(){vt&&tt("List() - itemsText is read only")}}),s&&(he.selectedIndex=0),Object.defineProperty(he,"checkBoxes",{get:function(){for(var He=[],yt=0;yt<he.tabs.buttons.length;yt++){var Mt=he.tabs.buttons[yt].checkBox;He.push(Mt)}return He},set:function(){vt&&tt("List() - checkBoxes is read only")}}),Object.defineProperty(he,"accordionIndex",{get:function(){var He=he.selected.listZID;return He?Number(He.split("id")[1]):null},set:function(){vt&&tt("List() - accordionIndex is read only")}}),this.last=function(){return this.selectedIndexPlusPosition=this.length-1,this},this.first=function(){return this.selectedIndexPlusPosition=0,this},this.openAtLevel=function(He){if(!n(He)){var yt=[];t.loop(He,function(Xt){yt.push(Xt)});var Mt=he.bloom;he.bloom=!1,t.interval(.01,function(Xt){var Yt=he.items[Xt.count];Yt?yt.indexOf(he.tree.getData(Yt.listZID).level)!=-1&&he.expandList(Xt.count):(Xt.clear(),he.bloom=Mt)},null,!0,!1,"s")}};var Qt;this.openAtNum=function(He){if(!n(He)){if(!Qt){let Kt=function(fn,Jt){for(yt in fn)Qt[yt]=Jt,Kt(fn[yt].list,yt)};var yt;Qt={},Kt(he.tree.data);var Mt={};for(var Xt in Qt){Mt[Xt]||(Mt[Xt]=[]);for(var Yt=Qt[Xt];Yt;)Mt[Xt].unshift(Yt),Yt=Qt[Yt];Mt[Xt].push(Xt)}}var ft="id"+He,bt=Mt[ft],Gt=he.bloom;he.bloom=!1,ki(.01,function(Kt){var fn=he.items[Kt.count];fn?bt.indexOf(fn.listZID)!=-1&&he.expandList(Kt.count):(Kt.clear(),he.bloom=Gt)},null,!0,!1,"s")}},lt&&Bt&&he.openAtLevel(1e4),n(Me)&&(Me=ae.selectedIndex!=null?ae.selectedIndex:0),he.selectedIndex=Me,Le!==!1&&t.styleTransforms(this,ae),this.clone=function(){return he.cloneProps(new t.List(e,Ge,t.copy(he.originalList,!0),l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,Xe,Qe,R,t.copy(U),Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue,ge,ie,xe,Se,z,pe,de,oe,Be,$,Me,be,me,re,ke,Re,Ye,$e,it,Le,this.group,ze))},this.dispose=function(He,yt,Mt){return Mt||(he.stageToggleEvent&&Dt.off("stagemousedown",he.stageToggleEvent),he.organizer&&he.organizer.dispose(),this.zimWindow_dispose()),!0}},t.extend(t.List,t.Window,["clone","dispose"],"zimWindow",!1),t.List.makeBase=function(e,r,i,l){n(l)&&(l=t.dark),e.backing=new t.Rectangle(e.width,e.height,l).center(e),r.type=="Label"?e.label=r:e.label=new t.Label(r,null,null,t.white),e.text=e.label.text,e.label.center(e).loc(i)},t.List.slider=function(e,r,i,l,a,s,f,u,y,k,g,O,T){var E="label, min, max, val, call, step, obj, property, paddingLeft, paddingRight, factor, offset, backgroundColor",A;if(A=st(t.List.slider,arguments,E))return A;var C=new t.Container(620,100);return C.type="ListItem",C.listItem="Slider",n(y)&&(y=20),n(k)&&(k=30),n(g)&&(g=1),n(O)&&(O=0),t.List.makeBase(C,e,y,T),C.slider=new t.Slider({inside:!0,barWidth:40,barLength:150,barColor:t.blue,min:r,max:i,step:s}).sca(1.5).center(C).mov(20).change(function(){C.stepper.currentValue=O+Math.round(C.slider.currentValue*g*1e3)/1e3,f&&u&&(f[u]=C.slider.currentValue),a&&typeof a=="function"&&a(C.slider.currentValue,C.parent),C.slider.stage&&C.slider.stage.update()}),n(l)||(C.slider.currentValue=l),C.stepper=new t.Stepper({corner:0,arrows:!1,stepperType:"number",min:O+r*g,max:O+i*g,step:s}).center(C).pos(k,null,!0).change(function(){}),n(l)||(C.stepper.currentValue=O+l*g),C},t.List.checkBox=function(e,r,i,l,a,s,f,u){var y="label, checked, call, obj, property, paddingLeft, paddingRight, backgroundColor",k;if(k=st(t.List.checkBox,arguments,y))return k;var g=new t.Container(620,100);return g.type="ListItem",g.listItem="CheckBox",n(s)&&(s=20),n(f)&&(f=30),t.List.makeBase(g,e,s,u),g.checkBox=new t.CheckBox({startChecked:r,label:""}).sca(1.2).center(g).pos(256+f,null,!0).change(function(){l&&a&&(l[a]=g.checkBox.checked),i&&typeof i=="function"&&i(g.checkBox.checked,g.parent),g.checkBox.stage&&g.checkBox.stage.update()}),g},t.List.colorPicker=function(e,r,i,l,a,s,f,u,y){var k="label, color, picker, call, obj, property, paddingLeft, paddingRight, backgroundColor",g;if(g=st(t.List.colorPicker,arguments,k))return g;var O=new t.Container(620,100);return O.type="ListItem",O.listItem="ColorPicker",n(f)&&(f=20),n(u)&&(u=30),t.List.makeBase(O,e,f,y),n(r)&&(r=t.pink),O.colorPicker=i||new t.ColorPicker({alphaPicker:!1,selectedColor:r}),O.swatch=new t.Rectangle(132,66,r,t.lighter,5).center(O).pos(270,null,!0).cur(),O.swatch.on("mousedown",function(){O.colorPicker.selectedColor=O.swatch.color,O.colorPicker.show()}),O.colorLabel=new t.Label(O.swatch.color.toUpperCase(),40,null,t.light).center(O).pos(u,null,!0),O.colorPicker.on("close",function(){var T=O.colorPicker.stage;O.colorPicker.hide(),T&&T.update()}),O.colorPicker.on("change",function(){var T=O.colorPicker.stage;O.swatch.color=O.colorPicker.selectedColor,O.colorLabel.text=O.swatch.color.toUpperCase(),O.colorPicker.hide(),a&&s&&(a[s]=O.colorPicker.selectedColor),l&&typeof l=="function"&&l(O.colorPicker.selectedColor,O.parent),T&&T.update()}),O},t.List.checkItem=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d){var x="label, size, width, align, paddingH, paddingV, spacing, color, rollColor, selectedColor, selectedRollColor, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, group, inherit",P;if(P=st(t.List.checkItem,arguments,x))return P;var v=t.getStyle("CheckBox",C,d);n(r)&&(r=v.size!=null?v.size:20);var w=t.getStyle("List",C,d);n(i)&&(i=300),n(a)&&(a=10),n(s)&&(s=10),n(l)&&(l=w.align!=null?w.align:"center"),n(f)&&(f=w.spacing!=null?w.spacing:2),n(O)&&(O=w.backgroundColor!=null?w.backgroundColor:t.tin),n(T)&&(T=w.rollBackgroundColor!=null?w.rollBackgroundColor:t.grey),n(E)&&(E=w.selectedBackgroundColor!=null?w.selectedBackgroundColor:t.charcoal),n(A)&&(A=w.selectedRollBackgroundColor!=null?w.selectedRollBackgroundColor:t.grey),n(u)&&(u=w.color!=null?w.color:t.white),n(y)&&(y=w.rollColor!=null?w.rollColor:u),n(k)&&(k=w.selectedColor!=null?w.selectedColor:u),n(g)&&(g=w.selectedRollColor!=null?w.selectedRollColor:y);var b=new t.Container;return b.type="CheckItem",b.checkBox=new t.CheckBox({size:r,label:e,color:u,tap:!0}),b.backing=new t.Rectangle(i-f*2,b.checkBox.height+s*2,O).addTo(b),b.checkBox.center(b),l!="center"&&l!="middle"&&b.checkBox.pos(a,null,l=="right"),b.backing.tap(function(){b.checkBox.toggle(),b.zimOut()}),b.checkBox.change(function(){b.zimOut()}),b.zimOver=function(){b.backing.color=b.checkBox.checked?A:T,b.checkBox.label.color=b.checkBox.checked?g:y,b.stage&&b.stage.update()},b.zimOut=function(){b.backing.color=b.checkBox.checked?E:O,b.checkBox.label.color=b.checkBox.checked?k:u,b.stage&&b.stage.update()},b.backing.on("mouseover",b.zimOver),b.checkBox.on("mouseover",b.zimOver),b.backing.on("mouseout",b.zimOut),b.checkBox.on("mouseout",b.zimOut),b},t.Stepper=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I){var N="list, width, backgroundColor, borderColor, borderWidth, label, color, vertical, arrows, corner, shadowColor, shadowBlur, continuous, display, press, hold, holdDelay, holdSpeed, draggable, dragSensitivity, dragRange, stepperType, min, max, step, step2, arrows2, arrows2Scale, keyEnabled, keyArrows, rightForward, downForward, selectedIndex, currentValue, arrowColor, arrowScale, style, group, inherit",p;if(p=st(t.Stepper,arguments,N,this))return p;De("61"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Stepper",this.group=o;var L=h===!1?{}:t.getStyle(this.type,this.group,I);n(e)&&(e=L.list!=null?L.list:[]),n(r)&&(r=L.width!=null?L.width:100),n(i)&&(i=L.backgroundColor!=null?L.backgroundColor:t.white),n(l)&&(l=L.borderColor!=null?L.borderColor:null),n(a)&&(a=L.borderWidth!=null?L.borderWidth:null),l<0||a<0?l=a=null:l!=null&&a==null&&(a=1),n(f)&&(f=L.color!=null?L.color:t.grey),n(s)&&(s=L.label!=null?L.label:""),(typeof s=="string"||typeof s=="number")&&(s=new t.Label({text:s,size:L.size!=null?L.size*2:40,color:f,align:L.align!=null?L.align:"center",valign:L.valign!=null?L.valign:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",padding:"ignore",backgroundColor:"ignore",group:this.group}).loc(0,0)),n(u)&&(u=L.vertical!=null?L.vertical:!1),n(y)&&(y=L.arrows!=null?L.arrows:!0),n(k)&&(k=L.corner!=null?L.corner:16),n(g)&&(g=L.shadowColor!=null?L.shadowColor:"rgba(0,0,0,.3)"),n(O)&&(O=L.shadowBlur!=null?L.shadowBlur:14),n(T)&&(T=L.continuous!=null?L.continuous:!1),n(E)&&(E=L.display!=null?L.display:!0),n(A)&&(A=L.press!=null?L.press:!0),n(C)&&(C=L.hold!=null?L.hold:!0);var we=Tt(d);n(d)&&(d=L.holdDelay!=null?L.holdDelay:we=="s"?.4:400),n(x)&&(x=L.holdSpeed!=null?L.holdSpeed:we=="s"?.2:200),Pt(x,we),n(P)&&(P=L.draggable!=null?L.draggable:!0),(n(v)||v<=0)&&(v=L.dragSensitivity!=null?L.dragSensitivity:.1),n(w)&&(w=L.dragRange!=null?L.dragRange:200),n(b)&&(b=L.stepperType!=null?L.stepperType:e.length>0?"list":"number"),n(X)&&(X=L.min!=null?L.min:0),n(Y)&&(Y=L.max!=null?L.max:10),n(m)&&(m=L.step!=null?L.step:1),n(j)&&(j=L.step2!=null?L.step2:m),n(S)&&j!=m&&b=="number"&&(S=L.arrows2!=null?L.arrows2:!0),n(_)&&(_=L.arrows2Scale!=null?L.arrows2Scale:.5),n(R)&&(R=L.keyEnabled!=null?L.keyEnabled:!0),n(U)&&(U=L.keyArrows!=null?L.keyArrows:!0),n(Z)&&(Z=L.rightForward!=null?L.rightForward:!0),n(K)&&(K=L.downForward!=null?L.downForward:b!="number"),n(D)&&(D=L.arrowColor!=null?L.arrowColor:i),n(c)&&(c=L.arrowScale!=null?L.arrowScale:1);var B=this,F,fe=60,se=fe/4;i=nt(i);var Q=m,te,le=1,Ae;if(b=="number"){if(X=Number(X),Y=Number(Y),isNaN(X)&&(X=0),isNaN(Y)&&(Y=100),Y<X){le=-1;var J=Y;Y=X,X=J,te=Y}else te=X;this.min=X,this.max=Y,0>X&&0<Y&&(te=0),m=Math.abs(m),Ae=Math.max(ce(m),ce(j))}else if(b=="letter"){e="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),typeof X!="string"&&(X="A"),typeof Y!="string"&&(Y="Z"),X=X.substr(0,1).toUpperCase(),Y=Y.substr(0,1).toUpperCase();var Te=e.indexOf(X);Te<0&&(X="A",Te=0);var G=e.indexOf(Y);G<0&&(Y="Z",G=e.length),G<Te&&(e.reverse(),Te=e.length-1-Te,G=e.length-1-G),e=e.splice(Te,G-Te+1)}else b="list";function ce(Xe){var Qe=String(Xe).split(".")[1];return Qe?Qe=Qe.length:Qe=0,Qe}var q,ue=0,ge=0;P&&this.on("mousedown",function(Xe){B.zimAccessibility&&B.zimAccessibility.aria||(this.stage.mouseMoveOutside=!0,ue=Xe.rawX/t.scaX,ge=Xe.rawY/t.scaY,q=this.stage.on("stagemousemove",function(Qe){ue=Qe.rawX/t.scaX,ge=Qe.rawY/t.scaY}))},null,!0),this.label=s,s.mouseChildren=!1,s.mouseEnabled=!1;var ie,xe,Se,z,pe,de,oe,Be,$,Me,be,me,re;if(y&&(Se=this.containerPrev=new t.Container({style:!1}),this.addChild(Se),z=this.arrowPrev=new t.Triangle(fe,fe*.8,fe*.8,D,null,null,null,null,null,null,null,!1).sca(c),g!=-1&&O>0&&(Se.shadow=new Fe.Shadow(g,3,3,O)),Se.addChild(z),Se.expand(),Se.cur("pointer"),Se.on("mousedown",function(Xe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){Q=m;var Qe=u?K?1:-1:Z?-1:1;it(Qe),Ye(Qe,null,null,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),C&&Se.on("pressup",$e),u?(Se.rotation=180,Se.x=r/2,E?Se.y=Se.height+se+fe+Se.height/2+se:Se.y=Se.height*2):(Se.rotation=-90,Se.x=Se.height/2,Se.y=fe/2)),E){var ke=this.textBox=new t.Rectangle(r,fe,i,l,a,k,null,null,null,!1);ke.cur("pointer"),this.addChild(ke),g!=-1&&O>0&&(ke.shadow=new Fe.Shadow(g,3,3,O)),y&&(u?y&&(ke.y=z.height+se):y&&(ke.x=z.height+se)),this.addChild(s),e.length>0&&(F=0,s.text=e[F]),s.center(B);var Re;ke.on("mousedown",function(Xe){B.zimAccessibility&&B.zimAccessibility.aria||(Re=B.currentValue,A&&it(1),Ye(1,!0,null,Xe.stageX/t.scaX,Xe.stageY/t.scaY))}),ke.on("pressup",function(){B.zimAccessibility&&B.zimAccessibility.aria})}else e.length>0&&(F=0);y&&(pe=this.containerNext=new t.Container({style:!1}),this.addChild(pe),de=this.arrowNext=new t.Triangle(fe,fe*.8,fe*.8,D,null,null,null,null,null,null,null,!1).sca(c),g!=-1&&O>0&&(pe.shadow=new Fe.Shadow(g,3,3,O)),pe.addChild(de),pe.expand(),pe.cur("pointer"),pe.on("mousedown",function(Xe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){Q=m;var Qe=u?K?-1:1:Z?1:-1;it(Qe),Ye(Qe,null,null,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),C&&pe.on("pressup",$e),u?(pe.rotation=0,pe.x=r/2,pe.y=pe.getBounds().height/2):(pe.rotation=90,E?pe.x=ke.x+ke.getBounds().width+pe.getBounds().height/2+se:pe.x=Se.x+Se.getBounds().width,pe.y=fe/2));function Ye(Xe,Qe,he,Ge,Ie){if(C){be=Ge,me=Ie,be==0&&(be=1),me==0&&(me=1),P||(v=1);var _e=x*(we=="s"?1e3:1),Je=d*(we=="s"?1e3:1),Oe=_e;re=new t.Proportion(0,w,_e,_e*v),ie=setTimeout(function(){function Ve(){xe=setTimeout(function(){var rt=Xe;if(P){var Ce=Math.abs(ue-be),We=Math.abs(ge-me);u?(!Qe&&!he&&(Ce=0),he&&(We=0)):(!Qe&&!he&&(We=0),he&&(Ce=0)),(Ce>=10||We>=10)&&(Ce>We?(Q=u?j:m,rt=ue-be>0?1:-1,Z||rt*-1,Oe=re.convert(Math.abs(be-ue))):(Q=u?m:j,rt=ge-me>0?1:-1,(b=="number"||!K)&&(rt*=-1),Oe=re.convert(Math.abs(me-ge))))}it(rt),Ve()},Oe)}Ve()},Je)}}C&&E&&ke.on("pressup",$e);function $e(){B.zimAccessibility&&B.zimAccessibility.aria||(clearTimeout(ie),clearTimeout(xe))}S&&(oe=this.prev2=new t.Container({style:!1}),Be=this.arrowPrev2=new t.Triangle(fe,fe*.8,fe*.8,"rgba(0,0,0,.2)",D,2,null,null,null,null,null,!1),oe.addChild(Be),oe.expand(),oe.cur("pointer"),oe.sca(_),oe.alpha=.5,oe.on("mousedown",function(Xe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){Q=j;var Qe=u?Z?-1:1:K?1:-1;it(Qe),Ye(Qe,null,!0,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),C&&oe.on("pressup",$e),$=this.next2=new t.Container({style:!1}),Me=this.arrowNext2=new t.Triangle(fe,fe*.8,fe*.8,"rgba(0,0,0,.2)",D,2,null,null,null,null,null,!1),$.addChild(Me),$.expand(),$.cur("pointer"),$.sca(_),$.alpha=.5,$.on("mousedown",function(Xe){if(!(B.zimAccessibility&&B.zimAccessibility.aria)){Q=j;var Qe=u?Z?1:-1:K?-1:1;it(Qe),Ye(Qe,null,!0,Xe.stageX/t.scaX,Xe.stageY/t.scaY)}}),C&&$.on("pressup",$e),u?(oe.y=this.height/2,oe.x=-oe.width/2-se*Math.max(.2,Math.min(1,_)),oe.rotation=270,$.y=this.height/2,$.x=this.width+$.width/2+se*Math.max(.2,Math.min(1,_)),$.rotation=90):($.x=this.width/2,$.y=-$.height/2-se*Math.max(.2,Math.min(1,_)),$.rotation=0,oe.x=this.width/2,oe.y=this.height+oe.height/2+se*Math.max(.2,Math.min(1,_)),oe.rotation=180),this.addChild(oe,$)),Object.defineProperty(this,"stepperArray",{get:function(){if(b=="number"){e=[];for(var Xe=B.min;Xe<=B.max;Xe+=Math.min(m,j))e.push(Number(t.decimals(Xe,Ae,null,!1)));e.push(Y)}return e},set:function(Xe){e=Xe;var Qe=B.selectedIndex;B.selectedIndex=Qe}}),Object.defineProperty(this,"min",{get:function(){return X},set:function(Xe){if(b=="number"){B.currentValue<Xe&&(B.currentValue=Xe),X=Xe;var Qe=B.selectedIndex;B.selectedIndex=Qe}else X=Xe}}),Object.defineProperty(this,"max",{get:function(){return Y},set:function(Xe){if(b=="number"){B.currentValue>Xe&&(B.currentValue=Xe),Y=Xe;var Qe=B.selectedIndex;B.selectedIndex=Qe}else Y=Xe}}),ze(b=="number"?te:e[F],b=="number"?te:F);function it(Xe){var Qe;if(b=="number"){te=Number(te);var he=te;te+=Number(Q*Xe*le),te=t.decimals(te,Ae),T?te>B.max?te=B.min:te<B.min&&(te=B.max):(te>B.max?(te=m==1?B.max:he,E&&ke.cur("default")):E&&ke.cur("pointer"),te<B.min&&(te=m==1?B.min:he))}else{if(Qe=F+Xe,T)Qe>e.length-1&&(Qe=0),Qe<0&&(Qe=e.length-1);else{if(Qe>e.length-1){E&&ke.cur("default");return}else E&&ke.cur("pointer");if(Qe<0)return}F=Qe}ze(b=="number"?te:e[F],b=="number"?te:F),B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue}Object.defineProperty(this,"selectedIndex",{get:function(){return b=="number"?B.stepperArray.indexOf(B.currentValue):F},set:function(Xe){n(Xe)||(b=="number"?(F=Math.min(B.stepperArray.length-1,Math.max(0,Xe)),te=B.stepperArray[F],ze(te,te)):(Xe=Math.min(e.length-1,Math.max(0,Xe)),F=Xe,ze(e[F],F)))}}),Object.defineProperty(this,"currentValue",{get:function(){return b=="number"?Number(te):e[F]},set:function(Xe){if(!n(Xe))if(b=="number"){if(Xe=Number(Xe),B.max>B.min){if(Xe>B.max||Xe<B.min)return}else if(Xe<B.max||Xe>B.min)return;var Qe=B.stepperArray.indexOf(Xe);if(Qe<0)return;F=Qe,te=Number(B.stepperArray[F]),ze(te,te)}else{if(e.indexOf(Xe)>-1)Xe=e.indexOf(Xe);else return;if(Xe==B.selectedIndex)return;F=Xe,ze(e[F],F)}}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return B.currentValue},set:function(Xe){String(Xe)!=String(B.currentValue)&&(B.currentValue=Xe,B.dispatchEvent("change"))}}),Object.defineProperty(this,"continuous",{get:function(){return T},set:function(Xe){T=Xe,b=="number"?ze(te,te):ze(e[B.selectedIndex],B.selectedIndex)}}),this._enabled=!0,Object.defineProperty(B,"enabled",{get:function(){return B._enabled},set:function(Xe){Ot(B,Xe),Xe?(b=="number"?ze(te,te):ze(e[B.selectedIndex],B.selectedIndex),ee.addEventListener("keydown",B.keyDownEvent)):(ve(),Pe(),ee.removeEventListener("keydown",B.keyDownEvent),E&&(s.mouseChildren=!1),E&&(s.mouseEnabled=!1)),pe&&!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&pe.stage?pe.stage.update():s&&!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&s.stage&&s.stage.update()}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==B},set:function(){t.KEYFOCUS=B}}),t.KEYFOCUS||Le(),this.on("mousedown",function(){Le()});function Le(){B.keyFocus=!0;var Xe=document.activeElement;Xe&&Xe.blur()}function Ze(){Se.alpha=1,z.color=D,Se.cur("pointer"),pe.alpha=1,de.color=D,pe.cur("pointer"),T||(b=="number"?(F==B.min&&(le>0?ve():Pe()),F==B.max&&(le>0?Pe():ve())):(F==0&&(u?Pe():ve()),F==e.length-1&&(u?ve():Pe())))}function ze(Xe,Qe){F=Qe,E&&(b=="number"&&Xe!=0&&Ae>0&&(Xe=t.decimals(Xe,Ae,!0)),s.text=Xe,s.center(B)),y&&Ze(),pe&&!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&pe.stage?pe.stage.update():s&&!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&s.stage&&s.stage.update(),B.zimAccessibility&&B.zimAccessibility.changeTitle(B,null,!0)}function ve(){y&&(Se.alpha=.8,z.color=t.fog,Se.cur("default"))}function Pe(){y&&(pe.alpha=.8,de.color=t.fog,pe.cur("default"))}var ae,Ne=!0,Ke="";this.on("mousedown",function(){Ne=!0,Ke="",!(B.zimAccessibility&&B.zimAccessibility.aria)&&(B.focus=!0,ae=!1)}),this.keyDownEvent=function(Xe){if(B.stage&&(B.zimAccessibility&&B.focus||!B.zimAccessibility&&B.keyFocus)){Xe||(Xe=event);var Qe=Xe.keyCode;if(U&&Qe>=37&&Qe<=40){var he=K?40:38,Ge=Z?39:37,Ie=K?38:40,_e=Z?37:39;Qe==he||Qe==Ge?(u&&Qe==he||!u&&Qe==Ge?Q=m:Q=j,it(1)):(Qe==Ie||Qe==_e)&&(u&&Qe==Ie||!u&&Qe==_e?Q=m:Q=j,it(-1))}if(R)if(b=="number"){var Je=null,Oe=null;if(Qe==8){var Ve=String(Ke).split("");Ve.pop(),Je=Ve.pop(),Ke=Ve.join("")}if(!Xe.shiftKey&&Qe>=48&&Qe<=57?Je=Qe-48:Qe>=96&&Qe<=105?Je=Qe-96:Qe==190?(Ke=String(Ke)+".",Oe=!0):Qe==173||Qe==189?(B.currentValue=B.currentValue*-1,B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue,ae=!ae):Qe==46&&(Ne=!0,Ke=""),n(Je)&&n(Oe)){Ne=!0,Ke="";return}if(n(Je)||(Ne?(Ne=!1,Ke=Je):Ke=Je=+(Ke+""+Je),Je<X||Je>Y))return;B.currentValue=Je,B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue}else Ne=!0,Ke="",B.currentValue=String.fromCharCode(Xe.keyCode),B.currentValue!=Re&&B.dispatchEvent("change"),Re=B.currentValue}},ee.addEventListener("keydown",this.keyDownEvent),this.next=function(){it(1)},this.prev=function(){it(-1)},n(ne)&&(ne=L.selectedIndex!=null?L.selectedIndex:0),B.selectedIndex=ne,n(V)&&(V=L.currentValue!=null?L.currentValue:null),n(V)||(B.currentValue=V),h!==!1&&t.styleTransforms(this,L),this.clone=function(){return B.cloneProps(new t.Stepper(e,r,i,l,a,s.clone(),f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,this.group,I))},this.dispose=function(Xe,Qe,he){return ee.removeEventListener("keydown",B.keyDownEvent),B.removeAllEventListeners(),B.stage&&B.stage.off(q),he||this.zimContainer_dispose(!0),Se=this.containerPrev=z=this.arrowPrev=null,pe=this.containerNext=de=this.arrowNext=null,ke=this.textBox=s=this.label=null,!0}},t["zut"]=function(e){if(!n(e)&&e["key"])t.async("https://zimjs.com/gamdata.php?id="+e["key"]+"&player="+e["player"]+"&score="+e["score"]+"&reverse="+e["info"]["reverse"]+"&total="+e["info"]["total"]+"&allowZero="+e["info"]["allowZero"],e["info"]["type"]);else return!0},t.extend(t.Stepper,t.Container,["clone","dispose"],"zimContainer",!1),t.Slider=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h){var o="min, max, step, button, barLength, barWidth, barColor, vertical, useTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, inside, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, damp, currentValue, expand, expandVertical, expandBar, expandBarVertical, useLabels, labelMargin, labelColor, style, group, inherit",I;if(I=st(t.Slider,arguments,o,this))return I;De("62"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Slider",this.group=c;var N=D===!1?{}:t.getStyle(this.type,this.group,h);if(n(e)&&(e=N.min!=null?N.min:0),n(r)&&(r=N.max!=null?N.max:10),r-e==0){tt("ZIM Slider range must not be 0");return}n(v)&&(v=N.sound!=null?N.sound:!1),n(i)&&(i=N.step!=null?N.step:0),n(l)&&(l=N.button!=null?N.button:v?"aztec":null),l&&l.type=="Button"&&(l=l.clone()),n(a)&&(a=N.barLength!=null?N.barLength:300),n(s)&&(s=N.barWidth!=null?N.barWidth:3),n(f)&&(f=N.barColor!=null?N.barColor:v?t.lighter:t.granite),n(u)&&(u=N.vertical!=null?N.vertical:!!v),n(y)&&(y=N.useTicks!=null?N.useTicks:!!v),n(g)&&(g=N.tickStep!=null?N.tickStep:i||(y||v?(r-e)/40:0)),n(O)&&(O=N.semiTicks!=null?N.semiTicks:g?3:0),n(k)&&(k=N.tickColor!=null?N.tickColor:v?t.tin:f),n(T)&&(T=N.tickScale!=null?N.tickScale:v?1.25:1),n(E)&&(E=N.semiTickScale!=null?N.semiTickScale:1),n(A)&&(A=N.accentSize!=null?N.accentSize:v?10:0),n(C)&&(C=N.accentOffset!=null?N.accentOffset:v?-(A+s)/2:0),n(d)&&(d=N.accentColor!=null?N.accentColor:t.pink),n(x)&&(x=N.accentBackgroundColor!=null?N.accentBackgroundColor:v?t.blue:t.clear),n(P)&&(P=N.accentDifference!=null?N.accentDifference:-.5),n(w)&&(w=N.inside!=null?N.inside:!1),n(b)&&(b=N.keyArrows!=null?N.keyArrows:!0),n(Y)&&(Y=N.keyArrowsH!=null?N.keyArrowsH:!0),n(m)&&(m=N.keyArrowsV!=null?N.keyArrowsV:!0),n(X)&&(X=N.keyArrowsStep!=null?N.keyArrowsStep:(r-e)/100),n(j)&&(j=N.damp!=null?N.damp:!1),n(S)&&(S=N.currentValue!=null?N.currentValue:!1),n(_)&&(_=N.expand!=null?N.expand:t.mobile()?10:null),n(R)&&(R=N.expandVertical!=null?N.expandVertical:_),n(U)&&(U=N.expandBar!=null?N.expandBar:null),n(Z)&&(Z=N.expandBarVertical!=null?N.expandBarVertical:_),n(K)&&(K=N.useLabels!=null?N.useLabels:!1),n(ne)&&(ne=N.labelMargin!=null?N.labelMargin:20),n(V)&&(V=N.labelColor!=null?N.labelColor:t.dark);var p,L=this,we=B(e,r,i,S);this.veeObj={min:we[0],max:we[1],step:we[2],currentValue:we[3]};function B(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i);var F=i;S=t.Pick.choose(S);var fe;A&&(L.accentBacking=new t.Rectangle(a-.25,A+P,x).addTo(this).rot(u?90:0).mov(u?-C-s/2+P/2:.25,u?0:C+s/2-P/2),fe=L.accent=new t.Rectangle(a,A,d).sca(0,1).rot(u?-90:0).mov(u?-C-A-s/2:0,u?a:C+s/2).addTo(this));function se(){fe.sca((L.currentValue-L.min)/Math.abs(L.max-L.min),1)}var Q=!(!n(N.backing)&&N.backing.type!="Pattern");function te(Oe,Ve,rt){var Ce=new t.Shape(Ve,rt);return Ce.f(Oe).s(N.borderColor!=null?N.borderColor:t.tin).ss(N.borderWidth!=null?N.borderWidth:3).mt(2,0).lt(Ve+2,rt*.2).lt(Ve+2,rt*.8).lt(2,rt).cp().centerReg({add:!1}),Ce}if(n(l)||typeof l=="string"){var le=30,Ae=40;u&&(le=50,Ae=40);var J;if(l=="pill"||l=="aztec"||l=="circle"||l=="grip"){if(l=="pill")J={width:u?40:18,height:u?18:40,borderColor:t.tin,borderWidth:3,corner:8};else if(l=="aztec"){le=N.width!=null?N.width:Math.max(le,Ae)*.9,Ae=N.height!=null?N.height:Math.min(le,Ae)*.6;var Te=te(N.backgroundColor!=null?N.backgroundColor:t.lighter,le,Ae).rot(u?0:-90),G=te(N.rollBackgroundColor!=null?N.rollBackgroundColor:t.white,le,Ae).rot(u?0:-90);J={width:le,height:Ae,backing:Te,rollBacking:G},N.borderWidth=0,N.borderColor=0}else l=="circle"&&(le=N.width!=null?N.width:30,Ae=N.height!=null?N.height:30,J={width:le,height:le,corner:N.corner!=null?N.corner:le/2});L.buttonType=l}var ce=N.borderColor!=null?N.borderColor:J?J.borderColor:Q?t.granite:null;if(l=new t.Button({width:N.width!=null?N.width:J?J.width:le,height:N.height!=null?N.height:J?J.height:Ae,label:"",backgroundColor:N.backgroundColor!=null?N.backgroundColor:t.white,rollBackgroundColor:N.rollBackgroundColor!=null?N.rollBackgroundColor:n(N.backgroundColor)||N.backgroundColor==t.white?t.moon:N.backgroundColor.lighten(.2),borderColor:ce,rollBorderColor:N.rollBorderColor!=null?N.rollBorderColor:ce,borderWidth:N.borderWidth!=null?N.borderWidth:J?J.borderWidth:Q?1:null,corner:N.corner!=null?N.corner:J?J.corner:0,backing:N.backing!=null?N.backing.clone():J?J.backing:null,rollBacking:N.rollBacking!=null?N.rollBacking.clone():J?J.rollBacking:null,shadowColor:N.shadowColor!=null?N.shadowColor:null,shadowBlur:N.shadowBlur!=null?N.shadowBlur:null,hitPadding:30,style:!1}),L.buttonType=="circle")l.scaleY=Ae/le,u||l.rot(-90);else if(L.buttonType=="grip"){var q=[1,1,1],ue=.4;t.loop(q,function(Oe,Ve,rt){u?new t.Line(l.width*.62,Oe,l.borderColor?l.borderColor:t.grey).pos(0,l.height*ue/2+(Ve+1)*(l.height*(1-ue))/(rt+1),t.CENTER,t.TOP,l):new t.Line(l.height*.62,Oe,l.borderColor?l.borderColor:t.grey).rot(90).pos(l.width*ue/2+(Ve+1)*(l.width*(1-ue))/(rt+1),0,t.LEFT,t.CENTER,l)})}}l.rollPersist=!0,(!n(_)||!n(R))&&l.expand(_,R);var ge,ie;u?(ge=l.width,w?(ie=a,this.setBounds(0,0,ge,ie)):(ie=a+l.height,this.setBounds(-l.width/2,-l.height/2,ge,ie))):(ie=Math.max(l.height,s),w?(ge=a,this.setBounds(0,0,ge,ie)):(ge=a+l.width,this.setBounds(-l.width/2,-l.height/2,ge,ie)));var xe=e,Se=0;this.button=l,this.cur("pointer");var z,pe,de,oe,Be;if(y){oe=this.ticks=new t.Shape({style:!1}),this.addChild(oe),Be=oe.graphics,Be.ss(1).s(k);var $=Math.round((r-e)/(g||i)),Me=(r-e)/$;g?(Me!=g&&vt&&tt("Slider() - non-divisible step ("+g+") adjusted to "+Me),g=Me):(Me!=i&&vt&&tt("Slider() - non-divisible step ("+i+") adjusted to "+Me),i=Me);var be;w?be=(a-(u?l.height:l.width))/Math.abs($):be=a/Math.abs($)}var me,re,ke,Re,Ye,$e,it;if(u){if(me=w?l.height/2:0,z=this.bar=new t.Rectangle(s,a,f,null,null,null,null,null,null,!1),U?z.expand(U,Z):z.expand(20,0),z.centerReg(this),l.centerReg(this),de=z.getBounds(),pe=new Fe.Rectangle(z.x,de.y+me,0,de.height-me*2),y){for(K&&(re=L.labels=new t.Container().addTo(L)),ke=0;ke<=Math.abs($);ke++)Re=ke%(O+1)==0,Ye=Re?25*T:15*E,$e=me+be*ke,Be.mt(0,$e).lt(Ye,$e),K&&(O&&Re||!O)&&(it=Math.max(t.countDecimals(F),t.countDecimals(e),t.countDecimals(r)),new t.Label({text:t.decimals(r-(r-e)/Math.abs($)*ke,it+1),size:N.size?N.size:10,color:V,align:"left",valign:"center"}).centerReg({add:!1}).reg(0).loc(Ye+ne+2,$e-1,re));oe.x=z.x+15}}else if(me=w?l.width/2:0,z=this.bar=new t.Rectangle(a,s,f,null,null,null,null,null,null,!1),U?z.expand(U,Z):z.expand(0,20),z.centerReg(this),l.centerReg(this),de=z.getBounds(),pe=new Fe.Rectangle(de.x+me,z.y,de.width-me*2,0),y){for(K&&(re=L.labels=new t.Container().addTo(L)),ke=0;ke<=Math.abs($);ke++)Re=ke%(O+1)==0,Ye=me+be*ke,$e=-(Re?25*T:15*E),Be.mt(Ye,0).lt(Ye,$e),K&&(O&&Re||!O)&&(it=Math.max(t.countDecimals(F),t.countDecimals(e),t.countDecimals(r)),new t.Label({text:t.decimals(e+(r-e)/Math.abs($)*ke,it+1),size:N.size?N.size:10,color:V,align:"center",valign:"center"}).centerReg({add:!1}).loc(Ye,$e-ne,re));oe.y=z.y-10}l.x=pe.x,l.y=pe.y;function Le(Oe){return i==0?Oe:Math.round(Oe/i)*i}var Ze,ze;l.on("mousedown",function(Oe){p=Oe.target.stage,L.focus=!0;var Ve=L.globalToLocal(Oe.stageX/t.scaX,Oe.stageY/t.scaY);Ze=Ve.x-l.x,ze=Ve.y-l.y,p&&(p.mouseMoveOutside=!0)}),l.on("pressmove",function(Oe){ve(Oe)});function ve(Oe){var Ve=L.globalToLocal(Oe.stageX/t.scaX,Oe.stageY/t.scaY),rt=Ne(Ve.x-Ze,Ve.y-ze,pe);u?(l.x=rt.x,xe=Le((rt.y-pe.y)/pe.height*(e-r)),l.y=pe.y+xe*pe.height/(e-r),xe+=r,l.y!=Se&&L.dispatchEvent("change"),Se=l.y):(xe=Le((rt.x-pe.x)/pe.width*(r-e)),l.x=pe.x+xe*pe.width/(r-e),xe+=e,l.y=rt.y,l.x!=Se&&L.dispatchEvent("change"),Se=l.x),fe&&se(),ae(),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&L.stage&&L.stage.update()}function Pe(Oe){return Oe>0?1:-1}function ae(){L.zimAccessibility&&L.zimAccessibility.changeTitle(L,null,!0)}function Ne(Oe,Ve,rt){return Oe=Math.max(rt.x,Math.min(rt.x+rt.width,Oe)),Ve=Math.max(rt.y,Math.min(rt.y+rt.height,Ve)),{x:Oe,y:Ve}}z.on("mousedown",function(Oe){p=Oe.target.stage,Ze=0,ze=0,!(L.zimAccessibility&&L.zimAccessibility.aria)&&ve(Oe)});var Ke,Xe;j&&(Ke=e,Xe=new t.Damp(Ke,j),L.ticker=t.Ticker.add(function(){Ke=Xe.convert(xe)})),Object.defineProperty(this,"currentValue",{get:function(){return j?Ke:xe},set:function(Oe){n(Oe)||(e<r?(Oe<e&&(Oe=e),Oe>r&&(Oe=r)):(Oe>e&&(Oe=e),Oe<r&&(Oe=r)),xe=Oe=Le(Oe),Xe&&Xe.immediate(xe),u?(l.y=(Oe-r)/(e-r)*pe.height+me,Se=l.y):(l.x=(Oe-e)/(r-e)*pe.width+me,Se=l.x),fe&&se(),ae(),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&L.stage&&L.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return j?Ke:xe},set:function(Oe){Oe!=L.currentValue&&(L.currentValue=Oe,L.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return e},set:function(){vt&&tt("Slider() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(){vt&&tt("Slider() - max is read only")}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){vt&&tt("Slider() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return Y},set:function(Oe){Y=Oe}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return m},set:function(Oe){m=Oe}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==L},set:function(){t.KEYFOCUS=L}}),b&&!t.KEYFOCUS&&Qe(),this.on("mousedown",function(){b&&Qe()});function Qe(){L.keyFocus=!0;var Oe=document.activeElement;Oe&&Oe.blur()}var he=!1,Ge=!1,Ie=!1,_e=!1;this.keyDownEvent=function(Oe){L.stage&&(L.zimAccessibility&&L.focus||!L.zimAccessibility&&L.keyFocus)&&(Oe.keyCode==37&&Y?he=!0:Oe.keyCode==40&&m?Ge=!0:Oe.keyCode==39&&Y?Ie=!0:Oe.keyCode==38&&m&&(_e=!0),L.keyInterval==null&&(he||Ge||Ie||_e)&&(Je(),L.keyTimeout=setTimeout(function(){L.keyInterval==null&&(he||Ge||Ie||_e)&&(L.keyInterval=setInterval(Je,40))},140)))};function Je(){(he||Ge)&&(i>0?L.currentValueEvent-=i*Pe(r-e):L.currentValueEvent-=X*Pe(r-e)),(Ie||_e)&&(i>0?L.currentValueEvent+=i*Pe(r-e):L.currentValueEvent+=X*Pe(r-e))}ee.addEventListener("keydown",this.keyDownEvent),L.keyUpEvent=function(Oe){Oe.keyCode==37?he=!1:Oe.keyCode==40?Ge=!1:Oe.keyCode==39?Ie=!1:Oe.keyCode==38&&(_e=!1),L.keyInterval!=null&&!he&&!Ge&&!Ie&&!_e&&(clearInterval(L.keyInterval),L.keyInterval=null)},ee.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(L,"enabled",{get:function(){return L._enabled},set:function(Oe){Ot(L,Oe),Oe?(ee.addEventListener("keydown",L.keyDownEvent),ee.addEventListener("keyup",L.keyUpEvent)):(ee.removeEventListener("keydown",L.keyDownEvent),ee.removeEventListener("keyup",L.keyUpEvent))}}),n(S)||(L.currentValue=S),t.setSwipe(this,!1),D!==!1&&t.styleTransforms(this,N),this.clone=function(Oe){return L.cloneProps(new t.Slider(Oe||!t.isPick(we[0])?L.min:we[0],Oe||!t.isPick(we[1])?L.max:we[1],Oe||!t.isPick(we[2])?L.step:we[2],l.clone(),a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,Oe||!t.isPick(we[3])?L.currentValue:we[3],_,R,U,Z,K,ne,V,D,this.group,h))},this.dispose=function(Oe,Ve,rt){return ee.removeEventListener("keydown",L.keyDownEvent),ee.removeEventListener("keyup",L.keyUpEvent),rt||this.zimContainer_dispose(!0),!0}},t.extend(t.Slider,t.Container,["clone","dispose"],"zimContainer",!1),t.Selector=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v){var w="tile, borderColor, borderWidth, backgroundColor, corner, dashed, paddingH, paddingV, speed, diagonal, dim, multi, keyArrows, behind, resizeScale, selectedIndex, liveIndex, style, group, inherit",b;if(b=st(t.Selector,arguments,w,this))return b;De("62.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Selector",this.group=P;var X=x===!1?{}:t.getStyle(this.type,this.group,v),Y=Tt();n(e)&&(e=X.tile!=null?X.tile:new t.Tile(new t.Circle(20,t.red),4,4,10,10)),n(r)&&(r=X.borderColor!=null?X.borderColor:t.white),n(i)&&(i=X.borderWidth!=null?X.borderWidth:2),n(l)&&(l=X.backgroundColor!=null?X.backgroundColor:"rgba(0,0,0,.1)"),n(a)&&(a=X.corner!=null?X.corner:10),n(s)&&(s=X.dashed!=null?X.dashed:!1),n(f)&&(f=X.padding!=null?X.padding:e.spacingH/2),n(u)&&(u=X.paddingV!=null?X.paddingV:e.spacingV/2),n(y)&&(y=X.speed!=null?X.speed:2),n(k)&&(k=X.diagonal!=null?X.diagonal:!1),n(g)&&(g=X.dim!=null?X.dim:!1),n(O)&&(O=X.multi!=null?X.multi:!1),O&&(y=0),n(T)&&(T=X.keyArrows!=null?X.keyArrows:!0),n(E)&&(E=X.behind!=null?X.behind:!1),n(A)&&(A=X.resizeScale!=null?X.resizeScale:!1),n(C)&&(C=X.selectedIndex!=null?X.selectedIndex:null),n(d)&&(d=X.liveIndex!=null?X.liveIndex:!1),this.liveIndex=d;var m=[],j=[];t.loop(e.items.length,function(){m.push(nt(r)),j.push(nt(l))});var S=this;if(!(n(C)&&O)){var _=C,R=n(C)||C<0?0:C,U=e.getChildAt(R);S.currentItem=e.getChildAt(R),C=_,n(C)&&(C=X.selectedIndex!=null?X.selectedIndex:0)}var Z,K,ne;Z=U||e.getChildAt(0),Z&&(K=Z.width+f*2,ne=Z.height+u*2),S.tile=e.addTo(S).cur();var V;if(O){var D=this.selectors=[];t.loop(10,function(){V=new t.Rectangle(K,ne,t.faint,t.faint,i,a,s,{ignoreScale:!A}).centerReg(S,E?0:1),V.visible=!1,D.push(V),V.mouseEnabled=!1}),this.selector=V}else V=this.selector=new t.Rectangle(K,ne,t.faint,t.faint,i,a,s,{ignoreScale:!A}).centerReg(S),V.loc(e.width/2,Z.y+u,S,E?0:1),V.visible=!1;C<0||n(U)||(V.loc(Z.x+f,Z.y+u,S,E?0:1),V.color=j[C],V.borderColor=m[C],V.visible=!0),e.mov(f,u),this.setBounds(e.width+f*2,e.height+u*2);var c={};this.tileDown=e.on("mousedown",function(I){var N=V;if(!(O&&(N=D.shift(),n(N)))){N.visible=!0;for(var p=I.target,L=0;p.parent!=e&&L<10;)p=p.parent,L++;if(p.parent==e&&h(p,null,N),O){var we="id"+Math.abs(I.pointerID+1);c[we]={index:C,item:U,selector:N}}}}),O&&(this.tileMove=e.on("pressmove",function(I){var N="id"+Math.abs(I.pointerID+1),p=c[N];if(!n(p)){var L=e.itemUnderPoint(I.stageX/t.scaX,I.stageY/t.scaY);if(p.item!=L){if(S.upItem=p.item,S.upIndex=p.index,S.downItem=p.item=L,S.downIndex=p.index=L?L.tileNum:null,S.dispatchEvent("change"),n(L))p.selector.visible=!1;else{var we=e.localToLocal(L.x,L.y,S);p.selector.loc(we.x,we.y).siz(L.width+f*2,L.height+u*2),p.selector.color=j[p.index],p.selector.borderColor=m[p.index],p.selector.visible=!0}S.stage.update()}}}),this.tileUp=e.on("pressup",function(I){var N="id"+Math.abs(I.pointerID+1),p=c[N];n(p)||(S.downIndex=S.downItem=null,S.upIndex=p.index,S.upItem=p.item,D.push(p.selector),p.selector.visible=!1,S.dispatchEvent("change"),S.stage&&!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&S.stage.update(),delete c[N])})),S.noAnimate=!1;function h(I,N,p,L){n(p)&&(p=V),U=I,C=I.tileNum,p.color=j[C],p.borderColor=m[C],O&&(S.upItem=S.upIndex=null,S.downItem=U,S.downIndex=C),S.animating=!0;var we=e.localToLocal(I.x,I.y,S),B=Math.abs(we.x-V.x),F=Math.abs(we.y-V.y),fe=S.noAnimate||N?0:y;if(S.noAnimate=!1,fe==0)p.loc(we.x,we.y).siz(I.width+f*2,I.height+u*2),S.animating=!1,S.dispatchEvent("change");else{if(k||(B+F)*fe<=0?p.animate({x:we.x,y:we.y},(F+B)*fe):(p.stopAnimate(),B>=F?p.animate([{props:{x:we.x},time:Math.max(Y=="s"?.1:100,B*fe/(Y=="s"?1e3:1))},{props:{y:we.y},time:Math.max(Y=="s"?.1:100,F*fe/(Y=="s"?1e3:1))}]):p.animate([{props:{y:we.y},time:Math.max(Y=="s"?.1:100,F*fe/(Y=="s"?1e3:1))},{props:{x:we.x},time:Math.max(Y=="s"?.1:100,B*fe/(Y=="s"?1e3:1))}])),p.animate({props:{widthOnly:I.width+f*2,heightOnly:I.height+u*2},time:Math.max(Y=="s"?.2:200,(F+B)*fe/(Y=="s"?1e3:1)),events:S.liveIndex,call:function(){S.animating=!1,L?S.dispatchEvent("changeset"):S.dispatchEvent("change")}}),S.liveIndex){var se=null;p.on("animation",function(){var te=p.parent.localToGlobal(p.x,p.y),le=e.itemUnderPoint(te.x,te.y);le.tileNum!=se&&(C=le.tileNum,L?S.dispatchEvent("changeset"):S.dispatchEvent("change"),se=le.tileNum)})}if(g){if(g===!0)var Q=.7;else Q=t.constrain(g,0,1);e.animate({props:{alpha:Q},rewind:!0,time:(F+B)*y*.7/(Y=="s"?1e3:1)})}}e.stage&&e.stage.update()}T&&S.added(function(){S.keyEvent=S.stage.frame.on("keydown",function(I){if(S.stage&&S.enabled&&!S.animating&&(S.zimAccessibility&&S.focus||!S.zimAccessibility&&S.keyFocus)){var N=t.loop(e.items2D,function(B,F){var fe=t.loop(B,function(se,Q){if(se==U)return[Q,F]});if(Array.isArray(fe))return fe});N===!0&&(N=[0,0]);var p=e.items2D[N[1]].length,L=e.items2D.length,we;I.keyCode=="39"?(we=(N[0]+1)%p,h(e.items2D[N[1]][we],we<N[0])):I.keyCode=="37"?(we=(N[0]-1+p)%p,h(e.items2D[N[1]][we],we>N[0])):I.keyCode=="38"?(we=(N[1]-1+L)%L,h(e.items2D[we][N[0]],we>N[1])):I.keyCode=="40"&&(we=(N[1]+1)%L,h(e.items2D[we][N[0]],we<N[1]))}})}),Object.defineProperty(this,"selectedIndex",{get:function(){return C},set:function(I){n(I)&&(S.currentItem=null),S.currentItem=e.items[Math.round(I)]}}),Object.defineProperty(this,"text",{get:function(){return U.text},set:function(){vt&&tt("Selector() - text is read only")}}),Object.defineProperty(this,"currentItem",{get:function(){return U},set:function(I){if(n(I)){U=null,C=null,V.visible=!1,S.selectedCol=null,S.selectedRow=null;return}V.visible=!0,S.lastItem=U,S.lastIndex=C,S.lastCol=S.selectedCol,S.lastRow=S.selectedRow,S.selectedCol=I.tileCol,S.selectedRow=I.tileRow,C=I.tileNum,U=I,h(U,null,null,!0)}}),this._enabled=!0,Object.defineProperty(S,"enabled",{get:function(){return S._enabled},set:function(I){I?S.mouse():S.noMouse(),S._enabled=I}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==S},set:function(){t.KEYFOCUS=S}}),t.KEYFOCUS||o(),this.on("mousedown",function(){o()});function o(){S.keyFocus=!0;var I=document.activeElement;I&&I.blur()}x!==!1&&t.styleTransforms(this,X),this.clone=function(I){if(I)for(var N=[],p=0;p<S.tile.items.length;p++)N.push(S.tile.items[p].clone(!0));return S.cloneProps(new t.Selector(I?t.series(N):e.clone?e.clone():e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,this.style,this.group))},this.dispose=function(I,N,p){S.keyEvent&&S.stage&&S.stage.frame.off("keydown",S.keyEvent),e.off(S.tileDown),e.dispose(),O&&(e.off(S.tileMove),e.off(S.tileUp)),p||this.zimContainer_dispose(!0)}},t.extend(t.Selector,t.Container,["clone","dispose"],"zimContainer",!1),t.Dial=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L){var we="min, max, step, width, backgroundColor, indicatorColor, indicatorScale, indicatorType, useTicks, innerTicks, tickColor, tickStep, semiTicks, tickScale, semiTickScale, innerCircle, innerScale, innerColor, inner2Color, accentSize, accentOffset, accentColor, accentBackgroundColor, accentDifference, sound, linear, gap, limit, keyArrows, keyArrowsStep, keyArrowsH, keyArrowsV, continuous, continuousMin, continuousMax, damp, currentValue, useLabels, labelMargin, style, group, inherit",B;if(B=st(t.Dial,arguments,we,this))return B;De("63"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Dial",this.group=p;var F=N===!1?{}:t.getStyle(this.type,this.group,L);if(n(e)&&(e=F.min!=null?F.min:0),n(r)&&(r=F.max!=null?F.max:10),r-e==0){tt("ZIM Dial range must not be 0");return}n(m)&&(m=F.sound!=null?F.sound:!1),n(i)&&(i=F.step!=null?F.step:m?0:1),n(l)&&(l=F.width!=null?F.width:100),n(a)&&(a=F.backgroundColor!=null?F.backgroundColor:t.granite),n(s)&&(s=F.indicatorColor!=null?F.indicatorColor:m?t.white:t.licorice),n(f)&&(f=F.indicatorScale!=null?F.indicatorScale:1),n(u)&&(u=F.indicatorType!=null?F.indicatorType:m?"aztec":"arrow"),n(y)&&(y=F.useTicks!=null?F.useTicks:i!=0),n(k)&&(k=F.innerTicks!=null?F.innerTicks:!1),n(O)&&(O=F.tickStep!=null?F.tickStep:i||(y?.25:0)),n(T)&&(T=F.semiTicks!=null?F.semiTicks:m?3:0),n(g)&&(g=F.tickColor!=null?F.tickColor:m?t.tin:a),n(E)&&(E=F.tickScale!=null?F.tickScale:m?1.25:1),n(A)&&(A=F.semiTickScale!=null?F.semiTickScale:1.25),n(C)&&(C=F.innerCircle!=null?F.innerCircle:!0),n(x)&&(x=F.innerColor!=null?F.innerColor:m?t.pink:"rgba(0,0,0,.2)"),n(P)&&(P=F.inner2Color!=null?F.inner2Color:m?t.light:"rgba(0,0,0,.1)"),n(d)&&(d=F.innerScale!=null?F.innerScale:m?.4:.5),n(v)&&(v=F.accentSize!=null?F.accentSize:m?l/2*.15:0),n(w)&&(w=F.accentOffset!=null?F.accentOffset:l/2*.45),n(Y)&&(Y=F.accentDifference!=null?F.accentDifference:-.25),n(b)&&(b=F.accentColor!=null?F.accentColor:t.pink),n(X)&&(X=F.accentBackgroundColor!=null?F.accentBackgroundColor:m?t.blue:t.clear),n(S)&&(S=F.gap!=null?F.gap:m?.25:0),n(j)&&(j=F.linear!=null?F.linear:m),S&&(j=!0,ne=!1),n(_)&&(_=F.limit!=null?F.limit:!0),n(R)&&(R=F.keyArrows!=null?F.keyArrows:!0),n(U)&&(U=F.keyArrowsStep!=null?F.keyArrowsStep:(r-e)/100),n(Z)&&(Z=F.keyArrowsH!=null?F.keyArrowsH:!0),n(K)&&(K=F.keyArrowsV!=null?F.keyArrowsV:!0),n(ne)&&(ne=F.continuous!=null?F.continuous:!1),ne&&(_=F.limit!=null?F.limit:!1),n(c)&&(c=F.damp!=null?F.damp:!1),n(h)&&(h=F.currentValue!=null?F.currentValue:!1),n(o)&&(o=F.useLabels!=null?F.useLabels:!1),n(I)&&(I=F.labelMargin!=null?F.labelMargin:10),_==!1&&(c=null);var fe=this;this.cur("pointer");var se=Q(e,r,i,h);this.veeObj={min:se[0],max:se[1],step:se[2],currentValue:se[3]};function Q(){return arguments}e=t.Pick.choose(e),r=t.Pick.choose(r),i=t.Pick.choose(i);var te=i;h=t.Pick.choose(h);var le=l/2,Ae=l,J=e,Te=0,G;if(v){var ce=l/2+w+v/2,q=360*S/2;fe.accentBacking=new t.Shape(-le,-le,le*2,le*2).addTo(this).s(X).ss(v+Y).a(0,0,ce,(q-90)*t.RAD,(360-q-90)*t.RAD),G=fe.accent=new t.Shape(-le,-le,le*2,le*2).addTo(this)}function ue(){G.c().s(b).ss(v),j?G.a(0,0,ce,(q-90)*t.RAD,(be.rotation-q*2)*t.RAD):G.a(0,0,ce,(q-90)*t.RAD,(be.rotation-90)*t.RAD)}var ge=this.backing=new t.Circle(le,a,null,null,null,null,null,null,!1);if(v?ge.center(this):this.addChild(ge),C){var ie=this.inner=new t.Circle(le*d,x,null,null,null,null,null,null,!1);this.addChild(ie);var xe=this.inner2=new t.Circle(le*(d-.1),P,null,null,null,null,null,null,!1);this.addChild(xe)}m&&(fe.rotation=180);var Se=Math.abs(r-e)/(O||i)+(S?1:0),z=i?Math.abs(r-e)/i:0;if(y){var pe=this.ticks=new t.Container({style:!1});if(this.addChild(pe),o)var de=fe.labels=new t.Container(l*2,Ae*2).centerReg(fe);for(var oe=0;oe<Se;oe++){var Be=oe%(T+1)==0,$=new t.Rectangle(1,le*(Be?.2*E:.1*A),g,null,null,null,null,null,null,!1);if($.regY=le+(k?d-.05:$.height+le*.1),$.regX=.5,$.rotation=(360-360*S)/(Se-(S?1:0))*oe+360*S/2,pe.addChild($),o&&(T&&Be||!T)){var Me=Math.max(t.countDecimals(te),t.countDecimals(e),t.countDecimals(r));new t.Label({text:t.decimals(e+(r-e)/Math.abs(z)*oe,Me+1),size:F.size?F.size:10,align:"center",valign:"center"}).centerReg({add:!1}).loc(0,-I-1,$).addTo(de)}}fe.expand($.height)}this.setBounds(-le,-le,l,l);var be,me;if(u=="dot"||u=="circle")be=this.indicator=new t.Container({style:!1}),me=this.indicatorShape=new t.Circle(le*.19,s,null,null,null,null,null,null,!1),be.addChild(me),t.sca(be,f),be.regY=le-be.getBounds().width*f/2-le*.07;else if(u=="line"||u=="rectangle")be=this.indicator=new t.Container({style:!1}),me=this.indicatorShape=new t.Rectangle(le*.1,le*.3,s,null,null,null,null,null,null,null,null,!1),be.addChild(me),t.sca(be,f),be.regY=le-be.getBounds().width*f/2-le*.07,be.regX=le*.05;else if(u=="aztec"){be=this.indicator=new t.Container({style:!1});var re=le*.05,ke=le*.1,Re=le*.42;me=this.indicatorShape=new t.Shape(-ke,0,ke*2,Re).f(s).mt(-re,0).lt(re,0).lt(ke,Re).lt(-ke,Re).cp(),be.addChild(me),t.sca(be,f),be.regY=le-be.getBounds().width*f/2-le*.04}else be=this.indicator=new t.Container({style:!1}),me=this.indicatorShape=new t.Triangle(le*.4,le*.4,le*.4,s,null,null,null,null,null,null,null,!1),be.addChild(me),t.sca(be,f),be.regY=le-be.getBounds().height*f*(k?.85:.75),k&&(me.rotation=180);be.regY/=f,this.addChild(be);function Ye(Ue){return i==0?Ue:Math.round(Ue/i)*i}var $e,it,Le,Ze,ze=0;if(ne)var ve=0,Pe=0,ae=0,Ne=!1,Ke=!1,Xe=!0;if(j)this.on("mousedown",function(Ue){if(!(fe.zimAccessibility&&fe.zimAccessibility.aria)){var ct=$e=be.rotation,ot=fe.parent.globalToLocal(Ue.stageX/t.scaX,Ue.stageY/t.scaY);Le=fe.on("pressmove",function(dt){var et=fe.parent.globalToLocal(dt.rawX/t.scaX,dt.rawY/t.scaY);be.rotation=ct=$e+(ot.y-et.y)*100/(this.width||1),_&&(ct>360-360*S/2||ct<0+360*S/2)&&(ct=t.constrain(ct,360*S/2,360-360*S/2),ot=fe.parent.globalToLocal(dt.rawX/t.scaX,dt.rawY/t.scaY),$e=ct),Ie(ct)}),Ze=this.on("pressup",function(){fe.off("pressmove",Le),fe.off("pressup",Ze)})}});else{var Qe=!0;this.on("mousedown",function(Ue){if(!(fe.zimAccessibility&&fe.zimAccessibility.aria)){$e=be.rotation;var ct=fe.parent.globalToLocal(Ue.stageX/t.scaX,Ue.stageY/t.scaY),ot=ct.x-fe.x,dt=fe.y-ct.y;it=Math.atan2(ot,dt)*180/Math.PI;var et=new Date().getTime();Le=fe.on("pressmove",function(St){if(Ne){var ht=fe.parent.globalToLocal(St.rawX/t.scaX,St.rawY/t.scaY),gt=ht.x-fe.x,Bt=fe.y-ht.y;it=Math.atan2(gt,Bt)*180/Math.PI,$e=be.rotation}ht=fe.parent.globalToLocal(St.rawX/t.scaX,St.rawY/t.scaY),gt=ht.x-fe.x,Bt=fe.y-ht.y;var Dt=Math.atan2(gt,Bt)*180/Math.PI,Ht=$e+Dt-it;Ht=(Ht+360*1e4)%360,_&&Qe&&(Ht-ze>180&&fe.currentValue!=r?Ht=0:Ht-ze<-180&&(Ht=359)),Qe=!0,Ie(Ht),ze=Ht}),Ze=this.on("pressup",function(St){fe.currentValue!=fe.min&&fe.currentValue!=fe.max&&(Qe=!1);var ht=new Date().getTime()-et;if(ht<200){ct=fe.parent.globalToLocal(St.rawX/t.scaX,St.rawY/t.scaY),ot=ct.x-fe.x,dt=fe.y-ct.y;var gt=Math.atan2(ot,dt)*180/Math.PI-fe.rotation;Ie(gt)}$e=be.rotation,fe.off("pressmove",Le),fe.off("pressup",Ze)})}})}function he(Ue){return Ue>0?1:-1}function Ge(){fe.zimAccessibility&&fe.zimAccessibility.changeTitle(fe,null,!0)}function Ie(Ue){if(ne){Ke&&(ve=Ue,Ke=!1),Ue>ve+180?ae-=360:Ue<ve-180&&(ae+=360),Pe=ae+Ue,Xe=!1;var ct=fe.currentValue;return fe.currentValue=Ye(Pe*(r-e)/360),ct!=fe.currentValue&&fe.dispatchEvent("change"),ve=Ue,Xe=!0,G&&ue(),!0}var ot;Ue<0&&(Ue+=360),Ue=Ue%360,i!=0?(Ue=Math.min(Ue,360),ot=Ye((Ue-360*S/2)/(360-360*S)*(r-e)),be.rotation=360*S/2+ot*(360-360*S)/(r-e)):(be.rotation=Ue,ot=(Ue-360*S/2)/(360-360*S)*(r-e)),ot!=Te&&(Te=ot,J=ot+e,G&&ue(),fe.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&fe.stage&&fe.stage.update()),Ge()}var _e,Je;c&&(_e=e,Je=new t.Damp(_e,c),fe.ticker=t.Ticker.add(function(){_e=Je.convert(J)})),Object.defineProperty(this,"currentValue",{get:function(){return c?_e:J},set:function(Ue){n(Ue)||(ne?(Ne=!1,!n(V)&&!n(D)?V<D?(Ue<V&&(Ue=V,Ne=!0),Ue>D&&(Ue=D,Ne=!0)):(Ue>V&&(Ue=V,Ne=!0),Ue<D&&(Ue=D,Ne=!0)):n(V)?n(D)||Ue>D&&(Ue=D,Ne=!0):Ue<V&&(Ue=V,Ne=!0),Xe&&(Ke=!0,ae=Math.floor(Ue/(r-e))*360)):e<r?(Ue<e&&(Ue=_?e:r),Ue>r&&(Ue=_?r:e)):(Ue>e&&(Ue=_?e:r),Ue<r&&(Ue=_?r:e)),J=Ue,Ue=Ye(Ue),c&&c.immediate(J),be.rotation=S*360/2+(Ue-e)*(360-S*360)/(r-e),be.rotation=(be.rotation+360*1e4)%360,Te=Ue-e,ze=be.rotation,G&&ue(),Ge(),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&fe.stage&&fe.stage.update())}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return c?_e:J},set:function(Ue){Ue!=fe.currentValue&&(fe.currentValue=Ue,fe.dispatchEvent("change"))}}),Object.defineProperty(this,"min",{get:function(){return e},set:function(Ue){ne?e=Ue:vt&&tt("Dial() - min is read only")}}),Object.defineProperty(this,"max",{get:function(){return r},set:function(Ue){ne?r=Ue:vt&&tt("Dial() - max is read only")}}),Object.defineProperty(this,"continuous",{get:function(){return ne},set:function(){vt&&tt("Dial() - continuous is read only")}}),Object.defineProperty(this,"continuousMin",{get:function(){return V},set:function(Ue){V=Ue,fe.currentValue<V&&(fe.currentValue=V)}}),Object.defineProperty(this,"continuousMax",{get:function(){return D},set:function(Ue){D=Ue,fe.currentValue>D&&(fe.currentValue=D)}}),Object.defineProperty(this,"step",{get:function(){return i},set:function(){vt&&tt("Dial() - step is read only")}}),Object.defineProperty(this,"keyArrowsH",{get:function(){return Z},set:function(Ue){Z=Ue}}),Object.defineProperty(this,"keyArrowsV",{get:function(){return K},set:function(Ue){K=Ue}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==fe},set:function(){t.KEYFOCUS=fe}}),R&&!t.KEYFOCUS&&Oe(),this.on("mousedown",function(){R&&Oe()});function Oe(){fe.keyFocus=!0;var Ue=document.activeElement;Ue&&Ue.blur()}var Ve=!1,rt=!1,Ce=!1,We=!1;this.keyDownEvent=function(Ue){fe.stage&&(fe.zimAccessibility&&fe.focus||!fe.zimAccessibility&&fe.keyFocus)&&(Ue.keyCode==37&&Z?Ve=!0:Ue.keyCode==40&&K?rt=!0:Ue.keyCode==39&&Z?Ce=!0:Ue.keyCode==38&&K&&(We=!0),fe.keyInterval==null&&(Ve||rt||Ce||We)&&(lt(),fe.keyTimeout=setTimeout(function(){fe.keyInterval==null&&(Ve||rt||Ce||We)&&(fe.keyInterval=setInterval(lt,40))},140)))};function lt(){(Ve||rt)&&(i>0?fe.currentValueEvent-=i*he(r-e):fe.currentValueEvent-=U*he(r-e)),(Ce||We)&&(i>0?fe.currentValueEvent+=i*he(r-e):fe.currentValueEvent+=U*he(r-e))}ee.addEventListener("keydown",this.keyDownEvent),fe.keyUpEvent=function(Ue){Ue.keyCode==37?Ve=!1:Ue.keyCode==40?rt=!1:Ue.keyCode==39?Ce=!1:Ue.keyCode==38&&(We=!1),fe.keyInterval!=null&&!Ve&&!rt&&!Ce&&!We&&(clearInterval(fe.keyInterval),fe.keyInterval=null)},ee.addEventListener("keyup",this.keyUpEvent),this._enabled=!0,Object.defineProperty(fe,"enabled",{get:function(){return fe._enabled},set:function(Ue){Ue?(ee.addEventListener("keydown",fe.keyDownEvent),ee.addEventListener("keyup",fe.keyUpEvent)):(ee.removeEventListener("keydown",fe.keyDownEvent),ee.removeEventListener("keyup",fe.keyUpEvent)),fe._enabled=Ue}}),n(h)&&(h=F.currentValue!=null?F.currentValue:e),fe.currentValue=h,N!==!1&&t.styleTransforms(this,F),this.clone=function(Ue){return fe.cloneProps(new t.Dial(Ue||!t.isPick(se[0])?fe.min:se[0],Ue||!t.isPick(se[1])?fe.max:se[1],Ue||!t.isPick(se[2])?fe.step:se[2],l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,Ue||!t.isPick(se[3])?fe.currentValue:se[3],o,I,N,this.group,L))},this.dispose=function(Ue,ct,ot){return ee.removeEventListener("keydown",fe.keyDownEvent),ee.removeEventListener("keyup",fe.keyUpEvent),ot||this.zimContainer_dispose(!0),!0}},t.extend(t.Dial,t.Container,["clone","dispose"],"zimContainer",!1),t.Tabs=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te){var le="width, height, tabs, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, vertical, spacing, currentEnabled, currentSelected, corner, base, keyEnabled, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, backdropColor, align, valign, labelAlign, labelValign, labelIndent, labelIndentH, labelIndentV, indent, useTap, excludeCustomTap, selectedIndex, styleLabels, keyWrap, style, group, inherit",Ae;if(Ae=st(t.Tabs,arguments,le,this))return Ae;De("65");var J=se===!1?{}:t.getStyle("Tabs",Q,te);n(E)&&(E=J.vertical!=null?J.vertical:!1),n(e)&&(e=J.width!=null?J.width:null);var Te=!n(e);if(n(e)&&(e=E?60:240),n(r)&&(r=J.height!=null?J.height:E?240:60),this.zimContainer_constructor(null,null,null,null,!0),this.type="Tabs",this.group=Q,(n(i)||i.length<=0)&&(i=J.tabs!=null?J.tabs:[1,2,3,4]),n(l)&&(l=J.backgroundColor!=null?J.backgroundColor:t.tin),n(a)&&(a=J.rollBackgroundColor!=null?J.rollBackgroundColor:t.grey),n(s)&&(s=J.downBackgroundColor!=null?J.downBackgroundColor:a),n(f)&&(f=J.selectedBackgroundColor!=null?J.selectedBackgroundColor:t.dark),n(u)&&(u=J.selectedRollBackgroundColor!=null?J.selectedRollBackgroundColor:a),n(y)&&(y=J.color!=null?J.color:t.white),n(k)&&(k=J.rollColor!=null?J.rollColor:y),n(g)&&(g=J.downColor!=null?J.downColor:k),n(O)&&(O=J.selectedColor!=null?J.selectedColor:y),n(T)&&(T=J.selectedRollColor!=null?J.selectedRollColor:k),n(X)&&(X=J.backing!=null?J.backing.clone():null),n(Y)&&(Y=J.rollBacking!=null?J.rollBacking.clone():null),n(V)&&(V=J.align!=null?J.align:"center"),n(D)&&(D=J.valign!=null?J.valign:"center"),n(c)&&(c=J.labelAlign!=null?J.labelAlign:V),n(h)&&(h=J.labelValign!=null?J.labelValign:D),n(p)&&(p=J.indent!=null?J.indent:10),n(o)&&(o=J.labelIndent!=null?J.labelIndent:p),n(I)&&(I=J.labelIndentH!=null?J.labelIndentH:o),n(N)&&(N=J.labelIndentV!=null?J.labelIndentV:o),n(C)&&(C=J.currentEnabled!=null?J.currentEnabled:!1),n(d)&&(d=J.currentSelected!=null?J.currentSelected:!0),d||(C=!0),n(A)&&(A=J.spacing!=null?J.spacing:1),n(x)&&(x=J.corner!=null?J.corner:0),n(w)&&(w=J.gradient!=null?J.gradient:null),n(b)&&(b=J.gloss!=null?J.gloss:null),n(P)&&(P=J.base!=null?J.base:x==0&&!Array.isArray(x)?"none":E?"left":"bottom"),n(v)&&(v=J.keyEnabled!=null?J.keyEnabled:!0),n(L)&&(L=J.useTap!=null?J.useTap:!1),n(we)&&(we=J.excludeCustomTap!=null?J.excludeCustomTap:!1),n(ne)&&(ne=J.backdropColor!=null?J.backdropColor:null),n(F)&&(F=J.styleLabels!=null?J.styleLabels:!1),n(fe)&&(fe=J.keyWrap!=null?J.keyWrap:!0),P!="none"&&x!=0&&!Array.isArray(x))switch(P){case"bottom":x=[x,x,0,0];break;case"left":x=[0,x,x,0];break;case"top":x=[0,0,x,x];break;case"right":x=[x,0,0,x];break}else Array.isArray(x)||(x=[x,x,x,x]);var G=this;this.keyEnabled=v;var ce=0,q=[],ue=[],ge,ie,xe=i.length,Se=(e-A*(xe-1))/xe,z=(r-A*(xe-1)-2)/xe;if(!n(ne)){var pe=this.backdrop=new t.Rectangle(e,r,ne,null,null,null,null,null,null,!1);this.addChild(pe)}var de=!1,oe;function Be(Pe){for(var ae=0;ae<Pe.length;ae++){var Ne=Pe[ae];if(Ne.constructor==={}.constructor){oe&&oe!="TabObject"&&(de=!0),oe="TabObject",Ne.type="TabObject";continue}typeof Ne=="string"||typeof Ne=="number"||Ne.type=="Label"?(Pe[ae]={type:"TabObject",label:String(Ne!=null)||Ne.type=="Label"?Ne:"1"},oe&&oe!="TabObject"&&(de=!0),oe="TabObject"):(oe&&oe=="TabObject"&&(de=!0),oe="Other")}}Be(i);for(var $=0,Me,be=0,me=0;me<i.length;me++)ie=i[me],E?Te&&(ie.width=ie.width?ie.width:e):(n(ie.width)&&be++,$+=n(ie.width)?Se:ie.width);if(!E){if($>e-A*(xe-1))for(me=0;me<i.length;me++)ie=i[me],ie.width=(e-A*(xe-1))/$*(n(ie.width)?Se:ie.width);else if(Math.round($)<Math.round(e-A*(xe-1))&&be>0)for(Me=(xe*Se-($-be*Se))/be,me=0;me<i.length;me++)ie=i[me],ie.width=n(ie.width)?Me:ie.width}function re(Pe,ae){for(me=0;me<Pe.length;me++)ie=Pe[me],ie!=""&&ie.type=="TabObject"&&(n(ie.label)&&(ie.label=" "),(typeof ie.label=="string"||typeof ie.label=="number")&&(ie.label=new t.Label({text:ie.label,size:J.size!=null?J.size:E?z/2:r/2,font:J.font!=null?J.font:null,style:F,valign:h,inherit:ae})))}re(i,F?J:null);var ke=0;for(me=0;me<i.length;me++)ie=i[me],!ie.width&&E&&ie.label.width>ke&&(ke=ie.label.width);var Re=0;function Ye(Pe,ae){var Ne=[],Ke=[];for(me=0;me<Pe.length;me++){if(ie=Pe[me],ie.type=="TabObject"){var Xe={color:n(ie.color)?t.Pick.choose(y):ie.color,rollColor:n(ie.rollColor)?t.Pick.choose(k):ie.rollColor,downColor:n(ie.downColor)?t.Pick.choose(g):ie.downColor,selectedColor:n(ie.selectedColor)?t.Pick.choose(O):ie.selectedColor,selectedRollColor:n(ie.selectedRollColor)?t.Pick.choose(T):ie.selectedRollColor,backgroundColor:n(ie.backgroundColor)?t.Pick.choose(l):ie.backgroundColor,rollBackgroundColor:n(ie.rollBackgroundColor)?t.Pick.choose(a):ie.rollBackgroundColor,downBackgroundColor:n(ie.downBackgroundColor)?t.Pick.choose(s):ie.downBackgroundColor,selectedBackgroundColor:n(ie.selectedBackgroundColor)?t.Pick.choose(f):ie.selectedBackgroundColor,selectedRollBackgroundColor:n(ie.selectedRollBackgroundColor)?t.Pick.choose(u):ie.selectedRollBackgroundColor,wait:n(ie.wait)?t.Pick.choose(m):ie.wait};if(ae)for(var Qe in ae)n(ae[Qe])||(Xe[Qe]=ae[Qe]);ge=new t.Button({width:E?n(ie.width)?Te?e:ke+z/2+x[0]/2:ie.width:n(ie.width)?Se:ie.width,height:E?z:r,label:ie.label,borderColor:J.borderColor!=null?J.borderColor:null,borderWidth:J.borderWidth!=null?J.borderWidth:null,backgroundColor:Xe.backgroundColor,rollBackgroundColor:Xe.rollBackgroundColor,downBackgroundColor:Xe.downBackgroundColor,downColor:Xe.downColor,corner:x,shadowColor:-1,gradient:w,gloss:b,backing:X?X.clone():null,rollBacking:Y?Y.clone():null,wait:Xe.wait,waitTime:n(ie.waitTime)?j:ie.waitTime,waitBackgroundColor:n(ie.waitBackgroundColor)?S:ie.waitBackgroundColor,rollWaitBackgroundColor:n(ie.rollWaitBackgroundColor)?_:ie.rollWaitBackgroundColor,waitColor:n(ie.waitColor)?R:ie.waitColor,rollWaitColor:n(ie.rollWaitBackgroundColor)?U:ie.rollWaitColor,waitModal:n(ie.waitModal)?Z:ie.waitModal,waitEnabled:n(ie.waitEnabled)?K:ie.waitEnabled,align:c,valign:h,indentH:I,indentV:N,inherit:t.copy(J)}),ge.tabInfo=Xe,ge.color=ge.tabInfo.color,ge.rollColor=ge.tabInfo.rollColor,ge.type="TabsButton",ge.content=ie,ge.listIndentReady=!0}else{if(ie.listIndentReady)ge=ie;else{ge=new t.Container,ge.type=ie.type,ge.content=ie;for(var he=["text","backing","label","slider","stepper","checkBox","colorPicker","swatch","colorLabel"],Ge=0;Ge<he.length;Ge++)ie[he[Ge]]&&(ge[he[Ge]]=ie[he[Ge]])}ie.checkBox&&(ge.checkBox=ie.checkBox),n(ge.tabInfo)&&(ge.tabInfo={}),we&&(ge.excludeTap=!0),ge.tabInfo.color=n(ie.color)?y:ie.color,ge.tabInfo.backgroundColor=n(ie.backgroundColor)?l:ie.backgroundColor,ie.listIndentReady||(new t.Rectangle(Math.max(ie.width,E?Te?e:ke+z/2+x[0]/2:ie.width),Math.max(ie.height,E?z:r),t.clear).addTo(ge).expand(0).cur(),ie.center(ge).cur(),V=="center"||V=="middle"||ie.pos(0,null,V=="right"),D=="center"||D=="middle"||ie.pos(null,0,null,D=="bottom"),ge.listIndentReady=!0)}ge.width>Re&&(Re=ge.width),L?ge.tap(function(Ie){Le(Ie.currentTarget.znum),G.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}):ge.zimTabEvent=ge.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Ie){Le(Ie.currentTarget.znum),G.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}),ge.on("mousedown",function(Ie){G.buttonDown=Ie.currentTarget}),ge.on("pressup",function(Ie){G.buttonDown=null;var _e=Ie.currentTarget.znum;L||t.ACTIONEVENT=="click"?setTimeout(function(){Ze(_e)},50):Ze(_e)}),Ke.push(ie.label),Ne.push(ge),ge.index=me}return[Ne,Ke]}var $e=Ye(i);ue=$e[0],q=$e[1];function it(){var Pe=0,ae=0,Ne;for(me=0;me<ue.length;me++)Ne=ue[me],Ne.znum=me,Ne.selectedIndex=me,Ne.selectedIndex==ce&&d&&(Ne.backgroundColor=f,Ne.rollBackgroundColor=u,Ne.color=O),q[me]&&(q[me].znum=me),G.addChild(Ne),(!E||Te)&&(Ne.x=(e-Ne.width)/2,Ne.y=(r-Ne.height)/2),E?(Ne.y=ae,ae=Ne.y+Ne.height+A,V=="left"?Ne.x=(Ne.type=="TabsButton"||Ne.type=="ListItem"?0:p)+(Ne.regX-(Ne.getBounds()?Ne.getBounds().x:0))*Ne.scaleX:V=="right"&&(Ne.x=(Te?e:Re)-Ne.width-(Ne.type=="TabsButton"||Ne.type=="ListItem"?0:p))):(Ne.x=Pe,Pe=Ne.x+Ne.width+A,D=="top"?Ne.y=(Ne.type=="TabsButton"&&!de?0:p)+(Ne.regY-(Ne.getBounds()?Ne.getBounds().y:0))*Ne.scaleY:D=="bottom"&&(Ne.y=r-Ne.height-(Ne.type=="TabsButton"&&!de?0:p))),me==ce&&!C?Ne.enabled=!1:Ne.enabled=!0;n(ne)||G.removeChild(pe),G._bounds=null;var Ke=G.getBounds(),Xe=0,Qe=0;if(!Ke&&Fe.EaselJS.version[0]!=0?G.setBounds():Ke&&(Xe=E&&Ke.width!=0&&Te?e:Ke.width,Qe=E&&Ke.height!=0?Ke.height:r,G.setBounds(Xe,Qe)),n(ne)||(pe.widthOnly=Xe,pe.heightOnly=Qe,G.addChildAt(pe,0)),E&&!Te)for(me=0;me<=ue.length;me++)(V=="center"||V=="middle")&&(Ne.x=(Xe-Ne.width)/2)}it();function Le(Pe,ae){if(Pe!=ce){var Ne=ue[ce];if(Ne&&d&&(Ne.tabInfo&&n(Ne.tabInfo.wait)&&(Ne.tabInfo.backgroundColor&&(Ne.backgroundColor=Ne.tabInfo.backgroundColor),Ne.tabInfo.rollBackgroundColor&&(Ne.rollBackgroundColor=Ne.tabInfo.rollBackgroundColor),Ne.tabInfo.color&&Ne.label&&(Ne.color=Ne.tabInfo.color),Ne.tabInfo.rollColor&&Ne.label&&(Ne.rollColor=Ne.tabInfo.rollColor)),C||(Ne.enabled=!0)),ce=Pe,Ne=ue[ce],Ne){var Ke=Ne.tabInfo;Ke&&n(Ne.tabInfo.wait)&&d&&(Ke.selectedBackgroundColor&&(Ne.backgroundColor=!n(Ke.downBackgroundColor)&&!ae?Ke.downBackgroundColor:Ke.selectedBackgroundColor),Ke.selectedRollBackgroundColor&&(Ne.rollBackgroundColor=Ke.selectedRollBackgroundColor),Ke.selectedColor&&Ne.label&&(Ne.color=!n(Ke.downColor)&&!ae?Ke.downColor:Ke.selectedColor),Ke.selectedRollColor&&Ne.label&&(Ne.rollColor=Ke.selectedRollColor)),ae&&!C&&(Ne.enabled=!1)}}}function Ze(Pe){var ae=ue[Pe];if(ae&&d){var Ne=ae.tabInfo;Ne&&n(Ne.wait)&&(Ne.selectedBackgroundColor&&(ae.backgroundColor=G.selected==ae?Ne.selectedBackgroundColor:Ne.backgroundColor),Ne.selectedColor&&ae.label&&(ae.color=G.selected==ae?Ne.selectedColor:Ne.color)),C||(ae.enabled=!1)}}this.addAt=function(Pe,ae,Ne){n(ae)&&(ae=ue.length),ae=t.constrain(ae,0,ue.length),Array.isArray(Pe)||(Pe=[Pe]),Be(Pe),re(Pe,Ne);var Ke=Ye(Pe,Ne),Xe=Ke[0],Qe=Ke[1];ae<=ce&&(ce+=Xe.length);var he=[ae,0].concat(Xe);return Array.prototype.splice.apply(ue,he),he=[ae,0].concat(Qe),Array.prototype.splice.apply(q,he),it(),G},this.removeAt=function(Pe,ae){if(ue.length==0)return G;for(n(Pe)&&(Pe=1),n(ae)&&(ae=ue.length-Pe),ae=t.constrain(ae,0,ue.length-Pe),ce>=ae&&ce<=ae+Pe&&(ce=-1),ce>ae+Pe&&(ce-=Pe),me=ae;me<ae+Pe;me++)ue[me].tabInfo&&(ue[me].tabInfo.backgroundColor&&(ue[me].backgroundColor=ue[me].tabInfo.backgroundColor),ue[me].tabInfo.color&&ue[me].label&&(ue[me].color=ue[me].tabInfo.color)),L?ue[me].noTap():ue[me].off((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",ue[me].zimTabEvent),ue[me].removeFrom();return ue.splice(ae,Pe),q.splice(ae,Pe),it(),G},G.keyEvent=function(Pe){if(!(!G.keyEnabled||!G.keyFocus||G.zimAccessibility)&&Pe.keyCode==9){var ae=ce;Pe.shiftKey?Le(--ae<0?fe?i.length-1:0:ae):Le(++ae>i.length-1?fe?0:i.length-1:ae),G.dispatchEvent("change"),G.dispatchEvent("keychange"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update(),Pe.preventDefault()}},ee.addEventListener("keydown",G.keyEvent),Object.defineProperty(this,"selected",{get:function(){return ue[ce]},set:function(){vt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"selectedIndex",{get:function(){return ce},set:function(Pe){Le(Pe,!0),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}),this.last=function(){return this.selectedIndex=this.buttons.length-1,this},this.first=function(){return this.selectedIndex=0,this},Object.defineProperty(this,"tabs",{get:function(){return ce},set:function(Pe){Le(Math.min(Math.max(Pe,0),i.length-1)),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}),Object.defineProperty(this,"color",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.color:y},set:function(Pe){if(y=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.color=Pe),(ae!=ce||!d)&&(G.buttons[ae].color=y);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"rollColor",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.rollColor:k},set:function(Pe){if(k=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.rollColor=Pe),G.buttons[ae].rollColor=k,ae!=ce&&G.buttons[ae].rolled&&(G.buttons[ae].color=k);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"selectedColor",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.selectedColor:O},set:function(Pe){if(O=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.selectedColor=Pe),ae==ce&&d&&(G.buttons[ae].color=O);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"selectedRollColor",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.selectedRollColor:T},set:function(Pe){if(T=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.selectedRollColor=Pe),ae==ce&&d&&G.buttons[ae].rolled&&(G.buttons[ae].color=T);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"backgroundColor",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.backgroundColor:l},set:function(Pe){if(l=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.backgroundColor=Pe),(ae!=ce||!d)&&(G.buttons[ae].backgroundColor=l);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"rollBackgroundColor",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.rollBackgroundColor:a},set:function(Pe){if(a=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.rollBackgroundColor=Pe),G.buttons[ae].rollBackgroundColor=a,ae!=ce&&G.buttons[ae].rolled&&(G.buttons[ae].backgroundColor=a);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"selectedBackgroundColor",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.selectedBackgroundColor:f},set:function(Pe){if(f=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.selectedBackgroundColor=Pe),ae==ce&&d&&(G.buttons[ae].backgroundColor=f);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"selectedRollBackgroundColor",{get:function(){return G.buttons[0].tabItems?G.buttons[0].tabItems.selectedRollBackgroundColor:u},set:function(Pe){if(u=Pe,G.buttons[0].tabInfo){for(var ae=0;ae<G.buttons.length;ae++)G.buttons[ae].tabInfo&&(G.buttons[ae].tabInfo.selectedRollBackgroundColor=Pe),ae==ce&&d&&G.buttons[ae].rolled&&(G.buttons[ae].backgroundColor=u);!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&G.stage&&G.stage.update()}}}),Object.defineProperty(this,"label",{get:function(){return q[ce]},set:function(){vt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"text",{get:function(){return q[ce]!=null?q[ce].text:void 0},set:function(){vt&&tt("Tabs() - selected is read only - try selectedIndex")}}),Object.defineProperty(this,"buttons",{get:function(){return ue},set:function(){vt&&tt("Tabs() - buttons is read only")}}),Object.defineProperty(this,"labels",{get:function(){return q},set:function(){vt&&tt("Tabs() - labels is read only")}}),this._enabled=!0,Object.defineProperty(G,"enabled",{get:function(){return G._enabled},set:function(Pe){Ot(G,Pe)}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==G},set:function(){t.KEYFOCUS=G}}),v&&t.KEYFOCUS&&ze(),this.on("mousedown",function(){v&&ze()});function ze(){G.keyFocus=!0;var Pe=document.activeElement;Pe&&Pe.blur()}var ve=G.getBounds();n(ve)||ve.width==0?G.setBounds(0,0,e,r):G.width=e,n(B)&&(B=J.selectedIndex!=null?J.selectedIndex:0),G.selectedIndex=B,se!==!1&&t.styleTransforms(this,J),this.clone=function(){for(var Pe=t.copy(i,!0),ae=0;ae<Pe.length;ae++)Pe[ae].label=Pe[ae].label.clone();return G.cloneProps(new t.Tabs(e,r,Pe,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,this.group,te))},this.doDispose=function(Pe,ae,Ne){G.keyEvent&&ee.removeEventListener("keydown",G.keyEvent),t.loop(G.buttons,function(Ke){Ke.dispose()}),G.keyEvent=null,Ne||this.zimContainer_dispose(!0),d=ie=i=q=ge=ue=$e=null}},t.extend(t.Tabs,t.Container,["clone","dispose"],"zimContainer",!1),t.Tabs.prototype.dispose=function(e){return this.doDispose(null,null,e)},t.Pad=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D){var c="width, cols, rows, keys, backgroundColor, rollBackgroundColor, downBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, downColor, selectedColor, selectedRollColor, spacing, currentEnabled, currentSelected, corner, labelColor, gradient, gloss, backing, rollBacking, wait, waitTime, waitBackgroundColor, rollWaitBackgroundColor, waitColor, rollWaitColor, waitModal, waitEnabled, selectedIndex, style, group, inherit",h;if(h=st(t.Pad,arguments,c,this))return h;De("66"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pad",this.group=V;var o=ne===!1?{}:t.getStyle(this.type,this.group,D);n(e)&&(e=o.width!=null?o.width:150),n(r)&&(r=o.cols!=null?o.cols:3),n(i)&&(i=o.rows!=null?o.rows:r);var I;if(n(l))if(o.keys!=null)l=o.keys;else for(l=[],I=1;I<=i*r;I++)l.push(I);n(C)&&(C=o.currentEnabled!=null?o.currentEnabled:!0),n(A)&&(A=o.spacing!=null?o.spacing:1);var N=this,p;this.cols=r,this.rows=i;var L=e/r-A,we=[],B=0,F;for(this.labels=[],this.buttons=[],I=0;I<i;I++){for(var fe=[],se=0;se<r;se++)fe.push(l[B]!=null?l[B]:""),B++;var Q=o.corner!=null?o.corner:x;Q&&!Array.isArray(Q)&&(Q=[Q,Q,Q,Q]),F=we[I]=new t.Tabs({width:e,height:L,tabs:fe,backgroundColor:o.backgroundColor!=null?o.backgroundColor:a,rollBackgroundColor:o.rollBackgroundColor!=null?o.rollBackgroundColor:s,downBackgroundColor:o.downBackgroundColor!=null?o.downBackgroundColor:f,selectedBackgroundColor:o.selectedBackgroundColor!=null?o.selectedBackgroundColor:u,color:o.color!=null?o.color:k,rollColor:o.rollColor!=null?o.rollColor:g,downColor:o.downColor!=null?o.downColor:O,selectedColor:o.selectedColor!=null?o.selectedColor:T,spacing:o.spacing!=null?o.spacing:A,currentEnabled:o.currentEnabled!=null?o.currentEnabled:C,currentSelected:o.currentSelected!=null?o.currentSelected:d,corner:Q,backing:o.backing!=null?o.backing.clone():b,rollBacking:o.rollBacking!=null?o.rollBacking.clone():X,base:null,keyEnabled:!1,gradient:o.gradient!=null?o.gradient:v,gloss:o.gloss!=null?o.gloss:w,wait:o.wait!=null?o.wait:Y,waitTime:o.waitTime!=null?o.waitTime:m,waitBackgroundColor:o.waitBackgroundColor!=null?o.waitBackgroundColor:j,rollWaitBackgroundColor:o.rollWaitBackgroundColor!=null?o.rollWaitBackgroundColor:S,waitColor:o.waitColor!=null?o.waitColor:_,rollWaitColor:o.rollWaitColor!=null?o.rollWaitColor:R,waitModal:o.waitModal!=null?o.waitModal:U,waitEnabled:o.waitEnabled!=null?o.waitEnabled:Z,group:V,style:!1}),this.labels=this.labels.concat(F.labels),this.buttons=this.buttons.concat(F.buttons),this.addChild(F),F.selectedIndex=-1,F.y=(L+A)*I,F.znum=I,F.on("change",te)}this.tabs=we;function te(le){var Ae=le.target;N.selected=Ae.selected,N.text=Ae.text,N.label=Ae.label;for(var J=Ae.selectedIndex,Te=0;Te<we.length;Te++)Ae!=we[Te]&&(we[Te].selectedIndex=-1);p=Ae.znum*r+J,N.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&N.stage&&N.stage.update()}Object.defineProperty(this,"selectedIndex",{get:function(){return p},set:function(le){p=le;for(var Ae=0;Ae<we.length;Ae++)we[Ae].selectedIndex=-1;var J=Math.floor(p/r);J>=0&&J<N.tabs.length&&(N.tabs[J].selectedIndex=p%r)}}),this._enabled=!0,Object.defineProperty(N,"enabled",{get:function(){return N._enabled},set:function(le){Ot(N,le)}}),n(K)&&(K=o.selectedIndex!=null?o.selectedIndex:0),N.selectedIndex=K,ne!==!1&&t.styleTransforms(this,o),this.clone=function(){return N.cloneProps(new t.Pad(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,this.group,D))},this.dispose=function(le,Ae,J){t.loop(we,function(Te){Te.dispose()}),this.labels=this.buttons=this.tabs=null,F=we=N.rowTabs=null,J||this.zimContainer_dispose(!0)}},t.extend(t.Pad,t.Container,["clone","dispose"],"zimContainer",!1),t.NumPad=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X){var Y="advanced, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, backgroundColor, borderColor, borderWidth, corner, numberCorner, close, closeColor, collapse, collapseColor, collapsed, align, shadowColor, shadowBlur, draggable, boundary, style, group, inherit",m;if(m=st(t.NumPad,arguments,Y,this))return m;De("57.7"),this.group=b;var j=w===!1?{}:t.getStyle("NumPad",this.group,X);n(e)&&(e=j.advanced!=null?j.advanced:!1);var S=e=="simple"?310:400,_=e=="simple"?440:e?620:530;n(r)&&(r=j.titleBar!=null?j.titleBar:"NUMPAD"),n(i)&&(i=j.titleBarColor!=null?j.titleBarColor:t.white),n(l)&&(l=j.titleBarBackgroundColor!=null?j.titleBarBackgroundColor:t.grey),n(a)&&(a=j.titleBarHeight!=null?j.titleBarHeight:40),n(s)&&(s=j.backgroundColor!=null?j.backgroundColor:t.darker),n(f)&&(f=j.borderColor!=null?j.borderColor:t.pewter),n(u)&&(u=j.borderWidth!=null?j.borderWidth:null),f<0||u<0?f=u=null:f!=null&&u==null&&(u=1),n(y)&&(y=j.corner!=null?j.corner:15),n(k)&&(k=j.numberCorner!=null?j.numberCorner:30),n(C)&&(C=j.align!=null?j.align:"left"),n(d)&&(d=j.shadowColor!=null?j.shadowColor:"rgba(0,0,0,.3)"),n(x)&&(x=j.shadowBlur!=null?j.shadowBlur:14),n(P)&&(P=j.draggable!=null?j.draggable:!0),n(v)&&(v=j.boundary!=null?j.boundary:null),n(g)&&(g=j.close!=null?j.close:!0),n(O)&&(O=j.closeColor!=null?j.closeColor:n(i)?t.grey:i),Array.isArray(y)||(y=[y,y,y,y]),n(T)&&(T=j.collapse!=null?j.collapse:!0),n(E)&&(E=j.collapseColor!=null?j.collapseColor:n(i)?t.grey:i),n(A)&&(A=j.collapsed!=null?j.collapsed:!1),this.zimPanel_constructor(S,_,null,r,i,l,a,s,f,u,y,g,O,null,null,null,T,E,A,C,d,x,P,v,w,b,X),this.type="NumPad";var R=this;function U(K,ne){return n(ne)&&(ne=mist),{label:K,backgroundColor:ne,rollBackgroundColor:white,color:darker,rollColor:darker}}var Z=[U("C",t.red.darken(.1)),U(new t.Label({text:"\u2423",size:90,shiftV:-24}),t.yellow.darken(.1)),U(new t.Label({text:"/",size:48,bold:!0,shiftV:3})),U(new t.Label({text:"*",size:65,shiftV:18})),1,2,3,U(new t.Label({text:"-",size:60,shiftV:-3})),4,5,6,U(new t.Label({text:"+",size:55,shiftV:3})),7,8,9,U(new t.Label({text:"\u232B",size:M=="ios"?60:35}),t.red.darken(.1)),U(new t.Label({text:",",size:70,shiftV:-3})),U(new ti({text:".",size:70,shiftV:-3})),0,U(new t.Label({text:"\u23CE",size:M=="ios"?40:50,shiftV:5}),t.green.darken(.1))];e=="simple"?(Z.splice(0,4),Z.splice(3,1),Z.splice(6,1),Z.splice(10,2),Z[12]=Z[9],Z[9]=Z[10],Z[10]=Z[12]):e&&(Z.splice(2,0,U("%",yellow.darken(.1))),Z.splice(4,0,U(new t.Label({text:"^",size:47,shiftV:10}),yellow.darken(.1))),Z.splice(4,0,U(")",yellow.darken(.1))),Z.splice(4,0,U("(",yellow.darken(.1)))),R.pad=new t.Pad({width:e=="simple"?290:380,cols:e=="simple"?3:4,rows:e=="simple"?4:e?6:5,keys:Z,spacing:6,currentSelected:!1,backgroundColor:t.grey,rollBackgroundColor:t.tin,selectedBackgroundColor:t.grey,downBackgroundColor:t.green,corner:k}),R.pad.on("mousedown",function(){R.pad.text=="C"?R.key="clear":R.pad.text=="\u2423"?R.key="space":R.pad.text=="\u232B"?R.key="backspace":R.pad.text=="\u23CE"?R.key="enter":R.key=R.pad.text,R.dispatchEvent("pressed")}),R.add(R.pad,null,!0),w!==!1&&t.styleTransforms(this,j),this.clone=function(){return R.cloneProps(new t.NumPad(e,r?r.clone():"",i,l,a,s,f,u,y,k,g,O,T,E,R.collapsed,C,d,x,P,v,w,this.group,X))}},t.extend(t.NumPad,t.Panel,["clone"],"zimPanel",!1),t.DPad=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d){var x="axis, width, backgroundColor, borderWidth, borderColor, indicatorColor, indicatorPressColor, indicatorScale, indicatorRadius, innerCircle, innerScale, activeRadius, clamp, logo, style, group, inherit",P;if(P=st(t.DPad,arguments,x,this))return P;De("66.2"),this.zimContainer_constructor(null,null,null,null,!1),this.type="DPad",this.group=C;var v=A===!1?{}:t.getStyle(this.type,this.group,d);n(e)&&(e=v.axis!=null?v.axis:"all"),n(r)&&(r=v.width!=null?v.width:100),n(i)&&(i=v.backgroundColor!=null?v.backgroundColor:t.granite),n(a)&&(a=v.borderColor!=null?v.borderColor:null),n(l)&&(l=v.borderWidth!=null?v.borderWidth:null),a<0||l<0?a=l=null:a!=null&&l==null&&(l=1),n(s)&&(s=v.indicatorColor!=null?v.indicatorColor:t.moon),n(f)&&(f=v.indicatorPressColor!=null?v.indicatorPressColor:t.lighter),n(u)&&(u=v.indicatorScale!=null?v.indicatorScale:1),n(y)&&(y=v.indicatorRadius!=null?v.indicatorRadius:null),n(k)&&(k=v.innerCircle!=null?v.innerCircle:!0),n(g)&&(g=v.innerScale!=null?v.innerScale:.5),n(O)&&(O=v.activeRadius!=null?v.activeRadius:r),n(T)&&(T=v.clamp!=null?v.clamp:!0),n(E)&&(E=v.logo!=null?v.logo:!1);var w=this;this.axis=e,this.outer=new t.Circle(r/2,i,a,l).addTo(this);var b=this.inner=new t.Circle(r*g/2,"rgba(0,0,0,.2)").center(this);E&&(this.logo=new t.Label({text:"D",bold:!0}).center(b).mov(1,2).alp(.3));var X=new t.Container().addTo(this),Y=(r-l)*.2*u,m=8;e=="vertical"?m=2:e=="horizontal"?(m=2,X.rotation=90):e=="both"&&(m=4),t.loop(m,function(K,ne){new t.Triangle(Y,Y,Y,s).addTo(X).reg(null,n(y)?(r-l)*.475:y).rot(K*360/ne)});var j=0,S=0,_;w.dirX=0,w.dirY=0;var R,U=!0;this.on("mousedown",function(K){R=K,X.loop(function(ne){ne.color=f}),U?w.ticker=t.Ticker.add(function(){Z()}):t.Ticker.add(w.ticker)}),this.on("pressmove",function(K){R=K}),this.on("pressup",function(){t.Ticker.remove(w.ticker),w.dirX=w.dirY=0,X.loop(function(K){K.color=s}),w.stage&&w.stage.update()});function Z(){var K=R;j=K.stageX/t.scaX,S=K.stageY/t.scaY,_=w.globalToLocal(j,S),K=new Fe.Event("change"),K.dirX=((_.x+O)/(O*2)-.5)*2,K.dirY=((_.y+O)/(O*2)-.5)*2,T&&(K.dirX=t.constrain(K.dirX,-1,1),K.dirY=t.constrain(K.dirY,-1,1)),w.dirX=K.dirX,w.dirY=K.dirY,w.dispatchEvent(K)}this._enabled=!0,Object.defineProperty(w,"enabled",{get:function(){return w._enabled},set:function(K){Ot(w,K)}}),A!==!1&&t.styleTransforms(this,v),this.clone=function(){return w.cloneProps(new t.DPad(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,this.group,d))},this.dispose=function(K,ne,V){return this.ticker&&t.Ticker.remove(this.ticker),V||this.zimContainer_dispose(!0),!0}},t.extend(t.DPad,t.Container,["clone","dispose"],"zimContainer",!1),t.Radial=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o){var I="labels, size, font, height, coreRadius, coreColor, startAngle, totalAngle, angles, flip, shiftRadial, icons, rollIcons, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, selectedIndex, style, group, inherit",N;if(N=st(t.Radial,arguments,I,this))return N;De("66.4"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Radial",this.group=h;var p=c===!1?{}:t.getStyle(this.type,this.group,o);n(e)&&(e=p.labels!=null?p.labels:["A","B","C","D","E"]),n(r)&&(r=p.size!=null?p.size:30),n(i)&&(i=p.font!=null?p.font:"verdana"),n(f)&&(f=p.startAngle!=null?p.startAngle:null),n(u)&&(u=p.totalAngle!=null?p.totalAngle:360),n(y)&&(y=p.angles!=null?p.angles:null),n(k)&&(k=p.flip!=null?p.flip:!0),n(g)&&(g=p.shiftRadial!=null?p.shiftRadial:0),n(O)&&(O=p.icons!=null?p.icons:null),n(T)&&(T=p.rollIcons!=null?p.rollIcons:null),n(E)&&(E=p.rotateIcons!=null?p.rotateIcons:!1),n(A)&&(A=p.iconsShiftRadial!=null?p.iconsShiftRadial:0),n(l)&&(l=p.height!=null?p.height:60),n(a)&&(a=p.coreRadius!=null?p.coreRadius:100),n(s)&&(s=p.coreColor!=null?p.coreColor:t.dark),n(v)&&(v=p.backdropColor!=null?p.backdropColor:t.clear),n(C)&&(C=p.backgroundColor!=null?p.backgroundColor:t.granite),n(d)&&(d=p.rollBackgroundColor!=null?p.rollBackgroundColor:t.tin),n(x)&&(x=p.selectedBackgroundColor!=null?p.selectedBackgroundColor:t.charcoal),n(P)&&(P=p.selectedRollBackgroundColor!=null?p.selectedRollBackgroundColor:x),n(w)&&(w=p.color!=null?p.color:t.white),n(b)&&(b=p.rollColor!=null?p.rollColor:w),n(X)&&(X=p.selectedColor!=null?p.selectedColor:w),n(Y)&&(Y=p.selectedRollColor!=null?p.selectedRollColor:b),n(m)&&(m=p.borderColor!=null?p.borderColor:t.dark),n(j)&&(j=p.borderWidth!=null?p.borderWidth:2),n(R)&&(R=p.gapAsAngle!=null?p.gapAsAngle:!1),n(_)&&(_=p.gap!=null?p.gap:R?3:6),n(S)&&(S=p.gradient!=null?p.gradient:null),S===!0&&(S=.1),n(U)&&(U=p.spacing!=null?p.spacing:6),n(Z)&&(Z=p.spacingInner!=null?p.spacingInner:U),n(K)&&(K=p.spacingOuter!=null?p.spacingOuter:U),n(ne)&&(ne=p.currentEnabled!=null?p.currentEnabled:!1),n(V)&&(V=p.currentSelected!=null?p.currentSelected:!0);var L=this,we=this.innerRadius=a+Z,B=this.outerRadius=we+l;this.setBounds(-B,-B,B*2,B*2);var F=this.backdrop=new t.Circle(B+K,v).center(this);if(a>0&&(this.core=new t.Circle(a,s).center(this)),y&&y.length<e.length-1)return vt&&tt("Radial() - not enough angles provided"),this;if(e&&e.length>0||O&&O.length>0){var fe;if(e&&e.length>0&&(fe=e.length),O&&O.length>0&&(fe>0?fe=Math.min(O.length,fe):fe=O.length),T&&T.length<fe)for(var se=0;se<fe-T.length;se++)T.push(new t.Circle(1,t.clear));var Q=F.width,te=this.buttons=new t.Container(-Q/2,-Q/2,Q,Q).centerReg(this),le=_;R||(_=_/B*180/Math.PI,le=le/we*180/Math.PI);for(var Ae=(u-_*fe+(u==360?0:_))/fe,J=f||0,Te=0;Te<fe;Te++){y&&(Ae=y[Te]);var G=new t.Shape(-Q/2,-Q/2,Q,Q).centerReg(te);G.num=Te,G.zimSelected=!1,G.angle=Ae;var ce=G.graphics;G.backgroundColor=t.Pick.choose(C),G.rollBackgroundColor=t.Pick.choose(d),G.selectedBackgroundColor=t.Pick.choose(x),G.selectedRollBackgroundColor=t.Pick.choose(P),G.color=t.Pick.choose(w),G.rollColor=t.Pick.choose(b),G.selectedColor=t.Pick.choose(X),G.selectedRollColor=t.Pick.choose(Y),G.colorCommand=ce.f(G.backgroundColor).command,(n(j)||j>0)&&(!n(m)||!n(j))&&(n(m)&&(m=t.black),G.borderColorCommand=ce.s(m).command,G.borderWidthCommand=ce.ss(j).command);var q=(J-90-Ae/2)*Math.PI/180,ue=(J-90+Ae/2)*Math.PI/180,ge=(J-90+(Ae+_-le)/2)*Math.PI/180,ie=(J-90-(Ae+_-le)/2)*Math.PI/180;if(ce.arc(0,0,B,q,ue,!1),ce.arc(0,0,we,ge,ie,!0).cp(),S&&(ce.s().ss().rf(["rgba(0,0,0,"+S+")","rgba(255,255,255,"+S+")"],[0,1],0,0,we,0,0,B),ce.arc(0,0,B,q,ue,!1),ce.arc(0,0,we,ge,ie,!0).cp()),G.cur("pointer"),G.zimOverEvent=G.on("mouseover",function(Be){var $=Be.target;$.colorCommand.style=$==L.selected&&V?$.selectedRollBackgroundColor:$.rollBackgroundColor,$.label&&($.label.color=$==L.selected&&V?$.selectedRollColor:$.rollColor),T&&($.holder.removeAllChildren(),T[$.num].loc(1,0,$.holder)),L.stage&&L.stage.update()}),G.zimOutEvent=G.on("mouseout",function(Be){var $=Be.target;$.colorCommand.style=$==L.selected&&V?$.selectedBackgroundColor:$.backgroundColor,$.label&&($.label.color=$==L.selected&&V?$.selectedColor:$.color),T&&($.holder.removeAllChildren(),O&&O[$.num].loc(1,0,$.holder)),L.stage&&L.stage.update()}),G.zimDownEvent=G.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(Be){var $=Be.target,Me=$!==L.selected;L.lastSelected=L.selected,oe=$.num,V?Me?(L.selected&&(L.selected.colorCommand.style=L.selected.backgroundColor,L.selected.label&&(L.selected.label.color=L.selected.color)),L.selected=$,L.label=$.label,L.label&&(L.text=L.label.text),L.icon=$.icon,$.colorCommand.style=$.selectedRollBackgroundColor,$.label&&($.label.color=$.selectedRollColor)):ne||(oe=-1,L.selected=null,L.label=null,L.text=null,L.icon=null,$.colorCommand.style=$.rollBackgroundColor,$.label&&($.label.color=$.rollColor)):(L.selected=$,L.label=$.label,L.label&&(L.text=L.label.text),L.icon=$.icon),L.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&L.stage&&L.stage.update()}),O&&O.length>0){var xe=we+l/2+A,Se=G.holder=new t.Container(3,xe).addTo(this).reg(1,xe).rot(J);Se.mouseChildren=!1,Se.mouseEnabled=!1,G.icon=O[Te],O[Te].loc(1,0,Se),E||(O[Te].rotation=-J)}if(e&&e.length>0){var z;if(e[Te].type!="LabelOnArc"){var pe=e[Te].type=="Label"?e[Te]:new t.Label({text:e[Te],size:r,font:i,color:w,style:c,inherit:o});z=new t.LabelOnArc({label:pe,color:w,size:r,spacing:-5,flip:k&&J>90&&J<270,radius:we+(l-pe.height)/2+2+g,style:c,inherit:o})}else z=e[Te];e[Te]=z,G.label=z,z.center(this).rot(J),z.mouseChildren=!1,z.mouseEnabled=!1}if(Te!=e.length-1){var de=y?y[Te+1]:Ae;J+=(Ae+de)/2+_}}n(f)||(L.rotation+=L.buttons.getChildAt(0).angle/2)}var oe=null;Object.defineProperty(this,"selectedIndex",{get:function(){return oe},set:function(Be){var $;L.buttons&&($=L.buttons.getChildAt(Be)),$!==L.selected&&(L.selected&&(L.selected.colorCommand.style=L.selected.backgroundColor,L.selected.label&&(L.selected.label.color=L.selected.color)),L.selected=$,$&&(V&&($.colorCommand.style=$.selectedRollBackgroundColor),$.label&&(V&&($.label.color=$.selectedColor),L.text=$.label.text))),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&L.stage&&L.stage.update()}}),n(D)&&(D=p.selectedIndex!=null?p.selectedIndex:0),L.selectedIndex=D,c!==!1&&t.styleTransforms(this,p),this.clone=function(){return L.cloneProps(new t.Radial(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,this.group,o))}},t.extend(t.Radial,t.Container,"clone","zimContainer",!1),t.RadialMenu=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o){var I="menu, size, font, height, coreRadius, coreColor, title, titleIcon, startAngle, totalAngle, flip, shiftRadial, rotateIcons, iconsShiftRadial, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, backdropColor, color, rollColor, selectedColor, selectedRollColor, borderColor, borderWidth, gradient, gap, gapAsAngle, spacing, spacingInner, spacingOuter, currentEnabled, currentSelected, open, under, style, group, inherit",N=I.split(", "),p=!1;if(e&&e.constructor==={}.constructor){for(var L in e)if(N.indexOf(L)>=0){p=!0;break}}if(e&&p){var we;if(we=st(t.RadialMenu,arguments,I,this))return we}De("66.6"),this.zimContainer_constructor(null,null,null,null,!1),this.type="RadialMenu",this.group=h;var B=c===!1?{}:t.getStyle(this.type,this.group,o);n(e)&&(e=B.menu!=null?B.menu:{A:{A1:["AA1","AA2","AA3","AA4"],A2:[],A3:[]},B:["B1","B2","B3","B4","B5","B6"],C:[]}),n(r)&&(r=B.size!=null?B.size:30),n(i)&&(i=B.font!=null?B.font:"verdana"),n(y)&&(y=B.startAngle!=null?B.startAngle:null),n(k)&&(k=B.totalAngle!=null?B.totalAngle:360),n(g)&&(g=B.flip!=null?B.flip:!0),n(T)&&(T=B.rotateIcons!=null?B.rotateIcons:!1),n(O)&&(O=B.shiftRadial!=null?B.shiftRadial:0),n(E)&&(E=B.iconsShiftRadial!=null?B.iconsShiftRadial:0),n(l)&&(l=B.height!=null?B.height:60),n(a)&&(a=B.coreRadius!=null?B.coreRadius:100),n(s)&&(s=B.coreColor!=null?B.coreColor:t.dark),n(f)&&(f=B.title!=null?B.title:"MENU"),n(u)&&(u=B.titleIcon!=null?B.titleIcon:null),n(P)&&(P=B.backdropColor!=null?B.backdropColor:t.clear),n(A)&&(A=B.backgroundColor!=null?B.backgroundColor:t.granite),n(C)&&(C=B.rollBackgroundColor!=null?B.rollBackgroundColor:t.tin),n(d)&&(d=B.selectedBackgroundColor!=null?B.selectedBackgroundColor:t.charcoal),n(x)&&(x=B.selectedRollBackgroundColor!=null?B.selectedRollBackgroundColor:d),n(v)&&(v=B.color!=null?B.color:t.white),n(w)&&(w=B.rollColor!=null?B.rollColor:v),n(b)&&(b=B.selectedColor!=null?B.selectedColor:v),n(X)&&(X=B.selectedRollColor!=null?B.selectedRollColor:w),n(Y)&&(Y=B.borderColor!=null?B.borderColor:t.dark),n(m)&&(m=B.borderWidth!=null?B.borderWidth:2),n(_)&&(_=B.gapAsAngle!=null?B.gapAsAngle:!1),n(S)&&(S=B.gap!=null?B.gap:_?3:6),n(R)&&(R=B.spacing!=null?B.spacing:6),n(j)&&(j=B.gradient!=null?B.gradient:null),j===!0&&(j=.1),n(U)&&(U=B.spacingInner!=null?B.spacingInner:R),n(Z)&&(Z=B.spacingOuter!=null?B.spacingOuter:R),n(K)&&(K=B.currentEnabled!=null?B.currentEnabled:!1),n(ne)&&(ne=B.currentSelected!=null?B.currentSelected:!0),n(V)&&(V=B.open!=null?B.open:!1),n(D)&&(D=B.under!=null?B.under:!0);var F=this,fe=(Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",se=null,Q=this.core=new t.Circle({radius:a,color:s,style:c,inherit:o}).addTo(this);u&&(this.titleIcon=u.center(Q)),f&&(this.title=new t.Label({text:f,size:r,font:i,color:v,style:c,inherit:o}).center(Q)),Q.cur("pointer"),Q.on(fe,function(){F.leafNode=!1,J.length==0?Te():(t.loop(J,function(ce){ce.selectedIndex=-1,ce.removeFrom(),J=[]}),F.outerLevel=0,F.selected=F.outerMenu=F.selectedMenu=F.text=null),(K||F.selected!=se)&&F.dispatchEvent("change"),se=F.selected,F.stage&&F.stage.update()}),this.closeRings=function(ce){n(ce)&&(ce=F.outerLevel);var q=F.outerLevel-ce;t.loop(J,function(ue,ge){ge>q-1&&(ue.removeFrom(),ue.selectedIndex=-1,J.pop())},!0),F.outerLevel=q,F.outerMenu=J[J.length-1],F.outerMenu&&(F.outerMenu.selectedIndex=-1),F.selected=F.selectedMenu=F.text=null,J[J.length-2]?(F.selectedMenu=J[J.length-2],F.selectedIndex=F.selectedMenu.selectedIndex):F.selectedIndex=-1,F.selected!=se&&F.dispatchEvent("change"),se=F.selected,F.stage&&F.stage.update()};var te={},le,Ae;F.outerLevel=0,e.constructor=={}.constructor&&(e={core:e},le=F.tree=new t.Hierarchy(e),Ae=le.getLinearIDs()),F.lastRadial=null;var J=this.radials=[];V&&Te();function Te(ce){var q,ue;ce?q=ce.ringLevel:(q=0,ue=a),t.loop(J,function(xe,Se){Se>q-1&&(xe.removeFrom(),xe.selectedIndex=-1,J.pop())},!0);var ge;if(ce&&(ge=ce.selected),ge){var ie=ge.id;ue=ce.outerRadius,G(ie,q+1,ue)}else ce||G("id0",q+1,ue);F.selected=ge,F.selected?(F.selectedMenu=J[F.selected.menu.ringLevel-1],F.selectedIndex=F.selected.num,F.selected.label?F.text=F.selected.label.text:F.text=null):K&&ce?(F.selectedIndex=ce.selectedIndex,F.label=ce.label,F.text=ce.text,F.icon=ce.icon,F.selectedMenu=ce):(F.text=null,F.selectedIndex=-1,F.selectedMenu=null),F.stage&&F.stage.update()}function G(ce,q,ue){q&&(F.outerLevel=q);var ge;if(!te[ce]){var ie=le.getData(ce),xe=ie.list;if(xe&&!t.isEmpty(xe)){var Se={labels:le.getLinearList(xe),coreRadius:ue,size:r,font:i,startAngle:y,totalAngle:k,flip:g,rotateIcons:T,shiftRadial:O,iconsShiftRadial:E,height:l,coreColor:t.clear,backdropColor:P,backgroundColor:A,rollBackgroundColor:C,selectedBackgroundColor:d,selectedRollBackgroundColor:x,color:v,rollColor:w,selectedColor:b,selectedRollColor:X,borderColor:Y,borderWidth:m,gapAsAngle:_,gap:S,gradient:j,spacingInner:U,spacingOuter:Z,currentSelected:ne,currentEnabled:K,style:c,inherit:o};ie.styles&&(Se=t.merge(Se,ie.styles)),ge=te[ce]=new t.Radial(Se),Ae=le.getLinearIDs(xe),ge.buttons.loop(function(z,pe){z.menu=ge,z.id=Ae[pe]}),ge.ringLevel=F.outerLevel,ge.selectedIndex=-1,ge.on("change",function(z){F.leafNode=!1,Te(z.target),(K||F.selected!=se)&&F.dispatchEvent("change"),se=F.selected})}}te[ce]?(J.push(te[ce]),te[ce].center(F),D&&te[ce].bot()):(F.leafNode=!0,F.outerLevel-=1),F.outerMenu=ge}c!==!1&&t.styleTransforms(this,B),this.clone=function(){return F.cloneProps(new t.RadialMenu(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,this.group,o))}},t.extend(t.RadialMenu,t.Container,"clone","zimContainer",!1),t.ColorPicker=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R){var U="width, colors, cols, spacing, greyPicker, alphaPicker, startBackgroundColor, draggable, shadowColor, shadowBlur, buttonBar, circles, indicator, backgroundColor, keyArrows, container, selectedIndex, selectedColor, dropperTarget, spectrumCollapse, spectrumMode, spectrumClose, spectrumOk, spectrumTitle, tolerancePicker, collapsed, style, group, inherit",Z;if(Z=st(t.ColorPicker,arguments,U,this))return Z;De("67"),this.zimContainer_constructor(null,null,null,null,!1),this.type="ColorPicker",this.group=_;var K=S===!1?{}:t.getStyle(this.type,this.group,R),ne;n(e)&&(e=K.width!=null?K.width:500),n(r)&&(r=K.colors!=null?K.colors:"spectrum"),r=="legacy"&&(ne=!0),n(i)&&(i=K.cols!=null?K.cols:10),n(l)&&(l=K.spacing!=null?K.spacing:2);var V=!ne&&r.length>0&&r.length<=i;r=="spectrum"&&(i=10,l=2,V=!1),n(s)&&(s=K.alphaPicker!=null?K.alphaPicker:!V),n(m)&&(m=K.tolerancePicker!=null?K.tolerancePicker:!1),m&&(s=!1),n(a)&&(a=K.greyPicker!=null?K.greyPicker:!V),n(y)&&(y=K.shadowColor!=null?K.shadowColor:"rgba(0,0,0,.3)"),n(k)&&(k=K.shadowBlur!=null?K.shadowBlur:14),n(g)&&(g=K.buttonBar!=null?K.buttonBar:!V),n(u)&&(g||r=="spectrum"?u=K.draggable!=null?K.draggable:!0:u=K.draggable!=null?K.draggable:!1),n(O)&&(O=K.circles!=null?K.circles:!1),n(T)&&(T=K.indicator!=null?K.indicator:!1,g||(T=K.indicator!=null?K.indicator:!0)),n(E)&&(E=K.backgroundColor!=null?K.backgroundColor:t.black),n(f)&&(f=K.startBackgroundColor!=null?K.startBackgroundColor:null),n(A)&&(A=K.keyArrows!=null?K.keyArrows:!0),n(P)&&(P=K.dropperTarget!=null?K.dropperTarget:!1),n(v)&&(v=K.spectrumCollapse!=null?K.spectrumCollapse:!0),n(w)&&(w=K.spectrumMode!=null?K.spectrumMode:!0),n(b)&&(b=K.spectrumClose!=null?K.spectrumClose:!0),n(X)&&(X=K.spectrumOk!=null?K.spectrumOk:!0),n(Y)&&(Y=K.spectrumTitle!=null?K.spectrumTitle:null),n(j)&&(j=K.collapsed!=null?K.collapsed:!1);var D=this;if(n(C))if(ee.zdf)C=ee.zdf.stage;else return;else if(C.getBounds){if(n(C.getStage))return}else return;D.container=C;var c="#e472c4",h="#50c4b7",o=1,I=1,N=new t.Shape;this.addChild(N),N.x+=l,N.y+=l,ne=!1;var p,L,we=[],B,F,fe,se,Q,te=r=="spectrum";if(n(r)||r=="legacy"||r=="spectrum"){ne=!0;var le=6,Ae=le*le*le;le=Math.ceil(Math.pow(Ae,1/2)),L=(e-l)/18-l,Q=Math.floor(Math.pow(le*le,1/3)),p=[];for(var J=0;J<6;J++)for(var Te=0;Te<6;Te++)for(var G=0;G<6;G++)p.push("#"+xe(J*3)+xe(Te*3)+xe(G*3));for(r=[],J=0;J<p.length;J++)B=Math.floor(J/6),F=J%6,B>=6*3?Q=1:Q=0,fe=B-Q*6*3,se=F+Q*6,r[se*18+fe]=p[J];i=18,we=[h,c]}else L=(e-l)/i-l;var ce=Math.ceil(r.length/i),q=1,ue=String(r[r.length-1]);if(!n(f)){var ge=f.match(/rgba\((.*)\)/);ge&&(B=ge[1].split(","),q=B.pop(),f="rgb("+B.join(",")+")"),ue=String(f)}var ie;ne&&(ie=h);function xe(wt){return wt=Math.floor(wt).toString(16),wt+""+wt}Q=0;var Se=N.graphics,z,pe,de=K.borderColor!=null?K.borderColor:null,oe=K.borderWidth!=null?K.borderWidth:null;!n(de)&&n(oe)&&(oe=1),oe&&n(de)&&(de=t.dark),oe&&Se.s(de).ss(oe);var Be=r.length;for(te&&(Be=56),J=0;J<Be;J++)B=J%i,F=Math.floor(J/i),z=B*(L+l),pe=F*(L+l),O?Se.f(r[J]).dc(z+L/2,pe+L/2,L/2):Se.f(r[J]).r(z,pe,L,L);var $=pe+L+l;D.colors=r;var Me=$;if(a){for(J=0;J<16;J++)we.push("#"+xe(J)+xe(J)+xe(J));for(J=0;J<we.length;J++)B=Math.floor(J/i),F=J%i,z=F*(L+l),pe=B*(L+l)+$,O?Se.f(we[J]).dc(z+L/2,pe+L/2,L/2):Se.f(we[J]).r(z,pe,L,L);$=pe+L+l;var be=i,me=Math.ceil(we.length/i)}D.greys=we,T&&!te&&(T=this.indicator=O?new t.Circle(L/2*.5,null,null,null,null,null,null,null,!1):new t.Rectangle(L*.5,L*.5,null,null,null,null,null,null,null,!1),T.alpha=.5,T.centerReg(),this.addChild(T),T.mouseEnabled=!1,re(r.indexOf(ue)));function re(wt){if(n(wt)||wt<0){T.visible=!1;return}else T.visible=!0;ue=="#000"||ue=="#000000"||ue=="black"?(T.color="#222",T.alpha=1):(T.color="black",T.alpha=.5),T.x=N.x+wt%i*(L+l)+L/2,T.y=N.x+Math.floor(wt/i)*(L+l)+L/2}var ke=10,Re=$;if(s||m){var Ye=new t.Container({style:!1});Ye.setBounds(0,0,600,70),this.addChild(Ye),Ye.x=0,Ye.y=$;var $e=this.alphaBacking=new t.Rectangle(600-ke*2,50,t.licorice,null,null,0,null,null,null,!1);Ye.addChild($e),t.centerReg($e,Ye);var it=this.alphaBut=new t.Button({width:20,height:30,backgroundColor:"darkorange",rollBackgroundColor:"orange",label:"",corner:0,hitPadding:20,style:!1}),Le=this.alphaSlider=new t.Slider({min:0,max:1,step:m?0:.05,button:it,barLength:m?500*.55:600*.55,barWidth:2,barColor:t.silver,vertical:!1,useTicks:!1,inside:!1,style:!1});Le.currentValue=n(q)?1:q,m&&(Le.currentValue=.1),Ye.addChild(Le),Le.x=40,Le.y=Ye.height/2;var Ze=this.alphaText=new t.Label({text:m?"Tolerance: 0.1":"Alpha: "+t.decimals(q),size:30,color:"orange",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",rollColor:"orange",group:this.group});Ye.addChild(Ze),Ze.x=Le.x+Le.bar.width+40,Ze.y=Ye.height/2-Ze.height/2,Ye.scaleX=Ye.scaleY=e/600,Le.on("change",function(){Ze.text=m?"Tolerance: "+Ut(Le.currentValue):"Alpha: "+Ut(Le.currentValue),s&&Xe&&(Xe.alpha=I=Le.currentValue),D.dispatchEvent("change"),D.stage&&D.stage.update()}),$+=Ye.height-ke,m&&(D.toleranceBacking=D.alphaBacking,D.toleranceBut=D.alphaBut,D.toleranceSlider=D.alphaSlider,D.alphaBacking=D.alphaBut=D.alphaSlider=null)}if(g){var ze=new t.Container({style:!1});ze.setBounds(0,0,600,100),this.addChild(ze),ze.x=0,ze.y=$+ke;var ve=this.swatchText=new t.TextInput({align:"left",selectionAlpha:.5,text:ue.toUpperCase(),width:140,size:30,color:"orange",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group});if(ve.on("input",function(){(ve.text.length==4||ve.text.length==7)&&(Xe.color=ve.text,ue=Xe.color,D.dispatchEvent("change"))}),ze.addChild(ve),t.centerReg(ve),ve.x=200/2-10,ve.y=50-2,u){var Pe=this.grip=new t.Shape({style:!1});Pe.cur("pointer"),ze.addChild(Pe),Pe.graphics.f("rgba(256,256,256,.25)").r(0,0,5,20).r(10,0,5,20).r(20,0,5,20).r(30,0,5,20),Pe.x=70,Pe.y=65,ve.y=50-10,Pe.mouseEnabled=!1}var ae=this.closeBut=new t.Button({width:90,height:90,label:"X",backgroundColor:t.licorice,rollBackgroundColor:t.charcoal,corner:0,style:!1});ze.addChild(ae),ae.x=600-ae.width-ke,ae.y=0,ae.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){D.hide(),D.dispatchEvent("close")});var Ne=this.okBut=new t.Button({width:150,height:90,label:"OK",backgroundColor:t.licorice,rollBackgroundColor:t.charcoal,corner:0,style:!1});ze.addChild(Ne),Ne.x=ae.x-Ne.width-ke,Ne.y=0,Ne.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){yt(),D.dispatchEvent("ok")});var Ke=this.swatchBacking=new t.Shape({style:!1});ze.addChild(Ke),Se=Ke.graphics,Se.f(t.black).r(.5,.5,50,89).f(t.granite).r(50,.5,50,89).f(t.white).r(100,.5,49.5,89),Ke.x=Ne.x-150-ke,Ke.y=0;var Xe=this.swatch=new t.Rectangle(150,90,ue,null,null,null,null,null,null,!1);ze.addChild(Xe),Xe.x=Ke.x,Xe.y=0,Xe.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){D.dispatchEvent("swatch")}),Xe.cur("pointer"),Xe.alpha=I=q,ze.scaleX=ze.scaleY=e/600,$+=ze.height}else N.cur("pointer");!s&&!g&&($-=ke-l);var Qe=$+ke;this.setBounds(0,0,e,Qe);var he=this.background=new t.Rectangle(e,Qe,E,null,null,null,null,null,null,!1);this.addChildAt(he,0),y!=-1&&k>0&&(he.shadow=new Fe.Shadow(y,8,8,k));var je=ee.zdf,Ge,Ie=!1;if(this.dropperTarget=P,te){r="spectrum";var _e=30,Je=20,Oe=Re-_e+1,Ve=Oe-Je+1,rt=D.bar=new t.Rectangle(D.width,_e+1,t.black).addTo(D);Y&&(D.title=new t.Label(Y,18,null,t.light).pos(12,1,LEFT,CENTER,D.bar).noMouse()),u&&rt.cur();var Ce=new t.Container(D.width,Oe).loc(0,_e,D),We=new t.Rectangle(D.width,Ve,new t.GradientColor(["rgb(255 0 0)","rgb(255 255 0)","rgb(0 255 0)","rgb(0 255 255)","rgb(0 0 255)","rgb(255 0 255)","rgb(255 0 0)"],[0,1/6,2/6,3/6,4/6,5/6,6/6],0,0,500,0)).addTo(Ce).mov(0,Je-1);new t.Rectangle(D.width,Ve/2,new t.GradientColor(["rgba(255,255,255,1)","rgba(255,255,255,0)"],[0,1],0,0,0,Ve/2)).loc(We,null,Ce),new t.Rectangle(D.width,Ve/2+.5,new t.GradientColor(["rgba(0,0,0,1)","rgba(0,0,00,0)"],[1,0],0,0,0,Ve/2+.5)).loc(We,null,Ce).mov(0,Ve/2),new t.Rectangle(D.width,20,new t.GradientColor(["black","white"],[.1,.9],0,0,D.width,0)).addTo(Ce);var lt=D.gradient=new t.Bitmap(Ce).loc(Ce,null,D).cur("none"),Ue=D.pixels=new t.Pixel(Ce,.5).loc(Ce,null,D).vis(!1).cur("none");Ce.dispose();var ct;!g&&b&&(ct=D.closeIcon=new t.Shape(-40,-40,80,80,null,!1),ct.graphics.f(t.light).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),ct.sca(.25).expand(10,10,10,1).pos(7,0,t.RIGHT,t.CENTER,rt).cur().addTo(D),ct.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){D.hide(),D.dispatchEvent("close")}));var ot=D.collapseIcon=new t.Triangle(20,20,20,t.faint,t.light,2).expand(10,10,10,1).pos(40+(ct?30:0),0,t.RIGHT,t.CENTER,rt).cur().addTo(D);ot.on("mousedown",function(){D.collapse(ot.rotation==0)});var dt=new t.Rectangle(20,20,t.white).reg("center");new t.Tile(new t.Rectangle(10,10,t.series(t.silver,t.white,t.white,t.silver)),2,2,0,0).addTo(dt),dt.mouseChildren=!1;var et=D.modeIcon=new t.Button({width:20,height:20,shadowColor:-1,label:"",backing:dt,toggleEvent:"mousedown",toggleBacking:new t.Rectangle(20,20,new t.GradientColor([t.white,t.grey],[0,1],0,0,20,20)).reg("center")}).pos(8+(ct?30:0),5,t.RIGHT,t.TOP,D).expand(10,10,10,1);et.on("mousedown",function(){Ue.vis(et.toggled),D.spectrumToggled=!et.toggled,je.stage.update()}),w||(et.removeFrom(),ot.mov(28)),v||ot.removeFrom(),X||D.okBut&&D.okBut.removeFrom(),!b&&ae&&ae.removeFrom();var St=new t.Rectangle(D.width,D.height-Oe-_e,t.faint).pos(0,0,t.LEFT,t.BOTTOM,D).noMouse(),ht=this.dropper=new t.Circle(10,t.clear,t.white,8);new t.Circle(5,t.clear,t.black,2).center(ht),new t.Circle(7,t.clear,t.white,2).center(ht),ht.noMouse()}this.updateDropperTarget=function(){ht.vis(!1),kt(),ht.vis(!0).top()},this.spectrumToggled=te,this.toggleSpectrum=function(wt){wt!=D.spectrumToggled&&(n(wt)&&(wt=!D.spectrumToggled),D.spectrumToggled=wt,et.toggle(!wt),Ue.vis(!wt),D.updateDropperTarget())};var gt=!1;function Bt(){je.stage.mouseInBounds?ht.alp(1):ht.alp(0),ht.loc(je.mouseX,je.mouseY,je.stage),gt=D.spectrumToggled?lt.hitTestReg(ht):Ue.hitTestReg(ht);var wt;D.dropperTarget?wt=ht.x>=Ge.x&&ht.x<=Ge.x+Ge.width&&ht.y>=Ge.y&&ht.y<=Ge.y+Ge.height:wt=!1;var Vt;if(D.dropperTarget?Vt=(gt||wt)&&!St.hitTestReg(ht)&&!rt.hitTestReg(ht):Vt=gt,!Ie&&Vt)Dt(wt);else if(Ie&&!Vt){Ht(),je.stage.update();return}if(Vt){var yn;if(gt)yn=D.spectrumToggled?lt:Ue;else if(D.dropperTarget)yn=Ge;else return;var $t=yn.globalToLocal(je.mouseX,je.mouseY),an=yn.getColorAt($t.x,$t.y,!0),Rn="rgba("+an[0]+","+an[1]+","+an[2]+","+an[3]+")";an[3]<.05&&(Rn=je.color),ht.borderColor=Rn,je.stage.update()}}function Dt(wt){Ie=!0,wt&&kt(),ht.vis(!0).top()}function Ht(){Ie=!1,Ge.dispose(),ht.vis(!1)}this.collapsed=!1,this.collapse=function(wt){n(wt)&&(wt=!0),wt!=D.collapsed&&(D.collapsed=wt,wt?(et.enabled=!1,ot.rot(180),D.background.vis(!1),lt.vis(!1),St.vis(!1),N.visible=!1,Ue&&Ue.vis(!1),Ye&&Ye.vis(!1),g&&ze.vis(!1),Ie=!1,en(),Qt(),D.dispatchEvent("collapsed")):(et.enabled=!0,ot.rot(0),D.background.vis(!0),lt.vis(!0),St.vis(!0),N.visible=!0,D.spectrumToggled||Ue.vis(!0),Ye&&Ye.vis(!0),g&&ze.vis(!0),Ie=!0,nn(),kt(),rt.hitTestReg(ht)&&Qt(),D.dispatchEvent("expanded")),je.stage.update())},te&&v&&(D.collapseEvent=rt.on("dblclick",function(){D.collapsed?D.collapse(!1):D.collapse(!0)})),te&&j&&v&&(D.vis(!1),setTimeout(function(){D.collapse(!0),D.vis(!0),D.stage&&D.stage.update()},50));function nn(){en(),D.dropperDown=je.stage.on("stagemousedown",Bt),D.dropperMove=je.stage.on("stagemousemove",Bt),D.dropperUp=je.stage.on("stagemouseup",function(){Bt(),Xe&&te&&gt&&Xe.color!=ht.borderColor&&He()})}function en(){D.dropperDown&&je.stage.off("stagemousedown",D.dropperDown),D.dropperMove&&je.stage.off("stagemousemove",D.dropperMove),D.dropperUp&&je.stage.off("stagemouseup",D.dropperUp)}function kt(){Ge&&Ge.dispose&&Ge.dispose();var wt=new t.Rectangle(je.width,je.height,je.color).addTo(je.stage,0),Vt;D.dropperTarget&&D.dropperTarget.getBounds&&D.dropperTarget.type&&!D.dropperTarget.type.includes("Stage")?Vt=D.dropperTarget.boundsToGlobal():Vt=je.stage.getBounds(),Ge=new t.Bitmap(je.stage,Vt.width,Vt.height,Vt.x,Vt.y).loc(Vt).cur("none"),wt.dispose(),Ge.on("mousedown",He)}function Qt(){Ge&&Ge.dispose&&Ge.dispose(),ht.vis(!1)}function He(){ht.vis(!1),D.currentValue=t.convertColor(ht.borderColor,"hex"),D.dispatchEvent("change"),Ie&&(P?(kt(),ht.vis(!0).top(),setTimeout(function(){D.updateDropperTarget(),je.stage.update()},50)):(ht.vis(!0).top(),je.stage.update()))}function yt(){if(ne&&a){h=c,c=ie;var wt=[h,c];for(J=0;J<2;J++){var Vt=N.graphics;B=Math.floor(J/i),F=J%i,z=F*(L+l),pe=B*(L+l)+Me,we[J]=wt[J],Vt.f(he.color).r(z-1,pe-1,L+2,L+2).f(wt[J]).r(z,pe,L,L)}}ie=ue,o=I,D.dispatchEvent("change"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&D.stage&&D.stage.update()}if(u){var Mt,Xt;he.on("mousedown",Yt),he.on("pressmove",ft),he.on("pressup",bt),te&&(rt.on("mousedown",Yt),rt.on("pressmove",ft),rt.on("pressup",bt))}function Yt(wt){Mt=wt.stageX/t.scaX-D.x,Xt=wt.stageY/t.scaY-D.y}function ft(wt){D.x=wt.stageX/t.scaX-Mt,D.y=wt.stageY/t.scaY-Xt,D.stage&&D.stage.update()}function bt(){D.stage&&D.stage.update()}var Gt=i*(L+l),Kt=ce*(L+l);if(a)var fn=be*(L+l),Jt=me*(L+l);N.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(wt){var Vt=t.hitTestGrid(N,Gt,Kt,i,ce,wt.stageX,wt.stageY,0,0,l,l);n(Vt)||(ue=r[Vt],g&&(Xe.color=ue,ve.text=String(r[Vt]).toUpperCase()),yt()),a&&(Vt=null,Vt=t.hitTestGrid(N,fn,Jt,be,me,wt.stageX,wt.stageY,0,Kt,l,l),n(Vt)||(ue=we[Vt],g&&(Xe.color=ue,ve.text=we[Vt].toUpperCase()),yt())),T&&re(r.indexOf(ue)),g?D.stage&&D.stage.update():T&&D.stage&&D.stage.update(),jt()}),Object.defineProperty(this,"selectedColor",{get:function(){return ue},set:function(wt){wt=wt.toLowerCase(),ie=ue=wt,g&&(Xe.color=ue,ve.text=ue,D.stage&&D.stage.update()),T&&!te&&re(r.indexOf(ue)),jt()}}),Object.defineProperty(this,"currentValue",{get:function(){return ue},set:function(wt){D.selectedColor=wt}}),Object.defineProperty(this,"currentValueEvent",{get:function(){return ue},set:function(wt){wt!=D.selectedColor&&(D.selectedColor=wt,D.dispatchEvent("change"))}}),Object.defineProperty(this,"selectedIndex",{get:function(){return te?null:r.indexOf(ue)},set:function(wt){te||(ie=ue=r[wt],g&&(Xe.color=ue,ve.text=ue,D.stage&&D.stage.update()),T&&re(r.indexOf(ue)),jt())}}),Object.defineProperty(this,"selectedAlpha",{get:function(){return s?Ut(Le.currentValue):1},set:function(wt){s&&(o=Le.currentValue=wt,Xe&&(Xe.alpha=o),Ze&&(Ze.text="Alpha: "+Ut(Le.currentValue)),D.stage&&D.stage.update())}}),Object.defineProperty(this,"selectedTolerance",{get:function(){return m?Ut(Le.currentValue):1},set:function(wt){m&&(Le.currentValue=wt,D.stage&&D.stage.update())}}),Object.defineProperty(this,"colors",{get:function(){return te?"spectrum":a?r.concat(we):r},set:function(){vt&&tt("ColorPicker() colors is read only - make a new ColorPicker to change")}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==D},set:function(){Et?t.KEYFOCUS=D:ee.KEYFOCUS=D}}),A&&t.KEYFOCUS&&rn(),this.on("mousedown",function(){A&&rn()});function rn(){D.keyFocus=!0;var wt=document.activeElement;wt&&wt.blur()}function jt(){D.zimAccessibility&&D.zimAccessibility.changeTitle(D,null,!0)}this.keyDownEvent=function(wt){if(D.stage&&!te&&(D.zimAccessibility&&D.focus||!D.zimAccessibility&&D.keyFocus)){var Vt=D.selectedIndex;wt.keyCode==37||wt.keyCode==40?(Vt--,gn(Vt)):(wt.keyCode==38||wt.keyCode==39)&&(Vt++,gn(Vt))}};function gn(wt){wt<0&&(wt=D.colors.length-1),wt>D.colors.length-1&&(wt=0),D.selectedIndex=wt,D.dispatchEvent("change"),D.stage&&D.stage.update()}ee.addEventListener("keydown",this.keyDownEvent);var xt,je;this.hide=function(){return xt=D.stage,D.removeFrom(),xt&&xt.update(),D},this.on("removed",Ct);function Ct(){if(te&&(Ie=!1,en(),Qt()),D.toggled=!1,D.zimAccessibility){var wt=D.zimAccessibility;wt.resize(D),Wt?Wt.focus():D.zimTabTag.nextSibling.focus(),setTimeout(function(){wt.talk("ColorPicker has been closed.")},50)}xt&&xt.update()}var Wt,_t=!1;this.show=function(){return D.center(D.container),D};function tn(){if(D.stage&&(xt=D.stage,je=xt.frame),D.zimAccessibility){var wt=D.zimAccessibility;setTimeout(function(){wt.activatedObject&&(Wt=wt.activatedObject.zimTabTag)},50),wt.resize(D),wt.tabIndex=D.zimTabIndex}D.toggled=!0,setTimeout(function(){te&&(Ie=!0,kt(),nn(),Dt(),Bt()),D.stage&&D.stage.update()},20)}this.on("added",tn),this.toggle=function(wt){return wt===!0?D.show():wt===!1||D.container.contains(D)?D.hide():D.show(),D};function Ut(wt){return Math.round(wt*Math.pow(10,2))/Math.pow(10,2)}n(d)&&(d=K.selectedIndex!=null?K.selectedIndex:0),D.selectedIndex=d,n(x)&&(x=K.selectedColor!=null?K.selectedColor:null),x!=null?D.selectedColor=x:te&&(D.selectedColor="#888888"),S!==!1&&t.styleTransforms(this,K),this.clone=function(){return D.cloneProps(new t.ColorPicker(e,ne?null:r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,this.group,R))},this.dispose=function(wt,Vt,yn){return ee.removeEventListener("keydown",D.keyDownEvent),te&&(en(),D.gradient.cur("default"),D.pixels.cur("default"),P&&P.cur("default"),Ge.cur("default"),Ie=!1,Qt()),Le&&Le.dispose(),ht&&ht.dispose(),D.dropperDown&&je.stage.off("stagemousedown",D.dropperDown),D.dropperMove&&je.stage.off("stagemousemove",D.dropperMove),D.dropperUp&&je.stage.off("stagemouseup",D.dropperUp),yn||this.zimContainer_dispose(!0),!0}},t.extend(t.ColorPicker,t.Container,["clone","dispose"],"zimContainer",!1),t.EmojiPicker=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P){var v="width, height, emojis, monochrome, backgroundColor, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, cache, size, collapse, collapseColor, collapsed, colSize, rowSize, style, group, inherit",w;if(w=st(t.EmojiPicker,arguments,v,this))return w;De("67.05"),this.group=x;var b=d===!1?{}:t.getStyle("EmojiPicker",this.group,P);n(e)&&(e=b.width!=null?b.width:400),n(r)&&(r=b.height!=null?b.height:600),n(l)&&(l=b.monochrome!=null?b.monochrome:!1),n(a)&&(a=b.backgroundColor!=null?b.backgroundColor:t.lighter),n(s)&&(s=b.titleBar!=null?b.titleBar:"Emojis"),n(f)&&(f=b.titleBarColor!=null?b.titleBarColor:null),n(u)&&(u=b.titleBarBackgroundColor!=null?b.titleBarBackgroundColor:t.silver.toAlpha(.8)),n(y)&&(y=b.titleBarHeight!=null?b.titleBarHeight:40),n(k)&&(k=b.cache!=null?b.cache:!!t.mobile()),n(g)&&(g=b.size!=null?b.size:30),n(A)&&(A=b.colSize!=null?b.colSize:g+15),n(C)&&(C=b.rowSize!=null?b.rowSize:g+14),n(O)&&(O=b.collapse!=null?b.collapse:!1),n(T)&&(T=b.collapseColor!=null?b.collapseColor:n(f)?t.grey:f),n(E)&&(E=b.collapsed!=null?b.collapsed:!1),this.zimWindow_constructor(e,r,null,a,null,b.borderWidth!=null?b.borderWidth:2,b.padding!=null?b.padding:10,b.corner!=null?b.corner:10,null,b.scrollBarActive!=null?b.scrollBarActive:!0,b.scrollBarDrag!=null?b.scrollBarDrag:!0,null,null,null,!1,null,null,null,null,null,!0,null,null,null,null,null,null,s,f,u,y,b.draggable!=null?b.draggable:!0,null,null,b.close!=null?b.close:!0,null,null,b.fullSize!=null?b.fullSize:!1,null,b.resizeHandle!=null?b.resizeHandle:!1,O,T,E,null,null,d,x,t.copy(b)),this.type="EmojiPicker";var X=this;this.emojiData=n(i)?["\u{1F4A5}","\u{1F335}","\u{1F382}","\u{1F370}","\u{1F429}","\u{1F525}","\u{1F32B}","\u{1F30A}","\u{1F34F}","\u{1F34E}","\u{1F34B}","\u{1F34C}","\u{1F347}","\u{1F351}","\u{1F345}","\u{1F346}","\u{1F9C0}","\u{1F355}","\u{1F36C}","\u{1F36D}","\u{1F369}","\u{1F37A}","\u{1F37B}","\u{1F378}","\u{1F37E}","\u2615\uFE0F","\u{1F4A9}","\u{1F47B}","\u{1F916}","\u{1F4A4}","\u{1F440}","\u{1F483}","\u{1F483}\u{1F3FB}","\u{1F483}\u{1F3FC}","\u{1F483}\u{1F3FD}","\u{1F483}\u{1F3FE}","\u{1F483}\u{1F3FF}","\u{1F454}","\u{1F457}","\u{1F459}","\u{1F458}","\u{1F460}","\u{1F452}","\u{1F3A9}","\u{1F431}","\u{1F43B}","\u{1F436}","\u{1F43C}","\u{1F42F}","\u{1F981}","\u{1F42E}","\u{1F437}","\u{1F419}","\u{1F435}","\u{1F412}","\u{1F414}","\u{1F426}","\u{1F434}","\u{1F984}","\u{1F41D}","\u{1F422}","\u{1F420}","\u{1F410}","\u{1F54A}","\u{1F415}","\u{1F408}","\u{1F409}","\u{1F432}","\u{1F384}","\u{1F340}","\u{1F33B}","\u{1F339}","\u{1F490}","\u{1F344}","\u2600\uFE0F","\u{1F327}","\u26BD\uFE0F","\u{1F3C0}","\u{1F3C8}","\u26BE\uFE0F","\u{1F3BE}","\u{1F3D2}","\u26F7","\u{1F3C4}","\u{1F3CA}","\u{1F6B4}","\u{1F3AD}","\u{1F3A8}","\u{1F3B7}","\u{1F3BA}","\u{1F3B8}","\u{1F3BB}","\u{1F3B0}","\u{1F3B3}","\u{1F697}","\u{1F695}","\u{1F68C}","\u{1F68E}","\u{1F691}","\u{1F692}","\u{1F69C}","\u{1F682}","\u2708\uFE0F","\u26F5\uFE0F","\u{1F6F0}","\u{1F301}","\u{1F30B}","\u{1F3DE}","\u{1F305}","\u{1F386}","\u{1F308}","\u{1F3E0}","\u{1F3E5}","\u{1F3EB}","\u231A\uFE0F","\u{1F4F1}","\u{1F5A5}","\u{1F4BE}","\u{1F4FC}","\u{1F3A5}","\u260E\uFE0F","\u{1F4FA}","\u{1F4FB}","\u{1F4E1}","\u{1F56F}","\u{1F4B0}","\u{1F48E}","\u{1F6AC}","\u26B0","\u{1F52E}","\u{1F488}","\u{1F6BD}","\u{1F511}","\u{1F6CF}","\u{1F389}","\u{1F38A}","\u2764\uFE0F","\u{1F921}","\u{1F600}","\u{1F62C}","\u{1F601}","\u{1F602}","\u{1F603}","\u{1F604}","\u{1F605}","\u{1F606}","\u{1F607}","\u{1F609}","\u{1F60A}","\u{1F642}","\u{1F643}","\u263A\uFE0F","\u{1F60B}","\u{1F60C}","\u{1F60D}","\u{1F618}","\u{1F617}","\u{1F619}","\u{1F61A}","\u{1F61C}","\u{1F61D}","\u{1F61B}","\u{1F911}","\u{1F913}","\u{1F60E}","\u{1F917}","\u{1F60F}","\u{1F636}","\u{1F610}","\u{1F611}","\u{1F612}","\u{1F644}","\u{1F914}","\u{1F633}","\u{1F61F}","\u{1F620}","\u{1F614}","\u{1F615}","\u{1F641}","\u2639\uFE0F","\u{1F623}","\u{1F62B}","\u{1F629}","\u{1F631}","\u{1F628}","\u{1F630}","\u{1F62F}","\u{1F626}","\u{1F622}","\u{1F62A}","\u{1F613}","\u{1F62D}","\u{1F635}","\u{1F632}","\u{1F910}","\u{1F637}","\u{1F912}","\u{1F915}","\u{1F634}","\u{1F480}","\u2620\uFE0F","\u{1F47D}","\u{1F63A}","\u{1F638}","\u{1F639}","\u{1F63B}","\u{1F63C}","\u{1F63D}","\u{1F640}","\u{1F63F}","\u{1F63E}","\u{1F444}","\u{1F48B}","\u{1F445}","\u{1F5E3}","\u{1F464}","\u{1F465}","\u{1F456}","\u{1F463}","\u{1F461}","\u{1F462}","\u{1F45E}","\u{1F45F}","\u{1F393}","\u{1F451}","\u{1F45C}","\u{1F45B}","\u{1F4BC}","\u{1F453}","\u{1F576}","\u{1F48D}","\u{1F302}","\u2744\uFE0F","\u{1F32A}","\u26A1\uFE0F","\u{1F951}","\u{1F98B}","\u{1F648}","\u{1F649}","\u{1F64A}","\u{1F427}","\u{1F577}","\u{1F982}","\u{1F980}","\u{1F40D}","\u{1F41B}","\u{1F40C}","\u{1F41E}","\u{1F41C}","\u{1F41F}","\u{1F421}","\u{1F42C}","\u{1F433}","\u{1F40B}","\u{1F40A}","\u{1F406}","\u{1F332}","\u{1F333}","\u{1F334}","\u{1F331}","\u{1F33F}","\u{1F343}","\u{1F342}","\u{1F341}","\u{1F33A}","\u{1F33C}","\u{1F338}","\u{1F330}","\u{1F383}","\u{1F41A}","\u{1F578}","\u{1F30E}","\u{1F30D}","\u{1F30F}","\u{1F315}","\u{1F316}","\u{1F317}","\u{1F318}","\u{1F311}","\u{1F312}","\u{1F313}","\u{1F314}","\u{1F31A}","\u{1F31D}","\u{1F31B}","\u{1F31C}","\u{1F31E}","\u{1F319}","\u2B50\uFE0F","\u{1F31F}","\u{1F4AB}","\u2728","\u2604\uFE0F","\u{1F354}","\u{1F373}","\u{1F35F}","\u{1F32D}","\u{1F35D}","\u{1F32E}","\u{1F32F}","\u{1F363}","\u{1F368}","\u{1F366}","\u{1F377}","\u{1F379}","\u{1F3C6}","\u{1F3AA}","\u{1F3B9}","\u{1F680}","\u26F2\uFE0F","\u{1F3A2}","\u26F0","\u{1F3D4}","\u{1F5FB}","\u{1F4AF}","\u{1F3B5}","\u{1F3B6}","\u{1F4AC}","\u{1F4AD}","\u{1F5EF}","\u{1F0CF}","\u{1F3F3}\uFE0F\u200D\u{1F308}","\u{1F953}","\u{1F943}","\u{1F3A4}","\u{1F6A8}","\u{1F3CD}","\u{1F3D5}","\u26FA\uFE0F","\u{1F3DC}","\u{1F3D6}","\u{1F3DD}","\u{1F307}","\u{1F306}","\u{1F3D9}","\u{1F303}","\u{1F3D8}","\u{1F3E1}","\u{1F3E2}","\u{1F528}","\u2699","\u{1F52B}","\u{1F4A3}","\u{1F52A}","\u{1F48A}","\u{1F573}","\u{1F489}","\u{1F6C1}","\u26F1","\u{1F381}","\u{1F388}","\u{1F380}","\u{1F4C5}","\u{1F5F3}","\u{1F4DA}","\u270F\uFE0F","\u26AA\uFE0F","\u26AB\uFE0F","\u2B1B\uFE0F","\u2B1C\uFE0F","\u{1F5BC}","\u{1F3DA}","\u{1F3ED}","\u{1F532}","\u{1F533}","\u{1F3B1}","\u{1F53A}","\u{1F53B}","\u{1F4A6}","\u26F3\uFE0F","\u{1F3DF}","\u{1F4A1}","\u{1F52D}","\u{1F52C}","\u{1F570}","\u{1F42A}","\u{1F42B}","\u{1F418}","\u{1F438}","\u{1F430}","\u{1F42D}","\u{1F6AA}","\u{1F6CD}","\u{1F441}","\u{1F353}","\u{1F352}","\u{1F336}","\u{1F33D}","\u{1F360}","\u{1F36F}","\u{1F35E}","\u{1F36B}","\u{1F37F}","\u{1F36A}","\u{1F34A}","\u{1F3F9}","\u{1F46F}","\u{1F46F}\u200D\u2642\uFE0F","\u{1F5D1}"]:i;var Y=[];t.loop(this.emojiData,function(m){var j=new t.Emoji(m,g,l);Y.push(j)}),this.wrapper=new t.Wrapper({items:Y,width:e,alignInner:t.CENTER,valignInner:t.CENTER,wrapperType:"column",colSize:A,rowSize:C}).cur(),this.backdrop=new t.Rectangle(this.wrapper.width,this.wrapper.height,t.faint),t.timeout(.2,function(){X.scrollBar&&X.scrollBar.vertical&&X.scrollBar.vertical.getBounds()&&X.scrollBar.vertical.expand(),X.backdrop.heightOnly=X.wrapper.height,k&&X.wrapper.cache()}),this.add(this.backdrop),this.add(this.wrapper),this.wrapper.tap(function(m){X.currentEmoji=m.target,X.dispatchEvent("change")}),d!==!1&&t.styleTransforms(this,b),this.clone=function(){return X.cloneProps(new t.EmojiPicker(e,r,d,this.group,P))},this.dispose=function(){return!0}},t.extend(t.EmojiPicker,t.Window,["clone","dispose"],"zimWindow",!1),t.TextEditor=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D){var c="width, color, backgroundColor, fieldColor, fieldHeight, textSize, sizeList, optionList, colorList, fontList, live, button, titleBar, titleBarColor, titleBarBackgroundColor, titleBarHeight, wrap, limit, scroll, placeholder, password, borderColor, borderWidth, margin, corner, shadowColor, shadowBlur, draggable, boundary, frame, fontListHeight, fontListViewNum, style, group, inherit",h;if(h=st(t.TextEditor,arguments,c,this))return h;De("67.1"),this.group=V;var o=ne===!1?{}:t.getStyle("TextEditor",this.group,D);if(n(e)&&(e=o.width!=null?o.width:400),n(i)&&(i=o.backgroundColor!=null?o.backgroundColor:t.lighter),n(T)&&(T=o.titleBar!=null?o.titleBar:"Text Editor"),n(_)&&(_=o.draggable!=null?o.draggable:!0),n(C)&&(C=o.titleBarHeight!=null?o.titleBarHeight:30),n(l)&&(l=o.fieldColor!=null?o.fieldColor:i.darken(.05)),n(g)&&(g=o.live!=null?o.live:!0),n(d)&&(d=o.wrap!=null?o.wrap:!0),n(P)&&(P=o.scroll!=null?o.scroll:!0),n(Y)&&(Y=o.margin!=null?o.margin:10),n(x)&&(x=o.limit!=null?o.limit:null),n(T)&&(T=o.titleBar!=null?o.titleBar:null),n(f)&&(f=o.sizeList!=null?o.sizeList:null),n(y)&&(y=o.colorList!=null?o.colorList:null),n(u)&&(u=o.optionList!=null?o.optionList:null),n(k)&&(k=o.fontList!=null?o.fontList:null),n(l)&&(l=o.fieldColor!=null?o.fieldColor:null),n(a)&&(a=o.fieldHeight!=null?o.fieldHeight:null),n(s)&&(s=o.textSize!=null?o.textSize:null),n(Z)&&(Z=o.fontListHeight!=null?o.fontListHeight:100),n(K)&&(K=o.fontListViewNum!=null?o.fontListViewNum:3),typeof U>"u")if(ee.zdf)var U=ee.zdf;else{vt&&tt("zim.TextEditor - please provide a reference to zim Frame");return}this.zimPanel_constructor(e,300,null,T,E,A,C,i,b,X,m,!0,null,null,null,null,null,null,null,null,j,S,_,R,ne,V,D);var I=this;n(O)&&(O=new t.Button({width:50,height:50,label:"",icon:new t.Shape().sca(.4).f("white").p("AikFsQg5jmhphxIA1gXQBeBGA3CwQC8mRCpjOIBfAoQkPFGiSFpg"),color:t.white,corner:10,backgroundColor:t.green.darken(.2),borderColor:t.white,borderWidth:2,rollBackgroundColor:t.green,shadowBlur:3}).pos(Y,C+Y*2,t.RIGHT,t.TOP,I)),I.button=O,O.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",N),n(a)&&(a=o.fieldHeight!=null?o.fieldHeight:O.height+Y*2);function N(){g||(L.text=p.text),I.hide(),I.dispatchEvent("set")}var p=I.textArea=new t.TextArea({color:r,backgroundColor:l,width:e-O.width-Y*3,height:n(a)?O.height+Y*2:a,expand:10,password:w,placeholder:v,frame:U}).loc(Y,C+Y+(a&&a<O.height+Y*2?(O.height-a)/2+Y:0),null,null,!1);d||(p.tag.style.whiteSpace="nowrap"),x&&p.tag.setAttribute("maxLength",x),P&&(p.tag.style.overflowY="auto");var L=new t.Label;I.on("pressmove",function(){p.resize()}),I.on("close",function(){I.inputEvent&&p.off("input",I.inputEvent),p.removeFrom()}),I.panelHeight=C+Y+Math.max(a,O.height+Y*2)+Y;var we=t.mobile(),B=we?35:30;if(f||u||y){new t.Rectangle(e,B+Y,"rgba(0,0,0,.05)").loc(0,I.panelHeight,I);var F=[];if(y){var fe=Array.isArray(y),se=I.colorPicker=new t.ColorPicker({colors:fe?y:null,cols:fe?Math.min(y.length,12):null,alphaPicker:!1,greyPicker:!fe,container:U.stage});se.on("close",Te),se.on("change",function(){L.color=r.color=se.selectedColor,I.dispatchEvent("update"),Te()}),I.closeColorPicker=function(){Te()},r=I.swatch=new t.Rectangle(B,B,L.color,t.dark,1).cur(),r.on("mousedown",function(){I.dispatchEvent("color"),p.tag.style.display="none",se.selectedColor=r.color,se.show(),I.stage&&I.stage.update()}),F.push(r)}if(u){u===!0&&(u=["bold","italic","align"]),n(ee.STYLE)&&(ee.STYLE={}),n(ee.STYLE.group)&&(ee.STYLE.group={}),ee.STYLE.group.zimEditor={width:B,height:B,corner:0,borderColor:t.tin,shadowBlur:-1,backgroundColor:t.light,rollBackgroundColor:t.light,toggleBackgroundColor:t.green,toggleColor:t.grey};var Q,te,le;t.loop(u,function(ge){if(ge.toLowerCase()=="bold")Q=I.bold=new t.Button({label:new t.Label({text:"B",color:t.grey,size:16,bold:!0}),toggle:"B",group:"zimEditor"}),Q.on("click",function(){L.bold=Q.toggled,I.dispatchEvent("update"),I.stage&&I.stage.update()}),F.push(Q),L.bold&&Q.toggle();else if(ge.toLowerCase()=="italic")te=I.italic=new t.Button({label:new t.Label({text:"I",color:t.grey,size:16,bold:!0,italic:!0}),toggle:"I",group:"zimEditor"}),te.on("click",function(){L.italic=te.toggled,I.dispatchEvent("update"),I.stage&&I.stage.update()}),F.push(te),L.italic&&te.toggle();else if(ge.toLowerCase()=="align"){var ie=new t.Tile(new t.Rectangle(B-10,B-10,t.grey).centerReg(),3,1,10,10),xe=we?["\u21DA","\u21D4","\u21DB"]:["\u21D0","\u21D4","\u21D2"];t.loop(3,function(z){var pe=ie.getChildAt(z);new t.Label(xe[z],B*2/3,null,t.white).center(pe).expand(10)});var Se=0;L.align=="right"?Se=2:(L.align=="center"||L.align=="middle")&&(Se=1),le=I.align=new t.Selector({tile:ie,corner:0,borderWidth:1,borderColor:t.grey,backgroundColor:t.clear,selectedIndex:Se}),le.on("change",function(){le.selectedIndex==0?L.align="left":le.selectedIndex==1&&(L.align="center"),le.selectedIndex==2&&(L.align="right"),I.dispatchEvent("update"),I.stage&&I.stage.update()}),F.push(le)}}),delete ee.STYLE.group.zimEditor}if(f){var Ae=I.sizePicker=new t.Stepper({list:f===!0?null:f,stepperType:f===!0?null:"list",min:f===!0?5:null,max:f===!0?500:null,width:150,shadowBlur:-1,borderColor:t.dark,borderWidth:2,corner:0,backgroundColor:t.green,downForward:!1}).siz(null,B);Ae.arrowPrev.expand(0),Ae.textBox.color=t.lighter,Ae.on("change",function(){L.size=Ae.currentValue,I.dispatchEvent("update"),I.stage&&I.stage.update()}),Ae.currentValue=L.size,F.push(Ae)}var J=new t.Tile(F,F.length,1,10,10,!0).loc(Y,I.panelHeight+Y/2,I);I.panelHeight=I.panelHeight+Y+J.height+Y}function Te(){p.tag.style.display="block",se.hide(),I.stage&&I.stage.update()}var G;if(k){Array.isArray(k)?G=k:(G=["Arial","Courier New","Georgia","Helvetica","Palatino","Tahoma","Verdana"],we||(G=G.concat(["Comic Sans MS","Impact"])),G.sort());var ce=I.fonts=new t.List({width:e-Y*2,height:Z,viewNum:K,backgroundColor:t.moon,color:t.grey,rollColor:t.dark,rollBackgroundColor:t.green.lighten(.5),selectedBackgroundColor:t.mist,selectedRollBackgroundColor:t.green.lighten(.6),selectedColor:t.dark,backdropColor:t.light,scrollBarColor:t.dark,shadowBlur:-1,list:G}).center(I).loc(null,I.panelHeight);ce.on("change",function(){L.font=ce.currentValue,I.dispatchEvent("update"),I.stage&&I.stage.update()}),I.panelHeight=I.panelHeight+Y+ce.height+Y}I.show=function(ge,ie,xe,Se){if(I.parent)return ge==I.label||(I.label=ge),I;L=ge,p.addTo(I);var z;if(L&&L.stage)z=L.stage;else if(Se)z=Se.stage;else if(ee.zdf)z=ee.zdf.stage;else return I;return!n(ie)||!n(xe)?I.loc(ie,xe):L&&L.y>z.height/2?I.loc(z.width/2-e/2,L.y-I.panelHeight-z.height*.05,z):L&&L.y<=z.height/2?I.loc(z.width/2-e/2,L.y+L.height+z.height*.05,z):I.center(z),I.y<20&&(I.y=20),I.y+I.height>I.stage.height&&(I.y=I.stage.height-I.height-20),q(),I.stage.update(),I};function q(){L&&(p.text=L.text),r&&(r.color=L.color),Q&&Q.toggle(L.bold==!0),te&&te.toggle(L.italic==!0),le&&(le.noAnimate=!0,L.align=="center"?le.selectedIndex=1:L.align=="right"?le.selectedIndex=2:le.selectedIndex=0),Ae&&(Ae.currentValue=L.size),ce&&(ce.currentValue=L.font),I.inputEvent&&p.off("input",I.inputEvent),I.inputEvent=p.on("input",function(){g&&L&&(L.text=p.text),I.dispatchEvent("input"),I.dispatchEvent("update"),I.stage&&I.stage.update()})}I.hide=function(){if(y&&se.hide(),p&&p.removeFrom(),!n(I.stage)){var ge=I.stage;return I.removeFrom(),ge.update(),I}},ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==I},set:function(){t.KEYFOCUS=I}}),t.KEYFOCUS||ue(),this.on("mousedown",function(){ue()});function ue(){I.keyFocus=!0}Object.defineProperty(I,"label",{get:function(){return L},set:function(ge){L=ge,q()}}),ne!==!1&&t.styleTransforms(this,o),this.clone=function(){return I.cloneProps(new t.TextEditor(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,this.group,D))},this.dispose=function(ge,ie,xe){return I.inputEvent&&p.off("input",I.inputEvent),se&&se.dispose(),r&&r.dispose(),ce&&ce.dispose(),O&&O.dispose(),p&&p.dispose(),le&&le.dispose(),Q&&Q.dispose(),te&&te.dispose(),Ae&&Ae.dispose(),xe||this.zimPanel_dispose(),I.stage&&I.stage.update(),I.textArea=I.color=I.colorPicker=I.font=I.button=I.selector=I.bold=I.italic=I.size=null,!0}},t.extend(t.TextEditor,t.Panel,["clone","dispose"],"zimPanel",!1),t.Keyboard=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D){var c="labels, backgroundColor, color, shiftBackgroundColor, shiftHoldBackgroundColor, placeBackgroundColor, placeColor, cursorColor, shadeAlpha, borderColor, borderWidth, margin, corner, draggable, placeClose, shadowColor, shadowBlur, container, data, place, placeShiftH, placeShiftV, special, rtl, hardKeyboard, layout, numPadScale, numPadDraggable, numPadOnly, numPadAdvanced, maxLength, numbersOnly, style, group, inherit",h;if(h=st(t.Keyboard,arguments,c,this))return h;De("67.2"),this.zimContainer_constructor(1e3,400,null,null,!1),this.type="Keyboard",this.group=V;var o=ne===!1?{}:t.getStyle(this.type,this.group,D);n(e)&&(e=o.labels!=null?o.labels:[]),Array.isArray(e)||(e=[e]),n(r)&&(r=o.backgroundColor!=null?o.backgroundColor:t.dark),n(i)&&(i=o.color!=null?o.color:t.white),n(l)&&(l=o.shiftBackgroundColor!=null?o.shiftBackgroundColor:"orange"),n(a)&&(a=o.shiftHoldBackgroundColor!=null?o.shiftHoldBackgroundColor:"red"),n(s)&&(s=o.placeBackgroundColor!=null?o.placeBackgroundColor:t.blue),n(f)&&(f=o.placeColor!=null?o.placeColor:i),n(u)&&(u=o.cursorColor!=null?o.cursorColor:t.blue),n(y)&&(y=o.shadeAlpha!=null?o.shadeAlpha:.2),n(k)&&(k=o.borderColor!=null?o.borderColor:"rgba(0,0,0,.1)"),n(g)&&(g=o.borderWidth!=null?o.borderWidth:null),k<0||g<0?k=g=null:k!=null&&g==null&&(g=1),n(O)&&(O=o.margin!=null?o.margin:5),n(T)&&(T=o.corner!=null?o.corner:30),n(E)&&(E=o.draggable!=null?o.draggable:!1),n(A)&&(A=o.placeClose!=null?o.placeClose:!0),n(C)&&(C=o.shadowColor!=null?o.shadowColor:"rgba(0,0,0,.2)"),n(d)&&(d=o.shadowBlur!=null?o.shadowBlur:14),n(P)&&(P=o.data!=null?o.data:[[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l"],["shift","z","x","c","v","b","n","m","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]]]),P[3]||(P[3]={e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]});var I=this;n(v)&&(v=o.place!=null?o.place:!0),n(w)&&(w=o.placeShiftH!=null?o.placeShiftH:0),n(b)&&(b=o.placeShiftV!=null?o.placeShiftV:0),n(Y)&&(Y=o.rtl!=null?o.rtl:!1),n(m)&&(m=o.hardKeyboard!=null?o.hardKeyboard:!0),n(S)&&(S=o.numPadScale!=null?o.numPadScale:.8),n(R)&&(R=o.numPadOnly!=null?o.numPadOnly:!1),n(_)&&(_=o.numPadDraggable!=null?o.numPadDraggable:!0),n(U)&&(U=o.numPadAdvanced!=null?o.numPadAdvanced:!1),n(Z)&&(Z=o.maxLength!=null?o.maxLength:null),n(K)&&(K=o.numbersOnly!=null?o.numbersOnly:!1),this.maxLength=Z,this.numbersOnly=K,n(j)&&(j=o.layout!=null?o.layout:"qwerty"),j=j.toLowerCase(),j!="qwerty"&&(j=="arabic"?P=[[["\u0636","\u0635","\u062B","\u0642","\u0641","\u063A","\u0639","\u0647","\u062E","\u062D","\u062C"],["\u0634","\u0633","\u064A","\u0628","\u0644","\u0627","\u062A","\u0646","\u0645","\u0643","\u0637"],["\u0630","\u0621","\u0624","\u0631","\u0649","\u0629","\u0648","\u0632","\u0638","\u062F","back"],["?123","\u0640"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{\u0627:["\u0623","\u0625","\u0622","\u0621"],\u0649:["\u0626"],\u0621:["\u0626","\u0624"],\u0648:["\u0624"],\u0640:["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],"*":["\u064D","\u064B","\u064C","\u0652","\u064F","\u0650","\u064E","\u0651"],n:["\xF1","\u0144"]}]:j=="hebrew"?P=[[["\u05E7","\u05E8","\u05D0","\u05D8","\u05D5","\u05DF","\u05DD","\u05E4","backspace"],["\u05E9","\u05D3","\u05D2","\u05DB","\u05E2","\u05D9","\u05D7","\u05DC","\u05DA","\u05E3"],["\u05D6","\u05E1","\u05D1","\u05E0","\u05D4","\u05DE","\u05E6","\u05EA","\u05E5"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:j=="azerty"?P=[[["a","z","e","r","t","y","u","i","o","p"],["q","s","d","f","g","h","j","k","l","m"],["shift","w","x","c","v","b","n","\xB4","backspace"],["?123","@"]],[["1","2","3","4","5","6","7","8","9","0"],["!","@","#","$","/","^","&","*","(",")"],["1/2","-","'",'"',":",";",",","?","backspace"],["ABC","@"]],[["+","x","%","=","<",">","{","}","[","]"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","backspace"],["ABC","@"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]}]:j=="turkish"&&(P=[[["q","w","e","r","t","y","u","\u0131","o","p","\u011F","\xFC"],["a","s","d","f","g","h","j","k","l","\u015F","i"],["shift","z","x","c","v","b","n","m","\xF6","\xE7","backspace"],["?123","*"]],[["1","2","3","4","5","6","7","8","9","0","*"],["!","@","#","$","/","^","&","*","(",")","*"],["1/2","-","'",'"',":",";",",","?","*","backspace"],["ABC","*"]],[["+","x","%","=","<",">","{","}","[","]","*"],["\u20AC","\xA3","\xA5","$","\uFFE6","~","`","\xA4","\u2661","\u2606","*"],["2/2","_","\\","|","\u300A","\u300B","\xA1","\xBF","*","backspace"],["ABC","*"]],{e:["\u0117","\u0113","\u0119","\xEA","\xE9","\xEB","\xE8"],u:["\u016B","\xFB","\xFA","\xFC","\xF9"],i:["\u012B","\u012F","\xEC","\xED","\xEF","\xEE"],o:["\u014D","\u0153","\xF8","\xF5","\xF4","\xF3","\xF6","\xF2"],a:["\u0101","\xE3","\xE5","\xE2","\xE1","\xE4","\xE0","\xE6"],n:["\xF1","\u0144"]},{\u0131:"I",i:"\u0130"},{I:"\u0131",\u0130:"i"}])),I.data=P;var N="zim display - Keyboard(): Please pass in a reference to a container with bounds set";if(n(x))if(ee.zdf)x=ee.zdf.stage;else{tt(N);return}else if(x.getBounds){if(n(x.stage)){tt("zim display - Keyboard(): The container must have a stage property");return}}else{tt(N);return}C!=-1&&d>0&&(I.shadow=new Fe.Shadow(C,3,3,d));var p=ee.zdf?ee.zdf.stage:null;I.labels=e;var L,we=10;t.loop(P[0],function(Oe){Oe.length>we&&(we=Oe.length)});var B=we,F=["/","",",",".","numpad","away"];n(X)||F.splice(1,0,X);var fe=t.copy(P[0]);fe[3]=fe[3].concat(F);var se=t.copy(P[1]);se[3]=se[3].concat(F);var Q=t.copy(P[2]);Q[3]=Q[3].concat(F);var te=[],le=(1e3-(B-1)*5)/B,Ae={def:"default",shift:"shift",number1:"number1",number2:"number2"},J=Ae.def,Te,G,ce,q=!1,ue,ge,ie=0,xe,Se=[],z,pe,de,oe,Be,$,Me,be;$e(),Re(J),E&&it(),this.on("mousedown",me);function me(Oe){p=I.stage,G&&I.removeChild(G),xe&&Se.indexOf(Oe.target)<0&&ae(),n(Oe.target.na)||(E&&Oe.target===Me?(I.tickerMouseEvent=p.on("stagemousemove",function(Ve){I.mouseYAmount=Ve.stageY}),t.Ticker.add(Ze),I.on("pressup",ze),be=Oe.stageY-I.localToGlobal(0,0).y):!n(X)&&Oe.target.na===X?I.dispatchEvent("special"):Oe.target.na==="shift"?ke():Oe.target.toggle==="?123"?(I.removeChild(Te),Re(Ae.number1)):Oe.target.toggle==="ABC"?(I.removeChild(Te),J=Ae.def,Re(),q&&ke(!0)):Oe.target.toggle==="1/2"?(I.removeChild(Te),Re(Ae.number2)):Oe.target.toggle==="2/2"?(I.removeChild(Te),Re(Ae.number1)):Oe.target.na==="numpad"?Le(Oe.target):Oe.target.na==="away"?(I.hideKeyboard(),I.dispatchEvent("close")):P[3]&&P[3][Oe.target.na]?Ye(Oe.target.na):Oe.target.na==="return"?Ne(`
`):Oe.target.na==="backspace"||Oe.target.na==="back"?Qe():Oe.target.na===""?Ne(" "):Ne(Oe.target.na),p.update())}I.addChar=function(Oe){!n(Oe)&&Oe.match(/^.$/)&&Ne(Oe)},I.removeChar=function(){Qe(!0)},I.clearText=function(){ge.text="",Qe(!0),Xe(),I.selectedIndex=0},I.setText=function(Oe){ge.text=Oe,Xe(),I.selectedIndex=Oe.length};var re;function ke(Oe){var Ve=!1,rt,Ce;if(J===Ae.def){for(ue.color=Oe?a:l,rt=0;rt<te.length-6-(n(X)?0:1);rt++)Ce=te[rt],Ce.label.text.length>0&&(Ce.na.length===1?(P[4]&&P[4][Ce.label.text]?Ce.label.text=P[4][Ce.label.text]:Ce.label.text=Ce.label.text.toUpperCase(),Ce.label.centerReg(Ce).mov(0,6)):Ce.label.centerReg(Ce));Oe||(Ve=!0,setTimeout(We,500),re=I.on("pressup",lt)),J=Ae.shift}else{for(ue.color=r,q=!1,rt=0;rt<te.length-6;rt++)Ce=te[rt],Ce.label.text.length>0&&(Ce.na.length===1?(P[5]&&P[5][Ce.label.text]?Ce.label.text=P[5][Ce.label.text]:Ce.label.text=Ce.label.text.toLowerCase(),Ce.label.centerReg(Ce).mov(0,3)):Ce.label.centerReg(Ce));J=Ae.def}Te.updateCache(),I.stage&&I.stage.update();function We(){Ve&&(q=!0,ue.color=a,Te.updateCache(),I.stage&&I.stage.update())}function lt(){I.off("pressup",re),Ve=!1}}function Re(Oe){var Ve,rt,Ce,We=0,lt=0,Ue,ct,ot=!1,dt,et,St=!1;n(Oe)&&(Oe=Ae.def),Oe===Ae.def?Ve=fe:Oe===Ae.number1?Ve=se:Oe===Ae.number2&&(Ve=Q),I.keys=Te=new t.Container(1e3,430,null,null,!1).addTo(I).vis(!R);for(var ht=0;ht<Ve.length;ht++){(ht<=1||Oe==Ae.def&&ht==2&&Ve[2][0]!="shift")&&(We=(le/2+2.5)*(B-Ve[ht].length));for(var gt=0;gt<Ve[ht].length;gt++){if(ot=!1,dt=null,St=!1,Ve[ht][gt]=="backspace"?(ct=!0,dt=pe,St=!0):Ve[ht][gt]=="back"?(ct=!1,dt=pe,St=!0):Ve[ht][gt]=="shift"?(ct=!0,dt=z):(ht==3||Oe!=Ae.def&&ht==2)&&gt==0?(ct=!0,St=!0):Ve[ht][gt]==""?(ct=!1,ot=!0):Ve[ht][gt]=="numpad"?(dt=oe,ct=!1,St=!0):Ve[ht][gt]=="away"?(dt=de,ct=!0,St=!0):ct=!1,ct?Ue=le*1.5+2.5:ot?(Ue=(le+5)*((n(X)?3:2)+B-10+1-P[0][3].length)-5,P[0][3].indexOf("backspace")!=-1&&(Ue-=le/2)):Ue=le,Ce=new t.Rectangle(Ue,le,r,k,g,T,null,null,null,!1).cur().addTo(Te),St&&Ce.addChild(new t.Rectangle(Ue,le,"black",null,null,T,null,null,null,!1).alp(y)),dt?Ce.label=rt=new t.Label({text:"",backgroundColor:"ignore",font:o.font!=null?o.font:null,style:!1}):Ce.label=rt=new t.Label({lineWidth:10,lineHeight:25,font:o.font!=null?o.font:null,text:Ve[ht][gt],color:i,align:"center",style:!1}),dt){var Bt=dt.clone(),Dt;Ve[ht][gt]=="numpad"?(Dt=60,$=Ce):Dt=70,Bt.scaleTo(Ce,Dt,Dt),Bt.centerReg(Ce)}et?(et=!1,We+=67.33):(rt.centerReg(Ce).mov(0,isNaN(rt.text)?3:7),Ce.x=We,Ce.y=lt,Ce.na=Ve[ht][gt],ht==2&&gt==0&&Oe==Ae.number1&&(Ce.toggle="1/2"),ht==2&&gt==0&&Oe==Ae.number2&&(Ce.toggle="2/2"),ht==3&&gt==0&&Oe==Ae.def&&(Ce.toggle="?123"),ht==3&&gt==0&&Oe!=Ae.def&&(Ce.toggle="ABC"),Ce.toggle&&rt.mov(0,3),te.push(Ce),Ce.na=="shift"&&(ue=Ce),We=Ce.x+Ce.width+5)}lt+=le+5,We=0}Te.cache(g?-g:0,g?-g:0,g?Te.width+g*2:Te.width,g?Te.height+g*2:Te.height)}function Ye(Oe){var Ve=P[3][Oe],rt=!1,Ce=!1,We;We=t.timeout(500,ct,null,"ms");var lt=I.on("pressup",Ue);function Ue(){rt=!0,I.off("pressup",lt),Ce||Ne(Oe)}function ct(){var ot,dt,et,St=0,ht;if(We.clear(),!rt){Ce=!0,G=new t.Container(1e3,le,null,null,!1).addTo(I,0),G.y=-le-5;for(var gt=0;gt<Ve.length;gt++)J===Ae.shift?ht=Ve[gt].toUpperCase():ht=Ve[gt],ot=new t.Label({lineWidth:10,lineHeight:25,text:ht,font:o.font!=null?o.font:null,color:i,align:"center",style:!1}),dt=new t.Rectangle(le,le,r,k,g,T,null,null,null,!1).addTo(G),et=new t.Rectangle(le,le,"white",null,null,T,null,null,null,!1).alp(.2),dt.addChild(et),ot.center(dt),dt.na=Ve[gt],dt.x=St,St+=le+5;I.stage&&I.stage.update()}}}function $e(){z=new t.Shape({style:!1}),z.graphics.f(i).p("AhIFoIAAjYIixAAID5n3ID6H3IixAAIAADYgAjHBxICeAAIAADYIBTAAIAAjYICeAAIjImSg"),z.setBounds(-51/2,-72/2,51,72),pe=new t.Container({style:!1});var Oe=new t.Shape({style:!1});Oe.graphics.f(i).p("ACgC+IigigIifCgQgGAGgJAAQgJAAgGgGQgGgGgBgJQABgJAGgGICgigIigifQgGgGgBgJQABgJAGgGQAGgGAJAAQAIAAAHAGICfCgICgigQAGgGAJAAQAJAAAGAGQAGAGABAJQgBAJgGAGIigCfICgCgQAGAGABAJQgBAJgGAGQgGAGgJAAQgJAAgGgGg"),Oe.setTransform(82.6,32),Oe.addTo(pe);var Ve=new t.Shape({style:!1});Ve.graphics.f(i).s().p("AkhFAQgcAAgUgUIkHj6QgVgUAAgeQAAgdAVgVIEHj6QAUgTAcAAINKAAQAdAAAUAUQAUAUAAAdIAAH1QAAAdgUATQgUAVgdAAgAk0kOIkGD8QgIAHAAALQAAALAIAIIEGD7QAIAHALAAINKAAQALAAAIgIQAHgHAAgLIAAn1QAAgLgHgIQgIgIgLAAItKAAQgLAAgIAHg"),Ve.setTransform(62.2,32),Ve.addTo(pe),pe.setBounds(0,0,125,64),de=new t.Container({style:!1}),de.setBounds(0,0,147,86);for(var rt=[{p:"Ai+heIF9AAIi/C9g",transform:[73.4,76]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.4,43.2]},{p:"AnNAzIAAhlIObAAIAABlg",transform:[73,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128.2,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.5,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.8,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[87.1,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.4,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.7,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[128,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[114.3,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[100.6,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[86.9,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[73.2,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[59.5,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]},{p:"AphEnQgzAAgkgkQglglAAgzIAAlVQAAgzAlglQAkgkAzAAITDAAQAzAAAkAkQAlAlAAAzIAAFVQAAAzglAlQgkAkgzAAgAqjjtQgcAcAAAnIAAFVQAAAnAcAbQAbAcAnAAITDAAQAnAAAcgcQAbgbAAgnIAAlVQAAgngbgcQgcgcgnAAIzDAAQgnAAgbAcg",transform:[73.4,29.5]}],Ce,We=0;We<rt.length;We++)Ce=new t.Shape({style:!1}),Ce.graphics.f(i).s().p(rt[We].p),Ce.setTransform(rt[We].transform[0],rt[We].transform[1]),Ce.addTo(de);oe=new t.Container({style:!1}),oe.setBounds(0,0,62,86),Be=new t.Container({style:!1}),Be.setBounds(0,0,62,86);for(var lt=[{p:"Ai+heIF9AAIi/C9g",transform:[33,76,1,1,180]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.8,43.2]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[46,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.3,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.6,29.5]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[45.8,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[32.1,15.8]},{p:"AgyAzIAAhlIBlAAIAABlg",transform:[18.4,15.8]}],We=0;We<lt.length;We++){var Ue=new t.Shape({style:!1});Ue.graphics.f(i).s().p(lt[We].p),Ue.setTransform(lt[We].transform[0],lt[We].transform[1],lt[We].transform[2],lt[We].transform[3],lt[We].transform[4]),Ue.addTo(oe);var ct=new t.Shape({style:!1});ct.graphics.f(i).s().p(lt[We].p),ct.setTransform(lt[We].transform[0],lt[We].transform[1]),ct.addTo(Be)}Ue.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10),ct.graphics.ef().s(white).ss(3).rr(-16,-14,60,55,10)}function it(){Me=new t.Rectangle(le*1.5+2.5+2.5,le,r,k,g,T,null,null,null,!1).addTo(I,0).cur();for(var Oe,Ve=0;Ve<4;Ve++)Oe=new t.Rectangle(Me.width*.4,4,i,null,null,null,null,null,null,!1).centerReg(Me).alp(.2),Oe.y-=-22+Ve*15;Me.x=8.5*le+40,Me.y=-le-5,Me.na="drag"}function Le(Oe){I.numPad||(I.numPad=new t.NumPad({advanced:U,draggable:_}).sca(S),_||R?I.numPad.center({add:!1}):I.numPad.pos({x:0,y:8,horizontal:"center",vertical:"bottom",add:!1}),I.numPad.on("pressed",function(){I.numPad.key=="enter"?I.dispatchEvent("enter"):I.numPad.key=="backspace"?I.removeChar():I.numPad.key=="clear"?I.clearText():I.numPad.key=="space"?Ne(" "):Ne(I.numPad.key)}),I.numPad.on("close",function(){$.removeChildAt(2),oe.clone().scaleTo($,60,60).centerReg($,2),Te.updateCache(),(!I.keys.parent||!I.keys.visible)&&ce&&(ce.visible=!1,I.toggled=!1,ae())})),$.removeChildAt(2),I.numPad.parent||Oe===!1?(I.numPad.removeFrom(),oe.clone().scaleTo($,60,60).centerReg($,2)):(!I.numPad.parent||Oe===!0)&&(I.numPad.addTo(),Be.clone().scaleTo($,60,60).centerReg($,2)),Te.updateCache(),I.stage&&I.stage.update()}function Ze(){I.mouseYAmount&&(I.y=I.parent.globalToLocal(0,I.mouseYAmount-be).y)}function ze(){p.off("pressmousemove",I.tickerMouseEvent),t.Ticker.remove(Ze)}I.setBounds(1e3,400-(B-10)*26);function ve(){if(!(!ge||!ce)){for(var Oe=ge.label.x+ge.label.getBounds().x,Ve=0;Ve<ie;Ve++)Oe+=ge.widthArray[Ve]?ge.widthArray[Ve]:0;ce.heightOnly=ge.getBounds().height*(ge.backing&&n(ge.padding)?.9:1)-(ge.paddingV&&ge.background?ge.paddingV*2:0),ce.center(ge),ce.x=Oe}}function Pe(){if(xe||!ge)return I;var Oe=A?["<",">","x"]:["<",">"],Ve,rt,Ce;Se=[],Ce=ge.localToLocal(0,0,I),xe=I.place=new t.Container({style:!1}).addTo(I).cur();for(var We=0;We<Oe.length;We++)Ve=new t.Rectangle(le,le,s,k,g,T,null,null,null,!1),Oe[We]=="x"&&new t.Rectangle(le,le,"black",null,null,T,null,null,null,!1).alp(y).addTo(Ve),rt=new t.Label({lineWidth:10,text:Oe[We],backing:Ve,font:o.font!=null?o.font:null,color:f,align:"center",valign:"center",style:!1}),rt.pos(0,0,t.LEFT,t.TOP,xe).cache(),rt.x=rt.x+We*(le+5),Se.push(rt);Ce=ge.localToLocal(0,0,I),xe.x=Ce.x+w,xe.y=Ce.y+ge.height+15+b,xe.on("click",lt);function lt(Ue){Se.indexOf(Ue.target)==0?ie>0&&ie--:Se.indexOf(Ue.target)==1?ie<ge.text.length&&ie++:ae(),ve()}I.stage&&I.stage.update()}function ae(){if(!xe)return I;xe.dispose(),xe=null}function Ne(Oe){if(ge){var Ve,rt;if(Oe==="del")ge&&(ge.text=[ge.text.slice(0,ie-1),ge.text.slice(ie)].join("")),ie--,Xe();else{if(J===Ae.shift&&(Oe=Oe.toUpperCase()),ge&&I.maxLength&&ge.text.length>=I.maxLength||I.numbersOnly&&!isFinite(Number(Oe)))return;var Ce=ge.text;Ve=ge.clone().removeFrom(),Ve.text=Oe,rt=Ve.label.getMeasuredWidth(),ge.widthArray?ge.widthArray.splice(ie,0,rt):ge.widthArray=[ge.breedte],ie<ge.text.length?ge.text=[ge.text.slice(0,ie),Oe,ge.text.slice(ie)].join(""):ge.text+=Oe,ge&&ge.label.getBounds().width<L?(ie++,ve()):ge.text=Ce}J===Ae.shift&&!q&&(I.removeChild(Te),Re(),J=Ae.def),ve();var We=new Fe.Event("keydown");We.letter=Oe,I.dispatchEvent(We),I.stage&&I.stage.update()}}function Ke(Oe){if(I.stage){var Ve,rt=0,Ce=!1;ge=Oe.target,ge.widthArrayCheck||Xe(),L=ge.label.lineWidth?ge.label.lineWidth:1e4,Ve=ge.globalToLocal(Oe.stageX/t.scaX,Oe.stageY/t.scaY),Ve.x-=ge.label.x,Ve.y-=ge.label.y;for(var We=0;We<ge.widthArray.length;We++)if(rt+=ge.widthArray[We],Ve.x<rt-ge.widthArray[We]/2+ge.label.getBounds().x){ie=We,Ce=!0;break}Ce||(ie=ge.text.length),ve(),v&&!xe&&ge.text.length>0&&Pe(),xe&&ge&&(ge.text.length>0?(Ve=ge.localToLocal(0,0,I),xe.x=Ve.x+w,xe.y=Ve.y+ge.height+15+b):ae())}}function Xe(){if(ge){var Oe=new t.Label("");ge.widthArray=[];for(var Ve=0;Ve<ge.text.length;Ve++)Oe=ge.clone().removeFrom(),Oe.text=ge.text[Ve],ge.widthArray.push(Oe.label.getMeasuredWidth());Oe.text=ge.text,ge.widthArrayCheck=!0,ve()}}function Qe(Oe){var Ve=!0,rt;function Ce(){(!ge||ge.text.length<1||I.currentIndex==0)&&(Ve=!1),Ve&&(We(),rt&&(rt=t.timeout(200,Ce,null,"ms"))),ge&&ge.text.length<1&&lt()}function We(){ge&&ge.text.length>0?(I.selectedIndex>0&&Ne("del"),Oe?lt():I.on("pressup",lt)):Ne("del")}function lt(){Ve=!1,rt&&rt.clear(),I.off("pressup",lt)}We(),rt=t.timeout(300,Ce,null,"ms"),I.stage&&I.stage.update()}function he(){for(var Oe=0;Oe<e.length;Oe++)e[Oe].clickEvent=e[Oe].on("click",Ke)}he();function Ge(){if(e.length>1)for(var Oe=0;Oe<e.length;Oe++)e[Oe].off("click",e[Oe].clickEvent)}function Ie(){if(!ce&&(ge=e[0],L=ge&&ge.label.lineWidth?ge.label.lineWidth:1e4,ge)){ce=new t.Rectangle(3,ge.height-(ge.paddingV&&ge.background?ge.paddingV*2:0),u,null,null,null,null,null,null,!1).center(ge),ce.x=0,ce.visible=!1,ce.animate({obj:{alpha:0},rewind:!0,loop:!0,loopWait:750,time:250,id:"knipperTekst",timeUnit:"ms"});for(var Oe=0;Oe<e.length;Oe++)e[Oe].widthArray=[0];Xe()}}Ie();function _e(){t.stopAnimate("knipperTekst"),ge&&ge.removeChild(ce),ce=null,ge=null}Object.defineProperty(this,"selectedLabel",{get:function(){return ge},set:function(Oe){var Ve={target:Oe};Ke(Ve),I.hidePlace()}}),Object.defineProperty(this,"selectedIndex",{get:function(){return ie},set:function(Oe){ie=Oe,ve()}}),this.show=function(Oe,Ve){if(I.addTo(x),!n(Oe)){var rt={target:e[Oe]};Ke(rt)}return ce&&(ce.visible=!0),I.toggled=!0,R?Le():(!R||Ve)&&(I.keys.vis(!0),Je.vis(!0)),I.numPad&&I.numPad.parent&&I.numPad.top(),I},this.hide=function(){return I.removeFrom(x),Le(!1),ce&&(ce.visible=!1),p.update(),I.toggled=!1,I},this.showNumPad=function(){Le(!0),I.toggled=!0,ce&&(ce.visible=!0)},this.hideNumPad=function(){Le(!1),(!I.keys.parent||!I.keys.visible)&&ce&&(ce.visible=!1,I.toggled=!1,ae())},this.showKeyboard=function(){I.show(null,!0)},this.hideKeyboard=function(){!I.numPad||!I.numPad.parent?I.hide():(I.keys.vis(!1),Je.vis(!1))},this.toggle=function(Oe){return Oe===!0?I.show():Oe===!1||I.parent?I.hide():I.show(),I},this.showPlace=function(){return Pe(),I},this.hidePlace=function(){return ae(),I},this.addLabels=function(Oe){Array.isArray(Oe)||(Oe=[Oe]);for(var Ve=Oe.length-1;Ve>=0;Ve--){var rt=e.indexOf(Oe[Ve]);rt>=0||Oe[Ve].type!="Label"?Oe.splice(Ve,1):Oe[Ve].widthArray=[0]}return Ge(),e=e.concat(Oe),he(),Ie(),ce&&(ce.visible=!0),I},this.removeLabels=function(Oe){Array.isArray(Oe)||(Oe=[Oe]),Ge();for(var Ve=0;Ve<Oe.length;Ve++){var rt=e.indexOf(Oe[Ve]);rt>=0&&e.splice(rt,1)}return he(),e.length==0?ge&&_e():ge&&e.indexOf(ge)==-1&&(_e(),Ie()),I};var Je=new t.Rectangle(this.width,this.height,t.clear,null,null,null,null,null,null,!1).addTo(this).expand().bot();Je.on("mousedown",function(){}),Je.on("click",function(){}),R&&Je.vis(!1),this.resize=function(){if(I.scaleTo(p,100-O*2/p.width*100,50-O*2/p.height*100),I.y=p.height-I.height-O,I.x=p.width/2-I.width/2,ge&&xe){var Oe=ge.localToLocal(0,0,I);xe.x=Oe.x,xe.y=Oe.y+ge.height+15}return I.stage&&I.stage.update(),I},this.resize(),I.selectedLabel&&(I.selectedIndex=I.selectedLabel.text.length),m&&(this.keydownEvent=function(Oe){if(I.stage){var Ve=I;n(Ve)||(Oe.keyCode==35&&(Ve.selectedIndex=Ve.selectedLabel.text.length),Oe.keyCode==36&&(Ve.selectedIndex=0),Oe.keyCode==37&&(Ve.selectedIndex=Ve.selectedIndex-1),Oe.keyCode==39&&(Ve.selectedIndex=Ve.selectedIndex+1),Oe.keyCode==46&&Ve.selectedIndex<Ve.selectedLabel.text.length&&(Ve.selectedIndex=Ve.selectedIndex+1,Ve.removeChar()),Oe.keyCode==8&&(Oe.preventDefault(),Ve.removeChar()),Ve.addChar(Oe.key),I.stage&&I.stage.update())}},ee.addEventListener("keydown",this.keydownEvent)),ne!==!1&&t.styleTransforms(this,o),this.clone=function(){var Oe=new t.Keyboard(e,r,i,l,a,s,u,y,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,this.group,D);return I.cloneProps(Oe)},this.dispose=function(Oe,Ve,rt){Je.removeAllEventListeners(),Je=null,I.keydownEvent&&ee.removeEventListener("keydown",I.keydownEvent);for(var Ce=0;Ce<I.labels.length;Ce++)I.labels[Ce].removeAllEventListeners();return I.numPad&&I.numPad.dispose(),ce&&ce.dispose(),I.labels=ge=null,p&&p.off("pressmousemove",I.tickerMouseEvent),rt||I.zimContainer_dispose(!0),!0}},t.extend(t.Keyboard,t.Container,["clone","dispose"],"zimContainer",!1),t.Organizer=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S){var _="width, list, useAdd, useRemove, usePosition, autoAdd, autoRemove, autoPosition, addForward, removeForward, backgroundColor, rollBackgroundColor, selectedBackgroundColor, selectedRollBackgroundColor, color, rollColor, selectedColor, selectedRollColor, spacing, corner, keyEnabled, gradient, gloss, backdropColor, style, group, inherit",R;if(R=st(t.Organizer,arguments,_,this))return R;De("67.3"),this.group=j;var U=m===!1?{}:t.getStyle("Organizer",this.group,S);if(n(e)&&(e=U.width!=null?U.width:r&&r.vertical?r.width:300),n(i)&&(i=U.useAdd!=null?U.useAdd:!0),n(l)&&(l=U.useRemove!=null?U.useRemove:!0),n(a)&&(a=U.usePosition!=null?U.usePosition:!0),n(s)&&(s=U.autoAdd!=null?U.autoAdd:i),n(f)&&(f=U.autoRemove!=null?U.autoRemove:l),n(u)&&(u=U.autoPosition!=null?U.autoPosition:a),n(y)&&(y=U.addForward!=null?U.addForward:!0),n(k)&&(k=U.removeForward!=null?U.removeForward:!0),n(g)&&(g=U.backgroundColor!=null?U.backgroundColor:t.tin),n(O)&&(O=U.rollBackgroundColor!=null?U.rollBackgroundColor:t.grey),n(T)&&(T=U.selectedBackgroundColor!=null?U.selectedBackgroundColor:t.dark),n(A)&&(A=U.color!=null?U.color:t.white),n(C)&&(C=U.rollColor!=null?U.rollColor:A),n(d)&&(d=U.selectedColor!=null?U.selectedColor:A),n(x)&&(x=U.selectedRollColor!=null?U.selectedRollColor:A),n(P)&&(P=U.spacing!=null?U.spacing:1),n(v)&&(v=U.corner!=null?U.corner:0),n(b)&&(b=U.gradient!=null?U.gradient:.2),n(X)&&(X=U.gloss!=null?U.gloss:null),n(Y)&&(Y=U.backdropColor!=null?U.backdropColor:null),Array.isArray(v)||(v=[v,v,v,v]),!(!i&&!a&&!l)){var Z=(i?1:0)+(a?4:0)+(l?1:0),K=(e+P)/Z,ne={width:K,height:K,label:"",shadowColor:-1,gradient:b,corner:v,backgroundColor:g,rollBackgroundColor:O},V=[],D=new t.Shape;if(D.graphics.f(A).p("AAAA4Ih6B8Ig5g4IB8h8Ih7h6IA4g5IB6B8IB7h8IA5A5Ih8B6IB8B7Ig5A5g"),i&&V.push(new t.Button({icon:D.sca(.55).rot(-45).reg(1),inherit:ne})),a){var c=new t.Shape;c.graphics.f(A).p("AiJieIETCeIkTCfg"),V.push(new t.Button({icon:c.sca(.6).rot(r&&!r.vertical?180:-90).reg(-2),inherit:ne})),V.push(new t.Button({icon:c.clone().sca(.6).rot(r&&!r.vertical?0:90).reg(-2),inherit:ne}));var h=new t.Shape;h.graphics.f(A).p("AiFCLIAAkVIBXAAIAAEVgAgiAAICoiHIAAEQg"),V.push(new t.Button({icon:h.sca(.62).rot(r&&!r.vertical?0:90).reg(0),inherit:ne})),V.push(new t.Button({icon:h.clone().sca(.62).rot(r&&!r.vertical?180:-90).reg(0),inherit:ne}))}l&&V.push(new t.Button({icon:D.clone().rot(0).sca(.55),inherit:ne})),V.length==0&&(V=[""]),this.zimTabs_constructor(e,K,V,g,O,null,T,E,A,C,null,d,x,!1,P,!0,!1,v,null,!0,b,X,null,null,null,null,null,null,null,null,null,null,Y);var o=this;o.list=r,o.type="Organizer",o.setButtons=function(){if(a){var p=i?1:0;V[p+0]&&(V[p+0].icon.rotation=o.list&&!o.list.vertical?180:-90),V[p+1]&&(V[p+1].icon.rotation=o.list&&!o.list.vertical?0:90),V[p+2]&&(V[p+2].icon.rotation=o.list&&!o.list.vertical?0:90),V[p+3]&&(V[p+3].icon.rotation=o.list&&!o.list.vertical?180:-90)}};var I=!1,N=r;o.change(function(p){(!I&&o.list||o.list&&o.list!=N)&&(o.list!=N&&N&&N.noChange(),o.list.change(function(){o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex}),I=!0,N=o.list);var L=p.target.selectedIndex;i||L++,!a&&(!i||L>0)&&(L=5);var we=n(o.list.selectedIndex)||o.list.selectedIndex<0;we&&(o.currentValue=null),o.lastIndex=o.list.selectedIndex;var B;switch(L){case 0:s&&(B=Math.max(0,o.list.selectedIndex),o.add(B)),o.orgType="add";break;case 1:if(we)break;u&&(B=o.list.selectedIndex,o.up(B)),o.orgType="up";break;case 2:if(we)break;u&&(B=o.list.selectedIndex,o.down(B)),o.orgType="down";break;case 3:if(we)break;u&&(B=o.list.selectedIndex,o.toTop(B)),o.orgType="top";break;case 4:if(we)break;u&&(B=o.list.selectedIndex,o.toBottom(B)),o.orgType="bottom";break;case 5:if(we)break;f&&(B=o.list.selectedIndex,o.remove(B)),o.orgType="remove";break}}),this.add=function(p,L,we){return n(p)&&(p=o.lastIndex),n(L)&&(L=""),y?p=Math.min(o.list.length,Math.max(0,o.list.selectedIndex)+1):p=Math.max(0,o.list.selectedIndex),o.list.addAt(L,p,we),o.list.selectedIndexPlusPosition=p,o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},this.up=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];return n(L)||(o.list.removeAt(1,p),o.list.addAt(L,p-1),o.list.selectedIndexPlusPosition=Math.max(0,p-1),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.down=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];return n(L)||(o.list.removeAt(1,p),o.list.addAt(L,p+1),o.list.selectedIndexPlusPosition=Math.min(o.list.length-1,p+1),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.toTop=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];return n(L)||(o.list.removeAt(1,p),o.list.addAt(L,0),o.list.first(),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex),o},this.toBottom=function(p){n(p)&&(p=o.lastIndex);var L=o.list.items[p];if(!n(L))return o.list.removeAt(1,p),o.list.addAt(L,o.list.length),o.list.last(),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},this.remove=function(p){if(n(p))if(o.list.selectedIndex>=0)p=o.list.selectedIndex;else return o;var L=p==o.list.selectedIndex;return o.removedItem=o.list.items[p],o.list.removeAt(1,p),L?k||(p=Math.max(0,p-1)):p=o.list.selectedIndex,o.list.selectedIndexPlusPosition=Math.min(o.list.length-1,p),o.orgItem=o.list.selected,o.orgIndex=o.list.selectedIndex,o},m!==!1&&t.styleTransforms(this,U),this.clone=function(){return o.cloneProps(new t.Organizer(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,o.group,S))},this.dispose=function(p,L,we){return V=null,we||o.zimTabs_dispose(!0),!0}}},t.extend(t.Organizer,t.Tabs,["clone","dispose"],"zimTabs",!1),t.Connectors=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h){var o="width, height, points, node, line, linear, linearWrap, linearOrder, num, snapH, snapV, dropType, dropArray, continuous, startIndex, duplicateLine, deleteNode, dblclick, fullMove, min, max, boundary, expand, nodeRollColor, nodeRollBorderColor, nodeSelectedColor, nodeSelectedBorderColor, baseColor, baseBorderColor, baseRollover, rootLock, grandChildren, dblclickTime, steps, style, group, inherit",I;if(I=st(t.Connectors,arguments,o,this))return I;De("67.39"),this.group=c;var N=D===!1?{}:t.getStyle("Connectors",this.group,h);n(e)&&(e=N.width!=null?N.width:null),n(r)&&(r=N.height!=null?N.height:null),this.zimContainer_constructor(null,null,null,null,!1),this.type="Connectors",n(i)&&(i=N.points!=null?N.points:[[0,0],[100,0],[100,100],[0,100]]),n(l)&&(l=N.node!=null?N.node:new t.Circle(10,t.grey,t.grey)),l.removeFrom(),l.color==t.clear&&!l.hitArea&&l.expand(0),n(a)&&(a=N.line!=null?N.line:new t.Line({length:10,thickness:3,color:t.tin,strokeObj:{caps:"round"}})),n(y)&&(y=N.num!=null?N.num:10),n(s)&&(s=N.linear!=null?N.linear:!1),n(f)&&(f=N.linearWrap!=null?N.linearWrap:!0),n(Y)&&(Y=N.nodeRollColor!=null?N.nodeRollColor:l.color.match("rgb")?l.color:l.color.lighten(.2)),n(m)&&(m=N.nodeRollBorderColor!=null?N.nodeRollBorderColor:l.borderColor),n(j)&&(j=N.nodeSelectedColor!=null?N.nodeSelectedColor:t.white),n(S)&&(S=N.nodeSelectedBorderColor!=null?N.nodeSelectedBorderColor:l.borderColor),n(_)&&(_=N.baseColor!=null?N.baseColor:l.color),n(R)&&(R=N.baseBorderColor!=null?N.baseBorderColor:l.borderColor),n(U)&&(U=N.baseRollover!=null?N.baseRollover:!1),n(v)&&(v=N.min!=null?N.min:l.radius?l.radius*2:Math.min(l.width,l.height)),n(w)&&(w=N.max!=null?N.max:null),n(X)&&(X=N.expand!=null?N.expand:t.mobile()?10:0),n(O)&&(O=N.dropType!=null?N.dropType:"any"),n(T)&&(T=N.dropArray!=null?N.dropArray:null),n(E)&&(E=N.continuous!=null?N.continuous:!1),n(A)&&(A=N.startIndex!=null?N.startIndex:null),n(C)&&(C=N.duplicateLine!=null?N.duplicateLine:!0),n(d)&&(d=N.deleteNode!=null?N.deleteNode:!0),n(x)&&(x=N.dblclick!=null?N.dblclick:!0),n(P)&&(P=N.fullMove!=null?N.fullMove:!0),n(ne)&&(ne=N.dblclickTime!=null?N.dblclickTime:.5);var p=Tt(ne);if(ne*=p=="s"?1e3:1,n(k)&&(k=N.snapH!=null?N.snapH:null),n(g)&&(g=N.snapV!=null?N.snapV:null),n(Z)&&(Z=N.rootLock!=null?N.rootLock:!1),n(K)&&(K=N.grandChildren!=null?N.grandChildren:!0),n(V)&&(V=N.steps!=null?N.steps:null),s&&i.length<=1){vt&&tt("Connector() - linear needs more than one point");return}var L=this,we=0;L.node=l,L.line=a;var B=[],F=l.color,fe=l.borderColor,se=L.lines=new t.Container(e,r).addTo(L),Q=L.nodes=new t.Container(e,r).addTo(L);if(i.type=="Blob"||i.type=="Squiggle"){var te=[];t.loop(i.points,function(Le){te.push([Le[0],Le[1]])}),i=te}L.points=i,this.addNode=function(Le,Ze,ze){if(!s)return le(Le,Ze,ze)};function le(Le,Ze,ze,ve){if(Le.addChild){O="on",Z=!0,K=!1,ze=Le,ze.connectorMoveEvent||(L.bases||(L.bases=[]),L.bases.push(ze),ze.connectorMoveEvent=ze.on("pressmove",function(){ze.positionConnectors(ze,!0,!0)}),ze.connectorUpEvent=ze.on("pressup",function(){ze.positionConnectors(ze,!0,!0)}),U&&(ze.connectorOverEvent=ze.on("mouseover",function(){Be(ze)}),ze.connectorOutEvent=ze.on("mouseout",function(){$(ze)})),ze.positionConnectors=function(Ke,Xe,Qe){t.loop(Ke.connectors,function(he){var Ge=Ke.parent.localToLocal(Ke.x-Ke.baseStart.x+he.nodeStart.x,Ke.y-Ke.baseStart.y+he.nodeStart.y,he.parent);he.x=Ge.x,he.y=Ge.y,Ye(he,Xe,Qe)}),Ke.stage&&Ke.stage.update()},ze.setConnectorColors=function(Ke,Xe,Qe,he){return n(Ke)||(ze.connectorColor=Ke),n(Xe)||(ze.connectorBorderColor=Xe),n(Qe)||(ze.connectorRollColor=Qe),n(he)||(ze.connectorRollBorderColor=he),t.loop(ze.connectors,function(Ge){n(Ke)||(Ge.color=Ke),n(Xe)||(Ge.borderColor=Xe)}),ze},ze.setConnectorColors(_,R,Y,m));var Pe=ze.getBounds();a.endHead,Array.isArray(Ze)||(Ze=[Ze,Ze]);var ae=[];return Ze.length==2&&(Ze=[Ze[0],Ze[1],Ze[0],Ze[1]]),(a.lineOrientation==t.HORIZONTAL||a.lineOrientation=="auto")&&t.loop([Ze[0],Ze[1]],function(Ke,Xe){if(Ke==-1||Ke==-2){var Qe=ze.localToLocal(Xe==0?Pe.x:Pe.x+Pe.width,Pe.y,L);ae.push([Qe.x,Qe.y,t.HORIZONTAL])}if(Ke==-1||Ke==-3){var he=ze.localToLocal(Xe==0?Pe.x:Pe.x+Pe.width,Pe.y+Pe.height,L);ae.push([he.x,he.y,t.HORIZONTAL])}Ke>0&&t.loop(Ke,function(Ge,Ie){var _e=ze.localToLocal(Xe==0?Pe.x:Pe.x+Pe.width,Pe.y+Pe.height*(Ge+1)/(Ie+1),L);ae.push([_e.x,_e.y,t.HORIZONTAL])})}),(a.lineOrientation==t.VERTICAL||a.lineOrientation=="auto")&&t.loop([Ze[2],Ze[3]],function(Ke,Xe){if(Ke==-1||Ke==-2){var Qe=ze.localToLocal(Pe.x,Xe==0?Pe.y:Pe.y+Pe.height,L);ae.push([Qe.x,Qe.y,t.VERTICAL])}if(Ke==-1||Ke==-3){var he=ze.localToLocal(Pe.x+Pe.width,Xe==0?Pe.y:Pe.y+Pe.height,L);ae.push([he.x,he.y,t.VERTICAL])}Ke>0&&t.loop(Ke,function(Ge,Ie){var _e=ze.localToLocal(Pe.x+Pe.width*(Ge+1)/(Ie+1),Xe==0?Pe.y:Pe.y+Pe.height,L);ae.push([_e.x,_e.y,t.VERTICAL])})}),ze.connectors=[],ze.baseStart=new t.Point(ze.x,ze.y),t.loop(ae,function(Ke){var Xe=le(Ke[0],Ke[1],ze,Ke[2]);Me(ze,Xe)}),setTimeout(function(){ze.positionConnectors(ze,!0,!0)},50),L}var Ne=l.clone().loc(Le,Ze,Q).drag({boundary:b}).expand(X);return Ne.orientation=ve,Ne.nodeColor=Ne.color,Ne.on("mouseover",Te),Ne.on("mouseout",G),Ne.on("mousedown",xe),Ne.on("pressmove",Se),Ne.on("pressup",z),d&&Ne.hold(J),Ne.nodeNum=we++,Ne.creations=[],Ne}function Ae(){t.loop(i,function(Le,Ze){var ze=le(Le[0],Le[1]);ze.dropIndex=Ze,T&&(ze.dropArray=T[Ze])}),s&&Q.loop(function(Le,Ze,ze){Ze==0?(f?Le.before=Q.getChildAt(ze-1):Le.before=null,Le.after=Q.getChildAt(Ze+1)):Ze==ze-1?(f?Le.after=Q.getChildAt(0):Le.after=null,Le.before=Q.getChildAt(Ze-1)):(Le.before=Q.getChildAt(Ze-1),Le.after=Q.getChildAt(Ze+1)),u&&Ze>0&&Le.noMouse()})}Ae(),L.setAvailableIndexes=function(Le){return Array.isArray(Le)||(Le=[Le]),L.nodes.loop(function(Ze,ze){Le.indexOf(ze)==-1?Ze.noMouse():Ze.mouse()}),L},n(A)||L.setAvailableIndexes(A),L.keyEvent=function(Le){d&&Le.keyCode==46&&(t.loop(ce,function(Ze){Ze&&Ze.parent&&$e(Ze)}),L.stage&&L.stage.update())},ee.addEventListener("keydown",L.keyEvent);function J(Le){var Ze=Le.target.stage,ze=Le.target;L.bases||Z&&!ze.creator.creator||(ze.adding?$e(ze.creator):$e(ze),L.stage&&L.stage.update())}function Te(Le){var Ze=Le.target;Ze.selected||(Ze.color=Ze.base?Ze.base.connectorRollColor:Y,Ze.borderColor=Ze.base?Ze.base.connectorRollBorderColor:m,L.stage&&L.stage.update())}function G(Le){var Ze=Le.target;Ze.selected||(Ze.color=Ze.base?Ze.base.connectorColor:Ze.nodeColor,Ze.borderColor=Ze.base?Ze.base.connectorBorderColor:fe,L.stage&&L.stage.update())}var ce=[],q,ue=0,ge,ie;function xe(Le,Ze,ze,ve){var Pe=Le.target;if(!n(Pe)&&(ze&&(Pe.selected=!0,ce=[],L.selectNode(Pe,!ve)),ie=Pe.nodeNum,!s&&(!Z||Pe.creator)&&x&&!Ze&&(ue==0&&(ge=setTimeout(function(){if(ue=0,ce){var Xe=L.stage?L.stage.frame:ee.zdf,Qe=Q.loop(function(he){if(he.hitTestPoint(Xe.mouseX,Xe.mouseY)&&he.selected)return!1});Qe&&Re()}},ne)),ue++),Pe.startX=Pe.x,Pe.startY=Pe.y,!s&&ce.length>0&&t.loop(ce,function(Xe){Xe.startX=Xe.x,Xe.startY=Xe.y}),!(Pe.creations.length>=y||Pe.selected||Pe.creator&&!K))){Pe.adding=!0;var ae=le(Pe.x,Pe.y).bot();ae.creations=Pe.creations,ae.creatorLine=Pe.creatorLine,ae.creator=Pe.creator,ae.orientation=Pe.orientation,ae.startX=Pe.startX,ae.startY=Pe.startY,ae.dropIndex=Pe.dropIndex,ae.dropArray=Pe.dropArray,ae.lineArray=Pe.lineArray,ae.color=ae.nodeColor=Pe.nodeColor;var Ne=ae.nodeNum;if(ae.nodeNum=Pe.nodeNum,Pe.nodeNum=Ne,Pe.base&&(ae.base=Pe.base,ae.baseStart=Pe.baseStart,ae.nodeStart=Pe.nodeStart,ae.connectors=Pe.connectors,Pe.base=Pe.baseStart=Pe.nodeStart=Pe.connectors=null,ae.base.connectors&&ae.base.connectors.splice(ae.base.connectors.indexOf(Pe),1,ae),ae.color=ae.base.connectorColor,ae.borderColor=ae.base.connectorBorderColor),ae.before=Pe.before,ae.after=Pe.after,ae.before&&(ae.before.after=ae),ae.after&&(ae.after.before=ae),ae.creator){var Ke=ae.creator.creations.indexOf(Pe);Ke!=-1&&ae.creator.creations.splice(Ke,1,ae)}t.loop(ae.creations,function(Xe){Xe.creator=ae}),Pe.creator=ae,Pe.creatorLine=a.clone().setPoints(Pe.x,Pe.y,Pe.x,Pe.y).addTo(se).alp(0),Pe.creatorLine.lineOrientation=Pe.orientation,Pe.creatorLine.node=Pe,Pe.creatorLine.creatorNode=ae,Pe.creations=[],Pe.veeObj&&!n(Pe.veeObj.color)?Pe.color=t.Pick.choose(Pe.veeObj.color):Pe.color=ae.color,Pe.nodeColor=Pe.color,ae.creations.push(Pe),L.latestNode=Pe}}function Se(Le,Ze,ze,ve){var Pe=Le.target;Pe.creatorLine&&Pe.creatorLine.alp(1),!s&&ce.length>0&&ce.indexOf(Pe)==-1&&Re(),Ye(Pe,!1,!0),L.bases&&t.loop(L.bases,function(ae){Pe.creator&&Pe.creator.base==ae||(!ae.connectorsOn&&Pe.hitTestBounds(ae)&&Be(ae),ae.connectorsOn&&!Pe.hitTestBounds(ae)&&$(ae))}),L.stage&&L.stage.update()}function z(Le,Ze,ze,ve){var Pe=Le.target;L.bases&&t.loop(L.bases,function(Ve){Ve!=Pe.base&&Ve.connectorsOn&&$(Ve)});var ae=!1;if(!s&&ue>1&&!Ze){clearTimeout(ge);var Ne=Pe.adding?Pe.creator:Pe;if(Pe.adding&&$e(Ne.creations[Ne.creations.length-1],!0),!Ne.selected){var Ke=L.stage?L.stage.frame:ee.zdf;re(Ne,!Ke.ctrlKey)}ue=0,ae=!0}if(!s&&!L.base&&(k&&(Pe.x=Math.round(Pe.x/k)*k),g&&(Pe.y=Math.round(Pe.y/g)*g)),v&&t.dist(Pe.x,Pe.y,Pe.startX,Pe.startY)<v||w&&t.dist(Pe.x,Pe.y,Pe.startX,Pe.startY)>w){Pe.adding?$e(Pe,!0):(Pe.loc(Pe.startX,Pe.startY),ae||Ye(Pe)),L.stage&&L.stage.update(),L.lastNode=null,L.targetNode=null,L.dispatchEvent("noconnection");return}var Xe=!1,Qe=!1;if(s){var he=Pe.creator;if(L.connectionStart=he,L.connectionEnd=Pe,he.before&&Pe.hitTestCircle(he.before)&&!u)Pe.loc(he.before).removeFrom(),he.before.after=null,he.before.before||he.before.noMouse(),he.before=null,he.after||he.noMouse(),Qe=!0,Xe=ke();else if(he.after&&Pe.hitTestCircle(he.after))Pe.loc(he.after).removeFrom(),he.after.before=null,he.after.after||he.after.noMouse(),u&&he.after.mouse(),he.after=null,he.before||he.noMouse(),u&&he.noMouse(),Qe=!0,Xe=ke();else if(!he||Pe.creations.length>0)Pe.loc(Pe.startX,Pe.startY).bot();else{$e(Pe,!0),L.stage&&L.stage.update(),L.lastNode=null,L.targetNode=null,L.dispatchEvent("noconnection");return}}else if(O=="off"){var Ge=Q.loop(function(Ve){if(Pe!=Ve&&Pe.hitTestCircles(Ve)){Pe.adding?$e(Pe,!0):(Pe.loc(Pe.startX,Pe.startY),Ye(Pe)),Z&&me(Pe),!P&&Pe.creator&&y>0&&Pe.creator.creations.length>=y&&Pe.creator.noMouse(),L.targetNode=Ve,E&&L.nodes.loop(function(rt){rt!=L.latestNode&&rt.noMouse()}),E&&L.nodes.loop(function(rt){rt!=L.latestNode&&rt.noMouse()}),pe(),L.dispatchEvent("connection"),L.stage&&L.stage.update();return}});if(!Ge){oe(Pe);return}}else if(O=="on"||O=="single"){var Ie=0,_e,Je=Q.loop(function(Ve){if(Pe!=Ve&&Pe.hitTestCircles(Ve)){if(_e=Ve,L.bases&&(Pe.orientation!=Ve.orientation||Pe.creator&&Pe.creator.base&&Pe.creator.base==Ve.base)||Pe.dropArray&&Pe.dropArray.indexOf(Ve.dropIndex)==-1||!C&&Pe.lineArray&&Pe.lineArray.indexOf(Ve.dropIndex)!=-1)return;if(O=="on")return!1;Ie++,Ie+=Ve.creations.length}});if(Je&&!(O=="single"&&Ie==1)){oe(Pe);return}else{if(Pe.loc(_e),Pe.creator&&Pe.orientation==t.VERTICAL&&Math.round(Pe.y)==Math.round(Pe.creator.startY)||Pe.creator&&Pe.orientation==t.HORIZONTAL&&Math.round(Pe.x)==Math.round(Pe.creator.startX))return;L.targetNode=_e;var Oe=Pe.dropIndex;Pe.dropIndex=_e.dropIndex,Pe.dropArray=t.copy(_e.dropArray),_e.lineArray?_e.lineArray.push(Oe):_e.lineArray=[Oe],Pe.lineArray=t.copy(_e.lineArray),Pe.creator&&(Pe.creator.lineArray||(Pe.creator.lineArray=[]),Pe.creator.lineArray.push(Pe.dropIndex)),_e.base&&_e.base.connectors&&Me(_e.base,Pe),Qe=!0}}else Pe.selected||(Qe=!0);!P&&Pe.creator&&y>0&&Pe.creator.creations.length>=y&&Pe.creator.noMouse(),Pe.adding=!1,Ye(Pe,!0,!0),t.loop(ce,function(Ve){if(ce.indexOf(Ve.creator)==-1){var rt=t.loop(Ve.creations,function(Ce){if(ce.indexOf(Ce)>=0)return!1});pe(Ve.nodeNum,null,t.decimals(Ve.x,2),t.decimals(Ve.y,2),rt||rt===void 0?1:0)}Ve.startX=Ve.x,Ve.startY=Ve.y}),Pe.startX=Pe.x,Pe.startY=Pe.y,Z&&me(Pe),Qe?(E&&L.nodes.loop(function(Ve){Ve!=L.latestNode&&Ve.noMouse()}),pe(),L.dispatchEvent("connection"),t.arraysEqual(Pe.dropArray,Pe.lineArray,!1)&&L.dispatchEvent("blocked")):L.dispatchEvent("noconnection"),Xe&&L.dispatchEvent("complete"),L.stage&&L.stage.update()}function pe(Le,Ze,ze,ve,Pe){Ze?B.push([Le,null,null,1]):n(ze)?B.push([ie,t.decimals(L.latestNode.x,2),t.decimals(L.latestNode.y,2)]):B.push([Le,null,null,null,ze,ve,Pe])}L.makeConnection=function(Le,Ze,ze,ve,Pe){var ae=L.stage?L.stage.frame:ee.zdf;return ve?(ae.ctrlKey=Pe==1,xe({target:Le},!0,!0,Pe),Le.loc(Ze,ze),Se({target:Le},!0,!0,Pe),z({target:Le},!0,!0,Pe)):(xe({target:Le},!0,!1,null),L.latestNode.loc(Ze,ze),Se({target:L.latestNode},!0,!1,null),z({target:L.latestNode},!0,!1,null)),ae.ctrlKey=!1,L.latestNode};function de(Le){var Ze=L.nodes.loop(function(ze){if(ze.nodeNum==Le)return ze});if(Ze.type)return Ze}L.setSteps=function(Le){return t.loop(Le,function(Ze){var ze=de(Ze[0]);ze&&(Ze[3]?ze&&$e(ze):n(Ze[4])?L.makeConnection(ze,Ze[1],Ze[2]):(L.makeConnection(ze,Ze[4],Ze[5],!0,Ze[6]),Re()))}),L},L.applySteps=L.setSteps,L.getSteps=function(Le){return Le&&(L.stage||(L.stage=zdf.stage),L.pane||(L.pane=new t.Pane({displayClose:!1,container:L.stage,width:Math.min(500,L.stage.width-20),height:Math.min(500,L.stage.height-20),draggable:!0}),L.textArea=new t.TextArea(Math.min(400,L.stage.width-70),Math.min(400,L.stage.height-70)).centerReg(L.pane)),L.pane.show(),L.textArea.text=JSON.stringify(B)),B},Object.defineProperty(this,"steps",{get:function(){return B},set:function(Le){L.setSteps(Le)}});function oe(Le){Le.adding||!K?$e(Le,!0):(Le.loc(Le.startX,Le.startY),Ye(Le)),Z&&me(Le),Le.base&&Le.base.connectors&&be(Le.base,Le),L.lastNode=null,L.targetNode=null,L.dispatchEvent("noconnection"),L.stage&&L.stage.update()}function Be(Le){t.loop(Le.connectors,function(Ze){Ze.color=Le.connectorRollColor,Ze.borderColor=Le.connectorRollBorderColor}),Le.connectorsOn=!0,Le.stage&&Le.stage.update()}function $(Le){t.loop(Le.connectors,function(Ze){Ze.color=Le.connectorColor,Ze.borderColor=Le.connectorBorderColor}),Le.connectorsOn=!1,Le.stage&&Le.stage.update()}function Me(Le,Ze){Le.connectors.push(Ze),Ze.nodeStart=Ze.parent.localToLocal(Ze.x,Ze.y,Le.parent),Ze.nodeStart.x-=Le.x-Le.baseStart.x,Ze.nodeStart.y-=Le.y-Le.baseStart.y,Ze.base=Le}function be(Le,Ze){Le.connectors.splice(Le.connectors.indexOf(Ze),1),Ze.nodeStart=null,Ze.base=null}function me(Le){if(Le.creator){if(Le.creator.creator){me(Le.creator);return}Le.creator&&Le.creator.creations.length>=y?Le.creator.noMouse():Le.creator.mouse()}}function re(Le,Ze){Ze&&t.loop(Le.creations,function(ze){re(ze,Ze)}),Le.selected=!0,Le.color=Le.base?Le.base.connectorColor:j,Le.borderColor=Le.base?Le.base.connectorBorderColor:S,ce.push(Le),Le.top(),q||(q=L.stage.on("stagemousedown",function(){var ze=L.stage?L.stage.frame:ee.zdf,ve=Q.loop(function(Pe){if(Pe.hitTestPoint(ze.mouseX,ze.mouseY))return!1});ve&&Re()}))}this.selectNode=function(Le,Ze){re(Le,Ze)};function ke(){var Le=Q.loop(function(Ze){if(Ze.before||Ze.after)return!1});if(Le)return Q.loop(function(Ze){Ze.noMouse()}),!0}function Re(){t.loop(ce,function(Le){Le.selected=!1,Le.color=Le.base?Le.base.connectorColor:Le.nodeColor,Le.borderColor=Le.base?Le.base.connectorBorderColor:fe}),ce=[],L.stage.off("stagemousedown",q),q=null,L.stage&&L.stage.update()}function Ye(Le,Ze,ze){var ve=ce.length>0?ce:[Le];t.loop(ve,function(Pe){Pe!=Le&&Pe.loc(Pe.startX+Le.x-Le.startX,Pe.startY+Le.y-Le.startY),Pe.creator&&Pe.creatorLine.setPoints(Pe.x,Pe.y,Pe.creator.x,Pe.creator.y,Ze,ze),t.loop(Pe.creations,function(ae){ae.creatorLine.setPoints(ae.x,ae.y,ae.creator.x,ae.creator.y,Ze,ze)})})}function $e(Le,Ze){if(t.loop(Le.creations,function(ve){$e(ve)},!0),Le.creatorLine){Le.creatorLine.removeFrom();var ze=Le.creator.creations.indexOf(Le);ze!=-1&&Le.creator.creations.splice(ze,1),!Le.creator.mouseEnabled&&!(Z&&!Le.creator.creator)&&Le.creator.mouse()}return Le.removeFrom(),Le.removeAllEventListeners(),Ze?we--:pe(Le.nodeNum,1),Le=null,L}this.removeNode=function(Le){$e(Le)},this.removeConnectors=function(){t.loop(Q,function(Le){$e(Le)},!0),Ae(),L.stage&&L.stage.update()},this.removeBase=function(Le){t.loop(Le.connectors,function(Ze){$e(Ze)}),it(Le)},this.addBase=function(Le,Ze){le(Le,Ze)};function it(Le){Le.off("pressmove",Le.connectorMoveEvent),Le.off("pressup",Le.connectorUpEvent),Le.connectorOverEvent&&Le.off("mouseover",Le.connectorOverEvent),Le.connectorOutEvent&&Le.off("mouseout",Le.connectorOutEvent),Le.connectors=null,Le.baseStart=null,Le.positionConnectors=Le.setConnectorColors=null,Le.connectorColor=Le.connectorBorderColor=Le.connectorRollColor=Le.connectorRollBorderColor=null,L.bases.splice(L.bases.indexOf(Le),1),L.stage&&L.stage.update()}V&&L.added(function(){L.setSteps(V),L.stage.update()}),Object.defineProperty(this,"selectedList",{get:function(){return ce},set:function(){vt&&tt("Selectors() - selectedList is read only")}}),this.dispose=function(Le,Ze,ze){return L.nodes.loop(function(ve){ve.removeFrom(),ve.removeAllEventListeners(),ve=null},!0),L.lines.loop(function(ve){ve.removeFrom(),ve=null},!0),ee.removeEventListener("keydown",L.keyEvent),L.keyEvent=null,L.bases&&t.loop(L.bases,function(ve){it(ve)}),ze||(L.zimContainer_dispose(!0),L.stage&&L.stage.update()),!0},D!==!1&&t.styleTransforms(this,N),this.clone=function(){return L.cloneProps(new t.Connectors(e,r,i,l,a,s,f,u,y,k,g,O,t.copy(T),E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,L.group,h))}},t.extend(t.Connectors,t.Container,["clone","dispose"],"zimContainer",!1),t.Marquee=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d){var x="width, height, items, time, transition, speed, direction, marginLeft, marginRight, marqueeType, borderColor, borderWidth, refresh, mix, style, group, inherit",P;if(P=st(t.Marquee,arguments,x,this))return P;De("67.4"),this.group=C;var v=A===!1?{}:t.getStyle("Marquee",this.group,d),w=this;n(e)&&(e=v.width!=null?v.width:300),n(r)&&(r=v.height!=null?v.height:100);var b=Tt(l);n(l)&&(l=v.time!=null?v.time:b=="s"?5:5e3),n(a)&&(a=v.transition!=null?v.transition:"slide"),n(g)&&(g=v.borderColor!=null?v.borderColor:t.dark),n(O)&&(O=v.borderWidth!=null?v.borderWidth:1),g<0||O<0?g=O=null:g!=null&&O==null&&(O=1),n(u)&&(u=v.marginLeft!=null?v.marginLeft:25),n(y)&&(y=v.marginRight!=null?v.marginRight:25),n(s)&&(s=v.speed!=null?v.speed:b=="s"?.5:500),Pt(s,b),n(f)&&(f=v.direction!=null?v.direction:"right"),n(T)&&(T=v.refresh!=null?v.refresh:b=="s"?30*60:30*60*1e3),n(E)&&(E=v.mix!=null?v.mix:!0),this.zimContainer_constructor(e+u+y,r,null,null,!1),this.type="Marquee",this.speed=s;var X=new t.Rectangle(e-1,r-1,t.clear).addTo(w).mov(u+.5,.5),Y=this.content=new t.Container(e,r).loc(u,0,w).setMask(X),m=this.pages=new t.Pages(null,a,s,null,Y).addTo(Y),j=!1;this.add=function(p,L,we,B,F){n(F)&&(F=!0),p.scaleTo(Y,100,100),L&&p.cur().on("click",function(){ir(L,we)}),m.addPage(p),F&&m.center(),p.marqueeViews=0,p.marquee=w,j||S(),B||D(),N&&N.top()},this.remove=function(p){if(w.selected==p){if(w.pages.pages.length==1)return;var L=w.selectedIndex+1;L==w.pages.pages.length&&(L=0),w.pages.go(L,null,null,0),setTimeout(function(){w.pages.removePage(p),p.dispose&&p.dispose(),D()},20)}else w.pages.removePage(p),p.dispose&&p.dispose(),D()};function S(){j=!0,w.selectedIndex=0,w.selected=m.pages[w.selectedIndex].page,w.lastSelected=null,w.selected.marqueeOn&&w.selected.marqueeOn(),w.interval=t.interval(l,function(){w.go()})}if(!n(i)&&!Array.isArray(i)&&(i=[i]),i&&i.length>0&&(E&&t.shuffle(i),t.loop(i,function(p){w.add(p,null,null,!0)})),T>0)var _=t.timeout(T*(b=="s"?1e3:1),function(){location.reload()},null,"ms");w.go=function(p){if(w.selected.marqueeViews+=1,w.selected.marqueeOff&&w.selected.marqueeOff(),p)w.selected=p,t.loop(m.pages,function(we,B){if(we.page==p){w.selectedIndex=B;return}}),w.interval.interval=w.selected.marqueeTime?w.selected.marqueeTime:l,w.interval.pause(ne.toggled,null,!0);else{var L=w.selectedIndex+1;w.selectedIndex=L%m.pages.length,w.selected=m.pages[w.selectedIndex].page,w.interval.time=w.selected.marqueeTime?w.selected.marqueeTime:l}w.dispatchEvent("page"),w.selected.marqueeOn&&w.selected.marqueeOn(),m.go(w.selected,f,a,s)},m.on("pagetransitioned",function(){w.dispatchEvent("pagetransitioned"),w.indicator&&(w.indicator.selectedIndex=w.selectedIndex)});var R=!1,U=w.left=new t.Container(u-4,r-4),Z=new t.Shape().sca(.6);Z.graphics.f(t.light).mt(0,0).p("AAhCLIAAkVIBXAAIAAEVgAh3CLIAAkVIBXAAIAAEVg");var K=new t.Shape().sca(.6).reg(-2,0);K.graphics.f(t.light).mt(0,0).p("AiJieIETCeIkTCfg");var ne=w.button=new t.Button({label:"",icon:Z,toggleIcon:K,width:45,height:45,corner:0,shadowBlur:0}).scaleTo(U,100).pos(0,0,!1,!0,U);ne.on("click",function(){w.interval&&w.interval.pause(ne.toggled),R=ne.toggled,w.stage.update()});var V;function D(){if(!(n(u)||u==0)){var p=4*u/25;U.pos(u-U.width-p,p/2,!1,!0,w),w.indicator&&(w.indicator.dispose(),w.indicator.removeFrom()),V||(V=new t.Proportion(8,16,U.width+p,U.width/2+p,-1)),w.indicator=new t.Indicator({width:(m.pages.length<=2?m.pages.length:m.pages.length-1)*(U.width-3),height:V.convert(m.pages.length),num:m.pages.length,shadowBlur:-1,interactive:!0,scale:1.2,indicatorType:k}),w.indicator.fit(0,0,r-ne.height,ne.width),w.indicator.rot(f=="down"?-90:90).center(U).pos(null,U.width-p/2,null,!0),w.indicator.selectedIndex=w.selectedIndex,w.indicator.on("change",function(){w.go(m.pages[w.indicator.selectedIndex].page)})}}if(D(),!n(y)&&y>0&&ee.zdf&&ee.zdf){var c=4*y/25,h=w.right=new t.Container(45,270),o=w.icon=ee.zdf.makeIcon(t.grey,t.lighter,t.silver).sca(.5).pos(0,0,!0,!0,h).mov(0,0).cur();o.on("mouseover",function(){I.animate({props:{scaleX:1},time:500,ease:"backOut",override:!0,timeUnit:"ms"}),o.stage.update()}),o.on("mouseout",function(){I.animate({props:{scaleX:0},time:300,ease:"backIn",override:!0,timeUnit:"ms"}),o.stage.update()}),o.on("mousedown",function(){ir("https://zimjs.com/marquee","_blank")});var I=w.label=new t.Label({text:"MARQUEE",color:t.dark,backgroundColor:t.lighter,shiftV:1,paddingV:5}).rot(-90).pos(0,13,!0,!1,h).reg(-10).sca(0,1).mov(0);h.fit(0,0,y-c,r-c),h.pos(y-h.width-c,c/2,!0,!0,w)}if(w.stage&&w.stage.update(),this.pause=function(p,L){n(p)&&(p=!0),p!=R&&(R=p,w.interval.pause(p,L),w.button.toggle(p))},Object.defineProperty(this,"paused",{get:function(){return R},set:function(){vt&&tt("Marquee() - paused is read only - use pause()")}}),Object.defineProperty(this,"time",{get:function(){return l},set:function(p){l=p,w.interval.time=l}}),this.load=function(p,L){var we=[];E&&t.shuffle(p),t.loop(p,function(F){Array.isArray(F)?we.push(F[0]):we.push(F)});var B=w.stage?w.stage.frame:ee.zdf;return w.marqueeLoader=B.loadAssets(we,L),w.loadEvent=w.marqueeLoader.on("assetload",function(F){var fe=p[F.asset.id],se,Q;Array.isArray(fe)?(se=fe[0],Q=fe[1]):(se=fe,Q="_self"),w.add(F.asset,se,Q),D()}),w},!n(g)){var N=new t.Rectangle(e-1,r-1,t.clear,g,O).loc(X,null,w);N.mouseEnabled=!1}A!==!1&&t.styleTransforms(this,v),this.clone=function(){return w.cloneProps(new t.Marquee(e,r,i,l,a,s,f,k,g,O,T,E,A,this.group,d))},this.dispose=function(p,L,we){return _&&_.clear(),w.interval&&w.interval.clear(),w.loadEvent&&w.marqueeLoader.off("assetload",w.loadEvent),m.dispose(),m=null,we||this.zimContainer_dispose(!0),!0}},t.extend(t.Marquee,t.Container,["clone","dispose"],"zimContainer"),t.Carousel=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w){var b="items, viewNum, time, spacing, backgroundColor, backing, padding, paddingH, paddingV, arrowLeft, arrowRight, arrowGap, valign, ease, swipe, remember, selectedIndex, continuous, style, group, inherit",X;if(X=st(t.Carousel,arguments,b,this))return X;De("67.45"),this.group=v;var Y=P===!1?{}:t.getStyle("Carousel",this.group,w),m=this;this.zimContainer_constructor(),n(e)&&(e=Y.items!=null?Y.items:[new Mn({color:red}),new Mn({color:orange}),new Mn({color:yellow}),new Mn({color:green}),new Mn({color:blue}),new Mn({color:purple}),new Mn({color:pink})]),n(a)&&(a=Y.backgroundColor!=null?Y.backgroundColor:t.clear),n(s)&&(s=Y.backing!=null?Y.backing:null),n(T)&&(T=Y.valign!=null?Y.valign:"center"),n(r)&&(r=Y.viewNum!=null?Y.viewNum:3),n(l)&&(l=Y.spacing!=null?Y.spacing:20),n(f)&&(f=Y.padding!=null?Y.padding:0),n(u)&&(u=Y.paddingH!=null?Y.paddingH:f),n(y)&&(y=Y.paddingV!=null?Y.paddingV:f),n(k)&&(k=Y.arrowLeft!=null?Y.arrowLeft:new t.Arrow().rot(180)),n(g)&&(g=Y.arrowRight!=null?Y.arrowRight:new t.Arrow),n(O)&&(O=Y.arrowGap!=null?Y.arrowGap:20);var j=Tt(i);n(i)&&(i=Y.time!=null?Y.time:j=="s"?.2:200),n(E)&&(E=Y.ease!=null?Y.ease:"quadInOut"),n(A)&&(A=Y.swipe!=null?Y.swipe:!0),n(C)&&(C=Y.remember!=null?Y.remember:"zimCarousel"),n(d)&&(d=Y.selectedIndex!=null?Y.selectedIndex:0),n(x)&&(x=Y.continuous!=null?Y.continuous:!0),C&&localStorage&&!n(localStorage[C])&&(localStorage[C]=="NaN"&&(localStorage[C]=0),d=Number(localStorage[C])),m.items=e,m.viewNum=r,m.spacing=l,m.arrowLeft=k,m.arrowRight=g,m.arrowLeft.oW=k.width,m.arrowRight.oW=g.width,s&&(m.backing=s);var S={};t.loop(e,function(o,I){typeof o=="string"&&(o=e[I]=new t.Pic(o)),o.reg(CENTER,CENTER);var N=S["width"+o.width];N?S["width"+o.width]+=1:S["width"+o.width]=1});var _=0,R=0;t.loop(S,function(o,I){I>_&&(_=I,R=Number(o.substring(5)))});var U=0;t.loop(e,function(o){o.width=R,o.height>U&&(U=o.height)});var Z;x?(m.continuous=!0,Z=t.copy(e),t.loop(e.length,function(o){Z.push(e[o].duplicate())})):Z=e,m.itemWidth=R,m.itemHeight=U;var K=k.width+O+u,ne;function V(){var o=r*(R+l)-l,I=U;ne=o+u*2+O*2+k.width+g.width,m.setBounds(0,0,ne,I+y*2),m.tile=new t.Tile({obj:Z,cols:Z.length,spacingH:l,rows:1,unique:!0,align:"center",valign:T}).center(m).loc(K),m.background=new Mn(o+u*2,I+y*2,a).center(m,0),m.tile.setMask(m.background)}function D(){k.pos(0,0,"left","center",m),g.pos(0,0,"right","center",m),k.on("mousedown",function(){m.cycleInterval&&(m.cycleClear(),m.dispatchEvent("cyclecleared")),m.goLeft()}),g.on("mousedown",function(){m.cycleInterval&&(m.cycleClear(),m.dispatchEvent("cyclecleared")),m.goRight()}),h()}function c(){if(m.swipe){var o=m.swipeObj=new t.Swipe(m.tile);o.on("swipe",function(I){I.swipeX!=0&&m.cycleInterval&&(m.cycleClear(),m.dispatchEvent("cyclecleared")),I.swipeX==1?m.goLeft():I.swipeX==-1&&m.goRight()})}}function h(){localStorage&&C&&(localStorage[C]=m.selectedIndex),k.activate(!0),g.activate(!0),!x&&(m.tile.x+m.tile.width<=ne-g.oW-u-O&&g.activate(!1),m.tile.x>=K&&k.activate(!1))}m.goLeft=function(o){return n(o)&&(o=i),x&&m.tile.x>=-R&&(m.tile.x-=m.tile.width/2+l/2),m.tile.x<K&&(m.disableArrows(),d--,m.tile.animate({props:{x:m.tile.x+R+l},time:o,ease:E,call:function(){h(),m.enableArrows(),m.dispatchEvent("transitioned")}})),m},m.goRight=function(o){return n(o)&&(o=i),x&&m.tile.x-R<=ne-m.tile.width&&(m.tile.x+=m.tile.width/2+l/2),m.tile.x+m.tile.width>ne-g.oW-u-O&&(m.disableArrows(),d++,m.tile.animate({props:{x:m.tile.x-R-l},time:o,ease:E,call:function(){h(),m.enableArrows(),m.dispatchEvent("transitioned")}})),m},m.cycleClear=function(){return m.cycleInterval.clear(),m.cycleInterval=null,m},m.cycle=function(o,I,N,p,L,we){var B="cycleTime, transitionTime, repeat, repeatNum, recycle, rtl",F;if(F=st(m.cycle,arguments,B))return F;n(o)&&(o=Y.cycleTime!=null?Y.cycleTime:j=="s"?5:5e3),n(I)&&(I=Y.transitionTime!=null?Y.transitionTime:j=="s"?1:1e3),n(N)&&(N=!0),n(p)&&(p=0),n(L)&&(L=o*2),n(we)&&(we=ee.DIR&&ee.DIR=="rtl"||!ee.DIR&&t.DIR=="rtl");let fe=we?-1:1;return m.cycleInterval&&m.cycleInterval.clear(),L&&L!=-1&&(m.recycleEvent&&m.off("cyclecleared",m.recycleEvent),m.recycleWait&&m.recycleWait.clear(),m.recycleEvent=m.on("cyclecleared",function(){m.recycleWait&&m.recycleWait.clear(),m.recycleWait=zr(L,function(){m.cycle(o,I,N,p,L,we)})})),x?(m.repeatTotal=0,m.cycleInterval=t.interval(o*2,function(se){if(m.selectedIndex==0)if(!N&&we)m.cycleInterval.clear();else{if(we&&se.count!=1&&(m.repeatTotal+=1),we&&p!=0&&m.repeatTotal>=p){m.cycleInterval.clear(),m.dispatchEvent("repeatdone");return}fe==1?m.goRight(I):m.goLeft(I)}else if(m.selectedIndex==e.length-r){if(!we&&se.count!=1&&(m.repeatTotal+=1),!we&&p!=0&&m.repeatTotal>=p){m.cycleInterval.clear(),m.dispatchEvent("repeatdone");return}m.repeatTotal>=1&&m.dispatchEvent("repeated"),!we&&!N?m.cycleInterval.clear():fe==1?m.goRight(I):m.goLeft(I)}else fe==1?m.goRight(I):m.goLeft(I)})):(m.repeatTotal=.5,m.cycleInterval=t.interval(o*2,function(se){if(m.selectedIndex==0){if(se.count!=1&&(m.repeatTotal+=.5),p!=0&&m.repeatTotal>p){m.cycleInterval.clear(),m.dispatchEvent("bouncedone");return}m.repeatTotal>=1&&m.dispatchEvent("bounced"),fe=1,m.goRight(I)}else if(m.selectedIndex==e.length-r){if(se.count!=1&&(m.repeatTotal+=.5),p!=0&&m.repeatTotal>p){m.cycleInterval.clear(),m.dispatchEvent("bouncedone");return}m.repeatTotal>=1&&m.dispatchEvent("bounced"),fe=-1,m.goLeft(I)}else Yr(),fe==1?m.goRight(I):m.goLeft(I)})),m},m.enableArrows=function(){return m.swipeObj&&(m.swipeObj.active=!0),k.mouse(),g.mouse(),m},m.disableArrows=function(){return m.swipeObj&&(m.swipeObj.active=!1),k.noMouse(),g.noMouse(),m},Object.defineProperty(m,"selectedIndex",{get:function(){return(d+e.length)%e.length},set:function(o){d=t.constrain(o,0,e.length-r),m.tile.x=K-d*(R+l),h()}}),Object.defineProperty(m,"swipe",{get:function(){return A},set:function(o){A=o,A&&!m.swipeObj&&c(),m.swipeObj.active=A}}),V(),D(),c(),s&&s.center(m,1),d&&(m.selectedIndex=d),this.dispose=function(o,I,N){return m.swipeObj&&m.swipeObj.dispose(),m.recycleEvent&&m.off("cyclecleared",m.recycleEvent),m.cycleWait&&m.cycleWait.clear(),m.cycleInterval&&m.cycleInterval.clear(),m.swipeObj=m.recycleEvent=m.cycleWait=null,N||this.zimContainer_dispose(),!0},P!==!1&&t.styleTransforms(this,Y),this.clone=function(){for(var o=[],I=0;I<e.length;I++){var N=e[I];N.duplicate?o.push(N.duplicate()):N.clone?o.push(N.clone()):o.push(t.copy(e[I]))}return m.cloneProps(new t.Carousel(o,r,i,l,a,s,f,u,y,k.duplicate(),g.duplicate(),O,T,E,A,C,d,x,P,this.group))}},t.extend(t.Carousel,t.Container,["clone","dispose"],"zimContainer",!1),t.Loader=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D){var c="width, height, label, type, backgroundColor, rollBackgroundColor, color, rollColor, borderColor, rollBorderColor, borderWidth, corner, shadowColor, shadowBlur, hitPadding, gradient, gloss, dashed, backing, rollBacking, rollPersist, icon, rollIcon, toggle, toggleBacking, rollToggleBacking, toggleIcon, rollToggleIcon, toggleEvent, frame, multiple, accept, style, group, inherit",h;if(h=st(t.Loader,arguments,c,this))return h;De("67.5"),this.group=V;var o=ne===!1?{}:t.getStyle("Loader",this.group,D);if(n(e)&&(e=o.width!=null?o.width:250),n(r)&&(r=o.height!=null?o.height:70),n(l)&&(l=o.type!=null?o.type:"image"),l=l.toLowerCase(),n(a)&&(a=o.backgroundColor!=null?o.backgroundColor:"rgba(0,0,0,.05)"),n(s)&&(s=o.rollBackgroundColor!=null?o.rollBackgroundColor:"rgba(0,0,0,.1)"),n(f)&&(f=o.color!=null?o.color:"rgba(0,0,0,.5)"),n(u)&&(u=o.rollColor!=null?o.rollColor:f),n(y)&&(y=o.borderColor!=null?o.borderColor:"rgba(0,0,0,.3)"),n(g)&&(g=o.borderWidth!=null?o.borderWidth:1),n(x)&&(x=o.dashed!=null?o.dashed:!0),n(O)&&(O=o.corner!=null?o.corner:0),n(Z)&&(Z=o.multiple!=null?o.multiple:!0),n(i)&&(i=o.label!=null?o.label:new t.Label({text:"UPLOAD PIC",color:f,rollColor:u,valign:"center",align:"center",backing:"ignore",shadowColor:"ignore",shadowBlur:"ignore",backgroundColor:"ignore",group:this.group})),typeof U>"u")if(ee.zdf)var U=ee.zdf;else{vt&&tt("zim.Loader - please provide a reference to zim Frame");return}this.zimButton_constructor(e,r,i,a,s,null,f,u,null,y,g,k,null,P,v,null,b,X,null,O,x,T,E,C,d,null,null,null,null,null,A,null,null,null,w,Y,null,null,null,null,null,null,m,j,null,S,_,null,R,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,!1),this.type="Loader";var I=this,N=U.stage;i=I.label;var p=I.tag=document.createElement("input");U.tag?U.tag.appendChild(p):document.body.appendChild(p),p.setAttribute("type","file"),p.setAttribute("aria-hidden",!0),Z&&p.setAttribute("multiple","multiple"),K&&p.setAttribute("accept",K),p.hidden=!0,p.zimDisplay=p.style.display||"inline-block",p.style.cssText="border:thin solid grey; z-index:2; width:"+e+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none; cursor:pointer; opacity: 0; filter: alpha(opacity=0);",this.addEventListener("mousedown",function(){p.click()}),p.addEventListener("change",F);var L=new Fe.DOMElement(p);N.addChild(L),L.alpha=0;var we=U.retina&&ee.devicePixelRatio||1;this.resize=function(Q,te){if(!I.stage){p.setAttribute("aria-hidden",!0),p.hidden=!0,p.style.display="none";return}p.setAttribute("aria-hidden",!1),p.hidden=!1,p.style.display=p.zimDisplay,n(Q)&&(Q=!0),I.time1&&clearTimeout(I.time1),te||(I.time1=setTimeout(function(){I.resize(null,!0)},40));var le=I.getConcatenatedMatrix().decompose(),Ae=I.localToGlobal(0,0);if(U.retina){var J=t.browserZoom();U.tag?(L.x=Ae.x/we/J,L.y=Ae.y/we/J):(L.x=U.x/N.scaleX+Ae.x/we/J,L.y=U.y/N.scaleY+Ae.y/we/J),t.sca(L,le.scaleX/we/N.scaleX/J,le.scaleY/we/N.scaleY/J)}else L.x=U.x+Ae.x*U.scale,L.y=U.y+Ae.y*U.scale,t.sca(L,U.scale*le.scaleX,U.scale*le.scaleY);return N.update(),I},this.resize(),I.on("added",function(){p.style.display="block",p.hidden=!1,p.style.display="block",I.resize()}),I.added(B);function B(){I.resize(),I.time2=setTimeout(function(){p.style.display="block",p.hidden=!1,p.style.display="block"},50),I.on("added",B,null,!0)}I.on("removed",function(){I.time1&&clearTimeout(I.time1),I.time2&&clearTimeout(I.time2),p&&(p.style.display="none",p.hidden=!0,p.style.display="none")});function F(Q){var te;if(Q.dataTransfer&&Q.dataTransfer.files&&Q.dataTransfer.files.length>0?te=Q.dataTransfer.files:te=Q.target.files,l=="text"||l=="json"){var le=[],Ae;if(l.toLowerCase()=="json")var J=[],Te}else if(l=="other")var G=[],ce;else var q=[],ue;for(var ge=0;ge<te.length;ge++)(function(ie){var xe=new FileReader;xe.onload=function(Se){if(l=="text"||l=="json"){var z=Se.target.result;if(le.push(z),l=="json"){var pe=t.parseJSON(z);J.push(pe)}if(le.length==1&&(Ae=z,l=="json"&&(Te=pe)),le.length==te.length){var de=new Fe.Event("loaded");de.texts=le,de.text=Ae,de.lastText=z,de.total=le.length,l=="json"&&(de.jsons=J,de.json=Te,de.lastJSON=pe),I.dispatchEvent(de),p.value=""}}else if(l=="other"){var oe=Se.target.result;if(G.push(oe),G.length==1&&(ce=oe),G.length==te.length){var de=new Fe.Event("loaded");de.others=G,de.other=ce,de.lastOther=oe,de.total=G.length,I.dispatchEvent(de),p.value=""}}else{var Be=new Image;Be.onload=function(){var $=new t.Bitmap(Be);if(q.push($),q.length==1&&(ue=$),q.length==te.length){var Me=new Fe.Event("loaded");Me.bitmaps=q,Me.bitmap=ue,Me.lastBitmap=$,Me.total=q.length,I.dispatchEvent(Me),p.value=""}},Be.src=Se.target.result}},l=="text"||l=="json"?xe.readAsText(ie):xe.readAsDataURL(ie)})(te[ge])}var fe=new XMLHttpRequest;if(fe.upload){var se=function(Q){p.removeEventListener("change",F),F(Q),setInterval(function(){p.addEventListener("change",F)},100)};p.addEventListener("drop",se)}this.save=function(Q,te,le,Ae,J,Te,G,ce,q,ue,ge){var ie="content, filename, x, y, width, height, cached, cachedBounds, type, data, quality",xe;if(xe=st(I.save,arguments,ie))return xe;if(n(Q)&&(Q=U.stage),n(q)&&(q="png"),n(te))te="saved_"+String(t.makeID("numbers",5))+"."+q;else{var Se=te.split(".");if(Se.length==1)te+="."+q;else{var z=["png","jpg","jpeg"],pe=z.indexOf(Se[Se.length-1].toLowerCase());pe==-1?te+="."+q:q=z[pe]}}if(n(le)&&(le=0),n(Ae)&&(Ae=0),n(J)&&(J=Q.getBounds&&Q.getBounds()?Q.getBounds().width:U.width),n(Te)&&(Te=Q.getBounds&&Q.getBounds()?Q.getBounds().height:U.height),Q.cache(le,Ae,J,Te),ue){var de=Q.cacheCanvas.toDataURL("image/"+q,ge);return G?ce&&Q.cache(ce.x,ce.y,ce.width,ce.height):Q.uncache(),de}var oe=/Edge\/(\d)+/.test(navigator.userAgent);if(oe){var Be=ee.open();Be.document.write("<html><head><title>saved</title></head><body style='margin:0px;padding:0px;overflow:hidden'><img src="+Q.cacheCanvas.toDataURL("image/"+q)+"></body></html>"),Be.document.close()}else{q=="jpg"&&(q="jpeg");var $=document.createElement("a");$.setAttribute("download",te),$.setAttribute("href",Q.cacheCanvas.toDataURL("image/"+q,ge)),document.body.appendChild($),$.click(),document.body.removeChild($)}return G?ce&&Q.cache(ce.x,ce.y,ce.width,ce.height):Q.uncache(),I},ne!==!1&&t.styleTransforms(this,o),this.clone=function(){var Q=new t.Loader(e,r,n(i)?null:i.clone(),a,s,f,u,y,g,O,T,E,A,C,d,n(P)?null:P.clone(),n(v)?null:v.clone(),w,n(b)?null:b.clone(),n(X)?null:X.clone(),Y,n(m)?null:m.clone(),n(j)?null:j.clone(),n(S)?null:S.clone(),n(_)?null:_.clone(),R,U,ne,this.group);return I.cloneProps(Q)},Object.defineProperty(this,"frame",{get:function(){return U},set:function(Q){Q!=U&&(U.off("update",I.updateEvent),U.off("resize",I.resizeEvent),U=Q,I.resizeEvent=U.on("resize",I.resize),I.updateEvent=U.on("update",I.resize),I.resize())}}),this.resizeEvent=U.on("resize",I.resize),this.updateEvent=U.on("update",I.resize),this.dispose=function(Q,te,le){var Ae;return I.stage&&(Ae=I.stage),U.off("update",I.updateEvent),U.off("resize",I.resizeEvent),F&&p.removeEventListener("change",F),se&&p.removeEventListener("drop",se),p&&p.parentNode&&p.parentNode.removeChild(p),p=null,le||(this.zimButton_dispose(),Ae&&Ae.update()),!0}},t.extend(t.Loader,t.Button,["clone","dispose"],"zimButton",!1),t.TextArea=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S){var _="width, height, placeholder, text, size, padding, color, backgroundColor, borderColor, borderWidth, corner, shadowColor, shadowBlur, dashed, id, readOnly, spellCheck, password, inputType, wrap, maxLength, frame, expand, keyboardShift, style, group, inherit",R;if(R=st(t.TextArea,arguments,_,this))return R;De("67.6"),this.group=j;var U=m===!1?{}:t.getStyle("TextArea",this.group,S);if(n(e)&&(e=U.width!=null?U.width:250),n(r)&&(r=U.height!=null?U.height:70),n(i)&&(i=U.placeholder!=null?U.placeholder:null),n(l)&&(l=U.text!=null?U.text:null),n(a)&&(a=U.size!=null?U.size:20),n(s)&&(s=U.padding!=null?U.padding:5),n(f)&&(f=U.color!=null?U.color:t.granite),n(u)&&(u=U.backgroundColor!=null?U.backgroundColor:"rgba(256,256,256,.1)"),n(y)&&(y=U.borderColor!=null?U.borderColor:"rgba(0,0,0,.1)"),n(k)&&(k=U.borderWidth!=null?U.borderWidth:null),y<0||k<0?y=k=null:y!=null&&k==null&&(k=1),n(g)&&(g=U.corner!=null?U.corner:0),!n(T)&&n(O)&&(O=U.shadowColor!=null?U.shadowColor:"rgba(0,0,0,.3)"),!n(O)&&n(T)&&(T=U.shadowBlur!=null?U.shadowBlur:10),n(x)&&(x=U.password!=null?U.password:!1),n(P)&&(P=U.inputType!=null?U.inputType:!1),n(v)&&(v=U.wrap!=null?U.wrap:!0),n(w)&&(w=U.maxLength!=null?U.maxLength:null),n(d)&&(d=U.spellCheck!=null?U.spellCheck:!0),n(C)&&(C=U.readOnly!=null?U.readOnly:!1),n(Y)&&(Y=U.keyboardShift!=null?U.keyboardShift:!1),this.maxLength=w,n(X)&&(X=U.expand!=null?U.expand:20),X===!0&&(X=20),typeof b>"u")if(ee.zdf)var b=ee.zdf;else{vt&&tt("zim.TextArea - please provide a reference to zim Frame");return}this.zimContainer_constructor(e,r,null,null,!1),this.type="TextArea";var Z=this,K=b.stage,ne=this.background=new t.Rectangle(e,r,u,y,k,g,E,null,null,!1).expand(X);O!=-1&&T>0&&(ne.shadow=new Fe.Shadow(O,3,3,T)),Z.addChild(ne);var V=Z.tag=P||x?document.createElement("input"):document.createElement("textarea");b.tag?b.tag.appendChild(V):document.body.appendChild(V),n(A)||(V.setAttribute("id",A),V.setAttribute("name",A)),x?V.setAttribute("type","password"):P&&V.setAttribute("type",P),V.readOnly=C,V.spellcheck=d,i&&V.setAttribute("placeholder",i),l&&(V.value=l),V.zimDisplay=V.style.display||"inline-block",V.style.cssText="background-color:rgba(0,0,0,.01); color:"+f+"; resize:none; z-index:3; width:"+(e-s*2)+"px; height:"+(r-s*2)+"px; overflow:hidden; outline:none;font-size:"+a+"px; font-family:"+(U.font!=null?U.font:"arial")+"; border:none; position:absolute; left:0px; top:0px; display:none;",Z.taInput=function(){!n(Z.maxLength)&&Z.text.length>Z.maxLength&&(Z.text=Z.text.substring(0,Z.maxLength)),Z.dispatchEvent("input")};var D=Z.y;Z.taFocus=function(){if(ee.M&&Y){Z.re&&Z.stage.frame.off("resize",Z.re),Z.re=Z.stage.frame.on("resize",function(){Z.stage&&I>Z.stage.height/4&&(Z.stage.y=Z.stage.scaleY*(Z.stage.height/4-I),Z.stage.update())});var I=Z.localToGlobal(0,0).y;Z.stage&&I>Z.stage.height/4&&(Z.stage.y=Z.stage.scaleY*(Z.stage.height/4-I),Z.stage.update())}Z.stage&&(b=Z.stage.frame),b.zil&&ee.removeEventListener("keydown",b.zil[0]),Z.dispatchEvent("focus")},Z.taBlur=function(){ee.M&&Y&&Z.stage&&(Z.re&&Z.stage.frame.off("resize",Z.re),Z.stage.y=D,Z.stage.update()),Z.stage&&(b=Z.stage.frame),b.zil&&ee.addEventListener("keydown",b.zil[0]),Z.dispatchEvent("blur")},V.addEventListener("change",Z.taChange),V.addEventListener("input",Z.taInput),V.addEventListener("focus",Z.taFocus),V.addEventListener("blur",Z.taBlur);var c=new Fe.DOMElement(V);c.alpha=0,this.on("mousedown",function(){setTimeout(function(){V.focus()},100)}),this.setFocus=function(I){return n(I)&&(I=!0),I?V.focus():V.blur(),Z};var h=b.retina&&ee.devicePixelRatio||1;this.resize=function(I,N){n(I)&&(I=!0),Z.time1&&clearTimeout(Z.time1),N||(Z.time1=setTimeout(function(){Z.resize(null,!0)},40));var p=Z.getConcatenatedMatrix().decompose(),L=Z.localToGlobal(s,s);if(b.retina){var we=t.browserZoom();b.tag?(c.x=L.x/h/we,c.y=L.y/h/we):(c.x=b.x/K.scaleX+L.x/h/we,c.y=b.y/K.scaleY+L.y/h/we),t.sca(c,p.scaleX/h/K.scaleX/we,p.scaleY/h/K.scaleY/we)}else b.tag?(c.x=L.x*b.scale,c.y=L.y*b.scale):(c.x=b.x+L.x*b.scale,c.y=b.y+L.y*b.scale),t.sca(c,b.scale*p.scaleX,b.scale*p.scaleY);return c.alpha=Z.alpha,Z.parent&&(c.alpha*=Z.parent.alpha),I&&Z.stage&&K.update(),Z},this.resize(),Z.added(o);function o(){K.addChild(c),Z.time2=setTimeout(function(){V.style.display=V.zimDisplay},50),Z.resize(),Z.on("added",o,null,!0),Z.FOEvent=K.on("stagemousedown",function(){Z.focus=!1})}Z.on("removed",function(){Z.time1&&clearTimeout(Z.time1),Z.time2&&clearTimeout(Z.time2),K.removeChild(c),Z.FOEvent&&K.off("stagemousedown",Z.FOEvent),V&&(V.style.display="none")}),Object.defineProperty(this,"currentValue",{get:function(){return V.value},set:function(I){V.value=I}}),Object.defineProperty(this,"text",{get:function(){return V.value},set:function(I){V.value=I}}),Object.defineProperty(this,"focus",{get:function(){return document.activeElement==V},set:function(I){Z.setFocus(I)}}),Object.defineProperty(this,"readOnly",{get:function(){return V.readOnly},set:function(I){V.readOnly=I}}),ee.KEYFOCUS!=null&&(t.KEYFOCUS=ee.KEYFOCUS),Object.defineProperty(this,"keyFocus",{get:function(){return t.KEYFOCUS==Z},set:function(){t.KEYFOCUS=Z}}),t.KEYFOCUS||(Z.keyFocus=!0),Z.taMousedown=function(){Z.keyFocus=!0},V.addEventListener("mousedown",Z.taMousedown),v||(V.style.whiteSpace="pre"),m!==!1&&t.styleTransforms(this,U),this.clone=function(){var I=new t.TextArea(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,this.group,S);return Z.cloneProps(I)},Object.defineProperty(this,"frame",{get:function(){return b},set:function(I){I!=b&&(b.off("update",Z.updateEvent),b.off("resize",Z.resizeEvent),b=I,Z.resizeEvent=b.on("resize",Z.resize),Z.updateEvent=b.on("update",Z.resize),h=b.retina&&ee.devicePixelRatio||1,K=b.stage,Z.resize())}}),this.resizeEvent=b.on("resize",Z.resize),this.updateEvent=b.on("update",Z.resize),this.dispose=function(I,N,p){var L;return Z.stage&&(L=Z.stage),b.off("update",Z.updateEvent),b.off("resize",Z.resizeEvent),L&&Z.FOEvent&&L.off("stagemousedown",Z.FOEvent),V&&V.parentNode&&V.parentNode.removeChild(V),V.removeEventListener("change",Z.taChange),V.removeEventListener("input",Z.taInput),V.removeEventListener("focus",Z.taFocus),V.removeEventListener("blur",Z.taBlur),V.removeEventListener("mousedown",Z.taMousedown),V=null,p||(this.zimContainer_dispose(!0),L&&L.update()),Z.background=null,!0}},t.extend(t.TextArea,t.Container,["clone","dispose"],"zimContainer",!1),t.Tag=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="width, height, id, frame, backgroundColor, padding, paddingH, paddingV, expand, style, group, inherit",E;if(E=st(t.Tag,arguments,T,this))return E;De("67.7"),this.group=g;var A=k===!1?{}:t.getStyle("Tag",this.group,O);if(n(e)&&(e=A.width!=null?A.width:250),n(r)&&(r=A.height!=null?A.height:70),n(i)&&(i=A.id!=null?A.id:"zimTag_"+t.rand(1e4)),typeof l>"u")if(ee.zdf)var l=ee.zdf;else{vt&&tt("zim.Tag - please provide a reference to zim Frame");return}n(a)&&(a=A.backgroundColor!=null?A.backgroundColor:"rgba(0,0,0,0)"),n(s)&&(s=A.padding!=null?A.padding:10),n(f)&&(f=A.paddingH!=null?A.paddingH:s),n(u)&&(u=A.paddingV!=null?A.paddingV:s),n(y)&&(y=A.expand!=null?A.expand:20),y===!0&&(y=20),this.zimContainer_constructor(e,r,null,null,!1),this.type="Tag",this.tagID=i,this.id=i;var C=this,d=l.stage;C.background=new t.Rectangle(e+f,r+u,a).center(this).expand(y||0);var x=C.tag=document.createElement("div");l.tag?l.tag.appendChild(x):document.body.appendChild(x),x.setAttribute("id",i),x.setAttribute("name",i),x.zimDisplay=x.style.display||"inline-block",x.style.cssText="resize:none; z-index:3; width:"+e+"px; height:"+r+"px; overflow:hidden; outline:none;position:absolute; left:0px; top:0px; display:none;";var P=new Fe.DOMElement(x);P.alpha=0;var v=l.retina&&ee.devicePixelRatio||1;this.resize=function(b,X){n(b)&&(b=!0),C.time1&&clearTimeout(C.time1),X||(C.time1=setTimeout(function(){C.resize(null,!0)},40));var Y=C.getConcatenatedMatrix().decompose(),m=C.localToGlobal(0,0);if(l.retina){var j=t.browserZoom();l.tag?(P.x=m.x/v/j,P.y=m.y/v/j):(P.x=l.x/d.scaleX+m.x/v/j,P.y=l.y/d.scaleY+m.y/v/j),t.sca(P,Y.scaleX/v/d.scaleX/j,Y.scaleY/v/d.scaleY/j)}else P.x=l.x+m.x*l.scale,P.y=l.y+m.y*l.scale,t.sca(P,l.scale*Y.scaleX,l.scale*Y.scaleY);return P.alpha=C.alpha,C.parent&&(P.alpha*=C.parent.alpha),b&&C.stage&&d.update(),C},this.resize(),C.added(w);function w(){d.addChild(P),C.time2=setTimeout(function(){x.style.display=x.zimDisplay},50),C.resize(),C.on("added",w,null,!0)}C.on("removed",function(){C.time1&&clearTimeout(C.time1),C.time2&&clearTimeout(C.time2),d.removeChild(P),x&&(x.style.display="none")}),this.add=function(b){return x.innerHTML+=b,C},Object.defineProperty(this,"innerHTML",{get:function(){return x.innerHTML},set:function(b){x.innerHTML=b}}),Object.defineProperty(this,"style",{get:function(){return x.style},set:function(b){x.style=b}}),k!==!1&&t.styleTransforms(this,A),this.clone=function(){var b=new t.Tag(e,r,i,l,a,s,f,u,y,k,this.group,O);return C.cloneProps(b)},Object.defineProperty(this,"frame",{get:function(){return l},set:function(b){b!=l&&(l.off("update",C.updateEvent),l.off("resize",C.resizeEvent),l=b,C.resizeEvent=l.on("resize",C.resize),C.updateEvent=l.on("update",C.resize),C.resize())}}),this.resizeEvent=l.on("resize",C.resize),this.updateEvent=l.on("update",C.resize),this.dispose=function(b,X,Y){var m;return C.stage&&(m=C.stage),l.off("update",C.updateEvent),l.off("resize",C.resizeEvent),x&&x.parentNode&&x.parentNode.removeChild(x),x=null,Y||(this.zimContainer_dispose(!0),m&&m.update()),!0}},t.extend(t.Tag,t.Container,["clone","dispose"],"zimContainer",!1);function Ot(e,r){r?(e.mouseChildren=!0,e.mouseEnabled=!0,e._enabled=!0):(e.mouseChildren=!1,e.mouseEnabled=!1,e._enabled=!1)}if(t.addTo=function(e,r,i,l){var a="obj, container, index, localToLocal",s;if(s=st(t.addTo,arguments,a))return s;if(De("47.5"),n(e)){tt("zim methods - addTo(): please provide object");return}if(n(r))if(ee.zdf)r=ee.zdf.stage;else{tt("zim methods - addTo(): please provide container");return}if(n(l)&&(l=!0),e.parent||(l=!1),l)var f=e.parent.localToLocal(e.x,e.y,r);return n(i)||isNaN(i)?r.addChild(e):r.addChildAt(e,i),l&&(e.x=f.x,e.y=f.y),e},t.removeFrom=function(e,r){if(De("47.6"),n(e)){tt("zim methods - removeFrom(): please provide object");return}return e.removePhysics&&e.removePhysics(),n(r)?e.parent&&e.parent.removeChild(e):r.removeChild(e),e},t.added=function(e,r,i,l){if(De("47.7"),!(n(e)||n(r)||typeof r!="function")){var a=Tt(i);if(n(i)&&(i=a=="s"?.1:100),e.stage){r(e.stage,e);return}var s=i*(a=="s"?1e3:1),f;l&&(Pt(l),f=l*(a=="s"?1e3:1));var u=Date.now(),y=0,k=setInterval(function(){if(y>5){clearInterval(k);return}y++,e.stage&&(r(e.stage,e),clearInterval(k),clearInterval(g))},10),g=setInterval(function(){f>0&&u-Date.now()>f&&clearInterval(g),e.stage&&(r(e.stage,e),clearInterval(g))},s);return g}},t.centerReg=function(e,r,i,l){var a="obj, container, index, add",s;if(s=st(t.centerReg,arguments,a))return s;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("centerReg",arguments),e.addTo(r,i);if(De("48"),n(e)||!e.getBounds||!e.getBounds())return tt("zim methods - centerReg(): please provide object with bounds set"),e;n(l)&&(l=!0),n(r)&&e.parent&&l&&(r=e.parent,n(i)&&(i=e.parent.getChildIndex(e)),e.parent.removeChild(e)),!n(r)&&r==e.parent&&(n(i)&&(i=e.parent.getChildIndex(e)),e.parent.removeChild(e));var f=e.getBounds();return e.regX=f.x+f.width/2,e.regY=f.y+f.height/2,l?t.center(e,r,i):e},t.center=function(e,r,i,l){var a="obj, container, index, add",s;if(s=st(t.center,arguments,a))return s;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("center",arguments),e.addTo(r,i);if(t.centerCheck||(De("48.1"),t.centerCheck=!0),n(e)||!e.getBounds)return tt("zim.center(): please provide object with bounds"),e;if(n(r)&&(e.parent?r=e.parent:ee.zdf&&(r=ee.zdf.stage)),n(r)||!r.getBounds)return tt("zim.center(): please provide container with bounds"),e;var f=e.getBounds(),u=r.getBounds();n(l)&&(l=!0);var y=!1;if(n(u)&&(r.setBounds(0,0),u=r.getBounds(),y=!0),l&&r.addChild&&(n(i)||typeof i=="number"&&isNaN(i)?(!e.parent||e.parent!=r)&&r.addChild(e):r.addChildAt(e,i)),n(f))return e.x=u.x+u.width/2,e.y=u.y+u.height/2,e;var k=!1,g=!1;r.scaleX==0&&(k=!0,r.scaleX=1e-5),r.scaleY==0&&(g=!0,r.scaleY=1e-5);var O=e.localToLocal(e.regX,e.regY,r),T=t.boundsToGlobal(e),E=t.boundsToGlobal(r,T,!0);if(k&&(r.scaleX=0),g&&(r.scaleY=0),e.x=u.x+u.width/2-E.width/2+(O.x-E.x),e.y=u.y+u.height/2-E.height/2+(O.y-E.y),!l&&r.getStage&&r.stage&&e.parent){var A=r.localToLocal(e.x,e.y,e.parent);e.x=A.x,e.y=A.y}return y&&r.setBounds(null),e},t.place=function(e,r){if(De("49"),n(e))return;n(r)&&(r="obj"),t.lastPlace=e;function i(){tt(r+".x = "+Math.round(e.x)+"; "+r+".y = "+Math.round(e.y)+";"),tt(r+".loc("+Math.round(e.x)+", "+Math.round(e.y)+");")}t.drag({obj:e,currentTarget:!0,dragCursor:"crosshair"}),e.on("mousedown",function(){t.lastPlace=e});var l=ee.zdf;return l&&l.on("keydown",function(a){if(e==t.lastPlace){var s=a.keyCode;if(s>=37&&s<=40){var f=a.shiftKey?10:1;e.mov(s==37?-1*f:s==39?1*f:0,s==38?-1*f:s==40?1*f:0),i(),e.stage&&e.stage.update()}}}),tt("place "+r+" - to get new position",e),e.on("click",i),e},t.placeReg=function(e,r){if(De("49.5"),n(e))return;var i=e.stage;if(n(i))return tt("zim.placeReg() - add object to stage before calling placeReg()"),e;n(r)&&(r="obj");function l(){var f=e.globalToLocal(s.x,s.y);tt(r+".regX = "+Math.round(f.x)+"; "+r+".regY = "+Math.round(f.y)+";"),tt(r+".reg("+Math.round(f.x)+", "+Math.round(f.y)+");")}var a=e.parent.localToGlobal(e.x,e.y),s=new t.Shape(-25,-25,50,50,null,!1).addTo(i).pos({x:a.x,y:a.y,reg:!0});return s.graphics.s("white").mt(-25,0).lt(25,0).mt(0,-25).lt(0,20),s.compositeOperation="difference",s.expand(0),t.drag({obj:s}),tt("place cursor to get new registration point location"),i.on("stagemouseup",l),e},t.pos=function(e,r,i,l,a,s,f,u,y,k,g){var O="obj, x, y, horizontal, vertical, container, index, add, reg, regX, regY",T;if(T=st(t.pos,arguments,O))return T;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("pos",arguments),e.addTo(s,f);De("41.5"),ee.DIR&&ee.DIR=="rtl"||!ee.DIR&&t.DIR=="rtl"?l=="start"?l="right":l=="end"&&(l="left"):l=="start"?l="left":l=="end"&&(l="right");var E=!1;l=="right"&&(E=!0);var A=!1;a=="bottom"&&(A=!0);var C=t.POSREG;if(ee.POSREG!=null&&(C=ee.POSREG),n(y)&&(y=C),n(e))return;n(y)&&n(k)&&(k=!1),n(y)&&n(g)&&(g=!1),!n(y)&&n(k)&&(k=y),!n(y)&&n(g)&&(g=y),n(u)&&(u=!0),!n(s)&&!s.addChild&&(s=null),!e.getBounds&&!e.getBounds()&&(k=g=!1),e.zimPos={x:r,y:i,h:l,v:a,i:f},n(s)&&(e.parent?s=e.parent:ee.zdf&&(s=ee.zdf.stage)),!e.parent&&n(r)&&(r=0),!e.parent&&n(i)&&(i=0);var d=!1;e.getBounds()||(e.setBounds(0,0),d=!0);var x=!1;s&&!s.getBounds()&&(s.setBounds(0,0),x=!0);function P(){n(f)||typeof f=="number"&&isNaN(f)?s.contains(e)||s.addChild(e):s.addChildAt(e,f)}if(!n(s)&&s.addChild&&u){var v=s.getBounds().clone();P();var w=s.getBounds();(v.width!=w.width||v.height!=w.height||v.x!=w.x||v.y!=w.y)&&(e.removeFrom(),s.setBounds(v.x,v.y,v.width,v.height),x=!0,P())}if(!k&&!g&&(l=="center"||l=="middle")&&(a=="center"||a=="middle"))return e.center({container:s}),e.mov(r,i),d&&e.setBounds(null),x&&s.setBounds(null),e;if(l=="center"||l=="middle"){if(k)e.x=s.width/2;else{var b=e.y;e.center(),e.y=b}e.mov(r),r=null,l=null}else l===!0&&(E=!0);if(a=="center"||a=="middle"){if(g)e.y=s.height/2;else{var X=e.x;e.center(),e.x=X}e.mov(0,i),i=null,a=null}else a===!0&&(A=!0);function Y(){var U=e.getBounds(),Z=U.x,K=U.y,ne=U.width,V=U.height,D=e._props.matrix;D=e.getMatrix(D),(Z||K)&&D.appendTransform(0,0,1,1,0,0,0,-Z,-K);var c=ne*D.a,h=ne*D.b,o=V*D.c,I=V*D.d,N=D.tx,p=D.ty,L=N,we=N,B=p,F=p;return(Z=c+N)<L?L=Z:Z>we&&(we=Z),(Z=c+o+N)<L?L=Z:Z>we&&(we=Z),(Z=o+N)<L?L=Z:Z>we&&(we=Z),(K=h+p)<B?B=K:K>F&&(F=K),(K=h+I+p)<B?B=K:K>F&&(F=K),(K=I+p)<B?B=K:K>F&&(F=K),{x:L,y:B,width:we-L,height:F-B}}if(e.parent&&e.parent.getBounds){if(s=e.parent,n(r)&&E==!0&&(r=0),n(i)&&A==!0&&(i=0),n(r)||(e.x=r),n(i)||(e.y=i),n(r)&&n(i)&&!E&&!A)return d&&e.setBounds(null),x&&s.setBounds(null),e;var m=0,j=0;if(e.getBounds()){var S=Y();if(!n(r)){var _;E?_=new t.Point(S.x+S.width,S.y+S.height):_=new t.Point(S.x,S.y),m=_.x-r}n(i)||(A?_=new t.Point(S.x+S.width,S.y+S.height):_=new t.Point(S.x,S.y),j=_.y-i);var R=s.getBounds();n(r)||(E?k?e.x=R.width+R.x-r:e.x=R.width+R.x-r-m:(k?e.x=r:e.x=r-m,e.x+=R.x)),n(i)||(A?g?e.y=R.height+R.y-i:e.y=R.height+R.y-i-j:(g?e.y=i:e.y=i-j,e.y+=R.y))}}return d&&e.setBounds(null),x&&s.setBounds(null),u||e.removeFrom(),e},t.loc=function(e,r,i,l,a,s,f,u){var y="obj, target, y, container, index, add, localToLocal, x",k;if(k=st(t.loc,arguments,y))return k;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("loc",arguments),e.addTo(l,a);if(De("41.55"),!n(e)){if(typeof r=="number"&&(u=r,r=null),n(r)||(Array.isArray(r)?(u=r[0],i=r[1]):(n(r.x)||(u=r.x),n(r.y)||(i=r.y))),n(u)&&n(r)&&(u=e.x),n(i)&&n(r)&&(i=e.y),n(s)&&(s=!0),n(l)&&(e.parent?l=e.parent:ee.zdf&&(l=ee.zdf.stage)),s&&l&&(!e.parent||l!=e.parent?n(a)||isNaN(a)?l.addChild(e):l.addChildAt(e,a):n(a)||l.addChildAt(e,a)),n(f)&&(f=!0),r&&r.parent&&e.parent&&f){var g=r.parent.localToLocal(u,i,e.parent);u=g.x,i=g.y}return e.x=u,e.y=i,e}},t.mov=function(e,r,i){var l="obj, x, y",a;if(a=st(t.mov,arguments,l))return a;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("mov",arguments),e;if(De("41.6"),!n(e))return n(r)||(e.x+=r),n(i)||(e.y+=i),e},t.sca=function(e,r,i){return e.type=="AC"&&ee.zdf?(ee.zdf.ac("sca",arguments),e):(De("41.97"),n(e)||n(e.scaleX)||(n(r)&&(r=e.scaleX),n(i)&&(i=r),e.scaleX=r,e.scaleY=i),e)},t.alp=function(e,r){if(De("41.7"),!n(e))return n(r)||(e.alpha=e.hovOriginal=r,e.tag&&e.tag.style&&(e.type!="Loader"&&(e.tag.style.opacity=r),r==0?e.tag.style.display=e.tag.zimDisplay="none":e.tag.style.display=e.tag.zimDisplay="inline-block")),e},t.vis=function(e,r){if(De("41.71"),!n(e))return e.visible=r,e.tag&&e.tag.style&&(r?e.tag.style.display=e.tag.zimDisplay="inline-block":e.tag.style.display=e.tag.zimDisplay="none"),e},t.ble=function(e,r){if(De("41.72"),!n(e))return n(r)&&(r="difference"),e.compositeOperation=r,(e.type=="Blob"||e.type=="Squiggle")&&e.update(),e},t.dye=function(e,r){if(De("41.73"),!n(e))return e.hasOwnProperty("backgroundColor")?e.backgroundColor=r:e.hasOwnProperty("color")&&(e.color=r),e},t.hov=function(e,r,i){if(De("41.75"),!n(e))return n(r)&&(r=1),n(i)&&(i=typeof r=="number"?"alpha":"color"),e.hovMouseover&&(e.off("mouseover",e.hovMouseover),e.off("mouseout",e.hovMouseout)),r==-1?(e.cur("default"),n(e.hovOld)||(e[e.hovType]=e.hovOld),e.hovOld=null,e.stage&&e.stage.update(),e):(e.cur(),e.hovOld=e[i],e.hovNew=r,e.hovType=i,e.hovMouseover=e.on("mouseover",function(){e[i]=e.hovNew,e.stage&&e.stage.update()}),e.hovMouseout=e.on("mouseout",function(){e[i]=e.hovOld,e.stage&&e.stage.update()}),e)},t.rot=function(e,r,i,l){if(De("41.8"),!n(e)){if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("rot",arguments),e;if(!n(r))if(e.parent&&(!n(i)||!n(l))){n(i)&&(i=e.x),n(l)&&(l=e.y);var a=e.parent.localToLocal(i,l,e),s=new t.Point(e.x,e.y);e.reg(a.x,a.y),e.rotation=r,e.x=i,e.y=l;var f=e.parent.localToLocal(s.x,s.y,e);e.reg(f.x,f.y),e.x=s.x,e.y=s.y}else e.rotation=r;return e}},t.siz=function(e,r,i,l){if(De("41.85"),!n(e))return e.type=="AC"&&ee.zdf?(ee.zdf.ac("siz",arguments),e):(n(l)&&(l=!1),!n(r)&&!n(i)?(e.widthOnly=r,e.heightOnly=i):n(r)?n(i)||(l?e.heightOnly=i:e.height=i):l?e.widthOnly=r:e.width=r,e)},t.ske=function(e,r,i){if(De("41.9"),!n(e))return e.type=="AC"&&ee.zdf?(ee.zdf.ac("ske",arguments),e):(n(r)||(e.skewX=r),n(i)||(e.skewY=i),e)},t.reg=function(e,r,i,l){if(De("41.95"),!n(e)){if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("reg",arguments),e;var a=e.regX,s=e.regY,f=r,u=ee.DIR||t.DIR||"ltr",y;if(r=="default"&&(r=null),typeof r=="string"&&(y=e.getBounds(),y?(r=="start"&&(r=u=="ltr"?"left":"right"),r=="end"&&(r=u=="ltr"?"right":"left"),r=="left"?r=y.x:r=="right"?r=y.x+y.width:(r=="center"||r=="middle")&&(r=y.x+y.width/2)):r=null),typeof i=="string"?(y||(y=e.getBounds()),y?i=="top"?i=y.y:i=="bottom"?i=y.y+y.height:(i=="center"||i=="middle")&&(i=y.y+y.height/2):i=null):n(i)&&(f=="center"||f=="middle")&&(y||(y=e.getBounds()),y?i=y.y+y.height/2:i=null),i=="default"&&(i=null),n(r)||(e.regX=r),n(i)||(e.regY=i),l&&e.parent){var k=e.localToLocal(a,s,e.parent);e.x-=k.x-e.x,e.y-=k.y-e.y}return e}},t.top=function(e){return De("41.62"),n(e)||!e.parent||e.parent.setChildIndex(e,e.parent.numChildren-1),e},t.bot=function(e){return De("41.63"),n(e)||!e.parent||e.parent.setChildIndex(e,0),e},t.ord=function(e,r){if(De("41.64"),!(n(e)||!e.parent))return n(r)&&(r=0),e.parent.setChildIndex(e,t.constrain(e.parent.getChildIndex(e)+r,0,e.parent.numChildren-1)),e},t.cur=function(e,r){if(De("41.1"),n(e))return tt("zim methods - cur(): please provide object"),e;n(r)&&(r="pointer");var i=ee.zdf;return e.stage&&(i=e.stage.frame),i.cursors&&i.cursors[r]?(e.cursor="none",e._cursor=r,i.cursorList.add(e,r),e):(i.cursorList&&i.cursorList.add(e,!0),e.cursor=r,e)},t.sha=function(e,r,i,l,a){return De("41.2"),n(e)?(tt("zim methods - sha(): please provide object"),e):(n(r)&&(r="rgba(0,0,0,.3)"),r.blur?(e.shadow=r,e):(n(i)&&(i=e.width?e.width*.08:5),n(l)&&(l=e.height?e.height*.08:5),n(a)&&(a=e.width?e.width*.16:10),r==-1?e.shadow=null:e.shadow=new Fe.Shadow(r,i,l,a),e))},t.dep=function(e,r){if(De("41.65"),!n(e))return n(r)&&(r=0),e.depth=r,e},t.nam=function(e,r){if(De("41.67"),!(n(e)||n(r)))return e.name=r,t.zimObjectIDs[r]=e,e},t.movement=function(e,r,i){De("47.75");var l=e.stage||ee.zdf.stage;function a(){l=e.stage,e.zimMovementStage=l,e.zimMovementEvent&&l.off("stagemousemove",e.zimMovementEvent),e.zimMovementEvent=l.on("stagemousemove",function(s){r(s)}),e.on("mouseout",function(){e.zimMovementEvent&&l.off("stagemousemove",e.zimMovementEvent)},null,!0)}return t.mobile()?(e.zimMovementEvent&&l.off("pressmove",e.zimMovementEvent),e.zimMovementEvent=e.on("pressmove",function(s){r(s)})):(e.zimMouseoverEvent&&e.off("mouseover",e.zimMouseoverEvent),e.zimMouseoverEvent=e.on("mouseover",a),i&&a()),e},t.noMovement=function(e){if(De("47.9"),!n(e))return e.zimMouseoverEvent&&e.off("mouseover",e.zimMouseoverEvent),e.zimMovementEvent&&e.zimMovementStage&&e.zimMovementStage.off("stagemousemove",e.zimMovementEvent),e},t.tap=function(e,r,i,l,a,s,f,u,y,k){var g="obj, call, distance, time, once, dbl, dblTime, call2, call3, call4",O;if(O=st(t.tap,arguments,g))return O;if(De("47.8"),!(n(e)||n(r)||typeof r!="function")){n(i)&&(i=s?10:5);var T=Tt(l);n(l)&&(l=T=="s"?8:8e3),n(a)&&(a=!1),n(s)&&(s=!1),n(f)&&(k?f=T=="s"?.5:500:f=T=="s"?1:1e3),e.cur("pointer");var E=!1,A=!1,C;return s?e.zimDblClickDownEvent=e.on("mousedown",function(d){if(C=!1,E){E=!1;return}if(E=!0,d.currentTarget.type=="List"){if(d.target.type=="WindowBacking")return;var x=d.currentTarget.globalToLocal(d.stageX/t.scaX,d.stageY/t.scaY);if(x.y<=0)return}var P=d.stageX/t.scaX,v=d.stageY/t.scaY,w=Date.now(),b,X;A=!0,e.zimDoubleTimeout&&clearTimeout(e.zimDoubleTimeout),e.zimDoubleTimeout=setTimeout(function(){if(A=!1,E=!1,e.zimDblClickUpEvent&&e.off("pressup",e.zimDblClickUpEvent),C&&k)if(Math.abs(P+v-b/t.scaX-X/t.scaY)<i){if(e.excludeTap)return;k(d)}else u&&u(d)},T=="s"?f*1e3:f),e.zimDblClickUpEvent=e.on("pressup",function(Y){if(b=Y.stageX,X=Y.stageY,C=!0,E){y&&y(Y);return}else if(!A)return;if(Math.abs(P+v-Y.stageX/t.scaX-Y.stageY/t.scaY)<i&&Date.now()-w<(T=="s"?l*1e3:l)){if(e.excludeTap)return;clearTimeout(e.zimDoubleTimeout),r(Y)}else u&&u(Y);Y.remove()})},null,a):e.zimClickDownEvent=e.on("mousedown",function(d){if(d.currentTarget.type=="List"){if(d.target.type=="WindowBacking")return;var x=d.currentTarget.globalToLocal(d.stageX/t.scaX,d.stageY/t.scaY);if(x.y<=0)return}var P=d.stageX/t.scaX,v=d.stageY/t.scaY,w=Date.now();e.zimClickUpEvent=e.on("pressup",function(b){if(Math.abs(P+v-b.stageX/t.scaX-b.stageY/t.scaY)<i&&Date.now()-w<(T=="s"?l*1e3:l)){if(e.excludeTap)return;r(b)}else u&&u(b);b.remove()})},null,a),e}},t.noTap=function(e){if(De("47.9"),!n(e))return e.cursor&&e.cur("default"),e.zimClickDownEvent&&e.off("mousedown",e.zimClickDownEvent),e.zimClickUpEvent&&e.off("pressup",e.zimClickUpEvent),e.zimDoubleTimeout&&clearInterval(e.zimDoubleTimeout),e},t.hold=function(e,r,i,l,a){if(De("47.87"),!(n(e)||n(r)||typeof r!="function")){n(i)&&(i=5);var s=Tt(l);n(l)&&(l=s=="s"?1.5:1500),n(a)&&(a=!1),e.cur("pointer");var f;return e.zimClickHoldDownEvent=e.on("mousedown",function(u){if(f||(f=u.target.stage),!!f){if(n(f.frame)&&(f.frame=ee.zdf),(n(f.frame)||!f.frame.mousemoveEvent)&&(n(f.frame)&&(f.frame={}),f.frame.mouseX=u.stageX/t.scaX,f.frame.mouseY=u.stageY/t.scaY,f.frame.mouseholdEvent&&f.off("stagemousemove",f.frame.mouseholdEvent),f.frame.mouseholdEvent=f.on("stagemousemove",function(T){f.frame.mouseX=T.stageX/t.scaX,f.frame.mouseY=T.stageY/t.scaY})),u.currentTarget.type=="List"){if(u.target.type=="WindowBacking")return;var y=u.currentTarget.globalToLocal(u.stageX/t.scaX,u.stageY/t.scaY);if(y.y<=0)return}var k=u.stageX/t.scaX,g=u.stageY/t.scaY;clearInterval(e.zimHoldInterval);var O=0;e.zimHoldInterval=setInterval(function(){if(O<10)Math.abs(k+g-f.frame.mouseX-f.frame.mouseY)>i&&clearInterval(e.zimHoldInterval);else{if(Math.abs(k+g-f.frame.mouseX-f.frame.mouseY)<i){if(e.excludeHold)return;r(u)}clearInterval(e.zimHoldInterval)}O++},l/10*(s=="s"?1e3:1)),e.zimClickHoldUpEvent=e.on("pressup",function(){clearInterval(e.zimHoldInterval),f&&f.frame.mouseholdEvent&&f.off("stagemousemove",f.frame.mouseholdEvent)},null,!0)}},null,a),e}},t.noHold=function(e){if(De("47.88"),!n(e))return e.cursor&&e.cur("default"),e.off("mousedown",e.zimClickHoldDownEvent),e.off("pressup",e.zimClickHoldUpEvent),e.stage&&e.stage.frame.mouseEvent&&e.stage.off("stagemousemove",e.stage.frame.mouseEvent),clearInterval(e.zimHoldTimeout),e},t.change=function(e,r,i){if(De("47.85"),!(n(e)||n(r)||typeof r!="function"))return n(i)&&(i=!1),e.zimChangeEvent=e.on("change",function(l){r(l)},null,i),e},t.noChange=function(e){if(De("47.95"),!n(e))return e.off("mousedown",e.zimChangeEvent),e},t.drag=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b){var X="obj, boundary, axis, overCursor, dragCursor, all, swipe, localBoundary, onTop, surround, slide, slideFactor, slideSnap, slideSnapDamp, reg, removeTweens, startBounds, rect, currentTarget, offStage, immediateBoundary, singleTouch",Y;if(Y=st(t.drag,arguments,X))return Y;if(De("31"),n(e)||!e.on)return;var m=t.DRAGALL;if(ee.DRAGALL!=null&&(m=ee.DRAGALL),n(s)&&n(P)&&(s=m),n(s)&&n(P)?P=!1:n(s)?n(P)&&(P=!1):P=s,(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&(P=!0),r&&r.getBounds&&(e.type=="Container"||e.type=="Tile")&&e.mouseChildren==!0&&!s){var j=Array.prototype.slice.call(arguments);return j[4]=!0,setTimeout(function(){e.loop(function(me){j[0]=me,t.drag.apply(null,j)})},w?0:50),e}(n(i)||i=="all"||i!="horizontal"&&i!="vertical")&&(i="both"),e.zimDown&&e.noDrag(),e.cur(n(l)?"pointer":l),n(f)&&(f=!1),n(u)&&(u=!1),n(y)&&(y=!0),n(k)&&(k=!1),n(g)&&(g=!1),n(O)&&(O=.9),n(T)&&(T=!0);var S=["horizontal","vertical","auto"];if(T!==!0&&S.indexOf(T)<0&&(T=!1),T=="auto"&&(T=!0),n(E)&&(E=.1),n(A)&&(A=!1),n(C)&&(C=!0),n(d)&&(d=!0),n(r)&&!n(x)&&(r=x),n(b)&&(b=!1),e.dragPaused=!1,g)var _,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe=ee.M?20:10,se,Q,te,le,Ae=!1,J=!1,Te=50;else e.zimDragTicker=function(){};e._draggable=!0,t.setSwipe(e,f),e.zimBoundary=r,e.zimlocalBoundary=u,e.circleBounds=r&&r.type=="Circle"?r.radius:!1,e.downCheck=!1;var G=!1,ce,q,ue,ge,ie;e.zimAdded=e.on("added",xe,null,!0),e.zimRemoved=e.on("removed",Se,null,!0),e.parent&&xe();function xe(){if(e.off("added",e.zimAdded),r=e.zimBoundary,r&&r.getBounds&&r.type!="Blob"){if(e.zimlocalBoundary=!1,r.type!="Stage"&&r.type!="StageGL"?r=r.boundsToGlobal():r=new t.Boundary(0,0,r.width,r.height),!k){var me=e.boundsToGlobal();ie=e.localToGlobal(e.regX,e.regY);var re=new t.Point(ie.x-me.x,ie.y-me.y),ke=e.borderWidth?e.borderWidth:0;r.x+=re.x+ke/2,r.y+=re.y+ke/2,r.width-=me.width+ke,r.height-=me.height+ke}e.zimBoundary=r}ce=0,q=0,e.zimBoundary&&e.zimBoundary.type!="Blob"&&(u?(ue=t.boundsToGlobal(e.parent,e.zimBoundary),k&&(ge=e.zimBoundary)):(ue=e.zimBoundary,k&&(ge=t.boundsToGlobal(e.parent,e.zimBoundary,!0)))),ue&&d&&(ie=e.parent.localToGlobal(e.x,e.y),oe(e,ie.x,ie.y)),g&&setTimeout(function(){g&&T&&(_=new t.Damp(null,E),R=new t.Damp(null,E)),e.zimDragImmediate=function(Re,Ye){o=Re,I=Ye,se=Q=0,te=le=0,D=N=c=p=h=L=0,g&&T&&(n(Re)||_.immediate(Re),n(Ye)||R.immediate(Ye))},U=3,Z=0,K=[],ne=[],V=[],D=e.x,c=e.y,o=e.x,I=e.y,N=e.x,p=e.y,L=Date.now(),we=-1e4,B=-1e4,e.zimDragMoving=!0,be()},50),n(e.zimMaskDynamic)||e.zimMaskApply()}function Se(){e.zimDragTicker&&t.Ticker.remove(e.zimDragTicker)}var z,pe;e.pointers={};var de=!1;e.zimDown=e.on("mousedown",function(me){if(!(!e.stage||e.dragPaused)&&!(b&&de)){de=!0,pe=e.stage,e.zmu||(e.zmu=pe.frame.on("mouseupplus",function($e){e.downCheck&&(g||(e.downCheck=!1),Be($e,!0))})),e.dragMouseX=Math.round(me.stageX/t.scaX)+pe.x,e.dragMouseY=Math.round(me.stageY/t.scaY)+pe.y;var re="id"+Math.abs(me.pointerID+1);if(e.pointers[re]=!0,z=P?me.currentTarget:me.target,e.zimBoundary&&!z.getBounds()){tt("zim.drag() - drag object needs bounds set");return}if(e.downCheck=!0,e.stage.mouseMoveOutside=!0,t.Ticker.has(e.zimDragTicker)||t.Ticker.add(e.zimDragTicker,e.stage),C&&e.zimTweens)for(var ke in e.zimTweens){var Re=e.zimTweens[ke];Re.zimObj&&(Re.zimObj.x!=null||Re.zimObj.y!=null)&&e.stopAnimate(ke)}if(z.parent){if(y){var Ye=z.parent.numChildren-1;z.parent.getChildAt(Ye).type=="Keyboard"&&Ye--,z.parent.setChildIndex(z,Ye),z.ZIMoutlineShape&&z.outline()}z.parent==e.stage?ie=new t.Point(me.stageX/t.scaX,me.stageY/t.scaY):ie=z.parent.globalToLocal(me.stageX/t.scaX,me.stageY/t.scaY),A&&(z.x=ie.x,z.y=ie.y),ce=ie.x-z.x,q=ie.y-z.y,ue=null,e.zimBoundary&&(u?(ue=t.boundsToGlobal(z.parent,e.zimBoundary),k&&(ge=e.zimBoundary)):(ue=e.zimBoundary,k&&(ge=t.boundsToGlobal(z.parent,e.zimBoundary,!0)))),e.cur(n(a)?"pointer":a),g&&(e.slideStartX=e.x,e.slideStartY=e.y,F=e.zimDragMoving,Z=0,K=[ie.x],ne=[ie.y],V=[Date.now()],we=-1e4,B=-1e4,e.zimDragMoving=!0),e.type=="Pen"&&(e.zimDragCheck=!0,G=!1)}}},!0),e.zimMove=e.on("pressmove",function(me){if(!(b&&!e.pointers["id"+Math.abs(me.pointerID+1)])&&!(!e.downCheck||e.dragPaused)){var re=(v?me.rawX:me.stageX)/t.scaX+pe.x,ke=(v?me.rawY:me.stageY)/t.scaY+pe.y;e.dragMouseX=Math.round(re),e.dragMouseY=Math.round(ke),oe(z,re,ke),z.ZIMoutlineShape&&z.outline(),e.type=="Pen"&&!G&&e.drawing?G=!0:(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize()}},!0);function oe(me,re,ke){var Re=ce,Ye=q;if(n(me)&&(me=z||e),!!me.parent){if(n(re)||n(ke)){var $e=me.parent.localToGlobal(me.x,me.y);ce=q=0,e.zimBoundary&&(u?(ue=t.boundsToGlobal(me.parent,e.zimBoundary),k&&(ge=me.zimBoundary)):(ue=e.zimBoundary,k&&(ge=t.boundsToGlobal(me.parent,e.zimBoundary,!0)))),re=$e.x,ke=$e.y,g&&(o=me.x,I=me.y,z=me)}var it;pe&&pe.type?it=me.parent.globalToLocal(re,ke):it=me.parent.globalToLocal(re*t.scaX,ke*t.scaY);var Le=i=="both"||i=="horizontal",Ze=i=="both"||i=="vertical",ze;g&&T?T=="vertical"?(ze=$(me,it.x-ce,it.y-q),Le&&(me.x=ze.x),Ze&&(me.y=it.y-q)):T=="horizontal"?(ze=$(me,it.x-ce,it.y-q),Le&&(me.x=it.x-ce),Ze&&(me.y=ze.y)):(Le&&(me.x=it.x-ce),Ze&&(me.y=it.y-q)):(ze=$(me,it.x-ce,it.y-q),Le&&(me.x=ze.x),Ze&&(me.y=ze.y)),g&&!F&&(me.slideStartX!=me.x||me.slideStartY!=me.y)&&(F=!0),me.downCheck&&(ce=Re,q=Ye)}}e.zimPosition=oe,e.zimUp=e.on("pressup",function(me){Be(me)},!0);function Be(me,re){if(!(b&&!re&&!e.pointers["id"+Math.abs(me.pointerID+1)])){de=!1;var ke="id"+Math.abs((n(me.pointerID)?0:me.pointerID)+1);if(delete e.pointers[ke],!(!e.downCheck||e.dragPaused)){if(e.cur(n(l)?"pointer":l),g){if(z.dispatchEvent("slidestart"),z.parent){var Re=v?me.rawX:me.stageX,Ye=v?me.rawY:me.stageY;ie=z.parent.globalToLocal(Re/t.scaX,Ye/t.scaY)}else ie=new t.Point(0,0);D=ie.x,c=ie.y,h=Date.now(),isNaN(D)&&(D=-1e3),isNaN(c)&&(c=-1e3),te=D-N,le=c-p;var $e=h-L;se=t.constrain(te*fe/$e,-Te,Te),Q=t.constrain(le*fe/$e,-Te,Te),Ae=!1,J=!1,e.downCheck=!1,o=z.x,I=z.y,re&&(N=D=0,p=c=0,L=h=0)}else{e.downCheck=!1;var it=0;for(var Le in e.pointers)it++;it==0&&t.Ticker.remove(e.zimDragTicker),e.type=="Pen"&&(e.zimDragCheck=!1,G&&e.drawing&&e.stopCheck())}e.stage&&e.stage.update()}}}function $(me,re,ke){if(!me.parent)return{x:re,y:ke};if(ue)if(k){var Re=me.getBounds().width,Ye=me.getBounds().height,$e=me.getBounds().x,it=me.getBounds().y;Re<ge.width?re=ge.x+(ge.width-Re)/2+(me.regX-$e):(re-(me.regX-$e)>ge.x&&(re=ge.x+(me.regX-$e)),re-(me.regX-$e)+Re<ge.x+ge.width&&(re=ge.x+ge.width+(me.regX-$e)-Re)),me.height<ge.height?ke=ge.y+(ge.height-Ye)/2+(me.regY-it):(ke-(me.regY-it)>ge.y&&(ke=ge.y+(me.regY-it)),ke-(me.regY-it)+Ye<ge.y+ge.height&&(ke=ge.y+ge.height+(me.regY-it)-Ye))}else{if(ue.type=="Blob")return ue.shape.hitTestPoint(re,ke)?{x:re,y:ke}:{x:e.x,y:e.y};if(ie=me.parent.localToGlobal(re,ke),e.circleBounds){var Le=ue.x+ue.width/2,Ze=ue.y+ue.height/2,ze=e.circleBounds;if(t.dist(Le,Ze,ie.x,ie.y)<=ze)re=ie.x,ke=ie.y;else{var ve=t.angle(Le,Ze,ie.x,ie.y)*RAD;re=Le+ze*Math.cos(ve),ke=Ze+ze*Math.sin(ve)}}else re=Math.max(ue.x,Math.min(ue.x+ue.width,ie.x)),ke=Math.max(ue.y,Math.min(ue.y+ue.height,ie.y));ie=me.parent.globalToLocal(re,ke),re=ie.x,ke=ie.y}return{x:re,y:ke}}function Me(me,re,ke,Re,Ye){Math.abs(me.x-we)<.1&&Math.abs(me.y-B)<.1?(e.zimDragMoving=!1,me.x=Re,me.y=Ye,me.slideStartX=null,me.slideStartY=null,F&&(me.dispatchEvent("slidestop"),t.Ticker.remove(e.zimDragTicker)),e.type=="Pen"&&(e.zimDragCheck=!1,G&&e.drawing&&e.stopCheck())):(we=re,B=ke)}function be(){e.zimDragTicker=function(){if(!n(e.slideStartX))if(z||(z=e),e.downCheck){var me;z.parent?me=z.parent.globalToLocal(e.dragMouseX,e.dragMouseY):me=new t.Point(0,0),Z++,K.push(me.x),ne.push(me.y),V.push(Date.now()),Z>=U?(N=K.shift(),p=ne.shift(),L=V.shift()):(N=K[0],p=ne[0],L=V[0])}else{if(!e.zimDragMoving)return;te=se,le=Q;var re,ke;i==BOTH?(re=z.x+te,ke=z.y+le):i==HORIZONTAL?(re=z.x+te,ke=z.y):i==VERTICAL&&(re=z.x,ke=z.y+le),se=te*O,Q=le*O;var Re;ue&&(Re=$(z,re,ke),(T===!0||T=="horizontal")&&(Math.round(re)!=Math.round(Re.x)&&(Ae||(_.immediate(re),Ae=!0),se=0,re=_.convert(Re.x)),T=="horizontal"&&(ke=Re.y)),(T===!0||T=="vertical")&&(Math.round(ke)!=Math.round(Re.y)&&(J||(J=!0,R.immediate(ke),Q=0),ke=R.convert(Re.y)),T=="vertical"&&(re=Re.x)),T||(re=Re.x,ke=Re.y)),z.x=re,z.y=ke,Me(z,z.x,z.y,re,ke)}}}return e},t.noDrag=function(e,r){if(De("32"),n(e)||!e.on)return;if(n(r)&&(r=!0),r&&e.numChildren&&e.numChildren>1)for(var i=0;i<e.numChildren;i++){var l=e.getChildAt(i);a(l)}a(e);function a(s){s.cur&&s.cur("default"),s._draggable=!1,t.setSwipe(s,!0),s.off("added",s.zimAdded),s.off("removed",s.zimRemoved),s.off("mousedown",s.zimDown),s.off("pressmove",s.zimMove),s.off("pressup",s.zimUp),s.zmu&&(s.stage?s.stage.frame.off("mouseupplus",s.zmu):ee.zdf.off("mouseupplus",s.zmu)),t.Ticker&&(s.zimDragSlide&&t.Ticker.remove(s.zimDragSlide),s.zimDragTicker&&t.Ticker.remove(s.zimDragTicker)),s.zimDragMoving=s.zimAdded=s.zimRemoved=s.zimDown=s.zimMove=s.zimUp=s.zimBoundary=s.zimDragSlide=null,s.slideStartX=s.slideStartY=s.zimDragImmediate=null,s.dragMouseX=s.zimPosition=s.dragMouseY=s.zimDown=s.zimUp=null,s.zimDragTicker=s.zimDragSlide=null}return e},t.dragBoundary=function(e,r){if(De("33"),!(n(e)||!e.on))return e.zimBoundary=r,e.zimDragMoving=!0,e.zimPosition&&e.zimPosition(),e},t.dragRect=t.dragBoundary,t.mouse=function(e){return De("33.1"),e.zimLastMouse&&(e.mouseChildren=e.zimLastMouse),e.mouseEnabled=!0,e.zimLastMouseEnabled=!0,e},t.noMouse=function(e){return De("33.15"),e.zimLastMouse=e.mouseChildren,e.mouseChildren=!1,e.mouseEnabled=!1,e.zimLastMouseEnabled=!1,e},t.wire=function(e,r,i,l,a,s,f,u){var y="source, target, prop, twoWay, setSource, filter, call, input",k;if(k=st(t.wire,arguments,y))return k;if(De("33.2"),n(t.Ticker)&&vt)return tt("wire() - requires ZIM Frame"),e;if(n(r)&&vt)return tt("wire() - requires a target"),e;var g=t.DEFAULTWIRE;return ee.DEFAULTWIRE!=null&&(g=ee.DEFAULTWIRE),n(u)&&(g&&g!="currentValue"&&g!="selectedIndex"||g&&Object.prototype.hasOwnProperty.call(e,g)?u=g:Object.prototype.hasOwnProperty.call(e,"currentValue")?u="currentValue":Object.prototype.hasOwnProperty.call(e,"selectedIndex")?u="selectedIndex":u=i),n(i)&&(i=u),e.addChild&&(e.zimWire=!0),r.addChild&&(r.zimWired=!0),t.Ticker.addWire(e,[r,i,l,a,s,f,u]),e},t.noWire=function(e,r,i,l){var a="source, target, prop, input",s;return(s=st(t.noWire,arguments,a))?s:(De("33.25"),n(t.Ticker)&&vt?(tt("noWire() - requires ZIM Frame"),e):(t.Ticker.removeWire(e,r,i,l),e))},t.wired=function(e,r,i,l,a,s,f,u){var y="target, source, prop, twoWay, setSource, filter, call, input",k;return(k=st(t.wired,arguments,y))?k:(De("33.3"),n(t.Ticker)&&vt?(tt("wired() - requires ZIM Frame"),e):(t.wire(r,e,i,l,a,s,f,u),e))},t.noWired=function(e,r,i,l){var a="target, source, prop, input",s;return(s=st(t.noWire,arguments,a))?s:(De("33.35"),n(t.Ticker)&&vt?(tt("noWired() - requires ZIM Frame"),e):(t.Ticker.removeWire(r,e,i,l),e))},typeof mt>"u")var mt;if(t.bind=function(e,r,i,l,a,s){var f="obj, id, props, extra, filter, bindObj",u;if(u=st(t.bind,arguments,f))return u;if(De("33.17"),!mt)return vt&&tt("bind() - needs a Bind() object created first"),e;if(n(r))return vt&&tt("bind() - needs a unique id"),e;var y=s||mt;return y.add(r,e,i,l,a),e},t.noBind=function(e,r,i,l,a){var s="obj, props, removeConnectionData, call, bindObj",f;if(f=st(t.noBind,arguments,s))return f;if(De("33.18"),!mt)return e;var u=a||mt;return u.remove(e,r,i,l),e},t.transform=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U){var Z="obj, move, stretchX, stretchY, scale, rotate, allowToggle, visible, onTop, showStretch, showRotate, showScale, showReg, showBorder, borderColor, borderWidth, dashed, customCursors, handleSize, regSize, snapDistance, snapRotation, cache, events, ghostColor, ghostWidth, ghostDashed, ghostHidden, frame, container",K;if(K=st(t.transform,arguments,Z))return K;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("transform",arguments),e;if(De("33.5"),n(e)||!e.getBounds)return tt("zim methods - transform(): please provide object with bounds set"),e;if(!e.getBounds())return tt("zim methods - transform(): please setBounds() on object"),e;if(!e.parent)return tt("zim methods - transform(): object should be on stage first"),e;n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),e.width==0&&(i=!1),e.height==0&&(l=!1),n(a)&&(a=!0),n(s)&&(s=!0),n(f)&&(f=!0),n(u)&&(u=!0),n(y)&&(y=!0),n(k)&&(k=!!ne),n(g)&&(g=!!ne),n(O)&&(O=!0),n(T)&&(T=!0),n(E)&&(E=!0),n(A)&&(A="brown"),n(C)&&(C=1),n(m)&&(m=null),n(j)&&(j=null),m<0||j<0?m=j=null:m!=null&&j==null&&(j=1),n(S)&&(S=!0),n(_)&&(_=!1),n(R)&&(R=ee.zdf);var ne=ee.M;n(x)&&(x=!ne),n(P)&&(P=ne?20:10),n(v)&&(v=16),n(w)&&(w=10),n(b)&&(b=5),n(X)&&(X=!0),n(Y)&&(Y=!1),(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&(Y=!0),e.mouseChildren=!1;var V=e.getConcatenatedMatrix().decompose(),D=e.stage?e.stage:R.stage;n(U)&&(U=D),n(R.eventRemove)&&(D.enableMouseOver(),R.ctrlKey=!1,R.shiftKey=!1,ee.addEventListener("keydown",function(je){R.altKey=je.altKey,R.ctrlKey=je.ctrlKey}),ee.addEventListener("keyup",function(je){R.altKey=je.altKey,R.ctrlKey=je.ctrlKey}));var c=e.getBounds(),h=new t.Shape({style:!1}),o=new t.Shape({style:!1}),I=new t.Shape({style:!1});o.mouseEnabled=!1,I.controlType="reg";var N=e.parent,p=h.graphics,L=o.graphics,we=I.graphics,B,F,fe,se,Q,te,le,Ae,J,Te=new t.Container({style:!1});Te.type="TransformControls";var G=new t.Container({style:!1}),ce=new t.Container({style:!1}),q=new t.Container({style:!1}),ue=new t.Container({style:!1}),ge,ie,xe,Se,z;n(e.zimMaskDynamic)||e.zimMaskApply();function pe(je,Ct){je==Ct&&new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(0,-13.5),new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(13.5).rot(90),je==Ct&&new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(0,13.5).rot(180),new t.Triangle(16,12,12,"white",null,null,0).addTo(je).mov(-13.5).rot(-90),je==Ct&&new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(0,-13),new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(13).rot(90),je==Ct&&new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(0,13).rot(180),new t.Triangle(10,7,7,"black",null,null,0).addTo(je).mov(-13).rot(-90),X&&je.cache(-20,-20,40,40)}if(x){var de=new t.Container({style:!1}),oe=new t.Container({style:!1});pe(de,de),pe(oe,de);var Be={"nw-resize":45,"ne-resize":-45,"n-resize":90,"e-resize":0}}function $(){var je=e;for(ge=0,ie=1,xe=1,Se=0,z=0;je.parent;)ge+=je.rotation,ie*=je.scaleX,xe*=je.scaleY,Se+=je.skewX,z+=je.skewY,je=je.parent}$();var Me=ge,be=["nw-resize","ne-resize","nw-resize","ne-resize"],me=[2,3,0,1],re,ke;for(ke=0;ke<4;ke++)O?(re=new t.Rectangle(P,P,t.pink,t.grey,2,null,null,null,null,!1),re.centerReg(G),X&&re.cache(-1,-1,P+2,P+2)):(re=new t.Rectangle(P,P,"rgba(0,0,0,0)","rgba(0,0,0,0)",2,null,null,null,null,!1),re.centerReg(G),re.expand(0)),re.rotation=ge,le=x?"none":be[ke],re.drag({overCursor:le,dragCursor:le,onTop:!1}),re.controlType="corner",re.cu=be[ke];for(ke=0;ke<me.length;ke++)G.getChildAt(ke).op=G.getChildAt(me[ke]);var Re=["n-resize","e-resize","n-resize","e-resize"];for(me=[1,1,0,0],ke=0;ke<4;ke++){var Ye=ke%2==0?e.width/2:P,$e=ke%2==0?P:e.height/2;k?(re=new t.Rectangle(P,P,t.fog,t.dark,2,null,null,null,null,!1),re.centerReg(ke%2==0?q:ce),X&&re.cache(-1,-1,P+2,P+2)):(re=new t.Rectangle(Ye,$e,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),re.centerReg(ke%2==0?q:ce),re.expand(0)),re.rotation=ge,le=x?"none":Re[ke],re.drag({overCursor:le,dragCursor:le,onTop:!1}),re.controlType="side",re.cu=Re[ke]}for(ke=0;ke<me.length;ke++){var it=ke%2==0?q:ce;it.getChildAt(Math.floor(ke/2)).op=it.getChildAt(me[ke])}var Le=["ne-resize","nw-resize","ne-resize","nw-resize"];for(ke=0;ke<4;ke++)g?(re=new t.Circle(P,t.pink,null,null,null,null,null,null,!1),re.addTo(ue),X&&re.cache(-P,-P,P*2,P*2)):(re=new t.Circle(P,"rgba(0,0,0,0)",null,null,null,null,null,null,!1),re.addTo(ue),re.expand(0)),le=x?"none":Le[ke],re.drag({overCursor:le,dragCursor:le,onTop:!1}),re.controlType="rotate",re.cu=Le[ke];var Ze=1.8;ue.alpha=.5,ze();function ze(){var je=P*Ze*t.sign(ie),Ct=P*Ze*t.sign(xe);ue.getChildAt(0).reg(je,Ct),ue.getChildAt(1).reg(-je,Ct),ue.getChildAt(2).reg(-je,-Ct),ue.getChildAt(3).reg(je,-Ct),D.update()}function ve(){p.c(),L.c(),we.c(),B=e.localToLocal(c.x,c.y,U),F=e.localToLocal(c.x+c.width,c.y,U),fe=e.localToLocal(c.x+c.width,c.y+c.height,U),se=e.localToLocal(c.x,c.y+c.height,U);var je=e.localToLocal(c.x+c.width/2,c.y,U),Ct=e.localToLocal(c.x+c.width,c.y+c.height/2,U),Wt=e.localToLocal(c.x+c.width/2,c.y+c.height,U),_t=e.localToLocal(c.x,c.y+c.height/2,U);Q=e.localToLocal(e.regX,e.regY,U),te=e.localToLocal(c.x+c.width/2,c.y+c.height/2,U),J=[B,F,fe,se],Ae=[je,Ct,Wt,_t],E&&(p.s(A),d&&p.sd([10,5],0),p.ss(C).mt(B.x,B.y).lt(F.x,F.y).lt(fe.x,fe.y).lt(se.x,se.y).lt(B.x,B.y).cp()),n(m)||(L.s(m),S&&L.sd([10,5],0),L.ss(j).mt(B.x,B.y).lt(F.x,F.y).lt(fe.x,fe.y).lt(se.x,se.y).lt(B.x,B.y).cp()),h.setBounds(B.x,B.y,F.x-B.x,se.y-B.y),T&&(we.s("#eee").ss(C).f("rgba(0,0,0,.1)").dc(0,0,v),we.s("#222").ss(C).dc(0,0,v*.3)),$();for(var tn=Math.min(50,Math.abs(Se))*t.sign(Se),Ut=Math.min(50,Math.abs(z))*t.sign(z),wt=ge*t.sign(ie*xe)*t.sign(e.scaleX*e.scaleY),Vt=0;Vt<J.length;Vt++){var yn=J[Vt];G.getChildAt(Vt).loc(yn.x,yn.y).ske(tn,Ut).rot(wt),ue.getChildAt(Vt).loc(yn.x,yn.y).rot(wt);var $t=Ae[Vt],an=Vt%2==0?q:ce;an.getChildAt(Math.floor(Vt/2)).loc($t.x,$t.y).ske(tn,Ut).rot(wt),k||an.getChildAt(Math.floor(Vt/2)).sca(Vt%2==0?ie/2:1,Vt%2==0?1:xe/2)}I.x=Q.x,I.y=Q.y}ve();var Pe=new t.Shape(1e3,1e3,null,null,null,!1);function ae(){Pe.x=0,Pe.y=0,Pe.graphics.c().f("rgba(0,0,0,.01)").mt(B.x,B.y).lt(F.x,F.y).lt(fe.x,fe.y).lt(se.x,se.y).lt(B.x,B.y).cp(),Pe.reg(Q.x,Q.y),Pe.x=Q.x,Pe.y=Q.y}ae(),Te.on("dblclick",function(je){R.ctrlKey&&e.transformControls.visible&&(e.scaleX=1,e.scaleY=1,e.rotation=0,ve(),ae(),D.update()),kt(je,!0)});var Ne=Te.on("mousedown",Xe),Ke=e.on("mousedown",Xe);function Xe(je){var Ct=D.getObjectUnderPoint(je.stageX,je.stageY,1);ne||Ct&&(e.contains&&e.contains(Ct)||!e.contains&&e==Ct)?e.transformControls.visible||(x?(bt=!1,Pe.mouseEnabled=!1):R.canvas.style.cursor="move",e.transformControls.show(),e.dispatchEvent("transformshow")):e.transformControls.visible&&(!Ct||!Te.contains(Ct))&&(e.transformControls.hide(),e.dispatchEvent("transformhide"))}var Qe=D.on("stagemousedown",function(je){var Ct=D.getObjectUnderPoint(je.stageX,je.stageY,1),Wt=Ct&&Ct.parent&&Ct.parent.layer&&Ct.parent.layer==e;e.transformControls.visible&&(!Ct||!Te.contains(Ct)&&!Wt)&&(e.dispatchEvent("transformhide"),e.transformControls.hide())});f||(Te.off("mousedown",Ne),e.off("mousedown",Ke),D.off("stagemousedown",Qe));var he,Ge,Ie,_e,Je,Oe,Ve,rt,Ce,We,lt,Ue,ct,ot=!1,dt=!1,et,St,ht=e.cursor,gt,Bt=new t.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);if(x){Bt.mouseEnabled=!1,Bt.mouseChildren=!1,Bt.addChild(oe),G.on("mouseover",He),G.on("mouseout",yt),ce.on("mouseover",He),ce.on("mouseout",yt),q.on("mouseover",He),q.on("mouseout",yt),ue.on("mouseover",He),ue.on("mouseout",yt);var Dt=new t.Circle(30,"rgba(0,0,0,0)",null,null,null,null,null,null,!1).expand(20);Dt.cursor="none"}G.on("mousedown",Ht),G.on("pressmove",nn),G.on("pressup",kt),ce.on("mousedown",Ht),ce.on("pressmove",nn),ce.on("pressup",kt),q.on("mousedown",Ht),q.on("pressmove",nn),q.on("pressup",kt),ue.on("mousedown",Ht),ue.on("pressmove",en),ue.on("pressup",kt);function Ht(je){dt=!0,y&&Mt(),et&&D.off("stagemousemove",et),he=je.target.x,Ge=je.target.y,We=e.x,lt=e.y,Ie=e.scaleX,_e=e.scaleY;var Ct=U.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);if(je.target.controlType=="rotate"){ot=!0,Je=e.rotation;var Wt=Ct.x,_t=Ct.y,tn=N.localToLocal(We,lt,U);Ue=tn.x,ct=tn.y,Oe=Math.atan2(_t-ct,Wt-Ue)*180/Math.PI}R.ctrlKey||je.target.controlType=="rotate"?(Ve=Math.abs(he-e.x),rt=Math.abs(Ge-e.y)):(Ve=Math.abs(he-je.target.op.x),rt=Math.abs(Ge-je.target.op.y)),je.target.controlType!="rotate"&&(Ce=je.target.op.parent.localToLocal(je.target.op.x,je.target.op.y,e.parent)),Bt.stage?U.setChildIndex(Bt,U.getChildIndex(Te)):Bt.addTo(U,U.getChildIndex(Te)+1),Bt.x=Ct.x,Bt.y=Ct.y,Bt.cursor=x?"none":je.target.cu,x&&(e.getConcatenatedMatrix().decompose(V),V.rotation||(V.rotation=0),oe.rotation=V.rotation*t.sign(ie*xe)*t.sign(e.scaleX*e.scaleY)+Be[je.target.cu]+Me,je.target.controlType!="side"&&ie*xe<0&&(oe.rotation+=90),Dt.addTo(U,1).pos({x:Ct.x,y:Ct.y,reg:!0})),Pe.visible=!1,e.cursor="none"}function nn(je){var Ct=1;R.ctrlKey&&je.target.controlType=="corner"?Ct=Ve>rt?(je.target.x-We)/(he-We):(je.target.y-lt)/(Ge-lt):Ve>rt?he-je.target.op.x&&(Ct=(je.target.x-je.target.op.x)/(he-je.target.op.x)):Ge-je.target.op.y&&(Ct=(je.target.y-je.target.op.y)/(Ge-je.target.op.y)),je.target.controlType=="corner"?(e.scaleX=Ct*Ie,e.scaleY=Ct*_e):(e.scaleX=je.target.cu=="e-resize"?Ct*Ie:Ie,e.scaleY=je.target.cu=="n-resize"?Ct*_e:_e),ve();var Wt=U.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);if(Bt.x=Wt.x,Bt.y=Wt.y,x&&(Dt.x=Wt.x,Dt.y=Wt.y),!R.ctrlKey||je.target.controlType=="side"){var _t=je.target.op.parent.localToLocal(je.target.op.x,je.target.op.y,e.parent);e.x-=(_t.x-Ce.x)*t.sign(ie)*t.sign(e.scaleX),e.y-=(_t.y-Ce.y)*t.sign(xe)*t.sign(e.scaleY)}if(ve(),e.transformControls.events){var tn=je.target.controlType;Qt(je,tn)}}function en(je){var Ct=U.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY),Wt=Math.atan2(Ct.y-ct,Ct.x-Ue)*180/Math.PI;if(R.shiftKey?e.rot(Math.round((Je+(Wt-Oe)*t.sign(ie)*t.sign(e.scaleX))/45)*45):e.rot(Je+(Wt-Oe)*t.sign(ie)*t.sign(e.scaleX)),ve(),Bt.x=Ct.x,Bt.y=Ct.y,x&&(e.getConcatenatedMatrix().decompose(V),V.rotation||(V.rotation=0),oe.rotation=V.rotation*t.sign(ie*xe)*t.sign(e.scaleX*e.scaleY)+Be[je.target.cu]+Me,je.target.controlType!="side"&&ie*xe<0&&(oe.rotation+=90),Dt.x=Ct.x,Dt.y=Ct.y),ve(),e.transformControls.events){var _t=je.target.controlType;Qt(je,_t,null,!1)}}function kt(je,Ct){ze();var Wt=je?je.target.controlType:"move";Ct&&(Wt="reset"),x&&Dt.removeFrom(),Qt(je,Wt,!0),D.update()}function Qt(je,Ct,Wt,_t){_t==null&&(_t=!0);var tn=!1;gt=null;var Ut=U.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);Ct=="move"?((e.x!=rn.x||e.y!=rn.y)&&(gt=new Fe.Event("transformed"),gt.transformType="move"),_t&&(tn=Pe.hitTestPoint(Ut.x,Ut.y))):Ct=="corner"?((e.scaleX!=rn.scaleX||e.scaleY!=rn.scaleY)&&(gt=new Fe.Event("transformed"),gt.transformType="size"),_t&&(tn=G.hitTestPoint(Ut.x,Ut.y))):Ct=="side"?((e.scaleX!=rn.scaleX||e.scaleY!=rn.scaleY)&&(gt=new Fe.Event("transformed"),gt.transformType="stretch"),_t&&(tn=ce.hitTestPoint(Ut.x,Ut.y)||q.hitTestPoint(Ut.x,Ut.y))):Ct=="rotate"?(e.rotation!=rn.rotation&&(gt=new Fe.Event("transformed"),gt.transformType="rotate"),_t&&(tn=ue.hitTestPoint(Ut.x,Ut.y))):Ct=="reg"?(e.regX!=rn.regX||e.regY!=rn.regY)&&(gt=new Fe.Event("transformed"),gt.transformType="reg"):Ct=="reset"?(gt=new Fe.Event("transformed"),gt.transformType="reset"):(gt=new Fe.Event("transformed"),gt.transformType="unknown"),_t&&!tn&&(Bt.removeFrom(),R.canvas.style.cursor="default",e.cursor=ht),gt&&(gt.pressup=Wt,(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize(),e.dispatchEvent(gt))}function He(je){if(!dt){Bt.stage?U.setChildIndex(Bt,U.getChildIndex(Te)):Bt.addTo(U,U.getChildIndex(Te)+1),Dt.addTo(U,1);var Ct=U.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);Bt.x=Ct.x,Bt.y=Ct.y,Dt.x=Ct.x,Dt.y=Ct.y,e.getConcatenatedMatrix().decompose(V),V.rotation||(V.rotation=0),oe.rotation=V.rotation*t.sign(ie*xe)*t.sign(e.scaleX*e.scaleY)+Be[je.target.cu]+Me,je.target.controlType!="side"&&ie*xe<0&&(oe.rotation+=90),D.update(),et&&D.off("stagemousemove",et),et=D.on("stagemousemove",function(Wt){var _t=U.globalToLocal(Wt.stageX/t.scaX,Wt.stageY/t.scaY);Bt.x=_t.x,Bt.y=_t.y,D.update()})}}function yt(){D.off("stagemousemove",et),!dt&&(e.cursor=ht,Bt.removeFrom(),Dt.removeFrom(),D.update())}function Mt(){if(y){var je=N.numChildren-1;N.getChildAt(je).type=="Keyboard"&&je--,N.setChildIndex(e,je),Xt()}}function Xt(){if(N==U)Te.removeFrom(),U.addChildAt(Te,U.getChildIndex(e)+1);else{for(var je=N;je.parent&&je.parent!=U;)je=je.parent;e.stage&&(Te.parent==U&&U.removeChild(Te),U.addChildAt(Te,U.getChildIndex(je)+1))}}var Yt,ft;I.drag(),I.on("mousedown",Mt),I.on("pressup",function(je){if(!R.ctrlKey){for(var Ct=0;Ct<J.length;Ct++)if(t.dist(I.x,I.y,J[Ct].x,J[Ct].y)<w){I.x=J[Ct].x,I.y=J[Ct].y;break}t.dist(I.x,I.y,te.x,te.y)<w&&(I.x=te.x,I.y=te.y)}var Wt=e.rotation;Yt=U.localToLocal(I.x,I.y,e),N==D?ft=new t.Point(I.x,I.y):ft=U.localToLocal(I.x,I.y,N),e.reg(Yt.x,Yt.y),e.rotation=0,e.x=e.x+ft.x-e.x,e.y=e.y+ft.y-e.y,e.rotation=Wt,ve(),ae(),kt(je),D.update()});var bt=!0;le=x?"none":"move",Pe.drag({overCursor:le,dragCursor:le,onTop:!1}),Pe.controlType="move",x&&(Pe.on("mouseover",Kt),Pe.on("mouseout",Gt));function Gt(){D.off("stagemousemove",St),!dt&&(de.removeFrom(Te),D.update())}function Kt(je){if(!(dt||!x||!bt)){var Ct=U.globalToLocal(je.stageX/t.scaX,je.stageY/t.scaY);de.addTo(Te).pos({x:Ct.x,y:Ct.y,reg:!0}),D.update(),St&&D.off("stagemousemove",St),St=D.on("stagemousemove",function(Wt){var _t=U.globalToLocal(Wt.stageX/t.scaX,Wt.stageY/t.scaY);de.x=_t.x,de.y=_t.y,D.update()})}}Pe.on("mousedown",Mt),Pe.on("pressmove",function(je){if(e.transformControls.visible){var Ct;if(N==D?Ct=new t.Point(Pe.x,Pe.y):Ct=U.localToLocal(Pe.x,Pe.y,N),e.x=Ct.x,e.y=Ct.y,ve(),e.transformControls.events){var Wt="move";Qt(je,Wt)}}}),Pe.on("pressup",function(je){e.transformControls.visible&&kt(je)});var fn=D.on("stagemouseup",function(){dt=!1,Pe.mouseEnabled=!0,bt||(gt=new Fe.Event("transformed"),e.x!=rn.x||e.y!=rn.y?gt.transformType="move":gt.transformType="select",gt.pressup=!0,e.dispatchEvent(gt)),bt=!0,Pe.visible=!0,ot&&!R.ctrlKey&&b>1&&(e.rotation=Math.round(e.rotation/b)*b,ve()),ae(),Pe.mouseEnabled=!0,ot=!1,D.update()});function Jt(){rn={x:e.x,y:e.y,rotation:e.rotation,regX:e.regX,regY:e.regY,scaleX:e.scaleX,scaleY:e.scaleY}}var rn;Jt();var jt=e.on("mousedown",Jt);Te.on("mousedown",Jt),Te.addChild(h),r&&Te.addChild(Pe),a&&Te.addChild(G),i&&Te.addChild(ce),l&&Te.addChild(q),s&&Te.addChild(ue),Te.addChild(I);var gn;r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),gn=e.on("pressmove",function(je){if(ve(),ae(),ze(),e.transformControls.events){var Ct="move";Qt(je,Ct)}}));var xt=f;return e.transformControls={visible:u,events:Y,ghost:!n(m),ghostEnabled:!n(m),show:function(){return y&&Mt(),Xt(),e.toggled=!0,e.transformControls.visible=!0,o.parent&&o.removeFrom(),D.update(),e},hide:function(){if(e.transformControls.ghost)var je=U.getChildIndex(Te);return U.removeChild(Te),e.transformControls.ghost&&e.transformControls.ghostEnabled&&U.addChildAt(o,je),e.toggled=!1,e.transformControls.visible=!1,x&&(et&&D.off("stagemousemove",et),St&&D.off("stagemousemove",St),dt=!1,Bt.removeFrom(),Dt.removeFrom()),r||e.cur(ht),D.update(),e},remove:function(je){je||e.transformControls.hide(),f=!1,r&&(e.noDrag(),e.off("pressmove",gn))},add:function(je){je||e.transformControls.show(),f=xt,r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),gn=e.on("pressmove",gn))},allowToggleOn:function(){f=xt=!0,Ne=Te.on("mousedown",Ne),Ke=e.on("mousedown",Ke),Qe=D.on("stagemousedown",Qe)},allowToggleOff:function(){f=xt=!1,Te.off("mousedown",Ne),e.off("mousedown",Ke),D.off("stagemousedown",Qe)},disable:function(){Te.mouseChildren=!1,Te.mouseEnabled=!1,r&&(e.noDrag(),e.off("pressmove",gn))},enable:function(){Te.mouseChildren=!0,Te.mouseEnabled=!0,r&&(e.drag({overCursor:"pointer",dragCursor:"pointer",onTop:!1,removeTweens:!1}),gn=e.on("pressmove",gn))},recordData:function(je){var Ct={type:e.type,index:N.getChildIndex(e),x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation,skewX:e.skewX,skewY:e.skewY,regX:e.regX,regY:e.regY,controls:e.transformControls.visible};return je?JSON.stringify(Ct):Ct},setData:function(je,Ct){if(!n(je)){Ct&&(je=JSON.parse(je)),delete je.controls;var Wt=je.index;n(Wt)&&(Wt=0),delete je.index;for(var _t in je)e[_t]=je[_t];return setTimeout(function(){ve(),ae(),ze(),N.setChildIndex(e,Wt),e.transformControls.visible&&e.type!="Layer"?e.transformControls.show():e.transformControls.hide(),e.transformControls.ghost&&!e.transformControls.ghostEnabled&&!e.transformControls.visible&&U.addChild(o)},90),e}},hideGhost:function(){e.transformControls.ghost=!1,o.removeFrom()},showGhost:function(){if(e.transformControls.ghost=!0,e.transformControls.ghostEnabled&&!e.transformControls.visible){for(var je=N;je.parent&&je.parent!=U;)je=je.parent;o.stage?U.setChildIndex(o,U.getChildIndex(je)+1):U.addChildAt(o,U.getChildIndex(je)+1)}},addGhost:function(){j>0?(e.transformControls.ghostEnabled=!0,e.transformControls.showGhost()):vt&&tt("transform() - ghostWidth must be > 0 when making transform")},removeGhost:function(){e.transformControls.ghostEnabled=!1,e.transformControls.hideGhost()},resize:function(je){if(N=e.parent,ve(),ae(),ze(),u&&e.transformControls.show(),je){var Ct=new Fe.Event("transformed");Ct.pressup=!0,Ct.transformType="resize",e.dispatchEvent(Ct)}return e},dispose:function(){e.transformControls.hide(),f=!1,r&&(e.noDrag(),e.off("pressmove",gn)),e.transformControls.hideGhost(),Pe.removeAllEventListeners(),ue.removeAllEventListeners(),I.removeAllEventListeners(),ce.removeAllEventListeners(),q.removeAllEventListeners(),G.removeAllEventListeners(),Te.removeAllEventListeners(),Ke&&e.off("mousedown",Ke),Ne&&e.off("mousedown",Ne),Qe&&D.off("stagemousedown",Qe),et&&D.off("stagemousemove",et),St&&D.off("stagemousemove",St),fn&&D.off("stagemouseup",fn),jt&&e.off("mousedown",jt),gn&&e.off("pressmove",gn),Te=Bt=Dt=null,e.transformControls=null},controls:Te,scaleControls:G,stretchXControls:ce,stretchYControls:q,rotateControls:ue},e.toggle=function(je){return je===!0?e.transformControls.show():je===!1||e.transformControls.visible?e.transformControls.hide():e.transformControls.show(),e},e.transformControls.ghost&&(e.transformControls.toggleGhost=function(je){return je===!0?e.transformControls.showGhost():je===!1||e.transformControls.visible?e.transformControls.hideGhost():e.transformControls.showGhost(),e}),u?e.transformControls.show():!_&&e.transformControls.ghost&&e.transformControls.showGhost(),e},t.gesture=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C){var d="obj, move, scale, rotate, boundary, minScale, maxScale, snapRotate, localBoundary, slide, slideFactor, regControl, onTop, surround, circularBounds, rect",x;if(x=st(t.gesture,arguments,d))return x;if(De("34.5"),n(e)||!e.on)return;n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),n(y)&&(y=!1),n(u)&&(u=1),n(k)&&(k=!1),n(g)&&(g=5),n(O)&&(O=!1),n(T)&&(T=!0),n(E)&&(E=!1),E&&l&&(E=C=null,vt&&tt("gesture() - does not support surround when rotate is true")),n(A)&&(A=!1),n(a)&&!n(C)&&(a=C);var P,v,w,b,X=Tt();if(n(e.zimMaskDynamic)||e.zimMaskApply(),!e.zimTouch){var Y=new t.Damp(e.scaleX,.05),m=new t.Damp(e.scaleY,.05),j=e.scaleX/e.scaleY;if(e.zimTouch={move:r,scale:i,rotate:l,pointers:{},checkBounds:function(o,I){if(e.zimTouch.boundary){var N=e.zimTouch.boundary,p=e.parent.localToLocal(o,I,e.parent);E?(o=Math.min(N.x,Math.max(N.x+N.width,p.x)),I=Math.min(N.y,Math.max(N.y+N.height,p.y))):(o=Math.max(N.x,Math.min(N.x+N.width,p.x)),I=Math.max(N.y,Math.min(N.y+N.height,p.y))),p=e.parent.globalToLocal(o,I),o=p.x,I=p.y}return{x:o,y:I}}},a){e.zimTouch.boundary=a,y&&(e.zimTouch.boundary=t.boundsToGlobal(e.parent,a)),e.zimTouch.boundaryStartX=e.zimTouch.boundary.x,e.zimTouch.boundaryStartY=e.zimTouch.boundary.y,e.zimTouch.boundaryStartW=e.zimTouch.boundary.width,e.zimTouch.boundaryStartH=e.zimTouch.boundary.height;var S=e.zimTouch.checkBounds(e.x,e.y);e.x=S.x,e.y=S.y}k&&(w=10,b=5,v=0,P=[],e.zimTouch.slideInterval=t.interval(w/(X=="s"?1e3:1),function(){P[v++%b]=[e.x,e.y]}),e.zimTouch.slideInterval.pause(),e.animate({x:e.x,y:e.y},10/(X=="s"?1e3:1),"quadOut"));var _,R,U,Z,K,ne,V,D;e.zimTouch.mousedown=e.on("mousedown",function(o){if(n(D)?D=1:D++,T){var I=e.parent.numChildren-1;e.parent.getChildAt(I).type=="Keyboard"&&I--,e.parent.setChildIndex(e,I),e.ZIMoutlineShape&&e.outline()}O||(V=null,R=e.scaleX,U=e.scaleY,Z=e.rotation,K=e.regX,ne=e.regY,e.reg(0,0),_=e.getMatrix(),e.regX=K,e.regY=ne);var N="id"+Math.abs(o.pointerID+1),p=e.parent.globalToLocal(o.stageX/t.scaX,o.stageY/t.scaY);e.zimTouch.pointers[N]={startX:p.x,startY:p.y,x:p.x,y:p.y},(e.zimTouch.move||e.zimTouch.rotate)&&(e.zimTouch.total=0,t.loop(e.zimTouch.pointers,function(){e.zimTouch.total++})),k&&e.zimTouch.total==1&&e.zimTouch.slideInterval.pause(!1),c()}),e.zimTouch.pressmove=e.on("pressmove",function(o){var I="id"+Math.abs(o.pointerID+1),N=e.parent.globalToLocal(o.stageX/t.scaX,o.stageY/t.scaY);e.zimTouch.pointers[I]&&(e.zimTouch.pointers[I].x=N.x,e.zimTouch.pointers[I].y=N.y);var p=0,L=0,we=0,B=0,F=0,fe=0;if(t.loop(e.zimTouch.pointers,function(pe,de){p+=de.x-de.startX,L+=de.y-de.startY,we+=de.x,B+=de.y}),e.zimTouch.total!=0){F=p/e.zimTouch.total,fe=L/e.zimTouch.total,p=e.zimTouch.startX+F,L=e.zimTouch.startY+fe,we=we/e.zimTouch.total,B=B/e.zimTouch.total;var se={x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY,rotation:e.rotation};if(e.zimTouch.move){var Q=e.zimTouch.checkBounds(p,L);se.x=Q.x,se.y=Q.y}if(e.zimTouch.pair.length==2){var te=e.zimTouch.pair[0],le=e.zimTouch.pair[1];if(e.zimTouch.scale){var Ae=Math.sqrt(Math.pow(le.startX-te.startX,2)+Math.pow(le.startY-te.startY,2)),J=Math.sqrt(Math.pow(le.x-te.x,2)+Math.pow(le.y-te.y,2)),Te=e.zimTouch.startSX+(J/Ae-1),G=e.zimTouch.startSY+(J/Ae-1);se.scaleX=Te,se.scaleY=G,se.scaleX=Y.convert(Te),se.scaleY=m.convert(G);var ce=!n(s)&&Math.min(Te,G)<s,q=!n(f)&&Math.max(Te,G)>f;(ce||q)&&(ce?j>1?(se.scaleY=s,se.scaleX=s*j):(se.scaleX=s,se.scaleY=s/j):q&&(j>1?(se.scaleX=f,se.scaleY=f/j):(se.scaleY=f,se.scaleX=f*j)),Y.immediate(se.scaleX),m.immediate(se.scaleY))}if(e.zimTouch.rotate){var ue=Math.atan2(te.startY-le.startY,te.startX-le.startX)*(180/Math.PI),ge=Math.atan2(te.y-le.y,te.x-le.x)*(180/Math.PI),ie=ge-ue;se.rotation=e.zimTouch.startR+ie}if(O)e.scaleX=se.scaleX,e.scaleY=se.scaleY,e.rotation=se.rotation,e.zimTouch.move&&(e.x=se.x,e.y=se.y);else{e.reg(0,0);var xe=e.parent.localToGlobal(we,B);we=xe.x,B=xe.y;var Se=n(V)?e.globalToLocal(we,B):e.globalToLocal(V.x,V.y),z=_.clone().translate(Se.x,Se.y).rotate(se.rotation-Z).scale(se.scaleX/R,se.scaleY/U).translate(-Se.x,-Se.y);z.decompose(e),e.zimTouch.move&&(e.x+=F,e.y+=fe),V=e.localToGlobal(Se.x,Se.y),e.reg(K,ne)}e.zimTouch.scale&&e.dispatchEvent("scale"),e.zimTouch.rotate&&e.dispatchEvent("rotate"),e.zimTouch.move&&e.dispatchEvent("move")}else e.x=se.x,e.y=se.y,e.zimTouch.move&&e.dispatchEvent("move");(e.type=="Tag"||e.type=="TextArea"||e.type=="Loader")&&e.resize(),e.ZIMoutlineShape&&e.outline(),e.getStage&&e.stage&&e.stage.update()}}),e.on("mousedown",function(){var o=1;e.stage.on("stagemousedown",function(){o++}),e.stage.on("stagemouseup",function(){o--,o==0&&setTimeout(function(){e.zimTouch&&(e.zimTouch.total=0),e.zimTouch&&(e.zimTouch.pointers={}),D=null},50)})},null,!0),e.zimTouch.pressup=e.on("pressup",function(o){var I="id"+Math.abs(o.pointerID+1);if(delete e.zimTouch.pointers[I],(e.zimTouch.move||e.zimTouch.rotate)&&e.zimTouch.total--,l&&!n(u)&&e.zimTouch.total==0&&(u>0?e.rotation=Math.round(e.rotation/u)*u:u==0&&(e.rotation=Math.round(e.rotation))),k&&e.zimTouch.total==0&&D==1){e.zimTouch.slideInterval.pause();var N=P[(v+1)%P.length],p=P[v%P.length],L=e.x+(N[0]-p[0])*g,we=e.y+(N[1]-p[1])*g,B=e.zimTouch.checkBounds(L,we),F=b*w*g*Math.min((e.x-B.x)/(e.x-L)||1,(e.y-B.y)/(e.y-we)||1);e.animate({x:B.x,y:B.y},F/(X=="s"?1e3:1),"quadOut",function(){e.dispatchEvent("slidestop")})}e.zimTouch.total==0&&(D=null),e.getStage&&e.stage&&e.stage.update(),c()}),a&&(h(),e.on("move",h))}function c(){e.zimTouch.pair=[],t.loop(e.zimTouch.pointers,function(o,I,N){I.startX=I.x,I.startY=I.y,N<=1&&e.zimTouch.pair.push(I)}),e.zimTouch.startX=e.x,e.zimTouch.startY=e.y,e.zimTouch.startSX=e.scaleX,e.zimTouch.startSY=e.scaleY,e.zimTouch.startR=e.rotation}function h(){var o=e.localToGlobal(e.regX,e.regY),I;if(A){var N=e.parent.localToGlobal(e.x-e.width/2,e.y-e.height/2),p=e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2);I={x:N.x,y:N.y,width:p.x-N.x,height:p.y-N.y}}else I=e.boundsToGlobal();var L={x:e.zimTouch.boundaryStartX+o.x-I.x,y:e.zimTouch.boundaryStartY+o.y-I.y,width:e.zimTouch.boundaryStartW-I.width,height:e.zimTouch.boundaryStartH-I.height};e.gestureBoundary(L,!1)}return e},t.noGesture=function(e,r,i,l){var a="obj, move, scale, rotate",s;if(s=st(t.noGesture,arguments,a))return s;if(De("34.6"),!(n(e)||!e.on||!e.zimTouch))return n(r)&&(r=!0),n(i)&&(i=!0),n(l)&&(l=!0),e.zimTouch.move=!r,e.zimTouch.scale=!i,e.zimTouch.rotate=!l,!e.zimTouch.move&&!e.zimTouch.scale&&!e.zimTouch.rotate&&(e.off("mousedown",e.zimTouch.mousedown),e.off("pressmove",e.zimTouch.pressmove),e.off("pressup",e.zimTouch.pressup),delete e.zimTouch),e},t.gestureBoundary=function(e,r,i){if(De("34.7"),!(n(e)||!e.on)&&!(n(r)||!e.zimTouch)){e.zimTouch.localBoundary&&e.parent?e.zimTouch.boundary=t.boundsToGlobal(e.parent,r):e.zimTouch.boundary=r,n(i)&&(i=!0),i&&(e.zimTouch.boundaryStartX=r.x,e.zimTouch.boundaryStartY=r.y,e.zimTouch.boundaryStartW=r.width,e.zimTouch.boundaryStartH=r.height);var l=e.zimTouch.checkBounds(e.x,e.y);return e.x=l.x,e.y=l.y,e}},t.effect=function(e,r,i,l,a,s){if(De("33.16"),n(r))return e;n(e.effects)&&(e.effects={}),Array.isArray(r)||(r=[r]);for(var f=0,u=0;u<r.length;u++){var y=r[u];y.type||(y instanceof Fe.BlurFilter?y.type="BlurEffect":y instanceof Fe.ColorFilter?y.type="ColorEffect":y instanceof Fe.AlphaMaskFilter?y.type="AlphaEffect":y instanceof Fe.ColorMatrixFilter?y.type="MultiEffect":n(y.type)&&(y.type="custom"+f++));var k=y.type.replace(/effect/i,"");e.effects[k.toLowerCase()]=y}e.filters=[];for(var g in e.effects)e.filters.push(e.effects[g]);return e.cache(i,l,a,s),e},t.updateEffects=function(e,r){return De("33.163"),e.updateCache&&(r?e.cache():e.updateCache()),e},t.noEffect=function(e,r,i){if(De("33.165"),n(i)&&(i=!1),n(r)){var l;e.effects.multi&&(l=e.effects.multi),e.effects={},l&&(e.effects.multi=l)}else{e.effects||(e.effects={}),Array.isArray(r)||(r=[r]);for(var a=0;a<r.length;a++){var s=r[a].replace(/effect/i,"");delete e.effects[s.toLowerCase()]}}e.filters=[];for(var f in e.effects)e.filters.push(e.effects[f]);return i||e.filters.length>0?e.updateCache&&e.updateCache():e.uncache&&e.uncache(),e},t.addPhysics=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E){var A="obj, dynamic, contract, shape, friction, linear, angular, density, bounciness, maskBits, categoryBits, physics, restitution, sensor",C;if(C=st(t.addPhysics,arguments,A))return C;if(De("34.8"),n(O)){if(typeof zimPhysics>"u")return vt&&tt("ZIM Physics module must be imported"),e;n(ee.zimDefaultPhysics)&&(ee.zimDefaultPhysics=new t.Physics),O=ee.zimDefaultPhysics}e.physics=O;var d="rectangle";return e.type=="Circle"||e.type=="Dial"?d="circle":e.type=="Triangle"?d="triangle":e.type=="Blob"&&(d="poly"),n(l)&&(l=d),n(y)&&(y=T),qe(e,r,i,l,a,s,f,u,y,k,g,E),e},t.removePhysics=function(e){return De("34.85"),n(e.physics)||(e==e.physics.followObj&&e.physics.follow(null),e.follow=e.noFollow=e.control=e.noControl=e.sleep=e.wake=null,e.impulse=e.force=e.spin=e.torque=null,e.physics.remove(e.body),e.physics=null),e},t.hitTestPoint=function(e,r,i,l){if(t.zimhtp||(De("35"),t.zimhtp=!0),!e.stage||n(r)||n(i))return!1;if(!(n(e)||!e.globalToLocal)){if(n(l)&&(l=!0),l){var a=e.getBounds();if(a){var s=e.globalToLocal(r,i);if(s.x>a.x+a.width||s.x<a.x||s.y>a.y+a.height||s.y<a.y)return!1}}var f={x:r,y:i};return e.image||e.spriteSheet||e.type=="Shape"?f=e.globalToLocal(f.x,f.y):f=e.globalToLocal(f.x*t.scaX,f.y*t.scaY),e.hitTest(f.x,f.y)}},t.hitTestReg=function(e,r,i){if(t.zimhtr||(De("36"),t.zimhtr=!0),!e.stage||!r.stage)return!1;if(!(n(e)||n(r)||!e.localToLocal||!r.localToLocal)){n(i)&&(i=!0);var l=r.localToGlobal(r.regX,r.regY),a=e.getBounds();if(i&&a){var s=e.globalToLocal(l.x,l.y);if(s.x>a.x+a.width||s.x<a.x||s.y>a.y+a.height||s.y<a.y)return!1}return e.image||e.spriteSheet||e.type=="Shape"?l=e.globalToLocal(l.x,l.y):l=e.globalToLocal(l.x*t.scaX,l.y*t.scaY),e.hitTest(l.x,l.y)}},t.hitTestRect=function(e,r,i,l,a){if(t.zimhtr||(De("37"),t.zimhtr=!0),!e.stage||!r.stage)return!1;if(n(e)||n(r)||!e.hitTest||!r.getBounds)return;n(i)&&(i=0),n(l)&&(l=!0);var s=r.getBounds();if(!s){vt&&tt(`hitTestRect():
 please setBounds() on param b object`);return}if(l){var f=e.getBounds();if(f&&!t.hitTestBounds(e,r))return!1}function u(A){if(e.image||e.spriteSheet||e.type=="Shape"?A=e.globalToLocal(A.x,A.y):A=e.globalToLocal(A.x*t.scaX,A.y*t.scaY),e.hitTest(A.x,A.y))return!0}var y=s.x+s.width/2,k=s.y+s.height/2,g=r.localToGlobal(y,k),O,T;if(a){if(!u(g))return!1;for(var E=0;E<=i;E++)if(O=s.width*(E+1)/(i+1),T=s.height*(E+1)/(i+1),g=r.localToGlobal(s.x+O,s.y),!u(g)||(g=r.localToGlobal(s.x+s.width,s.y+T),!u(g))||(g=r.localToGlobal(s.x+s.width-O,s.y+s.height),!u(g))||(g=r.localToGlobal(s.x,s.y+s.height-T),!u(g)))return!1;return!0}else{if(u(g))return!0;for(var E=0;E<=i;E++)if(O=s.width*(E+1)/(i+1),T=s.height*(E+1)/(i+1),g=r.localToGlobal(s.x+O,s.y),u(g)||(g=r.localToGlobal(s.x+s.width,s.y+T),u(g))||(g=r.localToGlobal(s.x+s.width-O,s.y+s.height),u(g))||(g=r.localToGlobal(s.x,s.y+s.height-T),u(g)))return!0}},t.hitTestCircle=function(e,r,i,l,a){if(t.zimhtc||(De("38"),t.zimhtr=!0),De("38"),!e.stage||!r.stage||n(e)||n(r)||!e.hitTest||!r.getBounds)return;n(i)&&(i=8),n(l)&&(l=!0);var s=r.getBounds();if(!s){vt&&tt(`hitTestCircle():
 please setBounds() on param b object`);return}var f=e.getBounds();if(l&&f&&!t.hitTestBounds(e,r))return!1;function u(d){if(e.image||e.spriteSheet||e.type=="Shape"?d=e.globalToLocal(d.x,d.y):d=e.globalToLocal(d.x*t.scaX,d.y*t.scaY),e.hitTest(d.x,d.y))return!0}var y=s.x+s.width/2,k=s.y+s.height/2,g=r.localToGlobal(y,k),O=(s.width+s.height)/2/2,T,E,A;if(a){if(!u(g))return!1;for(var C=0;C<i;C++)if(T=C/i*2*Math.PI,E=y+O*Math.cos(T),A=k+O*Math.sin(T),g=r.localToGlobal(E,A),!u(g))return!1;return!0}else{if(u(g))return!0;for(var C=0;C<i;C++)if(T=C/i*2*Math.PI,E=y+O*Math.cos(T),A=k+O*Math.sin(T),g=r.localToGlobal(E,A),u(g))return!0}return!1},t.hitTestCircleRect=function(e,r,i){if(t.zimhtcr||(De("38.2"),t.zimhtcr=!0),!(!e.stage||!r.stage)){var l=e.stage;if(!(n(e)||n(r)||!e.getBounds||!r.getBounds)){var a=e.getBounds(),s=r.getBounds();if(!a||!s){vt&&tt(`hitTestCircleRect():
 please setBounds() on both objects`);return}n(i)&&(i=0);var f=(e.radius?e.radius:(a.width+a.height)/2)+i,u=e.getConcatenatedMatrix().decompose().scaleX;f*=u/l.scaleX;var y=r.boundsToGlobal(),k=e.localToGlobal(0,0),g=k.x,O=k.y,T=y.x,E=y.y,A=y.x+y.width,C=y.y+y.height,d=g<T?T:g>A?A:g,x=O<E?E:O>C?C:O,P=d-g,v=x-O;return P*P+v*v<=f*f}}},t.hitTestCircles=function(e,r,i){if(t.zimhtcs||(De("38.5"),t.zimhtcs=!0),!(!e.stage||!r.stage)){var l=e.stage;if(!(n(e)||n(r)||!e.hitTest||!e.getBounds||!r.getBounds)){var a=e.getBounds(),s=r.getBounds();if(!a||!s){vt&&tt(`hitTestCircles():
 please setBounds() on both objects`);return}n(i)&&(i=0);var f=e.localToGlobal(a.x+a.width/2,a.y+a.height/2),u=r.localToGlobal(s.x+s.width/2,s.y+s.height/2),y=e.getConcatenatedMatrix(),k=r.getConcatenatedMatrix(),g=Math.sqrt(y.a/l.scaleX*y.a/l.scaleX+y.c/l.scaleX*y.c/l.scaleX),O=Math.sqrt(y.b/l.scaleY*y.b/l.scaleY+y.d/l.scaleY*y.d/l.scaleY),T=Math.sqrt(k.a/l.scaleX*k.a/l.scaleX+k.c/l.scaleX*k.c/l.scaleX),E=Math.sqrt(k.b/l.scaleY*k.b/l.scaleY+k.d/l.scaleY*k.d/l.scaleY),A=Math.sqrt(Math.abs(Math.pow(f.x-u.x,2)+Math.pow(f.y-u.y,2)));return a.width*Math.max(g,O)/2+s.width*Math.max(T,E)/2>=A-i}}},t.hitTestBounds=function(e,r,i,l){if(t.zimhtb||(De("39"),t.zimhtb=!0),!(!e.stage||!r.stage)&&!(n(e)||n(r)||!e.getBounds||!r.getBounds)){var a=!1;l&&l.graphics&&(a=!0);var s=e.getBounds(),f=r.getBounds();if(!s||!f){vt&&tt(`hitTestBounds():
 please setBounds() on both objects`);return}n(i)&&(i=0);var u=t.boundsToGlobal(e),y=t.boundsToGlobal(r);if(a){var k=l.graphics;k.c(),k.ss(1).s("blue"),k.r(u.x,u.y,u.width,u.height),k.s("green"),k.r(y.x,y.y,y.width,y.height),l.stage.update()}return t.rectIntersect(u,y,i)}},t.hitTestPath=function(e,r,i,l,a,s){if(t.zimhtpa||(De("37.5"),t.zimhtpa=!0),!e.stage||!r.stage||n(e)||n(r)||!e.hitTest||r.type!="Squiggle"&&r.type!="Blob")return;var f=e.getBounds();n(i)&&(i=2),n(l)&&(l=!1),n(a)&&(a=!1),n(s)&&(s=!1);var u=[],y;function k(A){var C;if(e.image||e.spriteSheet||e.type=="Shape"?C=e.globalToLocal(A.x,A.y):C=e.globalToLocal(A.x*t.scaX,A.y*t.scaY),e.hitTest(C.x,C.y))if(a)u.push({x:Math.round(A.x),y:Math.round(A.y)});else if(s)y=O/g.length*100;else return!0}var g=r.interpolate(i,null,!0,null,!0),O,T;if(l)for(r.hitPathPoints?r.hitPathPoints.removeAllChildren():r.hitPathPoints=new t.Container().addTo(),r.hitPathPoints.top(),O=0;O<g.length;O++)T=g[O],T=r.localToGlobal(T.x,T.y),new t.Circle(3).loc(T.x,T.y,r.hitPathPoints);if(f){var E=t.boundsAroundPoints(g);if(!t.rectIntersect(e.boundsToGlobal(f),r.boundsToGlobal(E)))return!1}for(O=0;O<g.length;O++){if(T=g[O],T=r.localToGlobal(T.x,T.y),k(T))return!0;if(y!=null)return y}return u.length>0?u:!1},t.hitTestGrid=function(e,r,i,l,a,s,f,u,y,k,g,O,T){if(t.zimhtg||(De("41"),t.zimhtg=!0),!e.stage)return!1;if(!n(e)&&!O){var E=e.globalToLocal(s,f);s=E.x,f=E.y}n(u)&&(u=0),n(y)&&(y=0),n(k)&&(k=0),n(g)&&(g=0),r+=k,i+=g;var A=r/l,C=i/a,d=Math.min(l-1,Math.max(0,Math.floor((s-u+k/2)/A))),x=Math.min(a-1,Math.max(0,Math.floor((f-y+g/2)/C)));if(!(T!="open"&&(s-u>A*(d+1)-k||s-u<A*d||f-y>C*(x+1)-g||f-y<C*x))){var P=x*l+d;if(n(T)||T=="index")return P;if(T=="col")return d;if(T=="row")return x;if(T=="array"||T=="open")return[P,d,x]}},t.animate=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue,ge,ie){var xe="target, props, time, ease, call, params, wait, waitedCall, waitedParams, loop, loopCount, loopWait, loopCall, loopParams, loopWaitCall, loopWaitParams, loopPick, rewind, rewindWait, rewindCall, rewindParams, rewindWaitCall, rewindWaitParams, rewindTime, rewindEase, startCall, startParams, animateCall, animateParams, sequence, sequenceCall, sequenceParams, sequenceReverse, ticker, cjsProps, css, protect, override, from, set, id, events, sequenceTarget, dynamic, drag, clamp, startPaused, clean, obj, seriesWait, sequenceWait, rate, pauseOnBlur, easeAmount, easeFrequency, timeUnit, timeCheck, noAnimateCall, pathDamp";if(e&&(e.props||e.obj)){var Se;if(Se=st(t.animate,arguments,xe))return Se}if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("animate",arguments),e;if(t.animateCheck||(De("45"),t.animateCheck=!0),!e)return;var z=t.ANIMATE;if(ee.ANIMATE!=null&&(z=ee.ANIMATE),!z)return n(ge)&&(ge=!0),a&&ge&&typeof a=="function"&&a(n(s)?e:s),e;n(ue)&&(ue=!0);var pe=Tt(null,q,null,null,n(ue)?!1:!ue);(g||T||O)&&(k=!0),(Y||v||Y||m||P)&&(x=!0);var de,oe,Be,$=arguments,Me=Array.prototype.slice.call(arguments);if(n(r)&&!n(te)&&(r=te),te=r,n(te))return vt&&tt("animate() - need props"),e;if(e.type=="BeadsContainer"&&n(U)&&(U=0),e.type=="Tone"&&(Te=!1),Te===!1?t.pauseAnimateOnBlur=!1:(Te||n(Te)&&t.pauseAnimateOnBlur!==!1)&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseAnimateOnBlur=!0),!(!n(U)&&e.addChild)){i=t.Pick.choose(i),l=t.Pick.choose(l),f=t.Pick.choose(f),g=t.Pick.choose(g),O=t.Pick.choose(O),x=t.Pick.choose(x),P=t.Pick.choose(P),n(Y)?Y=i:Y=t.Pick.choose(Y),ne=t.Pick.choose(ne),I=t.Pick.choose(I),N=t.Pick.choose(N);var be=["loopCount","loopWait","rewind","rewindWait"];for(oe in D)be.indexOf(oe)>=0&&(D[oe]=t.Pick.choose(D[oe]))}var me={override:!n(e)&&!n(e.zimX)&&!n(te.x)||!n(e)&&!n(e.zimY)&&!n(te.y)};n(k)||(me.loop=k),n(g)||(me.count=g),n(O)||(me.loopWait=O),n(T)||(me.loopCall=T),n(C)||(me.loopWaitParams=C),n(A)||(me.loopWaitCall=A),n(E)||(me.loopParams=E),n(d)||(me.loopPick=d),n(x)||(me.rewind=x),n(P)||(me.rewindWait=P),n(v)||(me.rewindCall=v),n(w)||(me.rewindParams=w),n(b)||(me.rewindWaitCall=b),n(X)||(me.rewindWaitParams=X),n(j)||(me.startCall=j),n(S)||(me.startParams=S),n(_)||(me.animateCall=_),n(R)||(me.animateParams=R),n(r)||(me=t.merge(me,D)),D=me,t.loop(te,function(Ee,at){if(typeof Ee=="string"){var ut=Ee.split(".");if(ut.length>1&&Ee.substr(0,1)!="."&&(te["."+Ee]=at,delete te[Ee],Ee="."+Ee),ut.length>1&&typeof at=="string"){var pt=at.substr(0,1);pt!="+"&&pt!="-"&&(te[Ee]="+"+at)}}});function re(Ee,at){if(at.substr(0,1)=="."){for(var ut=at.split("."),pt=Ee,Lt=1;Lt<ut.length;Lt++)pt=pt[ut[Lt]];return pt}else return at=="transform"&&Ee.style?Ee.style.transform:Ee[at]}function ke(Ee,at,ut){if(at.substr(0,1)=="."){for(var pt=at.split("."),Lt=Ee,Ft=1;Ft<pt.length-1;Ft++)Lt=Lt[pt[Ft]];Lt[pt[pt.length-1]]=ut}else Ee[at]=ut}if(e.zimTweenOriginals={},!n(U)&&e.addChild){var Re=[];for(de=0;de<e.numChildren;de++)Re.push(e.getChildAt(de));we=e,e=Re}var Ye=["extra","zoom","speed","layer","fade"],$e={zoom:e.type=="Pen"?"size":"scale",speed:"percentSpeed",layer:"layer",fade:"alpha"};if(e instanceof Array){for(ne&&e.reverse(),de=0;de<e.length;de++){var it=e[de];if(I){var Le;it.zimObj={};for(oe in te){if(Ye.indexOf(oe)>=0?Le=te[oe]:Le=t.Pick.choose(te[oe]),it.zimObj[oe]=it[oe],typeof Le=="string"&&oe!="transform"){var Ze;it.zimLastObj&&!n(it.zimLastObj[oe])?Ze=it.zimLastObj[oe]:Ze=it[oe],Le=Ze+Number(Le.replace(/\s/g,""))}it.zimLastObj&&(it.zimLastObj[oe]=x?it.zimTweenOriginals[oe]:te[oe]),it[oe]=Le}}else{it.zimObj={};for(oe in te)Ye.indexOf(oe)>=0,it.zimObj[oe]=te[oe]}var ze=de*U;de==0&&U!=0&&(ze=pe=="s"?.02:20),t.animate(it,it.zimObj,i,l,de==e.length-1?a:null,de==e.length-1?s:null,f,u,y,null,null,null,null,null,null,null,d,null,null,null,null,null,null,Y,m,j,S,_,R,null,Z,K,null,V,t.copy(D),c,h,o,null,N,p,L,we,B,F,fe,se,Q,te,le,ze,J,Te,G,ce,q,ue,ge,ie)}return we}var ve=i,Pe=Y;n(ve)&&(ve=pe=="s"?1:1e3),n(Y)&&(Y=Pe=ve),n(l)&&(l="quadInOut"),n(f)&&(f=0),n(P)&&(P=0),n(D)&&(D={override:!n(e.zimX)&&!n(te.x)||!n(e.zimY)&&!n(te.y)}),n(s)&&(s=e),n(V)&&(V=!0),n(c)&&(c=!1),n(h)&&(h=!1),n(I)&&(I=!1),n(N)&&(N={}),N.scale&&(N.scaleX=N.scaleY=N.scale,delete N.scale),n(o)||(D.override=o),n(F)&&(F=!1),n(se)&&(se=!!F),n(B)&&(B=!1),n(fe)&&(fe=!0),n(Q)&&(Q=!0),n(ie)&&(ie=.15),n(J)&&(J=1),e.futureRate=J;var ae,Ne,Ke;if(te instanceof Array){if(Be=1,te.length==0)return this;var Xe,Qe;return Ie(),Qt(),he(),e}function he(){e.zimLastObj&&t.loop(e.zimLastObj,function(An){n(e.zimTweenOriginals[An])||(e[An]=e.zimTweenOriginals[An],e.zimLastObj[An]=e.zimTweenOriginals[An])});for(var Ee,at=f,ut=0,pt,Lt,Ft=0;Ft<te.length;Ft++)if(Ee=te[Ft],!n(Ee.target)){n(Ee.time)&&(Ee.time=ve),at+=Ee.wait?Ee.wait:0,pt=Ee.time,Lt=n(Ee.rewindTime)?pt:Ee.rewindTime,Ee.rewind&&(pt=pt+Lt+(Ee.rewindWait?Ee.rewindWait:0)),Ee.loop&&(pt*=Ee.loopCount,pt+=(Ee.loopCount-1)*(Ee.loopWait?Ee.loopWait:0)),n(Ee.params)&&(Ee.params=Ee.target),Qe=Ee.target,at<0&&(ut+=at,at=0);var pn={target:Ee.target,obj:t.copy(Ee.obj),seriesWait:ut,wait:at,waitedCall:Ee.waitedCall,waitedParams:Ee.waitedParams,time:Ee.time,ease:Ee.ease,from:Ee.from,rewind:Ee.rewind,call:Ee.call,params:Ee.params,loop:Ee.loop,loopCount:Ee.loopCount,loopWait:Ee.loopWait,loopCall:Ee.loopCall,loopParams:Ee.loopParams,loopWaitCall:Ee.loopWaitCall,loopWaitParams:Ee.loopWaitParams,loopPick:Ee.loopPick,rewindWait:Ee.rewindWait,rewindCall:Ee.rewindCall,rewindParams:Ee.rewindParams,rewindWaitCall:Ee.rewindWaitCall,rewindWaitParams:Ee.rewindWaitParams,rewindTime:Ee.rewindTime,rewindEase:Ee.rewindEase,startCall:Ee.startCall,startParams:Ee.startParams,animateCall:Ee.animateCall,animateParams:Ee.animateParams,set:t.copy(Ee.masterSet),events:L,rate:e.futureRate,pauseOnBlur:Ee.pauseOnBlur,easeAmount:Ee.easeAmount,easeFrequency:Ee.easeFrequency,override:!1,id:p};Ft==te.length-1&&Ge(pn),t.animate(pn),ut+=at+pt,at=0}}function Ge(Ee){var at=Ee.call,ut=Ee.params;D.loop&&(!D.count||Be<D.count)?Ee.call=function(){at&&typeof at=="function"&&at(ut||e),D.loopCall&&typeof D.loopCall=="function"&&D.loopCall(D.loopParams||e),D.loopWait?(n(e.zimTweens)&&(e.zimTweens={}),ae=e.zimTweens[p]=e.zimTween=Fe.Tween.get(e,{override:D.override}).wait(D.loopWait,!0).call(pt),ae.timeScale=e.futureRate):pt();function pt(){for(var Lt=0;Lt<Xe.objects.length;Lt++)Xe.objects[Lt].set&&Xe.objects[Lt].set(Xe.values[Lt]);D.loopWaitCall&&typeof D.loopWaitCall=="function"&&D.loopWaitCall(D.loopWaitParams||e),he()}}:Ee.call=function(){at&&typeof at=="function"&&at(ut),n(s)&&(s=Qe),a&&typeof a=="function"&&a(s),e.zimLastObj=null},Be++}function Ie(){e&&!e.seriesTweens&&(e.seriesTweens=[],e.seriesCalls=[],e.seriesParams=[]);for(var Ee,at=0;at<te.length;at++)Ee=te[at],Ee.target?(Ee.target.seriesTweens||(Ee.target.seriesTweens=[]),Ee.target.seriesCalls||(Ee.target.seriesCalls=[]),Ee.target.seriesParams||(Ee.target.seriesParams=[]),Ee.target.seriesTweens.push(Ee.props),Ee.target.seriesCalls.push(Ee.call),Ee.target.seriesParams.push(Ee.params)):(e.seriesTweens.push(Ee.props),e.seriesCalls.push(Ee.call),e.seriesParams.push(Ee.params));e.seriesCalls.push(a),e.seriesParams.push(s),Ee=te[0];var ut;for(e?ut=e:ut=Ee.target,ut.zimSeriesOriginals={},at=te.length-1;at>=0;at--)Ee=te[at],n(Ee.props)&&!n(Ee.obj)&&(Ee.props=Ee.obj),Ee.obj=Ee.props,t.loop(Ee.obj,function(fr){fr=="path"?ut.zimSeriesOriginals[fr]=te[fr]:ut.zimSeriesOriginals[fr]=re(ut,fr)});var pt=new t.Dictionary;for(Xe=new t.Dictionary,at=0;at<te.length;at++)if(Ee=te[at],e||(e=Ee.target),n(Ee.target)&&(Ee.target=e),n(Ee.ease)&&(Ee.ease=l),!n(Ee.target)){if(at==0&&(Ee.target.zimSeriesArgs=$),n(Ee.props)&&!n(Ee.obj)&&(Ee.props=Ee.obj),Ee.obj=Ee.props,Ee.loop&&(n(Ee.loopCount)||Ee.loopCount<=0)&&(Ee.loopCount=0,te.splice(at+1,te.length)),n(Ee.obj.scale)||(Ee.obj.scaleX=Ee.obj.scaleY=Ee.obj.scale,delete Ee.obj.scale),Ee.from){var Lt=pt.at(Ee.target);if(Lt){if(Ee.set){var Ft=t.copy(Ee.obj),pn=t.merge(Lt,Ee.set);Ee.obj=Jt(Ee.target,Ee.obj,pn),Ee.set=t.merge(Ee.set,Ft)}else Ee.set=t.copy(Ee.obj),Ee.obj=Jt(Ee.target,Ee.obj,Lt);Ee.from=!1}else pt.add(Ee.target,Jt(Ee.target,Ee.obj,Ee.set))}var An={};for(var Xn in Ee.obj)An[Xn]=Ee.set&&Ee.set[Xn]?Ee.set[Xn]:Ee.target[Xn];n(Xe.at(Ee.target))&&Xe.add(Ee.target,{});var rr=t.merge(Xe.at(Ee.target),An);Xe.remove(Ee.target),Xe.add(Ee.target,rr),Ee.masterSet=t.copy(Ee.set)}n(e.zimTweens)&&(e.zimTweens={})}if(te&&(te.x&&(e.zimX=!0),te.y&&(e.zimY=!0)),!n(te.shape)&&te.shape.type==e.type&&(e.type=="Blob"||e.type=="Squiggle")){var _e=e.pointObjects,Je=te.shape.pointObjects;if(_e.length!=Je.length)vt&&tt("animate() - shapes must be of same number of points"),delete te.shape;else{delete te.shape;var Oe=n(te.blobShift)?0:te.blobShift;delete te.blobShift;var Ve=!0;for(de=0;de<_e.length;de++){var rt=_e[de],Ce=Je[(_e.length*2e4+de+Oe)%_e.length];for(Yn=0;Yn<4;Yn++)if(Yn!=1){var We=rt[Yn],lt=t.copy(Me);lt[0]=We,lt[1]={x:Ce[Yn].x,y:Ce[Yn].y,rotation:Ce[Yn].rotation},Ve&&(lt[37]=!0,We.animateEvent&&We.off("animation",We.animateEvent),We.animateEvent=We.on("animation",function(){e.update()})),Ve=!1,t.animate.apply(t.animate,lt)}}if(t.isEmpty(te))return e}}if(n(e))return;e.tweenStates||(e.tweenStates={all:!0});var Ue=!1;if(te.note){if(Array.isArray(te.note))t.loop(te.note,function(Ee,at){typeof Ee=="string"&&(te.note[at]=t.Synth.note(Ee))});else if(te.note.min)te.note.min=t.Synth.note(te.note.min),te.note.max=t.Synth.note(te.note.max);else if(te.note.array)t.loop(te.note.array,function(Ee,at){typeof Ee=="string"&&(te.note.array[at]=t.Synth.note(Ee))});else if(typeof te.note=="function"){if(vt)return tt("animate() - use frequency in ZIM VEE functions not note"),e}else te.note=t.Synth.note(te.note);te.frequency=te.note,delete te.note}function ct(Ee,at){return!!Object.getOwnPropertyDescriptor(Ee,at).get}(e.type=="Sprite"||!Object.prototype.hasOwnProperty.call(e,"paused"))&&(Object.defineProperty(e,"paused",{get:function(){return e.animatePaused},set:function(Ee){e.animatePaused=Ee}}),e.type!=null&&(e.paused=!0),e.animating=!1),e.endTween=function(Ee,at){if(e.stopAnimate(at),Ee!="all"&&Ee!="main"&&Ee!="none"&&(Ee="all"),!e.seriesTweens)t.loop(e.zimLastObj,function(pt){typeof e.zimLastObj[pt]=="string"&&pt!="transform"&&(e.zimLastObj[pt]=e[pt]+Number(e.zimLastObj[pt].replace(/\s/g,""))),ke(e,pt,e.zimLastObj[pt])}),Ee!="none"&&a&&a(s);else{if(t.loop(e.seriesTweens,function(pt,Lt){t.loop(pt,function(Ft){typeof pt[Ft]=="string"&&Ft!="transform"&&(pt[Ft]=e[Ft]+Number(pt[Ft].replace(/\s/g,""))),ke(e,Ft,pt[Ft])}),Ee=="all"&&e.seriesCalls[Lt]&&e.seriesCalls[Lt](e.seriesParams[Lt])}),Ee!="none"){var ut=e.seriesCalls[e.seriesCalls.length-1];ut&&ut(e.seriesParams[e.seriesParams.length-1])}e.seriesTweens=null,e.seriesCalls=null,e.seriesParams=null}return e.stage&&e.stage.update(),e};var ot=!1;if(t.loop(te,function(Ee,at){Ee=="path"?e.zimTweenOriginals[Ee]=te[Ee]:e.zimTweenOriginals[Ee]=re(e,Ee),Ee.match("hue")?(te.hueBatch=at,delete te.hue,ot=!0):Ee.match("saturation")?(te.saturationBatch=at,delete te.saturation,ot=!0):Ee.match("brightness")?(te.brightnessBatch=at,delete te.brightness,ot=!0):Ee.match("contrast")?(te.contrastBatch=at,delete te.contrast,ot=!0):Ee.match(/^.effects/)&&(ot=!0)}),e.resetTween=function(Ee){n(Ee)&&(Ee=!0),e.pauseAnimate(),e.percent=null,e.startPercent=null;var at=e.zimSeriesOriginals?e.zimSeriesOriginals:e.zimTweenOriginals;return t.loop(at,function(ut){if(ut=="path"){e.percentComplete=0,e.zimPath=at[ut];var pt;e.zimStartPercent,pt=e.zimPath.getCurvePoint(e.zimStartPercent/100),e.loc(pt.x,pt.y)}else ke(e,ut,at[ut])}),e.zimLastObj=null,e.stage&&e.stage.update(),e.stopAnimate(),e.zimPath&&(Me[1].path=e.zimPath),n(e.zimStartRotation)||(e.rotation=e.zimStartRotation),e.zimStartRotation=null,n(e.zimStartScaleX)||(e.scaleX=e.zimStartScaleX),e.zimStartScaleX=null,n(e.zimStartScaleY)||(e.scaleY=e.zimStartScaleY),e.zimStartScaleY=null,t.animate.apply(null,e.zimSeriesArgs?e.zimSeriesArgs:Me),e.pauseAnimate(Ee),e},e.replayTween=function(){return e.resetTween(!1),e},te.path||B){var dt;e.requestedPercentComplete?dt=e.requestedPercentComplete:e.percentComplete&&!ct(e,"percentComplete")&&(dt=e.percentComplete),e.requestedPercentComplete=null,n(dt)&&(dt=0),e.pathRatio=0,e.zimStartRotation=e.rotation,e.percent=null,e.parent&&e.parent.type=="BeadsContainer"||(e.startPercent=null)}c&&(V=!1),n(e.zimTweens)&&(e.zimTweens={});var et;if(c||(e.stage?et=e.stage:ee.zdf?et=ee.zdf.stage:c=!0),e.setColorRange&&!n(te.color)){var St=te.color;delete te.color,te.colorRange=1,e.setColorRange(e.color,St),e.colorRange=0}else if(te.color&&(e.material||e.isMaterial)){if(e.isMaterial)return tt("ZIM animate - please animate the color on the mesh not the material"),e;var ht=e;ht.cT&&t.Ticker.remove(ht.cT),e={val:0,zimTweens:{},ticker:ht.cT};var gt=ht.material.color.getHexString(),Bt=te.color;if(te={val:1},ht.cT=t.Ticker.add(function(){var Ee=t.colorRange("#"+gt,Bt,e.val);ht.material.color.set(Ee)}),a){var Dt=a;a=function(){ht.cT==e.ticker&&(Dt(callParams||ht),t.Ticker.remove(ht.cT),ht.cT=null,e=null)}}else a=function(){ht.cT==e.ticker&&(t.Ticker.remove(ht.cT),ht.cT=null,e=null)}}var Ht={};for(de in te)Ye.indexOf(de)>=0||(Ht[de]=t.copy(te[de]),te[de]=t.Pick.choose(te[de]));n(te.scale)||(te.scaleX=te.scaleY=t.Pick.choose(te.scale),delete te.scale);for(var nn in te){if(!e.zimBusy)break;e.zimBusy[nn]&&delete te[nn]}if(t.isEmpty(te))return;if(e.type!="Sprite")e.type!=null&&(e.paused=!1),e.animating=!0;else for(var en in te)if(en!="normalizedFrame"){e.animating=!0;break}function kt(){e.zimMouseEnabledCheck||(e.zimMouseEnabledCheck=!0,e.zimLastMouseEnabled=e.mouseEnabled),e.mouseEnabled=!1,setTimeout(function(){e.zimBusy||(e.zimBusy={});for(var Ee in te)e.zimBusy[Ee]=!0;e.zimMouseEnabledCheck=null,e.mouseEnabled=e.zimLastMouseEnabled},70)}(h||D.loop||D.rewind)&&kt(),Qt();function Qt(){n(p)?p=t.makeID(null,10):(p=String(p),Ke=p),n(e.zimIdSets)&&(e.zimIdSets={}),n(e.zimIdSets[p])?e.zimTweens&&!n(e.zimTweens[p])&&(Ne=p,p=t.makeID(null,10),e.zimIdSets[Ne]=[Ne],e.zimTweens[Ne].zimIdSet=Ne,e.zimIdSets[Ne].push(p)):(Ne=p,p=t.makeID(null,10),e.zimIdSets[Ne].push(p))}Ye.shift();for(de in N)N[de]=t.Pick.choose(N[de]);for(de in D)de=="waitedCall"||de=="waitedParams"||de=="loopCall"||de=="rewindCall"||de=="loopWaitCall"||de=="rewindWaitCall"||de=="startCall"||de=="animateCall"||(D[de]=t.Pick.choose(D[de]));He();function He(){Mt(),Xt(),e.seriesTweens&&(e.seriesTweens[0]=te),I&&!Ue&&(te=Jt(e,te,N,!0))}function yt(){Mt(),I&&!Ue&&(te=Jt(e,te,N,!0))}function Mt(){var Ee;e.zimLastObj||(e.zimLastObj={});for(de in te){if(typeof te[de]=="string"&&de!="transform"){if(de.substring&&de.substring(0,1)=="."){if(te[de].substr(0,1)=="+"||te[de].substr(0,1)=="-")continue}else if(te[de].substr(0,1)=="+")continue;if(te[de].substr(0,3)=="rgb")continue;e.zimLastObj&&!n(e.zimLastObj[de])?Ee=e.zimLastObj[de]:Ee=e[de],te[de]=Ee+Number(te[de].replace(/\s/g,""))}e.zimLastObj[de]=x?e.zimTweenOriginals[de]:te[de]}}function Xt(){var Ee;for(de in N){if(typeof N[de]=="string"&&de!="transform"){if(de.substring&&de.substring(0,1)=="."){if(N[de].substr(0,1)=="+"||N[de].substr(0,1)=="-")continue}else if(N[de].substr(0,1)=="+")continue;if(N[de].substr(0,3)=="rgb")continue;e.zimLastObj&&!n(e.zimLastObj[de])?Ee=e.zimLastObj[de]:Ee=e[de],N[de]=Ee+Number(N[de].replace(/\s/g,""))}e.zimLastObj[de]=x?e.zimTweenOriginals[de]:te[de]}}e.getBounds&&n(e.percentCompleteCheck)&&(e.percentCompleteCheck=!0,e._percentComplete=0,Object.defineProperty(e,"percentComplete",{get:function(){if(e.paused)return e._percentComplete;if(e.tweenStartTime&&e.tweenEndTime){var Ee=Date.now(),at;D.loop&&Ee>e.tweenEndTime?at=(Ee-e.tweenStartTime)%(e.tweenEndTime-e.tweenStartTime):at=Ee-e.tweenStartTime;var ut=Math.max(0,Math.min(100,at/(e.tweenEndTime-e.tweenStartTime)*100));return e._percentComplete=ut,ut}else return 0},set:function(Ee){this.zimTween?(Zn=!0,Yt(Ee,!0)):this.requestedPercentComplete=Ee,e._percentComplete=Ee}}),Object.defineProperty(e,"percentCompleteNoAngle",{get:function(){if(e.paused)return e._percentComplete;if(e.tweenStartTime&&e.tweenEndTime){var Ee=Date.now(),at;D.loop&&Ee>e.tweenEndTime?at=(Ee-e.tweenStartTime)%(e.tweenEndTime-e.tweenStartTime):at=Ee-e.tweenStartTime;var ut=Math.max(0,Math.min(100,at/(e.tweenEndTime-e.tweenStartTime)*100));return e._percentComplete=ut,ut}else return 0},set:function(Ee){this.zimTween?Yt(Ee,!1):this.requestedPercentComplete=Ee,e._percentComplete=Ee}})),Object.defineProperty(e,"rate",{get:function(){return e.futureRate},set:function(Ee){e.futureRate=Ee,t.loop(e.zimTweens,function(at,ut){ut.timeScale=Ee})},configurable:!0});function Yt(Ee,at){e.zimTween.startPaused=!1,B?n(e.zimTween.currentTime)||(e.zimTween.currentTime=e.zimTween.currentTime-e.zimTween.position+Ee*e.zimTween.duration/100):e.zimTweens?t.loop(e.zimTweens,function(ut,pt,Lt){var Ft=e.tweenStartTime+(e.tweenEndTime-e.tweenStartTime)*Ee/100,pn;pt.zimLoop&&Ft<=pt.startTime?pn=0:pt.zimLoop&&Ft>pt.startTime+pt.duration?pn=(Ft-pt.startTime)%pt.duration:pn=Ft-pt.startTime,pt.percentComplete=Math.max(0,Math.min(100,pn/pt.duration*100))}):e.zimTween.setPosition(Math.round(Ee*e.zimTween.duration/100)),at&&ft&&te.orient!==!1&&ft.getCurvePoint&&(e.rotation=ft.getCurvePoint(e.pathRatio,null,null,!0).angle+(En||0)),Zn&&typeof _t<"u"&&(_t=Ee),e.handlePath&&e.handlePath()}var ft,bt,Gt,Kt;if(!n(te.path)&&te.path.segmentPoints){n(te.orient)&&(te.orient=!0),te.orient&&n(te.flip)&&(te.flip=!0),e.type=="Pen"&&(e.infinite=!0),e.zimOnPath=!0,n(e.pathRatio)&&(e.pathRatio=0),te.orient&&(te.orient=te.path,te.startOrient=te.rotation),ft=te.path,F?(delete te.path,delete te.percent,(vt&&e.startPercent&&e.startPercent>0||e.percent&&e.percent!=100)&&tt("ZIM.animate() - startPercent and percent currently not supported with drag on path"),bt=ft.getCurvePoint(e.pathRatio,Ct,Kt),bt&&(Gt=e.parent.globalToLocal(bt.x,bt.y),e.x=Gt.x,e.y=Gt.y)):(n(e.startPercent)&&(e.startPercent=t.Pick.choose(n(te.startPercent)?0:te.startPercent)),n(e.percent)&&(e.percent=t.Pick.choose(n(te.percent)?100:te.percent)),delete te.path,delete te.percent);var fn=!ft.lockControls;delete te.path,te.pathRatio=1}function Jt(Ee,at,ut,pt){Ue=!0,ft&&(!n(Ee.percentComplete)||ut&&!n(ut.percentComplete))&&(ut||(ut={}),n(ut.pathRatio)&&(ut.pathRatio=n(ut.percentComplete)?Ee.percentComplete/100:ut.percentComplete/100));var Lt={};for(de in at)ut&&!n(ut[de])?Lt[de]=ut[de]:Lt[de]=Ee[de],pt&&(Ee[de]=at[de]);return Lt}var rn=!0,jt=!1,gn=!0,xt=!0;n(te.redirect)||(xt=te.redirect,delete te.redirect);function je(Ee){var at=ft.globalToLocal(Ee.rawX/t.scaX,Ee.rawY/t.scaY),ut=Nn;ft.type=="Blob"&&(xn[0]<xn[4]?wt=!0:xn[0]>xn[4]&&(wt=!1),ut<10&&!wt?(Ln=Nn=ut=$t-5,Qn.immediate(Ln/$t*100),xn=[$t-1,$t-2,$t,$t-3,$t-4]):ut>$t-10&&wt&&(Ln=Nn=ut=5,Qn.immediate(Ln/$t*100),xn=[0,0,0,0,0]));var pt={x:at.x,y:at.y,r:ut};Rn.sort(function(Lt,Ft){var pn={x:Lt.x,y:Lt.y,r:Lt.r*$t},An={x:Ft.x,y:Ft.y,r:Ft.r*$t},Xn=Math.sqrt(Math.pow(pt.x-pn.x,2)+Math.pow(pt.y-pn.y,2)+Math.pow(pt.r-pn.r,2)),rr=Math.sqrt(Math.pow(pt.x-An.x,2)+Math.pow(pt.y-An.y,2)+Math.pow(pt.r-An.r,2));return Xn-rr}),Ln=Rn[0].r*$t,_t=Ln/$t*100,_t=t.constrain(_t,0,99.95),x&&(_t/=2,ae.position>ae.duration/2&&(_t=100-_t))}if(ft){let Ee=function(ut){return ut.latestTween?ut.latestTween.percentComplete:ut.percentComplete},at=function(ut,pt){ut&&(ut.zimTween&&(ut.zimTween.startPaused=!1),ut.latestTween&&(ut.latestTween.percentComplete=pt),Zn&&typeof _t<"u"&&(_t=value),ut.handlePath&&ut.handlePath())};var Ct;fn||(Kt=t.copy(ft.segmentPoints),Ct=t.copy(ft.segmentRatios)),e.currentPercent=e.startPercent+e.percent*e.pathRatio;var Wt=(1e6+e.currentPercent)%100/100;if(bt=ft.getCurvePoint(Wt,Ct,Kt),e.parent&&bt&&(Gt=e.parent.globalToLocal(bt.x,bt.y),e.x=Gt.x,e.y=Gt.y),F){l="linear",e.cur("pointer");var _t;te.startPercent!=null?_t=te.startPercent:_t=0;var tn=!1,Ut=!0,wt=!0,Vt=_t,yn=10;Kt=t.copy(ft.segmentPoints);var $t=0;t.loop(Kt,function(ut){$t+=t.distanceAlongCurve(ut)});var an=Math.round($t/Kt.length/yn),Rn=ft.interpolate(an,null,!0,null,!0),Nn=(_t||0)/100*$t,Ln=Nn;ft.zimAnimateChanged=!1,e.zimAnimatePathChange=ft.on("change",function(){ft.zimAnimateChanged=!0}),e.zimAnimatePathDown=ft.on("mousedown",function(){tn=!0,e.paused==!0&&(jt=!0)}),e.zimAnimatePathUp=ft.on("pressup",function(){jt=!1}),e.zimAnimateDragDown=e.on("mousedown",function(ut){et=ut.target.stage,e.amu||(e.amu=et.frame.on("mouseupplus",function(){jt=!1})),et.mouseMoveOutside=!0,rn=!1,gn=!0,setTimeout(function(){rn=!0},50),jt=!0,ft.zimAnimateChanged&&(Kt=t.copy(ft.segmentPoints),$t=0,t.loop(Kt,function(Lt){$t+=t.distanceAlongCurve(Lt)}),an=Math.round($t/Kt.length/yn),Rn=ft.interpolate(an,null,!0,null,!0)),ft.zimAnimateChanged=!1,_t=Ee(e),Qn.immediate(_t);var pt=_t;x&&(ae.position>ae.duration/2?pt=(100-_t)*2:pt=_t*2),Nn=(pt||0)/100*$t,Ln=Nn});var zn=!1;e.zimAnimateDragPress=e.on("pressmove",function(ut){zn=!0,je(ut)}),e.animateReturn=function(){if(!x){vt&&tt("animate() - animateReturn() needs rewind set to true");return}Ut=!1,wt=!1,Ee(e)<50&&at(e,100-Ee(e)),e.pauseAnimate(!1)},e.zimAnimateDragUp=e.on("pressup",function(){e.paused==!1&&(jt=!1),rn=!1,setTimeout(function(){rn=!0},50),xn[0]<xn[4]?wt=!0:xn[0]>xn[4]&&(wt=!1),!e.paused&&x&&xt&&wt!=Ut&&(at(e,100-Ee(e)),Ut=wt)});var Qn=new t.Damp(_t,ie),qn=0,cn=0,xn=[0,0,0,0,0],Zn=!1;e.zimDragAnimateTicker=t.Ticker.add(function(){var ut;F&&(++cn%20&&(xn.push(Ln),xn.shift()),Nn=Ln,tn&&(_t=Ee(e)),jt||gn&&e.paused==!0?(tn||Zn||ft.type=="Blob"&&Math.abs(qn-_t)>(x?45:90)?(tn=!1,ut=_t,Qn.immediate(ut),Zn=!1):ut=Qn.convert(_t),Math.abs(qn-ut)>.1?(at(e,ut),qn=ut):(at(e,ut),gn=!1,zn=!1)):gn=!1)},et)}}var sn;if(te.orient){if(te.orient===!0){var on=e.parent.localToGlobal(n(te.x)?e.x:te.x,n(te.y)?e.y:te.y);te.orient={x:on.x,y:on.y}}sn=te.orient,delete te.orient;var En=e.rotation;if(e.rotation=ft.getPointAngle(0)+En,sn!=ft){var Fn;sn.parent?Fn=sn.parent.localToLocal(sn.x,sn.y,e.parent):Fn=e.parent.globalToLocal(sn.x,sn.y),e.rotation=t.angle(e.x,e.y,Fn.x,Fn.y)+En}}var lr=e.scaleX,ar=e.scaleY,Pn=te.flip!=null?te.flip:!1,kn=te.flipVertical!=null?te.flipVertical:!1,In=e.x,qt=e.y,ln=0;D.loop&&(n(D.count)||(ln=D.count,delete D.count,Be=1));var zt=0;D.loopWait&&(zt=D.loopWait,O=D.loopWait,delete D.loopWait);var wn;D.loopCall&&(wn=D.loopCall,delete D.loopCall);var On=e;D.loopParams&&(On=D.loopParams,delete D.loopParams),ee.TIMECHECK&&ue&&(ve&&Pt(ve,pe),Pe&&Pt(Pe,pe),f&&Pt(f,pe),Vn&&Pt(Vn,pe),zt&&Pt(zt,pe),O&&Pt(O,pe),D.rewindWait&&Pt(D.rewindWait,pe),le&&Pt(le,pe),Ae&&Pt(Ae,pe)),pe=="s"&&(ve&&(ve*=1e3),Pe&&(Pe*=1e3),f&&(f*=1e3),Vn&&(Vn*=1e3),zt&&(zt*=1e3),O&&(O*=1e3),D.rewindWait&&(D.rewindWait*=1e3),le&&(le*=1e3),Ae&&(Ae*=1e3));var Tn=ve;D.rewind&&(Tn+=Pe),e.zimTweenArgs={time:Tn,wait:f,wait2:Vn,wait3:zt,loopWait:O,rewindWait:D.rewindWait,seriesWait:le,sequenceWait:Ae};function $n(){if(zt>0&&(e.waiting=!1),!!D.loop){if(Z&&typeof Z=="function"){var Ee=n(K)?e:K;Z(Ee)}if(wn&&typeof wn=="function"&&wn(On||e),d){var at=t.Pick.choose(e.futureRate);n(e.futureRate)||(ae.timeScale=at);var ut;if(n(Ht.scale)||(ut=t.Pick.choose(Ht.scale)),!I&&ae.step&&ae.step.prev&&ae.step.prev.props){for(var pt in ae.step.prev.props)if(!(Ye.indexOf(pt)>=0)){var Lt=t.Pick.choose(Ht[pt]);if(typeof Lt=="string"&&pt!="transform"&&Lt.substr(0,1)!="+"&&Lt.substr(0,1)!="-"){var Ft;e.zimLastObj&&!n(e.zimLastObj[pt])?Ft=e.zimLastObj[pt]:Ft=e[pt],Lt=Ft+Number(Lt.replace(/\s/g,""))}e.zimLastObj[pt]=x?e.zimTweenOriginals[pt]:Lt,x?(n(Ht[pt])||(ae.step.prev.props[pt]=Lt),pt=="scaleX"&&!n(ut)&&(ae.step.prev.props.scaleX=ut),pt=="scaleY"&&!n(ut)&&(ae.step.prev.props.scaleY=ut)):(n(Ht[pt])||(ae.step.props[pt]=Lt),pt=="scaleX"&&!n(ut)&&(ae.step.props.scaleX=ut),pt=="scaleY"&&!n(ut)&&(ae.step.props.scaleY=ut))}}}}}var Sn;D.loopWaitCall&&(Sn=D.loopWaitCall,delete D.loopWaitCall);var Gn=e;D.loopWaitParams&&(Gn=D.loopWaitParams,delete D.loopWaitParams);function dr(){Sn&&typeof Sn=="function"&&Sn(Gn||e)}var er;D.startCall&&(er=D.startCall,delete D.startCall);var hr;D.startParams&&(hr=D.startParams,delete D.startParams);function pr(Ee){Ee.startCalled||(Ee.startCalled=!0,er&&typeof er=="function"&&er(hr||e))}function Kn(Ee){e.latestTween=Ee,e.waiting?Ee.startTime=Date.now():Ee.startTime=gr,Ee.zimLoop=k,e.animating||e.pauseAnimate(!0),Object.defineProperty(Ee,"percentComplete",{get:function(){return this.position/this.duration*100},set:function(at){this.setPosition(at*this.duration/100)}})}var sr=Date.now();e.tweenStartTime||(e.tweenStartTime=sr),e.tweenEndTime||(e.tweenEndTime=sr);var gr=sr+(f||0)+(le||0),vr=gr+(Tn||0);vr>e.tweenEndTime&&(e.tweenEndTime=vr);var yr=["ballisticIn","ballisticOut","ballisticInOut","snapIn","snapOut","snapInOut","slowmoIn","slowmoOut","slowmoInOut"];yr.indexOf(l)!=-1&&(l=xr(l));function xr(Ee){var at=[.4,.75,.9,.95],ut=[.99,-.69,.53,.014],pt=[1.18,.69,1,.96];return Ee=="ballisticIn"?Ee=nt(t.zimEase(at)):Ee=="ballisticOut"?Ee=nt(t.zimEase(at).reverse()):Ee=="ballisticInOut"?Ee=nt(t.zimEase(at,null,!0)):Ee=="snapIn"?Ee=nt(t.zimEase(ut)):Ee=="snapOut"?Ee=nt(t.zimEase(ut).reverse()):Ee=="snapInOut"?Ee=nt(t.zimEase(ut,null,!0)):Ee=="slowmoIn"?Ee=nt(t.zimEase(pt)):Ee=="slowmoOut"?Ee=nt(t.zimEase(pt).reverse()):Ee=="slowmoInOut"&&(Ee=nt(t.zimEase(pt,null,!0))),Ee}var vn,mn,tr;if(D.rewind&&(l&&(l instanceof Function?vn=nt(l.reverse()):(vn=l,vn.indexOf("InOut")==-1&&(vn.indexOf("Out")!=-1?vn=vn.replace("Out","In"):vn.indexOf("In")!=-1&&(vn=vn.replace("In","Out"))))),m&&(vn=m,yr.indexOf(vn)!=-1&&(vn=xr(vn)))),l instanceof Function)mn=l;else{var _n="get"+l.charAt(0).toUpperCase()+l.slice(1),Bn=nt(G),Dn=nt(ce);(!n(Bn)||!n(Dn))&&Fe.Ease[_n]?(!n(Dn)&&n(Bn)&&(Bn=1),!n(Bn)&&n(Dn)&&(Dn=.3*1.5),mn=Fe.Ease[_n](Bn,Dn)):mn=Fe.Ease[l]}vn&&(vn instanceof Function?tr=vn:(_n="get"+vn.charAt(0).toUpperCase()+vn.slice(1),Bn=nt(G),Dn=nt(ce),(!n(Bn)||!n(Dn))&&Fe.Ease[_n]?(!n(Dn)&&n(Bn)&&(Bn=1),!n(Bn)&&n(Dn)&&(Dn=.3*1.5),tr=Fe.Ease[_n](Bn,Dn)):tr=Fe.Ease[vn]));function si(){Vn>0&&(e.waiting=!1),wr&&typeof wr=="function"&&wr(Or)}function oi(){Vn>0&&(e.waiting=!0),Cr&&typeof Cr=="function"&&Cr(Sr)}function Nr(Ee){yt(),f>0?(e.waiting=!0,ae=e.zimTweens[p]=e.zimTween=Fe.Tween.get(e,{override:D.override}).wait(f,!0).call(function(){e.waiting=!1,f=0,Mr(ae),u&&typeof u=="function"&&u(n(y)?e:y)}),ae.timeScale=e.futureRate,Ee&&Tr(Ee,ae),Kn(ae)):Mr(Ee)}function Mr(Ee){var at=Vr();e.set&&!I&&e.set(N),ae=e.zimTweens[p]=e.zimTween=Fe.Tween.get(e,D).call(pr).to(te,ve,mn).call(oi).wait(Vn,!0).call(si).to(at,Pe,tr).call(Gr).wait(zt,!0).call($n),ae.timeScale=e.futureRate,Ee&&Tr(Ee,ae),Lr(),Kn(ae)}function Fr(Ee){yt(),f>0?(e.waiting=!0,ae=e.zimTweens[p]=e.zimTween=Fe.Tween.get(e,{override:D.override}).wait(f,!0).call(function(){f=0,e.waiting=!1,Ir(ae),u&&typeof u=="function"&&u(n(y)?e:y)}),ae.timeScale=e.futureRate,Ee&&Tr(Ee,ae),Kn(ae)):Ir(Ee)}function Ir(Ee){e.set&&!I&&e.set(N),ae=e.zimTweens[p]=e.zimTween=Fe.Tween.get(e,D).call(pr).to(te,ve,mn).call(Gr).wait(zt,!0).call($n),ae.timeScale=e.futureRate,Ee&&Tr(Ee,ae),Lr(),Kn(ae)}if(D.rewind){var Vn=0;delete D.rewind,x=!0,P=D.rewindWait,D.rewindWait&&(Vn=D.rewindWait,delete D.rewindWait);var wr;if(D.rewindCall){wr=D.rewindCall;var Or=D.rewindParams;n(Or)&&(Or=e),delete D.rewindCall,delete D.rewindParams}var Cr;if(D.rewindWaitCall){Cr=D.rewindWaitCall;var Sr=D.rewindWaitParams;n(Sr)&&(Sr=e),delete D.rewindWaitCall,delete D.rewindWaitParams}le>0||Ae>0||f>0?le>0||Ae>0?(e.waiting=!0,ae=e.zimTweens[p]=e.zimTween=Fe.Tween.get(e,{override:D.override}).wait(le>0?le:0,!0).wait(Ae>0?Ae:0,!0).call(function(Ee){Ee.waiting=!1,Ae=le=0,Nr(ae)}),ae.timeScale=e.futureRate,Kn(ae)):Nr():(yt(),Mr())}else le>0||Ae>0||f>0?le>0||Ae>0?(e.waiting=!0,ae=e.zimTweens[p]=e.zimTween=Fe.Tween.get(e,{override:D.override}).wait(le>0?le:0,!0).wait(Ae>0?Ae:0,!0).call(function(){Ae=le=0,e.waiting=!1,Fr(ae)}),ae.timeScale=e.futureRate,Kn(ae)):Fr():(yt(),Ir());function Tr(Ee,at){at.zimIdSet=Ee.zimIdSet,at.zimObj=Ee.zimObj,at.zimTicker=Ee.zimTicker,at.zimExtraTickers=Ee.zimExtraTickers,at.requestID=Ee.requestID}ae.startPaused=se,ae.rewinding=!1,n(J)||(ae.timeScale=t.Pick.choose(J)),D.animateCall&&(_=D.animateCall,delete D.animateCall),D.animateParams&&(R=D.animateParams,delete D.animateParams);var or;!c&&V&&(dt&&(e.pathRatio=e.percentComplete&&Math.round(e.percentComplete)!=100?e.percentComplete/100:0,e.percentCompleteNoAngle=Math.round(dt)!=100?dt:0),L&&!n(we)&&we.dispatchEvent?or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr(),we.dispatchEvent("animation")},et):L&&e.dispatchEvent?or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr(),e.dispatchEvent("animation")},et):_&&typeof _=="function"?or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr(),_(R||e)},et):or=t.Ticker.add(function(){ot&&e.updateEffects(),(ft||sn||Pn||kn)&&nr()},et));function fi(Ee){if(Array.isArray(Ee)){for(var at=0,ut=0,pt=Ee.length;ut<pt;ut++)at+=Ee[ut];return at}}var br=[1,1,1],nr=function(){if(!(!e.parent||ae.passive||ae.startPaused)){if(F&&x&&(Vt<50&&e.percentComplete>50||Vt>50&&e.percentComplete<50)&&(Ut=e.percentComplete<50),Vt=e.percentComplete,ft){if(fn&&(Kt=ft.segmentPoints,Ct=ft.segmentRatios),F)var Ee=ft.getCurvePoint(e.pathRatio,Ct,Kt);else{e.currentPercent=e.startPercent+e.percent*e.pathRatio;var at=(1e6+e.currentPercent)%100/100;e.pathRatio==1&&(at+=e.percent>0?1:0),Ee=ft.getCurvePoint(at,Ct,Kt)}if(Ee){var ut=e.parent.globalToLocal(Ee.x,Ee.y);e.x=ut.x,e.y=ut.y}}var pt=Math.abs(In-e.x),Lt=Math.abs(qt-e.y),Ft=En==90||En==270||En==-90;Pn&&rn&&(In>e.x&&pt>.01&&t.sign(Ft?e.scaleY:e.scaleX)==t.sign(lr)||In<e.x&&pt>.01&&t.sign(Ft?e.scaleY:e.scaleX)!=t.sign(lr)||e.percentComplete<99&&e.percentComplete>1&&pt<.01&&Lt>.01&&t.sign(Ft?e.scaleY:e.scaleX)!=t.sign(lr))&&(Ft?e.scaleY*=-1:e.scaleX*=-1),kn&&rn&&(qt>e.y&&Lt>.01&&t.sign(Ft?e.scaleX:e.scaleY)==t.sign(ar)||qt<e.y&&Lt>.01&&t.sign(Ft?e.scaleX:e.scaleY)!=t.sign(ar)||e.percentComplete<99&&e.percentComplete>1&&Lt<.01&&pt>.01&&t.sign(Ft?e.scaleX:e.scaleY)!=t.sign(ar))&&(Ft?e.scaleX*=-1:e.scaleY*=-1);var pn;if(sn&&pt>.05||sn&&Lt>.05){if(ft==sn)pn=t.angle(In,qt,e.x,e.y)+En;else{var An;sn.parent?An=sn.parent.localToLocal(sn.x,sn.y,e.parent):An=e.parent.globalToLocal(sn.x,sn.y),pn=t.angle(e.x,e.y,An.x,An.y)+En}if(pn!=0&&(!e.paused||zn)){Pn&&In-e.x>.01&&(pn+=180);var Xn=pn;e.rotation=Math.round(Xn==En?e.rotation:Xn),x&&e.percentComplete>50&&!Pn&&(e.rotation+=180)}}if(F){var rr=e.x-In+e.y-qt;Math.abs(rr)>2&&(br.push(t.sign(rr)),br.shift(),ae.forward=fi(br))}In=e.x,qt=e.y}};(ft||sn||Pn||kn)&&(e.handlePath=nr),n(e.zimMaskDynamic)||e.zimMaskApply();function Gr(){if(e.seriesTweens&&e.seriesTweens.shift(),e.seriesCalls&&e.seriesCalls.shift(),e.seriesParams&&e.seriesParams.shift(),e.paused&&e.type!="Sprite"){a&&typeof a=="function"&&a(s);return}if(D.loop)if(ln>0)if(Be<ln){zt>0&&(e.waiting=!0),dr(),Be++;return}else x?e.set&&e.set(Vr()):e.set&&e.set(te);else{zt>0&&(e.waiting=!0),dr();return}if(Q?Br(p):e.pauseAnimate(!0,p),!D.loop&&Z&&typeof Z=="function"){var Ee=n(K)?e:K;Z(Ee)}a&&typeof a=="function"&&a(s)}function Vr(){var Ee={};for(var at in te)if(c&&e.style)!n(N[at])&&!I?Ee[at]=N[at]:at=="transform"?Ee[at]=e.style[at]:Ee[at]=Hn(e.style[at]);else if(!n(N[at])&&!I)Ee[at]=N[at];else if(at.substr(0,1)=="."){for(var ut=at.split("."),pt=e,Lt=1;Lt<ut.length;Lt++)pt=pt[ut[Lt]];Ee[at]=pt}else Ee[at]=e[at];return Ee}function ui(Ee){if(e.zimBusy){for(var at in Ee)delete e.zimBusy[at];t.isEmpty(e.zimBusy)&&(e.zimBusy=null)}}var ci=!1;Lr();function Lr(){ae.zimObj=te,ae.zimTicker=or,ae.zimPaused=ci,Ne&&(ae.zimIdSet=Ne),Ke&&(n(t.idSets)&&(t.idSets={}),n(t.idSets[Ke])?t.idSets[Ke]=[e]:t.idSets[Ke].indexOf(e)<0&&t.idSets[Ke].push(e)),t.animatedObjects||(t.animatedObjects=new t.Dictionary(!0)),t.animatedObjects.add(e,!0)}function Br(Ee){if(e.tweenStates&&e.tweenStates[Ee]&&delete e.tweenStates[Ee],!(n(e.zimTweens)||n(e.zimTweens[Ee]))){e.zimX=null,e.zimY=null,ui(e.zimTweens[Ee].zimObj),e.zimTweens[Ee].paused=!0,Wr(Ee);var at=e.zimTweens[Ee].zimIdSet;if(!n(at)&&e.zimIdSets){var ut=e.zimIdSets[at];ut&&ut.splice(ut.indexOf(Ee),1),ut&&ut.length==0&&(delete e.zimIdSets[at],t.isEmpty(e.zimIdSets)&&delete e.zimIdSets)}if(e.type=="Pen"&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),delete e.zimTweens[Ee],e.zimLastObj=null,t.isEmpty(e.zimTweens)&&e.stopAnimate(null,null,null,!1,!0),!(e.zimTweens&&e.zimTweens[Ee]||e.zimIdSets&&e.zimIdSets[at||Ee])){if(t.idSets&&t.idSets[at||Ee]){t.idSets[at||Ee];var pt=t.idSets[at||Ee].indexOf(e);pt>=0&&t.idSets[at||Ee].splice(pt,1),t.idSets[at||Ee].length<=0&&(delete t.idSets[at||Ee],t.isEmpty(t.idSets)&&delete t.idSets)}}}}function Wr(Ee){-function(){var at=e.zimTweens[Ee].zimTicker;if(e.zimTweens[Ee].extraTickers)for(var ut=0;ut<e.zimTweens[Ee].extraTickers.length;ut++)t.Ticker.remove(e.zimTweens[Ee].extraTickers[ut]);e.zimTweens[Ee].requestID&&cancelAnimationFrame(e.zimTweens[Ee].requestID),at&&setTimeout(function(){at&&t.Ticker.remove(at),at=null},200)}()}function mr(Ee,at){var ut=e.zimTweens[Ee];ut.paused=at,at!=ut.zimPaused&&(ut.zimPaused=at,at?ut.zimTicker&&(ut.zimAnimateTimeout=setTimeout(function(){t.Ticker.remove(ut.zimTicker)},200)):(ut.startPaused=!1,clearTimeout(ut.zimAnimateTimeout),ut.zimTicker&&(ut.zimTicker=t.Ticker.add(ut.zimTicker,et))))}function Ur(Ee){for(var at=[],ut=0;ut<Ee.length;ut++)e.zimIdSets&&!n(e.zimIdSets[Ee[ut]])?at=at.concat(e.zimIdSets[Ee[ut]]):at.push(Ee[ut]);return at}(!e.stopAnimate||!e.stopAnimate.real)&&(e.stopAnimate=function(Ee,at,ut,pt,Lt){var Ft;if(e.dynamicAnimation=null,Lt&&F){e.pauseAnimate();return}if(n(Ee)&&(e.tweenStates={}),at)return e.endTween(null,Ee),e;if(n(pt)&&(pt=!0),e.pan==null&&(e.type!=null&&(e.paused=!0),e.animating=!1),e.type=="Pen"&&e.zimOnPath&&(e.stop(),e.zimOnPath=!1),n(ut)&&(ut=!0),pt&&F&&(ft&&ft.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),e.amu&&et.frame.off("mouseupplus",e.amu),t.Ticker.remove(e.zimDragAnimateTicker)),n(Ee)){if(!ut)return e;e.zimBusy=null,Fe.Tween.removeTweens(e);for(Ft in e.zimTweens)Wr(Ft);e.zimTweens=null,e.zimIdSets=null,e.zimTween=null,t.idSets&&t.idSets[Ne||Ft]&&(delete t.idSets[Ne||Ft],t.isEmpty(t.idSets)&&delete t.idSets),t.animatedObjects.remove(e)}else{Array.isArray(Ee)||(Ee=[Ee]);var pn=Ur(Ee);for(Ft in e.zimTweens)e.zimTweens[Ft].requestID&&cancelAnimationFrame(e.zimTweens[Ft].requestID),ut&&pn.indexOf(Ft)>=0&&Br(Ft,pt),!ut&&pn.indexOf(Ft)<0&&Br(Ft,pt)}return e},e.stopAnimate.real=!0,e.pauseAnimate=function(Ee,at,ut,pt){var Lt;if(at=="pauseOnBlur"?at=null:n(at)&&(e.tweenStates={all:Ee===!1}),e.type=="Pen"&&(Ee===!1?e.zimOnPath&&(e.infinite=!0):e.stop()),Zr&&!pt){if(n(at))for(Lt in e.zimTweens)mr(Lt,Ee);else e.pause(Ee,at);return e}if(n(Ee)&&(Ee=!0),jt=!1,e.type!=null&&(e.paused=Ee),e.animating=!Ee,n(ut)&&(ut=!0),n(at)&&!ut)return e;if(n(at))for(Lt in e.zimTweens)mr(Lt,Ee);else{Array.isArray(at)||(at=[at]);var Ft=Ur(at);for(Lt in e.zimTweens)ut&&Ft.indexOf(Lt)>=0&&(mr(Lt,Ee),e.tweenStates[Lt]=!Ee),!ut&&Ft.indexOf(Lt)<0&&(mr(Lt,Ee),e.tweenStates[Lt]=!Ee)}return e.type=="Sprite"&&(e.running||e.stop()),e}),se&&e.pauseAnimate(!0,p,null,!0);var bn;for(te.extra&&(bn=te.extra,delete te.extra,Array.isArray(bn)||(bn=[bn])),de=0;de<Ye.length;de++){var Ar=Ye[de];te[Ar]&&(n(bn)&&(bn=[]),di(Ar,te[Ar]),delete te[Ar])}function di(Ee,at){at===!0?bn.push({outputProp:$e[Ee]}):Array.isArray(at)?bn.push({outputProp:$e[Ee],outputMin:at[0],outputMax:at[1],inputMin:at[2],inputMax:at[3]}):bn.push({outputProp:$e[Ee],outputMax:at})}if(bn){e.zimStartScaleX=e.scaleX,e.zimStartScaleY=e.scaleY,ae.extraTickers=[];var Qr;for(de=0;de<bn.length;de++){var un=bn[de];n(un.inputObj)&&(un.inputObj=e),n(un.inputProp)&&(un.inputProp="y"),n(un.inputMin)&&(un.inputMin=0),n(un.inputMax)&&(un.inputMax=un.inputProp=="x"?et.width:et.height),n(un.outputObj)&&(un.outputObj=e),n(un.outputProp)&&(un.outputProp="scale"),n(un.outputMin)&&(un.outputMin=0),n(un.outputMax)&&(un.outputMax=un.outputMin+1),n(un.constrain)&&(un.constrain=!0);for(var Yn in un)te[Yn]=t.Pick.choose(te[Yn]);un.outputProp=="percentSpeed"&&(B=!0),Qr=new t.Proportion(un.inputMin,un.inputMax,un.outputMin,un.outputMax,un.factor,un.outputRound);var qr=function(){var Ee=un,at=Qr;return function(){var ut,pt=Ee.outputObj,Lt=Ee.inputObj[Ee.inputProp];if((Ee.inputProp=="x"||Ee.inputProp=="y")&&Ee.inputObj.parent){var Ft=Ee.inputObj.parent.localToGlobal(Lt,Lt);Lt=Ft[Ee.inputProp]}if(Ee.constrain?ut=t.constrain(at.convert(Lt),Ee.outputMin,Ee.outputMax):ut=at.convert(Lt),Number.isNaN(ut)&&(ut=Ee.outputMin!=null?Ee.outputMin:0),Ee.outputProp=="scale")pt.scaleX=t.sign(pt.scaleX)*ut,pt.scaleY=t.sign(pt.scaleY)*ut;else if(Ee.outputProp=="scaleX")pt.scaleX=t.sign(pt.scaleX)*ut;else if(Ee.outputProp=="scaleY")pt.scaleY=t.sign(pt.scaleY)*ut;else if(Ee.outputProp=="layer"){if(!pt.parent)return;var pn=t.constrain(Math.round(ut),0,pt.parent.numChildren-1);pn!=pt.parent.getChildIndex(pt)&&pt.parent.setChildIndex(pt,pn)}else Ee.outputProp=="percentSpeed"?pt[Ee.outputProp]=ut*100:pt[Ee.outputProp]=ut}}();qr(),ae.extraTickers.push(t.Ticker.add(qr,et))}}var Zr;function Kr(){if(ae.requestID=requestAnimationFrame(Kr),!(!B||ae.startPaused&&e.percentSpeed==0)){ae.startPaused=!1,ae!=Hr&&(Hr=ae,ae.currentTime=0,e.pauseAnimate(!0,p,null,!0),e.type!=null&&(e.paused=!1),e.animating=!0,Dr=!Ae&&!le&&!f&&!ln&&D.loop),Dr&&(ae.currentTime+=1e4*Rr,ae.setPosition(ae.currentTime,!0),Dr=!1);var Ee=ae.currentTime+hi*e.percentSpeed/100;_r&&f==0&&(Ee=t.constrain(Ee,0,_r)),ae.currentTime=Ee,ae.setPosition(ae.currentTime),(ft||sn||Pn||kn)&&nr(),et.update()}}if(B&&(e.dynamicAnimation=!0),B||e.zimAnimateDragDown){if(B){Zr=!0,e.pauseAnimate(!0,p,null,!0),e.type!=null&&(e.paused=!1),e.animating=!0,ae.currentTime=0;var Hr=ae;n(e.percentSpeed)&&(e.percentSpeed=ae.startPaused?0:100);var hi=1e3/60;ae.currentTime=0;var Dr=!Ae&&!le&&!f&&!ln&&D.loop;fe&&D.loop&&!ln&&(fe=!1);var Rr=i+(x?Y||i:0)+(P||0)+(O||0);Rr*=pe=="s"?1e3:1;var Jr=1;D.loop&&ln&&(Jr=ln);var _r;fe&&(_r=Rr*Jr),Kr()}var kr;e.pause=function(Ee,at){if(n(Ee)&&(Ee=!0),n(at)&&(at=0),Ee){if(e.zimAnimateDragDown&&(F=!1,e.cur("default"),ft&&ft.off("change",e.zimAnimatePathChange),e.off("mousedown",e.zimAnimateDragDown),e.off("pressmove",e.zimAnimateDragPress),e.off("pressup",e.zimAnimateDragUp),!B))return;kr=e.percentSpeed,at>0?t.animate({target:e,props:{percentSpeed:0},override:!1,ticker:!1,time:at,call:function(){e.percentSpeed=0,e.type!=null&&(e.paused=!0),e.animating=!1,B=!1,e.dispatchEvent("pause")}}):(ae.startPaused=!1,e.percentSpeed=0,e.type!=null&&(e.paused=!0),e.animating=!1,B=!1,setTimeout(function(){e.dispatchEvent("pause")},10))}else{if(e.zimAnimateDragDown&&(F=!0,e.cur("pointer"),ft&&(e.zimAnimatePathChange=ft.on("change",e.zimAnimatePathChange)),e.zimAnimateDragDown=e.on("mousedown",e.zimAnimateDragDown),e.zimAnimateDragPress=e.on("pressmove",e.zimAnimateDragPress),e.zimAnimateDragUp=e.on("pressup",e.zimAnimateDragUp),!B&&se!=!1))return;jt=!1,ae.currentTime=ae.position,at>0?t.animate({target:e,props:{percentSpeed:kr},override:!1,ticker:!1,time:at,call:function(){e.percentSpeed=kr,e.paused=!1,e.animating=!0,B=!0}}):(e.percentSpeed=kr,e.type!=null&&(e.paused=!1),e.animating=!0,B=!0)}return e}}return e},t.stopAnimate=function(e,r){De("45.12");var i;if(n(e)){if(t.animatedObjects)for(i=t.animatedObjects.length-1;i>=0;i--)t.animatedObjects.objects[i].stopAnimate(null,r);return}if(Array.isArray(e)||(e=[e]),!!t.idSets)for(var l=0;l<e.length;l++){var a=e[l];if(t.idSets[a]){var s=t.idSets[a].length-1;for(i=s;i>=0;i--)t.idSets[a][i].stopAnimate(a,r)}}},t.stopZimAnimate=function(e){De("45.1"),t.stopAnimate(e)},t.pauseAnimate=function(e,r){De("45.22"),n(e)&&(e=!0);var i;if(n(r)||r=="pauseOnBlur"){if(t.animatedObjects)for(i=t.animatedObjects.length-1;i>=0;i--)t.animatedObjects.objects[i].pauseAnimate(e,r);return}if(Array.isArray(r)||(r=[r]),!!t.idSets)for(var l=0;l<r.length;l++){var a=r[l];if(t.idSets[a])for(i=t.idSets[a].length-1;i>=0;i--)t.idSets[a][i].pauseAnimate(e,a)}},t.pauseZimAnimate=function(e,r){De("45.2"),t.pauseAnimate(e,r)},t.wiggle=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C){var d="target, property, baseAmount, minAmount, maxAmount, minTime, maxTime, totalTime, type, ease, integer, id, startType, ticker, wait, pauseOnBlur",x;if(x=st(t.wiggle,arguments,d))return x;if(De("45.25"),n(e)||n(i)||n(l))return e;n(a)&&(a=l);var P=Tt(s,null,40);n(s)&&(s=P=="s"?1:1e3),n(f)&&(f=s),Pt(f,P,40),n(k)&&(k="quadInOut"),n(g)&&(g=!1),n(O)&&(O=t.makeID()),n(y)&&(y="both"),n(T)&&(T="both"),n(E)&&(E=!0),n(A)&&(A=0),Pt(u,P,40),n(u)||(e.wiggleTimeout=setTimeout(function(){e.stopAnimate(O),e.dispatchEvent("wigglestop")},u*(P=="s"?1e3:1)));var v=0,w;function b(){var X=t.rand(t.Pick.choose(s),t.Pick.choose(f),!1),Y={},m={},j;m[r]=t.Pick.choose(i),y=="negative"||v==0&&T=="negative"?j=-t.rand(t.Pick.choose(l),t.Pick.choose(a),g):y=="positive"||v==0&&T=="positive"?j=t.rand(t.Pick.choose(l),t.Pick.choose(a),g):v==0?j=t.rand(t.Pick.choose(l),t.Pick.choose(a),g,!0):j=t.rand(t.Pick.choose(l),t.Pick.choose(a),g)*t.sign(w)*-1,Y[r]=t.Pick.choose(i)+j,v==0&&(X=X/2),w=j,v++;var S=e.futureRate;y=="negative"||y=="positive"?t.animate({target:e,obj:Y,set:m,ease:k,time:X*2,wait:nt(A),rewind:!0,override:!1,call:b,id:O,ticker:!!e.stage,timeCheck:!1,pauseOnBlur:C}):t.animate({target:e,obj:Y,ease:k,time:X,wait:nt(A),override:!1,call:b,id:O,ticker:!!e.stage,timeCheck:!1,pauseOnBlur:C}),S&&(e.futureRate=S)}return e.addTo&&!e.stage?e.added(b):b(),e},t.loop=function(e,r,i,l,a,s,f,u,y,k){var g="obj, call, reverse, interval, step, start, end, immediate, complete, completeParams",O;if(O=st(t.loop,arguments,g))return O;if(t.zimLoopCheck||De("45.3"),t.zimLoopCheck=!0,n(e)||n(r))return;n(i)&&(i=!1),n(l)&&(l=0),(n(a)||a<=0)&&(a=1),n(u)&&(u=!0),e.constructor===Number&&(e=Number(e)),e.constructor===String&&(e=String(e));var T=l===0&&y&&typeof y=="function",E=typeof e=="number"?"number":e.constructor===Array?"array":e.constructor==={}.constructor?"object":e instanceof NodeList?"nodelist":typeof e=="string"?"string":e instanceof HTMLCollection?"htmlcollection":e.type&&e.type=="Dictionary"?"Dictionary":"invalid";if(E=="container"&&!e.addChild)return;var A,C,d,x;if(E=="number"||E=="string"||E=="array"||E=="nodelist"||E=="htmlcollection"||E=="Dictionary"){if(E=="Dictionary"){var P=t.copy(e.values);e=t.copy(e.objects)}if(A=E=="number"?e:e.length,d=w(A-1),d==0)return;if(i)if(l===0){for(C=s;C>=f;C-=a)if(E=="number"?x=r(C,d,s,f,e):E=="array"||E=="string"?x=r(e[C],C,d,s,f,e):E=="Dictionary"?x=r(e[C],P[C],C,d,s,f,e):x=r(e.item(C),C,d,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(C=b.count,u||C--,a&&(C*=a),C=s-C,E=="number"?x=r(C,d,s,f,e):E=="array"||E=="string"?x=r(e[C],C,d,s,f,e):E=="Dictionary"?x=r(e[C],P[C],C,d,s,f,e):x=r(e.item(C),C,d,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},d,u,null,null,y,k);else if(l===0){for(C=s;C<=f;C+=a)if(E=="number"?x=r(C,d,s,f,e):E=="array"||E=="string"?x=r(e[C],C,d,s,f,e):E=="Dictionary"?x=r(e[C],P[C],C,d,s,f,e):x=r(e.item(C),C,d,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(C=b.count,u||C--,a&&(C*=a),E=="number"?x=r(C,d,s,f,e,b):E=="array"||E=="string"?x=r(e[C],C,d,s,f,e,b):E=="Dictionary"?x=r(e[C],P[C],C,d,s,f,e):x=r(e.item(C),C,d,s,f,e,b),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},d,u,null,null,y,k);return T&&y(k),!0}else if(E=="object"){A=0;var v=[];for(C in e)A++,v.push(C);if(d=w(A-1),d==0)return;if(i)if(l===0){for(C=s;C>=f;C-=a)if(x=r(v[C],e[v[C]],C,d,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(C=b.count,u||C--,a&&(C*=a),C=s-C,x=r(v[C],e[v[C]],C,d,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},d,u,null,null,y,k);else if(l===0){for(C=s;C<=f;C+=a)if(x=r(v[C],e[v[C]],C,d,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(C=b.count,u||C--,a&&(C*=a),x=r(v[C],e[v[C]],C,d,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},d,u,null,null,y,k);return T&&y(k),!0}else{if(d=w(e.numChildren-1),d==0)return;if(i)if(l===0){for(C=s;C>=f;C-=a)if(x=r(e.getChildAt(C),C,d,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(C=b.count,u||C--,a&&(C*=a),C=s-C,x=r(e.getChildAt(C),C,d,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},d,u,null,null,y,k);else if(l===0){for(C=s;C<=f;C+=a)if(x=r(e.getChildAt(C),C,d,s,f,e),typeof x<"u"&&x!="next")return x}else t.interval(l,function(b){if(C=b.count,u||C--,a&&(C*=a),x=r(e.getChildAt(C),C,d,s,f,e),x=="next")b.next();else if(typeof x<"u")return b.clear(),x},d,u,null,null,y,k);return T&&y(k),!0}function w(b){return n(s)&&(s=i?b:0),n(f)&&(f=i?0:b),i&&f>s||!i&&s>f||(s<0&&f)<0||s>b&&f>b?0:(s=Math.max(0,Math.min(s,b)),f=Math.max(0,Math.min(f,b)),Math.floor((i?s-f:f-s)/a)+1)}},t.scaleTo=function(e,r,i,l,a,s,f){var u="obj, boundObj, percentX, percentY, type, boundsOnly, simple",y;if(y=st(t.scaleTo,arguments,u))return y;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("scaleTo",arguments),e;if(De("43"),n(r)&&(r=ee.zdf&&ee.zdf.stage?ee.zdf.stage:null),n(e)||!e.getBounds||!e.getBounds())return Wn("zim methods - scaleTo(): please provide an object (with setBounds) to scale"),e;if(n(r)||!r.getBounds||!r.getBounds())return Wn("zim methods - scaleTo(): please provide a boundObject (with setBounds) to scale to"),e;n(i)&&(i=-1),n(l)&&(l=-1),i==-1&&l==-1&&(i=l=100,n(a)&&(a="fill")),n(a)&&(a="fit"),a=="smallest"?a="fit":a=="biggest"||a=="outside"||a=="largest"?a="fill":(a=="both"||a=="stretch")&&(a="full"),n(s)&&(s=!1),n(f)&&(f=!1);var k=r.getBounds().width*i/100*(s?1:r.scaleX),g=r.getBounds().height*l/100*(s?1:r.scaleY);(r.type=="Stage"||r.type=="StageGL")&&(k=r.width*i/100,g=r.height*l/100);var O,T;if(f)O=e.getBounds().height,T=e.getBounds().width;else{var E=t.boundsToGlobal(e);O=E.height/e.scaleX,T=E.width/e.scaleY,(isNaN(O)||isNaN(T)||O>5e3)&&(O=e.getBounds().height,T=e.getBounds().width)}if((i==-1||l==-1)&&a!="full")return i==-1?t.sca(e,g/O):t.sca(e,k/T),e;var A;return a=="full"?(e.scaleX=i!=-1?k/T:e.scaleX,e.scaleY=l!=-1?g/O:e.scaleY,e):(a=="fill"?A=Math.max(k/T,g/O):A=Math.min(k/T,g/O),t.sca(e,A),e)},t.fit=function(e,r,i,l,a,s){var f="obj, left, top, width, height, type",u;if(u=st(t.fit,arguments,f))return u;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("fit",arguments),e;if(De("46"),!(n(e)||!e.getBounds)){if(!e.getBounds()){tt("zim methods - fit(): please setBounds() on object");return}if(n(r)){if(!e.stage){tt("zim methods - fit(): please add boundary dimensions or add obj to stage first");return}if(!e.stage.getBounds()){tt("zim methods - fit(): please add boundary dimensions or add obj with bounds to stage first");return}var y=e.stage.getBounds().width,k=e.stage.getBounds().height;r=0,i=0,l=y,a=k}s===!0?s="fit":s===!1&&(s="fill"),n(s)&&(s="fit"),e.scaleX=e.scaleY=1;var g=l,O=a,T=e.getBounds().width,E=e.getBounds().height,A,C,d,x,P;return s=="full"?(e.scaleX=d=g/T,e.scaleY=x=O/E,A=g,C=O):(s=="fit"?g/O>=T/E?P=O/E:P=g/T:s=="fill"&&(g/O>=T/E?P=g/T:P=O/E),d=x=P),e.scaleX=d,e.scaleY=x,A=T*d,C=E*x,e.x=(e.regX-e.getBounds().x)*d+r+(g-A)/2,e.y=(e.regY-e.getBounds().y)*x+i+(O-C)/2,{x:e.x,y:e.y,width:A,height:C,scale:P,scaleX:d,scaleY:x,bX:r,bY:i,bWidth:l,bHeight:a}}},t.boundsCheck=!1,t.boundsToGlobal=function(e,r,i,l,a){if(t.boundsCheck||(De("40"),t.boundsCheck=!0),!(n(e)||!e.getBounds)){if(n(i)&&(i=!1),a&&!e.getBounds&&!e.getBounds())return e;var s=e.getBounds();if(!s&&n(r)){tt(`zim methods - boundsToGlobal():
 please setBounds() on object (or a rectangle)`);return}r&&(s=r);var f,u,y,k;a&&a.type&&!(a.type=="Stage"||a.type=="StageGL")?(f=e.localToLocal(s.x,s.y,a),u=e.localToLocal(s.x+s.width,s.y,a),y=e.localToLocal(s.x+s.width,s.y+s.height,a),k=e.localToLocal(s.x,s.y+s.height,a)):i?(f=e.globalToLocal(s.x,s.y),u=e.globalToLocal(s.x+s.width,s.y),y=e.globalToLocal(s.x+s.width,s.y+s.height),k=e.globalToLocal(s.x,s.y+s.height)):(f=e.localToGlobal(s.x,s.y),u=e.localToGlobal(s.x+s.width,s.y),y=e.localToGlobal(s.x+s.width,s.y+s.height),k=e.localToGlobal(s.x,s.y+s.height));var g=Math.min(f.x,u.x,y.x,k.x),O=Math.min(f.y,u.y,y.y,k.y),T=Math.max(f.x,u.x,y.x,k.x),E=Math.max(f.y,u.y,y.y,k.y);return new Fe.Rectangle(g,O,T-g,E-O)}},t.resetBounds=function(e,r,i,l,a,s){var f="obj, a, b, c, d, margin",u;if(u=st(t.resetBounds,arguments,f))return u;De("40.5");var y,k,g,O;return n(l)?(y=0,k=r,g=0,O=i):(y=r,k=l,g=i,O=a),n(O)&&(O=k),n(r)?e.setBounds(null):e.setBounds(y,g,k,O),s&&(i=e.getBounds(),i&&e.setBounds(i.x-s,i.y-s,i.width+s*2,i.height+s*2)),e},t.copyMatrix=function(e,r){return De("45.5"),e.x=r.x,e.y=r.y,e.scaleX=r.scaleX,e.scaleY=r.scaleY,e.regX=r.regX,e.regY=r.regY,e.rotation=r.rotation,e.skewX=r.skewX,e.skewY=r.skewY,e},t.duplicate=function(e,r){De("45.6");var i=e.clone(r);for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)&&i[l]==null){if(l=="parent"||l=="zimTouch")continue;i[l]=e[l]}return i},t.expand=function(e,r,i,l,a){var s="obj, padding, paddingV, paddingRight, paddingBottom",f;if(f=st(t.expand,arguments,s))return f;if(De("50"),n(e)||!e.getBounds||!e.getBounds())return tt("zim methods - expand(): please provide object with bounds set"),e;n(r)&&(r=20),n(i)&&(i=r);var u,y;!n(l)||!n(a)?(n(l)&&(l=r),n(a)&&(a=i),u=r,y=i):(u=l=r,y=a=i);var k=e.getBounds(),g=new t.Shape({style:!1});return g.graphics.f("rgba(0,0,0,.01)").r(k.x-u,k.y-y,k.width+u+l,k.height+y+a),e.hitArea=g,e},t.setSwipe=function(e,r){if(De("34"),n(e)||!e.on)return;e.zimNoSwipe=r?null:!0,e instanceof Fe.Container&&i(e);function i(l){for(var a=l.numChildren,s,f=0;f<a;f++)s=l.getChildAt(f),s.zimNoSwipe=e.zimNoSwipe,s instanceof Fe.Container&&i(s)}return e},t.setMask=function(e,r,i){if(De("50.1"),n(e)&&tt("zim methods - setMask(): please provide obj"),n(r))return a(),e;var l=e.stage||(ee.zdf?ee.zdf.stage:null);function a(){e.zimMask&&e.zimMask.parent&&e.zimMask.parent.removeChild(e.zimMask),e.zimMask=null,e.zimMaskTicker&&t.Ticker.remove(e.zimMaskTicker),e.mask=null}e.zimMaskOriginal&&e.zimMaskOriginal!=r&&a(),n(i)&&(i=r.type=="Blob"||!n(r.zimDown)||!n(r.transformControls)||!n(r.zimTouch)||!n(r.zimTweens),r.zimMaskDynamic=i),e.zimMaskOriginal=r;var s;function f(){if(i&&(!l||!r.stage))return e;if(s&&s.dispose&&s.dispose(),s=null,e.zimMask=r.zimMask=s=r.shape.clone(),t.copyMatrix(s,r),r.addChildAt(s,0),s.alpha=0,!e.parent){e.mask=s;return}var u=r.getConcatenatedMatrix().decompose(),y=e.parent.getConcatenatedMatrix().decompose();s.scaleX=u.scaleX/y.scaleX,s.scaleY=u.scaleY/y.scaleY,s.rotation=(u.rotation?u.rotation:0)-(y.rotation?y.rotation:0);var k=r.localToLocal(r.shape.x+r.regX,r.shape.y+r.regY,e.parent);s.x=k.x,s.y=k.y,e.mask=s}return r.zimMaskApply=function(){e.zimMaskTicker&&t.Ticker.remove(e.zimMaskTicker),e.zimMaskTicker=t.Ticker.add(f)},r&&r.shape?(f(),i&&r.zimMaskApply()):(s=r,e.mask=s),e},t.outline=function(e,r,i,l){var a="obj, color, size, boundsOnly",s;if(s=st(t.outline,arguments,a))return s;if(e.type=="AC"&&ee.zdf)return ee.zdf.ac("outline",arguments),e;if(De("47"),e.type&&e.type=="zimOultineShape")return vt&&tt("zim.outline() - warning, you are trying to outline an outline - do not outline in a loop"),e;if(n(e)||!e.getBounds)return tt("zim methods - outline(): please provide object with bounds set"),e;if(!e.getBounds())return tt("zim methods - outline(): please setBounds() on object"),e;if(!e.parent)return tt("zim methods - outline(): object should be on stage first"),e;if(n(r)&&(r="brown"),n(i)&&(i=2),i<=0){e.ZIMoutlineShape&&e.ZIMoutlineShape.parent.removeChild(e.ZIMoutlineShape),e.ZIMoutlineShapeC&&e.ZIMoutlineShapeC.parent.removeChild(e.ZIMoutlineShapeC),e.ZIMoutlineShape=e.ZIMoutlineShapeC=null;return}var f=e.getBounds(),u=e.ZIMoutlineShape=e.ZIMoutlineShape?e.ZIMoutlineShape:new t.Shape;u.type="zimOutlineShape";var y=e.ZIMoutlineShapeC=e.ZIMoutlineShapeC?e.ZIMoutlineShapeC:new t.Shape;y.type="zimOutlineShape";var k=e.parent;e.outlineToggled=!0,e.outlineToggle=function(w){return w===!0?(e.ZIMoutlineShape.visible=!0,e.ZIMoutlineShapeC.visible=!0):w===!1?(e.ZIMoutlineShape.visible=!1,e.ZIMoutlineShapeC.visible=!1):(e.ZIMoutlineShape.visible=!e.ZIMoutlineShape.visible,e.ZIMoutlineShapeC.visible=!e.ZIMoutlineShapeC.visible),e.outlineToggled=e.ZIMoutlineShape.visible,e};var g=e.localToLocal(f.x,f.y,k),O=e.localToLocal(f.x+f.width,f.y,k),T=e.localToLocal(f.x+f.width,f.y+f.height,k),E=e.localToLocal(f.x,f.y+f.height,k),A=e.localToLocal(0,0,k),C=u.graphics.c(),d=y.graphics.c();if(C.s(r).ss(i).mt(g.x,g.y).lt(O.x,O.y).lt(T.x,T.y).lt(E.x,E.y).lt(g.x,g.y).cp(),!l){var x=10,P=x+1;d.s("white").ss(i+2),d.mt(-P,0).lt(P,0),d.mt(0,-P).lt(0,P),d.s(r).ss(i),d.mt(-x,0).lt(x,0),d.mt(0,-x).lt(0,x),d.cp(),y.x=A.x,y.y=A.y,y.rotation=e.rotation,C.s("white").ss(i+2).dc(e.x,e.y,x+6),C.s(r).ss(i).dc(e.x,e.y,x+6)}e.parent.removeChild(u),e.parent.removeChild(y);var v=e.parent.getChildIndex(e);return e.parent.addChildAt(y,v+1),e.parent.addChildAt(u,v+1),u.mouseEnabled=!1,y.mouseEnabled=!1,e},t.blendmodes=function(e,r,i){De("47.05"),n(r)&&(r=1);var l=["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"];i===!1&&l.push("source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","copy","xor");var a=0,s=t.interval(r,function(){var f=l[a%l.length];a++,e.ble(f),Yr(f),e.stage&&e.stage.update()});return e.on("mousedown",function(){s.pause(!s.paused)}),e},t.STYLE=null,t.ignore="ignore",t.getStyle=function(e,r,i,l){t.STYLECHECK||(De("50.34"),t.STYLECHECK=!0);var a=["tap","change","hold","noTap","noChange","noHold","pos","addTo","center","centerReg","reg","mov","move","drag","transform","gesture","mouse","expand","outline","bounds","animate","wiggle","cache"],s=ee.STYLE||t.STYLE,f=s,u,y=!1;n(l)||(e=null,r=l,y=!0),s&&s.type&&typeof s.type=="string"&&(s.ttype=s.type,delete s.type);for(var k in s)u=s[k],k.match(/^[(A-Z)]/)?(s.type||(s.type={}),s.type[k]?s.type[k]=t.merge(s.type[k],u):s.type[k]=u,delete s[k]):u.constructor==={}.constructor&&k!="group"&&k!="type"&&!t.isPick(u)&&a.indexOf(k)==-1&&(s.group||(s.group={}),s.group[k]?s.group[k]=t.merge(s.group[k],u):s.group[k]=u,delete s[k]);n(f)?f={}:f=t.copy(f);var g;if(n(i))i={};else for(g=0;g<a.length;g++)delete i[a[g]];var O=i,T=f.type;if(T&&delete f.type,!n(r)&&!n(f.group)){var E=r.split(","),A={};for(g=0;g<E.length;g++){var C=E[g].trim();n(f.group[C])||(A=t.merge(A,f.group[C]))}delete f.group}y?!n(r)&&!n(A)&&(f=A):(!n(e)&&!n(T)&&!n(T[e])&&(f=t.merge(f,T[e])),!n(r)&&!n(A)&&(f=t.merge(f,A)));for(var d in f){if(O[d]){delete f[d];continue}if(u=a.indexOf(d)==-1&&!f.delayPick?t.Pick.choose(f[d]):f[d],u=="ignore"){delete f[d];continue}else u&&u.constructor==={}.constructor&&(u=t.copy(u,!0,!1));var x;for(var P in f)(x=P.match(/^(.+)gColor$/))&&(f[x[1]+"ackgroundColor"]=f[P],delete f[P]);f[d]=u}return f=t.merge(f,O),f.ttype&&!f.type&&(f.type=f.ttype,delete f.ttype),f.style===!1?{}:f},t.styleTransforms=function(e,r){var i=["visible","x","y","scale","scaleX","scaleY","rotation","alpha","skewX","skewY","blendMode"],l;if(r){for(r.add&&e.addTo(),r.addTo&&e.addTo(r.addTo===!0?null:r.addTo),l=0;l<i.length;l++)r[i[l]]!=null&&(e[i[l]]=t.Pick.choose(r[i[l]]));if((r.regX!=null||r.regY!=null)&&e.reg(n(r.regX)?DEFAULT:r.regX,n(r.regY)?DEFAULT:r.regY),r.bounds&&r.bounds.constructor==={}.constructor&&e.setBounds(r.bounds.x?r.bounds.x:0,r.bounds.y?r.bounds.y:0,r.bounds.width?r.bounds.width:100,r.bounds.height?r.bounds.height:100),r.center&&e.center(r.center===!0?null:r.center),r.centerReg&&e.centerReg(r.centerReg===!0?null:r.centerReg),r.reg!=null&&(r.reg.constructor==={}.constructor?e.reg(t.Pick.choose(r.reg.x),t.Pick.choose(r.reg.y),r.reg.still):e.reg(r.reg)),r.x!=null&&(r.loc?r.loc.x==null&&(r.loc.x=r.x):r.loc={x:r.x}),r.y!=null&&(r.loc?r.loc.y==null&&(r.loc.y=r.y):r.loc={y:r.y}),r.loc&&(r.loc.constructor==={}.constructor?e.loc(t.Pick.choose(r.loc.x),t.Pick.choose(r.loc.y)):e.loc(t.Pick.choose(r.loc))),r.pos)if(r.pos.constructor==={}.constructor)e.pos(t.Pick.choose(r.pos.x),t.Pick.choose(r.pos.y),t.Pick.choose(r.pos.horizontal),t.Pick.choose(r.pos.vertical),t.Pick.choose(r.pos.container),t.Pick.choose(r.pos.index),r.pos.add,t.Pick.choose(r.pos.reg),t.Pick.choose(r.pos.regX),t.Pick.choose(r.pos.regY));else{var a=t.Pick.choose(r.pos);(a=="left"||a=="top")&&e.pos(),a=="right"&&e.pos({horizontal:"right"}),a=="bottom"&&e.pos({vertical:"bottom"}),(a=="rightbottom"||a=="bottomright")&&e.pos({horizontal:"right",vertical:"bottom"}),a=="center"&&e.center()}if((r.mov||r.move)&&(r.move&&(r.mov=r.move),r.mov.constructor==={}.constructor?e.mov(t.Pick.choose(r.mov.x),t.Pick.choose(r.mov.y)):e.mov(t.Pick.choose(r.mov))),r.outline&&setTimeout(function(){e.outline(r.outline.constructor==={}.constructor?r.outline:null),e.stage&&e.stage.update()},20),r.drag&&e.drag(r.drag.constructor==={}.constructor?r.drag:{currentTarget:!0}),r.gesture&&e.gesture(r.gesture.constructor==={}.constructor?r.gesture:null),r.mouse===!1&&e.noMouse(),r.transform&&setTimeout(function(){e.transform(r.transform.constructor==={}.constructor?r.transform:null)},20),r.animate)for(Array.isArray(r.animate)||(r.animate=[r.animate]),l=0;l<r.animate.length;l++)-function(){var f=r.animate[l];f.constructor==={}.constructor&&setTimeout(function(){e.animate(f)},20)}();if(r.wiggle)for(Array.isArray(r.wiggle)||(r.wiggle=[r.wiggle]),l=0;l<r.wiggle.length;l++)-function(){var f=r.wiggle[l];f.constructor==={}.constructor&&setTimeout(function(){e.wiggle(f)},20)}();r.expand&&e.expand(r.expand===!0?null:r.expand),r.cache&&(r.cache.constructor==={}.constructor?r.cache.x?e.cache(t.Pick.choose(r.cache.x),t.Pick.choose(r.cache.y),t.Pick.choose(r.cache.x),t.Pick.choose(r.cache.y)):e.cache(t.Pick.choose(r.cache.width),t.Pick.choose(r.cache.height)):e.cache()),r.tap&&e.tap&&e.tap(r.tap),r.change&&e.change&&e.change(r.change),r.hold&&e.hold&&e.hold(r.hold),r.noChange&&e.noChange&&e.noChange(),r.noTap&&e.noTap&&e.noTap(),r.noHold&&e.noHold&&e.noHold();var s=ee.STYLE||t.STYLE;s&&(s.once===!0||s.once==e.type)&&(ee.STYLE?ee.STYLE={}:t.STYLE={})}},t.Style={remembered:{},clear:function(){return ee.STYLE&&(ee.STYLE={}),t.STYLE&&(t.STYLE={}),t.Style},clearTypes:function(){var e=ee.STYLE||t.STYLE;return delete e.types,t.Style},clearGroups:function(){var e=ee.STYLE||t.STYLE;return delete e.groups,t.Style},remember:function(e){n(e)&&(e="default");var r=ee.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=ee.STYLE={}),t.Style.remembered[e]=t.copy(r,!0),t.Style},clearRemembered:function(e){return n(e)?t.Style.remembered={}:delete t.Style.remembered[e],t.Style},recall:function(e){return n(e)&&(e="default"),ee.STYLE?ee.STYLE=t.Style.remembered[e]:t.STYLE=t.Style.remembered[e],t.Style},add:function(e){var r=ee.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=ee.STYLE={}),ee.STYLE?ee.STYLE=t.merge(r,e):t.STYLE=t.merge(r,e),t.Style},addType:function(e,r){var i=ee.STYLE||t.STYLE;return i||(Et?i=t.STYLE={}:i=ee.STYLE={}),i.type||(i.type={}),i.type[e]=r,t.Style},addGroup:function(e,r){var i=ee.STYLE||t.STYLE;return i||(Et?i=t.STYLE={}:i=ee.STYLE={}),i.group||(i.group={}),i.group[e]=r,t.Style},remove:function(e){var r=ee.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=ee.STYLE={}),delete r[e],t.Style},removeType:function(e){var r=ee.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=ee.STYLE={}),r.type&&delete r.type[e],t.Style},removeGroup:function(e){var r=ee.STYLE||t.STYLE;return r||(Et?r=t.STYLE={}:r=ee.STYLE={}),r.group&&delete r.group[e],t.Style}},t.PATH=null,t.TIME="seconds",t.TIMECHECK=!1,t.DIR="ltr",t.SEEDRAND=null,t.SEEDRANDCOUNT=0,t.ANIMATE=!0,t.OPTIMIZE=!1,t.ACTIONEVENT="mousedown",t.DEFAULTWIRE="currentValue",t.KEYFOCUS=null,t.POSREG=!1,t.DRAGALL=!1,t.MOBILE="default",t.Ticker={stages:null,myUpdate:null,alwaysList:new t.Dictionary,list:new t.Dictionary,wire:new t.Dictionary,setFPS:function(e,r){n(e)&&n(r)?(e=60,r=60):n(e)?e=60:n(r)&&(r=e),t.Ticker.framerate=Fe.Ticker.framerate=t.mobile()?e:r},setTimingMode:function(e){Fe.Ticker.timingMode=Fe.Ticker.RAF,e=="synched"&&(Fe.Ticker.timingMode=Fe.Ticker.RAF_SYNCHED),e=="timeout"&&(Fe.Ticker.timingMode=Fe.Ticker.TIMEOUT)},add:function(e,r){De("30");var i=t.Ticker;if(i.has(e,r))return e;if((n(r)||!r.update)&&(r=ee.zdf.stage),n(e)||typeof e!="function"){tt("zim.Ticker.add() - only add functions");return}return i.list.at(r)?i.list.at(r).push(e):i.list.add(r,[e]),i.ticker||(i.ticker=Fe.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),e},addWire:function(e,r){if(De("30"),n(r[0]))return e;var i=t.Ticker;i.wire.add(e,r);var l=r[0][r[1]];return r[4]&&(l=r[4](l,"from")),r[3]&&(e[r[6]]=r[7]=l),i.ticker||(i.ticker=Fe.Ticker.on("tick",i.call)),i.framerate||i.setFPS(),e},rawID:{},raw:function(e){De("30");var r=t.makeID("letters",7);return-function i(l){e(l),t.Ticker.rawID[r]=requestAnimationFrame(i)}(),r},removeRaw:function(e){cancelAnimationFrame(t.Ticker.rawID[e]),delete t.Ticker.rawID[e]},call:function(e){var r=t.Ticker,i,l,a,s=[];for(a=0;a<r.list.length;a++){i=r.list.objects[a],l=r.list.values[a];for(var f=0;f<l.length;f++)l[f](e);var u=!1;(r.alwaysList.at(i)||l.length>0&&(n(r.update)&&!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)||r.update))&&(u=!0),u&&s.indexOf(i)<0&&s.push(i)}for(a=r.wire.length-1;a>=0;a--){var y=r.wire.objects[a],k=r.wire.values[a];if(k){var g=y[k[6]];g!=k[7]&&(k[4]&&(g=k[4](g,"to",k[7])),k[0][k[1]]=k[7]=g,k[5]&&k[5](g),i=k[0].stage,i&&s.indexOf(i)<0&&s.push(i)),k[2]&&k[0]&&(g=k[0][k[1]],k[7]!=g&&(k[4]&&(g=k[4](g,"from",k[7])),y[k[6]]=k[7]=g,k[5]&&k[5](g),i=y.stage,i&&s.indexOf(i)<0&&s.push(i)))}}if(r.list.length==0)for(a=0;a<r.alwaysList.length;a++)i=r.alwaysList.objects[a],s.indexOf(i)<0&&s.push(i);var O=s.length;for(a=0;a<O;a++)s[a].update()},always:function(e){De("30");var r=t.Ticker;r.framerate||r.setFPS(),(n(e)||!e.update)&&(e=ee.zdf.stage),r.alwaysList.add(e,!0),r.ticker||(r.ticker=Fe.Ticker.on("tick",r.call))},alwaysOff:function(e){var r=t.Ticker;(n(e)||!e.update)&&(e=ee.zdf.stage),r.alwaysList.remove(e)},remove:function(e){var r=t.Ticker;if(n(e)||typeof e!="function"){tt("zim.Ticker - only remove functions");return}for(var i=0;i<r.list.length;i++){var l=r.list.values[i].indexOf(e);l>-1&&r.list.values[i].splice(l,1)}r.alwaysList.length>0||r.list.length>0||r.wire.length>0||(Fe.Ticker.off("tick",r.ticker),r.ticker=null)},removeAll:function(e){for(var r=t.Ticker,i,l=0;l<r.list.length;l++)i=r.list.objects[l],(n(e)||e===i)&&(r.list.values[l]=[]);r.alwaysList.length>0||r.list.length>0||r.wire.length>0||(Fe.Ticker.off("tick",r.ticker),r.ticker=null)},removeWire:function(e,r,i,l){var a=t.Ticker;if(n(e)&&n(r)&&n(i)&&n(l))a.wire.clear();else for(var s=a.wire.length-1;s>=0;s--){var f=a.wire.objects[s],u=a.wire.values[s];u&&(e&&f!=e||r&&u[0]!=r||i&&u[1]!=i||l&&u[6]!=l||(a.wire.objects.splice(s,1),a.wire.values.splice(s,1)))}a.alwaysList.length>0||a.list.length>0||a.wire.length>0||(Fe.Ticker.off("tick",a.ticker),a.ticker=null)},isUpdating:function(e){n(e)&&(e=ee.zdf.stage);var r=!1,i=t.Ticker;return(i.alwaysList.at(e)||i.list&&i.list.values.at(e)&&i.list.values.at(e).length>0&&(n(i.update)&&!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)||i.update))&&(r=!0),r},has:function(e,r){return(n(r)||!r.update)&&(r=ee.zdf.stage),t.Ticker.list&&t.Ticker.list.at(r)&&t.Ticker.list.at(r).indexOf(e)>=0},getFPS:function(){return Fe.Ticker.getMeasuredFPS()},dispose:function(e){for(var r=t.Ticker,i=0,l,a=r.list.length-1;a>=0;a--)l=r.list.objects[a],n(e)||e===l?(r.list.remove(e),r.alwaysList.remove(e)):i+=r.list.values[a].length;if(!(r.alwaysList.length>0))return i==0&&(Fe.Ticker.off("tick",r.ticker),r.ticker=null),!0}},t.Ticker.setFPS(),Object.defineProperty(t.Ticker,"update",{get:function(){return t.Ticker.myUpdate},set:function(e){var r=t.Ticker;typeof e!="boolean"&&(e=null),r.myUpdate=e,r.myUpdate===!1&&(cancelAnimationFrame(r.ticker),r.alwaysList=new t.Dictionary)}}),t.Pages=function(e,r,i,l,a,s,f,u,y){var k="pages, transition, speed, transitionTable, holder, arrowDisableColor, style, group, inherit",g;if(g=st(t.Pages,arguments,k,this))return g;De("71"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Pages",this.group=u;var O=f===!1?{}:t.getStyle(this.type,this.group,y),T=Tt(i);if(n(e)&&(e=O.pages!=null?O.pages:[]),this.pages=e,n(r)&&(r=O.transition!=null?O.transition:"none"),n(i)&&(i=O.speed!=null?O.speed:T=="s"?.2:200),n(l)&&(l=O.transitionTable!=null?O.transitionTable:[]),this.transitionTable=l,n(s)&&(s=O.arrowDisableColor!=null?O.arrowDisableColor:t.grey),this.arrowDisableColor=s,n(a)&&(a=O.holder!=null?O.holder:null),n(a)&&ee.zdf&&(a=ee.zdf.stage),!a.getBounds||!a.getBounds()){tt(`zim controls - Pages():
holder object must have bounds set`);return}this.speed=i,this.active=!0;var E=this;E.transitioning=!1;var A=a.getBounds().width,C=a.getBounds().height,d,x;(r!="none"||l!=[])&&P();function P(){d=new Fe.Shape,d.graphics.f("black").r(0,0,A,C+1),x=new Fe.Shape,x.graphics.f("white").r(0,0,A,C+1)}var v=["left","right","up","down"],w,b,X=!0,Y;for(Y=0;Y<e.length;Y++)w=e[Y],w.constructor!={}.constructor&&(w=e[Y]={page:e[Y]}),w.swipe&&(X=!1);for(Y=0;Y<e.length;Y++){if(w=e[Y],w.constructor!=={}.constructor&&(w=e[Y]={page:e[Y]}),X){var m=e[Y-1],j=e[Y+1];w.swipe=[m?m.page:null,j?j.page:null]}Z(w.page,w.swipe)}var S=this.page=e[0]?e[0].page:null;n(this.page)||(this.index=0),this.addChild(S),K(S),this.swipe=new t.Swipe(a);var _,R=!1,U=this.swipe.on("swipe",function(D){if(E.active){var c=D.currentTarget.direction;if(c!="none"){var h="";c=="left"?h="right":c=="right"?h="left":c=="up"?h="down":c=="down"&&(h="up"),c=h;var o=v.indexOf(c);b=S.zimSwipeArray[o],_=[b,c,null,null,!0],E.page=S,E.nextPage=b,E.direction=c,E.dispatchEvent("swipe"),setTimeout(function(){R||E.go(b,c,null,null,!0)},50)}}});function Z(D,c){n(D)||(D.zimHTMLList=new t.Dictionary,ne(D),D.zimSwipeArray=c||[],D.zimOriginalAlpha=D.alpha,D.parent&&D.parent.removeChild(w.page))}function K(D){if(!n(D))for(D.removedHTML=!1,Y=0;Y<D.zimHTMLList.length;Y++)D.addChildAt(D.zimHTMLList.values[Y].obj,D.zimHTMLList.values[Y].depth)}function ne(D){if(!D.removedHTML){D.removedHTML=!0,D.zimHTMLList.clear();var c,h;for(h=0;h<D.numChildren;h++)if(c=D.getChildAt(h),c.type=="TextArea"||c.type=="Loader"||c.type=="Tag"){var o={obj:c,depth:D.getChildIndex(c)};D.zimHTMLList.add(c,o)}for(h=D.numChildren-1;h>=0;h--)c=D.getChildAt(h),(c.type=="TextArea"||c.type=="Loader"||c.type=="Tag")&&D.removeChild(c)}}this.addPage=function(D,c){Z(D,c),E.pages.push({page:D}),S?D.parent&&D.parent.removeChild(D):(S=E.page=D,E.addChild(S))},this.removePage=function(D){ne(D),E.currentPage==D&&(E.removeChild(D),a.stage&&a.stage.update()),t.loop(E.pages,function(c,h){(c.page==D||c==D)&&E.pages.splice(h,1)},!0),D.zimSwipeArray=null},this.setSwipeArray=function(D,c){n(c)&&(c=[]);var h={page:D,swipe:c};h.page.zimSwipeArray=h.swipe?h.swipe:[]},this.pause=function(){R=!0},this.unpause=function(){R&&E.go(_[0],_[1],_[2],_[3],_[4])};var V=!0;this.go=function(D,c,h,o,I){if(typeof D=="number"){var N=E.pages[D];if(n(N))return;D=N.page}setTimeout(function(){R=!1},200);for(var p=[{x:A},{x:-A},{y:C},{y:-C}],L=[{x:0},{x:0},{y:0},{y:0}],we=[{x:A/2,alpha:0},{x:-A/2,alpha:0},{y:C/2,alpha:0},{y:-C/2,alpha:0}],B=r,F=E.speed,fe=0;fe<E.transitionTable.length;fe++)if(E.transitionTable[fe][0]==S&&E.transitionTable[fe][1]==D){B=E.transitionTable[fe][2],n(E.transitionTable[fe][3])||(F=E.transitionTable[fe][3]);break}n(h)&&(h=B),n(o)&&(o=F),E.speed=o;function se(Se){Se[0].uncache(),Se[1].uncache(),E.transitioning=!1,E.dispatchEvent("pagetransitioned"),E.removeChild(E.lastPage),h=="fan"&&(c=="right"||c=="down"?(E.lastPage.rotation=0,E.lastPage.regY=0,E.lastPage.mov(0,-E.lastPage.height)):(E.page.rotation=0,E.page.regY=0,E.page.mov(0,-E.lastPage.height))),E.removeChild(d),E.removeChild(x),K(S),V=!0}function Q(Se){E.removeChild(E.lastPage),t.animate(Se.shift(),{alpha:0},E.speed/2,null,se,Se)}if(E.direction=c,D==""||D==null)E.page=S,E.dispatchEvent("nothing");else if(typeof D=="string")E.page=S,E.dispatchEvent(D);else{if(D==S)return;n(c)&&(c="right");var te=v.indexOf(c);if(!V)return;V=!1,D.x=0,D.y=0,D.alpha=D.zimOriginalAlpha;var le,Ae=["pixelDark","pixelLight","pixelZIM","bubbleDark","bubbleLight","bubbleZIM","lineDark","lineLight","lineZIM"];if(Ae.indexOf(h)>=0){var J=h;le=!0,h="slide"}var Te=["explodeDark","explodeLight","explodeZIM"];if(Te.indexOf(h)>=0){var G=h;le=!0,h="fade"}if(h.type=="Emitter"&&(le=h,h.horizontal||h.vertical?h="slide":h="fade"),E.transitioning=!0,h=="slide"?(D.x=-(p[te].x|0),D.y=-(p[te].y|0),D.cache(0,0,(A+1)/D.scaleX,(C+1)/D.scaleY),S.cache(0,0,(A+1)/S.scaleX,(C+1)/S.scaleY),E.addChild(D),E.addChild(S),t.animate(S,p[te],E.speed,null,se,[S,D]),t.animate(D,L[te],E.speed)):h=="reveal"?(D.cache(0,0,(A+1)/D.scaleX,(C+1)/D.scaleY),S.cache(0,0,(A+1)/S.scaleX,(C+1)/S.scaleY),E.addChild(D),E.addChild(S),t.animate(S,we[te],E.speed,null,se,[S,D])):h=="fade"?(D.cache(0,0,(A+1)/D.scaleX,(C+1)/D.scaleY),S.cache(0,0,(A+1)/S.scaleX,(C+1)/S.scaleY),D.alpha=1,E.addChild(D),E.addChild(S),t.animate(S,{alpha:0},E.speed,null,se,[S,D])):h=="black"?(D.cache(0,0,(A+1)/D.scaleX,(C+1)/D.scaleY),S.cache(0,0,(A+1)/S.scaleX,(C+1)/S.scaleY),D.alpha=1,E.addChild(D),E.addChild(S),d.alpha=0,E.addChild(d),t.animate(d,{alpha:1},E.speed/2,null,Q,[d,S,D])):h=="clear"?(D.cache(0,0,(A+1)/D.scaleX,(C+1)/D.scaleY),S.cache(0,0,(A+1)/S.scaleX,(C+1)/S.scaleY),D.alpha=0,E.addChild(D),E.addChild(S),t.animate(S,{alpha:0},E.speed/2),t.animate(D,{alpha:1},E.speed/2,null,se,[S,D],E.speed/2)):h=="white"?(D.cache(0,0,(A+1)/D.scaleX,(C+1)/D.scaleY),S.cache(0,0,(A+1)/S.scaleX,(C+1)/S.scaleY),D.alpha=1,E.addChild(D),E.addChild(S),x.alpha=0,E.addChild(x),t.animate(x,{alpha:1},E.speed/2,null,Q,[x,S,D])):h=="fan"?(D.cache(0,0,(A+1)/D.scaleX,(C+1)/D.scaleY),S.cache(0,0,(A+1)/S.scaleX,(C+1)/S.scaleY),D.alpha=1,c=="right"||c=="down"?(E.addChild(D),E.addChild(S),S.regY=S.height,S.mov(0,S.height),t.animate(S,{rotation:-90},E.speed,null,se,[S,D])):(E.addChild(S),E.addChild(D),D.regY=S.height,D.mov(0,S.height),D.rotation=-90,t.animate(D,{rotation:0},E.speed,null,se,[S,D]))):(E.transitioning=!1,E.addChild(D),E.removeChild(S),V=!0),le){var ce=te<2,q,ue;if(J||h=="slide"){J?(J=="lineDark"||J=="lineLight"?q=new t.Rectangle(ce?30:A+5,ce?C+5:30,J=="lineDark"?t.dark:t.white).alp(.2):J=="lineZIM"?q=new t.Rectangle(ce?50:A+5,ce?C+5:50,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.5):J=="pixelDark"||J=="pixelLight"?q=new t.Rectangle(40,40,t.clear,J=="pixelDark"?t.dark:t.white,2).alp(.7):J=="pixelZIM"?q=new t.Rectangle(40,40,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7):J=="bubbleDark"||J=="bubbleLight"?q=new t.Circle(30,t.clear,J=="bubbleDark"?t.dark:t.white,2).alp(.7):J=="bubbleZIM"&&(q=new t.Circle(30,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7)),q.centerReg({add:!1}),J=="lineDark"||J=="lineLight"||J=="lineZIM"?ue=new t.Emitter({obj:q,life:.5,decayTime:.5,shrink:!1,force:0,gravity:0,width:0,startPaused:!0}):ue=new t.Emitter({obj:q,num:6,life:.5,decayTime:.5,width:ce?0:A,height:ce?C:0,vertical:ce,horizontal:!ce,startPaused:!0})):ue=le;var ge=[{x:0,y:C/2},{x:A,y:C/2},{x:A/2,y:0},{x:A/2,y:C}],ie=[{x:A,y:C/2},{x:0,y:C/2},{x:A/2,y:C},{x:A/2,y:0}];ue.centerReg(a).spurt(null,E.speed),ue.x=ge[te].x,ue.y=ge[te].y,t.animate(ue,ie[te],E.speed,null,function(){J&&ue.dispose()})}else(G||h=="fade")&&(G?(G=="explodeDark"||G=="explodeLight"?q=new t.Circle(150,G=="explodeDark"?t.dark:t.white).alp(.5):G=="explodeZIM"&&(q=new t.Circle(130,[t.green,t.yellow,t.orange,t.pink,t.blue]).alp(.7)),ue=new t.Emitter({obj:q,num:5,gravity:0,force:{min:20,max:40},life:.5,shrink:!1,decayTime:.5,startPaused:!0})):ue=le,ue.centerReg(a).spurt(null,E.speed*.35),ue.on("fizzed",function(){G&&ue.dispose()}));a&&a.type!="Stage"&&a.type!="StageGL"&&ue.particles&&a.shape&&ue.particles.setMask(a.shape)}for(a&&a.shape&&ue&&ue.particles&&ue.particles.setMask(a.shape),ne(S),E.lastPage=S,E.page=D,E.index=-1,fe=0;fe<E.pages.length;fe++){var xe=E.pages[fe].page;xe==E.page&&(E.index=fe)}h=="none"&&K(D),n(I)&&(I=!1),E.fromSwipe=I,E.dispatchEvent("page"),S=D,E.setArrows(e.index),a.stage&&a.stage.update()}},a&&a.shape&&(a.mouseChildren=!0,a.mouseEnabled=!0,E.setMask(a.shape)),this.resize=function(){A=a.getBounds().width,C=a.getBounds().height,(r!="none"||l!=[])&&P()},this.puff=function(D){for(var c=0;c<e.length;c++)E.addChild(e[c].page);E.addChild(S),D>0&&setTimeout(function(){E.settle()},D*(T=="s"?1e3:1))},this.settle=function(){E.removeAllChildren(),E.addChild(S),E.dispatchEvent("puffed")},this.disable=function(){E.active=!1},this.enable=function(){E.active=!0},this.arrows={},this.setArrows=function(){if(!t.isEmpty(E.arrows)){var D=E.pages[E.index];if(!(!D||!D.swipe)){var c=D.swipe,h=[t.LEFT,t.RIGHT,t.DOWN,t.UP];t.loop(h,function(o,I){c[I]?t.loop(E.arrows[o],function(N){if(N.setDisabled===!0){N.activate(!1,E.arrowDisableColor),N.setDisabled=null;return}N.enabled||N.activate(!0,N.arrowBackgroundColor)}):t.loop(E.arrows[o],function(N){if(N.setDisabled===!1){N.activate(!0,N.arrowBackgroundColor),N.setDisabled=null;return}N.enabled&&N.activate(!1,E.arrowDisableColor)})}),E.stage&&E.stage.update()}}},E.added(function(D){if(D.frame&&D.frame.scaling=="full"){if(!t.globalManager){var c=t.globalManager=new t.Manager;c.frame=D.frame,c.event=D.frame.on("resize",function(){c.resize()})}t.globalManager.add(E)}}),f!==!1&&t.styleTransforms(this,O),this.dispose=function(D,c,h){if(t.globalManager){var o=t.globalManager;o.remove(E),t.globalManager.items.length==0&&(o.frame.off("resize",o.event),o.dispose(),t.globalManager=null)}return E.swipe.off("swipe",U),E.swipe.dispose(),h||this.zimContainer_dispose(!0),!0}},t.extend(t.Pages,t.Container,["clone","dispose"],"zimContainer",!1),t.Arrow=function(e,r,i,l,a,s,f,u,y,k,g){var O="backgroundColor, rollBackgroundColor, pages, direction, type, newPage, trans, speed, style, group, inherit",T;if(T=st(t.Arrow,arguments,O,this))return T;De("71.2"),this.group=k;var E=y===!1?{}:t.getStyle("Arrow",this.group,g);n(l)&&(l=E.direction!=null?E.direction:"right"),n(e)&&(e=E.backgroundColor!=null?E.backgroundColor:t.blue),this.arrowBackgroundColor=e,n(r)&&(r=E.rollBackgroundColor!=null?E.rollBackgroundColor:t.blue.lighten(.2)),this.arrowRollBackgroundColor=r,n(a)&&(a=E.type!=null?E.type:"triangle"),n(s)&&(s=E.newPage!=null?E.newPage:null),n(f)&&(f=E.trans!=null?E.trans:null),n(u)&&(u=E.speed!=null?E.speed:null);var A,C,d,x,P;a=="triangle"?(A=new t.Triangle(45,45,45,e,null,null,null,null,-7).rot(90),C=new t.Triangle(45,45,45,r,null,null,null,null,-7).rot(90)):a=="thick"?(A=new t.Shape,d=A.graphics.f(e).command,P="AhFBdIiWAAIAAi4ICWAAIAAh7IEhDWIkhDXg",A.p(P).reg(-4),C=new t.Shape,x=C.graphics.f(r).command,C.p(P).reg(-4)):a=="thin"?(A=new t.Shape,d=A.graphics.f(e).command,P="AhBCIIBZhbIjWAAIAAhVIDaAAIhdhfIA9g+IDDDFIAAAAIAAAAIjDDGg",A.p(P).reg(-4),C=new t.Shape,x=C.graphics.f(r).command,C.p(P).reg(-4)):a=="angle"&&(A=new t.Shape,d=A.graphics.f(e).command,P="AiNC5IC4i5Ii4i5IAxgxIDqDqIjqDrg",A.p(P).reg(-3),C=new t.Shape,x=C.graphics.f(r).command,C.p(P).reg(-3)),this.zimButton_constructor(50,50,"",t.clear,t.clear,null,null,null,null,null,null,null,null,null,null,null,A,C),this.type="Arrow";var v=this;if(this.activate=function(Y,m){return n(Y)&&(Y=!0),n(m)&&(m=t.grey),m===!1||(Y?(v.enabled=!0,m!==!1&&(a=="triangle"?(v.icon.color=v.arrowBackgroundColor,v.rollIcon.color=v.arrowRollBackgroundColor):(d.style=v.arrowBackgroundColor,x.style=v.arrowRollBackgroundColor))):(v.enabled=!1,m!==!1&&(a=="triangle"?(v.icon.color=m,v.rollIcon.color=m):(d.style=m,x.style=m)))),v},n(i)||i.type!="Pages")return;var w=(Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click";n(i.arrows)&&(i.arrows={}),n(i.arrows[l])&&(i.arrows[l]=[]),i.arrows[l].push(this);var b=X();b||this.activate(!1,i.arrowDisableColor);function X(){var Y=i.pages[i.index];if(!(!Y||!Y.page||!Y.page.zimSwipeArray)){var m=Y.page.zimSwipeArray;if(l=="left")return m[0];if(l=="right")return m[1];if(l=="up")return m[2];if(l=="down")return m[3]}}this.expand(),this.on(w,function(){if(!i.transitioning){var Y=X();Y&&i.go(Y,l,f,u)}}),y!==!1&&t.styleTransforms(this,E),this.clone=function(){return v.cloneProps(new t.Arrow(e,r,i,l,a,s,f,u,y,this.group,g))}},t.extend(t.Arrow,t.Button,"clone","zimButton",!1),t.HotSpots=function(e,r,i){var l="spots, local, mouseDowns",a;if(a=st(t.HotSpots,arguments,l,this))return a;De("72"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpots",n(r)&&(r=!0),n(i)&&(i=!1);var s=(Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",f=this,u,y,k=f.hotSpots=[];n(e)&&(e=[]);for(var g=0;g<e.length;g++)O(e[g]);function O(E){var A=null;if(!Array.isArray(E.rect)){if(A=E.rect,!A){tt("zim controls - HotSpots(): HotSpot "+E.page+" "+E.rect+" button does not exist");return}E.rect=[A.x,A.y,A.width||1,A.height||1]}y=new t.HotSpot(E.page,E.rect[0],E.rect[1],E.rect[2],E.rect[3],E.call,E.callOver,E.callOut,r,E.talk),y.zimHSpage=E.page,y.button=A,k.push(y),y.on(s,T),A&&n(E.callOver)&&n(E.callOut)&&(y.spot.mouseEnabled=!1,y.spot.mouseChildren=!1,A.zimHScall=E.call,A.zimHSEvent=A.on(s,T,!0),i||(A.zimHSMDEvent=A.on("mousedown",function(C){C.stopImmediatePropagation()})),A.cur("pointer"))}function T(E){E.stopImmediatePropagation&&E.stopImmediatePropagation(),ee.event&&(ee.event.cancelBubble=!0),typeof E.currentTarget.zimHScall=="function"&&E.currentTarget.zimHScall(E)}this.add=this.addHotSpot=function(E,A,C,d,x,P){u={page:E,rect:A,call:C,callOver:d,callOut:x,talk:P},e.push(u),O(u)},this.show=function(){for(var E=0;E<k.length;E++)y=k[E],y.button||(y.spot.alpha=.2)},this.hide=function(){for(var E=0;E<k.length;E++)y=k[E],y.spot.alpha=0},this.remove=this.removeHotSpots=function(E,A){for(var C=e.length-1;C>=0;C--)u=e[C],y=k[C],A&&!Array.isArray(A)&&(A=[A.x,A.y,A.getBounds().width,A.getBounds().height]),(n(E)&&n(A)||n(A)&&E==u.page||n(E)&&t.arraysEqual(A,u.rect)||E==u.page&&t.arraysEqual(A,u.rect))&&(e.splice(C,1),y.button&&(y.button.off(s,y.button.zimHSEvent),y.button.zimHSEvent=null,i||(y.button.off("mousedown",y.button.zimHSMDEvent),y.button.zimHSMDEvent=null)),y.off(s,T),y.dispose(),k.splice(C,1))},this.dispose=function(){for(var E=0;E<k.length;E++)y=k[E],y.button&&(y.button.off(s,y.button.zimHSEvent),y.button.zimHSCall=null,y.button.zimHSEvent=null,i||(y.button.off("mousedown",y.button.zimHSMDEvent),y.button.zimHSMDEvent=null)),y.off(s,T),y.dispose();return!0}},t.extend(t.HotSpots,t.Container,"dispose","zimContainer",!1),t.HotSpot=function(e,r,i,l,a,s,f,u,y,k){var g="obj, x, y, width, height, call, callOver, callOut, local, talk",O;if(O=st(t.HotSpot,arguments,g,this))return O;if(De("73"),this.zimContainer_constructor(null,null,null,null,!1),this.type="HotSpot",n(e)||!e.addChild){tt(`zim controls - HotSpot():
Please pass in container object for obj`);return}if(!(e instanceof Fe.Container)){tt(`zim controls - HotSpot():
Objects passed in should be Containers`);return}if(n(r)||n(i)||n(l)||n(a)){tt(`zim controls - HotSpot():
Please pass in x, y, width, height`);return}n(y)&&(y=!0);var T=(Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",E=l,A=a,C,d,x;if(y)C=new t.Point(r,i),d=l,x=a;else{C=e.globalToLocal(r,i);var P=e.globalToLocal(r+E,i+A);d=P.x-C.x,x=P.y-C.y}var v=new t.Shape(l,a);if(v.talk=n(k)?"HotSpot":k,v.alpha=0,v.graphics.f("black").dr(0,0,d,x),v.x=C.x,v.y=C.y,v.cur("pointer"),v.expand(0),this.spot=v,typeof s=="function")var w=v.on(T,function(Y){s(Y)});if(typeof f=="function")var b=v.on("mouseover",function(Y){f(Y)});if(typeof u=="function")var X=v.on("mouseout",function(Y){u(Y)});e.addChild(v),this.show=function(){v.alpha=.5,e.stage&&e.stage.update()},this.hide=function(){v.alpha=0,e.stage&&e.stage.update()},this.dispose=function(){return w&&v.off(T,b),b&&v.off("mouseover",b),X&&v.off("mouseout",X),e.removeChild(v),v=null,!0}},t.extend(t.HotSpot,t.Container,"dispose","zimContainer",!1),t.Guide=function(e,r,i,l,a,s,f,u){var y="obj, vertical, pixels, hideKey, pixelKey, style, group, inherit",k;if(k=st(t.Guide,arguments,y,this))return k;De("76"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Guide",this.group=f;var g=s===!1?{}:t.getStyle(this.type,this.group,u);if(n(e)&&(ee.zdf?e=ee.zdf.stage:e="stage"),n(r)&&(r=g.vertical!=null?g.vertical:!0),e!="stage"&&(!e.addChild||!e.getBounds||!e.getBounds())){Wn("zim controls - Guide(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=g.pixels!=null?g.pixels:!(zdf&&zdf.scaling=="full")),n(l)&&(l=g.hideKey!=null?g.hideKey:"G"),n(a)&&(a=g.pixelKey!=null?g.pixelKey:"P");var O=this,T,E=80,A=26,C=E/6+E/2,d=A*2,x,P,v;r?(v=w("#00c5af","white","white"),v.shape.regX=E+E/6,v.shape.regY=A/2,v.label.x=-E/2-E/6):(v=w("#d61fa0","white","white"),v.shape.regX=E/2,v.shape.regY=A+A/4,v.label.y=-A*3/4);function w(V,D,c){var h=new t.Container({style:!1});return h.shape=new t.Shape,h.shape.graphics.s(D).ss(1).f(V).r(0,0,E,A),h.shape.alpha=.9,h.addChild(h.shape),h.label=new Fe.Text("10","16px arial",c),h.label.textAlign="center",h.label.textBaseline="middle",h.addChild(h.label),h.mouseChildren=!1,h.mouseEnabled=!1,h}var b;e!="stage"&&e.addChild(O);var X=t.added(O,R),Y=!1,m,j,S,_;function R(){if(e=="stage"?(b=O.stage,e=b):b=e.stage,b.frame&&b.frame.scaling=="full"){if(!t.globalManager){var V=t.globalManager=new t.Manager;V.frame=b.frame,V.event=b.frame.on("resize",function(){V.resize()})}t.globalManager.add(O)}e.addChild(O),m=e.getBounds().width,j=e.getBounds().height,r?(v.y=j/2,v.label.text="x:"+(O.pixels?Math.round(m*70/100):"70%")):(v.x=m/2,v.label.text="y:"+(O.pixels?Math.round(j*70/100):"70%")),S=new t.Shape,O.addChild(S),r?S.x=m*.7:S.y=j*.7,Y||(e.addChild(O),K()),b.off("stagemousemove",T),T=b.on("stagemousemove",Z),b.update()}var U={x:0,y:0};function Z(V){var D,c;V?(D=e.globalToLocal(V.rawX/t.scaX,V.rawY/t.scaY),U=D):D={x:U.x,y:U.y},i?r?(c=Math.round(Math.abs(D.x-S.x)),v.label.text="x:"+Math.max(0,Math.min(c,Math.round(m))),v.y=Math.max(d,Math.min(D.y,P))):(c=Math.round(Math.abs(D.y-S.y)),v.label.text="y:"+Math.max(0,Math.min(c,Math.round(j))),v.x=Math.max(C,Math.min(D.x,x))):r?(c=Math.round(Math.abs(D.x-S.x)/m*100),v.label.text="x:"+Math.max(0,Math.min(c,100))+"%",v.y=Math.max(d,Math.min(D.y,P))):(c=Math.round(Math.abs(D.y-S.y)/j*100),v.label.text="y:"+Math.max(0,Math.min(c,100))+"%",v.x=Math.max(C,Math.min(D.x,x))),b&&b.update()}function K(){Y=!0,m=e.getBounds().width,j=e.getBounds().height;var V;r?(V="ew-resize",_=new Fe.Rectangle(0,0,m,0)):(V="ns-resize",_=new Fe.Rectangle(0,0,0,j)),t.noDrag(S),setTimeout(function(){t.drag(S,_,null,V,V,null,null,!0)},500),b.mouseMoveOutside=!0,b.enableMouseOver(10),x=m-E*2/3,P=j-A-A,S.uncache();var D=S.graphics;r?(D.c().s("rgba(0,255,255,.1)").ss(20).mt(0,0).lt(0,j),D.f().s("white").ss(2).mt(0,0).lt(0,j),D.s("#00c5af").sd([20,20]).mt(0,0).lt(0,j).sd(),S.cache(-10,0,20,j)):(D.c().s("rgba(255,0,255,.1)").ss(20).mt(0,0).lt(m,0),D.f().s("white").ss(2).mt(0,0).lt(m,0),D.s("#d61fa0").sd([20,20]).mt(0,0).lt(m,0).sd(),S.cache(0,-10,m,20)),r?v.x=m:v.y=j,O.addChild(v)}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(V){i=V,O.resize()}}),ee.addEventListener("keydown",ne);function ne(V){V||(V=event),b&&(String.fromCharCode(V.keyCode)==l.toUpperCase()&&O.toggle(),String.fromCharCode(V.keyCode)==a.toUpperCase()&&(O.pixels=!O.pixels))}this.toggled=!0,this.toggle=function(V){return V===!0?O.visible=O.toggled=!0:V===!1?O.visible=O.toggled=!1:(O.visible=!O.visible,O.toggled=O.visible),b&&(b.off("stagemousemove",T),O.visible&&(T=b.on("stagemousemove",Z,O)),b.update()),O},this.resize=function(){return O?(b&&(K(),Z()),!0):!1},s!==!1&&t.styleTransforms(this,g),this.dispose=function(){if(!O)return!1;if(t.globalManager){var V=t.globalManager;V.remove(O),t.globalManager.items.length==0&&(V.frame.off("resize",V.event),V.dispose(),t.globalManager=null)}return t.noDrag(S),clearInterval(X),O.removeAllChildren(),ee.removeEventListener("keydown",ne),O.parent&&O.parent.removeChild(O),O=null,!0}},t.extend(t.Guide,t.Container,"clone","zimContainer",!1),t.Grid=function(e,r,i,l,a,s,f,u,y,k,g){var O="obj, color, pixels, hideKey, pixelKey, allowToggle, cache, numbers, style, group, inherit",T;if(T=st(t.Grid,arguments,O,this))return T;De("78"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Grid",this.group=k;var E=y===!1?{}:t.getStyle(this.type,this.group,g);if(n(e)&&(ee.zdf?e=ee.zdf.stage:e="stage"),n(r)&&(r=E.color!=null?E.color:t.black),e!="stage"&&(!e.addChild||!e.getBounds||!e.getBounds())){Wn("zim controls - Grid(): Please provide container with bounds for the obj (setBounds())");return}n(i)&&(i=E.pixels!=null?E.pixels:!(zdf&&zdf.scaling=="full")),n(l)&&(l=E.hideKey!=null?E.hideKey:"G"),n(a)&&(a=E.pixelKey!=null?E.pixelKey:"P"),n(s)&&(s=E.allowToggle!=null?E.allowToggle:!0),n(f)&&(f=E.cache!=null?E.cache:!0),n(u)&&(u=E.numbers!=null?E.numbers:!0);var A=this,C=10,d;this.mouseChildren=!1,this.mouseEnabled=!1;var x=80,P=26,v=A.numbersX=b("#dddddd",r,"#333333");v.shape.regX=x/2,v.shape.regY=-P/4,v.label.y=P*3/4;var w=A.numbersY=b("#dddddd",r,"#333333");w.shape.regX=-x/6,w.shape.regY=P/2,w.label.x=x/2+x/6,u||(v.visible=!1,w.visible=!1);function b(o,I,N){var p=new t.Container({style:!1});return p.shape=new Fe.Shape,p.shape.graphics.s(I).ss(1).f(o).r(0,0,x,P),p.shape.alpha=.9,p.addChild(p.shape),p.label=new Fe.Text("10","16px arial",N),p.label.textAlign="center",p.label.textBaseline="middle",p.addChild(p.label),p.mouseChildren=!1,p.mouseEnabled=!1,p}var X=x/6+x/2,Y=P*2,m,j;v.x=X,w.y=Y,v.label.text="x:0",w.label.text="y:0";var S;e!="stage"&&e.addChild(A);var _=t.added(A,U),R=!1;function U(){if(e=="stage"?(S=A.stage,e=S):S=e.stage,S.frame&&S.frame.scaling=="full"){if(!t.globalManager){var o=t.globalManager=new t.Manager;o.frame=S.frame,o.event=S.frame.on("resize",function(){o.resize()})}t.globalManager.add(A)}R||(c(),e.addChild(A)),S.off("stagemousemove",d),d=S.on("stagemousemove",K),S.update()}var Z={x:0,y:0};function K(o){var I;o?(I=e.globalToLocal(o.rawX/t.scaX,o.rawY/t.scaY),Z=I):I={x:Z.x,y:Z.y},i?(v.label.text="x:"+Math.max(0,Math.min(Math.round(I.x),Math.round(ne))),v.x=Math.max(X,Math.min(I.x,m)),w.label.text="y:"+Math.max(0,Math.min(Math.round(I.y),Math.round(V))),w.y=Math.max(Y,Math.min(I.y,j))):(v.label.text="x:"+Math.max(0,Math.min(Math.round(I.x/ne*100),100))+"%",v.x=Math.max(X,Math.min(I.x,m)),w.label.text="y:"+Math.max(0,Math.min(Math.round(I.y/V*100),100))+"%",w.y=Math.max(Y,Math.min(I.y,j))),S&&S.update()}var ne,V,D;function c(){R=!0,e&&e.getBounds&&(ne=e.getBounds().width,V=e.getBounds().height),S&&(S.mouseMoveOutside=!0,S.enableMouseOver(10)),m=ne-x*2/3,j=V-P-P,D=A.grid=new t.Container({style:!1}),A.addChild(D);var o=new Fe.Shape;D.addChild(o);var I=o.graphics;I.s(r).ss(1);var N=new Fe.Shape;D.addChild(N);var p;if(i){for(p=0;p<ne/C;p++)I.mt(p*C,0).lt(p*C,V);for(p=0;p<V/C;p++)I.mt(0,p*C).lt(ne,p*C);for(o.alpha=.3,I=N.graphics,I.s(r).ss(1),p=0;p<ne/(C*10);p++)I.mt(p*(C*10),0).lt(p*(C*10),V);for(p=0;p<V/(C*10);p++)I.mt(0,p*(C*10)).lt(ne,p*(C*10))}else{for(p=1;p<20+1;p++)I.mt(p*ne/20,0).lt(p*ne/20,V);for(p=1;p<20;p++)I.mt(0,p*V/20).lt(ne,p*V/20);for(o.alpha=.3,I=N.graphics,I.s(r).ss(1),p=1;p<10;p++)I.mt(p*ne/10,0).lt(p*ne/10,V);for(p=1;p<10;p++)I.mt(0,p*V/10).lt(ne,p*V/10)}var L=80;I.s("#FFFFFF").ss(8),I.mt(ne/2,V/2-L/2).lt(ne/2,V/2+L/2),I.mt(ne/2-L/2,V/2).lt(ne/2+L/2,V/2),I.s("#000000").ss(4),I.mt(ne/2,V/2-L/2).lt(ne/2,V/2+L/2),I.mt(ne/2-L/2,V/2).lt(ne/2+L/2,V/2),I.s(r).ss(f?3:2),I.dr(0,0,ne,V),N.alpha=.5,f&&D.cache(0,0,ne,V),A.addChild(v),A.addChild(w),S&&S.update()}Object.defineProperty(this,"pixels",{get:function(){return i},set:function(o){i=o,A.resize()}}),ee.addEventListener("keydown",h);function h(o){o||(o=event),!(!S||!s)&&(String.fromCharCode(o.keyCode)==l.toUpperCase()&&A.toggle(),String.fromCharCode(o.keyCode)==a.toUpperCase()&&(A.removeChild(D),D=null,A.pixels=!A.pixels))}this.toggled=!0,this.toggle=function(o){return o===!0?A.visible=A.toggled=!0:o===!1?A.visible=A.toggled=!1:(A.visible=!A.visible,A.toggled=A.visible),S.off("stagemousemove",d),A.visible&&(d=S.on("stagemousemove",K,A)),S&&S.update(),A},this.resize=function(){return A?(A.removeChild(D),D=null,S&&(c(),K(),setTimeout(function(){A&&A.removeChild(D),D=null,c()},200)),!0):!1},y!==!1&&t.styleTransforms(this,E),this.dispose=function(){if(t.globalManager){var o=t.globalManager;o.remove(A),t.globalManager.items.length==0&&(o.frame.off("resize",o.event),o.dispose(),t.globalManager=null)}return clearInterval(_),A.removeAllChildren(),ee.removeEventListener("keydown",h),A.parent&&A.parent.removeChild(A),A=null,!0}},t.extend(t.Grid,t.Container,"clone","zimContainer",!1),t.Wrapper=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m){var j="items, width, spacingH, spacingV, wrapperType, align, valign, alignInner, valignInner, flip, reverse, bottomFull, colSize, rowSize, height, minSpreadNum, minStretchNum, percentVoidH, offsetVoidH, percentVoidV, offsetVoidV,  minStretchFirst, style, group, inherit",S=null;if(S=st(t.Wrapper,arguments,j,this))return S;De("78.5"),this.group=Y;var _=X===!1?{}:t.getStyle("Wrapper",this.group,m);n(r)&&(r=_.width!=null?_.width:300),n(A)&&(A=_.height!=null?_.height:null),n(i)&&(i=_.spacingH!=null?_.spacingH:null),n(l)&&(l=_.spacingV!=null?_.spacingV:null),n(a)&&(a=_.wrapperType!=null?_.wrapperType:"spacing"),n(s)&&(s=_.align!=null?_.align:"left"),n(f)&&(f=_.valign!=null?_.valign:"top"),n(u)&&(u=_.alignInner!=null?_.alignInner:"left"),n(y)&&(y=_.valignInner!=null?_.valignInner:"bottom"),n(k)&&(k=_.flip!=null?_.flip:!1),n(g)&&(g=_.reverse!=null?_.reverse:!1),n(O)&&(O=_.bottomFull!=null?_.bottomFull:!1),n(T)&&(T=_.colSize!=null?_.colSize:100),n(E)&&(E=_.rowSize!=null?_.rowSize:null),n(i)&&(i=0),n(l)&&(l=0),n(C)&&(C=_.minSpreadNum!=null?_.minSpreadNum:2),n(d)&&(d=_.minStretchNum!=null?_.minStretchNum:3),n(x)&&(x=_.percentVoidH!=null?_.percentVoidH:0),n(P)&&(P=_.offsetVoidH!=null?_.offsetVoidH:0),n(v)&&(v=_.percentVoidV!=null?_.percentVoidV:0),n(w)&&(w=_.offsetVoidV!=null?_.offsetVoidV:0),n(b)&&(b=_.minStretchFirst!=null?_.minStretchFirst:!0);var R=200,U=0,Z=0,K=0,ne=r;this.items=[];var V,D;a=="spread"?V=!0:a=="stretch"&&(D=!0),this.zimContainer_constructor(r,R),this.type="Wrapper",s=="middle"&&(s="center"),f=="middle"&&(f="center"),u=="middle"&&(u="center"),y=="middle"&&(y="center");var c=this;this.add=function(o){return this.addAt(o,this.numChildren-1),c},this.addAt=function(o,I){return n(o)||((n(I)||I<0)&&(I=0),Array.isArray(o)||(o=[o]),t.loop(o,function(N,p){c.addChildAt(N,I+p)}),c.resize()),c},this.remove=function(o){return Array.isArray(o)||(o=[o]),t.loop(o,function(I){I&&I.removeFrom&&I.removeFrom()},!0),c.resize(),c},this.convert=function(o,I){var N=[];return o.loop(function(p){N.push(p),I&&p.cache()}),c.add(N),o.removeFrom(),c},this.resize=function(o,I){if(!c.preventResize){n(o)||(r=o),n(I)||(A=I),this.items2D=[],this.items=[],U=0,Z=0,K=0,n(x)&&(x=0),n(P)&&(P=0);var N=t.Pick.choose(x),p=t.Pick.choose(P);ne=r*(100-N)/100,this.setBounds(ne,R);var L=0,we=0,B=0;c.cols=0,c.rows=0;var F=[],fe=[0],se=null,Q=0,te=null,le=t.Pick.choose(T);a!="column"&&(le=null);var Ae=t.Pick.choose(E),J=0,Te,G;t.loop(this,function(z,pe){O||k?z.pos(L+(z.marginRight?z.marginRight:0),we+(z.marginTop?z.marginTop:0),t.RIGHT,k?t.TOP:t.BOTTOM):z.pos(L+(z.marginLeft?z.marginLeft:0),we+(z.marginTop?z.marginTop:0)),J++,te=z.boundsToGlobal();var de=c.globalToLocal(te.x,te.y),oe=c.globalToLocal(te.x+te.width,te.y+te.height);if(O||k?Te=c.globalToLocal(te.x,te.y):Te=c.globalToLocal(te.x+te.width,te.y+te.height),z.wrapHeight=oe.y-de.y,z.wrapWidth=oe.x-de.x,N){var Be=c.globalToLocal(te.x+z.wrapWidth/2,te.y+z.wrapHeight/2);z.centerX=Be.x,z.centerY=Be.y,Be=null}le?G=le*J:O||k?G=ne-Te.x+(z.marginLeft?z.marginLeft:0)+i:G=Te.x+(z.marginRight?z.marginRight:0)+i,Math.round(G)-i>ne&&(h(F,se,B,Q,le,N,p,!1),Q=0,c.cols==0&&(c.cols=pe),L=0,we+=B+(Ae?0:t.Pick.choose(l)),B=0,Ae=t.Pick.choose(E),N=t.Pick.choose(x),p=t.Pick.choose(P),J=0,c.items2D.push(t.copy(F)),c.rows++,fe.push(we),F=[],O||k?z.pos(L+(z.marginRight?z.marginRight:0),we+(z.marginTop?z.marginTop:0),t.RIGHT,k?t.TOP:t.BOTTOM):z.pos(L+(z.marginLeft?z.marginLeft:0),we+(z.marginTop?z.marginTop:0)),N&&(te=z.boundsToGlobal(),Be=c.globalToLocal(te.x+z.wrapWidth/2,te.y+z.wrapHeight/2),z.centerX=Be.x,z.centerY=Be.y,Be=null),J++,le?G=0:(G=(z.marginLeft?z.marginLeft:0)+z.wrapWidth+(z.marginRight?z.marginRight:0)+t.Pick.choose(i),O||k?Te.x=ne-((z.marginRight?z.marginRight:0)+z.wrapWidth):Te.x=(z.marginLeft?z.marginLeft:0)+z.wrapWidth)),F.push(z),Q+=z.wrapWidth,L=G,Ae?B=Ae:B=Math.max(B,z.wrapHeight+(z.marginTop?z.marginTop:0)+(z.marginBottom?z.marginBottom:0)),se=new t.Point(Te.x,we+B)},g&&O?!1:g||O),c.numChildren>0&&(c.cols==0&&(c.cols=c.numChildren),c.items2D.push(t.copy(F)),fe.push(we),h(F,se,B,Q,le,N,p,!0),c.rows+=1);var ce=t.Pick.choose(f),q;n(ce)&&(ce="top"),O&&(q=we+B-R,t.loop(this,function(z){z.mov(0,q)}),c.items2D.reverse(),t.loop(c.items2D,function(z){z.reverse()}));var ue=t.Pick.choose(v),ge=t.Pick.choose(w);if(!n(ue)){n(ge)&&(ge=0);var ie=we+B,xe=ie*ue/100,Se=ie/2+ge/100*ie;t.loop(fe,function(z,pe){if(z>=Se)return t.loop(c.items2D,function(de){t.loop(de,function(oe){oe.mov(0,xe)})},null,1,pe),"break"})}return n(A)||(f=="bottom"?(q=A-(we+B),t.loop(this,function(z){z.mov(0,q)})):(f=="center"||f=="middle")&&(q=(A-(we+B))/2,t.loop(this,function(z){z.mov(0,q)}))),c.setBounds(null),te=c.getBounds(),te&&c.setBounds(0,te.y,r,te.height),t.loop(c.items2D,function(z){t.loop(z,function(pe){c.items.push(pe)})}),this.stage&&this.stage.update(),c}};function h(o,I,N,p,L,we,B,F){var fe=t.Pick.choose(s),se=t.Pick.choose(V),Q=t.Pick.choose(D),te=t.Pick.choose(k),le=t.Pick.choose(u),Ae=t.Pick.choose(y);n(fe)&&(fe="left"),n(Ae)&&(Ae="top"),n(le)&&(le="left"),te&&o.reverse();var J=((100-we)/100/2+B/100)*r,Te=r*we/100,G=0,ce=!1,q,ue;if(L){(O||k)&&o.reverse();var ge=ne%L,ie=ne/2+B/100*ne,xe=0,Se=0,z=Math.floor(ne/L);c.rows!=0&&F&&(ce=!0),t.loop(o,function($,Me){G=0,le=="right"?Se=L*Me+xe+L-$.wrapWidth:le=="center"||le=="middle"?Se=L*Me+xe+(L-$.wrapWidth)/2:Se=L*Me+xe,q=$.x,$.pos(Se),ue=$.x-q,$.centerX+=ue,$.marginLeft&&(G+=$.marginLeft),$.marginRight&&(G-=$.marginRight);var be;fe=="center"||fe=="middle"?(be=Math.floor(ne/L)-o.length,G+=(ge+(be?be*L:0))/2):fe=="right"&&(be=Math.floor(ne/L)-o.length,G+=ge+(be?be*L:0)),$.mov(G),$.centerX+=G}),fe=="center"&&ce&&(o.length+z)%2!=0&&(G=(ie<=ne/2?-1:1)*L/2,t.loop(o,function($){$.mov(G),$.centerX+=G}))}else if(se||Q){var pe,de;se?pe=o.length?(ne-p)/(o.length+1):0:Q&&(pe=o.length-1>0?(ne-p)/(o.length-1):0),o.length<d&&F&&(b||c.rows>0)&&(pe=c.rows==0?i:K,ce=!0),K=pe;var oe=0;if((O||k)&&o.reverse(),t.loop(o,function($,Me){G=0,q=$.x,$.pos(pe*(Me+(se?1:0))+oe),ue=$.x-q,$.centerX+=ue,ce||($.marginLeft&&(G+=$.marginLeft),$.marginRight&&(G-=$.marginRight),$.mov(G),$.centerX+=G),oe+=$.wrapWidth}),ce){G=0;var Be=se?pe:0;ue=0,t.loop(o,function($){if(fe=="right")q=$.x,$.pos(Be,null,t.RIGHT),ue=$.x-q,Be+=$.wrapWidth+pe;else if(fe=="center"){var Me=(ne-(oe+(o.length-1)*pe))/2-(se?pe:0);q=$.x,$.pos(Be+Me,null,t.RIGHT),ue=$.x-q,Be+=$.wrapWidth+pe}$.marginLeft&&(G+=$.marginLeft),$.marginRight&&(G-=$.marginRight),$.mov(G),$.centerX+=ue+G},!0)}}else fe=="center"?t.loop(o,function($){G=((O||k?0:r)-I.x)/2,(se||Q)&&($.marginLeft&&(G+=$.marginLeft),$.marginRight&&(G-=$.marginRight)),$.mov(G),$.centerX+=G}):(O||k)&&fe=="left"?(de=o[o.length-1].marginLeft,t.loop(o,function($){G=-I.x+(de||0),se&&(G+=Z),$.mov(G),$.centerX+=G})):!(O||k)&&fe=="right"?(de=o[o.length-1].marginRight,t.loop(o,function($){G=r-I.x-(de||0),se&&(G-=Z),$.mov(G),$.centerX+=G})):se&&se&&t.loop(o,function($){G=Z*(fe=="right"?-1:1),$.mov(G),$.centerX+=G});we&&(J=(1/2+B/100)*ne,Te=r*we/100,t.loop(o,function($){L||Q||se?fe=="right"?$.centerX>ne-J&&$.mov(Te):fe=="center"?Math.round($.centerX)==Math.round(ne/2+B/100*ne)?$.mov(Te/2):Math.round($.centerX)>Math.round(ne/2+B/100*ne)&&$.mov(Te):$.centerX>J&&$.mov(Te):!(O||k)&&fe=="right"?$.centerX<r-J&&$.mov(-Te):!(O||k)&&fe=="center"?$.centerX>r/2+B/100*ne?$.mov(Te/2):$.mov(-Te/2):(O||k)&&fe=="right"?$.centerX>ne-J&&$.mov(Te):(O||k)&&fe=="center"?$.centerX>ne/2+B/100*ne&&$.mov(Te):$.centerX>J&&$.mov(Te)})),se&&(U+=pe,Z=U/(c.rows+1)),Ae=="center"?t.loop(o,function($){$.mov(0,(N-$.wrapHeight)/2*(O?-1:1))}):!O&&Ae=="bottom"?t.loop(o,function($){$.mov(0,N-$.wrapHeight-($.marginBottom?$.marginBottom:0))}):O&&Ae=="top"&&t.loop(o,function($){$.mov(0,-(N-$.wrapHeight)+($.marginTop?$.marginTop:0))})}Object.defineProperty(c,"spacingH",{get:function(){return i},set:function(o){i=o,this.resize()}}),Object.defineProperty(c,"spacingV",{get:function(){return l},set:function(o){l=o,this.resize()}}),Object.defineProperty(c,"wrapperType",{get:function(){return a},set:function(o){o=="spread"?V=!0:V=!1,o=="stretch"?D=!0:D=!1,a=o,this.resize()}}),Object.defineProperty(c,"align",{get:function(){return s},set:function(o){s=o,s=="middle"&&(s="center"),this.resize()}}),Object.defineProperty(c,"valign",{get:function(){return f},set:function(o){f=o,f=="middle"&&(f="center"),this.resize()}}),Object.defineProperty(c,"alignInner",{get:function(){return u},set:function(o){u=o,u=="middle"&&(u="center"),this.resize()}}),Object.defineProperty(c,"valignInner",{get:function(){return y},set:function(o){y=o,y=="middle"&&(y="center"),this.resize()}}),Object.defineProperty(c,"colSize",{get:function(){return T},set:function(o){T=o,a=="column"&&this.resize()}}),Object.defineProperty(c,"rowSize",{get:function(){return E},set:function(o){E=o,this.resize()}}),Object.defineProperty(c,"flip",{get:function(){return k},set:function(o){k=o,this.resize()}}),Object.defineProperty(c,"reverse",{get:function(){return g},set:function(o){g=o,this.resize()}}),Object.defineProperty(c,"bottomFull",{get:function(){return O},set:function(o){O=o,this.resize()}}),Object.defineProperty(c,"percentVoidH",{get:function(){return x},set:function(o){x=o,this.resize()}}),Object.defineProperty(c,"offsetVoidH",{get:function(){return P},set:function(o){P=o,this.resize()}}),Object.defineProperty(c,"percentVoidV",{get:function(){return v},set:function(o){v=o,this.resize()}}),Object.defineProperty(c,"offsetVoidV",{get:function(){return w},set:function(o){w=o,this.resize()}}),n(e)||c.add(e),X!==!1&&t.styleTransforms(this,_),this.clone=function(){var o=c.cloneProps(new t.Wrapper(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,this.style,this.group));return o}},t.extend(t.Wrapper,t.Container,"clone","zimContainer",!1),t.Tile=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V){var D="obj, cols, rows, spacingH, spacingV, unique, width, height, squeezeH, squeezeV, colSize, rowSize, align, valign, count, mirrorH, mirrorV, snapToPixel, clone, events, exact, scaleToH, scaleToV, scaleToType, backgroundColor, backing, backdropColor, backdropPadding, backdropPaddingH, backdropPaddingV, mat, style, group, inherit",c;if(c=st(t.Tile,arguments,D,this))return c;De("66.5"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Tile",this.group=ne;var h=K===!1?{}:t.getStyle(this.type,this.group,V);n(e)&&(e=h.obj!=null?h.obj:new t.Circle),n(r)&&(r=h.cols!=null?h.cols:1121),n(i)&&(i=h.rows!=null?h.rows:1121);var o;r==1121&&i==1121?r=i=o=3:r==1121?r=1:i==1121&&(i=1),n(s)&&(s=h.unique!=null?h.unique:!1),n(f)&&(f=h.width!=null?h.width:null),n(u)&&(u=h.height!=null?h.height:null),n(g)&&(g=h.colSize!=null?h.colSize:null),n(O)&&(O=h.rowSize!=null?h.rowSize:null),n(f)||(g=null),n(u)||(O=null),n(l)&&(l=h.spacingH!=null?h.spacingH:o?3:null),n(a)&&(a=h.spacingV!=null?h.spacingV:o?3:null);var I=l,N=a;(n(l)||!n(g)||!n(f))&&(l=0),(n(a)||!n(O)||!n(u))&&(a=0),n(y)&&(y=h.squeezeH!=null?h.squeezeH:!1),n(k)&&(k=h.squeezeV!=null?h.squeezeV:!1),n(T)&&(T=h.align!=null?h.align:"left"),n(E)&&(E=h.valign!=null?h.valign:"top"),n(A)&&(A=h.count!=null?h.count:s&&Array.isArray(e)?e.length:null),A===0&&(A=null,vt&&tt("ZIM Tile() - count parameter of 0 is ignored - see docs")),n(C)&&(C=h.mirrorH!=null?h.mirrorH:!1),n(d)&&(d=h.mirrorV!=null?h.mirrorV:!1),n(x)&&(x=h.snapToPixel!=null?h.snapToPixel:!0),x&&(e&&e.stage?e.stage.snapToPixelEnabled=!0:typeof elem<"u"&&ee.zdf&&(ee.zdf.stage.snapToPixelEnabled=!0)),n(P)&&(P=h.clone!=null?h.clone:s?!1:null),P==null&&(P=!(typeof e=="function"&&e.type!="series")),n(v)&&(v=h.events!=null?h.events:!0),n(b)&&(b=h.scaleToH!=null?h.scaleToH:null),n(X)&&(X=h.scaleToV!=null?h.scaleToV:null),n(Y)&&(Y=h.scaleToType!=null?h.scaleToType:null),n(m)&&(m=h.backgroundColor!=null?h.backgroundColor:null),n(j)&&(j=h.backing!=null?h.backing:null),n(S)&&(S=h.backdropColor!=null?h.backdropColor:null),n(_)&&(_=h.backdropPadding!=null?h.backdropPadding:null),n(R)&&(R=h.backdropPaddingH!=null?h.backdropPaddingH:n(S)?null:_||l),n(U)&&(U=h.backdropPaddingV!=null?h.backdropPaddingV:n(S)?null:_||a),(U||R)&&(_=!0),n(Z)&&(Z=h.mat!=null?h.mat:!1);var p=this;p.cols=r=Math.round(r),p.rows=i=Math.round(i),p.spacingH=l,p.spacingV=a,p.squeezeH=y,p.squeezeV=k;var L=typeof T=="function",we=typeof E=="function";p.align=L?"left":T,p.valign=we?"top":E,p.mirrorH=C,p.mirrorV=d,p.items=[];var B,F=0,fe=!1;e:for(var se=0;se<i;se++)for(var Q=0;Q<r;Q++){if(F++,!n(A)&&F>A)break e;B=s?e[F-1]:t.Pick.choose(e),typeof B=="string"&&(B=ee.asset(B).centerReg({add:!1}).clone()),n(B)&&(B=new t.Container(0,0,0,0)),P&&(se!=0||Q!=0)&&(B=B.clone(w)),v&&B.on("change",function(ae){var Ne=new Fe.Event("change");Ne.item=ae.currentTarget,p.dispatchEvent(Ne)}),p.items.push(B),B.type=="AC"&&(fe=!0),B.tileNum=F-1,B.tileCol=Q,B.tileRow=se}fe&&vt&&tt("ZIM Tile - assets must have dimensions for Tile");var te,le,Ae,J,Te,G,ce,q,ue,ge,ie,xe,Se,z;function pe(){p.removeAllChildren(),te=[],le=[],Ae=[],J=[],Te=[],G=0,ce=0,q=0,ue=0,ge=[],ie=[],xe=[],z=[],Se=[],(!p.items||!p.items.length)&&(p.items=[]),A=p.items.length;var ae=0,Ne,Ke,Xe=0,Qe=0,he,Ge;for(Ke=0;Ke<A;Ke++)Xe=Math.floor(Ke/p.cols),Qe=Ke%p.cols,n(te[Xe])&&(te[Xe]=[]),n(p.items[Ke])&&(p.items[Ke]=new t.Container(0,0,0,0)),te[Xe][Qe]=p.items[Ke];p.rows=Math.max(1,te.length),p.cols=Math.max(1,n(te[0])?0:te[0].length);e:for(Xe=0;Xe<p.rows;Xe++)for(ge.push([]),ie.push([]),z.push([]),O&&n(u)&&(he=t.Pick.choose(O)),Ke=0;Ke<p.cols;Ke++){if(ae++,!n(A)&&ae>A)break e;Ne=te[Xe][Ke],Ne.snapToPixel=x,p.addChild(Ne),ge[Xe].push(Ne.scaleX),ie[Xe].push(Ne.scaleY),g&&n(f)&&(Ge=t.Pick.choose(g)),Xe==0&&Se.push(t.Pick.choose(T)),(!g||!n(f))&&(Ge=Math.abs(Ne.width)),(!O||!n(u))&&(he=Math.abs(Ne.height)),z[Xe][Ke]=[Ge,he],n(J[Ke])&&(J[Ke]=0),n(Te[Xe])&&(Te[Xe]=0),Ge>J[Ke]&&(J[Ke]=Ge),he>Te[Xe]&&(Te[Xe]=he),n(le[Xe])&&(le[Xe]=0),n(Ae[Ke])&&(Ae[Ke]=0),le[Xe]+=Ge,Ae[Ke]+=he,le[Xe]>G&&(G=le[Xe]),Ae[Ke]>ce&&(ce=Ae[Ke]),n(xe[Ke])&&(xe[Ke]=0),xe[Ke]++}var Ie;if(p.squeezeH===!1)for(Ke=0;Ke<J.length;Ke++)Ie=J[Ke],q+=Ie;if(p.squeezeV===!1)for(Ke=0;Ke<Te.length;Ke++)Ie=Te[Ke],ue+=Ie}pe();var de=q,oe=ue,Be,$,Me,be,me=1,re=1;function ke(ae,Ne){!n(S)&&_&&(ae-=Math.max(R*2,0),Ne-=Math.max(U*2,0)),ae<=0&&(ae=null),Ne<=0&&(Ne=null),!n(ae)&&p.squeezeH=="full"?Be=ae:n(ae)?q>0?Be=q+(p.cols-1)*p.spacingH:Be=G+(p.cols-1)*p.spacingH:b?Be=ae:Be=Math.max(G+(p.cols-1)*p.spacingH,ae),!n(Ne)&&p.squeezeV=="full"?$=Ne:n(Ne)?ue>0?$=ue+(p.rows-1)*p.spacingV:$=ce+(p.rows-1)*p.spacingV:X?$=Ne:$=Math.max(ce+(p.rows-1)*p.spacingV,Ne),p.setBounds(0,0,Be,$),me=(Be-(p.cols-1)*I)/de,re=($-(p.rows-1)*N)/oe;var Ke,Xe;Me=[],be=[];var Qe=[];for(se=0;se<te.length;se++)for(Ke=te[se],Xe=0,Q=0;Q<Ke.length;Q++){B=Ke[Q];var he,Ge;if(se==0&&(Me[Q]=0,n(Ne)||(p.squeezeV=="full"?be[Q]=xe[Q]>1?(Ne-Ae[Q])/(xe[Q]-1):0:p.squeezeV?be[Q]=xe[Q]>1?Math.max(p.spacingV,(Ne-Ae[Q])/(xe[Q]-1)):0:be[Q]=xe[Q]>1?Math.max(p.spacingV,($-Ae[Q])/(xe[Q]-1)):0),p.squeezeV?p.valign=="center"||p.valign=="middle"?Qe[Q]=($-(Ae[Q]+(xe[Q]-1)*(n(Ne)?p.spacingV:be[Q])))/2:p.valign=="bottom"?Qe[Q]=$-(Ae[Q]+(xe[Q]-1)*(n(Ne)?p.spacingV:be[Q])):Qe[Q]=0:Qe[Q]=0),Q==0){n(ae)||(p.squeezeH=="full"?Ge=Ke.length>1?(ae-le[se])/(Ke.length-1):0:p.squeezeH?Ge=Ke.length>1?Math.max(p.spacingH,(ae-le[se])/(Ke.length-1)):0:Ge=Ke.length>1?Math.max(p.spacingH,(Be-le[se])/(Ke.length-1)):0),p.squeezeH?p.align=="center"||p.align=="middle"?he=(Be-(le[se]+(Ke.length-1)*(n(ae)?p.spacingH:Ge)))/2:p.align=="right"?he=Be-(le[se]+(Ke.length-1)*(n(ae)?p.spacingH:Ge)):he=0:he=0;var Ie=t.Pick.choose(E)}T=Se[Q];var _e=z[se][Q][0],Je=z[se][Q][1];p.mirrorH&&Q%2==1&&(B.scaleX=-ge[se][Q]),B.pos(Xe,null),!p.squeezeH&&L?n(ae)&&(T=="center"||T=="middle")?B.x+=(J[Q]-B.width)/2:n(ae)&&T=="right"&&(B.x+=J[Q]-B.width):p.squeezeH?n(ae)&&(p.align=="center"||p.align=="middle")?B.x+=(_e-B.width)/2:n(ae)&&p.align=="right"&&(B.x+=_e-B.width):n(ae)&&(p.align=="center"||p.align=="middle")?B.x+=(J[Q]-B.width)/2:n(ae)&&p.align=="right"&&(B.x+=J[Q]-B.width),p.mirrorV&&se%2==1&&(B.scaleY=-ie[se][Q]),B.pos(null,Me[Q]),!p.squeezeV&&we?n(Ne)&&(Ie=="center"||Ie=="middle")?B.y+=(Te[se]-B.height)/2:n(Ne)&&Ie=="bottom"&&(B.y+=Te[se]-B.height):p.squeezeV?n(Ne)&&(p.valign=="center"||p.valign=="middle")?B.y+=(Je-B.height)/2:n(Ne)&&p.valign=="bottom"&&(B.y+=Je-B.height):n(Ne)&&(p.valign=="center"||p.valign=="middle")?B.y+=(Te[se]-B.height)/2:n(Ne)&&p.valign=="bottom"&&(B.y+=Te[se]-B.height),p.squeezeH===!0||!n(ae)?Xe+=_e+(n(ae)?p.spacingH:Ge):Xe+=J[Q]+(n(ae)?p.spacingH:Ge),B.x+=he,B.y+=Qe[Q],p.squeezeV===!0||!n(Ne)?Me[Q]+=Je+(n(Ne)?p.spacingV:be[Q]):Me[Q]+=Te[se]+(n(Ne)?p.spacingV:be[Q])}}ke(f,u),this.itemUnderPoint=function(ae,Ne,Ke){if(n(Ke)&&(Ke=!0),!(n(ae)||n(Ne))){var Xe=p.globalToLocal(ae,Ne);ae=Xe.x,Ne=Xe.y;var Qe=0,he=t.loop(J,function(_e,Je){if(Qe+=_e+p.spacingH,(!Ke||Ke=="vertical")&&ae>Qe-p.spacingH&&ae<Qe)return!1;if(ae<Qe-p.spacingH/2)return Je});if(he!==!1&&(he===!0&&(he=r-1),!(ae<0||ae>Be||Ne<0||Ne>$))){var Ge=0,Ie=t.loop(Te,function(_e,Je){var Oe=n(u)?p.spacingV:be[Q];if((!Ke||Ke=="horizontal")&&Ne>Ge-Oe&&Ne<Ge)return!1;if(Ge+=_e+Oe,Ne<Ge-Oe/2)return Je});if(Ie!==!1)return Ie===!0&&(Ie=i-1),p.items2D[Ie][he]}}},this.remake=function(ae){return n(ae)||(p.items=ae),pe(),ke(f,u),Pe(!0),p},this.resize=function(ae,Ne){return n(ae)&&(ae=f),n(Ne)&&(Ne=u),f=ae,u=Ne,ke(ae,Ne),Pe(!0),p};function Re(ae){for(var Ne=[],Ke,Xe=0;Xe<ae.length;Xe++)Xe%p.cols==0&&(Ke=[],Ne.push(Ke)),Ke.push(ae[Xe]);return Ne}function Ye(ae){var Ne=[],Ke;for(Ke=0;Ke<p.cols;Ke++)Ne.push([]);for(Ke=0;Ke<ae.length;Ke++)Ne[Ke%p.cols][Math.floor(Ke/p.cols)]=ae[Ke];return Ne}Object.defineProperty(this,"items2D",{get:function(){return Re(p.items)},set:function(){vt&&tt("Tile() - items2D is read only")}}),Object.defineProperty(this,"items2DCols",{get:function(){return Ye(p.items)},set:function(){vt&&tt("Tile() - items2DCols is read only")}}),Object.defineProperty(this,"current",{get:function(){var ae=[];return t.loop(p.items,function(Ne){var Ke=Ne.getBounds(),Xe=Ne.x-Ne.regX+Ke.x+Ke.width/2,Qe=Ne.y-Ne.regY+Ke.y+Ke.height/2,he=p.hitTestGrid(p.width,p.height,p.cols,p.rows,Xe,Qe,null,null,p.spacingH,p.spacingV,!0,"open");he!=null&&(ae[he[0]]=Ne)}),ae},set:function(){vt&&tt("Tile() - current is read only")}}),Object.defineProperty(this,"current2D",{get:function(){return Re(p.current)},set:function(){vt&&tt("Tile() - current2D is read only")}}),Object.defineProperty(this,"current2DCols",{get:function(){return Ye(p.current)},set:function(){vt&&tt("Tile() - current2DCols is read only")}});var $e,it,Le,Ze,ze,ve;function Pe(ae){if(ae&&(Ze&&Ze.removeFrom(),Z&&Z.removeFrom()),!n(m)||j||b||X){!ae&&(b||X)&&(ze=[],ve=[]),(!ae||n(m))&&($e=[]),!ae&&!n(m)&&(Le=[]),!ae&&j&&(it=[]);var Ne=(g?I:0)/2,Ke=(O?N:0)/2,Xe,Qe=0;if(t.loop(p.items2D,function(Ge,Ie){t.loop(Ge,function(_e,Je){var Oe=black;if(n(m)||(ae&&!n(m)?(Oe=Le[Qe],Xe=$e[Qe].siz(J[Je]*me-(g?I:0),Te[Ie]*re-(O?N:0)).loc(Ne,Ke,p,0)):(Oe=nt(m),Le.push(m),Xe=new t.Rectangle({width:J[Je]*me-(g?I:0),height:Te[Ie]*re-(O?N:0),color:Oe,style:!1,scaleDimensions:!1,strokeObj:{ignoreScale:!0},group:"background"}).loc(Ne,Ke,p,0),$e.push(Xe)),_e.pos(0,0,T,E,Xe).addTo(p)),Ne=Xe.x+Xe.width+I,b||X){var Ve,rt;if(ae)Ve=ze[Qe],rt=ve[Qe];else{var Ve=nt(b)||100,rt=nt(X)||100;ze.push(Ve),ve.push(rt)}_e.scaleTo(Xe,Ve,rt,Y).pos(0,0,T,E,Xe).addTo(p)}if(j){var Ce;ae?Ce=it[Qe]:Ce=nt(j).clone(null,!1),it.push(Ce),Ce.pos(0,0,T,E,Xe).addTo(p)}Qe++}),Ne=(g?I:0)/2,Ke+=Xe.height+N}),j&&!n(m)&&t.loop(it,function(Ge){Ge.addTo(p,$e.length)},!0),n(m)?(t.loop($e,function(Ge){Ge.dispose()},!0),$e=null,Le=null):(p.backgrounds=$e,p.backgroundColors=Le),!n(m)&&(g||O)){p.loop(function(Ge){Ge.mov(g?-I/2:0,O?-N/2:0)});var he=p.getBounds();p.setBounds(he.x,he.y,he.width-(g?I:0)*r,he.height-(O?N:0)*i),he=p.getBounds()}j&&(p.backings=it)}if(Z&&(p.mat=Z,Z.center(p,0)),S){var he=p.getBounds();Ze=p.backdrop=new t.Rectangle({width:he.width+R*2,height:he.height+U*2,color:S,style:!1,group:"backdrop"}),Ze.center(p,0),p.loop(function(Ie){Ie.mov(Math.max(0,R),Math.max(U,0))}),p.setBounds(0,0,he.width+Math.max(0,R)*2,he.height+Math.max(U,0)*2)}}Pe(),K!==!1&&t.styleTransforms(this,h),this.clone=function(ae){if(ae){var Ne=[];if(m)var Ke=[];if(j)var Xe=[];for(var Qe=0;Qe<p.items.length;Qe++)Ne.push(p.items[Qe].clone(!0)),m&&Ke.push(Le[Qe]),j&&Xe.push(it[Qe].clone(!0))}return p.cloneProps(new t.Tile(ae&&Ne?t.series(Ne):e.clone?e.clone():e,p.cols,p.rows,p.spacingH,p.spacingV,ae?!1:s,f,u,p.squeezeH,p.squeezeV,g,O,T,E,p.items.length,p.mirrorH,p.mirrorV,x,ae?!1:P,v,ae,b,X,Y,ae&&Ke?t.series(Ke):m,ae&&Xe?t.series(Xe):j&&j.clone?j.clone():j,S,_,R,U,Z&&Z.clone?Z.clone():Z,this.style,this.group))}},t.extend(t.Tile,t.Container,"clone","zimContainer",!1),t.Pack=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m){var j="width, height, items, spacingH, spacingV, flatten, direction, lock, backgroundColor, align, valign, lastAlign, paddingH, paddingV, dragOrder, dragColor, dragThickness, dragDashed, reverse, funnel, showPacking, order, style, group, inherit",S;if(S=st(t.Pack,arguments,j,this))return S;De("66.52"),this.group=Y;var _=X===!1?{}:t.getStyle("Pack",this.group,m);n(e)&&(e=_.width!=null?_.width:500),n(r)&&(r=_.height!=null?_.height:500),this.zimContainer_constructor(e,r),this.type="Pack",n(i)&&(i=_.items!=null?_.items:[new t.Rectangle(400,300,t.orange),new t.Rectangle(400,200,t.purple),new t.Rectangle(500,300,t.blue)]),n(l)&&(l=_.spacingH!=null?_.spacingH:10),n(a)&&(a=_.spacingV!=null?_.spacingV:10),n(s)&&(s=_.flatten!=null?_.flatten:"top"),n(f)&&(f=_.direction!=null?_.direction:"horizontal"),n(u)&&(u=_.lock!=null?_.lock:"auto"),n(y)&&(y=_.backgroundColor!=null?_.backgroundColor:t.clear),n(k)&&(k=_.align!=null?_.align:"center"),n(g)&&(g=_.valign!=null?_.valign:"center"),n(O)&&(O=_.lastAlign!=null?_.lastAlign:f=="horizontal"?"left":"top"),n(T)&&(T=_.paddingH!=null?_.paddingH:0),n(E)&&(E=_.paddingV!=null?_.paddingV:0),n(A)&&(A=_.dragOrder!=null?_.dragOrder:!1),n(C)&&(C=_.dragColor!=null?_.dragColor:t.white),n(d)&&(d=_.dragThickness!=null?_.dragThickness:2),n(x)&&(x=_.dragDashed!=null?_.dragDashed:!0),n(P)&&(P=_.reverse!=null?_.reverse:!1),n(v)&&(v=_.funnel!=null?_.funnel:!1),n(w)&&(w=_.showPacking!=null?_.showPacking:!1),n(b)&&(b=_.order!=null?_.order:null);var R=this;R.funnel=v;var U=i.length,Z=e-T*2,K=r-E*2,ne=50;s===!1&&(s=NONE);var V=this.backing=new Mn({width:e,height:r,color:y,scaleDimensions:!1}).addTo(this);if(R.items=t.copy(i),i.length<=0)return this;if(i.length==1)return c(i[0]),h(i[0]),this;var D=function(oe,Be,$){return oe.width>Be.width?1:oe.width<Be.width?-1:0};function c(oe){oe.scaleTo(V,100-T/Z*100*2,100-E/K*100*2),oe.scale*=R.scale,oe.scale<0&&(oe.scale=.05)}function h(oe){oe.pos(k!=CENTER&&k!=MIDDLE?T:0,g!=CENTER&&g!=MIDDLE?E:0,k,g,V).addTo(R)}function o(oe){var Be=[];t.loop(oe,function($,Me){Be[Me]=R.items[$]}),i=[],t.loop(Be,function($){$&&i.push($)})}var I=R.content=new t.Container,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te;t.loop(i,function(oe,Be){oe.zpRotation=oe.rotation,oe.zpIndex=Be}),b&&o(b),f==VERTICAL&&G(!0);function G(oe){I.rotation=0;var Be=r;r=e,e=Be;var $=K;K=Z,Z=$;var Me=a;a=l,l=Me;var be=E;E=T,T=be,s==RIGHT?s=BOTTOM:s!=CENTER&&s!=NONE&&(s=TOP),O==BOTTOM?O=LEFT:O!=CENTER&&O!=MIDDLE&&(O=RIGHT),V.dispose(),V=new Mn(e,r,y).center(R),oe?(u==HORIZONTAL?u=VERTICAL:u==VERTICAL&&(u=HORIZONTAL),t.loop(i,function(me,re){var ke=new t.Container(me.height,me.width);me.rotation+=90,me.pos(0,0,TOP,LEFT,ke),i[re]=ke})):(u==HORIZONTAL?u=VERTICAL:u==VERTICAL&&(u=HORIZONTAL),I.rotation-=90,t.loop(i,function(me,re){var ke=me,Re=me.getChildAt(0).addTo(I).sca(ke.scale);ke.dispose(),i[re]=Re}))}var ce=u;function q(oe){u==AUTO&&(u=HORIZONTAL),N=Math.ceil(Math.sqrt(U)),p=Math.ceil(U/N),B=null,F=null,fe=0,Te=null,se=0,Q=0,te=null,le=null,Ae=null,J=null,de(oe,N,p),pe(I,N,p)}q(i),ue();function ue(){if(c(I),h(I),s==NONE){t.loop(i,function(Me){Me.surrogate?(i.splice(i.indexOf(Me),1),Me.dispose()):Me.bot()},!0);var oe=p*N-U;if(s==NONE&&oe>0){var Be=I.getChildAt(I.numChildren-1);if(f==HORIZONTAL&&!P&&O!=LEFT){var $=I.getBounds().width-(Be.x+(Be.getBounds().x-Be.regX)*Be.scaleX+Be.width);t.loop(N-oe,function(Me){I.getChildAt(I.numChildren-Me-1).mov(O==RIGHT?$:$/2)})}else if(f==HORIZONTAL&&P&&O!=RIGHT){var $=Be.x+(Be.getBounds().x-Be.regX)*Be.scaleX;t.loop(N-oe,function(be){I.getChildAt(I.numChildren-be-1).mov(O==LEFT?-$:-$/2)})}else if(f==VERTICAL&&!P&&O!=RIGHT){var $=Be.x;t.loop(N-oe,function(be){I.getChildAt(I.numChildren-be-1).mov(O==LEFT?-$:-$/2)})}else if(f==VERTICAL&&P&&O!=LEFT){var $=I.getBounds().width-Be.x;t.loop(N-oe,function(be){I.getChildAt(I.numChildren-be-1).mov(O==RIGHT?$:$/2)})}}}f==VERTICAL&&(G(!1),c(I),h(I)),R.cols=N,R.rows=p,R.iterations=fe-2,R.currentItems=i,R.dispatchEvent("change")}var ge,ie,xe;A&&R.added(Se);function Se(){z(),xe=Math.min(30,f==HORIZONTAL?I.height/p/3*R.scale*I.scale:I.width/N/3*R.scale*I.scale),ge?ge.siz(xe,xe).reg(CENTER):ge=R.beacon=new t.Rectangle({width:xe,height:xe,borderColor:C,borderWidth:d,scaleDimensions:!1}).reg(CENTER).rot(45),ie||(ie=R.ghost=new t.Rectangle({width:100,height:100,borderColor:C,borderWidth:d,dashed:x,scaleDimensions:!1}).reg(CENTER));var oe,Be,$,Me;R.mdEvent=R.on("mousedown",function(be){if($=be.target,ge.top(),oe=null,!(i.indexOf($)<0)){Me=R.localToGlobal(R.getBounds().x,R.getBounds().y);var me=$.boundsToGlobal();R.ghost.siz(me.width,me.height).reg(CENTER).loc(me.x+ie.width/2,me.y+ie.height/2,R.stage),ie.diffX=R.stage.frame.mouseX-ie.x,ie.diffY=R.stage.frame.mouseY-ie.y,Be=I.getChildIndex($),R.stage.update()}}),R.pmEvent=R.on("pressmove",function(){if(ie.parent){var be=R.stage.frame;ie.loc(be.mouseX-ie.diffX,be.mouseY-ie.diffY);var me=R.getObjectUnderPoint((ie.x-Me.x)/R.scaleX,(ie.y-Me.y)/R.scaleY,1);if(i.indexOf(me)>=0){var re=me.boundsToGlobal();f==HORIZONTAL?ie.x>=re.x+re.width/2?(ge.loc(re.x+re.width+l/2*R.scaleX*I.scaleX,re.y+re.height/2,R.stage),oe=I.getChildIndex(me)+(P?0:1)):(ge.loc(re.x-l/2*R.scaleX*I.scaleX,re.y+re.height/2,R.stage),oe=I.getChildIndex(me)+(P?1:0)):ie.y>=re.y+re.height/2?(ge.loc(re.x+re.width/2,re.y+re.height+a/2,R.stage),oe=I.getChildIndex(me)+(P?0:1)):(ge.loc(re.x+re.width/2,re.y-a/2,R.stage),oe=I.getChildIndex(me)+(P?1:0))}R.stage.update()}}),R.puEvent=R.on("pressup",function(){ie.parent&&(oe!=null&&(oe>Be&&oe--,oe!=Be&&($.level=oe,i=[],I.loop(function(be,me){i.push(be.rot(be.zpRotation||0).sca(1))}),u=ce,f==VERTICAL&&G(!0),q(i),ue())),ie.removeFrom(),ge.removeFrom(),R.stage.update())})}function z(){R.mdEvent&&R.off("mousedown",R.mdEvent),R.pmEvent&&R.off("pressmove",R.pmEvent),R.puEvent&&R.off("pressup",R.puEvent),ge&&ge.removeFrom(),ie&&ie.removeFrom()}function pe(oe,Be,$){if(oe.scale=1,fe++>20){Te&&Te.clear();return}var Me=!1;if(oe.height>K){if(L=Be+1,we=Math.ceil(U/L),Be==F&&u==VERTICAL)if(Q>se)L=le,we=J,Me=!0;else return oe}else if(oe.height<=K&&(L=Math.max(Be-1,1),we=Math.ceil(U/L),Be==F&&u==HORIZONTAL))if(Q>se)L=le,we=J,Me=!0;else return oe;if(F=B,B=N,N=L,p=we,t.loop(i,function(be){s==NONE&&be.surrogate?(i.splice(i.indexOf(be),1),be.dispose()):be.siz(null,K)},!0),de(i,N,p),Q=se,le=te,J=Ae,ce==AUTO||u==HORIZONTAL&&Math.round(oe.width)==Z||u==VERTICAL&&Math.round(oe.height)==K?se=oe.width*oe.height:se=0,te=N,Ae=p,Me){Te&&Te.clear(),h(oe),R.stage&&R.stage.update();return}w?(Te=zr(1,function(){pe(oe,N,p)}),h(oe),R.stage&&R.stage.update(),oe.sca(1)):(oe.sca(1),pe(oe,N,p))}function de(oe,Be,$){var Me=0;t.loop(oe,function(Le,Ze){Le.siz(null,ne),Me+=Le.width});var be=Me/U,me=oe;U%Be!=0&&s==NONE&&t.loop(Be-U%Be,function(){var Le=new t.Rectangle(be,ne,grey);Le.surrogate=!0,me.push(Le)});var re=new ni(me,Be,$,0,0,!0),ke=[],Re=t.copy(re.items2D);if(s!=NONE&&Be*$!=U&&Re.length>1){var Ye;if(s==BOTTOM)Ye=R.funnel?Math.floor((Be*$-U)/2):Math.ceil((Be*$-U)/2),t.loop(Ye,function(Le){Re[$-1].unshift(Re[$-2].pop())});else{var $e=Be*$-U;t.loop(Re,function(Le,Ze,ze){Ze!=ze-1&&t.loop(Le.splice(-$e,$e),function(ve){Re[Ze+1].unshift(ve)},!0)}),Ye=R.funnel?Math.floor((Be*$-U)/2):Math.ceil((Be*$-U)/2),t.loop(Ye,function(Le){Re[0].push(Re[1].shift())})}}t.loop(Re,function(Le,Ze,ze){var ve=0;t.loop(Le,function(Ke){ve+=Ke.width});var Pe=(Z-l*(Le.length-1))/ve;t.loop(Le,function(Ke){Ke.scale*=Pe});var ae=t.copy(Le);(P&&f==HORIZONTAL||!P&&f==VERTICAL)&&ae.reverse();var Ne=new ni(ae,Le.length,1,l,0,!0);P&&Ne.loop(function(Ke){Ke.bot()}),ke.push(Ne)}),re.dispose();var it=0;return I.loc(V,null,R),I.removeAllChildren(),t.loop(ke,function(Le){Le.loc(0,it,I),it+=Le.height+a,Le.loop(function(Ze,ze,ve){Ze.addTo(I).ord(-(ve-ze))},!0)}),t.loop(ke,function(Le){Le.dispose()},!0),c(I),I}R.getOrder=function(oe){if(n(oe)&&(oe=!1),oe){if(!Be){var Be=R.pane=new t.Pane({displayClose:!1,container:R.stage,width:Math.min(500,R.stage.width-20),height:Math.min(500,R.stage.height-20),draggable:!0}),$=R.textArea=new t.TextArea(Math.min(400,R.stage.width-70),Math.min(400,R.stage.height-70));$.centerReg(Be)}Be.show(),$.text=JSON.stringify(R.order)}return R.order},this.setOrder=function(oe){return o(oe),q(i),ue(),R},this.addAt=function(oe,Be){return n(oe)||(n(Be)&&(Be=R.items.length),Array.isArray(oe)||(oe=[oe]),t.loop(oe,function($,Me){R.items.push($),$.zpIndex=R.items.length-1,R.currentItems.splice(Be+Me,0,$)}),q(R.currentItems),ue()),R},this.removeAt=function(oe,Be){n(oe)&&(oe=1),n(Be)&&(Be=R.items.length);var $=R.currentItems.splice(Be,oe);return t.loop($,function(Me){var be=R.items.indexOf(Me);R.items.splice(be,1)}),q(R.currentItems),ue(),R},Object.defineProperty(R,"order",{get:function(){var oe=[];return I.loop(function(Be){oe.push(Be.zpIndex)}),oe},set:function(oe){R.setOrder(oe)}}),Object.defineProperty(R,"lock",{get:function(){return ce},set:function(oe){oe!=ce&&(u=oe,q(i),ue(),A&&Se())}}),Object.defineProperty(R,"direction",{get:function(){return f},set:function(oe){oe!=f&&(f=oe,I.rotation=0,i=[],I.loop(function(Be,$){i.push(Be.rot(Be.zpRotation||0).sca(1))}),f==VERTICAL&&G(!0),q(i),ue(),A&&Se())}}),Object.defineProperty(R,"spacing",{get:function(){return f==VERTICAL?a:l},set:function(oe){l=a=oe,q(i),ue()}}),Object.defineProperty(R,"outerWidth",{get:function(){return e},set:function(oe){e!=oe&&(e=oe,Z=e-T*2,V&&(V.widthOnly=e,V.center(R)),q(i),ue(),A&&Se())}}),Object.defineProperty(R,"outerHeight",{get:function(){return r},set:function(oe){r!=oe&&(r=oe,K=r-E*2,V&&(V.heightOnly=r,V.center(R)),q(i),ue(),A&&Se())}}),Object.defineProperty(R,"flatten",{get:function(){return s},set:function(oe){s!=oe&&(s=oe,q(i),ue())}}),Object.defineProperty(R,"dragOrder",{get:function(){return A},set:function(oe){oe?Se():(z(),R.stage&&R.stage.update())}}),X!==!1&&t.styleTransforms(this,_),this.dispose=function(oe){return A&&z(),R.items=null,R.currentItems=null,oe||this.zimContainer_dispose(!0),!0},this.clone=function(){return R.cloneProps(new t.Pack(e,r,t.copy(i,!0),l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,t.copy(R.order),this.style,this.group))}},t.extend(t.Pack,t.Container,["dispose","clone"],"zimContainer",!1),t.Beads=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A){var C="path, obj, count, angle, startPercent, endPercent, percents, onTop, showControls, visible, interactive, clone, group, style, inherit",d;if(d=st(t.Beads,arguments,C,this))return d;De("66.7"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Beads",this.group=T;var x=E===!1?{}:t.getStyle(this.type,this.group,A);n(u)&&(u=x.onTop!=null?x.onTop:!1),n(y)&&(y=x.showControls!=null?x.showControls:!1),n(k)&&(k=x.visible!=null?x.visible:!0),n(g)&&(g=x.interactive!=null?x.interactive:!0),n(e)&&(e=x.path!=null?x.path:new t.Blob({color:null,borderWidth:3,borderColor:t.blue})),e.visible=k,e.interactive=g,e.toggle(y),e.onTop=u,n(r)&&(r=x.obj!=null?x.obj:new t.Circle(10)),n(i)&&(i=x.count!=null?x.count:10),n(l)&&(l=x.angle!=null?x.angle:null),n(a)&&(a=x.startPercent!=null?x.startPercent:0),n(s)&&(s=x.endPercent!=null?x.endPercent:100),n(f)&&(f=x.percents!=null?x.percents:null);var P=s;s<a&&(P=100+s);var v;if(n(f)){var w;e.type=="Squiggle"?w=(P-a)/(i-1):w=(P-a)/(i-(a!=P%100?1:0)),f=[];var b=a-w;for(v=0;v<i;v++)f.push(b+w),b+=w,b>100&&(b-=100)}n(O)&&(O=x.clone!=null?x.clone:!0);var X=this;X.count=i,X.percents=f,X.items=[];var Y;for(v=0;v<i;v++)Y=t.Pick.choose(r),O&&v!=0&&(Y=Y.clone()),Y.beadNum=v,Y.startPercent=f[v],X.items.push(Y);X.path=e.addTo(X),X.beads=new t.Container().addTo(X,u?0:null),X.beads.type="BeadsContainer",this.resize=function(){for(var m=e.segmentRatios,j=e.segmentPoints,S=0;S<X.count;S++){var _=e.getCurvePoint(Math.max(0,Math.min(.9999,f[S]/100)),m,j,!0);if(_){var R=X.beads.globalToLocal(_.x,_.y);R&&X.items[S].loc(R,null,X.beads).rot(n(l)?_.angle>180?_.angle-360+e.rotation:_.angle+e.rotation:l)}}return this},X.resize(),g&&(e.on("pressmove",X.resize),e.on("update",X.resize)),E!==!1&&t.styleTransforms(this,x),this.dispose=function(m){return m||this.zimContainer_dispose(!0),X.items=[],!0},this.clone=function(m){if(m)for(var j=[],S=0;S<X.items.length;S++)j.push(X.items[S].clone(!0));return X.cloneProps(new t.Beads(e.clone(),m?t.series(j):r.clone?r.clone():r,X.count,l,a,s,f,u,y,k,g,O,this.style,this.group))}},t.extend(t.Beads,t.Container,["clone","dispose"],"zimContainer",!1),t.Layout=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="holder, regions, lastMargin, lastMarginMin, backgroundColor, vertical, showRegions, scalingObject, hideKey, style, group, inherit",E;if(E=st(t.Layout,arguments,T,this))return E;De("80"),this.cjsEventDispatcher_constructor(),this.type="Layout",this.group=g;var A=k===!1?{}:t.getStyle(this.type,this.group,O);if(n(e)&&(e=A.holder!=null?A.holder:null),n(u)&&(u=A.scalingObject!=null?A.scalingObject:null),n(e)||!e.getBounds){Wn("zim controls - Layout(): please provide an object with bounds set that holds the objects being laid out");return}if(u=n(u)?e:u,!u.getBounds||!u.getBounds()){Wn("zim controls - Layout(): holder must have bounds set or provide a scalingObject with bounds");return}var C=u.getBounds();e.setBounds(0,0,C.width,C.height),n(i)&&(i=A.lastMargin!=null?A.lastMargin:0),n(l)&&(l=A.lastMarginMin!=null?A.lastMarginMin:0),n(s)&&(s=A.vertical!=null?A.vertical:!0),n(a)&&(a=A.backgroundColor!=null?A.backgroundColor:""),n(y)&&(y=A.hideKey!=null?A.hideKey:"B"),n(f)&&(f=A.showRegions!=null?A.showRegions:null);var d;f&&(d=new t.Shape);var x=this.backing=new t.Shape,P=this;if(this.active=!0,n(r)&&(r=A.regions!=null?t.copy(A.regions):null),n(r))return;t.loop(r,function(c,h){c instanceof Fe.DisplayObject&&(r[h]={obj:c}),r[h].object&&(r[h].obj=r[h].object,delete r[h].object)}),this.regions=r;var v,w=0,b="minWidth",X="width",Y="height",m="marginLeft",j="marginMinLeft",S="maxHeight";s&&(b="minHeight",X="height",Y="width",m="marginTop",j="marginMinTop",S="maxWidth");for(var _=[],R=0,U=0;U<r.length;U++){if(v=r[U],!v.obj||!v.obj.getBounds()){tt("Layout(): each region object must have an object with setBounds() set");return}v[b]||(v[b]=0),v[X]||(v[X]=0),v.backgroundColor||(v.backgroundColor=""),v.given=0,v.maxGiven=0,v[m]=="auto"?(_[U]=!0,R++,v[j]?v[m]=v[j]:delete v[m]):v[m]&&v[j]&&v[m]<v[j]&&(v[m]=v[j]),n(v[m])&&(v[m]=1e-4),v[S]||(v[S]=100),s?(v.align||(v.align="middle"),v.valign||(U==0?v.valign="top":U==r.length-1?v.valign="bottom":v.valign="middle",r.length==1&&(v.valign="middle"))):(v.valign||(v.valign="top"),v.align||(U==0?v.align="left":U==r.length-1?v.align="right":v.align="middle",r.length==1&&(v.align="middle"))),v[X]&&(v[b]=0),w+=v[X]+v[m]}if(i=="auto"?(_[r.length]=!0,i=l||0):i&&l&&i<l&&(i=l),w+=i,w>100){tt("Layout(): cannot fit regions into 100% bounds");return}var Z=100-w;K();function K(){var c=0,h;for(h=0;h<r.length;h++)v=r[h],v.given=0,v[X]==0&&(c+=v.obj.getBounds()[X]);for(h=0;h<r.length;h++)v=r[h],v[X]==0&&(v.given=v.obj.getBounds()[X]/c*Z)}this.resize=function(){var c;if(P.active){for(C=u.getBounds(),e.setBounds(0,0,C.width,C.height),x.graphics.clear(),a!=""&&(ne(x,a),x.graphics.r(0,0,C.width,C.height)),c=0;c<r.length;c++)v=r[c],v.maxGiven=0,v.marginGiven=0;for(var h=!0,o,I,N,p,L,we,B=Z;h;){for(h=!1,o=!0,c=0;c<r.length;c++)v=r[c],v.given>0&&v.maxGiven==0&&(I=v.obj.getBounds()[X],N=v.obj.getBounds()[Y],p=v.given*C[X]/100,L=v[S]*C[Y]/100,we=N/I*p,we>L&&v.obj.type!="Window"?(v.maxGiven=I/N*L*100/C[X],B-=v.maxGiven):o=!1);if(o)break;var F=0;for(c=0;c<r.length;c++)v=r[c],v[X]==0&&v.maxGiven==0&&(F+=v.obj.getBounds()[X]);for(c=0;c<r.length;c++)v=r[c],v[X]==0&&v.maxGiven==0&&(v.given=v.obj.getBounds()[X]/F*B)}var fe=!0;if(v=r[0],v.maxGiven>0?v.maxGiven<v[b]&&(v[X]=v[b],fe=!1):v.given>0&&v.given<v[b]&&(v[X]=v[b],fe=!1),v=r[r.length-1],v.maxGiven>0?v.maxGiven<v[b]&&(v[X]=v[b],fe=!1):v.given>0&&v.given<v[b]&&(v[X]=v[b],fe=!1),!fe){for(w=0,c=0;c<r.length;c++)v=r[c],w+=v[X]+v[m];if(w+=i,w>100){tt("zim display - Layout(): cannot fit regions into 100% bounds");return}Z=100-w,K(),P.resize();return}var se=!0,Q=0,te=0;for(c=0;c<r.length;c++)v=r[c],Q+=v[m],v[X]>0?te+=v[X]:v.maxGiven>0?te+=v.maxGiven:v.given>0&&(te+=v.given),v[X]==0&&(se=!1);if(se||o){Q+=i;var le=100-te-Q;if(Q-=i+r[0][m],le!=0&&Q!=0)for(c=0;c<r.length;c++)c!=0&&(v=r[c],v.marginGiven=v[m]/Q*(Q+le))}if(R>0){var Ae=0,J=0;for(c=0;c<r.length;c++)v=r[c],v.marginGiven>0?J+=v.marginGiven:J+=v[m],v.marginGiven=0,Ae+=v[m]>.05?v[m]:0;var Te=(J-Ae)/R;for(c=0;c<_.length;c++)_[c]&&r[c]&&(v=r[c],v.marginGiven=(v[j]?v[j]:0)+Te)}var G=0,ce=0,q,ue,ge;if(d&&d.graphics){var ie=d.graphics;ie.c()}for(c=0;c<r.length;c++)v=r[c],v.marginGiven>0?G+=v.marginGiven*C[X]/100:G+=v[m]*C[X]/100,v[X]>0?I=v[X]:v.maxGiven>0?I=v.maxGiven:v.given>0?I=v.given:I=0,I=I*C[X]/100,N=v[S]*C[Y]/100,ce=(C[Y]-N)/2,s?(v.obj.type=="Wrapper"&&v.obj.resize(N),v.obj.type=="Window"&&v.obj.resize(N,I),v.obj.type=="Region"&&v.obj.setBounds(N,I),q=t.fit(v.obj,ce,G,N,I)):(v.obj.type=="Wrapper"&&v.obj.resize(I),v.obj.type=="Window"&&v.obj.resize(I,N),v.obj.type=="Region"&&v.obj.setBounds(I,N),q=t.fit(v.obj,G,ce,I,N)),v.valign=="top"?v.obj.y=q.bY:v.valign=="bottom"&&(v.obj.y=q.bY+q.bHeight-q.height),v.align=="left"?v.obj.x=q.bX:v.align=="right"&&(v.obj.x=q.bX+q.bWidth-q.width),d&&d.graphics&&(ie.s("white").ss(2).r(q.bX,q.bY,q.bWidth,q.bHeight),ie.s("#ff8203").sd([20,20]).r(q.bX,q.bY,q.bWidth,q.bHeight).sd()),ge=ue=0,(G==0||G+I==C[X])&&(s?ge=1:ue=1),N==C[Y]&&(s?ue=1:ge=1),v.backgroundColor!=""&&(ne(x,v.backgroundColor),x.graphics.r(q.bX,q.bY,q.bWidth+ue,q.bHeight+ge)),G+=I,v.obj.ZIMoutlineShape&&v.obj.outline()}};function ne(c,h){h.type=="GradientColor"?c.graphics.lf(h.colors,h.ratios,h.x0,h.y0,h.x1,h.y1):h.type=="RadialColor"?c.graphics.rf(h.colors,h.ratios,h.x0,h.y0,h.r0,h.x1,h.y1,h.r1):h.type=="BitmapColor"?c.graphics.bf(h.image,h.repetition,h.matrix):c.graphics.f(v.backgroundColor)}this.resize(),d&&e.addChild(d),e.addChildAt(x,0),ee.addEventListener("keydown",V);function V(c){c||(c=event),d&&String.fromCharCode(c.keyCode)==y.toUpperCase()&&(P.toggle(),d.stage&&d.stage.update())}this.disable=function(){P.active=!1,ee.removeEventListener("keydown",V),d&&(d.alpha=0)},this.enable=function(){P.active=!0,ee.addEventListener("keydown",V),P.resize(),d&&(d.alpha=1)},this.removeShape=function(){d&&(d.graphics.clear(),d.dispose(),d=null,d=!1),ee.removeEventListener("keydown",V)},this.toggled=!0,this.toggle=function(c){return c===!0?d.visible=!0:c===!1?d.visible=!1:d.visible=!d.visible,P.toggled=d.visible,P},this.addShape=function(c){P.removeShape(),d=c,ee.addEventListener("keydown",V),e.addChild(d),P.resize()},k!==!1&&t.styleTransforms(this,A),u.added?u.added(D):D(u);function D(c){if(c&&c.frame&&c.frame.scaling=="full"){if(!t.globalManager){var h=t.globalManager=new t.Manager;h.frame=c.frame,h.event=c.frame.on("resize",function(){h.resize()})}t.globalManager.add(P)}}this.dispose=function(){if(P.resize=null,t.globalManager){var c=t.globalManager;c.remove(P),t.globalManager.items.length==0&&(c.frame.off("resize",c.event),c.dispose(),t.globalManager=null)}return P.backing&&P.backing.dispose(),P.backing=null,P.removeShape(),!0}},t.extend(t.Layout,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),t.Accessibility=function(e,r,i,l,a,v,f,u,y,k,g,O,T,E,A){var C="appName, tabOrder, tabIndex, cycle, decimals, frame, application, alwaysHighlight, AHTime, AHColor, AHBorderWidth, AHBorderPadding, AHAlpha, AHObject, AHObjectScale",d;if(d=st(t.Accessibility,arguments,C,this))return d;De("30.5"),this.cjsEventDispatcher_constructor(),this.type="Accessibility",n(e)&&(e="application"),n(l)&&(l=!1),n(a)&&(a=2),n(v)&&(v=ee.zdf),n(f)&&(f=!t.mobile()),n(u)&&(u=!1);var x=Tt(y);if(n(y)&&(y=x=="s"?.7:700),n(k)&&(k="brown"),n(g)&&(g=3),n(O)&&(O=5),n(T)&&(T=.8),n(A)&&(A=.8),n(E)){var P=new t.Shape({style:!1});P.mouseEnabled=!1}else E.mouseEnabled&&(E.mouseEnabled=!1);if(typeof v>"u")var v=ee.zdf;if(n(v)){vt&&tt("Accessibility - needs a Frame");return}var w=v.retina&&ee.devicePixelRatio||1,b=this;b.cycle=l,b.decimals=a,b.alwaysHighlight=u,b.AHTime=y,b.AHColor=k,b.AHBorderWidth=g,b.AHBorderPadding=O,b.AHAlpha=T,b.AHObjectScale=A;var X=-1,Y=-1,m=[],j=[],S={RadioButtons:"option",Tabs:"tab",Pad:"key"},_,R=v.canvas.id,U=t.mobile(),Z=!1,K=null,ne=[],V,D,c,h,o,I,N,p=150,L;Object.defineProperty(this,"tabOrder",{get:function(){return X},set:function($){var Me;for(V&&V.removeEventListener("focus",F),D&&D.removeEventListener("focus",F),Me=0;Me<m.length;Me++)m[Me].parentElement&&(m[Me].outerHTML="");m=[];var be,me;for(Me=0;Me<j.length;Me++)be=X[Me],be&&j[Me][0].off("mousedown",j[Me][1]);j=[],X=[];var re=[];L=v.shim?document.body:v.canvas,oe=!1;var ke=0;for(Me=0;Me<$.length;Me++){if(be=$[Me],be.type=="HotSpots"&&($.splice.apply($,[Me,1].concat(be.hotSpots)),be=be.hotSpots[0]),be.type=="HotSpot"&&(be=be.spot),be.constructor=={}.constructor){if(me=be.obj,!me||!me.getStage)continue;be.title||(be.title=G(me,Me+ke))}else me=be,be={obj:be,title:G(be,Me+ke)};if(me.type=="RadioButtons"||me.type=="Tabs"||me.type=="Pad"){var Re=[];ke--;for(var Ye=0;Ye<me.buttons.length;Ye++){ke++;var $e=me.buttons[Ye],it={obj:$e,title:be.title+" - "+S[me.type]+": "+($e.text=="a"||$e.text=="A"?"eh":$e.text)};Re.push(it),$e.zimTabParent=me,$e.zimTabParent.zimAccessibility=b,$e.zimTabIndex=Me+ke,$e.tabIndex=Ye,$e.zimAccessibility=b,ce(it),L=q(R+"Tab"+(Me+ke),it.title,L,it),j.push([$e,$e.on("mousedown",Te)]),Z||ne.push([$e,$e.on("mousedown",B)])}re=re.concat(Re)}else me.zimTabIndex=Me+ke,me.zimTabParent=me,ce(be),me.zimAccessibility=b,j.push([me,me.on("mousedown",Te)]),Z||ne.push([me,me.on("mousedown",B)]),re.push(be),L=q(R+"Tab"+(Me+ke),be.title,L,be)}V=b.startAppTag=q(R+"PrefixTab",e+" start",v.shim?document.body:v.canvas,null,"before"),V.addEventListener("focus",F),Z||(V.addEventListener("focus",le),h=q(R+"noAriaTab","",V,null,"before"),h.setAttribute("aria-hidden",!0),h.focusTab=V,h.addEventListener("focus",te),I=q(R+"noAriaTab","",V),I.setAttribute("aria-hidden",!0),I.focusTab=V,I.addEventListener("focus",te)),L=q(R+"BufferTab","",L),U&&L.setAttribute("aria-hidden",!0),L=D=b.endAppTag=q(R+"SuffixTab",e+" end",L),D.addEventListener("focus",F),Z||(D.addEventListener("focus",le),L=o=q(R+"noAriaTab","",D),o.setAttribute("aria-hidden",!0),o.focusTab=D,o.addEventListener("focus",te),N=q(R+"noAriaTab","",D,null,"before"),N.setAttribute("aria-hidden",!0),N.focusTab=D,N.addEventListener("focus",te)),X=re}});function we(){V&&(V.removeEventListener("focus",F),V.removeEventListener("focus",le),V.parentNode&&(V.outerHTML="")),h&&(h.removeEventListener("focus",te),h.parentNode&&(h.outerHTML="")),I&&(I.removeEventListener("focus",te),I.parentNode&&(I.outerHTML="")),L&&L.parentNode&&(L.outerHTML=""),D&&(D.removeEventListener("focus",F),D.removeEventListener("focus",le),D.parentNode&&(D.outerHTML="")),o&&(o.removeEventListener("focus",te),o.parentNode&&(o.outerHTML="")),N&&(N.removeEventListener("focus",te),N.parentNode&&(N.outerHTML=""))}Object.defineProperty(this,"tabIndex",{get:function(){return Y},set:function($){if(!Be)return;if($<0||$>=X.length)Le();else{$!=Y&&it();var Me=X[$].obj;if(Me.stage){if(Y=$,Me.focus=!0,ue=!0,ge=!1,b.changeTitle(Me),Me.zimTabTag.focus(),setTimeout(function(){Me.zimTabTag.focus();var Ze=new Fe.Event("change");Ze.title=Me.zimTabTag.getAttribute("aria-label"),b.dispatchEvent(Ze)},p),b.alwaysHighlight&&(!K||!U)){if(b.AHObject){_=b.AHObject;var $e=t.boundsToGlobal(Me);b.AHObject.alp(b.AHAlpha).addTo(v.stage,null,!1),b.AHObject.fit($e.x,$e.y,$e.width,$e.height),b.AHObject.sca(b.AHObject.scaleX*b.AHObjectScale),b.AHTime>0&&(pe=setTimeout(function(){v.stage.removeChild(b.AHObject),v.stage.update()},b.AHTime*(x=="s"?1e3:1)))}else{_=P;var be=Me.getBounds(),me=Me.localToGlobal(be.x-5,be.y-5),re=Me.localToGlobal(be.x+be.width+5,be.y-5),ke=Me.localToGlobal(be.x+be.width+5,be.y+be.height+5),Re=Me.localToGlobal(be.x-5,be.y+be.height+5),Ye=P.graphics;Ye.clear(),Ye.s(b.AHColor).ss(b.AHBorderWidth).mt(me.x-b.AHBorderPadding,me.y-b.AHBorderPadding).lt(re.x+b.AHBorderPadding,re.y-b.AHBorderPadding).lt(ke.x+b.AHBorderPadding,ke.y+b.AHBorderPadding).lt(Re.x-b.AHBorderPadding,Re.y+b.AHBorderPadding).lt(me.x-b.AHBorderPadding,me.y-b.AHBorderPadding).cp(),P.alpha=b.AHAlpha,b.AHTime>0&&(pe=setTimeout(function(){v.stage.removeChild(P),v.stage.update()},b.AHTime*(x=="s"?1e3:1)))}v.stage.addChild(_),v.stage.update()}}else Le()}function it(){if(Y&&Y>-1)X&&X[Y]&&(X[Y].obj.focus=!1);else for(var Ze=0;Ze<X.length;Ze++)X[Ze].obj.focus=!1}function Le(){it(),ue=!1,b.AHObject&&v.stage.removeChild(b.AHObject),b.alwaysHighlightShape&&v.stage.removeChild(b.alwaysHighlightShape),v.stage.update(),Y=-1}}}),Object.defineProperty(this,"aria",{get:function(){return K},set:function($){K=$,K&&fe()}});function B($){var Me=$.currentTarget,be=Me.boundsToGlobal(),me=be.x+be.width/2,re=be.y+be.height/2,ke=5;$.stageX/t.scaX<me-ke||$.stageX/t.scaX>me+ke||$.stageY/t.scaY<re-ke||$.stageY/t.scaY>re+ke?se():fe()}function F(){c&&(c.innerHTML="")}U=="android"&&(t.ACTIONEVENT="click",Et||(ee.ACTIONEVENT="click"));function fe(){K=!0,Ae(),c&&c.setAttribute("aria-hidden",!1),t.ACTIONEVENT="click",Et||(ee.ACTIONEVENT="click"),v.stage.removeChild(_),U&&(b.alwaysHighlight=!1),v.stage.update();for(var $,Me,be,me=0;me<X.length;me++)$=X[me],Me=$.obj,be=Me.zimTabTag,be.disabled=!1,$.title=$.title.replace(/\s\(use arrow keys\)/,""),be.setAttribute("aria-label",$.title),be.addEventListener("focus",Q)}function se(){K=!1;for(var $,Me,be,me=0;me<X.length;me++)$=X[me],Me=$.obj,be=Me.zimTabTag,be.disabled=!1;Ae(),u&&J()}function Q($){var Me=$.currentTarget,be=Me.zimObject;Y=be.zimTabIndex,be.focus=!0;var me=new Fe.Event("change");me.title=Me.getAttribute("aria-label"),b.dispatchEvent(me)}function te($){K=!1,$.target.focusTab.focus()}function le(){n(K)||K?fe():se()}function Ae(){Z=!0,V.removeEventListener("focus",le),D.removeEventListener("focus",le),h.removeEventListener("focus",te),o.removeEventListener("focus",te),h.parentNode&&(h.parentNode.removeChild(h),o.parentNode.removeChild(o)),I.removeEventListener("focus",te),N.removeEventListener("focus",te),I.parentNode&&(I.parentNode.removeChild(I),N.parentNode.removeChild(N));for(var $=0;$<ne.length;$++)ne[$][0].off("mousedown",ne[$][1])}function J(){for(var $=0;$<m.length;$++){var Me=m[$];Me.zimObject&&(Me.zimObject.type=="Loader"||Me.zimObject.type=="TextArea"||Me.zimObject.type=="Tag")||(m[$].style.left="-2000px")}}n(r)?setTimeout(function(){if(X==-1){X=[];var $=[];t.loop(v.stage,function(Me){Me.type&&$.push(Me)}),b.tabOrder=$,n(i)||(b.tabIndex=i)}},50):(X=[],b.tabOrder=r,n(i)||(b.tabIndex=i));function Te($){var Me=$.currentTarget;if(Me.type=="RadioButton"||Me.type=="TabsButton"||Me.type=="PadButton")for(var be=0;be<Me.zimTabParent.buttons.length;be++){var me=Me.zimTabParent.buttons[be];me.zimTabTag.setAttribute("aria-label",me.zimTabTag.getAttribute("aria-label").split(" - currently")[0]+(Me.zimTabParent.selectedIndex==me.tabIndex?" - currently selected.":" - currently not selected."))}b.tabIndex=$.currentTarget.zimTabIndex,b.activatedObject=Me}function G($){return $.talk?$.talk:$.type=="TextArea"||$.type=="RadioButtons"||$.type=="Tabs"||$.type=="Pad"?$.type:$.type=="Waiter"?"Waiter active - please wait":$.text?$.type+" - "+($.text=="a"||$.text=="A"?"eh":$.text):$.type+($.type=="Dial"||$.type=="Slider"||$.type=="ColorPicker"||$.type=="Stepper"?" (use arrow keys)":"")+($.type=="TextArea"?" (press ENTER to edit)":"")}function ce($){var Me=$.obj;$.title=$.title.replace(/\.$/,""),Me.type=="RadioButton"||Me.type=="TabsButton"||Me.type=="PadButton"?$.title=$.title+(Me.tabIndex==Me.zimTabParent.selectedIndex?" - currently selected":" - currently not selected"):Me.type=="CheckBox"?$.title=$.title+(Me.checked?" - currently checked":" - currently not checked"):Me.type=="Stepper"?$.title=$.title+" - currently displaying "+Me.currentValue:Me.type=="Slider"||Me.type=="Dial"?$.title=$.title+" - currently at "+t.decimals(Me.currentValue,b.decimals):Me.type=="ColorPicker"?$.title=$.title+" - currently at "+Me.selectedColor:Me.type=="TextArea"?$.title=$.title+(Me.tag.value!=""?"":" - placeholder: "+Me.tag.placeholder):Me.type=="Indicator"?$.title=$.title+" - currently "+(Me.selectedIndex>=0?"at "+(Me.selectedIndex+1)+" of "+Me.num:"not indicating"):Me.type=="TextInput"&&($.title=$.title+(Me.htmlTag.value!=""?"":" - placeholder: "+Me.htmlTag.placeholder)),$.title+="."}function q($,Me,be,me,re){var ke,Re;if(me&&(ke=me.obj),me&&(ke.type=="TextArea"||ke.type=="Loader"))return Re=ke.tag,Re.setAttribute("aria-label",Me),ke&&Re.setAttribute("aria-hidden",!ke.stage),re=="before"?be.parentNode.insertBefore(Re,be):be.parentNode.insertBefore(Re,be.nextSibling),ke.type=="TextArea"?Re.style.zIndex=3:Re.style.zIndex=-5,Re.zimObject=ke,me.obj.zimTabTag=Re,m.push(Re),Re;if(me&&ke.type=="TextInput")return Re=ke.htmlTag,Re.setAttribute("aria-label",Me),ke&&Re.setAttribute("aria-hidden",!ke.stage),re=="before"?be.parentNode.insertBefore(Re,be):be.parentNode.insertBefore(Re,be.nextSibling),Re.style.zIndex=-5,Re.zimObject=ke,me.obj.zimTabTag=Re,m.push(Re),Re;var Ye;if(me&&(ke.type=="Dial"||ke.type=="Slider"||ke.type=="Stepper"||ke.type=="ColorPicker")){var $e=[];if(ke.type=="Dial"||ke.type=="Slider"){var it=ke.step<=0?(ke.max-ke.min)/20:ke.step;for(Ye=ke.min;Ye<ke.max;Ye=Ye+it)$e.push(ke.min+Ye)}else ke.type=="Stepper"?$e=ke.stepperArray:ke.type=="ColorPicker"&&($e=ke.colors);Re=document.createElement("select"),Re.disabled=!0,Re.zimObject=ke,Re.addEventListener("change",function(ve){!K&&!U=="android"||(ve.currentTarget.zimObject.zimTabParent.currentValueEvent=ve.target.value,v.stage.update())}),Re.size=1;var Le,Ze;for(Ye=0;Ye<$e.length;Ye++)Le=$e[Ye],Ze=document.createElement("option"),Ze.setAttribute("aria-label",Le),Ze.innerHTML=Le,Re.add(Ze),Le==ke.zimTabParent.currentValue&&Ze.setAttribute("selected","selected");Re.setAttribute("role","button")}else Re=document.createElement("div"),ke&&(Re.zimObject=ke),Re.innerHTML="tag",Re.setAttribute("role",f?"application":"button"),U=="android"&&Re.addEventListener("click",function(){ke.dispatchEvent("click")});if(Re.setAttribute("id",$),Re.setAttribute("tabindex",0),Re.setAttribute("aria-label",Me),ke&&Re.setAttribute("aria-hidden",!ke.stage),re=="before"?be.parentNode.insertBefore(Re,be):be.parentNode.insertBefore(Re,be.nextSibling),Re.style.position="absolute",me){ke=me.obj;var ze=ke.boundsToGlobal();v.retina?(Re.style.left=v.x+ze.x*v.scale/w+"px",Re.style.top=v.y+ze.y*v.scale/w+"px",Re.style.width=ze.width*v.scale/w+"px",Re.style.height=ze.height*v.scale/w+"px"):(Re.style.left=v.x+ze.x*v.scale+"px",Re.style.top=v.y+ze.y*v.scale+"px",Re.style.width=ze.width*v.scale+"px",Re.style.height=ze.height*v.scale+"px"),me.obj.zimTabTag=Re}else Re.style.left="-1000px",Re.style.top=v.y+"px";return Re.style.overflow="hidden",Re.style.zIndex=-5,Re.style.fontSize="20px",Re.style.color="rgba(0,0,0,.01)",m.push(Re),Re}var ue=!1,ge=!0,ie=v.on("keydown",function($){if($.keyCode==9&&(xe()||(ue=!1,b.tabIndex!=-1&&(b.tabIndex=-1)),ue?z($):Se($)),ue&&X.length>0&&b.tabIndex>=0&&$.keyCode==13){var Me=X[b.tabIndex],be=Me.obj;if(Me&&be.stage){var me=new Fe.Event("mousedown"),re=new Fe.Event("click");me.fromEnter=re.fromEnter=!0,be.type=="Pane"?(be.backdrop.dispatchEvent(me),be.backdrop.dispatchEvent(re)):(be.dispatchEvent(me),be.dispatchEvent(re))}}});function xe(){for(var $=!1,Me=0;Me<m.length;Me++)if(document.activeElement==m[Me]){$=!0;break}return!!(document.activeElement==v.canvas||$)}function Se($){!v.shiftKey&&(Cn(R+"PrefixTab")==document.activeElement||v.canvas==document.activeElement)?(X.length>0&&(X[X.length-1].obj.focus=!0),ge=!0,ue=!0,z($)):v.shiftKey&&(Cn(R+"SuffixTab")==document.activeElement||Cn(R+"BufferTab")==document.activeElement)&&(X.length>0&&(X[0].obj.focus=!0),ge=!0,ue=!0,z($))}function z($){if($.ctrlKey){de($.shiftKey?-1:1);return}$.shiftKey?b.tab(-1):b.tab(1),$.preventDefault()}var pe;this.tab=function($){if(clearTimeout(pe),_&&v.stage.removeChild(_),n($)&&($=1),X.length==0){de($);return}for(var Me=0;Me<X.length;Me++){var be=X[Me].obj;if(be.focus){be.focus=!1;var me=Me+$,re=(me+X.length*1e4)%X.length,ke=X[re];be=ke.obj;for(var Re=0,Ye=!1;!(be.stage&&(!be.zimTabParent&&(n(be.enabled)||be.enabled)||be.zimTabParent&&(n(be.zimTabParent.enabled)||be.zimTabParent.enabled)));)if(Re++,me=me+$,re=(me+X.length*100)%X.length,ke=X[re],be=ke.obj,Re==X.length){Ye=!0;break}if(Ye||!b.cycle&&me!=re&&!ge){de($);return}ge=!1,b.tabIndex=re;break}}};function de($){ue=!1,Cn(R+($==1?"SuffixTab":"PrefixTab")).focus(),v.stage.removeChild(E),v.stage.update(),b.tabIndex=-1}this.changeTitle=function($,Me,be){if(typeof $!="number"&&($=$.zimTabIndex),!n($)){if(be&&n(Me)){b.tabIndex=$;return}var me=X[$],re=me.obj;n(Me)&&(Me=re.zimTabTag.getAttribute("aria-label").split(" - currently")[0]),me.title=Me,ce(me),re.zimTabTag.setAttribute("aria-label",me.title),be&&(b.tabIndex=$)}};var oe=!1;this.talk=function($){oe||(c=q(R+"TalkTab","",D),c.setAttribute("role","alert"),oe=!0),c.removeAttribute("role"),c.setAttribute("aria-label",$),c.setAttribute("role","alert");var Me=new Fe.Event("change");Me.title=$,b.dispatchEvent(Me)},this.resize=function($){if(n($))for(var me=0;me<X.length;me++)re(X[me].obj);else{if(typeof $!="number"&&($=$.zimTabIndex),$<0)return;var Me=X[$],be=Me.obj;!be.stage&&_&&be==b.currentObject&&(v.stage.removeChild(_),v.stage.update()),re(be)}function re(ke){if(ke.type=="TextArea"||ke.type=="Loader"){ke.resize();return}else{var Re=ke.boundsToGlobal(),Ye=ke.zimTabTag;v.retina?(Ye.style.left=v.x+Re.x*v.scale/w+"px",Ye.style.top=v.y+Re.y*v.scale/w+"px",Ye.style.width=Re.width*v.scale/w+"px",Ye.style.height=Re.height*v.scale/w+"px"):(Ye.style.left=v.x+Re.x*v.scale/w/w+"px",Ye.style.top=v.y+Re.y*v.scale/w/w+"px",Ye.style.width=Re.width*v.scale/w/w+"px",Ye.style.height=Re.height*v.scale/w/w+"px")}Ye.setAttribute("aria-hidden",!ke.stage),Ye.hidden=!ke.stage}},Object.defineProperty(this,"currentObject",{get:function(){return X[Y]&&X[Y].obj?X[Y].obj:null},set:function($){for(var Me=0;Me<X.length;Me++)if(X[Me].obj==$){b.tabIndex=Me;break}}});var Be=!0;Object.defineProperty(this,"enabled",{get:function(){return Be},set:function($){Be=$}}),this.dispose=function(){P&&P.graphics.clear(),b.tabOrder=[];for(var $=0;$<m.length;$++)m[$].parentElement&&(m[$].outerHTML="");we(),b.removeAllEventListeners(),v.off("keydown",ie)}},t.extend(t.Accessibility,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),t.TextureActive=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C){var d="width, height, color, color2, angle, borderColor, borderWidth, corner, interactive, animated, backingOrbit, pattern, scalePattern, style, group, inherit",x;if(x=st(t.TextureActive,arguments,d,this))return x;De("35.2"),this.group=A;var P=E===!1?{}:t.getStyle("TextureActive",this.group,C);n(e)&&(e=P.width!=null?P.width:ee.zdf.width),n(r)&&(r=P.height!=null?P.height:ee.zdf.height),n(y)&&(y=P.interactive!=null?P.interactive:!0),n(k)&&(k=P.animated!=null?P.animated:!0),n(i)&&(i=P.color!=null?P.color:null),n(l)&&(l=P.color2!=null?P.color2:null),n(a)&&(a=P.angle!=null?P.angle:null),n(s)&&(s=P.borderColor!=null?P.borderColor:null),n(f)&&(f=P.borderWidth!=null?P.borderWidth:null),s<0||f<0?s=f=null:s!=null&&f==null&&(f=1),n(u)&&(u=P.corner!=null?P.corner:10),n(g)&&(g=P.backingOrbit!=null?P.backingOrbit:!0),n(O)&&(O=P.pattern!=null?P.pattern:null),n(T)&&(T=P.scalePattern!=null?P.scalePattern:null),this.zimPage_constructor(e,r,i,l,a,O,T,null,E,A,C),this.type="TextureActive",u&&(this.backing.corner=u),n(f)||(this.backing.borderWidth=f),n(s)||(this.backing.borderColor=s),(f||!n(s))&&(this.backing.siz(this.width-f,this.height-f),this.backing.center()),this.backing.mouseChildren=!1,this.interactive=y,this.animated=k,this.backingOrbit=g,E!==!1&&t.styleTransforms(this,P),this.clone=function(){return this.cloneProps(new t.TextureActive(e,r,i,l,a,s,f,u,y,k,g,O,T,E,this.group,C))}},t.extend(t.TextureActive,t.Page,["clone"],"zimPage",!1),t.TextureActive.makeLogo=function(e,r){n(e)&&(e="light");var i=e!="dark",l=i?t.light:t.dark,a=i?t.dark:t.light,s=i?t.white:t.black,f=i?t.black:t.white,u=new t.Container(400,100),y=ee.zdf.makeIcon(l,a,[l,l,l,l,l]).ske(0,30).scaleTo(u,100,100).center(u),k=new t.Rectangle((400-y.width)/2+4,80-10,new t.GradientColor([i?l:s,i?s:l,i?l:s],-70),f,.5).addTo(u),g=k.clone().pos(0,0,"right","bottom",u);return new t.Label({text:"Texture",size:50,color:a,variant:!0}).scaleTo(k,75,75).center(k),new t.Label({text:"Active",size:50,color:a,variant:!0}).scaleTo(k,72,72).center(g),r?u:u.noMouse()},t.TextureActive.makeBacking=function(e,r,i,l){n(e)&&(e=800),n(r)&&(r=600),n(i)&&(i="CANVAS WINDOW"),n(l)&&(l=t.light);var a=new t.Container(e,r);return a.icon=ee.zdf.makeIcon({box:black}).sca(2),a.label=new t.Label({text:i,size:25,color:l,align:"center"}).reg("center"),a.tile=new t.Tile({obj:[a.icon,a.label],rows:2,spacingV:24,unique:!0,align:CENTER}).scaleTo(a,50,70).center(a),a.tile.items[1].mov(0,10),a},t.TextureActives=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x){var P="actives, threejs, zimThree, renderer, scene, camera, controls, layers, near, far, ignoreList, toggleKey, color, outerColor, damp, style, group, inherit",v;if(v=st(t.TextureActives,arguments,P,this))return v;De("35.4"),this.group=d;var w=C===!1?{}:t.getStyle("TextureActives",this.group,x),b,X,Y="ZIM TextureActives - need a ZIM Frame";if(n(e)&&n(e[0]))if(ee.zdf)X=ee.zdf,b=ee.zdf.stage;else{tt(Y);return}else if(n(e)||n(e[0])||n(e[0].stage))if(ee.zdf)X=ee.zdf,b=ee.zdf.stage;else{tt(Y);return}else b=e[0].stage,X=b.frame;n(e)&&(e=w.actives!=null?w.actives:null),n(r)&&(r=w.threejs!=null?w.threejs:null),n(i)&&(i=w.zimThree!=null?w.zimThree:null),n(l)&&(l=w.renderer!=null?w.renderer:null),n(a)&&(a=w.scene!=null?w.scene:null),n(s)&&(s=w.camera!=null?w.camera:null),n(f)&&(f=w.controls!=null?w.controls:null),n(u)&&(u=w.layers!=null?w.layers:[]),Array.isArray(u)||(u=[u]),n(y)&&(y=w.near!=null?w.near:void 0),n(k)&&(k=w.far!=null?w.far:void 0),n(g)&&(g=w.ignoreList!=null?w.ignoreList:[]),Array.isArray(g)||(g=[g]),n(O)&&(O=w.toggleKey!=null?w.toggleKey:"t"),n(T)&&(T=w.color!=null?w.color:t.darker),n(E)&&(E=w.outerColor!=null?w.outerColor:"black"),n(A)&&(A=w.damp!=null?w.damp:null);var m=this;t.TAM||(t.TAM=new t.TextureActivesManager(b,O,A),l&&l.domElement&&l.domElement.addEventListener("mousedown",R=>{R.preventDefault()})),m.manager=t.TAM,this.ignoreList=g,this.raycast=!0,this.renderer=l,this.layers=u,this.animated=!1,this.interactive=!1,this.actives=[],this.threeMeshes=[];var j=!1;function S(R){n(R)&&(R=[]),Array.isArray(R)||(R=[R]);var U=0,Z,K;return t.loop(R,function(ne){m.actives.indexOf(ne)<0&&(m.actives.push(ne),ne.cache(),ne.canvas.content=ne,ne.interactive&&(Z=!0,ne.canvas.isTextureActive=!0),ne.animated&&(K=!0),U++)}),Z&&!m.interactive&&(m.interactive=!0,U>0&&_()),K&&!m.animated&&(m.animated=!0),U}S(e),t.TAM.updateTile(m,m.actives),t.TAM.color=T,t.TAM.outerColor=E,X.canvas.style.display="none";function _(){if(j)return;j=!0,m.pointerCheck||(m.pointerCheck=t.TAM.addPointer(m)),m.pointerData={x:X.mouseX,y:X.mouseY,mousedown:!1};var R=window.innerWidth,U=window.innerHeight,Z=-1,K=-2,ne=-1,V=-2;m.overInterval=t.interval(.05,function(){if(K&&K!=Z||V&&V!=ne){var G=new Fe.Event("rayover");G.mesh=m.mesh=K,G.material=m.material=V,V.userData&&(G.textureActive=m.textureActive=V.userData.ta_content),G.intersect=m.intersect,m.dispatchEvent(G),f&&!f.screenSpacePanning&&(f.activeLook=!1)}else if(!K&&Z||!V&&ne){var G=new Fe.Event("rayout");G.mesh=Z,G.material=ne,ne.userData&&(G.textureActive=ne.userData.ta_content),G.intersect=m.intersect,m.dispatchEvent(G),f&&!f.screenSpacePanning&&(f.activeLook=!0)}Z=K,ne=V});var D=m.raycaster=new r.Raycaster(void 0,void 0,y,k);u.length>0&&t.loop(u,function(G){D.layers.set(G)});var c,h;m.XR=ee.XR=!1;var o=new r.Matrix4;let I=m.controllerLeft=l.xr.getController(0);I.addEventListener("selectstart",p),I.addEventListener("selectend",L),I.addEventListener("move",we);let N=m.controllerRight=l.xr.getController(1);N.addEventListener("selectstart",B),N.addEventListener("selectend",F),N.addEventListener("move",fe);function p(G){h=!0,Q(G)}function L(G){h=!0,le(G)}function we(G){h=!0,J(G,"left")}function B(G){h=!0,Q(G)}function F(G){h=!0,le(G)}function fe(G){h=!0,J(G,"right")}window.addEventListener("pointerdown",se);function se(G){h=!1,Q(G)}function Q(G){if(m.raycast){if(h){var ce=G.target;o.identity().extractRotation(ce.matrixWorld),D.ray.origin.setFromMatrixPosition(ce.matrixWorld),D.ray.direction.set(0,0,-1).applyMatrix4(o),G.data&&G.data.handedness=="left"?G.pointerId=2:G.pointerId=1}else{var q;!i||i.resizeEvent?q={x:G.clientX/window.innerWidth*2-1,y:1-G.clientY/window.innerHeight*2}:q={x:G.clientX/R*2-1,y:1-G.clientY/U*2},D.setFromCamera(q,s)}var ue=D.intersectObjects(a.children);c=null;var ge,ie,xe;for(ie=0;ie<ue.length;ie++)if(ge=ue[ie].object,!(m.ignoreList.indexOf(ge)>-1)){if(m.threeMeshes.indexOf(ge)>-1)if(ge.material&&Array.isArray(ge.material))xe=ge.material[ue[ie].face.materialIndex];else if(ge.material)xe=ge.material;else break;if(xe&&xe.map&&xe.map.source&&xe.map.source.data&&xe.map.source.data.isTextureActive&&xe.userData.ta_content){c=ge;var Se=xe.userData.ta_content;if(m.pointerData.mousedown=!0,Te(Se,ue[ie],xe.userData.ta_flipped),Fe.handleRemotePointer(m.pointerData.x,m.pointerData.y,"down",G,b,G.pointerId),f&&f.maxAzimuthAngle&&Se)if(Se.backingOrbit){var z=Se.globalToLocal(X.mouseX,X.mouseY),pe=Se.backing;pe&&Se.getObjectUnderPoint(z.x,z.y,1)!=pe?f.enableRotate=!1:f.enableRotate=!0}else f.enableRotate=!1;var de=new Fe.Event("raydown");de.mesh=m.mesh=ge,de.material=m.material=xe,de.textureActive=m.textureActive=Se,de.intersect=m.intersect=ue[ie],m.dispatchEvent(de);break}else break}}}window.addEventListener("pointerup",te);function te(G){h=!1,le(G)}function le(G){if(m.raycast){if(m.pointerData.mousedown=!1,f&&f.maxAzimuthAngle&&(f.enableRotate=!0),c){var ce=new Fe.Event("rayup");ce.mesh=m.mesh,ce.material=m.material,ce.textureActive=m.textureActive,ce.intersect=m.intersect,m.dispatchEvent(ce)}c=null,h&&(G.data&&G.data.handedness=="left"?G.pointerId=2:G.pointerId=1),Fe.handleRemotePointer(null,null,"up",G,b,G.pointerId)}}window.addEventListener("pointermove",Ae);function Ae(G){h=!1,J(G)}function J(G,ce){if(m.raycast){if(h){var q=G.target;o.identity().extractRotation(q.matrixWorld),D.ray.origin.setFromMatrixPosition(q.matrixWorld),D.ray.direction.set(0,0,-1).applyMatrix4(o),ce=="left"?G.pointerId=2:G.pointerId=1}else{var ue;!i||i.resizeEvent?ue={x:G.clientX/window.innerWidth*2-1,y:1-G.clientY/window.innerHeight*2}:ue={x:G.clientX/R*2-1,y:1-G.clientY/U*2},D.setFromCamera(ue,s)}var ge=!1,ie,xe,Se;if(c){let oe=D.intersectObject(c);if(oe.length>0&&(ie=c,ie.material&&Array.isArray(ie.material)?Se=ie.material[oe[0].face.materialIndex]:ie.material&&(Se=ie.material),Se)){var z=Se.userData.ta_content;Te(z,oe[0],Se.userData.ta_flipped),Fe.handleRemotePointer(m.pointerData.x,m.pointerData.y,"move",G,b,G.pointerId),ge=!0;var pe=new Fe.Event("raymove");pe.mesh=K=m.mesh=ie,pe.material=V=m.material=Se,pe.textureActive=m.textureActive=z,pe.intersect=m.intersect=oe[0],m.dispatchEvent(pe)}}else{var de=D.intersectObjects(a.children);for(xe=0;xe<de.length;xe++)if(ie=de[xe].object,!(m.ignoreList.indexOf(ie)>-1)){if(m.threeMeshes.indexOf(ie)>-1)if(ie.material&&Array.isArray(ie.material))Se=ie.material[de[xe].face.materialIndex];else if(ie.material)Se=ie.material;else break;if(Se&&Se.map&&Se.map.source&&Se.map.source.data&&Se.map.source.data.isTextureActive&&Se.userData.ta_content){var z=Se.userData.ta_content;Te(z,de[xe],Se.userData.ta_flipped),Fe.handleRemotePointer(m.pointerData.x,m.pointerData.y,"move",G,b,G.pointerId),ge=!0;var pe=new Fe.Event("raymove");pe.material=V=m.material=Se,pe.mesh=K=m.mesh=ie,pe.textureActive=m.textureActive=z,pe.intersect=m.intersect=de[xe],m.dispatchEvent(pe);break}else break}}ge||(K=null,V=null),t.TAM.setActive(m,ge)}}function Te(G,ce,q){if(!(!G||!G.getBounds)){var ue=G.getBounds(),ge=q?ue.width-ce.uv.x*ue.width:ce.uv.x*ue.width,ie=(1-ce.uv.y)*ue.height,xe=G.localToGlobal(ge,ie);m.pointerData.x=xe.x,m.pointerData.y=xe.y}}}this.add=function(R){var U=S(R);return U>0&&t.TAM.updateTile(m,m.actives),m},this.remove=function(R){n(R)&&(R=[]),Array.isArray(R)||(R=[R]);var U=0;return t.loop(R,function(Z){if(Fe.remoteQueue){var K=Fe.remoteQueue.indexOf(Z);K>=0&&Fe.remoteQueue.splice(K,1)}K=m.actives.indexOf(Z),K>=0&&(m.actives.splice(K,1),U++),Z.textureMap&&delete Z.textureMap.userData.ta_content,K=m.threeMeshes.indexOf(Z),K>=0&&m.threeMeshes.splice(K,1),Z.dispose()},!0),U>0&&t.TAM.updateTile(m,m.actives),m},m.addMesh=function(R,U){if(n(U)||R.layers.enable(U),R.material){var Z=m.threeMeshes.indexOf(R);if(Z<0)m.threeMeshes.push(R);else return m;var K;Array.isArray(R.material)?K=R.material:K=[R.material],R.onBeforeRender=function(){R.userData.ta_viewID&&clearTimeout(R.userData.ta_viewID),R.userData.ta_viewID=setTimeout(function(){R.userData.ta_view=!1,Fe.remoteQueue&&t.loop(R.userData.ta_content,function(ne){var V=Fe.remoteQueue.indexOf(ne);V>=0&&Fe.remoteQueue.splice(V,1)},!0)},100),R.userData.ta_view||(R.userData.ta_view=!0,t.loop(R.userData.ta_content,function(ne){Fe.remoteQueue.indexOf(ne)<0&&Fe.remoteQueue.push(ne)}))},R.userData.ta_content=[],t.loop(K,function(ne){if(ne&&ne.map&&ne.map.source&&ne.map.source.data&&ne.map.source.data.content){var V=ne.map.source.data.content;R.userData.ta_content.push(V),V.mesh=R,R.textureActive=!0,ne.userData.ta_content=V,V.textureMaps||(V.textureMaps=[]);var D=V.textureMaps.indexOf(ne.map);D<0&&V.textureMaps.push(ne.map),(V.animated||V.interactive)&&(Fe.remoteQueue||(Fe.remoteQueue=[]))}})}return m},m.dispose=function(){m.raycast=!1,f&&(f.enableRotate=!0,f.enabled=!0),m.remove(m.actives),t.TAM.remove(m),t.TAM.count<1&&(t.TAM.dispose(),t.TAM=null),m.material=m.mesh=m.content=m.intersect=null}},t.extend(t.TextureActives,Fe.EventDispatcher,"dispose"),t.TextureActivesManager=function(e,r,i){De("35.6");var l=this;this.type="TextureActivesManager",l.color=t.darker,l.outerColor="black";var a=!1;l.toggleKey=r||"t",(n(i)||i===!0)&&(i=.2);var s=l.objects=new t.Dictionary(!0),f=e.frame,u=new t.Proportion({baseMin:1e3,baseMax:9e3,targetMin:-.1,targetMax:-.05,clamp:!1});l.backing=new t.Rectangle(100,100,t.faint).addTo(e,0);var y=[];l.updateTile=function(x,P,v){v||s.add(x,P);var w=[];if(y=[],t.loop(s,function(X,Y){t.loop(Y,function(m){w.push(m),m.loop(function(j){(j.type=="Scrambler"||j.type=="List"||j.type=="Window")&&y.push(j)})})}),w.length<0){var b=l.message=new t.Rectangle(W,H,t.yellow);new t.Label("No TextureActives Added").center(b),w.push(b)}l.tile?(l.tile.cols=w.length,l.tile.remake(w)):l.tile=new t.Tile(w,w.length,1,20,0,!0).addTo(e),l.backing.scaleTo(l.tile,100,100,"full").siz(null,e.height,!0),l.swiper&&(l.swiper.sensitivity=t.constrain(u.convert(l.tile.width),-.1,-.01))},this.addPointer=function(x){var P=[];return t.loop(s,function(v){P.indexOf(v.renderer.domElement)<0&&P.push(v.renderer.domElement)}),P.indexOf(x)<0&&P.push(x.renderer.domElement),Fe.remotePointers?Fe.remotePointers=P:Fe.addRemotePointers(e,P),!0},this.setActive=function(x,P){if(x.active=P,!P){var v=t.loop(s,function(w){if(w.active)return!1});v&&(e.mouseInBounds=!1)}};var k=!1,g=this.nav=new t.Panel({width:200,height:80,titleBar:"TextureActives",draggable:!0,close:!0}).pos(50,50,RIGHT,BOTTOM),O=this.slider=new t.Slider({min:0,max:100,damp:!0}).scaleTo(g,80);O.on("mousedown",function(){k=!0,l.swiper.enabled=!1,E()}),O.on("pressup",function(){l.swiper.immediate(O.currentValue),l.swiper.enabled=!0,A(),k=!1}),g.on("close",function(){l.hide(),g.addTo()});var T=0;this.ticker=t.Ticker.add(function(){l.tile.x=-O.currentValue*(l.tile.width-W)/100,a&&!k&&T!=0&&T!=100&&(O.currentValue==0||O.currentValue==100)&&A(),T=O.currentValue}),g.add(O,0,!0),g.removeFrom(),t.Ticker.remove(l.ticker);function E(){a||(a=!0,t.loop(y,function(x){x.enabled=!1}))}function A(){a&&(a=!1,t.loop(y,function(x){x.enabled=!0,x.update()}))}l.swiper=new t.Swiper({swipeOn:l.backing,target:O,property:"currentValue",sensitivity:l.tile?t.constrain(u.convert(tile.width),-.1,-.01):-.1,damp:i}),l.backing.on("mousedown",function(){T=-100,E()}),l.swiper.on("swipestop",A),l.toggled=!1;var C=f.color,d=f.outerColor;this.show=function(){if(!l.toggled)return f.color=l.color,f.outerColor=l.outerColor,l.toggled=!0,t.Ticker.add(l.ticker),g.addTo(),t.loop(s,function(x){x.lastRaycast=x.raycast,x.raycast=!1,x.renderer.domElement.style.display="none"}),Fe.remoteQueue&&t.loop(l.tile.items,function(x){Fe.remoteQueue.indexOf(x)<0&&Fe.remoteQueue.push(x)}),f.canvas.style.display="block",Fe.removeRemotePointers(e),this},this.hide=function(){if(l.toggled){f.color=C,f.outerColor=d,l.toggled=!1,t.Ticker.remove(l.ticker),g.removeFrom();var x=[];return t.loop(s,function(P){P.raycast=P.lastRaycast,P.renderer.domElement.style.display="block",x.push(P.renderer.domElement)}),Fe.remoteQueue&&(Fe.remoteQueue=[],t.loop(l.tile.items,function(P){P.mesh&&(P.mesh.userData.ta_view=!1)})),f.canvas.style.display="none",Fe.addRemotePointers(e,x),this}},l.toggle=function(x){return n(x)&&(x=!l.toggled),x&&!l.toggled?l.show():!x&&l.toggled&&l.hide(),this},l.keyEvent=f.on("keydown",function(x){x.key==l.toggleKey&&(l.toggled?l.hide():l.show())}),l.remove=function(x){s.remove(x),l.updateTile(null,null,!0)},l.dispose=function(){l.hide(),g.dispose(),f.off("keydown",l.keyEvent),l.backing.removeAllEventListeners(),l.backing.dispose(),l.objects.dispose(),l.tile.dispose(),l.objects=l.tile=g=null}},t.extend(t.TextureActivesManager,Fe.EventDispatcher),t.Manager=function(e){De("75");var r=this;this.type=e,this.items=[],this.add=function(a){return Array.isArray(a)?r.items=r.items.concat(a):r.items.push(a),r};var i,l;this.remove=function(a){if(r){if(!a)r.items=[];else for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--){l=a[i];var s=r.items.indexOf(l);s!=-1&&r.items.splice(s,1)}return r}},this.resize=function(a){if(r){if(a)for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--)l=a[i],!l.resize&&r.items.indexOf(l)!=-1?r.items.splice(r.items.indexOf(l),1):l.resize();else for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].resize():r.items.splice(i,1);return r}},this.toggle=function(a,s){if(r){if(s)for(Array.isArray(s)||(s=[s]),f=s.length-1;f>=0;f--)l=s[f],!l.resize&&r.items.indexOf(l)!=-1?r.items.splice(r.items.indexOf(l),1):l.toggle(a);else for(var f=r.items.length-1;f>=0;f--)r.items[f].resize?r.items[f].toggle(a):r.items.splice(f,1);return r}},this.dispose=function(a){if(r){if(r.resize=null,a)for(Array.isArray(a)||(a=[a]),i=a.length-1;i>=0;i--)l=a[i],r.items.indexOf(l)!=-1&&r.items.splice(r.items.indexOf(l)),l.dispose&&l.dispose();else{for(i=r.items.length-1;i>=0;i--)r.items[i].resize?r.items[i].dispose():r.items.splice(i,1);r.items=null}return!0}}},t.ResizeManager=function(){De("75.5"),t.Manager.call(this,"ResizeManager")},t.ResizeManager.prototype=new t.Manager,t.ResizeManager.prototype.constructor=t.ResizeManager,t.TransformManager=function(e,r){De("75.7");var i=this;this.type="TransformManager",this.persistID=r,this.items=[];function l(s){!localStorage||s&&!s.pressup||i.savePersist(s)}this.add=function(s){var f=[];Array.isArray(s)?f=s:f=[s];for(var u,y=!1,k=0;k<f.length;k++)if(u=f[k],u.transformControls&&(u.originalVisible=u.transformControls.visible),u.toggle&&u.toggle(!1),i.items.length==0&&k==0&&(y=!0),u.type=="Blob"||u.type=="Squiggle")i.persistID||y&&(y=!1,u.controlsVisible=!0,i.currentObject=u),u.on("change",function(O){var T=new Fe.Event("transformed");T.transformObject=O.target,T.transformType=O.controlType,i.dispatchEvent(T)}),u.on("controlsshow",function(O){var T=new Fe.Event("transformshow");i.currentObject=T.transformObject=O.target,i.dispatchEvent(T)}),u.on("controlshide",function(O){var T=new Fe.Event("transformhide");T.transformObject=O.target,i.currentObject=null,i.dispatchEvent(T)}),u.on("update",function(O){var T=new Fe.Event("transformed");T.transformObject=O.target,T.transformType=O.controlType,i.dispatchEvent(T)});else if(u.type=="Connectors")i.persistID||y&&(y=!1,i.currentObject=u),u.on("connection",function(O){var T=new Fe.Event("transformed");T.transformObject=O.target,T.transformType="connection",i.dispatchEvent(T)});else if(u.type=="Pack")i.persistID||y&&(y=!1,i.currentObject=u),u.on("change",function(O){var T=new Fe.Event("transformed");T.transformObject=O.target,T.transformType="change",i.dispatchEvent(T)});else{var g=u.transformControls;i.persistID||y&&u.type!="Layer"&&(y=!1,u.originalVisible&&(g.show(),i.currentObject=u)),u.on("transformed",function(O){var T=new Fe.Event("transformed");T.transformObject=O.target,T.transformType=O.transformType,i.dispatchEvent(T)}),u.on("transformshow",function(O){var T=new Fe.Event("transformshow");i.currentObject=T.transformObject=O.target,i.dispatchEvent(T)}),u.on("transformhide",function(O){var T=new Fe.Event("transformhide");T.transformObject=O.target,i.currentObject=null,i.dispatchEvent(T)})}i.items=i.items.concat(s),i.persist&&!n(i.persistID)&&i.persist(i.persistID)},this.remove=function(s){if(n(s)){i.items=[];return}Array.isArray(s)||(s=[s]);for(var f,u=0;u<s.length;u++){f=s[u],i.currentObject==f&&(i.currentObject=null),f.transformedEvent&&(f.off("transformed",f.transformedEvent),f.transformedEvent=null),f.type=="Blob"||f.type=="Squiggle"?f.controlsVisible=!1:f.transformControls&&f.transformControls.remove();var y=i.items.indexOf(f);y!=-1&&i.items.splice(y,1)}r&&i.savePersist()},this.show=function(s){if(!n(s)){if(s.type=="Blob"||s.type=="Squiggle")s.controlsVisible||(s.controlsVisible=!0);else{var f=s.transformControls;if(!f||f.visible)return;f.show()}i.currentObject=s}},this.hide=function(s){if(!n(s))if(i.currentObject==s&&(i.currentObject=null),s.type=="Blob"||s.type=="Squiggle")s.controlsVisible&&(s.controlsVisible=!1);else{var f=s.transformControls;if(!f||f.visible)return;f.hide()}},this.hideAll=function(s){for(var f,u,y=0;y<i.items.length;y++)if(u=i.items[y],!u||!(u.transformControls||u.update))i.items.splice(y);else{if(i.items[y]==s)continue;u.type=="Blob"||u.type=="Squiggle"?u.controlsVisible&&(u.controlsVisible=!1):(f=i.items[y].transformControls,f.visible&&f.hide())}i.currentObject=null},this.resize=function(){if(i){for(var s,f=0;f<i.items.length;f++)s=i.items[f],!s||!(s.transformControls||s.update)?i.items.splice(f):s.type=="Blob"||s.type=="Squiggle"?s.update():s.transformControls.resize();r&&i.savePersist()}},n(e)||i.add(e);var a="TransformManager persist(persistID) - sorry, must provide id";this.persist=function(s){var f,u;if(n(s)&&vt){tt(a);return}i.persistID=s;var y=0;if(localStorage&&localStorage[s]){var k=i.persistData=JSON.parse(localStorage[s]);if(k.length==i.items.length)for(u=0;u<i.items.length;u++)k[u].controls&&(i.currentObject=i.items[u]),k[u]&&(k[u].type=="Blob"||k[u].type=="Squiggle")?(i.items[u].points.length!=k[u].points.length&&(i.items[u].points=k[u].points),i.items[u].setData(k[u]),i.items[u]==i.currentObject&&i.currentObject.toggle(!0),y++,y==k.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):k[u]&&k[u].type=="Connectors"?(i.items[u].setSteps(k[u].steps),i.items[u].loc(k[u].x,k[u].y),i.items[u].sca(k[u].scale),y++,y==k.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):k[u]&&k[u].type=="Pack"?(i.items[u].setOrder(k[u].order),i.items[u].outerWidth=k[u].outerWidth,i.items[u].outerHeight=k[u].outerHeight,y++,y==k.length&&setTimeout(function(){i.dispatchEvent("persistcomplete")},100)):k[u]&&(n(i.items[u].transformControls)?-function(){var g=f=i.items[u],O=k[u];t.interval(50,function(T){g.transformControls&&(g.transformControls.setData(O),g.dispatchEvent("persistset"),y++,y==k.length&&(setTimeout(function(){g==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),T.clear()))},20,null,null,"ms")}():(i.items[u].transformControls.setData(k[u]),-function(){var g=f=i.items[u];t.interval(50,function(O){g.dispatchEvent("persistset"),y++,y==k.length&&(setTimeout(function(){g==i.currentObject&&i.currentObject.toggle(!0),i.dispatchEvent("persistcomplete")},100),O.clear())},20,null,null,"ms")}()))}for(u=0;u<i.items.length;u++)f=i.items[u],f.transformedEvent||(f.type=="Blob"||f.type=="Squiggle"?(f.transformedEvent=f.on("change",function(g){g.pressup=!0,l(g)}),f.transformedUEvent=f.on("update",function(g){g.pressup=!0,l(g)}),f.transformedSEvent=f.on("controlsshow",function(g){g.pressup=!0,l(g)}),f.transformedHEvent=f.on("controlshide",function(g){g.pressup=!0,l(g)})):f.type=="Connectors"?f.transformedEvent=f.on("connection",function(g){g.pressup=!0,l(g)}):f.type=="Pack"?f.transformedEvent=f.on("change",function(g){g.pressup=!0,l(g)}):(f.transformedEvent=f.on("transformed",l),f.transformedSEvent=f.on("transformshow",l),f.transformedHEvent=f.on("transformhide",l)))},this.savePersist=function(){for(var s=[],f=0;f<i.items.length;f++){var u=i.items[f];u.type=="Blob"||u.type=="Squiggle"?u.recordData&&s.push(u.recordData()):u.type=="Connectors"?s.push({type:u.type,x:u.x,y:u.y,scale:u.scale,steps:u.getSteps()}):u.type=="Pack"?s.push({type:u.type,outerWidth:u.outerWidth,outerHeight:u.outerHeight,order:u.getOrder()}):u.transformControls&&u.transformControls.recordData&&s.push(u.transformControls.recordData())}i.persistData=s,localStorage[i.persistID]=JSON.stringify(s)},this.clearPersist=function(s){if(n(s)&&vt){tt(a);return}i.persistData=null,localStorage&&localStorage.removeItem(s)},this.stopPersist=function(){for(var s=0;s<i.items.length;s++){var f=i.items[s];f.transformedEvent&&(f.type=="Blob"||f.type=="Squiggle"?(f.off("change",f.transformedEvent),f.off("update",f.transformedUEvent),f.off("controlsshow",f.transformedSEvent),f.off("controlshide",f.transformedHEvent)):f.type=="Connectors"?f.off("connection",f.transformedEvent):f.type=="Pack"?f.off("change",f.transformedEvent):(f.off("transformed",f.transformedEvent),f.off("transformshow",f.transformedSEvent),f.off("transformhide",f.transformedHEvent)),f.transformedEvent=null,f.transformedUEvent=null,f.transformedSEvent=null,f.transformedHEvent=null)}i.persistData=null},n(r)||i.persist(r),this.dispose=function(s,f){if(n(s)&&(s=!0),i.removeAllEventListeners(),i.persistID&&s&&i.stopPersist(),f)for(var u=0;u<i.items.length;u++){var y=i.items[u];y.type=="Blob"||y.type=="Squiggle"?y.dispose():y.transformControls.dispose()}}},t.extend(t.TransformManager,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),t.GuideManager=function(){De("77"),t.Manager.call(this,"GuideManager")},t.GuideManager.prototype=new t.Manager,t.GuideManager.prototype.constructor=t.GuideManager,t.GridManager=function(){De("79"),t.Manager.call(this,"GridManager")},t.GridManager.prototype=new t.Manager,t.GridManager.prototype.constructor=t.GridManager,t.LayoutManager=function(){De("81"),t.Manager.call(this,"LayoutManager")},t.LayoutManager.prototype=new t.Manager,t.LayoutManager.prototype.constructor=t.LayoutManager,t.SelectionSet=function(e){De("81.5"),this.type="SelectionSet",n(e)&&(e=[]),this.selections=e,this.clear=function(){this.selections=[]},this.isSelected=function(r){return this.selections.indexOf(r)>=0},this.add=function(r,i,l,a){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear();var s=this.selections.indexOf(r);if(!(s>=0)){if(this.selections.push(r),!n(l)){Array.isArray(l)||(l=[l]);for(var f=0;f<=l.length;f++)l[f].add(r,i)}if(!n(a))for(Array.isArray(a)||(a=[a]),f=0;f<=a.length;f++)a[f].remove(r,i)}}},this.remove=function(r,i,l,a){if(!n(r)){n(i)&&(n(this.selectionManager)||(i=this.selectionManager.multiple)),n(this.selectionManager)||this.selectionManager.setCurrent(this),i||this.clear();var s=this.selections.indexOf(r);if(n(this.selectionManager)||(this.selectionManager.setCurrent(this),!i&&this.selectionManager.multipleSets&&this.selectionManager.clear()),i||this.clear(),i?s>=0&&this.selections.splice(s,1):this.clear(),!n(l)){Array.isArray(l)||(l=[l]);for(var f=0;f<=l.length;f++)l[f].remove(r,i)}if(!n(a))for(Array.isArray(a)||(a=[a]),f=0;f<=a.length;f++)a[f].add(r,i)}},this.toggle=function(r,i,l,a){this.isSelected(r)?this.remove(r,i,l,a):this.add(r,i,l,a)},this.dispose=function(){return this.clear(),this.selections=null,!0}},t.SelectionManager=function(e,r,i){De("81.6"),this.cjsEventDispatcher_constructor(),this.type="SelectionManager",n(e)&&(e=[]),n(i)&&(i=!0),Array.isArray(e)||(e=[e]),this.sets=e,this.multipleKey=r,this.multipleSets=i,this.multiple=!1;for(var l=this,a=0;a<e.length;a++)e[a].selectionManager=this;this.clear=function(){this.currentSet=null;for(var f=0;f<e.length;f++)e[f].clear()},this.setCurrent=function(f){this.currentSet=f;for(var u=0;u<e.length;u++)e[u]!=f&&(this.multipleSets||e[u].clear())};var s=new Fe.Event("keydown");this.eventRemove=s.remove,this.keydownEvent=function(f){f.remove=l.eventRemove,l.multipleKey&&(l.multiple=f[l.multipleKey+"Key"]),l.ctrlKey=f.ctrlKey,l.shiftKey=f.shiftKey,l.metaKey=f.metaKey,l.dispatchEvent(f),f.keyCode==90&&(l.ctrlKey||l.metaKey)&&l.dispatchEvent("undo")},ee.addEventListener("keydown",this.keydownEvent),this.keyupEvent=function(f){l.multipleKey&&(l.multiple=f[l.multipleKey+"Key"]),l.ctrlKey=f.ctrlKey,l.shiftKey=f.shiftKey,l.metaKey=f.metaKey,f.remove=l.eventRemove,l.dispatchEvent(f)},ee.addEventListener("keyup",this.keyupEvent),this.dispose=function(){this.clear(),ee.removeEventListener("keydown",this.keydownEvent),ee.removeEventListener("keyup",this.keyupEvent)}},t.extend(t.SelectionManager,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),typeof mt>"u")var mt;t.Bind=function(e,r,i,l,a,s,f,u){var y="connection, bindType, master, masterFilter, couple, smartDecimals, report, setDefault",k;if(k=st(t.Bind,arguments,y,this))return k;De("81.8"),this.type="Bind";var g=this;n(e)&&localStorage&&n(mt)&&(n(r)||r==t.LOCALSTORAGE)?(e="zimBind",r=t.LOCALSTORAGE):e&&e.match(/\/|\./)?(n(r)&&(r=t.GET),e.match(/\?/)?e+="&":e+="?"):e&&n(r)&&(r=t.LOCALSTORAGE),n(s)&&(s=!0),r==t.LOCALSTORAGE&&!localStorage&&(vt&&tt("Bind() - no localStorage"),g.error="error - no localStorage"),this.connection=e,this.bindType=r,this.master=i,this.masterFilter=l,this.smartDecimals=s,n(f)&&(f=!1),(!mt||u)&&(mt=this),Object.defineProperty(g,"default",{get:function(){return g==mt},set:function(d){!d&&mt==g?mt=null:d&&(mt=g)}}),this.bindType==t.POST&&(g.ajax=new t.Ajax),this.bindings={},this.ids=[],this.data={},this.objIDs=new t.Dictionary(!0),this.toIDs={},this.fromIDs={},this.add=function(d,x,P,v,w){if(n(P)||n(x)||n(d))return g;if(g.bindings[d]){if(g.bindings[d].obj!=x)return vt&&tt("Bind() - id can be used with only one object"),g}else{g.ids.indexOf(d)<=0&&g.ids.push(d),g.bindings[d]={obj:x,props:[]},!n(w)&&typeof w=="function"&&(g.bindings[d].filter=w);var b=g.objIDs.at(x);b?b.indexOf(d)<0&&b.push(d):g.objIDs.add(x,[d])}!Array.isArray(P)&&P.constructor!={}.constructor&&(P=[P]);var X=g.bindings[d].props;Array.isArray(P)?t.loop(P,function(m){Y(g.toIDs,m,d),Y(g.fromIDs,m,d),X.indexOf(m)<0&&X.push(m)}):t.loop(P,function(m,j){(j==t.BOTH||j==t.TO)&&Y(g.toIDs,m,d),(j==t.BOTH||j==t.FROM)&&Y(g.fromIDs,m,d),X.indexOf(m)<0&&X.push(m)});function Y(m,j,S){n(m[j])?m[j]=[S]:m[j].indexOf(S)<0&&m[j].push(S)}return f&&C("Bind Report: ADD ["+d+"]",(P?" "+P:"")+(v?" "+v:"")),g.bindType==t.LOCALSTORAGE?(g.from(null,d,P,v),(!g.data||t.isEmpty(g.data))&&g.to(d,P)):(E("bind",null,[w],g.data,v),g.applyData()),g},this.updatefilter=function(d,x){var P=g.bindings[d];return P&&(n(x)?P.filter&&delete P.filter:typeof x=="function"&&(P.filter=x)),g},this.remove=function(d,x,P,v,w,b){var X;if(!n(d)&&!Array.isArray(d)&&(d=[d]),!n(d)){X=[];var Y=[];t.loop(d,function(ne){typeof ne=="string"?X.push(ne):Y.push(ne)})}!n(x)&&!Array.isArray(x)&&(x=[x]),n(w)&&(w=!0),d=X.concat(Y),d.length==0&&(d=null);var m=O("from",d,x,!1),j=m[0];m=m[1];var S=E("remove",v,j,m,P);if(S=="stop")return;var _=t.copy(m);n(x)||x.length==0?(X.length>0&&t.loop(X,function(ne){K(ne,!0)}),Y.length>0&&t.loop(Y,function(ne){X=g.objIDs.at(ne),X.length>0&&t.loop(X,function(V){K(V,!1)}),g.objIDs.remove(ne)})):(X=[],t.loop(m,function(ne,V){var D=g.bindings[ne],c=D.props;t.loop(V,function(h){var o=c.indexOf(h);o>=0&&c.splice(o,1),Z(h,ne)}),c.length==0&&X.push(ne)}),X.length>0&&g.remove(X));function R(ne){b&&typeof b=="function"&&(a&&(ne=t.couple(ne)),b(ne)),f&&C("Bind Report: REMOVE"+(P?" ["+P+"]":""),ne)}if(w){var U="type="+g.bindType+"&";g.bindType==t.LOCALSTORAGE?(g.to(),R("success")):g.bindType==t.GET?(S=JSON.stringify(_),a&&(S=t.couple(S)),t.async(g.connection+U+"remove="+S,R,"callbackRemove")):g.bindType==t.POST?g.ajax.post(g.connection+U,_,R,"remove"):g.bindType==t.SOCKET}function Z(ne,V){var D,c;D=g.fromIDs[ne],D&&(c=D.indexOf(V),c>=0&&D.splice(c,1),D.length==0&&delete g.fromIDs[ne]),D=g.toIDs[ne],D&&(c=D.indexOf(V),c>=0&&D.splice(c,1),D.length==0&&delete g.toIDs[ne])}function K(ne,V){var D=g.bindings[ne].obj,c=g.bindings[ne].props,h=g.objIDs.at(D),o=h.indexOf(ne);o>=0&&h.splice(o,1),V&&h.length==0&&Y.push(D),o=g.ids.indexOf(ne),o>=0&&g.ids.splice(o,1),t.loop(c,function(I){Z(I,ne)}),delete g.bindings[ne]}return g};function O(d,x,P){var v=[],w;if(n(x)&&n(P)){if(d=="from"&&g.bindType!=t.LOCALSTORAGE)return t.loop(g.bindings,function(m){m.filter&&v.push(m.filter)}),[v,"full"];w=g.ids}else!n(x)&&!Array.isArray(x)&&(x=[x]),!n(P)&&!Array.isArray(P)&&(P=[P]),x&&(w=[],t.loop(x,function(m){if(typeof m=="string")w.indexOf(m)<0&&w.push(m);else{var j=g.objIDs.at(m);j&&t.loop(j,function(S){w.indexOf(S)<0&&w.push(S)})}}));var b={};return w?X(P):P&&Y(),[v,b];function X(m){t.loop(w,function(j){var S=g.bindings[j];if(S){S.filter&&v.push(S.filter);var _=S.obj;t.loop(m||S.props,function(R){var U=g.toIDs[R];if(U&&U.indexOf(j)>=0)if(d=="from")b[j]||(b[j]=[]),b[j].push(R);else{b[j]||(b[j]={});var Z=_[R];typeof Z=="number"&&g.smartDecimals&&(Z>1?Z=t.decimals(Z,1):Z=t.decimals(Z,2)),b[j][R]=t.copy(Z)}})}})}function Y(){var m=[];t.loop(P,function(j){t.loop(g.toIDs[j],function(S){var _=g.bindings[S];m.indexOf(S)<0&&(_.filter&&v.push(_.filter),m.push(S));var R=_.obj;if(d=="from")b[S]||(b[S]=[]),b[S].push(j);else{b[S]||(b[S]={});var U=R[j];typeof U=="number"&&g.smartDecimals&&(U>1?U=t.decimals(U,1):U=t.decimals(U,2)),b[S][j]=t.copy(U)}})})}}this.stopProcess=!1,this.stop=function(){g.stopped=!0};var T=function(){var d=this;d.stop=function(){d.stopped=!0}};function E(d,x,P,v,w){var b=new T,X=v!=null&&!t.isEmpty(v)&&g.data;if(A(b,w))return["stop",v];g.masterFilter&&typeof g.masterFilter=="function"&&(v=g.data=g.masterFilter(v,d,w,b));var Y=t.loop(P,function(m){if(typeof m=="function"){if(A(b,w))return"stop";v=g.data=m(v,d,w,b)}});return Y=="stop"||A(b,w)?["stop",v]:(x&&typeof x=="function"&&(v=g.data=x(v,d,w,b)),A(b,w)?["stop",v]:(X&&!g.data&&vt&&tt("Bind()"+(d?" ["+d+"]":"")+(w?" ["+w+"]":"")+" - warning, a filter may not have returned data"),["go",v]))}function A(d,x){if(g.stopped||d.stopped)return C("STOP"+(x?" ["+x+"]":""),d.stopped?"process stopped":"bind stopped"),d.stopped?d.stop=null:g.stopped=!1,!0}this.to=function(d,x,P,v,w,b,X,Y){var m="targets, props, extra, filter, smartDecimals, call, lock, unique",j;if(j=st(g.to,arguments,m))return j;var S=O("to",d,x,w),_=S[0];S=S[1];var R=E("to",v,_,S,P);if(S=R[1],R[0]=="stop")return;if(g.bindType==t.LOCALSTORAGE)localStorage[g.connection]=JSON.stringify(S),h(S);else{var U="type="+g.bindType+"&";if(!S||t.isEmpty(S))return g;if(g.bindType==t.GET){var Z=S;t.isJSON(Z)||(Z=JSON.stringify(Z)),a&&(Z=t.couple(Z)),f&&C("Bind Report: TO [bindings]",Z),Z=t.urlEncode(Z);var K=n(g.master)?"":"&master="+t.urlEncode(i),ne=n(X)?"":"&lock="+t.urlEncode(X),V=n(Y)?"":"&unique="+t.urlEncode(Y),D=n(P)?"":"&extra="+t.urlEncode(P),c=g.connection+U+"command=to&data="+Z+K+ne+V+D;f&&C("Bind Report: TO [url]",c),t.async(c,h,"callbackTo")}else g.bindType==t.POST&&(g.ajax.master=i,g.ajax.couple=a,g.ajax.lock=X,g.ajax.unique=Y,f&&C("Bind Report: TO [bindings]",S),g.ajax.post(g.connection+U,S,"to",P,h))}function h(o){a&&(o=t.decouple(o)),b&&typeof b=="function"&&b(o),f&&C("Bind Report: TO"+(P?" ["+P+"]":" -"),o)}return g},this.toLock=function(d,x,P,v,w,b){var X="targets, props, extra, filter, smartDecimals, call",Y;if(Y=st(g.toLock,arguments,X))return Y;if(g.bindType.toLowerCase()=="localstorage")return g.to(d,x,P,v,w,b),g;var m=t.makeID();g.from(j,d,x,P,v,m);function j(){g.to(d,x,P,v,w,b,m)}return g},this.toUnique=function(d,x,P,v,w,b){var X="targets, props, extra, filter, smartDecimals, call",Y;return(Y=st(g.toUnique,arguments,X))?Y:(g.to(d,x,P,v,w,b,null,!0),g)},this.toggleReport=function(d){return n(d)?f=!f:f=d,g},f&&C("Bind Report: CREATE ["+r.toUpperCase()+"]",e+(i?" "+i:""));function C(d,x){g==mt?Er(d,x):Pr(d,x)}return this.report=function(){var d="Bind {DATA} Report:",x=t.copy(g.data);return g==mt?Er(d,x):Pr(d,x),d="Bind {BINDINGS} Report:",x=t.copy(g.bindings),g==mt?Er(d,x):Pr(d,x),g},this.from=function(d,x,P,v,w,b){var X="call, targets, props, extra, filter, lock",Y;if(Y=st(g.from,arguments,X))return Y;var m=O("from",x,P,s),j=m[0];m=m[1];var S=E("fromTo",w,j,m,v);if(m=S[1],S[0]=="stop")return;var _="type="+g.bindType+"&";if(g.bindType==t.LOCALSTORAGE)(!localStorage[g.connection]||localStorage[g.connection]==null)&&(localStorage[g.connection]="{}"),g.data=JSON.parse(localStorage[g.connection]),V(g.data);else if(g.bindType==t.GET){var R=m;t.isJSON(R)||(R=JSON.stringify(R)),a&&(R=t.couple(R)),f&&C("Bind Report: FROM [bindings]",R),R=t.urlEncode(R);var U=n(g.master)?"":"&master="+t.urlEncode(i),Z=n(b)?"":"&lock="+t.urlEncode(b),K=n(v)?"":"&extra="+t.urlEncode(v),ne=g.connection+_+"data="+R+"&command=from"+U+Z+K;f&&C("Bind Report: FROM [url]",ne),t.async(ne,V,"callbackFrom")}else g.bindType==t.POST&&(g.ajax.master=i,g.ajax.couple=a,g.ajax.lock=b,f&&C("Bind Report: FROM [bindings]",m),g.ajax.post(g.connection+_,m,"from",v,V));function V(D){if(g.data=D,a&&(g.data=t.decouple(g.data)),!n(b))var c=JSON.stringify(g.data);var h=E("from",w,j,g.data,v);if(h[0]!="stop"){var o=!1;(n(b)||c!=JSON.stringify(g.data))&&(o=!0,g.applyData()),f&&C("Bind Report: FROM"+(v?" ["+v+"]":" -"),o?g.data:"data not applied in toLock()"),d&&typeof d=="function"&&d(g.data)}}return g},this.applyData=function(){return t.loop(g.data,function(d,x){var P=g.bindings[d];if(P){var v=g.bindings[d].obj;t.loop(x,function(w,b){v[w]=b})}}),g},this.clear=function(){return g.bindType==t.LOCALSTORAGE&&(localStorage[g.connection]=null),g},this.removeAllBindings=function(d,x){if(n(d)&&(d=!0),this.bindings={},this.ids=[],this.data={},this.objIDs=new t.Dictionary(!0),this.toIDs={},this.fromIDs={},d){var P="type="+g.bindType+"&";if(g.bindType==t.LOCALSTORAGE)g.clear(),w("success");else if(g.bindType==t.GET){var v=n(g.master)?"":"&master="+encodeURI(i);t.async(g.connection+P+"command=removeAll"+v,w,"callbackRemoveAll")}else g.bindType==t.POST&&(g.ajax.master=i,g.ajax.post(g.connection+P,{},"removeAll",null,w,"removeAll"))}function w(b){x&&typeof x=="function"&&x(b),f&&C("Bind Report: REMOVEALL",b)}return g},g},t.Swipe=function(e,r,i,l,a){var s="obj, distance, duration, isometric, overrideNoSwipe",f;if(f=st(t.Swipe,arguments,s,this))return f;if(De("70"),this.cjsEventDispatcher_constructor(),this.type="Swipe",n(e)||!e.on){tt(`zim controls - Swipe():
Please pass in object`);return}n(r)&&(r=30);var u=Tt(i);n(i)&&(i=u=="s"?.08:80),this.distance=r,this.duration=i,this.active=!0;var y,k,g,O,T,E,A=this,C,d,x=e.on("mousedown",function(P){if(!A.active||!a&&P.target.zimNoSwipe)return;A.obj=P.target,O=y=P.stageX/t.scaX,T=k=P.stageY/t.scaY,g=!0,A.dispatchEvent("swipedown"),clearTimeout(E),E=setTimeout(function(){g&&(v(),g=!1)},A.duration*(u=="s"?1e3:1)),C=e.on("pressmove",function(w){O=w.stageX/t.scaX,T=w.stageY/t.scaY}),d=e.on("pressup",function(){g&&(v(),g=!1,clearTimeout(E))});function v(){var w=new Fe.Event("swipe");if(w.obj=A.obj,w.stageX=P.stageX/t.scaX,w.stageY=P.stageY/t.scaY,w.rawX=P.rawX/t.scaX,w.rawY=P.rawY/t.scaY,w.swipeX=w.swipeY=0,A.direction="none",l){if(Math.abs(O-y)>A.distance||Math.abs(T-k)>A.distance){var b=Math.atan2(T-k,O-y)*180/Math.PI;b=(b+360)%360,b>=270&&b<360?(w.swipeY=-1,A.direction="up"):b>=0&&b<90?(w.swipeX=1,A.direction="right"):b>=90&&b<180?(w.swipeY=1,A.direction="down"):b>=180&&b<270&&(w.swipeX=-1,A.direction="left")}}else Math.abs(O-y)>Math.abs(T-k)?(O-y>A.distance&&(w.swipeX=1,A.direction="right"),y-O>A.distance&&(w.swipeX=-1,A.direction="left")):(T-k>A.distance&&(w.swipeY=1,A.direction="down"),k-T>A.distance&&(w.swipeY=-1,A.direction="up"));A.dispatchEvent(w)}});this.disable=function(){A.active=!1},this.enable=function(){A.active=!0},this.dispose=function(){x&&e.off("mousedown",x),C&&e.off("pressmove",C),d&&e.off("pressup",d)}},t.extend(t.Swipe,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),t.Swiper=function(e,r,i,l,a,s,f,u,y,k,g,O,T){var E="swipeOn, target, property, sensitivity, swiperType, min, max, damp, integer, factor, loop, pauseTime, otherSwiper",A;if(A=st(t.Swiper,arguments,E,this))return A;if(De("69.5"),this.cjsEventDispatcher_constructor(),this.type="Swiper",n(e)||!e.getStage||!e.stage){tt("zim.Swiper() - please provide container on stage");return}if(n(r))return;n(l)&&(l=1),n(a)&&(a="horizontal"),n(u)&&(u=.1),u===!1&&(u=1),n(y)&&(y=!1),n(k)&&(k=1),n(g)&&(g=!1);var C=Tt(O);n(O)&&(O=C=="s"?.2:200);var d=this,x=e,P,v,w=d.desiredValue=r[i],b;this.target=r,this.property=i,this.sensitivity=l;var X=!1,Y=ee.zdf||e.stage?e.stage.frame:{};x.canvas?(b=x,d.downEvent=x.on("stagemousedown",function(B){X=!0,V(B),d.moveEvent=x.on("stagemousemove",D),d.upEvent=x.on("stagemouseup",m),d.upEvent2=Y.on("mouseupplus",m)})):(b=x.stage,p(),d.downEvent=x.on("mousedown",V),d.moveEvent=x.on("pressmove",D),d.upEvent=x.on("pressup",j),d.upEvent2=Y.on("mouseupplus",j));function m(){X=!1,x.off("stagemousemove",d.moveEvent),x.off("stagemouseup",d.upEvent),d.dispatchEvent("swipeup")}function j(){X=!1,d.dispatchEvent("swipeup")}var S,_,R,U=Math.sqrt(Math.pow(x.width,2)+Math.pow(x.height,2)),Z,K,ne=!1;function V(B){ne=!0,b=B.target.stage,R=(x.parent?x.parent:x).localToGlobal(x.x,x.y),X=!0,a=="radial"?(Z=B.stageX/t.scaX,K=B.stageY/t.scaY,S=Math.atan2(K-R.y,Z-R.x)*t.DEG):P=a=="horizontal"?B.stageX/t.scaX:B.stageY/t.scaY,v=d.target[d.property],d.dispatchEvent("swipedown")}function D(B){if(X){if(a=="radial"){d.diff=t.dist(Z,K,B.stageX/t.scaX,B.stageY/t.scaY),_=Math.atan2(B.stageY/t.scaY-R.y,B.stageX/t.scaX-R.x)*t.DEG;var F=t.sign(S-_);if(Math.abs(_-S)>180){X=!1;return}d.diff=d.diff*F;var fe=Math.max(10,t.dist(R.x,R.y,B.stageX/t.scaX,B.stageY/t.scaY));d.diff*=(U-fe)/U}else d.diff=P-(a=="horizontal"?B.stageX/t.scaX:B.stageY/t.scaY);if(T&&(Math.abs(d.diff)<Math.abs(T.diff)?(d.override=!0,T.override=!1):(d.override=!1,T.override=!0)),!d.override){if(Math.abs(d.diff)>0&&(d.swiperMoving=!0),w=v-d.diff*d.sensitivity*k,!n(s)&&!n(f)&&g){var se=w;w=(w+(f-s)*1e4-s)%(f-s)+s,Math.abs(se-w)>Math.abs(f-s)*.8&&(d.immediate(w),P=a=="horizontal"?B.stageX/t.scaX:B.stageY/t.scaY,v=d.target[d.property])}else n(s)||(w=Math.max(w,s)),n(f)||(w=Math.min(w,f));d.desiredValue=w,d.dispatchEvent("swipemove")}}}var c=new t.Damp(d.target[d.property],u),h=w,o=w;d.swiperTicker=t.Ticker.add(function(){w==h?w!=o&&(d.pauseTimeout&&d.pauseTimeout.clear(),o=w,d.pauseTimeout=t.timeout(O,function(){X&&d.dispatchEvent("swipepause"),d.pauseTimeout=null})):(o=null,h=w,d.pauseTimeout&&d.pauseTimeout.clear()),d.swiperMoving&&(d.target[d.property]=y?Math.round(c.convert(w)):c.convert(w),ne&&!X&&Math.abs(d.target[d.property]-w)<Math.abs(l)/2&&(d.swiperMoving=!1,ne=!1,d.target[d.property]=w,d.immediate(d.target[d.property]),d.dispatchEvent("swipestop")))},b),this.immediate=function(B){c.immediate(B),d.target[d.property]=y?Math.round(B):B,d.desiredValue=w=B};var I=!0;Object.defineProperty(d,"enabled",{get:function(){return I},set:function(B){I!=B&&(B?we():L(),I=!!B)}}),Object.defineProperty(d,"desiredValue",{get:function(){return w},set:function(B){d.swiperMoving=!0,w=B}}),Object.defineProperty(d,"damp",{get:function(){return u},set:function(B){u=B,c.damp=u}});function N(){x.off("stagemousedown",d.downEvent),x.off("stagemousemove",d.moveEvent),x.off("stagemouseup",d.upEvent),Y.off("mouseupplus",d.upEvent2)}function p(){x.off("mousedown",d.downEvent),x.off("pressmove",d.moveEvent),x.off("pressup",d.upEvent),Y.off("mouseupplus",d.upEvent2)}function L(){x.canvas?N():p(),t.Ticker.remove(d.swiperTicker)}function we(){x.canvas?d.downEvent=x.on("stagemousedown",d.downEvent):(d.downEvent=x.on("mousedown",d.downEvent),d.moveEvent=x.on("pressmove",d.moveEvent),d.upEvent=x.on("pressup",d.upEvent),d.upEvent2=Y.on("mouseupplus",d.upEvent2)),d.immediate(d.target[d.property]),d.swiperTicker=t.Ticker.add(d.swiperTicker,b)}this.dispose=function(){L(),c=null,d.swiperTicker=null}},t.extend(t.Swiper,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),t.MotionController=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y){var m="target, type, speed, axis, boundary, map, diagonal, damp, flip, orient, constant, firstPerson, turnSpeed, moveThreshold, stickThreshold, container, localBoundary, mouseMoveOutside, mousedownIncludes, minPercentSpeed, maxPercentSpeed, dampKeyup, rotate, mouseOutside",j;if(j=st(t.MotionController,arguments,m,this))return j;De("69.7"),this.cjsEventDispatcher_constructor(),this.type="MotionController";var S=this,_,R="zim MotionController(): Please pass in a reference to the stage or a container on the stage";if(n(C))if(ee.zdf)_=C=ee.zdf.stage;else{tt(R);return}else if(n(C.stage))if(ee.zdf)_=ee.zdf.stage;else{tt(R);return}else _=C.stage;var U=_.frame;n(k)||(X=k),n(e)&&(e=new t.Container(1,1,null,null,!1));var Z=e.type=="Accelerator";if(n(i)&&(i=r=="pressmove"?20:7),!n(r)&&r.type=="DPad"){var K=r;r="manual",n(l)&&(l=K.axis),l=="all"&&(l="both"),K.on("change",function(){S.convert(e.x+K.dirX*i,e.y+K.dirY*i)})}(n(r)||r!="mousemove"&&r!="pressmove"&&r!="pressdrag"&&r!="keydown"&&r!="gamebutton"&&r!="gamestick"&&r!="swipe"&&r!="follow"&&r!="manual")&&(r="mousedown"),n(l)&&(l=Z?"horizontal":"both"),r=="keydown"&&n(s)&&(s=[[65,37],[68,39],[87,38],[83,40]]),r=="gamebutton"&&n(s)&&(O?s=[14,15,t.GamePad.RT,t.GamePad.LT]:s=[14,15,12,13]),r=="gamestick"&&n(s)&&(O?s=[[0,2],[0,2],[1],[1]]:s=[0,0,1,1]),r=="gamestick"&&n(s)&&(s=[0,0,1,1]),n(f)&&(f=!0),(l=="horizontal"||l=="vertical")&&(f=!1),(n(u)||u===!0)&&(u=r=="keydown"||r=="gamebutton"?1:r=="pressmove"?.5:.1),u===!1&&(u=1),n(O)&&(O=!1),n(T)&&(T=i*.4),n(E)&&(E=4),n(A)&&(A=.2),n(x)&&(x=!0),_.mouseMoveOutside=x,n(P)&&(P=[]),Array.isArray(P)||(P=[P]),e.type=="Pen"&&!e.move?P.push(e,e.paper):P.push(e),a&&a.getBounds&&(P?P.indexOf(a)==-1&&P.push(a):P=[a]),e.motionController=this,this.mousedownIncludes=P,C&&C.backing&&this.mousedownIncludes.push(C.backing),n(b)&&(b=.3),S.dampKeyup=b,this.dirX=0,this.dirY=0,this.speed=i,this.turnSpeed=T,this.axis=l,this.target=e,this.moveThreshold=E,this.stickThreshold=A,this.boundary=a,e.zimMCStartAngle=e.rotation;var ne=S.speed,V=S.speed,D=0;S.rotation=e.zimMCStartAngle;var c,h;if(Z){h=C.getBounds();var o;!h||l=="vertical"&&!h.height||l!="vertical"&&!h.width?o=1e3:o=l=="vertical"?h.height:h.width,n(v)&&(v=0),n(w)&&(w=100),n(this.target.percentSpeed)&&(this.target.percentSpeed=(w-v)/2),S.x=o/2,S.y=o/2,c=new t.Proportion(0,o,v,w)}else S.x=this.target.x,S.y=this.target.y;var I=S.scaleX=e.scaleX,N=S.scaleY=e.scaleY,p,L,we,B,F=!1,fe=!1,se,Q,te,le,Ae;if(r=="keydown"||r=="gamebutton"){for(Q=0;Q<4;Q++)Array.isArray(s[Q])||(s[Q]=[s[Q]]);var J=[0,0,0,0],Te=[],G=["X","X","Y","Y"],ce=[-1,1,-1,1],q={dirX:0,dirY:0};if(r=="keydown")var ue=U.on("keydown",Be);else{le=S.gamepad=new t.GamePad;var ge=le.on("buttondown",Be)}if(n(g))if(r=="keydown")var ie=U.on("keyup",$);else var xe=le.on("buttonup",$);Ae={rotation:0,speedX:S.speed,speedY:S.speed};var Se=t.Ticker.add(function(){if(O){be(q);return}var Qe=S.speed,he=S.speed;if(S.axis=="both"&&q.dirX!=0&&q.dirY!=0){var Ge=ke(q.dirX,q.dirY);Qe=Ge.speedX,he=Ge.speedY}(S.axis=="horizontal"||S.axis=="both")&&(S.x+=Qe*q.dirX),(S.axis=="vertical"||S.axis=="both")&&(S.y+=he*q.dirY),me()},_)}else if(r=="mousedown"||r=="mousemove")p=_.on("stage"+r,function(Qe){_=Qe.target.stage;var he,Ge;if(!Y&&S.boundary&&!S.boundary.type=="Blob"?Ge=S.boundary:!Y&&C&&C.boundsToGlobal&&(Ge=C.boundsToGlobal()),!(Ge&&(he={x:Qe.stageX/t.scaX,y:Qe.stageY/t.scaY},he.x<Ge.x||he.x>Ge.x+Ge.width||he.y<Ge.y||he.y>Ge.y+Ge.height))){if(r=="mousedown"){if(Array.isArray(S.mousedownIncludes)||(S.mousedownIncludes=[S.mousedownIncludes]),S.mousedownIncludes.indexOf(C)<0)for(Q=0;Q<C.numChildren;Q++){var Ie=C.getChildAt(Q);if(S.mousedownIncludes.indexOf(Ie)==-1&&Ie.mouseEnabled&&Ie.hitTestPoint&&Ie.hitTestPoint(Qe.stageX/t.scaX,Qe.stageY/t.scaY))return}S.dispatchEvent("mousedown")}var _e=C.globalToLocal(x?Qe.rawX/t.scaX:Qe.stageX/t.scaX,x?Qe.rawY/t.scaY:Qe.stageY/t.scaY);S.x=_e.x,S.y=_e.y,me()}});else if(r=="pressmove"||r=="pressdrag"||r=="follow")e.type=="Pen"&&(e.write=!1),p=_.on("stagemousedown",function(Qe){var he,Ge;if(!Y&&S.boundary&&!S.boundary.type=="Blob"?Ge=S.boundary:!Y&&C&&C.boundsToGlobal&&(Ge=C.boundsToGlobal()),!(Ge&&(he={x:Qe.stageX/t.scaX,y:Qe.stageY/t.scaY},he.x<Ge.x||he.x>Ge.x+Ge.width||he.y<Ge.y||he.y>Ge.y+Ge.height))&&!(S.boundary&&S.boundary.type=="Blob"&&(r=="pressmove"||r=="pressdrag")&&(he={x:Qe.stageX/t.scaX,y:Qe.stageY/t.scaY},!S.boundary.shape.hitTestPoint(he.x,he.y)))&&!(r=="pressdrag"&&!e.hitTestPoint(Qe.stageX/t.scaX,Qe.stageY/t.scaY))){fe=!1,Array.isArray(S.mousedownIncludes)||(S.mousedownIncludes=[S.mousedownIncludes]);var Ie=!1;for(S.mouseDownIncludes&&(se=_.getObjectUnderPoint(Qe.stageX,Qe.stageY,1)),Q=0;Q<S.mousedownIncludes.length;Q++)se&&S.mousedownIncludes[Q].hitTestPoint&&S.mousedownIncludes[Q].hitTestPoint(Qe.stageX/t.scaX,Qe.stageY/t.scaY)&&S.mousedownIncludes[Q].contains(se)&&(Ie=!0);if(!Ie)for(Q=0;Q<C.numChildren;Q++){var _e=C.getChildAt(Q);if(S.mousedownIncludes.indexOf(_e)==-1&&_e.mouseEnabled&&_e.hitTestPoint&&_e.hitTestPoint(Qe.stageX/t.scaX,Qe.stageY/t.scaY))return}var Je=C.globalToLocal(x?Qe.rawX/t.scaX:Qe.stageX/t.scaX,x?Qe.rawY/t.scaY:Qe.stageY/t.scaY);r!="follow"&&r!="pressdrag"&&S.immediate(l=="both"||l=="horizontal"?Je.x:null,l=="both"||l=="vertical"?Je.y:null),me(),S.dispatchEvent("mousedown"),F=!0,S.moveX=x?Qe.rawX/t.scaX:Qe.stageX/t.scaX,S.moveY=x?Qe.rawY/t.scaY:Qe.stageY/t.scaY,L=_.on("stagemousemove",function(Oe){S.moveX=x?Oe.rawX/t.scaX:Oe.stageX/t.scaX,S.moveY=x?Oe.rawY/t.scaY:Oe.stageY/t.scaY,r!="follow"&&Me()}),B&&t.Ticker.remove(B),r=="follow"&&(B=t.Ticker.add(Me)),e.type=="Pen"&&(e.write=!0,e.paper.noMouse(),e.zimDragCheck=!0)}}),we=_.on("stagemouseup",function(){e.type=="Pen"&&(e.write=!1,e.paper.mouse(),e.zimDragCheck=!1,fe&&e.stopCheck()),B&&t.Ticker.remove(B),_.off("stagemousemove",L),F=!1});else if(r=="gamestick"){for(le=this.gamepad=new t.GamePad,Q=0;Q<4;Q++)Array.isArray(s[Q])||(s[Q]=[s[Q]]);Ae={rotation:e.zimMCStartAngle,speedX:S.speed,speedY:S.speed};var z=le.on("data",function(Qe){for(q={dirX:0,dirY:0},Q=0;Q<s[0].length;Q++)if(te=Qe.axes[s[0][Q]],Math.abs(te)>S.stickThreshold){q.dirX=te;break}for(Q=0;Q<s[2].length;Q++)if(te=Qe.axes[s[2][Q]],Math.abs(te)>S.stickThreshold){q.dirY=te;break}if(O){be(q);return}S.x+=S.speed*q.dirX,S.y+=S.speed*q.dirY,me()})}else if(r=="swipe")var pe=new t.Swiper(_,S,"x",.8),de=new t.Swiper(_,S,"y",.8,!1),oe=pe.on("swipemove",function(){me()});function Be(Qe){var he=r=="keydown"?Qe.keyCode:Qe.buttonCode,Ge;for(Q=0;Q<4;Q++)if(s[Q].indexOf(he)>-1){if(!f&&S.axis=="both"&&(q.dirX=q.dirY=0),q["dir"+G[Q]]=ce[Q],J[Q]=1,Ge=Te.indexOf(Q),Ge==0)return;Ge>0&&Te.splice(Ge,1),Te.unshift(Q);return}}function $(Qe){var he=r=="keydown"?Qe.keyCode:Qe.buttonCode,Ge;for(Q=0;Q<4;Q++)if(s[Q].indexOf(he)>-1){if(J[Q]=0,Ge=Te.indexOf(Q),Ge>=0&&Te.splice(Ge,1),S.axis!="both"||f)q["dir"+G[Q]]=-J[Math.floor(Q/2)*2]+J[Math.floor(Q/2)*2+1];else if(Te.length>0){q["dir"+G[Q]]=0;var Ie=Te[0];q["dir"+G[Ie]]=ce[Ie]}else q.dirX=q.dirY=0;return}}function Me(){var Qe=C.globalToLocal(S.moveX,S.moveY);S.x=Qe.x,S.y=Qe.y,me(),e.type=="Pen"&&!fe&&e.drawing&&(fe=!0)}function be(Qe){Ae.rotation+=Qe.dirX*S.turnSpeed,S.rotation=Ae.rotation,Ae.speedX=Math.sin(Ae.rotation*Math.PI/180)*S.speed*-Qe.dirY,Ae.speedY=-Math.cos(Ae.rotation*Math.PI/180)*S.speed*-Qe.dirY,S.x+=Ae.speedX,S.y+=Ae.speedY}function me(){var Qe=S.x-(Z?S.target.percentSpeed:S.target.x),he=S.y-(Z?S.target.percentSpeed:S.target.y),Ge=ke(Qe,he);if(ne=Ge.speedX,V=Ge.speedY,!!X){if(n(Ge.angle)||(S.rotation=Ge.angle+e.zimMCStartAngle),n(S.rotation)){S.rotation=S.target.rotation;return}S.rotation+=D;var Ie=re(S.rotation),_e=S.target.rotation=re(S.target.rotation);Math.abs(Ie-_e)>180&&(_e>Ie?_e-=360:Ie-=360),S.dampR.immediate(_e),S.target.rotation=_e,S.rotation=Ie}}function re(Qe){return(Qe%360+360)%360}function ke(Qe,he){var Ge=S.speed,Ie=S.speed,_e,Je=Math.sqrt(Math.pow(Qe,2)+Math.pow(he,2));return Je>0&&(Ge=Math.abs(Qe)/Je*S.speed,Ie=Math.abs(he)/Je*S.speed,_e=90-Math.atan2(Qe,he)*180/Math.PI),{speedX:Ge,speedY:Ie,angle:_e}}var Re=this.x,Ye=this.y,$e=this.x,it=this.y,Le=this.x=Z?o/2:this.target.x,Ze=this.y=Z?o/2:this.target.y;this.dampX=new t.Damp(Le,u),this.dampY=new t.Damp(Ze,u),this.dampR=new t.Damp(this.target.rotation,u);var ze=0,ve=0,Pe=t.Ticker.add(function(){if(r=="manual"&&me(),S.boundary&&S.boundary.type!="Blob"&&(S.x=t.constrain(S.x,S.boundary.x,S.boundary.x+S.boundary.width),S.y=t.constrain(S.y,S.boundary.y,S.boundary.y+S.boundary.height)),S.axis=="horizontal"||S.axis=="both"){if(S.dirX=t.sign(S.x-Le),Math.abs(S.x-Le)<ne?Le=S.x:Le+=S.dirX*ne,q&&q.dirX==0){var Qe=S.boundary?S.boundary.width/2:_.width/2,he=S.x-(S.x-Qe)*(Z?S.dampKeyup:0);Le=he,S.x=Le}Z&&h&&h.width?S.target.percentSpeed=c.convert(S.dampX.convert(Le)):S.target.x=S.dampX.convert(Le)}if(S.axis=="vertical"||S.axis=="both"){if(S.dirY=t.sign(S.y-Ze),Math.abs(S.y-Ze)<V?Ze=S.y:Ze+=t.sign(S.y-Ze)*V,q&&q.dirY==0){Qe=S.boundary?S.boundary.height/2:_.height/2;var Ge=S.y-(S.y-Qe)*(Z?S.dampKeyup:0);Ze=Ge,S.y=Ze}Z&&h&&h.height?S.target.percentSpeed=c.convert(S.dampY.convert(Ze)):S.target.y=S.dampY.convert(Ze)}if(S.boundary&&S.boundary.type=="Blob"&&(S.boundary.shape.hitTestPoint(S.target.x,S.target.y)?(Re=S.target.x,Ye=S.target.y):(S.target.x=S.x=Re,S.target.y=S.y=Ye,S.immediate(Re,Ye))),r=="pressmove"&&F&&S.dispatchEvent("pressing"),u==1?(S.movingX=Math.round($e-S.x)!=0,S.movingY=Math.round(it-S.y)!=0,$e=S.x,it=S.y):(S.movingX=Math.abs(Le-(Z?S.target.percentSpeed:S.target.x))>S.moveThreshold,S.movingY=Math.abs(Ze-(Z?S.target.percentSpeed:S.target.y))>S.moveThreshold),S.moving&&!(S.movingX||S.movingY)?S.dispatchEvent("stopmoving"):!S.moving&&(S.movingX||S.movingY)&&S.dispatchEvent("startmoving"),S.moving=S.movingX||S.movingY,S.moving&&S.dispatchEvent("moving"),S.dirX!=ze||S.dirY!=ve){var Ie=new Fe.Event("change"),_e;S.dirX!=ze?(_e=["left",null,"right"],Ie.dir=_e[S.dirX+1],ze=S.dirX,!e.zimMCStartAngle&&(y=="horizontal"||y=="both")&&(S.scaleX=e.scaleX=S.dirX?Math.abs(e.scaleX)*S.dirX:e.scaleX,I!=0&&Math.round(S.scaleX/I)==-1?D=180:D=0)):(_e=["up",null,"down"],Ie.dir=_e[S.dirY+1],ve=S.dirY,!e.zimMCStartAngle&&(y=="vertical"||y=="both")&&(S.scaleY=e.scaleY=S.dirY?-Math.abs(e.scaleY)*S.dirY:e.scaleY,N!=0&&Math.round(S.scaleY/N)==-1?D=180:D=0)),S.dispatchEvent(Ie)}X&&!n(S.rotation)&&(S.target.rotation=S.dampR.convert(S.rotation))},_);this.immediate=function(Qe,he,Ge){return!n(Qe)&&S.dampX&&(S.dampX.immediate(Qe),Z?S.x=S.target.percentSpeed=Le=Qe:S.x=S.target.x=Le=Qe,pe&&pe.immediate(Qe)),!n(he)&&S.dampY&&(S.dampY.immediate(he),Z?S.y=S.target.percentSpeed=Ze=he:S.y=S.target.y=Ze=he,de&&de.immediate(he)),!n(Ge)&&S.dampR&&(S.dampR.immediate(Ge),S.rotation=S.target.rotation=Ge),Re=S.x,Ye=S.y,S},this.convert=function(Qe,he){n(Qe)||(S.x=Qe),n(he)||(S.y=he),me()},Object.defineProperty(S,"pausingSpeed",{get:function(){return S.speed},set:function(Qe){S.speed=Qe}}),this.paused=!1;var ae;this.pause=function(Qe,he,Ge){return n(Qe)&&(Qe=!0),n(he)&&(he=0),n(Ge)&&(Ge=!1),Qe?(ae=S.speed,he>0?(t.animate({target:S,obj:{pausingSpeed:0},ticker:!1,time:he,call:function(){S.speed=0,S.paused=!0,S.enabled=!1,S.immediate(S.target.x,S.target.y),S.dispatchEvent("pause")}}),Ge&&(F=!1,L&&_.off("stagemousemove",L),B&&t.Ticker.remove(B),e.type=="Pen"&&(e.write=!1,e.zimDragCheck=!1),we&&_.off("stagemouseup",we),fe&&e.stopCheck(),r=="keydown"?ie&&U.off("keyup",ie):xe&&le.off("buttonup",xe))):(S.speed=0,S.paused=!0,S.enabled=!1,S.immediate(S.target.x,S.target.y),setTimeout(function(){S.dispatchEvent("pause")},10))):(S.enabled=!0,he>0?t.animate({target:S,obj:{pausingSpeed:ae},ticker:!1,time:he,call:function(){S.speed=ae,S.paused=!1}}):(S.speed=ae,S.paused=!1)),S};var Ne=!0;Object.defineProperty(S,"enabled",{get:function(){return Ne},set:function(Qe){Ne!=Qe&&(Qe?(Ke(),S.paused=!1):(Xe(),S.paused=!0),Ne=!!Qe)}});function Ke(){r=="keydown"?(ue=U.on("keydown",ue),ie&&(ie=U.on("keyup",ie)),Se=t.Ticker.add(Se,_)):r=="gamebutton"?(ge=le.on("buttondown",ge),xe&&(xe=le.on("buttonup",xe)),Se=t.Ticker.add(Se,_)):r=="gamestick"?z=le.on("data",z):r=="swipe"?(pe.enabled=!0,de.enabled=!0,oe&&(oe=pe.on("swipemove",oe))):r=="mousedown"||r=="mousemove"?p=_.on("stage"+r,p):r=="pressmove"&&(p=_.on("stagemousedown",p),L&&(L=_.on("stagemousemove",L)),we&&(we=_.on("stagemouseup",we))),Pe=t.Ticker.add(Pe,_)}function Xe(){r=="keydown"?(U.off("keydown",ue),U.off("keyup",ie),t.Ticker.remove(Se)):r=="gamebutton"?(le.off("buttondown",ge),le.off("buttonup",xe),t.Ticker.remove(Se)):r=="gamestick"?le.off("data",z):r=="swipe"?(pe.enabled=!1,de.enabled=!1,pe.off("swipemove",oe)):r=="mousedown"||r=="mousemove"?_.off("stage"+r,p):r=="pressmove"&&(_.off("stagemousedown",p),_.off("stagemousemove",L),_.off("stagemouseup",we)),t.Ticker.remove(Pe)}this.dispose=function(){Xe(),le&&le.dispose(),pe&&pe.dispose(),de&&pe.dispose()}},t.extend(t.MotionController,Fe.EventDispatcher,"enabled","cjsEventDispatcher"),t.GamePad=function(){if(De("69.8"),this.type="GamePad",this.cjsEventDispatcher_constructor(),!navigator.getGamepads){this.error=!0,vt&&tt("zim.GamePad() - no browswer support");return}var e;ee.addEventListener("gamepadconnected",i),this.currentIndex=0;var r=this;function i(f){r.connected=!0,a("gamepadconnected",f);var u=navigator.getGamepads()[r.currentIndex];r.lastData=[];for(var y=0;y<u.buttons.length;y++)r.lastData[y]=u.buttons[y].pressed;function k(){if(e=requestAnimationFrame(k),r.data=navigator.getGamepads()[r.currentIndex],!!r.data){for(var g=r.buttons=[],O,T=0;T<r.data.buttons.length;T++)g[T]=r.data.buttons[T].pressed,g[T]!=r.lastData[T]&&(r.lastData[T]=g[T],g[T]?O=new Fe.Event("buttondown"):O=new Fe.Event("buttonup"),O.buttonCode=T,O.button=Rt[T],r.dispatchEvent(O));O=new Fe.Event("data"),O.axes=r.axes=r.data.axes,O.buttons=r.buttons,r.dispatchEvent(O)}}k()}var l=setInterval(function(){navigator.getGamepads&&navigator.getGamepads()[0]&&(r.connected||i(),clearInterval(l))},500);function a(f,u){var y=new Fe.Event(f);y.index=u.gamepad.index,y.id=u.gamepad.id,y.buttons=u.gamepad.buttons,y.axes=u.gamepad.axes,r.dispatchEvent(y)}var s=function(f){f.gamepad.index==r.currentIndex&&(cancelAnimationFrame(e),r.connected=!1,r.dispatchEvent("gamepaddisconnected"))};ee.addEventListener("gamepaddisconnected",s),this.dispose=function(){ee.removeEventListener("gamepadconnected",i),ee.removeEventListener("gamepaddisconnected",s),cancelAnimationFrame(e),clearInterval(l),r.connected=!1}};var Rt=["A","B","X","Y","LB","RB","LT","RT","BACK","START","LS","RS","DPAD_UP","DPAD_DOWN","DPAD_LEFT","DPAD_RIGHT"];for(dn=0;dn<Rt.length;dn++)t.GamePad[Rt[dn]]=dn;var Zt=["LSX","LSY","RSX","RSY"];for(dn=0;dn<Zt.length;dn++)t.GamePad[Zt[dn]]=dn;t.extend(t.GamePad,Fe.EventDispatcher,null,"cjsEventDispatcher"),t.Portal=function(e,r){var i="obj, lands",l;if(l=st(t.Portal,arguments,i,this))return l;if(De("69.96"),n(e)||!e.stage)return;this.type="Portal";var a=this,s=r&&r.numChildren&&r.numChildren>0;if(s){var f=r.getChildAt(r.numChildren-1),u=r.getChildAt(r.numChildren-2);r.setChildIndex(u,r.numChildren-1),u.setMask(e)}function y(){r.setChildIndex(f,0),f=u,u=r.getChildAt(r.numChildren-2),r.setChildIndex(u,r.numChildren-1),f.setMask(null),u.setMask(e),e.stage.update()}e.on(t.mobile()?"mousedown":"mouseover",function(){a._enabled&&(s&&y(),a.dispatchEvent("enter"))}),e.on(t.mobile()?"pressup":"mouseout",function(){a._enabled&&a.dispatchEvent("exit")}),Object.defineProperty(this,"portal",{get:function(){return e},set:function(k){if((n(k)||!k.stage)&&vt){tt("zim.Portal() - please provide a Display Object to act as the portal");return}u.setMask(e)}}),Object.defineProperty(this,"currentLand",{get:function(){return f},set:function(k){if(r.contains(k))for(;k!=f;)y()}}),Object.defineProperty(this,"nextLand",{get:function(){return u},set:function(){if(vt){tt("zim.Portal() - nextLand is read only - remake Portal to change");return}}}),this._enabled=!0,Object.defineProperty(a,"enabled",{get:function(){return a._enabled},set:function(k){a._enabled=k}})},t.extend(t.Portal,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),ee.zimContactListener=null;var At,Nt;function qe(e,r,i,l,a,s,f,u,y,k,g,O){if(De("69.97"),n(i)&&(i=0),l=="rectangle")e.body=e.physics.makeRectangle(e.width-i,e.height-i,r,a,f,u,y,k,g,s,O);else if(l=="circle")e.body=e.physics.makeCircle(e.width/2-i,r,a,f,u,y,k,g,s,O);else if(l=="triangle")n(e.a)&&(e.a=e.width,e.b=e.c=Math.sqrt(Math.pow(e.a/2,2)+Math.pow(e.height,2))),e.body=e.physics.makeTriangle(e.a-i,e.b-i,e.c-i,r,a,f,u,y,k,g,s,O);else if(l=="poly"){var T=[];e.reg(0,0,!0);var E=e;e.scale!=1&&(E=e.clone().transformPoints("scale",e.scale)),i&&(E=e.clone().transformPoints("scale",Math.max(0,1-i/((e.width+e.height)/4)))),t.loop(E.points,function(C){T.push({x:C[0],y:C[1]})}),e.body=e.physics.makePoly(T,e.width,e.height,r,a,f,u,y,k,g,s,O)}e.body.x=e.x,e.body.y=e.y,e.body.rotation=e.rotation,e.physics.addMap(e.body,e),e.impulse=function(C,d,x,P){n(C)&&(C=0),n(d)&&(d=0);var v=e.body.GetWorldCenter();return n(x)&&(x=v.x*e.physics.scale),n(P)&&(P=v.y*e.physics.scale),e.body.ApplyImpulse(new ee.b2Vec2(C,d),new ee.b2Vec2(x/e.physics.scale,P/e.physics.scale)),e},e.force=function(C,d,x,P){n(C)&&(C=0),n(d)&&(d=0);var v=e.body.GetWorldCenter();return n(x)&&(x=v.x*e.physics.scale),n(P)&&(P=v.y*e.physics.scale),e.body.ApplyForce(new ee.b2Vec2(C,d),new ee.b2Vec2(x/e.physics.scale,P/e.physics.scale)),e},e.setLinearVelocity=function(C,d){return e.body.SetLinearVelocity(new ee.b2Vec2(C,d)),e},e.setAngularVelocity=function(C){return e.body.SetAngularVelocity(C),e},e.spin=function(C){return n(C)&&(C=10),e.body.ApplyTorque(C*1e3),e},e.torque=function(C){return n(C)&&(C=10),e.body.ApplyTorque(C),e},e.follow=function(C,d,x,P,v,w,b,X,Y,m,j,S){var _="damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, borderOriginal",R;return(R=st(e.follow,arguments,_))?R:(e.physics.follow(e,C,d,x,P,v,w,b,X,Y,m,j,S),e)},e.noFollow=function(){return e.physics.follow(null),e},e.control=function(C,d,x,P,v){var w="type, speed, speedY, horizontal, vertical",b;return(b=st(e.control,arguments,w))?b:(e.physics.control(e,C,d,x,P,v),e)},e.customControl=function(C,d,x){var P="dir, speed, speedY",v;return(v=st(e.customControl,arguments,P))?v:(e.physics.customControl(C,d,x),e)},e.noControl=function(){return e.physics.noControl(e),e},e.sleep=function(){return e.body.SetAwake(!1),e},e.wake=function(){return e.body.SetAwake(!0),e};function A(){ee.zimContactListener=new ee.b2ContactListener,At=new t.Dictionary(!0),Nt=new t.Dictionary(!0),ee.zimContactListener.BeginContact=C,ee.zimContactListener.EndContact=d;function C(x){var P=At.at(x.m_fixtureB.GetBody());P&&P(x.m_fixtureA.GetBody().zimObj,x.m_fixtureA.GetBody()),P=At.at(x.m_fixtureA.GetBody()),P&&P(x.m_fixtureB.GetBody().zimObj,x.m_fixtureB.GetBody())}function d(x){var P=Nt.at(x.m_fixtureB.GetBody());P&&P(x.m_fixtureA.GetBody().zimObj,x.m_fixtureA.GetBody()),P=Nt.at(x.m_fixtureA.GetBody()),P&&P(x.m_fixtureB.GetBody().zimObj,x.m_fixtureB.GetBody())}e.physics.world.SetContactListener(ee.zimContactListener)}e.contact=function(C){return ee.zimContactListener||A(),At.add(e.body,C),e},e.noContact=function(){return At.remove(e.body),e},e.contactEnd=function(C){return ee.zimContactListener||A(),Nt.add(e.body,C),e},e.noContactEnd=function(){return Nt.remove(e.body),e},e.hasOwnProperty("dynamic")||Object.defineProperty(e,"dynamic",{get:function(){return e.body.GetType()==2},set:function(C){e.body.SetType(C==!0?2:0)}})}for(t.Timeline=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A){var C="objects, width, startPaused, barColor, buttonColor, themeColor, corner, ticks, damp, loop, noLoop, call, style, group, inherit",d;if(d=st(t.Timeline,arguments,C,this))return d;De("69.971"),this.group=E;var x=T===!1?{}:t.getStyle("Timeline",E,A),P=this.stage?this.stage:zimDefaultFrame.stage,v=P.frame,w=P.width,b=P.height;n(i)&&(i=x.startPaused!=null?x.startPaused:!1),n(k)&&(k=x.loop!=null?x.loop:!0),n(g)&&(g=x.noLoop!=null?x.noLoop:!1),n(l)&&(l=x.barColor!=null?x.barColor:t.tin),n(a)&&(a=x.buttonColor!=null?x.buttonColor:t.light),n(s)&&(s=x.themeColor!=null?x.themeColor:t.purple),n(r)&&(r=x.width!=null?x.width:w*.5),n(u)&&(u=x.ticks!=null?x.ticks:!0),n(y)&&(y=x.damp!=null?x.damp:!1),n(F)&&(F=x.labels!=null?x.labels:!0),n(f)&&(f=x.corner!=null?x.corner:5);var X=50;this.zimContainer_constructor(r,X,null,null,!1),this.type="Timeline";var Y=this,m=e,j=t.toBW(v.color);if(n(m)){if(!t.animatedObjects||!t.animatedObjects.objects)return tt("ZIM Timeline - add Timeline after animated objects"),Y;m=t.copy(t.animatedObjects.objects)}Array.isArray(m)||(m=[m]);var S=Date.now(),_=0;t.loop(m,function(xe){xe.pauseAnimate(),xe.tweenEndTime&&xe.tweenEndTime>_&&(_=xe.tweenEndTime)});var R=Math.ceil((_-S)/1e3),U=this.backing=new t.Rectangle(r,X,l,null,null,f).alp(.8).addTo(Y),Z=j=="#000000"?0:1,K=this.shade=new t.Rectangle(X-Z,X-Z*2,black,null,null,[f,0,0,f]).alp(.7).pos(Z,Z,LEFT,TOP,Y),ne=this.shade2=new t.Rectangle(X-Z,X-Z*2,black,null,null,[0,f,f,0]).alp(.7).pos(Z,Z,RIGHT,TOP,Y),V=new t.Container(50,50).alp(.9);new t.Rectangle(7,24,white).center(V).mov(-6),new t.Rectangle(7,24,white).center(V).mov(6);var D=Y.controls=new t.Button({icon:new t.Triangle(30,30,30,white).reg(null,16).rot(90).alp(.9),toggleIcon:V.reg("center"),downBackgroundColor:t.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(U,null,70).center(K).addTo(Y).expand(10).tap(function(){J.pauseAnimate(!D.toggled)});i||D.toggle();var c=new t.Container(50,50).reg("center").alp(.8).expand(10);new Mn(24,5,t.white).center(c).mov(0,-8),new Mn(24,5,t.white).center(c),new Mn(24,5,t.white).center(c).mov(0,8);var h=!0,o=Y.menu=new t.Button({icon:c,downBackgroundColor:t.purple.darken(.2),width:50,height:50,corner:25}).scaleTo(U,null,70).center(ne).addTo(Y).tap(function(){Ae.show(),h&&Ae.loc(Y.x,Y.y).mov(Y.width-Ae.width/2,-Ae.height/2-10)});function I(xe){J.rate=xe,ie.speed=xe,Y.trailInterval.time=ge.convert(ie.speed);try{localStorage&&(localStorage.zim_tl=JSON.stringify(ie))}catch (e10){}}function N(xe){J.ticks.vis(xe),J.labels.vis(xe),P.update(),ie.labels=xe;try{localStorage&&(localStorage.zim_tl=JSON.stringify(ie))}catch (e11){}}function p(xe){k=xe,ie.looping=xe;try{localStorage&&(localStorage.zim_tl=JSON.stringify(ie))}catch (e12){}}function L(xe){ue(),xe&&(J.percentComplete=0,setTimeout(function(){q()},50)),ie.trailing=xe;try{localStorage&&(localStorage.zim_tl=JSON.stringify(ie))}catch (e13){}}function we(xe){t.loop([D,o],function(Se){Se.backgroundColor=xe,Se.toggleBackgroundColor=xe,Se.rollBackgroundColor=xe.lighten(.2),Se.rollToggleBackgroundColor=xe.lighten(.2),Se.downBackgroundColor=xe.darken(.2)}),Ae.backing.color=xe,B.slider.bar.color=xe,P.update(),ie.color=xe;try{localStorage&&(localStorage.zim_tl=JSON.stringify(ie))}catch (e14){}return this}this.setThemeColor=we;var B=t.List.slider("speed",0,2,1,I,.1),F=t.List.checkBox("labels",!1,N),fe=t.List.checkBox("loop",!1,p),se=t.List.checkBox("trails",!1,L),Q=t.List.colorPicker("color",t.purple,new t.ColorPicker({colors:[t.purple,t.pink,t.red,t.orange,t.brown,t.green,t.blue,t.grey,t.black],cols:9}),we),te=this.title=new t.Container(300,25).noMouse();new t.Rectangle(500,70,t.black.toAlpha(.4)).pos(0,-45,CENTER,TOP,te),this.icon=v.makeIcon({edges:"white",box:faint,slats:["white","white","white","white","white"]}).alp(.6).scaleTo(te,null,140).pos(7,-10,"left","center",te),new t.Label({text:"Z  I  M  -  T  I  M  E  L  I  N  E",color:"white"}).alp(.6).sca(.47).loc(51,-4,te),new t.Line(219,1,"white").alp(.6).center(te).mov(8,3);var le=this.list=new t.List({width:300,height:260,backdropColor:clear,borderWidth:-1,shadowColor:-1,viewNum:6,padding:12,scrollBarV:!1,list:[B,F,fe,se,Q],swipe:!1});B.slider.bar.color=t.purple,le.tabs.mov(0,8);var Ae=Y.pane=new t.Pane({width:le.width,height:le.height+40,backgroundColor:t.purple,backdropColor:t.faint,draggable:!0,corner:8,content:le,resets:!1});Ae.contentContainer.mov(0,20),Ae.backing.on("pressmove",function(){h=!1},null,!0),te.scaleTo(Ae.contentContainer,100).pos(0,2,"center","top",Ae.contentContainer).setMask(Ae.backing);var J=Y.slider=new t.Slider({min:0,max:R,inside:!0,barColor:l,barWidth:X,barLength:r-X*2-12,tickColor:j.toAlpha(.8),damp:y,useTicks:!0,tickScale:1,tickStep:.1,semiTicks:4,semiTickScale:1,useLabels:!0,labelColor:j.toAlpha(.8)}).center(Y,1);J.bar.dye(t.faint),J.currentValue=0,J.ticks.mov(0,-20),J.bar.widthOnly=J.bar.width+14,new t.Triangle({color:t.dark}).alp(.3).scaleTo(J.button,70,90,"full").center(J.button),J.animate({props:{currentValue:J.max},time:J.max,ease:"linear",startPaused:i,loop:!0,loopWait:.5,loopWaitCall:function(){k||(J.pauseAnimate(),D.toggle(!1),J.currentValue=J.max),G&&Y.trailInterval.pause(),O&&typeof O=="function"&&O()},loopCall:function(){t.loop(m,function(xe){xe.percentComplete=0})}}),J.bar.on("mousedown",function(){J.percentComplete=J.currentValue/J.max*100});var Te=!0;J.button.on("mousedown",function(){Te=J.animating,J.pauseAnimate()}),J.button.on("pressup",function(){Te&&J.pauseAnimate(!1),J.percentComplete=J.currentValue/J.max*100}),Y.keyEvent=v.on("keydown",function(xe){xe.key==" "&&(D.toggled?(D.toggle(!1),J.pauseAnimate(!0)):(D.toggle(!0),J.pauseAnimate(!1)))}),Y.tickerID=t.Ticker.add(function(){var xe=Math.min(100,Y.slider.currentValue/R*100)-.01;t.loop(m,function(Se){var z=S+xe/100*(_-S)-Se.tweenStartTime;g&&(Se.percentComplete=Math.max(0,Math.min(100,z/(Se.tweenEndTime-Se.tweenStartTime)*100))),Se.percentComplete=z/(Se.tweenEndTime-Se.tweenStartTime)*100})});var G;function ce(){t.loop(m,function(xe){var Se=xe.clone().addTo(G).alp(.05);Se.color=clear,Se.borderColor=j}),G.updateCache("source-over"),G.disposeAllChildren()}Y.trailInterval=t.interval(.05,function(){J.animating&&B.slider.currentValue>0&&ce()}),Y.trailInterval.pause();function q(){Y.trails||(G=new t.Container(w,b).addTo(P,0).cache(),Y.trails=new t.Bitmap(G.cacheCanvas).addTo(P,1),Y.trailInterval.pause(!1))}function ue(){Y.trails&&(Y.trailInterval.pause(),Y.trails.dispose(),Y.trails=null,G.dispose(),G=null)}var ge=new t.Proportion(.1,2,.1,.01);try{if(localStorage){var ie=localStorage.zim_tl;ie||(ie=JSON.stringify({speed:1,labels:!1,looping:!1,color:purple})),ie=JSON.parse(ie),I(ie.speed),B.slider.currentValue=ie.speed,B.stepper.currentValue=ie.speed,N(ie.labels),F.checkBox.checked=ie.labels,p(ie.looping),fe.checkBox.checked=ie.looping,we(ie.color),Q.colorPicker.selectedColor=ie.color,Q.swatch.color=ie.color,Q.colorLabel.text=ie.color.toUpperCase(),ie.trailing&&q(),se.checkBox.checked=ie.trailing,Y.trailInterval.time=ge.convert(ie.speed)}}catch (e15){}this.pos(0,20,"center","bottom"),s!=t.purple&&we(s),this.dispose=function(xe,Se,z){return t.Ticker.remove(Y.tickerID),v.off("keydown",Y.keyEvent),z||this.zimContainer_dispose(!0),!0},T!==!1&&t.styleTransforms(this,x)},t.extend(t.Timeline,t.Container,"dispose","zimContainer",!1),t.BlurEffect=function(e,r,i,l,a,s){var f="blurX, blurY, quality, style, group, inherit",u;if(u=st(t.BlurEffect,arguments,f,this))return u;De("69.972"),this.group=a;var y=l===!1?{}:t.getStyle("BlurEffect",a,s);n(e)&&(e=y.blurX!=null?y.blurX:10),n(r)&&(r=y.blurY!=null?y.blurY:10),n(i)&&(i=y.quality!=null?y.quality:1);var k=g(e,r,i);this.veeObj={blurX:k[0],blurY:k[1],quality:k[2]};function g(){return arguments}e=nt(e),r=nt(r),i=nt(i),this.createjsBlurFilter_constructor(e,r,i),this.type="BlurEffect",this.clone=function(O){return new t.BlurEffect(O||!t.isPick(k[0])?e:k[0],O||!t.isPick(k[1])?r:k[1],O||!t.isPick(k[2])?i:k[2],l,this.group,s)}},t.extend(t.BlurEffect,Fe.BlurFilter,"clone","createjsBlurFilter",!1),t.GlowEffect=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",E;if(E=st(t.GlowEffect,arguments,T,this))return E;De("69.9725"),this.group=g;var A=k===!1?{}:t.getStyle("GlowEffect",g,O);n(e)&&(e=A.color!=null?A.color:t.white),n(r)&&(r=A.alpha!=null?A.alpha:1),n(i)&&(i=A.blurX!=null?A.blurX:30),n(l)&&(l=A.blurY!=null?A.blurY:30),n(a)&&(a=A.strength!=null?A.strength:1),n(s)&&(s=A.quality!=null?A.quality:1),n(f)&&(f=A.inner!=null?A.inner:!1),n(u)&&(u=A.knockout!=null?A.knockout:!1),n(y)&&(y=A.hideObject!=null?A.hideObject:!1);var C=d(e,r,i,l,a,s,f,u,y);this.veeObj={color:C[0],alpha:C[1],blurX:C[2],blurY:C[3],strength:C[4],quality:C[5],inner:C[6],knockout:C[7],hideObject:C[8]};function d(){return arguments}i=nt(i),l=nt(l),s=nt(s),e=nt(e),this.alpha=nt(r),this.strength=nt(a),this.inner=nt(f),this.knockout=nt(u),this.hideObject=nt(y),this.createjsBlurFilter_constructor(i,l,s),this.type="GlowEffect",this.usesContext=!0,this.applyFilter=function(x,P,v,w,b,X,Y,m){if((this.alpha<=0||this.strength<=0)&&!this.knockout)return!0;X=X||x,Y===void 0&&(Y=P),m===void 0&&(m=v);var j=X.getImageData(Y,m,w,b),S=j.data,_=document.createElement("canvas");_.width=w,_.height=b;for(var R=_.getContext("2d",{willReadFrequently:!0}),U=R.getImageData(0,0,w,b),Z=U.data,K=this.inner,ne=this._red,V=this._green,D=this._blue,c=0,h=Z.length;c<h;c+=4){var o=c+3,I=S[o];K?I!==255&&(Z[c]=ne,Z[c+1]=V,Z[c+2]=D,Z[o]=255-I):I!==0&&(Z[c]=ne,Z[c+1]=V,Z[c+2]=D,Z[o]=I)}R.putImageData(U,0,0);var N=this.strength;if(0<N){this.createjsBlurFilter_applyFilter(R,0,0,w,b),255<N&&(N=255);for(var p=1;p<N;p++)R.drawImage(_,0,0)}var L=this.alpha;L<0?L=0:1<L&&(L=1);var we;return this.knockout?K?we="source-in":we="source-out":this.hideObject?K?we="source-in":we="copy":K?we="source-atop":we="destination-over",X.save(),X.setTransform(1,0,0,1,0,0),X.globalAlpha=L,X.globalCompositeOperation=we,X.drawImage(_,Y,m),X.restore(),!0},Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(x){x=t.convertColor(x,"hexNumber"),this._red=x>>16&255,this._green=x>>8&255,this._blue=x&255}}),this.color=e,this.clone=function(x){return new t.GlowFilter(x||!t.isPick(C[0])?e:C[0],x||!t.isPick(C[1])?r:C[1],x||!t.isPick(C[2])?i:C[2],x||!t.isPick(C[3])?l:C[3],x||!t.isPick(C[4])?s:C[4],x||!t.isPick(C[5])?a:C[5],x||!t.isPick(C[6])?f:C[6],x||!t.isPick(C[7])?u:C[7],x||!t.isPick(C[8])?u:C[8],k,this.group,O)}},t.extend(t.GlowEffect,Fe.BlurFilter,["clone","applyFilter"],"createjsBlurFilter",!1),t.ShadowEffect=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E){var A="distance, angle, color, alpha, blurX, blurY, strength, quality, inner, knockout, hideObject, style, group, inherit",C;if(C=st(t.ShadowEffect,arguments,A,this))return C;De("69.973"),this.group=T;var d=O===!1?{}:t.getStyle("ShadowEffect",T,E);n(e)&&(e=d.distance!=null?d.distance:10),n(r)&&(r=d.angle!=null?d.angle:45),n(i)&&(i=d.color!=null?d.color:t.black),n(l)&&(l=d.alpha!=null?d.alpha:.4),n(a)&&(a=d.blurX!=null?d.blurX:15),n(s)&&(s=d.blurY!=null?d.blurY:15),n(f)&&(f=d.strength!=null?d.strength:1),n(u)&&(u=d.quality!=null?d.quality:1),n(y)&&(y=d.inner!=null?d.inner:!1),n(k)&&(k=d.knockout!=null?d.knockout:!1),n(g)&&(g=d.hideObject!=null?d.hideObject:!1);var x=P(e,r,i,l,a,s,f,u,y,k,g);this.veeObj={distance:x[0],angle:x[1],color:x[2],alpha:x[3],blurX:x[4],blurY:x[5],strength:x[6],quality:x[7],inner:x[8],knockout:x[9],hideObject:x[10]};function P(){return arguments}a=nt(a),s=nt(s),u=nt(u),i=nt(i),e=nt(e),r=nt(r);var v=this;this.alpha=nt(l),this.strength=nt(f),this.inner=nt(y),this.knockout=nt(k),this.hideObject=nt(g),this.createjsBlurFilter_constructor(a,s,u),this.type="ShadowEffect",this.usesContext=!0,Object.defineProperty(this,"angle",{get:function(){return r},set:function(b){r=b=(b%360+360)%360,w(e,b)}}),this.angle=r,Object.defineProperty(this,"distance",{get:function(){return e},set:function(b){e=b,w(b,r)}}),this.distance=e;function w(b,X){var Y=X*t.RAD;v._offsetX=Math.cos(Y)*b,v._offsetY=Math.sin(Y)*b}Object.defineProperty(this,"color",{get:function(){return this._red<<16|this._green<<8|this._blue},set:function(b){b=t.convertColor(b,"hexNumber"),this._red=b>>16&255,this._green=b>>8&255,this._blue=b&255}}),this.color=i,this.applyFilter=function(b,X,Y,m,j,S,_,R){if((this.alpha<=0||this.strength<=0)&&!this.knockout&&!this.hideObject)return!0;S=S||b,_===void 0&&(_=X),R===void 0&&(R=Y);var U=S.getImageData(_,R,m,j),Z=U.data,K=document.createElement("canvas");K.width=m,K.height=j;for(var ne=K.getContext("2d",{willReadFrequently:!0}),V=ne.getImageData(0,0,m,j),D=V.data,c=this.inner,h=this._red,o=this._green,I=this._blue,N=0,p=D.length;N<p;N+=4){var L=N+3,we=Z[L];c?we!==255&&(D[N]=h,D[N+1]=o,D[N+2]=I,D[L]=255-we):we!==0&&(D[N]=h,D[N+1]=o,D[N+2]=I,D[L]=we)}ne.putImageData(V,0,0);var B=this.strength;if(0<B){this.createjsBlurFilter_applyFilter(ne,0,0,m,j),255<B&&(B=255);for(var F=1;F<B;F++)ne.drawImage(K,0,0)}var fe=this.alpha;fe<0?fe=0:1<fe&&(fe=1);var se;return this.knockout?c?se="source-in":se="source-out":this.hideObject?c?se="source-in":se="copy":c?se="source-atop":se="destination-over",S.save(),S.setTransform(1,0,0,1,0,0),S.globalAlpha=fe,S.globalCompositeOperation=se,S.drawImage(K,_+this._offsetX,R+this._offsetY),S.restore(),!0},this.getBounds=function(b){var X=this.createjsBlurFilter_getBounds(b),Y=this._offsetX,m=this._offsetY;return Y!==0&&(Y<0?(X.x+=Y,X.width+=-Y):X.width+=Y),m!==0&&(m<0?(X.y+=m,X.height+=-m):X.height+=m),X},this.clone=function(b){return new t.ShadowFilter(b||!t.isPick(x[0])?e:x[0],b||!t.isPick(x[1])?r:x[1],b||!t.isPick(x[2])?i:x[2],b||!t.isPick(x[3])?l:x[3],b||!t.isPick(x[4])?a:x[4],b||!t.isPick(x[5])?s:x[5],b||!t.isPick(x[6])?u:x[6],b||!t.isPick(x[7])?f:x[7],b||!t.isPick(x[8])?y:x[8],b||!t.isPick(x[9])?k:x[9],b||!t.isPick(x[10])?g:x[10],O,this.group,E)}},t.extend(t.ShadowEffect,Fe.BlurFilter,["clone","getBounds","applyFilter"],"createjsBlurFilter",!1),t.ColorEffect=function(e,r,i,l,a,s,f,u,y,k,g){var O="redMultiplier, greenMultiplier, blueMultiplier, alphaMultiplier, redOffset, greenOffset, blueOffset, alphaOffset, style, group, inherit",T;if(T=st(t.ColorEffect,arguments,O,this))return T;De("69.9735"),this.group=k;var E=y===!1?{}:t.getStyle("ColorEffect",k,g);n(e)&&(e=E.redMultiplier!=null?E.redMultiplier:1),n(r)&&(r=E.greenMultiplier!=null?E.greenMultiplier:1),n(i)&&(i=E.blueMultiplier!=null?E.blueMultiplier:1),n(l)&&(l=E.alphaMultiplier!=null?E.alphaMultiplier:1),n(a)&&(a=E.redOffset!=null?E.redOffset:0),n(s)&&(s=E.greenOffset!=null?E.greenOffset:0),n(f)&&(f=E.blueOffset!=null?E.blueOffset:0),n(u)&&(u=E.alphaOffset!=null?E.alphaOffset:0);var A=C(e,r,i,l,a,s,f,u);this.veeObj={redMultiplier:A[0],greenMultiplier:A[1],blueMultiplier:A[2],alphaMultiplier:A[3],redOffset:A[4],greenOffset:A[5],blueOffset:A[6],alphaOffset:A[7]};function C(){return arguments}e=nt(e),r=nt(r),i=nt(i),l=nt(l),a=nt(a),s=nt(s),f=nt(f),u=nt(u),this.createjsColorFilter_constructor(e,r,i,l,a,s,f,u),this.type="ColorEffect",this.clone=function(d){return new t.ColorEffect(e,r,i,l,a,s,f,u,d||!t.isPick(A[0])?e:A[0],d||!t.isPick(A[1])?r:A[1],d||!t.isPick(A[2])?i:A[2],d||!t.isPick(A[2])?l:A[3],d||!t.isPick(A[2])?a:A[4],d||!t.isPick(A[2])?s:A[5],d||!t.isPick(A[2])?f:A[6],d||!t.isPick(A[2])?u:A[7],y,this.group,g)}},t.extend(t.ColorEffect,Fe.ColorFilter,"clone","createjsColorFilter",!1),t.MultiEffect=function(e,r,i,l,a,s,f){var u="hue, saturation, brightness, contrast, style, group, inherit",y;if(y=st(t.MultiEffect,arguments,u,this))return y;De("69.974"),this.group=s;var k=a===!1?{}:t.getStyle("MultiEffect",s,f);n(e)&&(e=k.hue!=null?k.hue:0),n(r)&&(r=k.saturation!=null?k.saturation:0),n(i)&&(i=k.brightness!=null?k.brightness:0),n(l)&&(l=k.contrast!=null?k.contrast:0);var g=O(e,r,i,l);this.veeObj={hue:g[0],saturation:g[1],brightness:g[2],contrast:g[3]};function O(){return arguments}e=nt(e),this.createjsColorMatrixFilter_constructor(new Fe.ColorMatrix().adjustColor(i,l,r,e)),this.type="MultiEffect",this.adjustColor=function(T,E,A,C){n(e)||(e=nt(T)),n(r)||(r=nt(E)),n(i)||(i=nt(A)),n(l)||(l=nt(C)),this.matrix.reset().adjustColor(T,E,A,C)},Object.defineProperty(this,"brightness",{get:function(){return i},set:function(T){i=nt(T),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"contrast",{get:function(){return l},set:function(T){l=nt(T),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"saturation",{get:function(){return r},set:function(T){r=nt(T),this.matrix.reset().adjustColor(i,l,r,e)}}),Object.defineProperty(this,"hue",{get:function(){return e},set:function(T){e=nt(T),this.matrix=new Fe.ColorMatrix().adjustColor(i,l,r,e),this.applyFilter()}}),this.clone=function(T){return new t.MultiEffect(T||!t.isPick(g[0])?e:g[0],T||!t.isPick(g[0])?r:g[0],T||!t.isPick(g[0])?i:g[0],T||!t.isPick(g[0])?l:g[0],a,this.group,f)}},t.extend(t.MultiEffect,Fe.ColorMatrixFilter,"clone","createjsColorMatrixFilter",!1),t.AlphaEffect=function(e,r,i,l){var a="mask, style, group, inherit",s;if(s=st(t.AlphaEffect,arguments,a,this))return s;De("69.9745"),this.group=i;var f=r===!1?{}:t.getStyle("AlphaEffect",i,l);n(e)&&(e=f.mask!=null?f.mask:null);var u=y(e);this.veeObj={mask:u[0]};function y(){return arguments}e=nt(e),e.type=="Bitmap"?e=e.image:e.cache&&(e=e.cache().cacheCanvas),this.createjsAlphaMaskFilter_constructor(e),this.type="AlphaEffect",this.clone=function(k){return new t.AlphaEffect(k||!t.isPick(u[0])?e:u[0],r,this.group,l)}},t.extend(t.AlphaEffect,Fe.AlphaMaskFilter,"clone","createjsAlphaMaskFilter",!1),t.Pixel=function(e,r,i,l,a,s,f,u,y,k,g,O,T){var E="obj, amount, amountY, blur, dynamic, blendmode, boundary, expand, amountFactor, blurFactor, style, group, inherit",A;if(A=st(t.Pixel,arguments,E,this))return A;De("69.9747"),this.group=O;var C=g===!1?{}:t.getStyle("Pixel",O,T);n(e)&&(e=C.obj!=null?C.obj:null),n(r)&&(r=C.amount!=null?C.amount:.5),n(i)&&(i=C.amountY!=null?C.amountY:null);var d=!1;i==null&&(d=!0,i=r),n(l)&&(l=C.blur!=null?C.blur:0),n(a)&&(a=C.dynamic!=null?C.dynamic:!1),n(s)&&(s=C.blendmode!=null?C.blendmode:null),n(f)&&(f=C.boundary!=null?C.boundary:new t.Boundary(e.getBounds())),n(u)&&(u=C.expand!=null?C.expand:0),n(y)&&(y=C.amountFactor!=null?C.amountFactor:.6),n(k)&&(k=C.blurFactor!=null?C.blurFactor:.6);var x=P(e,r,i,l,s,y,k);this.veeObj={obj:x[0],amount:x[1],amountY:x[2],blur:x[3],blendmode:x[4],amountFactor:x[5],blurFactor:x[6]};function P(){return arguments}e=nt(e),r=nt(r),i=nt(i),l=nt(l),s=nt(s),y=nt(y),k=nt(k),u&&(Array.isArray(u)?u.length==1?f.contract(-u):u.length==2?f.contract(-u[0],-u[1]):f.contract(-u[0],-u[1],-u[2],-u[3]):f.contract(-u));var v=t.constrain(y*10,0,10),w=t.constrain(k*10,0,10),b=this,X=Math.pow(Math.E,-r*v),Y=Math.pow(Math.E,-i*v),m=Math.pow(Math.E,-l*w);n(e)&&(e=new t.Tile(new t.Circle(20,[t.green,t.blue,t.yellow,t.pink,t.purple]),5,5,5,5));var j=document.createElement("canvas"),S=j.getContext("2d"),_=document.createElement("canvas"),R=_.getContext("2d"),U=m;this.update=function(){!e.cacheCanvas||m!=U?(e.cache(f.x,f.y,f.width,f.height,m),U=m):e.updateCache(s);var Z=e.width,K=e.height,ne=e.width*X,V=e.height*Y;j.width=Z,j.height=K,_.width=Z,_.height=K,R.msImageSmoothingEnabled=!1,R.mozImageSmoothingEnabled=!1,R.webkitImageSmoothingEnabled=!1,R.imageSmoothingEnabled=!1,S.drawImage(e.cacheCanvas,0,0,ne,V),R.drawImage(j,0,0,ne,V,-u*e.scale,-u*e.scale,_.width+u*2*e.scaleX,_.height+u*2*e.scaleY)},this.update(),this.zimBitmap_constructor(_),a&&(this.dynamicTicker=t.Ticker.add(function(){b.update()})),Object.defineProperty(this,"amount",{get:function(){return r},set:function(Z){r=Z,X=Math.pow(Math.E,-r*v),d&&(Y=Math.pow(Math.E,-r*v),i=r),b.update()}}),Object.defineProperty(this,"amountX",{get:function(){return r},set:function(Z){r=Z,d=!1,X=Math.pow(Math.E,-r*v),b.update()}}),Object.defineProperty(this,"amountY",{get:function(){return i},set:function(Z){i=Z,d=!1,Y=Math.pow(Math.E,-i*v),b.update()}}),Object.defineProperty(this,"amountFactor",{get:function(){return y},set:function(Z){y=Z,v=t.constrain(y*10,0,10),X=Math.pow(Math.E,-r*v),Y=Math.pow(Math.E,-i*v),b.update()}}),Object.defineProperty(this,"blur",{get:function(){return l},set:function(Z){l=Z,m=Math.pow(Math.E,-l*w),b.update()}}),Object.defineProperty(this,"blurFactor",{get:function(){return k},set:function(Z){k=Z,w=t.constrain(k*10,0,10),m=Math.pow(Math.E,-l*w),b.update()}}),Object.defineProperty(this,"dynamic",{get:function(){return a},set:function(Z){a!=Z&&(a=Z,a?b.dynamicTicker?b.dynamicTicker=t.Ticker.add(b.dynamicTicker):b.dynamicTicker=t.Ticker.add(b.update):b.dynamicTicker&&t.Ticker.remove(b.dynamicTicker))}}),this.dispose=function(){b.dynamicTicker&&t.Ticker.remove(b.dynamicTicker),this.zimBitmap_dispose()},g!==!1&&t.styleTransforms(this,C),this.clone=function(Z){return b.cloneProps(new t.Pixel(Z||!t.isPick(x[0])?e:x[0],Z||!t.isPick(x[1])?r:x[1],Z||!t.isPick(x[2])?i:x[2],Z||!t.isPick(x[3])?l:x[3],a,Z||!t.isPick(x[4])?s:x[4],f,u,Z||!t.isPick(x[5])?y:x[5],Z||!t.isPick(x[6])?k:x[6],g,this.group,T))}},t.extend(t.Pixel,t.Bitmap,["clone","dispose"],"zimBitmap",!1),t.Parallax=function(e,r,i,l,a,s,f){var u="layers, damp, auto, stage, startPaused, mouseMoveOutside, clamp",y;if(y=st(t.Parallax,arguments,u,this))return y;if(De("68"),this.type="Parallax",n(l))if(e&&e[0]&&e[0].obj&&e[0].obj.stage)l=e[0].obj.stage;else if(ee.zdf)l=ee.zdf.stage;else return;n(i)?i=!0:i=!1,n(a)&&(a=!1),n(s)&&(s=!1);var k=l.getBounds().width,g=l.getBounds().height;l.mouseMoveOutside=s;var O=this;O.stageEvent=l.on("stagemousemove",function(x){O.mouseX=x.rawX/t.scaX,O.mouseY=x.rawY/t.scaY});var T=n(r)?.1:r;this.addLayer=function(x){if(!(n(x.obj)||n(x.prop)||n(x.propChange))){var P={obj:x.obj,prop:x.prop};P[P.prop]=x.propChange,n(x.input)&&(x.input="mouseX"),P.input=x.input,P.split=n(x.split)?!!(x.input=="mouseX"&&i):x.split;var v=n(x.inMin)?0:x.inMin,w=n(x.inMax)?x.input=="mouseX"||x.input=="scrollX"?k:g:x.inMax,b=n(x.factor)?1:x.factor,X=n(x.integer)?!1:x.integer;return P["p_"+P.prop]=new t.ProportionDamp(v,w,0,P[P.prop],T,b,X,f),P.prop=="scale"?P["s_"+P.prop]=P.obj.scaleX:P.prop=="frame"?P["s_"+P.prop]=P.obj.currentFrame:P["s_"+P.prop]=P.obj[P.prop],n(x.immediate)||P["p_"+P.prop].immediate(x.immediate),E.push(P),O}},this.removeLayer=function(x){if(!n(x)){var P=E[x];return P["p_"+P.prop].dispose(),E.splice(x,1),O}},this.immediate=function(x){for(var P,v=0;v<E.length;v++)P=E[v],P["p_"+P.prop].immediate(x[v]);return O},this.dispose=function(){return l.off("stagemousemove",O.stageEvent),E=null,i&&t.Ticker.remove(C),!0},e=n(e)?[]:e;for(var E=[],A=0;A<e.length;A++)this.addLayer(e[A]);if(i){var C=t.Ticker.add(d,l);a&&t.Ticker.remove(C)}function d(){O.step()}this.step=function(x){for(var P,v,w=0;w<E.length;w++)P=E[w],n(x)?P.input=="mouseX"?v=O.mouseX:P.input=="mouseY"?v=O.mouseY:P.input=="scrollX"?v=t.scrollX():P.input=="scrollY"&&(v=t.scrollY()):v=x,P.prop=="scale"?P.obj.scaleX=P.obj.scaleY=P["s_"+P.prop]+P["p_"+P.prop].convert(v):P.prop=="frame"?P.obj.gotoAndStop(P["s_"+P.prop]+P["p_"+P.prop].convert(v)):(P.obj[P.prop]=P["s_"+P.prop]+P["p_"+P.prop].convert(v),P.split&&(P.obj[P.prop]-=P[P.prop]/2));return O},O.paused=a,O.pause=function(x){return n(x)&&(x=!0),O.paused!=x&&(O.paused=x,C&&(x?t.Ticker.remove(C):C=t.Ticker.add(C))),O},Object.defineProperty(O,"damp",{get:function(){return T},set:function(x){T=x;for(var P,v=0;v<E.length;v++)P=E[v],P["p_"+P.prop].damp=T}})},t.Flipper=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E){var A="front, back, interactive, time, vertical, flipped, easeRoot, frontPress, backPress, reverse, continuous, style, group, inherit",C;if(C=st(t.Flipper,arguments,A,this))return C;De("68.5"),this.group=T;var d=O===!1?{}:t.getStyle("Flipper",this.group,E);if(n(e)&&(e=d.front!=null?d.front:ee.zdf.makeIcon().sca(2)),n(r)&&(r=d.back!=null?d.back:new t.Page(e.width,e.height,t.dark)),this.front=e,this.back=r,s){var x=e;e=r,r=x}var P=Math.max(e.width,r.width),v=Math.max(e.height,r.height);this.zimContainer_constructor(P,v),this.type="Flipper",n(l)&&(l=d.time!=null?d.time:.2),n(a)&&(a=d.vertical!=null?d.vertical:!1),n(i)&&(i=d.interactive!=null?d.interactive:!1),n(s)&&(s=d.flipped!=null?d.flipped:!1),n(f)&&(f=d.easeRoot!=null?d.easeRoot:"quad"),n(u)&&(u=d.frontPress!=null?d.frontPress:!0),n(y)&&(y=d.backPress!=null?d.backPress:!0),n(k)&&(k=d.reverse!=null?d.reverse:!1),n(g)&&(g=d.continuous!=null?d.continuous:!1);var w=s;this.flipped=s;var b=this;e.centerReg(this);var X;(u&&!s||y&&s)&&(X=i&&e.backing?e.backing:e,X.on("mousedown",function(){Y(e,r)}),X.cur()),(y&&!s||u&&s)&&(X=i&&r.backing?r.backing:r,X.on("mousedown",function(){Y(r,e,-1)}),X.cur()),e.oScale=e.scale,r.oScale=r.scale,e.flipper=b,e.other=r,r.flipper=b,r.other=e,i||(e.mouseChildren=r.mouseChildren=!1),this.flip=function(m,j){m!=b.flipped&&(b.flipped?Y(w?e:r,w?r:e,-1,j):Y(w?r:e,w?e:r,1,j))};function Y(m,j,S,_){if(n(S)&&(S=1),S*=k?-1:1,g&&(S=k?w?1:-1:w?-1:1),n(_)&&(_=l),b.flipped=!b.flipped,b.dispatchEvent("flip"),_==0){b.removeAllChildren(),j.scale=j.oScale,j.skewX=j.skewY=0,j.centerReg(b),b.dispatchEvent("flipped");return}var R,U;a?(R={skewX:-90*S,scaleY:m.oScale/2},U={skewX:0,scaleY:j.oScale},j.ske(90*S,0).sca(j.oScale,j.oScale/2)):(R={skewY:-90*S,scaleX:m.oScale/2},U={skewY:0,scaleX:j.oScale},j.ske(0,90*S).sca(j.oScale/2,j.oScale)),m.animate({props:R,time:l,ease:f+"In",call:function(){m.removeFrom(),j.centerReg(b).animate({props:U,time:l,ease:f+"Out",call:function(){b.dispatchEvent("flipped")}})}})}O!==!1&&t.styleTransforms(this,d),this.clone=function(){return b.cloneProps(new t.Flipper(e.clone(),r.clone(),i,l,a,s,f,u,y,k,g,O,this.group,E))}},t.extend(t.Flipper,t.Container,"clone","zimContainer"),t.Book=function(e,r,i,l,a,s,f,u,y){var k="width, height, pages, startPage, rollUp, radius, backgroundColor, arrows, handleHTML",g;if(g=st(t.Book,arguments,k,this))return g;De("68.7"),n(e)&&(e=ee.zdf?ee.zdf.stage.width:1024),n(r)&&(r=ee.zdf?ee.zdf.stage.height:768),this.zimContainer_constructor(e,r),this.type="Book",n(i)&&(i=[]),n(l)&&(l=0),n(a)&&(a=!0),n(f)&&(f=t.darker),n(u)&&(u=!0),n(y)&&(y=!0),this.handleHTML=y;var O=Tt(),T=this;if(i.length==0)return;T.backing=new t.Rectangle(e-2,r-2,f),t.loop(i,function(X,Y){typeof X=="string"&&(i[Y]=t.asset(X)),i[Y].zimBookIndex=Y,x(X)}),T.added(d);var E,A,C;function d(X){E=X,A=E.frame;var Y=new t.Shape,m,j,S,_,R,U,Z;T._currentPage=l;function K(N){if(T._currentPage=N,T.removeAllChildren(),T.backing.loc(1,1,T),T.setMask(T.backing),Y.addTo(T),Y.c().f(t.black).dr(0,0,0,0),T.moving=!1,i[N-1]?m=i[N-1].reg(0,0).rot(0).loc(0,0,T):N>0&&Z.reg(0,0).rot(0).loc(0,0,T).setMask(null),i[N-2]?j=i[N-2].reg(e/2,r).loc(0,r,T).rot(-90):j=new t.Rectangle(e/2,r,f).reg(e/2,r).loc(0,r,T).rot(-90),i[N-3]?S=i[N-3].rot(0).loc(0,0,T).setMask(Y):S=new t.Rectangle(e/2,r,f).loc(0,0,T).setMask(Y),i[N])_=i[N].rot(0).reg(0,0).pos(0,0,t.RIGHT,t.TOP,T);else{E.update();return}i[N+1]?R=i[N+1].reg(0,r).loc(e,r,T).rot(90):(R=new t.Rectangle(e/2,r,f).reg(0,r).loc(e,r,T).rot(90),Z=R),i[N+2]?U=i[N+2].rot(0).pos(0,0,t.RIGHT,t.TOP,T).setMask(Y):U=new t.Rectangle(e/2,r,f).pos(0,0,t.RIGHT,t.TOP,T).setMask(Y),E.update()}K(l),Object.defineProperty(T,"directPage",{get:function(){return T._currentPage},set:function(N){b(),l%2==1?N=Math.ceil(N/2)*2-1:N=Math.ceil(N/2)*2,N!=T.page&&(N>T.page?(R.reg(0,0),U.setMask(null)):(j.reg(0,0),S.setMask(null)),K(N),T.moving=!1,ne=!1,T.currentW=0,T.currentH=0,w())}});var ne=!1;T.currentW=0,T.currentH=0,T.moving=!1;function V(){T.stageEvent=E.on("stagemousedown",function(){if(T.hitTestPoint(A.mouseX,A.mouseY)){var N,p;if(!T.moving){var L=T.globalToLocal(A.mouseX,A.mouseY);if(!(L.x<0||L.x>e||L.y<0||L.y>r)&&!(s>0&&t.dist(L,new t.Point(0,r))>s&&t.dist(L,new t.Point(e,r))>s)){var we=L.x>e/2?"right":"left";we=="right"&&T._currentPage>=i.length-1||we=="left"&&T._currentPage<=1||(T.moving=!0,we=="right"?(_.addTo(T),R.addTo(T),U.addTo(T),T.pageNext=U.zimBookIndex):(m.addTo(T),j.addTo(T),S.addTo(T),T.rolledUp&&h(0,0,"right"),T.pageNext=j.zimBookIndex),b(),T.direction=we,T.dispatchEvent("rollpress"),T.moveEvent=E.on("stagemousemove",function(){D&&(D.clear(),D=null);var B=T.globalToLocal(A.mouseX,A.mouseY);we=="right"?N=e-B.x:N=B.x,p=r-B.y+N,T.currentW=N=t.constrain(N,0,e/2),T.currentH=p=t.constrain(p,0,r),h(N,p,we)}),T.upEvent=E.on("stagemouseup",function(){E.off("stagemousemove",T.moveEvent),!ne&&c(N,p,we)},null,!0))}}}})}if(V(),T.rollUp=function(N,p,L,we,B){if(!T.moving&&!(L=="right"&&T._currentPage>=i.length-1)&&!(L=="left"&&T._currentPage<=1)){L=="right"?(_.addTo(T),R.addTo(T),U.addTo(T)):(T.rolledUp&&h(0,0,"right"),m.addTo(T),j.addTo(T),S.addTo(T)),T.moving=!0,n(we)&&(we=O=="s"?.5:.5/1e3),n(B)&&(B=null),T.animate({props:{currentW:N,currentH:p},time:we,ease:B,call:function(){t.Ticker.remove(F),T.moving=!1,h(N,p,L)}});var F=t.Ticker.add(function(){h(T.currentW,T.currentH,L)})}},a!==!1){T.rolledUp=!0,a===!0&&(a=O=="s"?1:1/1e3);var D=t.timeout(a,function(){T.rollUp(60,130,"right",.5),T.dispatchEvent("rollup")})}T.rollDown=function(N,p,L,we){T.moving||L=="right"&&T._currentPage>=i.length-1||L=="left"&&T._currentPage<=1||c(N,p,L,we)};function c(N,p,L,we){T.moving=!0,T.rolledUp=!1,n(we)&&(we=O=="s"?.7:.7/1e3),T.animate({props:{currentW:0,currentH:0},time:we,call:function(){t.Ticker.remove(B),h(0,0,L),T.moving=!1,w(),T.dispatchEvent("rolldown")}});var B=t.Ticker.add(function(){h(T.currentW,T.currentH,L)})}function h(N,p,L){var we;L=="right"?(Y.c().mt(e,r).lt(e-N,r).lt(e,r-p).cp(),we=Math.atan2(N,p),R.loc(e-(N+N*Math.cos(2*we)),r-N*Math.sin(2*we)).rot(we*2*t.DEG),!ne&&N>=e/2&&p>=r&&o()):(Y.c().mt(0,r).lt(N,r).lt(0,r-p).cp(),we=Math.atan2(N,p),j.loc(N+N*Math.cos(2*we),r-N*Math.sin(2*we)).rot(-we*2*t.DEG),!ne&&N>=e/2&&p>=r&&I()),E.update()}function o(){b(),ne=!0,T.moving=!0,T.moveEvent&&E.off("stagemousemove",T.moveEvent),T.upEvent&&E.off("stagemouseup",T.upEvent),T.currentW=0,T.currentH=0,T.lastPage=t.constrain(T._currentPage),T.direction="right",T.pageNext=U.zimBookIndex,T.dispatchEvent("pageanimate"),T.animate({ease:"quadOut",props:{currentW:e/2},time:.3,timeUnit:"s",call:function(){t.Ticker.remove(N),R.reg(0,0),U.setMask(null),K(T._currentPage+2),T.moving=!1,ne=!1,T.currentW=0,T.currentH=0,w(),T.dispatchEvent("page")}});var N=t.Ticker.add(function(){Y.c().mt(e,r).lt(e/2,r).lt(e-T.currentW,0).lt(e,0).cp()});R.reg(e/2,r).loc(e/2,r,T).animate({props:{rotation:0},time:.3,ease:"quadOut",timeUnit:"s"})}function I(){b(),ne=!0,T.moving=!0,T.moveEvent&&E.off("stagemousemove",T.moveEvent),T.upEvent&&E.off("stagemouseup",T.upEvent),T.currentW=0,T.currentH=0,T.lastPage=t.constrain(T._currentPage),T.direction="left",T.pageNext=j.zimBookIndex,T.dispatchEvent("pageanimate"),T.animate({ease:"quadOut",props:{currentW:e/2},time:.3,timeUnit:"s",call:function(){t.Ticker.remove(N),j.reg(0,0),S.setMask(null),K(T._currentPage-2),T.moving=!1,ne=!1,T.currentW=0,T.currentH=0,w(),T.dispatchEvent("page")}});var N=t.Ticker.add(function(){Y.c().mt(0,r).lt(e/2,r).lt(T.currentW,0).lt(0,0).cp()});j.reg(0,r).loc(e/2,r,T).animate({props:{rotation:0},time:.3,timeUnit:"s",ease:"quadOut"})}u&&(u===!0&&(u=.2),T.keydown=A.on("keydown",function(N){N.keyCode==39?T.nextPage(u):N.keyCode==37&&T.prevPage(u)})),T.changeFrame=function(N){return T.stageEvent&&E.off("stagemousedown",T.stageEvent),T.moveEvent&&E.off("stagemousemove",T.moveEvent),T.upEvent&&E.off("stagemouseup",T.upEvent),A=N,E=N.stage,V(),T},w()}T.nextPage=function(X){if(n(T.rollUp))return setTimeout(function(){T.nextPage(X)},10),T;T.moving||T.rollUp(e/2+.1,r+.1,"right",X,"quadIn")},T.prevPage=function(X){if(n(T.rollUp))return setTimeout(function(){T.prevPage(X)},10),T;T.moving||T.rollUp(e/2+.1,r+.1,"left",X,"quadIn")},T.gotoPage=function(X,Y){if(n(T.rollUp))return setTimeout(function(){T.gotoPage(X,Y)},10),T;X=t.constrain(X,0,T.pages.length-1),n(Y)&&(Y=O=="s"?.3:300);var m=Y+(O=="s"?.35:350);T.pageInterval=t.interval(m,function(j){var S=!1;T._currentPage<X?T.nextPage(Y):T._currentPage>X?T.prevPage(Y):S=!0,T.dispatchEvent("pageturn"),j.count==j.total-1&&(S?(w(),T.dispatchEvent("pagedone")):t.timeout(m,function(){w(),T.dispatchEvent("pagedone")}))},Math.floor(Math.abs(X-T._currentPage)/2+1),!0)};function x(X){X.addChild&&(X.zimHTMLList=new t.Dictionary,T.handleHTML&&v(X))}function P(X){if(!(n(X)||!X.addChild))for(X.removedHTML=!1,C=0;C<X.zimHTMLList.length;C++)X.addChildAt(X.zimHTMLList.values[C].obj,X.zimHTMLList.values[C].depth)}function v(X){if(!(X.removedHTML||!X.addChild)){X.removedHTML=!0,X.zimHTMLList.clear();var Y,m;for(m=0;m<X.numChildren;m++)if(Y=X.getChildAt(m),Y.type=="TextArea"||Y.type=="Loader"||Y.type=="Tag"){var j={obj:Y,depth:X.getChildIndex(Y)};X.zimHTMLList.add(Y,j)}for(m=X.numChildren-1;m>=0;m--)Y=X.getChildAt(m),(Y.type=="TextArea"||Y.type=="Loader"||Y.type=="Tag")&&X.removeChild(Y)}}function w(){T.handleHTML&&(T.pages[T.page]&&P(T.pages[T.page]),T.pages[T.page-1]&&P(T.pages[T.page-1]))}function b(){T.handleHTML&&(T.pages[T.page]&&v(T.pages[T.page]),T.pages[T.page-1]&&v(T.pages[T.page-1]))}Object.defineProperty(T,"page",{get:function(){return T._currentPage},set:function(X){T.gotoPage(X,O=="s"?.1:100)}}),Object.defineProperty(T,"pages",{get:function(){return i},set:function(){vt&&tt("Book() - pages is read only")}}),this.dispose=function(X,Y,m){return T.stageEvent&&E.off("stagemousedown",T.stageEvent),T.moveEvent&&E.off("stagemousemove",T.moveEvent),T.upEvent&&E.off("stagemouseup",T.upEvent),T.keydown&&A.off("keydown",T.keydown),T.removeFrom(),m||this.zimContainer_dispose(!0),!0}},t.extend(t.Book,t.Container,["clone","dispose"],"zimContainer"),t.Scrambler=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E){var A="tile, keys, keyProperty, scramble, time, wait, num, shadowColor, shadowBlur, swap, swapLock, style, group, inherit",C;if(C=st(t.Scrambler,arguments,A,this))return C;De("67.35"),this.zimContainer_constructor(null,null,null,null,!1),this.type="Scrambler",this.group=T;var d=O===!1?{}:t.getStyle(this.type,this.group,E);n(e)&&(e=d.tile!=null?d.tile:e),n(r)&&(r=d.keys!=null?d.keys:null),n(i)&&(i=d.keyProperty!=null?d.keyProperty:null),n(l)&&(l=d.scramble!=null?d.scramble:!0),n(a)&&(a=d.time!=null?d.time:0),n(s)&&(s=d.wait!=null?d.wait:0),n(f)&&(f=d.num!=null?d.num:1),n(u)&&(u=d.shadowColor!=null?d.shadowColor:"rgba(0,0,0,.3)"),n(y)&&(y=d.shadowBlur!=null?d.shadowBlur:5),n(k)&&(k=d.swap!=null?d.swap:!1),n(g)&&(g=d.swapLock!=null?d.swapLock:!1),g&&(k=!0),n(e)&&(e=new t.Tile(new t.Rectangle(100,100,t.series(t.silver,t.tin,t.grey,t.dark,t.darker)),5,1,5)),e.addTo(this);var x=this;x.tile=e,x.complete=!0;var P=Tt(a);Tt(s);var v=(e.width+e.spacingH)/e.cols,w=(e.height+e.spacingV)/e.rows,b=ee.zdf,X=t.makeID(null,10),Y,m,j,S=!1;e.pointers={},e.on("mousedown",function(D){if(S)return;S=!0,R(D.target),x.myDownCheck=!0,j=D.target;var c="id"+Math.abs(D.pointerID+1);if(e.pointers[c]=!0,Y=D.target.x,m=D.target.y,g){var h=e.current;if(x.testItem(D.target,h.indexOf(D.target))){D.target.noMouse(),D.target.noDrag(),D.target.locked=!0,x.myDownCheck=S=!1,U();return}}if(u!=-1&&y>0){var o=new Fe.Shadow(u,3,3,y);D.target.backing?D.target.backing.shadow=o:D.target.shadow=o}b&&(x.scrmu||(x.scrmu=b.on("mouseupplusonly",function(p){if(x.myDownCheck){x.myDownCheck=!1;var L=t.loop(e.pointers,function(we,B){return B});L||(e.pointers.id0=!0),p={target:j,pointerID:p.pointerID?L:-1},I(p)}}))),x.upEvent&&e.off("pressup",x.upEvent),x.upEvent=e.on("pressup",function(p){var L="id"+Math.abs(p.pointerID+1);e.pointers[L]&&(x.myDownCheck=S=!1,I(p))});function I(p){var L="id"+Math.abs(p.pointerID+1);if(e.pointers[L]){delete e.pointers[L];var we=!0;if(U(),S=!1,x.moveEvent&&e.off("pressmove",x.moveEvent),g){var B=p.target.boundsToGlobal(),F=e.hitTestGrid(e.width,e.height,e.cols,e.rows,B.x+B.width/2,B.y+B.height/2,null,null,e.spacingH,e.spacingV,null,"open");if(n(F))we=!1;else{var fe=h[F[0]];p.target==fe?we=!1:we=!x.testItem(fe,F[0])}}k&&we&&_(p),p.target.mouseEnabled=!1,p.target.animate({props:{x:Y,y:m},time:.1,id:X,timeUnit:"seconds",pauseOnBlur:!1,call:N,params:p})}}function N(p){!x.complete&&x.test()&&(x.complete=!0,x.dispatchEvent("complete")),u!=-1&&y>0&&(p.target.backing?p.target.backing.shadow=null:p.target.shadow=null),p.target.mouseEnabled=!0}k||(x.moveEvent&&e.off("pressmove",x.moveEvent),x.moveEvent=e.on("pressmove",function(p){_(p)}))});function _(D){var c=D.target;c.stopAnimate();var h=c.boundsToGlobal(),o=e.hitTestGrid(e.width,e.height,e.cols,e.rows,h.x+h.width/2,h.y+h.height/2,null,null,e.spacingH,e.spacingV,null,"open");n(o)||t.loop(e,function(I){if(!(I==c||I.paused===!1)){var N=I.boundsToGlobal(),p=e.hitTestGrid(e.width,e.height,e.cols,e.rows,N.x+N.width/2,N.y+N.height/2,null,null,e.spacingH,e.spacingV,null,"open");if(!n(p)){var L;o[2]==p[2]&&(I.x>=c.x&&I.x<=c.x+v/2||I.x<=c.x&&I.x>=c.x-v/2)&&(L=I.x,I.top().ord(-1),I.animate({props:{x:Y},time:.2,id:X,timeUnit:"seconds",call:function(){k&&!x.complete&&x.test()&&(x.complete=!0,x.dispatchEvent("complete"))}}),Y=L),o[1]==p[1]&&(I.y>=c.y&&I.y<=c.y+w/2||I.y<=c.y&&I.y>=c.y-w/2)&&(L=I.y,I.top().ord(-1),I.animate({props:{y:m},time:.201,override:!1,id:X,timeUnit:"seconds",call:function(){k&&!x.complete&&x.test()&&(x.complete=!0,x.dispatchEvent("complete"))}}),m=L)}}},!0)}function R(D){e.loop(function(c){c!=D&&c.noMouse()})}function U(){e.loop(function(D){D.locked||D.mouse()})}this.test=function(){var D=e.current;return t.loop(D,function(c,h){if(n(c)||!x.testItem(c,h))return!1})},this.testItem=function(D,c){if(!n(D)){if(n(c)&&(c=e.current.indexOf(D)),r){var h=n(i)?D.key:D[i];if(h!=r[c])return!1}else if(e.items[c]!=D)return!1;return!0}},this.update=function(){return e.noDrag(),e.drag({boundary:e,singleTouch:!0}),this},this.starts=[];var Z=[];t.loop(e.rows*e.cols,function(D){Z.push(D)});var K=Z.slice();e.loop(function(D){D.mouseChildren=!1,x.starts.push({x:D.x,y:D.y})}),this.inactive=!1,this.scramble=function(D,c,h){n(c)&&(c=0),n(D)&&(D=0),(n(h)||D==0)&&(h=1),ne(),t.timeout(c,function(){D>0?t.interval(D/h,o,h,!0):o()}),setTimeout(function(){x.complete=!1,e.loop(function(I){I.mouse(),I.locked=!1}),x.mouse(),e.drag({boundary:e,singleTouch:!0}),S=!1},P=="s"?(c+D)*1e3:c+D);function o(){for(var I=!0,N=0;I&&N<50;)N++,t.shuffle(Z),I=t.loop(Z,function(p,L){var we=e.getChildAt(p);if(r){var B=n(i)?we.key:we[i];if(B!=r[L])return!1}else if(e.items[L]!=we)return!1});V(Z,D/h),t.timeout(D,function(){x.dispatchEvent("scrambled")})}return x},l?x.scramble(a,s,f):x.added(function(){e.drag({boundary:e,singleTouch:!0})});function ne(){x.upEvent&&e.off("pressup",x.upEvent),x.moveEvent&&e.off("pressmove",x.moveEvent),e.noDrag(),s+a>0&&x.noMouse()}function V(D,c,h){t.stopAnimate(X),t.loop(e.items,function(o,I,N){var p=x.starts[D[I]];c?o.animate({props:{x:p.x,y:p.y},time:c,ease:h?"quadInOut":"quadOut",wait:h,timeUnit:"seconds",id:X}):(o.loc(p),x.stage?o.drag({boundary:e,singleTouch:!0}):I==N-1&&x.added(function(){e.drag({boundary:e,singleTouch:!0})}))})}this.solve=function(D,c,h){n(h)&&(h=!0),n(c)&&(c=0),n(D)&&(D=0),c+D==0&&h&&x.noMouse(),setTimeout(function(){Z=K.slice(),ne(),V(Z,D,0,h)},P=="s"?c*1e3:c),h||setTimeout(function(){x.mouse(),e.drag({boundary:e,singleTouch:!0})},P=="s"?(c+D)*1e3:c+D)},this._enabled=!0,Object.defineProperty(x,"enabled",{get:function(){return x._enabled},set:function(D){Ot(x,D),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&x.stage&&x.stage.update()}}),Object.defineProperty(x,"order",{get:function(){var D=[],c=t.loop(e.current,function(h){if(!h)return!1;D.push(h.tileNum)});return!c||D.length!=Z.length||(Z=D),Z},set:function(D){var c=[];t.loop(D,function(h){c.push(e.items[h])}),e.remake(c),e.stage&&e.stage.update()}}),this.dispose=function(D,c,h){return x.scrmu&&b.off("mouseupplus",x.scrmu),e.removeAllEventListeners(),h||(x.zimContainer_dispose(!0),x.stage&&x.stage.update()),!0},O!==!1&&t.styleTransforms(this,d),this.clone=function(){return x.cloneProps(new t.Scrambler(e.clone(),r,i,l,a,s,f,u,y,k,g,O,x.group,E))}},t.extend(t.Scrambler,t.Container,["clone","dispose"],"zimContainer",!1),t.Scroller=function(e,r,i,l,a,s,f,u,y,k,g){var O="backing, speed, direction, horizontal, gapFix, stage, container, backing2, style, group, inherit",T;if(T=st(t.Scroller,arguments,O,this))return T;De("69"),this.cjsEventDispatcher_constructor(),this.type="Scroller",this.group=k;var E=y===!1?{}:t.getStyle(this.type,this.group,g);if(n(e)&&(e=E.backing!=null?E.backing:null),n(e))return;var A=this.backing1=e;if(n(A)||!A.getBounds)return;var C;n(u)?C=this.backing2=e.clone(!0):C=u,n(l)&&(l=E.horizontal!=null?E.horizontal:!0),n(a)&&(a=E.gapFix!=null?E.gapFix:0),n(f)&&(f=E.container!=null?E.container:null),n(s)&&(s=E.stage!=null?E.stage:null);var d=this;n(r)&&(r=E.speed!=null?E.speed:1),this.speed=r;var x=this.baseSpeed=this.speed;n(i)&&(i=E.direction!=null?E.direction:1),this.direction=i;var P=l?A.scaleX:A.scaleY;if(A.type=="AC"){tt("ZIM Scroller(): please provide Pic() with dimensions for backing objects");return}if(!A.getBounds()){tt("ZIM Scroller(): please setBounds() on backing objects");return}if(!s&&!A.stage){tt("ZIM Scroller(): please pass in stage parameter or add backing objects to stage to start");return}if(!A.parent){tt("ZIM Scroller(): please add object to container or stage before adding to Scroller");return}if(A.parent.addChildAt(C,A.parent.getChildIndex(A)),s=s||A.stage,n(f)&&(f=s),!f.getBounds()){tt("zim display - Scroller(): please setBounds() on container or stage if no container");return}var v=A.getBounds().width*P-a,w=A.getBounds().height*P-a,b,X;l?C.x=v:C.y=w;var Y=!1,m=t.Ticker.add(j,s);function j(){b||(b=f.getBounds().width,X=f.getBounds().height),!(d.speed==0||d.direction==0)&&(l?(A.x-=d.speed*d.direction,A.x<C.x?C.x=A.x+v:C.x=A.x-v,d.direction*d.speed>0?C.x<0&&A.x<C.x?A.x=C.x+v:A.x<0&&C.x<A.x&&(C.x=A.x+v):C.x>b&&C.x>A.x?C.x=A.x-v:A.x>b&&A.x>C.x&&(A.x=C.x-v)):(A.y-=d.speed*d.direction,A.y<C.y?C.y=A.y+w:C.y=A.y-w,d.direction*d.speed>0?C.y<0&&A.y<C.y?A.y=C.y+w:A.y<0&&C.y<A.y&&(C.y=A.y+w):C.y>X&&C.y>A.y?C.y=A.y-w:A.y>X&&A.y>C.y&&(A.y=C.y-w)))}this.paused=!1,this.pause=function(S,_){return n(S)&&(S=!0),n(_)&&(_=0),S?(x=d.speed,_>0?(Y=!0,t.animate({target:d,obj:{pausingSpeed:0},ticker:!1,time:_,call:function(){d.speed=0,d.paused=!0,Y=!1,d.dispatchEvent("pause")}})):(Y=!1,d.speed=0,d.paused=!0,setTimeout(function(){d.dispatchEvent("pause")},10))):(Y=!1,_>0?t.animate({target:d,obj:{pausingSpeed:x},ticker:!1,time:_,call:function(){d.speed=x,d.paused=!1,Y=!1}}):(d.speed=x,d.paused=!1)),d},Object.defineProperty(d,"percentSpeed",{get:function(){return d.baseSpeed==0?NaN:d.speed/d.baseSpeed*100},set:function(S){Y||d.paused||(d.speed=d.baseSpeed*S/100)}}),Object.defineProperty(d,"pausingSpeed",{get:function(){return d.baseSpeed==0?NaN:d.speed/d.baseSpeed*100},set:function(S){d.speed=d.baseSpeed*S/100}}),Object.defineProperty(d,"percentComplete",{get:function(){return l?A.x<0&&A.x>C.x?-A.x/A.width*100:(-C.x/C.width*100+1e9)%100:A.y<0&&A.y>C.y?-A.y/A.height*100:(-C.y/C.height*100+1e9)%100},set:function(S){S=(S+1e9)%100,l?(A.x=-S*A.width/100,C.x=A.x+v):(A.y=-S*A.height/100,C.y=A.y+w)}}),y!==!1&&t.styleTransforms(this,E),this.dispose=function(){return t.Ticker.remove(m),!0}},t.extend(t.Scroller,Fe.EventDispatcher,null,"cjsEventDispatcher"),t.Dynamo=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="sprite, speed, label, startFrame, endFrame, update, reversible, flip, flipVertical, style, group, inherit",E;if(E=st(t.Dynamo,arguments,T,this))return E;De("69.2"),this.cjsEventDispatcher_constructor(),this.type="Dynamo",this.group=g;var A=k===!1?{}:t.getStyle(this.type,this.group,O);if(n(e)&&(e=A.sprite!=null?A.sprite:null),n(e))return;var C=this.frames=e.parseFrames(i,l,a,!0);if(C.length==0)return;this.totalFrames=C.length;var d=0;n(r)&&(r=A.speed!=null?A.speed:30),n(f)&&(f=A.reversible!=null?A.reversible:!0);var x=this.baseSpeed=this.speed=r;n(s)&&(s=A.update!=null?A.update:!1),n(u)&&(u=A.flip!=null?A.flip:null),n(u)&&f==!1&&(u=!0);var P=this,v,w,b=Date.now(),X,Y,m,j=!1;P.scaleX=e.scaleX,P.scaleY=e.scaleY;function S(){if(v=requestAnimationFrame(S),w=C[d].s,!(P.speed==0||w==0)&&(Y=1e3/Math.abs(P.speed)*w,X=Date.now(),X-b>Y)){b=X;var _=P.frame+(P.speed>0||!f?1:-1),R=!1;_>=C.length&&(R=!0,_=0),_<0&&(R=!0,_=C.length-1),P.frame=_,u&&(P.speed<0?e.scaleX=-P.scaleX:e.scaleX=P.scaleX),y&&(P.speed<0?e.scaleY=-P.scaleY:e.scaleY=P.scaleY),R&&P.dispatchEvent("loop"),P.dispatchEvent("change"),s&&e.stage&&e.stage.update(),!n(m)&&m==P.frame&&(j=!1,P.speed=0,P.paused=!0,P.dispatchEvent("pause"))}}S(),this.paused=!1,this.pause=function(_,R,U){if(n(_)&&(_=!0),_!=P.paused)return n(R)&&(R=0),_?(x=P.speed,typeof U>"u"?R>0?(j=!0,t.animate({target:P,obj:{pausingSpeed:0},ticker:!1,time:R,call:function(){j=!1,P.speed=0,P.paused=!0,P.dispatchEvent("pause")}})):(j=!1,P.speed=0,P.paused=!0,setTimeout(function(){P.dispatchEvent("pause")},10)):(j=!0,m=U)):(m=null,R>0?(j=!0,t.animate({target:P,obj:{pausingSpeed:x},ticker:!1,time:R,call:function(){j=!1,P.speed=x,P.paused=!1}})):(j=!1,P.speed=x,P.paused=!1)),P},Object.defineProperty(P,"frame",{get:function(){return d},set:function(_){d=Math.round(_)%C.length;var R=C[d];n(R)||(e.frame=R.f)}}),Object.defineProperty(P,"percentSpeed",{get:function(){return P.baseSpeed==0?NaN:j||P.paused?x/P.baseSpeed*100:P.speed/P.baseSpeed*100},set:function(_){if(j||P.paused){x=P.baseSpeed*_/100;return}P.speed=P.baseSpeed*_/100}}),Object.defineProperty(P,"pausingSpeed",{get:function(){return P.baseSpeed==0?NaN:P.speed/P.baseSpeed*100},set:function(_){P.speed=P.baseSpeed*_/100}}),k!==!1&&t.styleTransforms(this,A),this.dispose=function(){cancelAnimationFrame(v)}},t.extend(t.Dynamo,Fe.EventDispatcher,null,"cjsEventDispatcher"),t.Accelerator=function(e){De("69.3"),this.cjsEventDispatcher_constructor();var r=this;this.type="Accelerator",this.paused=!1,this.items=[],this.paused=!1,this._percentSpeed=100,this.add=function(i){var l;Array.isArray(i)?l=i:l=[i];for(var a,s=0;s<l.length;s++)a=r.items.indexOf(l[s]),a<0&&r.items.push(l[s]);return r},e&&this.add(e),this.remove=function(i){var l;Array.isArray(i)?l=i:l=[i];for(var a,s=0;s<l.length;s++)a=r.items.indexOf(l[s]),a>=0&&r.items.splice(a,1);return r},this.pause=function(i,l,a){if(n(i)&&(i=!0),i==r.paused)return;var s=[];if(i){n(a)||(l=null);for(var f=!1,u=0;u<r.items.length;u++)(!n(l)&&n(a)&&!r.items[u].totalFrames||r.items[u].totalFrames&&(!n(l)||!n(a)))&&(r.items[u].pause(!0,l,a),f=!0,s[u]=1,r.items[u].on("pause",function(){r.paused||(y(!0),r.paused=!0,r.dispatchEvent("pause"))},null,!0));f||(y(),r.paused=!0,setTimeout(function(){r.dispatchEvent("pause")},10))}else r.paused=!1,y();function y(){for(var k=0;k<r.items.length;k++)s[k]!=1&&r.items[k].pause(i)}},Object.defineProperty(r,"percentSpeed",{get:function(){return r._percentSpeed},set:function(i){r._percentSpeed=i;for(var l=0;l<r.items.length;l++)r.items[l].percentSpeed=i}}),this.dispose=function(){for(var i=0;i<r.items.length;i++)r.items[i].dispose();return r.items=null,!0}},t.extend(t.Accelerator,Fe.EventDispatcher,null,"cjsEventDispatcher"),t.Emitter=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c){var h="obj, width, height, interval, num, life, fade, shrink, warm, decayTime, decayStart, trace, traceFadeTime, traceShiftX, traceShiftY, angle, force, gravity, wind, layers, animation, random, horizontal, vertical, sink, sinkForce, cache, events, startPaused, pool, poolMin, particles, focusWarm, style, group, inherit",o;if(o=st(t.Emitter,arguments,h,this))return o;De("69.9"),this.type="Emitter",this.group=D;var I=V===!1?{}:t.getStyle(this.type,this.group,c);n(e)&&(e=I.obj!=null?I.obj:[new t.Circle(20,t.pink),new t.Circle(20,t.green),new t.Circle(20,t.blue)]),n(r)&&(r=I.width!=null?I.width:300),n(i)&&(i=I.height!=null?I.height:300);var N=Tt(l);n(l)&&(l=I.interval!=null?I.interval:N=="s"?.02:20),typeof l=="number"&&(l=Math.max(N=="s"?.01:10,l)),n(a)&&(a=I.num!=null?I.num:1),n(O)&&(O=I.trace!=null?O.size:!1),n(T)&&(T=I.traceFadeTime!=null?I.traceFadeTime:k),n(E)&&(E=I.traceShiftX!=null?I.traceShiftX:0),n(A)&&(A=I.traceShiftY!=null?I.traceShiftY:0),Pt(s,N),n(s)&&(s=I.life!=null?I.life:N=="s"?1:1e3),n(f)&&(f=I.fade!=null?I.fade:!0),n(u)&&(u=I.shrink!=null?I.shrink:!O),n(y)&&(y=I.warm!=null?I.warm:null),Pt(k,N),n(k)&&(k=I.decayTime!=null?I.decayTime:N=="s"?1:1e3),n(C)&&(C=I.angle!=null?I.angle:{min:0,max:360}),n(d)&&(d=I.force!=null?I.force:5),n(x)&&(x=I.gravity!=null?I.gravity:9.8),n(P)&&(P=I.wind!=null?I.wind:0),n(v)&&(v=I.layers!=null?I.layers:"top"),n(r)&&(r=I.width!=null?I.width:100),n(i)&&(i=I.height!=null?I.height:100),n(X)&&(X=I.horizontal!=null?I.horizontal:!1),n(Y)&&(Y=I.vertical!=null?I.vertical:!1),n(m)&&(m=I.sink!=null?I.sink:null),!n(m)&&n(j)&&(j=I.sinkForce!=null?I.sinkForce:10),n(_)&&(_=I.events!=null?I.events:!1),n(R)&&(R=I.startPaused!=null?I.startPaused:!1),n(U)&&(U=I.pool!=null?I.pool:!0),n(Z)&&(Z=I.poolMin!=null?I.poolMin:0),n(K)&&(K=I.particles!=null?I.particles:new t.Container),n(ne)&&(ne=I.focusWarm!=null?I.focusWarm:!0),e.type=="shape"&&(ne=!1),K.type="Particles",K.emitter=this,this.zimContainer_constructor(r,i,null,null,!1),this.type="Emitter";var p=this;this.regX=r/2,this.regY=i/2,p.obj=e,p.particles=K,p.interval=l,p.num=a,p.life=s,p.fade=f,p.shrink=u,p.decayTime=k,p.decayStart=g,p.trace=O,p.traceFadeTime=T,p.traceShiftX=E,p.traceShiftY=A,p.angle=C,p.emitterForce=d,p.gravity=x,p.wind=P,p.layers=v,p.animation=w,p.random=b,p.horizontal=X,p.vertical=Y,p.sink=m,p.sinkForce=j,p.events=_,p.startEmitterPaused=p.emitterPaused=R,p.pool=U,p.poolMin=Z,p.particlesEmitted=0;var L=[],we=0,B=0,F,fe;t.added(p,se);function se(J){if(p.emitterPaused=null,p.on("added",function(){t.loop(p.particles,function(ce){ce.visible=!1}),p.particles.addTo(p.parent)}),fe=J,n(S)&&(fe.isWebGL?S=!1:S=t.mobile()),S&&(fe.snapToPixelEnabled=!0),fe){let ce=function(){var ue=t.isPick(p.life)?t.Pick.getMinMax(p.life).max:p.life;if(n(ue)&&(ue=N=="s"?1:1e3),p.startEmitterPaused){p.pauseEmitter();return}if(e=Array.isArray(p.obj)?p.obj:[p.obj],e.length<=0)return;var ge,ie;function xe(Se,z){return Se-z}Array.isArray(p.interval)?(p.interval.sort(xe),ge=p.interval[0]):p.interval.constructor=={}.constructor?ge=p.interval.min:ge=p.interval,Array.isArray(p.num)?(p.num.sort(xe),ie=p.num[p.num.length-1]):p.num.constructor=={}.constructor?ie=p.num.max:ie=p.num,t.loop(t.Pick.choose(p.num),function(){if(p.decayTime>0){var Se={};p.shrink&&(Se.scale=0),p.fade&&(Se.alpha=0)}var z,pe,de;if(p.pool&&L.length>0&&B>=Math.max(p.poolMin,ue/ge*ie))z=L[we++%L.length],z.visible=!0,de=z.trace?z.getChildAt(0):z,de.emitShape&&(pe=de.template,de.graphics.c().s(pe.s?t.Pick.choose(pe.s):null).ss(pe.ss?t.Pick.choose(pe.ss):null).sd(pe.sd?t.Pick.choose(pe.sd):null,pe.offset?t.Pick.choose(pe.offset):null)),z.trace&&z.cacheCanvas&&z.updateCache(),p.layers=="top"?de.emitShape?z.addTo(K,null,!1):z.addTo(K,K.numChildren-1):de.emitShape?z.addTo(K,p.layers=="bottom"?0:t.rand(K.numChildren),!1):z.addTo(K,p.layers=="bottom"?0:t.rand(K.numChildren)),O||z.reg("center"),z.scaleX=1,z.scaleY=1,z.alpha=z.originalAlpha,de.scaleX=de.originalScaleX,de.scaleY=de.originalScaleY,de.rotation=de.originalRotation,de.color=de.originalColor,de.endSpurt=!1;else{B++,p.trace&&(z=new t.Container(r,i,null,null,!1),z.trace=!0);var oe=t.Pick.choose(t.shuffle(e)[0]);oe.type=="shape"?(pe=oe,de=new t.Shape(1,1,null,null,null,!1),de.emitShape=!0,de.template=pe,de.graphics.s(pe.s?t.Pick.choose(pe.s):null).ss(pe.ss?t.Pick.choose(pe.ss):null).sd(pe.sd?t.Pick.choose(pe.sd):null,pe.offset?t.Pick.choose(pe.offset):null),p.trace?de.addTo(z,null,!1):p.layers=="top"?de.addTo(K,null,!1):de.addTo(K,p.layers=="bottom"?0:t.rand(K.numChildren),null,!1)):(de=oe.clone(),de.centerReg||Un(de),p.trace?de.centerReg(z).loc(-1e3,-1e3):p.layers=="top"?de.centerReg(K):de.centerReg(K,p.layers=="bottom"?0:t.rand(K.numChildren))),p.trace&&(p.layers=="top"?z.addTo(K,null,!1):z.addTo(K,p.layers=="bottom"?0:t.rand(K.numChildren),!1),z.cache(E,A,r*2,i*2)),p.trace||(z=de),z.particle=de,z.originalAlpha=z.alpha,de.originalAlpha=de.alpha,de.originalScaleX=de.scaleX,de.originalScaleY=de.scaleY,de.originalRotation=de.rotation,de.originalColor=de.color}p.currentParticle=de,p.particlesEmitted++,z.particleNormal=!0,z.particleDecaying=!1,z.particleFizzing=!1;var Be=t.Pick.choose(p.angle),$=t.Pick.choose(p.emitterForce),Me=$*Math.cos(Be*Math.PI/180),be=$*Math.sin(Be*Math.PI/180);de.info={position:{x:p.x,y:p.y},velocity:{x:Me,y:be},sink:n(j)?null:nt(j)},p.horizontal&&(de.info.position={x:p.x-p.regX+t.rand(0,r),y:p.y-p.regY+(p.vertical?i/2:0)}),p.vertical&&(de.info.position={x:p.x-p.regX+(p.horizontal?r/2:0),y:p.y-p.regY+t.rand(0,i)}),de.emitShape?de.graphics.mt(de.info.position.x,de.info.position.y):(de.x=de.info.position.x,de.y=de.info.position.y),de.alpha=de.originalAlpha,p.random&&t.loop(p.random,function(Ye,$e){var it=t.Pick.choose($e);Ye=="scale"?de.sca(it):(Ye=="x"?de.info.position.x=p.horizontal||p.vertical?it:it+r/2:Ye=="y"&&(de.info.position.y=p.horizontal||p.vertical?it:it+i/2),(Ye=="x"||Ye=="y")&&de.emitShape&&de.graphics.mt(de.info.position.x,de.info.position.y),de[Ye]=it,de.emitShape&&(de.x=0,de.y=0))}),S&&!de.emitShape&&de.cache(de.getBounds().x-10,de.getBounds().y-10,de.getBounds().width+20,de.getBounds().height+20);var me=de.emitShape?!1:p.shrink,re=(z||de).life=nt(p.life);if(p.decayTime>0&&(p.fade||me||p.trace&&p.traceFadeTime>0)){if(p.trace&&p.traceFadeTime>0&&z.animate({obj:{alpha:0},time:p.traceFadeTime,wait:re-p.traceFadeTime,waitedCall:function(Ye){Ye.particleNormal=!1,Ye.particleFizzing=!0},call:Q,override:!1,id:"decay"}),p.fade||me){var ke={};p.fade&&(ke.alpha=0),me&&(ke.scaleX=0,ke.scaleY=0),de.animate({obj:ke,time:p.decayTime,wait:n(p.decayStart)?re-p.decayTime:p.decayStart,waitedCall:function(Ye){Ye.parent!=p&&(Ye=Ye.parent),Ye.particleNormal=!1,Ye.particleDecaying=!0},call:function(Ye){p.events&&te("decayed",Ye),Ye.endSpurt&&te("spurtdecayed",Ye),p.trace&&p.traceFadeTime>0||(n(p.decayStart)||p.decayStart+p.decayTime>p.life?Ye.parent&&Q(Ye.parent.trace?Ye.parent:Ye):-function(){var $e=z;t.timeout(re-(p.decayStart+p.decayTime),function(){Q($e)})}())},override:!1,id:"decay"})}}else z.life=p.life,p.life>0&&-function(){var Ye=z;Ye.timeOut=t.timeout(p.life,function(){Q(Ye)})}();if(p.events&&te("emitted",z),le(de),p.animation){var Re=t.Pick.choose(p.animation);Array.isArray(Re)?t.loop(Re,function(Ye){n(Ye.override)&&(Ye.override=!1),de.animate(t.copy(Ye))}):(n(Re.override)&&(Re.override=!1),de.animate(t.copy(Re)))}})},q=function(){t.loop(K,function(ue){if(ue.trace){var ge=ue;ue=ue.getChildAt(0)}var ie=ue.info,xe=0,Se=0;if(!n(p.sink)){var z=p.particles.localToGlobal(ie.position.x,ie.position.y),pe;p.sink.parent&&p.sink.parent.localToGlobal?pe=p.sink.parent.localToGlobal(p.sink.x,p.sink.y):pe=new Fe.Point(t.Pick.choose(p.sink.x),t.Pick.choose(p.sink.y));var de=t.angle(z.x,z.y,pe.x,pe.y);xe=ie.sink*Math.cos(de*Math.PI/180),Se=ie.sink*Math.sin(de*Math.PI/180)}var oe=p.wind+xe,Be=p.gravity+Se;ie.velocity.x+=oe*G,ie.velocity.y+=Be*G,ie.position.x+=ie.velocity.x*G*100,ie.position.y+=ie.velocity.y*G*100,ue.emitShape?ue.graphics.lt(ie.position.x,ie.position.y):(ue.x=ie.position.x,ue.y=ie.position.y),p.trace&&ge&&ge.cacheCanvas&&ge.updateCache(ue.emitShape?null:"source-over")})};var Te=p.parent.getChildIndex(p);p.parent.addChildAt(K,Te),!X&&!Y&&p.centerReg(null,null,!1),p.zimInterval=t.interval(p.interval,ce,null,!0,!0);var G=0;F=p.emitterTicker=t.Ticker.add(q,fe),G=1/t.Ticker.framerate,p.focusWarm=ne,p.doWarm=function(ue){if(n(ue)||ue===!0){var ge;s.max?ge=s.max:Array.isArray(s)?ge=t.arrayMinMax(s).max:ge=nt(s);var ie;l.min?ie=l.min:Array.isArray(l)?ie=t.arrayMinmin(l).min:ie=nt(l),ue=Math.min(200,Math.round(ge/ie))}var xe=p.pool;p.pool=!1;var Se=Math.round(l*t.Ticker.framerate);t.loop(Math.round(ue*l*t.Ticker.framerate),function(z){z%Se==0&&ce(),t.loop(K,function(pe){pe.warmTick?pe.warmTick++:pe.warmTick=1,pe.warmTick/t.Ticker.framerate>pe.life&&Q(pe)}),q()}),t.loop(K,function(z){if(z.zimTweens){var pe=z.warmTick/t.Ticker.framerate/z.life*100;pe>=100&&(z.alpha=0),z.percentComplete=pe}}),p.pool=xe},y&&p.doWarm(y)}}p.particles.noMouse();function Q(J){if(p.events&&te("fizzed",J),(J.trace?J.getChildAt(0).endSpurt:J.endSpurt)&&(te("spurtfizzed",J),p.spurting=!1),p.pool&&J.pooled!="end")if(J.pooled){J.visible=!1;return}else{J.pooled=!0,L&&L.push(J),J.visible=!1;return}p.removeChild(J),p.trace&&J.uncache(),J=null}function te(J,Te){if(!n(Te)){var G=new Fe.Event(J);G.particle=Te.trace?Te.getChildAt(0):Te,p.dispatchEvent(G)}}function le(J){n(p.spurtCount)&&n(p.spurtNum)||(p.spurtCount++,p.spurtCount>=p.spurtNum&&Ae(J))}function Ae(J){p.pauseEmitter(),p.spurtCount=p.spurtNum=null,!n(J)&&(te("spurted",J),J.endSpurt=!0)}Object.defineProperty(p,"interval",{get:function(){return l},set:function(J){l=J,p.zimInterval&&(p.zimInterval.time=l)}}),this.removeFrom=function(){p.parent&&p.parent.removeChild(p),p.particles.removeFrom()},this.spurting=!1,this.spurt=function(J,Te,G){var ce="num, time, restart",q;return(q=st(p.spurt,arguments,ce))?q:(n(Te)||(t.timeout(t.Pick.choose(Te),function(){Ae(p.currentParticle)},!0),p.spurting=!0),n(J)||(p.spurtNum=t.Pick.choose(J),p.spurtCount=0,p.spurting=!0),p.pauseEmitter(!1,G,null,!0),p)},this.clearPool=function(){t.loop(p.particles,function(J){J.pooled="end",J.visible||p.removeChild(J)},!0),B=0,we=0,L=[]},p.startEmitterPaused||(this.emitterPaused=!1),this.pauseEmitter=function(J,Te,G,ce){if(p.startEmitterPaused=null,n(J)&&(J=!0),n(Te)&&(Te=!1),n(G)&&(G=!1),J){if(p.emitterPaused)return p;G&&(F&&t.Ticker.remove(F),t.loop(p.particles,function(q){q.pauseAnimate(),q.trace&&q.getChildAt(0).pauseAnimate(),q.timeOut&&q.timeOut.pause()})),p.zimInterval.pause(),p.emitterPaused=!0}else{if(!p.emitterPaused)return p;Te&&(t.loop(p.particles,function(q){q.stopAnimate(),q.timeOut&&q.timeOut.clear(),q.trace&&q.getChildAt(0).pauseAnimate()}),p.removeAllChildren()),fe&&F&&!t.Ticker.has(fe,F)&&(t.Ticker.add(F,fe),t.loop(p.particles,function(q){q.pauseAnimate(!1),q.timeOut&&q.timeOut.pause(!1),q.trace&&q.getChildAt(0).pauseAnimate(!1)})),p.zimInterval&&p.zimInterval.pause(!1,ce),p.emitterPaused=!1}return p},this.resize=function(J,Te){n(J)||(r=J),n(Te)||(i=Te),p.setBounds(0,0,r,i),!X&&!Y&&p.centerReg(),p.clearPool()},V!==!1&&t.styleTransforms(this,I),this.clone=function(J){var Te;return Array.isArray(p.obj)||p.obj.constructor=={}.constructor?Te=t.copy(p.obj):p.obj.clone?Te=p.obj.clone(J):Te=p.obj,p.cloneProps(new t.Emitter(Te,r,i,p.interval,p.num,p.life,p.fade,p.shrink,p.decayTime,p.decayStart,p.trace,p.traceFadeTime,p.traceShiftX,p.traceShiftY,p.angle,p.emitterForce,p.gravity,p.wind,p.layers,p.animation,t.copy(p.random),p.horizontal,p.vertical,p.sink,p.sinkForce,S,p.events,R,p.pool,p.poolMin,V,p.group,c))},this.dispose=function(){return p.zimInterval&&p.zimInterval.clear(),F&&t.Ticker.remove(F),t.loop(L,function(J){J&&J.dispose()}),K&&K.dispose&&K.dispose(),p.currentParticle&&p.currentParticle.dispose&&p.currentParticle.dispose(),e&&Array.isArray(e)?t.loop(e,function(J){J.dispose&&J.dispose()}):e&&e.dispose&&e.dispose(),K=p.currentParticle=p.particles=e=p.obj=L=p.poolList=null,!0}},t.extend(t.Emitter,t.Container,"clone","zimContainer",!1),t.Generator=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b){var X="color, strokeColor, strokeWidth, draw, stamp, setup, maxCount, boundary, drawCount, drawPause, drawSpacebarPause, startX, startY, cache, recordLinePoints, frame, seed, output, outputType, style, group, inherit",Y;if(Y=st(t.Generator,arguments,X,this))return Y;De("69.92"),this.group=w;var m=v===!1?{}:t.getStyle("Generator",this.group,b);n(C)&&(C=m.frame!=null?m.frame:ee.zdf);var j=C.stage;n(e)&&(e=m.color!=null?m.color:null),n(r)&&(r=m.strokeColor!=null?m.strokeColor:t.white),n(i)&&(i=m.strokeWidth!=null?m.strokeWidth:1),n(f)&&(f=m.maxCount!=null?m.maxCount:1e3),n(u)&&(u=m.boundary!=null?m.boundary:new t.Boundary(0,0,j.width,j.height)),n(y)&&(y=m.drawCount!=null?m.drawCount:1),n(k)&&(k=m.drawPause!=null?m.drawPause:!0),n(g)&&(g=m.drawSpacebarPause!=null?m.drawSpacebarPause:!0),n(O)&&(O=m.startX!=null?m.startX:j.width/2),n(T)&&(T=m.startY!=null?m.startY:j.height/2),n(E)&&(E=m.cache!=null?m.cache:!1);var S=this.drawing=new t.Container(u.x,u.y,u.width,u.height).addTo(j),_=this.shape=new t.Shape(u.width,u.height).addTo(S);this.drawCount=y,n(k)&&(k=!0),E&&_.cache(u.x,u.y,u.width,u.height),this.zimContainer_constructor(u.x,u.y,u.width,u.height),this.type="Generator";var R=this;if(R.draw=null,x){R.drawCount=10,!n(a)&&n(l)&&(l=a),a=null;var U=new t.Loader;R.outputNum=0,R.outputName=x===!0?"gen_":x.match(/_$/)?x:x+"_"}this.color=e,this.strokeColor=r,this.strokeWidth=i;var Z=O,K=T;this.fill=function(h){return R.color=h,R.currentColor=nt(R.color),_.f(R.currentColor),this},this.stroke=function(h,o){return n(h)||(R.strokeColor=h,R.currentStrokeColor=nt(R.strokeColor),_.s(R.currentStrokeColor)),n(o)||(R.strokeWidth=o,R.currentStrokeWidth=nt(R.strokeWidth),_.ss(R.currentStrokeWidth)),this},this.noStroke=function(){return R.strokeColor=R.currentStrokeColor=null,R.strokeWidth=R.currentStrokeWidth=null,_.s(),_.ss(1),this},_.matrix=_.getMatrix(),this.translate=function(h,o){n(h)&&(h=0),n(o)&&(o=0),h=nt(h),o=nt(o);var I=_.matrix.transformPoint(h,o);return Z=I.x,K=I.y,_.mt(Z,K),_.matrix.translate(h,o),this},this.rotate=function(h){return n(h)&&(h=0),h=nt(h),_.matrix.rotate(h),this},this.scale=function(h,o){return n(h)&&(h=1),n(o)&&(o=h),h=nt(h),o=nt(o),_.matrix.scale(h,o),this},this.skew=function(h,o){return n(h)&&(h=0),n(o)&&(o=0),h=nt(h),o=nt(o),_.matrix.skew(h,o),this},A&&(R.linePoints=[]),this.line=function(h,o,I,N){n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=0),n(N)&&(N=0),h=nt(h),o=nt(o),I=nt(I),N=nt(N),(A=="zero"||A=="nonzero"&&h&&o)&&R.linePoints.push([h,o]),R.translate(h,o);var p=_.matrix.transformPoint(I,N);return Z=p.x,K=p.y,_.lt(Z,K),A&&R.linePoints.push([Z,K]),_.matrix.translate(I,N),this},this.arc=function(h,o,I,N,p,L){n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=50),h=nt(h),o=nt(o),I=nt(I),I=Math.abs(I),n(N)&&(N=0),n(p)&&(p=180),N=nt(N),p=nt(p),n(L)&&(L=!1),L=nt(L),R.translate(h,o);var we=_.matrix.transformPoint(0,0);_.decomp||(_.decomp={}),_.matrix.decompose(_.decomp);var B=(Math.abs(_.decomp.scaleX)+Math.abs(_.decomp.scaleY))/2,F=_.decomp.rotation||0,fe=I*B;return _.mt(we.x+fe*Math.cos((N+F)*Math.PI/180),we.y+fe*Math.sin((N+F)*Math.PI/180)),_.a(we.x,we.y,fe,(N+F)*Math.PI/180,(p+F)*Math.PI/180,L),this},this.curve=function(h,o,I,N,p,L){n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=50),n(N)&&(N=50),n(p)&&(p=100),n(L)&&(L=0),h=nt(h),o=nt(o),I=nt(I),N=nt(N),p=nt(p),L=nt(L),R.translate(h,o);var we=_.matrix.transformPoint(I,N),B=_.matrix.transformPoint(p,L),F=B.x,fe=B.y;return _.qt(we.x,we.y,F,fe),_.matrix.translate(p,L),this},this.bezier=function(h,o,I,N,p,L,we,B){n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=50),n(N)&&(N=50),n(p)&&(p=-50),n(L)&&(L=-50),n(we)&&(we=100),n(B)&&(B=0),h=nt(h),o=nt(o),I=nt(I),N=nt(N),p=nt(p),L=nt(L),we=nt(we),B=nt(B),R.translate(h,o);var F=_.matrix.transformPoint(I,N),fe=_.matrix.transformPoint(p,L),se=_.matrix.transformPoint(we,B),Q=se.x,te=se.y;return _.bt(F.x,F.y,fe.x,fe.y,Q,te),_.matrix.translate(we,B),this},this.rectangle=function(h,o,I,N,p,L,we,B){if(n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=100),n(N)&&(N=I),h=nt(h),o=nt(o),I=nt(I),N=nt(N),!p&&!L&&!we&&!B){R.translate(h,o);var F=_.matrix.transformPoint(0,0),fe=_.matrix.transformPoint(I,0),se=_.matrix.transformPoint(I,N),Q=_.matrix.transformPoint(0,N);return _.mt(F.x,F.y).lt(fe.x,fe.y).lt(se.x,se.y).lt(Q.x,Q.y).lt(F.x,F.y).lt(fe.x,fe.y),_.mt(F.x,F.y),this}n(p)&&(p=0),n(L)&&(L=p),n(we)&&(we=p),n(B)&&(B=p),p=nt(p),L=nt(L),we=nt(we),B=nt(B);var te=(I<N?I:N)/2,le=0,Ae=0,J=0,Te=0;te=Math.abs(te),p<0&&(p*=le=-1),p>te&&(p=te),L<0&&(L*=Ae=-1),L>te&&(L=te),we<0&&(we*=J=-1),we>te&&(we=te),B<0&&(B*=Te=-1),B>te&&(B=te),R.translate(h,o),_.decomp||(_.decomp={}),_.matrix.decompose(_.decomp);var G=(Math.abs(_.decomp.scaleX)+Math.abs(_.decomp.scaleY))/2,ce=I<0?-1:1,q=N<0?-1:1,ue=_.matrix.transformPoint(I-L*ce,0),ge=_.matrix.transformPoint(I+L*Ae*ce,-L*Ae*q),ie=_.matrix.transformPoint(I,L*q),xe=_.matrix.transformPoint(I,N-we*q),Se=_.matrix.transformPoint(I+we*J*ce,N+we*J*q),z=_.matrix.transformPoint(I-we*ce,N),pe=_.matrix.transformPoint(B*ce,N),de=_.matrix.transformPoint(-B*Te*ce,N+B*Te*q),oe=_.matrix.transformPoint(0,N-B*q),Be=_.matrix.transformPoint(0,p*q),$=_.matrix.transformPoint(-p*le*ce,-p*le*q),Me=_.matrix.transformPoint(p*ce,0);return _.mt(ue.x,ue.y).at(ge.x,ge.y,ie.x,ie.y,L*G).lt(xe.x,xe.y).at(Se.x,Se.y,z.x,z.y,we*G).lt(pe.x,pe.y).at(de.x,de.y,oe.x,oe.y,B*G).lt(Be.x,Be.y).at($.x,$.y,Me.x,Me.y,p*G).cp(),this},this.circle=function(h,o,I,N,p){n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=50),n(N)&&(N=100),n(p)&&(p=!0),h=nt(h),o=nt(o),I=nt(I),N=nt(N),I=Math.abs(I),R.translate(h,o);var L=_.matrix.transformPoint(0,0);_.decomp||(_.decomp={}),_.matrix.decompose(_.decomp);var we=(Math.abs(_.decomp.scaleX)+Math.abs(_.decomp.scaleY))/2,B=_.decomp.rotation||0,F=I*we;if(R.circleHeight=F*2,typeof N=="number"&&N>=0&&N<100){var fe=360*N/100/2;_.mt(L.x+F*Math.cos((-fe-90+B)*Math.PI/180),L.y+F*Math.sin((-fe-90+B)*Math.PI/180)),_.a(L.x,L.y,F,(-fe-90+B)*Math.PI/180,(fe-90+B)*Math.PI/180,!1),p&&_.cp(),R.circleHeight=F-Math.cos(fe*Math.PI/180)*F}else _.mt(L.x+F,L.y),_.a(L.x,L.y,F,0,Math.PI*2);return this},this.elipse=function(h,o,I,N){n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=100),n(N)&&(N=50),h=nt(h),o=nt(o),I=nt(I),N=nt(N),R.translate(h,o);var p=_.matrix.transformPoint(-I/2,-N/2);_.decomp||(_.decomp={}),_.matrix.decompose(_.decomp);var L=_.decomp.scaleX,we=_.decomp.scaleY;return _.de(p.x,p.y,I*L,N*we),this},this.poly=function(h,o,I,N,p,L){n(h)&&(h=0),n(o)&&(o=0),n(I)&&(I=100),n(N)&&(N=5),n(p)&&(p=0),n(L)&&(L=0),h=nt(h),o=nt(o),I=nt(I),N=nt(N),p=nt(p),L=nt(L),I=Math.abs(I),R.translate(h,o);var we=_.matrix.transformPoint(0,0);_.decomp||(_.decomp={}),_.matrix.decompose(_.decomp);var B=(Math.abs(_.decomp.scaleX)+Math.abs(_.decomp.scaleY))/2,F=_.decomp.rotation||0,fe=I*B;return _.dp(we.x,we.y,fe,N,p,F),this},this.closePath=this.close=this.cp=function(){return _.cp(),this},this._noise=new t.Noise(d),this.noise=function(){if(arguments.length==1)return(this._noise.simplex1D.apply(null,arguments)+1)/2;if(arguments.length==2)return(this._noise.simplex2D.apply(null,arguments)+1)/2;if(arguments.length==3)return(this._noise.simplex3D.apply(null,arguments)+1)/2;if(arguments.length==4)return(this._noise.simplex4D.apply(null,arguments)+1)/2},this.stack=[],this.colorStrokeStack=[],this.push=function(){return R.stack.push(_.matrix.clone()),R.colorStrokeStack.push([R.color,R.strokeColor,R.strokeWidth,R.currentColor,R.currentStrokeColor,R.currentStrokeWidth]),this},this.pop=function(){_.matrix=R.stack.pop()||_.matrix;var h=R.colorStrokeStack.pop()||[R.color,R.strokeColor,R.strokeWidth,R.currentColor,R.currentStrokeColor,R.currentStrokeWidth];return R.color=h[0],R.strokeColor=h[1],R.strokeWidth=h[2],R.currentColor=h[3],R.currentStrokeColor=h[4],R.currentStrokeWidth=h[5],_.f(R.currentColor).s(R.currentStrokeColor).ss(R.currentStrokeWidth),_.mt(_.matrix.x,_.matrix.y),this},this.blit=function(){return _.updateCache("source-over"),_.c(),this},this.step=function(){return R.draw&&c(),this},n(R.color)||this.fill(R.color),!n(R.strokeColor)&&R.strokeWidth?this.stroke(R.strokeColor,R.strokeWidth):R.noStroke(),this.translate(Z,K),typeof s=="function"&&(this.setup=s,t.timeout(.01,function(){s(0,R.count,R),E&&_.updateCache(),j.update()}));var ne=0;this.maxCount=f,this.resetup=function(h){return n(h)&&(h=!0),ne=0,h&&R.shape.c(),n(R.color)||this.fill(R.color),!n(R.strokeColor)&&R.strokeWidth?this.stroke(R.strokeColor,R.strokeWidth):R.noStroke(),this.reset(),this.setup&&(s(0,R.count,R),E&&_.updateCache(),j.update()),this},this.stampNum=0,typeof a=="function"&&(this.stamp=a,t.timeout(.015,function(){D(0)})),this.restamp=function(h,o){return n(h)&&(h=!0),n(o)&&(o=!0),ne=0,h&&R.shape.c(),o&&R.resetup(h),D(0),this},this.reset=function(){return this.fill(e),!n(r)&&i?this.stroke(r,i):this.noStroke(),_.matrix.identity(),this.translate(O,T),this},this.clear=function(){return this.shape.c(),this};function V(){U.save({content:j,filename:R.outputName+t.decimals(R.outputNum,null,null,6),type:P}),R.outputNum++}x&&(j.update(),V());function D(h){R.stampNum++;var o=t.loop(R.maxCount,function(I,N){if(R.paused)return R.pausedCount=I,!1;if(R.changeCount)return R.changeCount=!1,!1;ne=I+1;var p=a(I+1,N,R,R.stampNum);if(R.currentColor=nt(R.color),_.f(R.currentColor),R.currentStrokeColor=nt(R.strokeColor),_.s(R.currentStrokeColor),R.currentStrokeWidth=nt(R.strokeWidth),_.ss(R.currentStrokeWidth),x&&(j.update(),V()),p)return p},null,null,h);E&&_.updateCache(),o&&R.dispatchEvent("complete"),j.update()}R.iterator=0,typeof l=="function"&&(this.draw=l,s?setTimeout(function(){R.ticker=t.Ticker.add(c)},100):this.ticker=t.Ticker.add(c),R.generatorPaused=!1,k&&(R.pauseEvent=j.on("stagemousedown",function(){R.count>=R.maxCount||R.pauseTimeout||(t.Ticker.has(R.ticker)?(t.Ticker.remove(R.ticker),R.generatorPaused=!0,R.dispatchEvent("generatorpaused")):(R.ticker=t.Ticker.add(R.ticker),R.generatorPaused=!1,R.dispatchEvent("generatorunpaused")))})),g&&(R.pauseSpacebarEvent=C.on("keydown",function(h){R.count>=R.maxCount||R.pauseTimeout||h.keyCode==20&&(t.Ticker.has(R.ticker)?(t.Ticker.remove(R.ticker),R.generatorPaused=!0,R.dispatchEvent("generatorpaused")):(R.ticker=t.Ticker.add(R.ticker),R.generatorPaused=!1,R.dispatchEvent("generatorunpaused")))})));function c(){R.iterator++,R.iterator%Math.ceil(R.drawCount)==0&&(R.count++,R.draw(R.count,R.maxCount,R),E&&R.blit(),R.currentColor=nt(R.color),_.f(R.currentColor),R.currentStrokeColor=nt(R.strokeColor),_.s(R.currentStrokeColor),R.currentStrokeWidth=nt(R.strokeWidth),_.ss(R.currentStrokeWidth),R.dispatchEvent("drawing"),j.update(),x&&V()),R.maxCount&&R.count>=R.maxCount&&(R.dispatchEvent("complete"),t.Ticker.remove(R.ticker))}this.redraw=function(h,o){return n(h)&&(h=!0),R.reset(),n(o)&&(o=!0),R.ticker&&t.Ticker.remove(R.ticker),R.iterator=0,R.count=0,h&&R.shape.c(),o?(R.resetup(h),setTimeout(function(){R.ticker&&(R.ticker=t.Ticker.add(R.ticker))},100)):R.ticker&&(R.ticker=t.Ticker.add(R.ticker)),this},this.paused=!1,this.pause=function(h,o){if(n(h)&&(h=!0),!(R.count>=R.maxCount)){if(h==this.paused)return this;this.paused=h,this.pauseTimeout&&this.pauseTimeout.clear(),this.paused?R.ticker&&t.Ticker.remove(R.ticker):R.ticker?R.ticker=t.Ticker.add(R.ticker):D(R.pausedCount,R.maxCount),setTimeout(function(){j.update()},20),o&&(this.pauseTimeout=t.timeout(o,function(){R.pause(!R.paused),R.pauseTimeout=null})),R.dispatchEvent(R.paused?"paused":"unpaused")}},this.outOfBounds=function(h,o){n(h)&&(h=0),n(o)&&(o=h);var I=R.shape.stage;if(I)return R.currentX>I.width-h||R.currentX<0+h||R.currentY>I.height-o||R.currentY<0+o},this.stop=function(){R.pause(),R.pauseEvent&&j.off("stagemousedown",R.pauseEvent),R.pauseSpaceEvent&&C.off("keydown",R.pauseSpaceEvent)},Object.defineProperty(this,"count",{get:function(){return ne},set:function(h){ne=h,R.stamp&&(R.changeCount=!0,setTimeout(function(){D(ne,R.maxCount)}))}}),Object.defineProperty(this,"currentX",{get:function(){return Z},set:function(){vt&&tt("Generator() - currentX is read only")}}),Object.defineProperty(this,"currentY",{get:function(){return K},set:function(){vt&&tt("Generator() - currentY is read only")}}),this.clone=function(){return R.cloneProps(new t.Generator(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,v,R.group,b))},R.dispose=function(h,o,I){return R.pause(),R.ticker&&t.Ticker.remove(R.ticker),R.pauseEvent&&j.off("stagemousedown",R.pauseEvent),R.pauseSpacebarEvent&&C.off("keydown",R.pauseSpacebarEvent),R._noise&&(R._noise=null),R.shape&&R.shape.dispose(),R.drawing&&R.drawing.dispose(),R.shape=R.drawing=null,I||R.zimContainer_dispose(),!0},v!==!1&&t.styleTransforms(this,m)},t.extend(t.Generator,t.Container,["clone","dispose"],"zimContainer",!1),t.Pen=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U){var Z="size, color, penType, damp, spread, borderColor, borderWidth, end, paper, nib, cache, ctrlKey, cropScale, undo, undoKeys, move, onTop, deleteable, doubleClickDelete, holdDelete, immediateStop, lineAlpha, lineBlendMode, frame, dashed, pullColor, pullThickness, style, group, inherit",K;if(K=st(t.Pen,arguments,Z,this))return K;De("69.93"),this.zimContainer_constructor(),this.type="Pen",this.group=R;var ne=_===!1?{}:t.getStyle(this.type,this.group,U);n(i)&&(i=ne.penType!=null?ne.penType:"line");var V={size:2,color:t.dark,spread:{min:5,max:20},borderColor:t.darker,borderWidth:0},D={line:{size:2},kitetail:{size:{min:5,max:20},color:t.series(t.pink,t.blue,t.green),borderColor:"rgba(0,0,0,.5)",borderWidth:1},grass:{color:t.green,size:3,spread:{min:10,max:30}},hair:{color:[t.pink,t.blue],size:3,spread:{min:20,max:50}},city:{size:{min:30,max:70},spread:{min:50,max:200},color:[t.dark,t.darker,t.grey]},barbwire:{},splatter:{size:{min:5,max:20},color:"rgba(0,0,0,.5)"}};n(D[i])&&(i="line"),n(e)&&(e=ne.size!=null?ne.size:n(D[i].size)?V.size:D[i].size),n(r)&&(r=ne.color!=null?ne.color:n(D[i].color)?V.color:D[i].color),n(l)&&(l=ne.damp!=null?ne.damp:.5),l===!1&&(l=1),n(a)&&(a=ne.spread!=null?ne.spread:n(D[i].spread)?V.spread:D[i].spread),n(s)&&(s=ne.borderColor!=null?ne.borderColor:n(D[i].borderColor)?V.borderColor:D[i].borderColor),n(f)&&(f=ne.borderWidth!=null?ne.borderWidth:n(D[i].borderWidth)?V.borderWidth:D[i].borderWidth),n(u)&&(u=ne.end!=null?ne.end:t.isPick(e)||t.isPick(r)||i!="line"?"butt":"round"),n(T)&&(T=ne.cropScale!=null?ne.cropScale:1),n(g)&&(g=ne.cache!=null?ne.cache:!0),n(E)&&(E=ne.undo!=null?ne.undo:0),n(A)&&(A=ne.undoKeys!=null?ne.undoKeys:!0),n(C)&&(C=ne.move!=null?ne.move:!0),n(x)&&(x=ne.deleteable!=null?ne.deleteable:!0),n(P)&&(P=ne.doubleClickDelete!=null?ne.doubleClickDelete:!0),n(v)&&(v=ne.holdDelete!=null?ne.holdDelete:!0),n(d)&&(d=ne.onTop!=null?ne.onTop:!0),n(w)&&(w=ne.immediateStop!=null?ne.immediateStop:"both"),n(b)&&(b=ne.lineAlpha!=null?ne.lineAlpha:1),n(X)&&(X=ne.lineBlendMode!=null?ne.lineBlendMode:"normal"),n(y)&&(y=ne.paper!=null?ne.paper:new t.Container),n(k)&&(k=ne.nib!=null?ne.nib.clone():null),n(Y)&&(Y=ne.frame!=null?ne.frame:ee.zdf),n(m)&&(m=ne.dashed!=null?ne.dashed:null),m===!0&&(m=[3,100]),n(j)&&(j=ne.pullColor!=null?ne.pullColor:null),n(S)&&(S=ne.pullThickness!=null?ne.pullThickness:1);var c=this;this.dampX=new t.Damp(null,l),this.dampY=new t.Damp(null,l);var h=!0;this.drawing=!1,this.immediateStop=w,this.undoLevels=E,this.undoKeys=A,this.move=C,this.draggable=!0,this.lineAlpha=b,this.lineBlendMode=X;var o=c.shape=new t.Shape,I=Y.stage.width,N=Y.stage.height,p,L,we,B;c.paperNum=0,c.sizeScale=1,c.spreadScale=1,c.sizeFactor=1,c.spreadFactor=1,c.pullThickness=S,c.stop=function(){};var F;this.added(function(G){F=G,c.paper=y,I=c.stage.width,N=c.stage.height,n(k)?c.stageDown=F.on("stagemousedown",function(ie){c.dispatchEvent("start")}):c.zimDown?c.nib=k.addTo(c):(c.nib=k.addTo(c.parent,c.parent.getChildIndex(c)),c.nib.x=c.x,c.nib.y=c.y,c.nib.mouseEnabled=!1,c.stageDown=F.on("stagemousedown",function(ie){F=ie.target.stage,c.nibEvent=F.on("stagemousemove",ce),c.dispatchEvent("start")}),c.stageUp=F.on("stagemouseup",function(){F.off("stagemousemove",c.nibEvent)}));function ce(ie){c.drawing&&(c.nib.x=ie.stageX/t.scaX,c.nib.y=ie.stageY/t.scaY)}c.zimDragCheck=!1,c.stop=function(){c.stopCheck(!0)},c.infinite=!1,c.stopCheck=function(ie){if(ie)c.drawing=!1,c.infinite=!1;else if(c.infinite||c.zimDragCheck||!c.immediateStop&&c.drawing)return;c.immediate(c.x,c.y),setTimeout(function(){var xe;if(!c.drawing){if(g?(o.cache(-(I*T-I)/2,-(N*T-N)/2,I*T,N*T),xe=y.bitmap=new t.Bitmap(o.cacheCanvas).reg((I*T-I)/2,(N*T-N)/2).addTo(y),o.graphics.clear(),o.uncache(),o.top()):xe=o,c.undoLevels>0){var Se={paper:y,line:xe};E.push(Se),E.length>c.undoLevels&&E.shift(),c.dispatchEvent("recordUndo")}g||(o=new t.Shape().clone().addTo(y)),c.lastSegment=xe,c.lastSelected=xe,xe.alpha=c.lineAlpha,xe.blendMode=c.lineBlendMode,xe.paper=y,c.dispatchEvent("stop"),c.dispatchEvent("change")}},c.immediateStop||ie?0:50)};var q=0;c.dampX.immediate(c.x),c.dampY.immediate(c.y),c.lastX=c.lastMidX=c.drawX=c.x,c.lastY=c.lastMidY=c.drawY=c.y;var ue,ge;c.ticker=t.Ticker.add(function(){if(c.parent){var ie=c.dampX.convert(h?c.x:c.finishX),xe=c.dampY.convert(h?c.y:c.finishY),Se=c.parent.localToLocal(ie,xe,o);if(Math.abs(c.lastX-ie)+Math.abs(c.lastY-xe)<1){if(c.drawing&&(c.drawing=!1,c.zimDown?(c.x=c.lastX=c.lastMidX=h?c.x:c.finishX,c.y=c.lastY=c.lastMidY=h?c.y:c.finishY):(c.x=c.finishX=c.lastX=c.lastMidX=ie,c.y=c.finishY=c.lastY=c.lastMidY=xe),c.stopCheck(),ue=ge=null),c.lastX=c.lastMidX=ie,c.lastY=c.lastMidY=xe,y){var z=y.localToLocal(0,0,c.parent);c.lastMidX-=z.x,c.lastMidY-=z.y}return}else{var pe=t.Pick.choose(e)*c.sizeScale*c.sizeFactor,de=t.Pick.choose(a)*c.spreadScale*c.spreadFactor;c.drawing||(Q=[],y.getChildIndex(o)!=y.numChildren-1&&o.top()),c.drawing=!0,c.dispatchEvent("drawing")}var oe=c.parent.localToLocal(c.lastX,c.lastY,o),Be;y?Be=y.localToLocal(c.lastMidX,c.lastMidY,o):Be=c.parent.localToLocal(c.lastMidX,c.lastMidY,o);var $,Me,be;if(i=="splatter")for(var me=0;me<=3;me++){var re=t.rand(360)*Math.PI/180,ke=de,Re={x:ie+ke*Math.cos(re),y:xe+ke*Math.sin(re)},Ye=c.parent.localToLocal(Re.x,Re.y,o);o.graphics.mt(Ye.x,Ye.y).f(t.Pick.choose(r)).dc(Ye.x,Ye.y,pe/2)}else i=="grass"||i=="hair"||i=="city"?((i=="grass"||i=="hair")&&($=c.lastX+(ie-c.lastX)/2,Me=c.lastY+(xe-c.lastY)/2,be=c.parent.localToLocal($,Me,o),o.graphics.s(t.Pick.choose(r)).ss(pe,u).mt(be.x,be.y).lt(be.x+t.rand(-de/4,de/4),i=="hair"?be.y+de:be.y-de)),(i=="grass"||i=="hair"||i=="city"&&q%3==0)&&o.graphics.s(t.Pick.choose(r)).ss(pe,u).mt(Se.x,Se.y).lt(Se.x+(i=="city"?0:t.rand(-de/4,de/4)),i=="hair"?be.y+de:Se.y-de),q++):(i=="kitetail"&&o.graphics.s(t.Pick.choose(r)).ss(pe,u),i=="barbwire"?(o.graphics.s(t.Pick.choose(r)).ss(pe,u),$=c.lastX+(ie-c.lastX)/2+t.rand(-de,de),Me=c.lastY+(xe-c.lastY)/2+t.rand(-de,de)):($=c.lastX+(ie-c.lastX)/2,Me=c.lastY+(xe-c.lastY)/2),be=c.parent.localToLocal($,Me,o),i!="line"&&o.graphics.qt(oe.x,oe.y,be.x,be.y));if(f>0&&i!="line"&&($=c.lastX+(ie-c.lastX)/2,Me=c.lastY+(xe-c.lastY)/2,be=c.parent.localToLocal($,Me,o),o.graphics.s(t.Pick.choose(s)).ss(t.Pick.choose(f)).mt(Be.x,Be.y).qt(oe.x,oe.y,be.x,be.y),i=="splatter"&&o.graphics.es()),i=="splatter")o.graphics.f(t.Pick.choose(r));else if(i!="kitetail")if(i=="line"){if(t.isPick(r)||pe!=ge){var $e=t.Pick.choose(r);($e!=ue||pe!=ge)&&o.graphics.s($e).ss(pe,u),ue=$e,ge=pe}}else o.graphics.s(t.Pick.choose(r)).ss(pe,u);i!="grass"&&i!="hair"&&i!="city"&&i!="splatter"&&o.graphics.mt(Be.x,Be.y).qt(oe.x,oe.y,be.x,be.y),m&&o.graphics.sd(m),c.lastX=ie,c.lastY=xe,be&&(c.lastMidX=be.x,c.lastMidY=be.y),c.drawX=c.lastMidX||0,c.drawY=c.lastMidY||0}}),n(j)||fe(F),c.mouseChildren=!1});function fe(G){var ce=G.frame;c.ppdEvent&&c.off("drawing",c.ppdEvent),c.ppsEvent&&c.off("stop",c.ppsEvent),c.ppmEvent&&G.off("stagemousedown",c.ppmEvent),c.pullShape||(c.pullShape=new t.Shape),c.ppdEvent=c.on("drawing",function(){setTimeout(function(){var q=y.localToGlobal(c.drawX,c.drawY);c.pullShape.c().s(j).ss(c.pullThickness).mt(ce.mouseX,ce.mouseY).lt(q.x,q.y)},10)}),c.ppsEvent=c.on("stop",function(){c.pullShape.removeFrom(),c.pullShape.c()}),c.ppmEvent=G.on("stagemousedown",function(){c.pullShape.addTo(G),c.immediate(ce.mouseX,ce.mouseY),c.motionController&&c.motionController.immediate(ce.mouseX,ce.mouseY)})}function se(){c.ppdEvent&&c.off("drawing",c.ppdEvent),c.ppsEvent&&c.off("stop",c.ppsEvent),c.ppmEvent&&c.off("stagemousedown",c.ppmEvent),c.pullShape&&c.pullShape.dispose()}E=[];var Q=[];this.saveState=function(G,ce,q){var ue=G.type=="Container"?"paper":"line",ge={paper:c.paper};ge[ue]=G,ge[ue+"Transform"]={x:G.x,y:G.y,r:G.rotation,a:G.alpha,rX:G.regX,rY:G.regY,sX:G.scaleX,sY:G.scaleY,skX:G.skewX,skY:G.skewY,v:G.visible},!n(ce)&&!n(q)&&ce!=q&&(ge.startLayer=ce,ge.endLayer=q),E.push(ge),c.dispatchEvent("recordUndo"),E.length>c.undoLevels&&E.shift()};var te={x:0,y:0,r:0,a:1,rX:0,rY:0,sX:1,sY:1,skX:0,skY:0,v:!0};this.undo=function(){var G=E.pop();if(G){if(Q.push(G),G.clear){for(var ce=0;ce<G.clear.length;ce++)G.paper.addChild(G.clear[ce]);G.paper.addChild(o)}else G.line&&G.lineTransform?(n(G.startLayer)||(o.top(),G.paper.setChildIndex(G.line,we)),le("line",G.line)):G.line?G.line.removeFrom():G.paperTransform&&le("paper",G.paper);c.lastPaper=c.paper,G.paper!=c.paper&&(c.paper=G.paper,c.dispatchEvent("paperChange")),c.dispatchEvent("change"),c.dispatchEvent("undo"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&c.stage&&c.stage.update()}};function le(G,ce){for(var q,ue=E.length-1;ue>=0;ue--)if(E[ue][G]==ce&&E[ue][G+"Transform"]){q=E[ue][G+"Transform"];break}q||(q=t.copy(te)),ce.x=q.x,ce.y=q.y,ce.alpha=q.a,ce.rotation=q.r,ce.regX=q.rX,ce.regY=q.rY,ce.scaleX=q.sX,ce.scaleY=q.sY,ce.skewX=q.skX,ce.skewY=q.skY,ce.visible=q.v,G=="line"&&g&&(ce.regX=(I*T-I)/2,ce.regY=(N*T-N)/2)}this.redo=function(){var G=Q.pop(),ce,q;G&&(E.push(G),G.clear?(G.paper.removeAllChildren(),G.paper.addChild(o)):G.line&&G.lineTransform?(n(G.endLayer)||(o.top(),G.paper.setChildIndex(G.line,B)),q=G.lineTransform,ce=G.line):G.line?G.line.addTo(G.paper):G.paperTransform&&(q=G.paperTransform,ce=G.paper),ce&&(ce.x=q.x,ce.y=q.y,ce.alpha=q.a,ce.rotation=q.r,ce.regX=q.rX,ce.regY=q.rY,ce.scaleX=q.sX,ce.scaleY=q.sY,ce.skewX=q.skX,ce.skewY=q.skY,ce.visible=q.v),c.lastPaper=c.paper,G.paper!=c.paper&&(c.paper=G.paper,c.dispatchEvent("paperChange")),c.dispatchEvent("change"),c.dispatchEvent("redo"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&c.stage&&c.stage.update())},c.ctrlKey=!1,c.shiftKey=!1,c.ctrlKeyCheck=!1,c.zimkeydownEvent=function(G){c.ctrlKey=G.ctrlKey,c.shiftKey=G.shiftKey,G.keyCode==17&&C&&!c.ctrlKeyCheck&&(c.ctrlKeyCheck=!0,y.noDrag(),y.drag({onTop:d,all:!0})),!(c.undoLevels<=0)&&c.undoKeys&&(G.ctrlKey&&(G.shiftKey&&G.keyCode==90||G.keyCode==89)?c.redo():G.ctrlKey&&G.keyCode==90&&c.undo(),Y&&Y.ctrlKey&&c.write&&(c.lastWrite=c.write,c.write=!1))},ee.addEventListener("keydown",c.zimkeydownEvent),c.zimkeyupEvent=function(G){G.keyCode==17&&C&&c.ctrlKeyCheck&&(c.ctrlKeyCheck=!1,y.noDrag(),y.drag({onTop:d})),G.ctrlKey||(c.ctrlKey=!1),G.shiftKey||(c.shiftKey=!1),Y&&!Y.ctrlKey&&c.write==!1&&(c.write=c.lastWrite)},ee.addEventListener("keyup",c.zimkeyupEvent),Object.defineProperty(this,"paper",{get:function(){return y},set:function(G){G.type=="Container"&&(y=G,o.addTo(y,0,!1),y.shape=o,c.dampX.immediate(c.x),c.dampY.immediate(c.y),c.lastX=c.lastMidX=c.finishX=c.x,c.lastY=c.lastMidY=c.finishY=c.y,i=="barbwire"&&o.graphics.s(t.Pick.choose(r)).ss(t.Pick.choose(e)*c.sizeScale*c.sizeFactor,u),o.graphics.mt(c.x,c.y),y.parent||y.addTo(c.parent,c.parent.getChildIndex(c)),n(y.paperNum)&&(y.paperNum=++c.paperNum,x&&y.on("mousedown",function(ce){c.lastSelected=ce.target,c.nibEvent&&c.stage.off("stagemousemove",c.nibEvent);var q=ce.target.paper;q&&(q!=c.paper&&(c.paper=q,c.dispatchEvent("paperChange")),c.shiftKey&&(c.ctrlKey?c.clear():(ce.target.visible=!1,c.undoLevels>0&&c.saveState(ce.target),c.dispatchEvent("change"))))}),P&&y.on("dblclick",function(ce){ce.target.visible=!1,c.undoLevels>0&&c.saveState(ce.target)}),P&&y.hold(function(ce){ce.target.visible=!1,c.undoLevels>0&&c.saveState(ce.target)}),C&&(y.on("mousedown",function(ce){F=ce.target.stage,c.draggingCheck=!0,!(c.shiftKey&&x)&&(p=ce.stageX/t.scaX,L=ce.stageY/t.scaY,o.top(),we=y.getChildIndex(ce.target))}),y.drag({onTop:d}),y.on("pressup",function(ce){if(!(x&&c.shiftKey)&&ce.target.visible!=!1&&!(c.undoLevels<=0)){if(Math.abs(ce.stageX/t.scaX-p)<1&&Math.abs(ce.stageY/t.scaY-L)<1){d&&(o.top(),B=y.getChildIndex(ce.target),we!=B&&c.saveState(ce.target,we,B));return}c.ctrlKey?(c.saveState(y),c.dispatchEvent("paperChange")):(o.top(),B=y.getChildIndex(ce.target),c.saveState(ce.target,we,B)),c.dispatchEvent("change"),o.top()}}))))}}),Object.defineProperty(this,"write",{get:function(){return h},set:function(G){h&&G===!1&&(c.finishX=c.x,c.finishY=c.y),!h&&G&&(o.graphics.es(),o.graphics.ef(),c.dampX.immediate(c.x),c.dampY.immediate(c.y),c.lastX=c.lastMidX=c.x,c.lastY=c.lastMidY=c.y),h=G}}),Object.defineProperty(this,"size",{get:function(){return e},set:function(G){o.graphics.es(),o.graphics.ef(),e=G,i!="splatter"&&o.graphics.ss(t.Pick.choose(e)*c.sizeScale*c.sizeFactor,u)}}),Object.defineProperty(this,"color",{get:function(){return r},set:function(G){r=G,o.graphics.es(),o.graphics.ef(),i!="splatter"&&o.graphics.s(t.Pick.choose(r))}}),Object.defineProperty(this,"penType",{get:function(){return i},set:function(G){i=G,o.graphics.ef().es(),i!="splatter"?o.graphics.s(t.Pick.choose(r)):o.graphics.s(t.Pick.choose(r)).ss(t.Pick.choose(e)*c.sizeScale*c.sizeFactor,u)}}),Object.defineProperty(this,"end",{get:function(){return u},set:function(G){u=G}}),Object.defineProperty(this,"damp",{get:function(){return l},set:function(G){l=G,c.dampX.damp=l,c.dampY.damp=l}}),Object.defineProperty(this,"spread",{get:function(){return a},set:function(G){a=G}});var Ae,J;this.setColorRange=function(G,ce){return n(ce)?(Ae=c.color,J=G):n(G)?(Ae=c.color,J=ce):(Ae=G,J=ce),c};var Te=0;Object.defineProperty(c,"colorRange",{get:function(){return Te},set:function(G){Te=G,!n(Ae)&&!n(J)&&(c.color=t.colorRange(Ae,J,G))}}),Object.defineProperty(this,"borderColor",{get:function(){return s},set:function(G){s=G}}),Object.defineProperty(this,"borderWidth",{get:function(){return f},set:function(G){f=G}}),Object.defineProperty(this,"pullColor",{get:function(){return j},set:function(G){if(n(G||G==-1))se(),j=null;else if(n(j)){j=G;var ce=F||zdf.stage;fe(ce)}else j=G}}),c.setPen=function(G){c.dampX.immediate(c.x),c.dampY.immediate(c.y),c.lastX=c.lastMidX=c.finishX=c.x,c.lastY=c.lastMidY=c.finishY=c.y,n(G)&&(G=i),n(D[G])&&(G="line"),c.penType=i=G;var ce=t.merge(V,D[G]);for(var q in ce)c[q]!=ce[q]&&(c[q]=ce[q]);return c},c.immediate=function(G,ce){return n(G)||(c.x=G,c.dampX.immediate(c.x),c.lastX=c.lastMidX=c.finishX=c.x),n(ce)||(c.y=ce,c.dampY.immediate(c.y),c.lastY=c.lastMidY=c.finishY=c.y),c},c.clear=function(){for(var G=[],ce=0;ce<y.numChildren-1;ce++)G.push(y.getChildAt(ce));return E.push({paper:y,clear:G}),E.length>c.undoLevels&&E.shift(),c.dispatchEvent("recordUndo"),y.removeAllChildren(),o.graphics.clear(),y.addChild(o),c.dispatchEvent("change"),c.stage&&c.stage.update(),c},this.deleteSegment=function(G){G.visible=!1,c.undoLevels>0&&c.saveState(G)},this.clone=function(){return this.cloneChildren(this.cloneProps(new t.Pen(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U)))},c.dispose=function(G,ce,q){return n(G)&&(G=!0),ee.removeEventListener("keydown",c.zimkeydownEvent),ee.removeEventListener("keyup",c.zimkeyupEvent),F&&c.nibEvent&&F.off("stagemousemove",c.nibEvent),F&&c.stageDown&&F.off("stagemousedown",c.stageDown),F&&c.stageUp&&F.off("stagemouseup",c.stageUp),F&&c.upEvent&&F.off("stagemouseup",c.upEvent),t.Ticker.remove(c.ticker),c.removeAllEventListeners(),k&&k.removeFrom(),G&&(c.shape&&c.shape.dispose(),c.paper&&c.paper.dispose(),g&&(c.bitmap&&c.bitmap.dispose(),c.bitmap=null),c.zimContainer_dispose(q),y=o=c.shape=null),!0},_!==!1&&t.styleTransforms(this,ne)},t.extend(t.Pen,t.Container,["dispose","clone"],"zimContainer",!1),t.SoundWave=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="num, input, include, smoothing, min, max, operation, baseline, magnify, reduce, adjust, channel",E;if(E=st(t.SoundWave,arguments,T,this))return E;De("69.95"),this.type="SoundWave",n(e)&&(e=120),n(r)&&(r="mic"),n(i)&&(i=120/1024),n(l)&&(l=.85),n(a)&&(a=r=="mic"?-80:(r.oscillator,-100)),n(s)&&(s=r=="mic"?-40:(r.oscillator,-10)),n(f)&&(f=function(b,X){return b*(.5+X*1/Math.pow(t.SoundWave.bufferLength,.95))}),n(u)&&(u=r=="mic"?0:(r.oscillator,30)),n(y)&&(y=r=="mic"?1:r.oscillator?5:10),n(k)&&(k=0),n(g)&&(g=5),t.SoundWave.bufferLength=1024;var A=e,C=this;C.baseline=u,C.magnify=y,C.reduce=k,C.input=r,C.adjust=g;var d;r.type=="Tone"||r.type=="SynthSound"?d=r.audioContext:d=new(ee.AudioContext||ee.webkitAudioContext);var x=C.analyser=d.createAnalyser();x.minDecibels=a,x.maxDecibels=s,x.smoothingTimeConstant=l,Object.defineProperty(this,"smoothing",{get:function(){return x.smoothingTimeConstant},set:function(b){x.smoothingTimeConstant=b}}),Object.defineProperty(this,"num",{get:function(){return A},set:function(b){A=b,P=Math.floor(i*t.SoundWave.bufferLength/A),P<1&&tt("ZIM SoundWave: num is too big")}}),this.setInput=function(b){if(C.input=b,b=="mic"){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!0}).then(function(m){var j=C.source=d.createMediaStreamSource(m);w(j)}).catch(function(m){tt("ZIM SoundWave: Error occured: "+m)}):navigator.getUserMedia?navigator.getUserMedia({audio:!0},function(m){var j=C.source=d.createMediaStreamSource(m);w(j)},function(m){tt("ZIM SoundWave: Error occured: "+m)}):tt("ZIM SoundWave: Sorry, mic not supported");return}else if(b.type=="Tone")w(b.compressor);else if(b.type=="SynthSound")w(b.gain);else{if(b.type&&b.type=="sound"){tt("ZIM SoundWave: pass in the result of a zim.asset('somesound').play() for the input");return}var X,Y;b.playbackResource?(X=b.playbackResource,Y=d.createMediaElementSource(X)):(X=b,Y=d.createMediaElementSource(X)),w(Y)}},this.setInput(r);var P,v;function w(b){if(v&&v.disconnect(x),v=b,n(O)||O!==0&&O!==1)b.connect(x),r!="mic"&&x.connect(d.destination);else{var X=new ChannelSplitterNode(d,{numberOfOutputs:2});b.connect(X),X.connect(x,O);var Y=new ChannelMergerNode(d,{numberOfInputs:2});x.connect(Y,0,O),r!="mic"&&Y.connect(d.destination)}if(x.fftSize=t.SoundWave.bufferLength*2,P=Math.floor(i*t.SoundWave.bufferLength/A),P<1){tt("ZIM SoundWave: include param is too small or num param is too big");return}var m=x.frequencyBinCount,j=new Uint8Array(m),S=300,_=0,R=0,U=Math.round(60*C.adjust*.8),Z=new t.Damp(S,.01);C.calculate=function(K){n(K)&&(K=!0),x.getByteFrequencyData(j);var ne=j.map(f);if(P==1&&!K)return ne;var V=[],D=0,c;for(c=0;c<=i*t.SoundWave.bufferLength;c++)D+=ne[c],c!=0&&c%P==0&&(V.push(Math.max(0,(D/P-C.baseline)*C.magnify-C.reduce)),D=0);var h=V.length;if(r!="mic"&&(V[0]*=.75,V[1]*=.85,V[2]*=.9,V[h-2]*=.8,V[h-1]*=.75),V[h-1]*=1.3,V[h-2]*=1.2,V[h-3]*=1.1,K){var o=[];U++,U>=60*C.adjust&&(S=_/U,_=0,R=0,U=0);var I=Z.convert(S);for(c=0;c<h;c++)V[c]>R&&(R=V[c]),o[c]=Math.min(1,I!=0?V[c]/I:0);return _+=R,o}return V},setTimeout(function(){C.dispatchEvent("ready")},50)}this.dispose=function(b){return b&&d&&d.close(),x&&x.disconnect(),!0}},t.extend(t.SoundWave,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),t.Synth=function(e,r){De("69.955"),this.type="Synth",n(e)&&(e=.3),n(r)&&(r=220),this.volume=e,this.frequency=r;var i=this,l;this.play=function(a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te){var G=Array.prototype.slice.call(arguments);if(G=G.shift(),!l&&(ee.AudioContext||ee.webkitAudioContext)&&(l=new(ee.AudioContext||ee.webkitAudioContext),l.z=l.createBufferSource,l.createBufferSource=function(ue){return ue==null&&(ue=l.z()),ue.start=ue.start||function(ge){l.noteOn(ge)},ue}),!!l){for(a=a!=null?nt(a):0,s=s!=null?nt(s):.3,f=f!=null?nt(f):.05,u=u!=null?nt(u):220,y=y!=null?nt(y):0,k=k!=null?nt(k):0,g=g!=null?nt(g):.1,O=O!=null?nt(O):0,T=T!=null?nt(T):1,E=E!=null?nt(E):0,A=A!=null?nt(A):0,C=C!=null?nt(C):0,d=d!=null?nt(d):0,x=x!=null?nt(x):0,P=P!=null?nt(P):0,v=v!=null?nt(v):0,w=w!=null?nt(w):0,b=b!=null?nt(b):0,m=m!=null?nt(m):0,X=X!=null?nt(X):1,Y=Y!=null?nt(Y):0,K=K!=null?nt(K):44100,ne==null&&(ne=99+y*K),V==null&&(V=k*K),D==null&&(D=g*K),c==null&&(c=Y*K),h==null&&(h=b*K),o==null&&(o=Math.PI*2),I==null&&(I=function(ue){return ue>0?1:-1}),N==null&&(N=ne+c+V+D+h),p==null&&(p=E*=500*o/Math.pow(K,2)),L==null&&(L=u*=(1+f*2*Math.random()-f)*o/K),we==null&&(we=I(v)*o/4),B==null&&(B=0),F==null&&(F=0),fe==null&&(fe=0),se==null&&(se=0),Q==null&&(Q=0),te==null&&(te=0),le==null&&(le=1),Ae==null&&(Ae=[]),J==null&&(J=l.createBufferSource()),Te==null&&(Te=l.createBuffer(1,N,K)),J.connect(l.destination);fe<Math.floor(N);Ae[fe++]=te)++Q>w*100&&(Q=0,te=B*u*Math.sin(F*v*o/K-we),te=O?O>1?O>2?O>3?Math.sin(Math.pow(te%o,3)):Math.max(Math.min(Math.tan(te),1),-1):1-(2*te/o%2+2)%2:1-4*Math.abs(Math.round(te/o)-te/o):Math.sin(te),te=(x?1-m+m*Math.sin(o*fe/x):1)*I(te)*Math.pow(Math.abs(te),T)*s*i.volume*(fe<ne?fe/ne:fe<ne+c?1-(fe-ne)/c*(1-X):fe<ne+c+V?X:fe<N-h?(N-fe-h)/D*X:0),te=h?te/2+(h>fe?0:(fe<N-h?1:(fe-N)/h)*Ae[fe-h|0]/2):te),B+=1-P+(Math.sin(fe)+1)*1e9%2*P,F+=1-P+(Math.pow(Math.sin(fe),2)+1)*1e9%2*P,u+=E+=A*500*o/Math.pow(K,3),le&&++le>d*K&&(u+=C*o/K,L+=C*o/K,le=0),x&&++se>x*K&&(u=L,E=p,se=1,le=le||1);Te.getChannelData(0).set(Ae),J.buffer=Te;var ce=new Fe.EventDispatcher;ce.type="SynthSound",ce.audioContext=l,ce.gain=l.createGain(),J.connect(ce.gain),ce.gain.connect(l.destination),ce.pan=l.createStereoPanner(),ce.pan.pan.value=a,J.connect(ce.pan),ce.pan.connect(l.destination),J.start(),ce.duration=Ae.length/K,ce.playing=!0,ce.stop=function(){clearTimeout(ce.completeID),clearInterval(ce.repeatID),ce.gain.gain.setTargetAtTime(0,l.currentTime,.1),ce.playing=!1,setTimeout(function(){l.close()},.1*1e3)};var q;return ce.repeat=ce.loop=function(ue,ge){q=0,ue===!0&&(ue=null),n(ge)&&(ge=0),clearTimeout(ce.completeID);function ie(){return ce.duration+nt(ge)}return ce.repeatID=t.interval(ie,function(){q++,ue&&q>=ue?(ce.dispatchEvent("complete"),ce.repeatID.clear(),ce.playing=!1):(ce.dispatchEvent("loop"),i.play.apply(i,G))}),ce},ce.play=function(){return i.play.apply(i,G),ce.playing=!0,ce},ce.completeID=setTimeout(function(){ce.dispatchEvent("complete")},(Ae.length/K+.1)*1e3),ce}},this.Tone=function(a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y){var m="volume, note, shape, pan, duration, attack, release, wahAmount, wahRate, wahShape, wahThroat, wahNote, vibratoAmount, vibratoRate, vibratoShape, tremeloAmount, tremeloRate, tremeloShape, startTime, pauseOnBlur",j;if(j=st(i.Tone,arguments,m,this))return j;this.type="Tone";var S=this,_;n(a)&&(a=i.volume),n(s)&&(s=i.frequency),n(f)&&(f=t.SINE),n(u)&&(u=0),n(k)&&(k=.02),n(g)&&(g=.05),n(X)&&(X=0),ee.AudioContext||ee.webkitAudioContext?_=this.audioContext=new(ee.AudioContext||ee.webkitAudioContext):vt&&tt("Synth tone() needs AudioContext"),a=nt(a),s=nt(s),f=nt(f),u=nt(u),y=nt(y),k=nt(k),g=nt(g),O=nt(O),T=nt(T),E=nt(E),A=nt(A),C=nt(C),d=nt(d),x=nt(x),P=nt(P),v=nt(v),w=nt(w),b=nt(b),X=nt(X);var R=Tt(y);i.duration=y,y&&(y=y*(R=="s"?1:1/1e3)),X&&(Tt(X),X=X*(R=="s"?1:1/1e3)),i.attack=k,i.release=g,i.rampDuration=.02,i.hush=.1;var U=this.note=this.oscillator=_.createOscillator();U.frequency.value=t.Synth.note(s),t.Synth.setShape(U,f);var Z=this.filter=_.createBiquadFilter();Z.type="bandpass",Z.frequency.value=U.frequency.value,Z.Q.value=0;var K=this.gain=U.gain=_.createGain();K.type="gain",K.gain.setValueAtTime(0,_.currentTime);var ne=this.compressor=_.createDynamicsCompressor();ne.threshold.setValueAtTime(-50,_.currentTime),ne.knee.setValueAtTime(40,_.currentTime),ne.ratio.setValueAtTime(12,_.currentTime),ne.attack.setValueAtTime(0,_.currentTime),ne.release.setValueAtTime(.25,_.currentTime);var V=this.panNode=_.createStereoPanner();this.panNode.pan.value=u,U.connect(Z),Z.connect(V),V.connect(K),K.connect(ne),ne.connect(_.destination);function D(Q,te){n(Q)&&(Q=_.currentTime),n(te)&&(te=i.attack),U.start(Q);var le=ee.zdf&&new Date().getTime()-ee.zdf.startTime<200?.1:i.attack;K.gain.setValueAtTime(0,_.currentTime+.1),K.gain.linearRampToValueAtTime(a*i.hush,_.currentTime+.1+le)}D(X),this.stop=function(Q){n(Q)&&(Q=i.release),K&&h(K.gain,0,!0,Q),F&&h(F.gain,0,!0,Q),L&&h(L.gain,0,!0,Q),setTimeout(function(){S.dispatchEvent("complete")},(.6+Q+i.rampDuration)*1e3),setTimeout(function(){_&&!_.iamClosed&&(_.iamClosed=!0,_.close())},(Q+1)*1e3),setTimeout(function(){o&&S.removeWah()},(Q+1)*1e3)},y&&this.stop(X+y-.1);var c=this.notes=[U];this.addNote=function(Q,te,le,Ae,J,Te){n(Ae)&&(Ae=!0),n(J)&&(J=!1),n(Q)&&(Q=.1),n(Te)&&(Te=0);var G={type:"Note"};G._volume=Q,G._note=t.Synth.note(te),c.push(G);var ce=G.oscillator=_.createOscillator();ce.frequency.value=G._note,ce.type=t.Synth.setShape(ce,le);var q=G.gain=_.createGain();return h(q.gain,G._volume,!0),q.connect(Ae?Z:K),ce.connect(q),L&&J&&L.connect(ce.frequency),ce.start(_.currentTime+Te),Object.defineProperty(G,"volume",{get:function(){return G._volume},set:function(ue){n(ue)||(G._volume=nt(ue),h(G.gain.gain,G._volume,!0))}}),Object.defineProperty(G,"note",{get:function(){return G._note},set:function(ue){n(ue)||(G._note=nt(ue),h(G.oscillator.frequency,t.Synth.note(G._note)))}}),G},this.removeNote=function(Q){var te=c.indexOf(Q);return te>=0&&c.splice(te,1),Q.oscillator.disconnect(),Q=null,this};function h(Q,te,le,Ae){n(te)&&(te=0),n(Ae)&&(Ae=i.rampDuration),le?(Q.cancelScheduledValues(_.currentTime),Q.linearRampToValueAtTime(Q.value,_.currentTime+.02),Q.linearRampToValueAtTime(te,_.currentTime+.05+Ae)):(Q.cancelScheduledValues(_.currentTime),Q.setTargetAtTime(te,_.currentTime,Ae))}this.ramp=function(Q,te){h(K.gain,Q*i.hush,!0,te)},this.rampPan=function(Q,te){h(V.pan,Q,!1,te)},this.animate=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),t.animate.apply(null,arguments),this},this.wiggle=function(){return arguments[0].props?arguments[0].target=this:Array.prototype.unshift.call(arguments,this),t.wiggle.apply(null,arguments),this},t.addWires(this);var o,I;function N(){n(O)&&(O=1e3),n(T)&&(T=1),n(E)&&(E="sine"),n(A)&&(A=5),n(C)?C=S.oscillator.frequency.value:C=t.Synth.note(C),n(I)&&(I=200),S.filter.Q.value=A,o=S.wah=i.oscillator(T,O/2,E,C+O/2+I),o.ticker=t.Ticker.add(function(){S.filter.frequency.value=S.wah.amplitude})}(O||T||!n(E)||!n(A))&&N(),S.removeWah=function(){t.Ticker.remove(o.ticker),o.dispose(),o=S.wah=null,S.filter.Q.value=0};var p,L;function we(){n(x)&&(x=5),n(P)&&(P="sine"),n(d)&&(d=10),p=S.vibrato=_.createOscillator(),L=S.vibratoGain=_.createGain(),L.gain.value=0,p.frequency.value=x,t.Synth.setShape(p,P),p.connect(L),L.connect(U.frequency),p.start(0),L.gain.setValueAtTime(0,_.currentTime+.1),L.gain.linearRampToValueAtTime(d,_.currentTime+.1+i.attack)}(d||x||!n(P))&&we(),S.removeVibrato=function(){h(L.gain,0,!0),setTimeout(function(){L.disconnect(),p.disconnect(),p.stop(),p=null},(i.rampDuration+1)*1e3)};var B,F;function fe(){n(w)&&(w=5),n(b)&&(b="sine"),B=S.tremelo=_.createOscillator(),F=S.tremeloGain=_.createGain(),F.gain.value=0,B.frequency.value=w,t.Synth.setShape(B,b),B.connect(F),F.connect(K.gain),B.start(0);var Q=ee.zdf&&new Date().getTime()-ee.zdf.startTime<200?.1:i.attack;F.gain.setValueAtTime(0,_.currentTime+.1),F.gain.linearRampToValueAtTime(a*i.hush,_.currentTime+.1+Q)}(v||w||!n(b))&&fe(),S.removeTremelo=function(){h(F.gain,0,!0),setTimeout(function(){F.disconnect(),B.disconnect(),B.stop(),B=null},(i.rampDuration+1)*1e3)},Object.defineProperty(this,"volume",{get:function(){return a},set:function(Q){if(!n(Q)){var te;B?(K.gain.value?te=F.gain.value/K.gain.value:te=a?v/a:0,a=nt(Q),a=t.constrain(a,.001),h(F.gain,a*te*i.hush,!0)):a=nt(Q),h(K.gain,a*i.hush,!1,i.rampDuration)}}}),this.paused=!1;var se=a;this.pause=function(Q){n(Q)&&(Q=!0),Q?(se=S.volume,S.volume=0):S.volume=se},Y&&(n(t.blurCheck)&&t.setBlurDetect(),t.pauseOnBlur.push(this)),Object.defineProperty(this,"frequency",{get:function(){return r},set:function(Q){n(Q)||(r=nt(Q),h(U.frequency,Q))}}),Object.defineProperty(this,"note",{get:function(){return s},set:function(Q){n(Q)||(s=nt(Q),U.frequency.value=t.Synth.note(s))}}),Object.defineProperty(this,"shape",{get:function(){return f},set:function(Q){f=nt(Q),t.Synth.setShape(U,f)}}),Object.defineProperty(this,"pan",{get:function(){return u},set:function(Q){n(Q)||(u=nt(Q),h(V.pan,u,!1,.1))}}),Object.defineProperty(this,"currentTime",{get:function(){return _.currentTime},set:function(){vt&&tt("Synth tone() - currentTime is read only")}}),this.wahAmountMin=0,this.wahAmountMax=5e3,Object.defineProperty(this,"wahAmount",{get:function(){return O},set:function(Q){n(Q)||(O=nt(Q),O=t.constrain(O,i.wahAmountMin,i.wahAmountMax),n(o)?N():o.gain=O/2)}}),this.wahRateMin=0,this.wahRateMax=30,Object.defineProperty(this,"wahRate",{get:function(){return T},set:function(Q){n(Q)||(T=nt(Q),T=t.constrain(T,i.wahRateMin,i.wahRateMax),n(o)?N():o.frequency=T)}}),this.wahThroatMin=0,this.wahThroatMax=100,Object.defineProperty(this,"wahThroat",{get:function(){return A},set:function(Q){A=nt(Q),A=t.constrain(A,i.wahThroatMin,i.wahThroatMax),n(o)?N():Z.Q.value=A}}),Object.defineProperty(this,"wahNote",{get:function(){return C},set:function(Q){n(Q)||(C=nt(Q),n(o)?N():o.offset=C+O/2+I)}}),Object.defineProperty(this,"wahAdjust",{get:function(){return I},set:function(Q){n(Q)||(I=nt(Q),n(o)?N():o.offset=C+O/2+I)}}),Object.defineProperty(this,"wahShape",{get:function(){return E},set:function(Q){E=nt(Q),n(o)?N():o.shape=E}}),Object.defineProperty(this,"tremeloAmount",{get:function(){return v},set:function(Q){n(Q)||(v=nt(Q),n(B)?fe():F.gain.setValueAtTime(v,_.currentTime))}}),Object.defineProperty(this,"tremeloRate",{get:function(){return w},set:function(Q){n(Q)||(w=nt(Q),n(o)?fe():B.frequency.value=w)}}),Object.defineProperty(this,"tremeloShape",{get:function(){return b},set:function(Q){b=nt(Q),n(B)?fe():t.Synth.setShape(B,b)}}),Object.defineProperty(this,"vibratoAmount",{get:function(){return d},set:function(Q){n(Q)||(d=nt(Q),n(p)?we():L.gain.setValueAtTime(d,_.currentTime))}}),Object.defineProperty(this,"vibratoRate",{get:function(){return x},set:function(Q){n(Q)||(x=nt(Q),n(p)?we():p.frequency.value=x)}}),Object.defineProperty(this,"vibratoShape",{get:function(){return P},set:function(Q){P=nt(Q),n(p)?we():t.Synth.setShape(p,P)}})},t.extend(this.Tone,Fe.EventDispatcher),this.tone=function(a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Tone,arguments))},this.Oscillator=function(a,s,f,u){var y="frequency, gain, shape, offset",k;if(k=st(i.Oscillator,arguments,y,this))return k;this.type="Oscillator",n(a)&&(a=1),n(s)&&(s=10),n(f)&&(f="sine"),n(u)&&(u=0),this.frequency=nt(a),this.gain=nt(s),this.shape=nt(f),this.shape=="saw"&&(this.shape="sawtooth"),this.offset=nt(u),this.paused=!1;var g=this,O=0,T=t.Ticker.framerate;this.ticker=t.Ticker.add(function(){if(!g.paused){var E=0;g.shape=="sine"?E=Math.sin(g.frequency*(Math.PI*2*(O/T))):g.shape=="square"?(E=Math.sin(g.frequency*(Math.PI*2*(O/T))),E=E<=0?0:1):g.shape=="triangle"?E=2/Math.PI*Math.asin(Math.sin(g.frequency*Math.PI*2*O/T)):g.shape=="sawtooth"||g.shape=="saw"?E=-2/Math.PI*Math.atan(1/Math.tan(g.frequency*Math.PI*O/T)):g.shape=="zap"&&(E=2/Math.PI*Math.atan(1/Math.tan(g.frequency*Math.PI*O/T))),g.amplitude=E*g.gain+g.offset,O++}}),this.pause=function(E){g.paused=E},this.dispose=function(){t.Ticker.remove(this.ticker)}},this.oscillator=function(a,s,f,u){return Array.prototype.unshift.call(arguments,null),new(Function.prototype.bind.apply(i.Oscillator,arguments))}},t.Synth.notes=["C",null,"D",null,"E","F",null,"G",null,"A",null,"B"],t.Synth.major=["C","D","E","F","G","A","B","C4"],t.Synth.minor=["C","D","Eb","F","G","Ab","B","C4"],t.Synth.shapes=["sine","triangle","sawtooth","tan","noise","square"],t.Synth.setShape=function(e,r){if(!n(e)){n(r)&&(r="sine"),r=="saw"&&(r="sawtooth");var i;if(typeof r=="number")r=t.Synth.shapes[r],r||(r="sine");else if(r.real&&r.imag)i=e.context.createPeriodicWave(new Float32Array(r.real),new Float32Array(r.imag));else if(r.constructor==PeriodicWave)i=r;else if(typeof r=="string"){var l=t.Synth.shapes.indexOf(r);if(l<0&&(r="sine"),r=="noise"){for(var a=4096,s=new Float32Array(a),f=new Float32Array(a),u=1;u<a;u+=2)f[u]=t.shuffle([0,.5,1])[0];i=e.context.createPeriodicWave(s,f)}else r=="tan"&&(r="sawtooth")}else r="sine";i?(e.setPeriodicWave(i),r="custom"):e.type=r}},t.Synth.getNote=function(e,r){return n(r)&&(r=0),e*Math.pow(2,r/12)},t.Synth.note=function(e){if(typeof e=="string"){var r=e.substr(0,1).toUpperCase(),i=t.loop(e,function(u){if(!isNaN(u))return Number(u)});i=i!==!0&&!isNaN(i)?i:3;var l=t.Synth.notes.indexOf(r);l<0&&(l=9);var a=e.match(/b/g),s=e.match(/#/g);a=a?a.length:0,s=s?s.length:0;var f=(i-3)*12+l+s-a;return t.Synth.getNote(t.Synth.getNote(220,-9),f)}else return typeof e!="number"&&(e=220),e},t.Synth.wave=function(e,r){if(ee.AudioContext||ee.webkitAudioContext){var i=new(ee.AudioContext||ee.webkitAudioContext);if(e.real)r=e.imag,e=e.real;else if(n(r)&&vt){tt("Synth.wave() - pass in asset('wave.json') or real and imag properties");return}return e.constructor!==Float32Array&&(e=new Float32Array(e)),r.constructor!==Float32Array&&(r=new Float32Array(r)),i.createPeriodicWave(e,r)}},t.Synth.drawWave=function(e,r,i,l,a,s,f,u,y){var k="shape, color, thickness, backgroundColor, borderColor, borderWidth, corner, padding, paddingV",g;if(g=st(t.Synth.drawWave,arguments,k))return g;var O=45,T=45;e=nt(e),n(i)&&(i=2),n(r)&&(r=t.darker),n(u)&&(u=8),n(y)&&(y=u);var E=u,A=y,C=new t.Container(O,T);C.mouseChildren=!1,n(l)||(C.backing=new t.Rectangle(O,T,l,a,s,f).addTo(C)),C.shape=new t.Shape(O,T).addTo(C).s(r).ss(i);var d=O-E*2;return e=="square"?C.shape.mt(E,T/2).lt(E,A+3).lt(O/2,A+3).lt(O/2,T-A-3).lt(O-E,T-A-3).lt(O-E,T/2):e=="triangle"?C.shape.mt(E,T/2).lt(E+d/4,A+3).lt(E+d*3/4,T-A-3).lt(O-E,T/2):e=="sawtooth"||e=="saw"?C.shape.mt(E,T/2).lt(O/2,A+2).lt(O/2,T-A-2).lt(O-E,T/2):e=="zap"?C.shape.mt(E,T/2).lt(O/2,T-A-2).lt(O/2,A+2).lt(O-E,T/2):C.shape.mt(E,T/2).bt(O/2,0-15,O/2,T+15,O-E,T/2),C.type=e,C},t.VR=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="content, angle, distance, parallax, parallaxAngle, damp, parallaxDamp, startAngle, negativeParallax, boundaryMarkers, swiper, holder",E;if(E=st(t.VR,arguments,T,this))return E;if(De("69.98"),this.type="VR",!ee.zdf){vt&&tt("VR() - please use ZIM Frame");return}var A=ee.zdf;(n(O)||!O.getBounds||!O.getBounds().width)&&(O=A.stage),n(r)&&(r=0),n(i)&&(i=100),n(s)&&(s=.5),n(l)&&(l=0),n(a)&&(a=60),n(f)&&(f=.1),n(u)&&(u=0),n(y)&&(y=!1),n(k)&&(k=!0),n(g)&&(g=!0),this.angle=r,this.currentAngle=u,t.mobile()&&(g=!1);var C=this,d=O.width,x=O.height;C.zimContainer_constructor();var P=C.left=new t.Container(d/2,x,null,null,!1),v=new t.Rectangle(d/2,x,"rgba(0,0,0,.01)",null,null,null,null,null,null,!1);P.addChild(v);var w=C.right=P.clone();C.addChild(P,w),w.x=d/2;var b=C.contentLeft=C.content=e,X=C.contentRight=e.clone();if(u!=0)var Y=setTimeout(m,100);else m();function m(){b.addTo(P,null,!1).setMask(P.getChildAt(0)).pos({y:(O.height-b.height)/2,reg:!0}),X.addTo(w,null,!1).setMask(w.getChildAt(0)).pos({y:(O.height-b.height)/2,reg:!0})}var j=[],S=[];function _(G,ce,q,ue){G.vrMatch=ce,ce.vrMatch=G,G.cacheCanvas&&ce.cache(),G.dep&&!n(G.depth)&&(j.push(G),S.push(ce),n(q)||q.push(G),n(ue)||ue.push(ce),ce.dep(G.depth)),t.loop(G,function(ge,ie){_(ge,ce.getChildAt(ie),q,ue)})}_(b,X);function R(G,ce){t.loop(G,function(q){q.vrChannel=ce,q.vrStartX=q.x,r!=0&&i!=0&&(q.vrAngle=r,q.vrDistance=i),l!=0&&i!=0&&(q.vrParallax=l/100,q.vrParallaxDistance=0,r!=0&&(q.vrParallaxDamp=new t.Damp(0,f))),q.dep(q.depth)})}if(R(j,"left"),R(S,"right"),r!=0&&i!=0){var U=new t.Damp(180+u,s);U.immediate(180+u);var Z=!1,K=!1;A.on("deviceorientation",function(G){ne(U.convert((G.rotation.z>180?-180:180)+G.rotation.z+u)-180)}),t.Ticker.always()}function ne(G){C.currentAngle=G;var ce=-C.currentAngle*i/r;C.contentLeft.x=ce,C.contentRight.x=ce;var q;Math.round(C.currentAngle)<=-r/2&&!Z?(q=new Fe.Event("boundaryout"),q.boundary="left",Z=!0,C.dispatchEvent(q)):Math.round(C.currentAngle)>=r/2&&!K?(q=new Fe.Event("boundaryout"),q.boundary="right",K=!0,C.dispatchEvent(q)):Math.round(C.currentAngle)>-r/2&&Math.round(C.currentAngle)<r/2&&(q=new Fe.Event("boundaryin"),Z?(q.boundary="left",C.dispatchEvent(q),Z=!1):K&&(q.boundary="right",C.dispatchEvent(q),K=!1))}function V(G){var ce=G.parent.localToLocal(G.vrStartX,0,O),q=G.vrParallaxDamp.convert(G.vrChannel=="left"?C.contentLeft.x+ce.x-d/4:C.contentRight.x+ce.x-d/2-d/4);G.depth<=0&&!y&&(q=0),G.vrParallaxDistance=Math.max(-i/r*a/2,Math.min(i/r*a/2,q)),G.dep(G.depth)}if(l!=0&&i!=0){var D=new t.ProportionDamp(180-a/2,180+a/2,-a/2,a/2,f);D.immediate(180),A.on("deviceorientation",function(G){var ce=0;r==0&&l!=0&&i!=0&&(ce=D.convert((G.rotation.z>180?-180:180)+G.rotation.z)),h(ce)}),t.Ticker.always()}function c(G,ce){G.vrParallaxDistance=G.depth<=0&&!y?0:ce,G.dep(G.depth)}function h(G){r!=0&&i!=0?(t.loop(j,V),t.loop(S,V)):(t.loop(j,function(ce){c(ce,G)}),t.loop(S,function(ce){c(ce,G)}))}g&&i!=0&&(r!=0||l!=0)&&C.added(function(){var G={swipeAngle:0};C.swiper=new t.Swiper({swipeOn:C,target:G,property:"swipeAngle",sensitivity:.2,damp:.05,factor:-1,min:-330,max:330}),t.Ticker.add(function(){r!=0&&i!=0&&ne(G.swipeAngle),l!=0&&i!=0&&h(D.convert(G.swipeAngle+180))})});var o=localStorage&&localStorage.zimEyeAdjust?Number(localStorage.zimEyeAdjust):0,I=o,N=!1;b.startRegX=b.regX,X.startRegX=X.regX;var p=this.adjuster=new t.Container(800,300,null,null,!1);v=p.backing=new t.Rectangle(p.width,p.height,t.lighter,null,null,null,null,null,null,!1).center(p).alp(1).sha("rgba(0,0,0,.2)",0,0,30),p.strip=new t.Rectangle(p.width,p.height/3,t.white,null,null,null,null,null,null,!1).center(p).alp(1),p.label=new t.Label({text:"slide to adjust center of left and right",size:28,color:t.dark,align:"center",valign:"center"}).center(p).pos({y:50,reg:!0});var L=p.close=new t.Rectangle(50,50,t.light,null,null,null,null,null,null,!1).addTo(p).mov(p.width-70,26),we=new t.Shape(-40,-40,80,80,null,!1);we.graphics.f(t.dark).p("AmJEVIEUkTIkXkWIB4h5IEWEYIETkTIB4B3IkTESIEQERIh4B4IkRkRIkSEVg"),we.center(L).sca(.3),L.cur("pointer"),L.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){C.hideAdjuster(),fe.currentValue=(fe.max-fe.min)/2+I,C.dispatchEvent("closed")});var B=new t.Circle(30,t.dark,null,null,null,null,null,null,!1).center(p).pos({x:p.width/4,reg:!0});B.shape.alpha=.2,new t.Circle(12,t.dark,null,null,null,null,null,!1).center(B);var F=new t.Circle(30,t.dark,null,null,null,null,null,!1).center(p).pos({x:p.width/4*3,reg:!0});F.shape.alpha=.2,new t.Circle(12,t.dark,null,null,null,null,null,null,!1).center(F);var fe=p.slider=new t.Slider({min:0,max:30,step:1,useTicks:!0,style:!1}).centerReg(p).pos({y:p.height-40,reg:!0});fe.currentValue=(fe.max-fe.min)/2+o;var se=new t.Proportion(fe.min,fe.max,B.x-p.width/4,B.x+p.width/4,-1),Q=new t.Proportion(fe.min,fe.max,F.x-p.width/4,F.x+p.width/4);fe.on("change",function(){B.x=se.convert(fe.currentValue),F.x=Q.convert(fe.currentValue)}),new t.Label("closer",24,null,t.silver).centerReg(p).pos({x:fe.x-220,y:fe.y,reg:!0}),new t.Label("farther",24,null,t.silver).centerReg(p).pos({x:fe.x+220,y:fe.y,reg:!0});var te=C.ok=new t.Button({label:"OK",width:90,height:60,corner:0,backgroundColor:t.blue,rollBackgroundColor:t.green,shadowColor:-1,style:!1}).centerReg(p).sca(.8).pos({x:p.width-58,y:fe.y,reg:!0});te.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){localStorage&&(localStorage.zimEyeAdjust=fe.currentValue-(fe.max-fe.min)/2),J(),C.hideAdjuster(),C.dispatchEvent("saved"),C.dispatchEvent("closed")});var le=C.zero=new t.Button({label:">|<",width:90,height:60,corner:0,backgroundColor:t.yellow,rollBackgroundColor:t.green,shadowColor:-1,style:!1}).centerReg(p).sca(.8).pos({x:58,y:fe.y,reg:!0});le.on((Et?t.ACTIONEVENT=="mousedown":ee.ACTIONEVENT=="mousedown")?"mousedown":"click",function(){fe.currentValue=(fe.max-fe.min)/2,B.x=se.convert(fe.currentValue),F.x=Q.convert(fe.currentValue)});var Ae=new t.Proportion(0,30,-O.width/4,O.width/4);function J(){var G=Ae.convert(fe.currentValue);b.regX=b.startRegX+G,X.regX=X.startRegX-G}J(),this.showAdjuster=function(){if(N)return C;N=!0,B.x=se.convert(fe.currentValue),F.x=Q.convert(fe.currentValue),I=fe.currentValue-(fe.max-fe.min)/2,p.scaleTo(O,100,100).center(this),O.stage.update()},this.hideAdjuster=function(){if(!N)return C;N=!1,p.removeFrom(this),O.stage.update()},this.position=function(G,ce,q){ue(G),ue(G.vrMatch);function ue(ge){ge.vrStartX=ce,ge.vrParallaxDamp&&ge.vrParallaxDamp.immediate(ce),ge.mov(ce,q)}return G},this.register=function(G){if(!G.parent||!G.parent.vrMatch)return vt&&tt("ZIM VR() - please only register objects already inside content container"),G;var ce=G.clone().addTo(G.parent.vrMatch),q=[],ue=[];return _(G,ce,q,ue),R(q,"left"),R(ue,"right"),G},r!=0&&i!=0&&k&&(C.boundaryRight=new t.Container({style:!1}),new t.Circle(24,t.light,null,null,null,null,null,null,!1).addTo(C.boundaryRight).dep(-2),new t.Triangle(16,16,16,t.yellow,t.grey,null,null,null,-3,null,null,!1).rot(-90).center(C.boundaryRight).dep(-6),C.boundaryRight.center(e).mov(i/2+24),C.boundaryLeft=new t.Container({style:!1}),new t.Circle(24,t.light,null,null,null,null,null,null,!1).addTo(C.boundaryLeft).dep(-2),new t.Triangle(16,16,16,t.yellow,t.grey,null,null,null,-3,null,null,!1).rot(90).center(C.boundaryLeft).dep(-6),C.boundaryLeft.center(e).mov(-i/2-24),C.register(C.boundaryRight),C.register(C.boundaryLeft));function Te(G){var ce=j.indexOf(G);j.indexOf(G)>=0&&(j.splice(ce,1),S.splice(ce,1)),t.loop(G,function(q){Te(q)})}this.remove=function(){return t.loop(arguments,function(G,ce){e.contains(ce)&&(Te(ce),ce.parent.removeChild(ce),ce.vrMatch.parent.removeChild(ce.vrMatch))}),C},this.resize=function(){d=O.width,x=O.height,P.getChildAt(0).widthOnly=w.getChildAt(0).widthOnly=d/2,P.getChildAt(0).heightOnly=w.getChildAt(0).heightOnly=x,w.x=d/2,P.setBounds(0,0,d/2,x),w.setBounds(0,0,d/2,x),u!=0?(clearTimeout(Y),Y=setTimeout(m,100)):m(),p.scaleTo(O,100,100).center(this,null,!1)}},t.extend(t.VR,t.Container,"clone","zimContainer",!1),t.scaX=1,t.scaY=1,t.Frame=function(e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne){var V="scaling, width, height, color, outerColor, ready, assets, path, progress, ticker, rollover, touch, scrollTop, align, valign, canvasID, rollPerSecond, delay, canvasCheck, gpu, gpuObj, nextFrame, nextStage, allowDefault, loadFailObj, sensors, retina, mouseMoveOutside, captureMouse, shim, maxConnections, maxNum, singleTouch",D;if(D=st(t.Frame,arguments,V,this))return D;De("83"),vt&&ri("ZIM FRAME"),this.cjsEventDispatcher_constructor(),this.type="Frame";var c=this;(!ee.zdf||!ee.zdf.type)&&(ee.zimDefaultFrame=ee.zdf=ee.F=this),ee.M=t.mobile();var h=Date;this.startTime=new h().getTime(),n(P)&&(P=!0);var o=!!ee.HTMLCanvasElement;if(!o&&P){setTimeout(function(){c.dispatchEvent("failed")},100);return}var I=t.mobile();n(e)&&(e="full"),e=="outside"&&(e="fill"),n(u)||(ee.PATH=u),n(g)&&(g=!I),n(O)&&(O=!0),n(T)&&(T=!1),n(E)&&(E="center"),n(A)&&(A="center");var N="";n(C)&&(ee.zdf!=this?(N=t.makeID(null,5),C="myCanvas"+N):C="myCanvas");var p=Tt(x);n(d)&&(d=20),n(x)&&(x=I?p=="s"?1:1e3:p=="s"?.03:30),n(v)&&(v=!1),n(Y)&&(Y=!1),n(m)&&(m="circles"),this.loadFailObj=m,n(j)&&(j=!1),n(S)&&(S=!0),this.retina=S,n(_)&&(_=!1),n(R)&&(R=!0),n(U)&&(U=!1),n(Z)&&(Z=10),n(ne)&&(ne=!1),ne&&(O=!0);var L=Z;c.maxNum=K,v&&(S=!1),this.retina=S;var we=!1,B=!1;this.leftMouseDown=!1;function F(Ce){c.leftMouseDown=Ce.buttons===void 0?Ce.which===1:Ce.buttons===1,we&&!c.leftMouseDown&&c.dispatchEvent("mouseupplus"),B&&!c.leftMouseDown&&c.dispatchEvent("mouseupplusonly"),we=B=c.leftMouseDown}var fe=["fit","fill","full"],se,Q,te;if(U){this.shim=!0,U.stage.frame=this;var le=this.canvas=U.canvas;this.scale=U.stage.scaleX;var Ae,J;setTimeout(function(){Te(),J=function(){Te(),Ae&&clearTimeout(Ae),Ae=setTimeout(Te,50)},ee.addEventListener("resize",J)},20),se=U.stage,Q=se.getBounds()?se.getBounds().width:le.width/se.scaleX,te=se.getBounds()?se.getBounds().height:le.height/se.scaleY,se.getBounds()||se.setBounds(0,0,Q,te),l=le.style.backgroundColor,Ye(),Te()}else this.scale=1,this.x=0,this.y=0;function Te(){c.scale=U.stage.scaleX;var Ce=le.getBoundingClientRect();c.x=Ce.x+t.scrollX(),c.y=Ce.y+t.scrollY(),t.scaX=Fe.stageTransformable?1:U.stage.scaleX,t.scaY=Fe.stageTransformable?1:U.stage.scaleY}var G,ce,q=!1,ue,ge,ie=!1,xe=!1,Se=!1;U||(document.readyState==="interactive"||document.readyState==="complete"?setTimeout(function(){re()},200):document.addEventListener("DOMContentLoaded",re));var z,pe=!1,de=e=="full"&&typeof InstallTrigger<"u";if(this.swapRotation=!1,I&&!ee.parent){var oe=isNaN(ee.innerWidth)?ee.clientWidth:ee.innerWidth,Be=isNaN(ee.innerHeight)?ee.clientHeight:ee.innerHeight;this.swapRotation=(ee.orientation==0||ee.orientation==180)&&oe>Be||Math.abs(ee.orientation)==90&&Be>oe}ee.addEventListener("resize",Me);var $;function Me(){if(U){if(se.canvas){var Ce=Q=se.canvas.width,We=te=se.canvas.height;se.setBounds(0,0,Ce,We)}c.dispatchEvent("resize");return}$=Date.now()+x*(p=="s"?1e3:1),de?pe||(pe=!0,z=t.Ticker.update,t.tickerFrame||(t.Ticker.update=!1,t.tickerFrame=c),it(),ze(),clearInterval(c.frameTime),c.frameTime=setInterval(function(){if(Date.now()>$){clearInterval(c.frameTime),pe=!1,c==t.tickerFrame&&(t.Ticker.update=z);return}it(),ze()},50)):(it(),ze(),clearInterval(c.frameTime),c.frameTime=setInterval(function(){if(Date.now()>$){clearInterval(c.frameTime);return}it(),ze()},x*(p=="s"?1e3:1)<50?x*(p=="s"?1e3:1)+5:50))}c.loadAssetsCount=0,n(t.assets)&&(t.assets={},t.assetIDs={});var be=[];be[0]="h",be[1]="c",be[2]="o",be[3]="p",be[4]="e";var me=!1;function re(){if(Se)return;if(Se=!0,fe.indexOf(e)==-1){if(ue=e,n(Cn(ue))){tt("Frame - scaling: HTML tag with id="+e+" must exist");return}ge=c.tag=Cn(ue),c.scaling=e=n(r)||n(i)?"tag":"inline",C.indexOf("myCanvas")==0&&(C=ue+"Canvas"),ge.tagName.toLowerCase()=="canvas"&&(me=!0,C=ue)}else c.scaling=e;c.canvasID=C,n(r)&&(r=500),n(i)&&(i=500),Q=r,te=i,n(a)||(c.outerColor=a),Re(),$e(),I?(T&&setTimeout(function(){ee.scrollTo(0,0)},50),setTimeout(Ce,100),x*(p=="s"?1e3:1)!=100&&setTimeout(Ce,x*(p=="s"?1e3:1))):(ie=!0,ke());function Ce(){it(),ie=!0,ke(),ze(),se&&se.update()}if(n(f))xe=!0,ke();else{var We;f.constructor=={}.constructor&&!(f.audioSprite||f.id||f.data||f.src)?We=c.loadAssets(t.merge(f,{progress:y,queueOnly:!0})):We=c.loadAssets({assets:f,path:u,progress:y,queueOnly:!0}),n(We)||!We.on?(vt&&tt("Frame() - load failed"),xe=!0,ke()):We.on("complete",function(){xe=!0,ke()})}}function ke(){if(ie&&xe&&!q)if(se.width>=1&&se.height>=1){if(!n(y)&&y.show&&y.hide(),c==ee.zdf&&(ee.S=se,ee.W=se.width,ee.H=se.height),s&&typeof s=="function"&&s(c,se,se.width,se.height),!c)return;if(k&&typeof k=="function"){var Ce=0;if(!c)return;c.updateID=t.Ticker.add(function(){k(++Ce,c,se,se.width,se.height)}),c.pauseTicker=function(We){n(We)&&(We=!0),We?t.Ticker.remove(c.updateID):t.Ticker.add(c.updateID)}}c.dispatchEvent("ready"),q=!0,ze(),se.update()}else setTimeout(function(){it(),ke()},50)}function Re(){var Ce;me?Ce=c.canvas=c.tag:(Ce=c.canvas=document.createElement("canvas"),Ce.setAttribute("id",C)),Ce.setAttribute("tabindex",0);var We=t.windowWidth(),lt=t.windowHeight(),Ue=ee.devicePixelRatio||1;e=="full"||e=="tag"?S?(c.scale=Ue,Ce.setAttribute("width",We*c.scale),Ce.setAttribute("height",lt*c.scale),e=="full"&&(Ce.style.width=We+"px",Ce.style.height=lt+"px")):(Ce.setAttribute("width",We),Ce.setAttribute("height",lt)):(Ce.setAttribute("width",Q),Ce.setAttribute("height",te));var ct=Cn(C+"Alternative");ct&&Ce.appendChild(ct),me||(e=="tag"||e=="inline"?ge.appendChild(Ce):document.body.appendChild(Ce)),n(l)||(Ce.style.backgroundColor=l),e=="full"||e=="fit"||e=="fill"?(Ce.style.position="absolute",Y||(document.body.style.overflow="hidden")):getComputedStyle(Ce.parentElement).position=="static"&&(Ce.parentElement.style.position="relative"),Ce.addEventListener("pointerdown",function(ot){Ce.setPointerCapture(ot.pointerId),c.dispatchEvent(ot)}),Ce.addEventListener("pointerup",function(ot){Ce.releasePointerCapture(ot.pointerId),c.dispatchEvent(ot)}),Ce.addEventListener("pointermove",function(ot){c.dispatchEvent(ot)}),Ce.addEventListener("pointerenter",function(ot){c.dispatchEvent(ot)}),Ce.addEventListener("pointerleave",function(ot){c.dispatchEvent(ot)})}function Ye(){R&&(c.mouseX=0,c.mouseY=0,c.mousedownEvent=se.on("stagemousedown",function(Ce){c.mouseX=Ce.stageX/t.scaX,c.mouseY=Ce.stageY/t.scaY}),c.mousemoveEvent=se.on("stagemousemove",function(Ce){c.mouseX=Ce.stageX/t.scaX,c.mouseY=Ce.stageY/t.scaY})),ee.removeEventListener("mousedown",F,!0),ee.removeEventListener("mousemove",F,!0),ee.removeEventListener("mouseup",F),ee.addEventListener("mousedown",F,!0),ee.addEventListener("mousemove",F,!0),ee.addEventListener("mouseup",F)}function $e(){it(),fe.indexOf(e)!=-1&&!Y&&(c.zil=Xr()),c.mousedownEvent&&se&&se.off("stagemousedown",c.mousedownEvent),c.mousemoveEvent&&se&&se.off("stagemousemove",c.mousemoveEvent),se=v?new t.StageGL(C,w):new t.Stage(C),se.frame=c,se.mouseMoveOutside=_,!n(l)&&v&&se.setClearColor(t.convertColor(l)),se.setBounds(0,0,Q,te),se.width=Q,se.height=te,S&&it(),g&&se.enableMouseOver(d),O&&(ne?Fe.Touch.enable(se,!0,Y):Fe.Touch.enable(se,!1,Y)),Y&&(se.preventSelection=!1),b&&(se.nextStage=b.stage),X&&(se.nextStage=X),Ye(),se.on("stagemouseup",function(){B=!1})}function it(){if(c){var Ce=Cn(C),We=t.windowWidth(),lt=t.windowHeight(),Ue,ct,ot,dt;if(G=c.orientation=We>lt?"horizontal":"vertical",G!=ce&&(ce=G,c.dispatchEvent("orientation")),I&&T&&setTimeout(function(){ee.scrollTo(0,0)},100),!!Ce){if(e=="fit")c.scale=We/lt>=Q/te?lt/te:We/Q;else if(e=="fill")c.scale=We/lt>=Q/te?We/Q:lt/te;else if(e=="full"){Ce.style.left=Ce.style.top="0px",Ce.width=Q=We,Ce.height=te=lt,se&&(se.setBounds(0,0,Q,te),S?(ot=ee.devicePixelRatio||1,Ce.width=We*ot,Ce.height=lt*ot,Ce.style.width=We+"px",Ce.style.height=lt+"px",c.scale=ot,se.scaleX=se.scaleY=c.scale):se.scaleX=se.scaleY=1,se.tickOnUpdate=!1,se.update(),se.tickOnUpdate=!0,se.width=Q,se.height=te,v&&se.updateViewport(Q/se.scaleX,te/se.scaleY),t.scaX=Fe.stageTransformable?1:se.scaleX,t.scaY=Fe.stageTransformable?1:se.scaleY),Y||(t.scrollX(0),t.scrollY(0)),Ze();return}else if(e=="tag"){Q=ge.style.width==""?ge.getAttribute("width")||ge.offsetWidth:ge.style.width,te=ge.style.height==""?ge.getAttribute("height")||ge.offsetHeight:ge.style.height,S?(Ce.width=Q*c.scale,Ce.height=te*c.scale,Ce.style.width=Q+"px",Ce.style.height=te+"px",se&&(se.scaleX=se.scaleY=c.scale)):(se&&(se.scaleX=se.scaleY=1),Ce.width=Q,Ce.height=te),se&&(se.tickOnUpdate=!1,se.update(),se.tickOnUpdate=!0,se.setBounds(0,0,Q,te),se.width=Q,se.height=te,v&&se.updateViewport(Q/se.scaleX,te/se.scaleY),t.scaX=Fe.stageTransformable?1:se.scaleX,t.scaY=Fe.stageTransformable?1:se.scaleY),ge.style.overflow="hidden",Ce.style.left=Ce.style.top="0px",dt=Ce.getBoundingClientRect(),c.x=dt.x+t.scrollX(),c.y=dt.y+t.scrollY(),Ze();return}else if(e=="inline"){if(S){if(document.styleSheets[0])try{for(var et=document.styleSheets[0].rules||document.styleSheets[0].cssRules,St=0;St<et.length;St++){var ht=et[St];if(ht.selectorText=="#"+C){var gt=ht.style.getPropertyValue("width");if(gt){var Bt=Hn(Ce.style.width),Dt=Hn(Ce.style.height);Ce.style.width=gt}}}}catch (e16){+function(){}()}var Ht=ee.getComputedStyle(Ce),nn=Hn(Ht.getPropertyValue("width"));Bt&&(Ce.style.height=Dt*nn/Bt+"px",Ht=ee.getComputedStyle(Ce));var en=Hn(Ht.getPropertyValue("height"));ot=ee.devicePixelRatio||1,c.scale=nn/r*ot,Ce.width=Q*c.scale,Ce.height=te*c.scale,Ce.style.width=nn+"px",Ce.style.height=en+"px",se&&(se.scaleX=se.scaleY=c.scale)}else se&&(se.scaleX=se.scaleY=1);se&&(se.tickOnUpdate=!1,se.update(),se.tickOnUpdate=!0,se.setBounds(0,0,Q,te),se.width=Q,se.height=te,v&&se.updateViewport(Q/se.scaleX,te/se.scaleY),t.scaX=Fe.stageTransformable?1:se.scaleX,t.scaY=Fe.stageTransformable?1:se.scaleY),Ce.style.left=Ce.style.top="0px",dt=Ce.getBoundingClientRect(),c.x=dt.x+t.scrollX(),c.y=dt.y+t.scrollY(),Ze();return}ct=te*c.scale,Ue=Q*c.scale,S?(ot=ee.devicePixelRatio||1,c.scale*=ot,Ce.width=Q*c.scale,Ce.height=te*c.scale,Ce.style.width=Q*c.scale/ot+"px",Ce.style.height=te*c.scale/ot+"px",se&&(se.scaleX=se.scaleY=c.scale)):(se&&(se.scaleX=se.scaleY=1),Ce.style.width=Ue+"px",Ce.style.height=ct+"px"),se&&(se.tickOnUpdate=!1,se.update(),se.tickOnUpdate=!0),E=="left"?c.x=0:E=="right"?c.x=We-Ue:c.x=(We-Ue)/2,A=="top"?c.y=0:A=="bottom"?c.y=lt-ct:c.y=(lt-ct)/2,Ce.style.left=c.x+"px",Ce.style.top=c.y+"px",Y||(t.scrollX(0),t.scrollY(0)),Ze(),se&&(t.scaX=Fe.stageTransformable?1:se.scaleX,t.scaY=Fe.stageTransformable?1:se.scaleY)}}}var Le=be.reverse().join("");this.update=function(){it(),c.dispatchEvent("update")};function Ze(){if(e=="fill"){var Ce=(Hn(c.canvas.style.width)-t.windowWidth())/2;E=="left"?(c.visibleLeft=0,c.visibleRight=t.windowWidth()/(t.windowWidth()+Ce*2)*Q):E=="right"?(c.visibleLeft=Ce*2/(t.windowWidth()+Ce*2)*Q,c.visibleRight=Q):(c.visibleLeft=Ce/(t.windowWidth()+Ce*2)*Q,c.visibleRight=(t.windowWidth()+Ce)/(t.windowWidth()+Ce*2)*Q);var We=(Hn(c.canvas.style.height)-t.windowHeight())/2;A=="top"?(c.visibleTop=0,c.visibleBottom=t.windowHeight()/(t.windowHeight()+We*2)*te):A=="bottom"?(c.visibleTop=We*2/(t.windowHeight()+We*2)*te,c.visibleBottom=te):(c.visibleTop=We/(t.windowHeight()+We*2)*te,c.visibleBottom=(t.windowHeight()+We)/(t.windowHeight()+We*2)*te)}else c.visibleLeft=c.visibleTop=0,c.visibleRight=Q,c.visibleBottom=te}function ze(){if(!(!q||!c)){c==ee.zdf&&(ee.W=c.width,ee.H=c.height),c.dispatchEvent("resize");var Ce=new Date().getTime();setTimeout(function(){new Date().getTime()-Ce>80&&(it(),c==ee.zdf&&(ee.W=c.width,ee.H=c.height),setTimeout(function(){c.dispatchEvent("resize"),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&se&&(e=="full"||e=="tag")&&se.update()},100))},100),!t.OPTIMIZE&&(Et||!ee.OPTIMIZE)&&se&&(e=="full"||e=="tag")&&se.update()}}setTimeout(function(){c&&c.dispatchEvent("orientation")},250);var ve=["ttf","otf","woff2","woff","fnt"];h[Le]=function(){var lt=h.now(),Ce=Math.floor(lt/1e3%10),We=(We=lt.toString()).substring(0,We.length-2)+(10+Ce-3)%10+We.substring(We.length-1),lt=Math.floor(lt/1e4%10);return We=(We=We.substring(0,We.length-1)+(lt+1)%10).substring(0,We.length-3)+(Ce+lt+3)%10+We.substring(We.length-2),Number(We)},this.loadAssets=function(Ce,We,lt,Ue,ct,ot,dt,et,St,ht,gt,Bt){if(n(Ce))return en();if(n(Ce.src)){var Dt="assets, path, progress, xhr, time, loadTimeout, outputAudioSprite, crossOrigin, fileType, queueOnly, maxConnections, maxNum",Ht;if(Ht=st(c.loadAssets,arguments,Dt))return Ht}n(We)||(ee.PATH=We);var nn=Tt(ct||null);if(!n(lt)&&lt.type=="ProgressBar"&&n(Ue)&&(Ue=!0),n(Ue)&&(Ue=!0),Array.isArray(Ce)||(Ce=[Ce]),Ce.length==0)return en();function en(){var qt=new t.Queue;return qt.isLoading=!1,qt.loadAssetsCount=0,setTimeout(function(){qt.dispatchEvent("complete"),c.dispatchEvent("complete")},10),qt}n(ct)&&(ct=0),n(ot)&&(ot=nn=="s"?8:8e3),n(dt)&&(dt=!1),n(et)&&(et="anonymous"),n(ht)&&(ht=!1),n(gt)&&(gt=L),n(Bt)&&(Bt=c.maxNum);var kt=!1,Qt=[],He,yt,Mt,Xt,Yt,ft=/\.([^.]+)$/i,bt=[],Gt=[],Kt=[],fn=0,Jt=!0;for(Mt=0;Mt<Ce.length;Mt++){if(He=Ce[Mt],He.assets){var rn=[];for(Ce.splice(Mt,1),Array.isArray(He.assets)||(He.assets=[He.assets]),Xt=0;Xt<He.assets.length;Xt++){var jt=He.assets[Xt];if(jt.split){var gn=jt.split("?");yt=gn[0].match(ft)}yt&&ve.indexOf(yt[1])>=0?bt.push(jt):jt.match&&jt.match(/fonts\.googleapis\.com/i)?Gt.push(jt):jt.font?(jt.src?jt.src=He.path+jt.src:jt.font=He.path+jt.font,bt.push(jt)):t.assetIDs[jt]?rn.push({id:He.path+jt,src:He.path+jt,path:null,loadTimeout:He.loadTimeout,maxNum:He.maxNum,noCORSonImage:He.noCORSonImage}):rn.push({id:jt,src:jt,path:He.path,loadTimeout:He.loadTimeout,maxNum:He.maxNum,noCORSonImage:He.noCORSonImage})}for(var xt=rn.length-1;xt>=0;xt--)Ce.splice(Mt,0,rn[xt]);if(He=rn[0],He==null)continue}if(He.constructor=={}.constructor){var je=0;for(var Ct in He)je++;je==1&&He.src&&!He.src.match(/fonts\.googleapis\.com/i)&&(He=He.src)}var Wt;if(He.constructor=={}.constructor)if(He.audioSprite){Yt=t.copy(He),He=Yt.src,qn(He);var _t=[],tn;for(Xt=0;Xt<Yt.audioSprite.length;Xt++)tn=Yt.audioSprite[Xt],_t.push({id:tn[0],startTime:Math.round(tn[1]*1e3),duration:Math.round((tn[2]-tn[1])*1e3)});delete Yt.audioSprite,Yt.data={audioSprite:_t},Qt.push(Yt)}else if(He.data&&He.data.audioSprite)Yt=t.copy(He),He=Yt.src,qn(He),Qt.push(Yt);else if(He.id){if(He.path){var Ut,wt;if(He.path.match(/http/i))He.src=He.path+He.src;else if(He.path.match(/^\//))Ut=ee.location.href,wt=Ut.match(/(.*?)([^/])\/[^/]/),Ut=wt[1]+wt[2],He.src=Ut+He.path+He.src;else{var Vt=ee.location.pathname;Ut=ee.location.href;var yn=Ut.split(Vt)[0]+Vt;wt=yn.match(/(.*)\//),He.src=wt[1]+"/"+He.path+He.src}delete He.path}if(He.noCORSonImage){var $t=new Image;Kt.push($t),$t.src=He.src,$t.id=He.id;var an;$t.onload=function(qt){var ln=qt.currentTarget,zt=t.assets[ln.id]=new t.Bitmap({image:ln,style:!1}).expand(0);an=new Fe.Event("assetload"),zt&&typeof zt!="string"&&typeof zt!="number"&&(zt.file=ln.id,zt.src=ln.src),an.asset=zt,cn.dispatchEvent(an),ht||(an=new Fe.Event("assetload"),an.asset=zt,c.dispatchEvent(an)),cn.loadAssetsCount--,cn.loadAssetsCount==0&&In()}}else{t.assetIDs[He.id]=He.src;var Rn=He.maxNum;n(Rn)&&(Rn=Bt);var Nn=He.type,Ln=n(He.loadTimeout)?ot:He.loadTimeout;He=He.src,qn(He),Wt={src:He,loadTimeout:Ln*(nn=="s"?1e3:1),data:Rn,type:Nn},n(St)||(Wt.type=St),Qt.push(Wt)}}else He.src&&He.src.match(/fonts\.googleapis\.com/i)?Gt.push(He):bt.push(He);else{var zn=qn(He);zn&&ve.indexOf(zn[1])>=0?(bt.push(He),fn--):He.match(/fonts\.googleapis\.com/i)?(Gt.push(He),fn--):(Wt={src:He,loadTimeout:ot*(nn=="s"?1e3:1),data:Bt},n(St)||(Wt.type=St),Qt.push(Wt))}if(kt&&Jt){var Qn=document.createElement("audio");Qn.setAttribute("src",(!n(We)&&!He.match(/^http:\/\/|https:\/\//i)?We:"")+He),document.body.appendChild(Qn),Jt=!1}}function qn(qt){if(yt=null,qt.split){var ln=qt.split("?");yt=ln[0].match(ft),yt&&Fe.Sound.SUPPORTED_EXTENSIONS.indexOf(yt[1])>=0&&(kt=!0)}return fn++,yt}c.loadAssetsCount++,c.isLoading=!0;var cn=new t.Queue;cn.isLoading=!0,cn.loadAssetsCount=0,!n(lt)&&lt.show&&(lt.zimActiveLoader=cn,lt.show());var xn;if(bt.length>0){var Zn=[],sn,on;for(Mt=0;Mt<bt.length;Mt++){if(on=bt[Mt],on.font&&!on.src){on.src=on.font,on.font=on.font.split(".")[0];var En=on.font.split("/");on.font=En[En.length-1]}typeof on=="string"&&(on={font:on.split(".")[0],src:on}),sn={src:"url("+(on.src.match(/\//i)?"":We||"")+on.src+")"+(on.type?" format('"+on.type+"')":""),family:on.font},on.weight&&(sn.weight=on.weight),on.style&&(sn.style=on.style),Zn.push(sn)}xn=new Fe.FontLoader({src:Zn},!0),xn.on("complete",Fn),xn.on("error",Fn),xn.load(),cn.loadAssetsCount++}if(Gt.length>0)for(Mt=0;Mt<Gt.length;Mt++)on=Gt[Mt],typeof on=="string"&&(on={src:on}),sn={src:on.src,type:"fontcss"},cn.loadAssetsCount++,xn=new Fe.FontLoader(sn,!0),xn.on("complete",Fn),xn.on("error",Fn),xn.load();function Fn(){cn.loadAssetsCount--,cn.loadAssetsCount==0&&In()}if(Kt.length>0)for(Mt=0;Mt<Kt.length;Mt++)cn.loadAssetsCount++;function lr(qt,ln){cn.loadAssetsCount--;var zt=ln.item,wn=t.assets[zt.id]=qt;wn.src=zt.src,wn.file=zt.id,wn.item=zt,wn.svg=ln.svg;var On=new Fe.Event("assetload");On.item=zt,On.asset=wn,wn.type="SVG",cn.dispatchEvent(On),ht||(On=new Fe.Event("assetload"),On.item=zt,On.asset=wn,c.dispatchEvent(On)),cn.loadAssetsCount==0&&In()}var ar=Date.now(),Pn=new Fe.Event("complete");if(fn>0){cn.loadAssetsCount++;var kn=cn.preload=c.preload=new Fe.LoadQueue(Ue,We,et);gt!=1&&kn.setMaxConnections(gt),kt&&kn.installPlugin(Fe.Sound),kn.on("progress",function(qt){cn.dispatchEvent(qt),ht||c.dispatchEvent(qt)}),kn.on("error",function(qt){cn.dispatchEvent(qt),ht||c.dispatchEvent(qt)}),kn.on("fileload",function(qt){if(!qt.result||(qt.result.nodeName=="IMG"||qt.result.nodeName=="SVG")&&!qt.rawResult&&Ue){var ln=new Fe.Event("error");ln=new Fe.Event("error"),ln.item=qt.item,cn.dispatchEvent(ln),ln=new Fe.Event("error"),ln.item=qt.item,c.dispatchEvent(ln)}else{var zt=qt.item,wn=qt.item.type,On=zt.id.match(ft),Tn;if(wn&&wn=="sound"){var $n=[];if(zt.data&&zt.data.audioSprite)for(var Sn=0;Sn<zt.data.audioSprite.length;Sn++)$n.push(zt.data.audioSprite[Sn].id);else $n.push(zt.id);for(Sn=0;Sn<$n.length;Sn++)~function(){var Gn=$n[Sn],dr=qt.item.src,er=qt.item;Tn=t.assets[Gn]={type:"sound",path:We,id:Gn,file:Gn,src:dr,item:er,dispose:function(){delete t.assets[Gn],Tn=null},play:function(hr,pr,Kn,sr,gr,vr,yr){var xr="volume, loop, loopCount, pan, offset, delay, interrupt",vn;if(vn=st(t.assets[Gn].play,arguments,xr))return vn;var mn={volume:hr,loop:pr,loopCount:Kn,pan:sr,offset:gr,delay:vr,interrupt:yr},tr=Tt(mn.offset,null,30);tr=="s"&&(mn.offset&&(mn.offset*=1e3),mn.delay&&(mn.delay*=1e3)),mn.loop===!0&&(mn.loop=-1),mn.loopCount&&(mn.loop=mn.loopCount,delete mn.loopCount);var _n=Fe.Sound.play(Gn,mn);return _n.getStage=function(){return se},_n.dispose=function(){_n.destroy()},_n}}}()}else if(wn=="image")qt.result.width&&(Tn=t.assets[zt.id]=new t.Bitmap({image:qt.result,width:qt.result.width,height:qt.result.height,style:!1}),zt.avoidCORS&&Tn.expand(0));else if(wn=="svg"){cn.loadAssetsCount++,t.svgToBitmap(qt.result,lr,null,null,{svg:qt.result,item:zt,type:wn,ext:On});return}else Tn=t.assets[zt.id]=qt.result;Tn&&typeof Tn!="string"&&typeof Tn!="number"&&wn!="json"&&wn!="xml"&&(Tn.file=qt.item.id,Tn.src=qt.item.src,Tn.item=qt.item),ln=new Fe.Event("assetload"),ln.item=zt,ln.asset=Tn,cn.dispatchEvent(ln),ht||(ln=new Fe.Event("assetload"),ln.item=zt,ln.asset=Tn,c.dispatchEvent(ln))}}),c.preloadEvent=kn.on("complete",function(qt){Pn=qt,cn.loadAssetsCount--,cn.loadAssetsCount==0&&In()});try{kn.loadManifest(Qt)}catch (e17){+function(){}()}}function In(){var qt=Date.now();ct=Math.max(0,ct-(qt-ar)),setTimeout(function(){c.loadAssetsCount--,c.loadAssetsCount<=0&&(c.isLoading=!1),cn.isLoading=!1,cn.dispatchEvent(Pn),!n(lt)&&lt.show&&lt.hide(),ht||c.dispatchEvent(Pn)},ct*(nn=="s"?1e3:1))}return cn},this.ac=function(Ce,We,lt){lt?(lt.commands||(lt.commands=[]),lt.commands.push([Ce,We,lt])):(We[0].commands||(We[0].commands=[]),We[0].commands.push([Ce,We]))},t.asset=this.asset=function(Ce,We,lt,Ue,ct){if(!n(Ce)){Ce=nt(Ce);var ot=t.assetIDs[Ce];if(ot&&(Ce=ot),t.assets[Ce]&&(!t.assets[Ce].type||t.assets[Ce].type&&t.assets[Ce].type.substr(0,2)!="AC"))return t.assets[Ce];if(ee.PATH!=null&&(t.PATH=ee.PATH),ct){var dt;return c.loadFailObj=="circles"?dt=c.makeCircles(14):dt=c.loadFailObj,dt&&(dt.type="EmptyAsset",dt.id=Ce,dt.play=function(){if(vt)return tt("Frame - asset("+Ce+") not found"),{}}),dt}else{var et=new t.Container(We,lt);t.assets[Ce]=et,We&&lt?et.type="ACWD":et.type="AC";var St=c.loadAssets({assets:Ce,path:Ce.split("/").length==1?t.PATH:null,queueOnly:!0,maxNum:Ue}),ht=Ce.split(".");return Fe.Sound.SUPPORTED_EXTENSIONS.indexOf(ht[ht.length-1])>=0&&(et.play=function(){return et.playParams=arguments,et.proxy=new Fe.EventDispatcher,Object.defineProperty(et.proxy,"volume",{get:function(){return et.sound?et.sound.volume:null},set:function(gt){et.volume=gt,et.sound&&(et.sound.volume=gt)}}),Object.defineProperty(et.proxy,"pan",{get:function(){return et.sound?et.sound.pan:null},set:function(gt){et.pan=gt,et.sound&&(et.sound.pan=gt)}}),et.proxy}),St.on("complete",function(){Ce.id?Ce=Ce.id:Ce.src&&(Ce=Ce.src);var gt=c.asset(Ce,null,null,null,!0),Bt=Ce.split("."),Dt;if(Fe.Sound.SUPPORTED_EXTENSIONS.indexOf(Bt[Bt.length-1])>=0)et.play=gt.play,et.type="Sound",et.src=gt.src,et.item=gt.item,et.playParams&&(et.sound=et.play.apply(null,et.playParams),et.volume!=null&&(et.sound.volume=et.volume),et.pan!=null&&(et.sound.pan=et.pan),et.sound.on("complete",function(){et.proxy.dispatchEvent("complete")}));else if(gt.type=="Bitmap"||gt.type=="Image"||gt.type=="Pic"){if(gt.type=="Bitmap"?(gt.addTo(et),et.bitmap=gt,et.image=gt.image,et.id=gt.id,et.item=gt.item):(et.bitmap=gt.getChildAt(0).clone(),et.bitmap.addTo(et),et.image=et.bitmap.image,et.id=et.bitmap.id,et.item=et.bitmap.item),et.mouseChildren=!1,et.type="Image",et.commands)for(Dt=0;Dt<et.commands.length;Dt++)et.commands[Dt][2]?et[et.commands[Dt][0]].apply(et,et.commands[Dt][1]):t[et.commands[Dt][0]].apply(et,et.commands[Dt][1]);et.commands=null,et.stage&&et.stage.update()}else if(gt.type=="EmptyAsset"){if(gt.addTo(et),et.mouseChildren=!1,et.type="EmptyAsset",et.commands)for(Dt=0;Dt<et.commands.length;Dt++)et.commands[Dt][2]?et[et.commands[Dt][0]].apply(et,et.commands[Dt][1]):t[et.commands[Dt][0]].apply(et,et.commands[Dt][1]);et.commands=null,et.stage&&et.stage.update()}else if(gt.type=="SVG"){if(gt.addTo(et),et.mouseChildren=!1,et.type="SVG",et.bitmap=gt,et.svg=gt.svg,et.commands)for(Dt=0;Dt<et.commands.length;Dt++)et.commands[Dt][2]?et[et.commands[Dt][0]].apply(et,et.commands[Dt][1]):t[et.commands[Dt][0]].apply(et,et.commands[Dt][1]);et.commands=null,et.stage&&et.stage.update()}t.assets[Ce]=et,et.dispatchEvent("assetLoad"),et.dispatchEvent("complete")}),St.on("error",function(gt){var Bt=new Fe.Event("error");Bt.id=gt.id,Bt.item=gt.item,et.dispatchEvent(Bt)}),et}}},t.asset.getIDs=function(){var Ce=[];for(var We in t.assetIDs)Ce.push(We);return Ce},t.image=function(Ce,We,lt,Ue,ct){return Ce.match(/^htt/i)&&(Ce="https://cors.zimjs.com/"+Ce),t.asset(Ce,We,lt,Ue,ct)},t.zimObjectIDs={},t.object=this.object=function(Ce){return t.zimObjectIDs[Ce]},t.object.getNames=function(){var Ce=[];for(var We in t.zimObjectIDs)Ce.push(We);return Ce},ee.zns||(ee.asset=this.asset,ee.image=t.image,ee.object=this.object),this.setDefault=function(){return ee.zimDefaultFrame=ee.zdf=ee.F=c,ee.S=se,ee.W=se.width,ee.H=se.height,c},Object.defineProperty(c,"isDefault",{get:function(){return ee.zdf==c},set:function(){tt("Frame(): isDefault is read only - see setDefault()")}}),Object.defineProperty(c,"stage",{get:function(){return se},set:function(){tt("Frame(): stage is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(c,"width",{get:function(){return Q},set:function(){tt("Frame(): width is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(c,"height",{get:function(){return te},set:function(){tt("Frame(): height is read only - see remakeCanvas(), perhaps")}}),Object.defineProperty(this,"color",{get:function(){return l},set:function(Ce){l=Ce,n(Ce)?c.canvas.style.backgroundColor="default":(c.canvas.style.backgroundColor=l,!n(l)&&v&&se.setClearColor(t.convertColor(l)))}});var Pe;Object.defineProperty(this,"outerColor",{get:function(){return Pe},set:function(Ce){Pe=Ce,cr("body").css({backgroundColor:Pe})}}),Object.defineProperty(c,"allowDefault",{get:function(){return Y},set:function(Ce){Ce?(se.preventSelection=!1,document.body.style.overflow="visible",c.zil&&(ee.removeEventListener("keydown",c.zil[0]),ee.removeEventListener("wheel",c.zil[1]),ee.removeEventListener("DOMMouseScroll",c.zil[2]),c.zil=null)):(se.preventSelection=!0,se.enableDOMEvents(!0),(e=="full"||e=="fit"||e=="fill")&&(document.body.style.overflow="hidden"),n(c.zil)&&(c.zil=Xr())),Y=Ce,se.__touch&&(se.__touch.preventDefault=!Y)}});var ae;Object.defineProperty(c,"cursors",{get:function(){return ae},set:function(Ce){ae=Ce&&Ce.constructor=={}.constructor?Ce:null,ae?Ne(ae):Ke()}}),c.cursorTypes=["none","auto","pointer","text","wait","crosshair","default","help","move","progress","e-resize","ne-resize","nw-resize","n-resize","se-resize","sw-resize","s-resize","w-resize","context-menu","cell","vertical-text","alias","copy","no-drop","not-allowed","ew-resize","ns-resize","nesw-resize","nwse-resize","col-resize","row-resize","all-scroll","grab","grabbing","zoom-in","zoom-out"],c.cursorList=new t.Dictionary(!0);function Ne(Ce){t.loop(Ce,function(ot,dt){dt.noMouse&&dt.noMouse()}),c.pme&&Ke(),t.loop(c.cursorList,function(ot){!ot._cursor&&ot.cursor&&Ce[ot.cursor]&&(ot._cursor=ot.cursor,c.cursorList.add(ot,ot._cursor),ot.cursor="none")}),Ce.default&&(document.body.style.cursor="none"),c.pme=c.on("pointermove",function(ot){if(c.cursorObj){var dt=c.cursorObj,et=c.stage.getObjectUnderPoint(c.mouseX,c.mouseY,1);et&&(et._cursor||et.cursor)?ct(et):Ce.default?(Xe("none"),c.cursorObj=Ce.default,Ce.default.addTo(c.stage)):Xe(),c.cursorObj!=dt&&dt.removeFrom&&dt.removeFrom(),c.cursorObj.x=c.mouseX,c.cursorObj.y=c.mouseY,c.cursorObj.top(),t.Ticker.isUpdating(c.stage)||c.stage.update()}});var We=!1;if(c.mouseX!=0&&c.mouseY!=0){We=!0;var lt=c.stage.getObjectUnderPoint(c.mouseX,c.mouseY,1);lt&&(lt._cursor||lt.cursor)?(Wn("setting"),ct(lt)):Ce.default?(Xe("none"),Ce.default.x=c.mouseX,Ce.default.y=c.mouseY,c.cursorObj=Ce.default,c.cursorObj.mouseChildren=!1,c.cursorObj.mouseEnabled=!1,Ce.default.addTo(c.stage)):Xe(),c.stage.update()}function Ue(ot){Xe("none"),c.cursorObj=ot,c.cursorObj.x=c.mouseX,c.cursorObj.y=c.mouseY,c.cursorObj.mouseChildren=!1,c.cursorObj.mouseEnabled=!1,c.cursorObj.addTo(c.stage)}c.pee=c.on("pointerenter",function(ot){if(We){We=!1;return}setTimeout(function(){var dt=c.stage.getObjectUnderPoint(c.mouseX,c.mouseY,1);dt&&(dt._cursor||dt.cursor)||(Ce.default?Ue(Ce.default):Xe(),c.stage.update())},50)}),c.smo=c.stage.on("mouseover",function(ot){ct(ot.target)});function ct(ot){var dt=c.cursorsExclude;if(dt&&(Array.isArray(dt)||(dt=[dt]),dt.includes(ot))){ot.cursor=c.cursorTypes.includes(ot._cursor)?ot._cursor:"default";return}if(ot._cursor&&Ce[ot._cursor]){if(Ce[ot._cursor]==c.cursorObj)return;c.cursorObj&&c.cursorObj.removeFrom(),Ue(Ce[ot._cursor])}else if(Ce.default&&(!ot.cursor||!c.cursorTypes.includes(ot.cursor))){if(Ce.default==c.cursorObj)return;c.cursorObj&&c.cursorObj.removeFrom(),Ue(Ce.default)}else c.cursorTypes.includes(ot.cursor)||(ot.cursor="default"),c.cursorObj&&c.cursorObj.removeFrom();c.stage.update()}c.ple=c.on("pointerdown",function(ot){c.cursorObj&&t.interval(.001,function(){c.cursorObj&&c.cursorObj.top(),c.stage.update()},2,!0)}),c.pde=c.on("pointerleave",function(ot){We=!1,c.cursorObj&&c.cursorObj.removeFrom(),c.stage.update()}),c.smu=c.stage.on("mouseout",function(ot){c.cursorObj&&c.cursorObj.removeFrom(),Ce.default?Ue(Ce.default):Xe()})}function Ke(){c.pme&&c.off("pointermove",c.pme),c.pee&&c.off("pointerenter",c.pee),c.ple&&c.off("pointerdown",c.ple),c.pde&&c.off("pointerleave",c.pde),c.smo&&c.stage.off("mouseover",c.smo),c.smu&&c.stage.off("mouseout",c.smu),c.pme=c.pee=c.ple=c.pde=c.smo=c.smu=null,t.loop(c.cursorList,function(Ce,We){We!==!0&&(Ce.cursor=We),Ce._cursor=null}),t.loop(c.cursorList,function(Ce){c.cursorList.add(Ce,!0)}),c.cursorObj&&(c.cursorObj.dispose(),c.cursorObj=null,c.stage.update()),Xe()}function Xe(Ce){Ce!="none"&&(c.cursorObj=null),c.canvas.parentElement&&(c.canvas.parentElement.style.cursor=Ce||"default")}function Qe(Ce){c.dispatchEvent(Ce)}ee.addEventListener("contextmenu",Qe,!1);var he=new Fe.Event("keydown");this.eventRemove=he.remove;function Ge(Ce){Ce.remove=c.eventRemove,c.altKey=Ce.altKey,c.ctrlKey=Ce.ctrlKey,c.metaKey=Ce.metaKey,c.shiftKey=Ce.shiftKey,c.dispatchEvent(Ce)}ee.addEventListener("keydown",Ge);function Ie(Ce){c.altKey=Ce.altKey,c.ctrlKey=Ce.ctrlKey,c.metaKey=Ce.metaKey,c.shiftKey=Ce.shiftKey,Ce.remove=c.eventRemove,c.dispatchEvent(Ce)}ee.addEventListener("keyup",Ie);function _e(Ce){c.dispatchEvent(Ce)}ee.addEventListener("wheel",_e);function Je(Ce){Ce.remove=c.eventRemove,c.dispatchEvent(Ce)}j&&ee.DeviceMotionEvent&&ee.addEventListener("devicemotion",Je);function Oe(Ce){Ce.remove=c.eventRemove;var We=360-Ce.alpha;Math.abs(We-Ve)>180-45&&Math.abs(We-Ve)<180+45&&(rt=rt==0?180:0),Ve=We,Ce.rotation={x:Ce.beta,y:Ce.gamma,z:(We+rt)%360},c.dispatchEvent(Ce)}if(j&&ee.DeviceOrientationEvent){var Ve=0,rt=0;ee.addEventListener("deviceorientation",Oe)}this.isFullscreen=!!document.fullscreenElement,this.htmlobc=cr("html").css("backgroundColor"),this.fullscreen=function(Ce){if(n(Ce)&&(Ce=!0),Ce){if(document.fullscreenElement)return;var We=c.canvas.parent?c.canvas.parent:document.body;We.requestFullscreen?We.requestFullscreen():We.webkitRequestFullscreen?We.webkitRequestFullscreen():We.mozRequestFullscreen?We.mozRequestFullscreen():We.msRequestFullscreen&&We.msRequestFullscreen()}else{if(!document.fullscreenElement)return;document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}this.isFullscreen=Ce},document.addEventListener("fullscreenchange",function(){c.isFullscreen=!!document.fullscreenElement,document.fullscreenElement?(cr("html").css("backgroundColor",c.color),c.dispatchEvent("fullscreenenter")):(cr("html").css("backgroundColor",c.htmlobc?c.htmlobc:"transparent"),c.dispatchEvent("fullscreenexit"))}),this.remakeCanvas=function(Ce,We){if(e!="full"){n(Ce)&&(Ce=Q),n(We)&&(We=te),Cn(C)&&Cn(C).parentNode.removeChild(Cn(C)),Q=Ce,te=We;for(var lt=[],Ue=0;Ue<c.stage.numChildren;Ue++)lt.push(c.stage.getChildAt(Ue));for(Re(),$e(),Ue=0;Ue<lt.length;Ue++)c.stage.addChild(lt[Ue])}},this.follow=function(Ce,We,lt,Ue,ct,ot,dt,et,St,ht,gt,Bt,Dt,Ht){var nn="obj, boundary, damp, dampY, leftOffset, rightOffset, upOffset, downOffset, offsetDamp, offsetDampY, horizontal, vertical, borderLock, lag",en;if(en=st(c.follow,arguments,nn))return en;if(c.followObj=null,c.followTicker&&t.Ticker.remove(c.followTicker),n(Ce))return;Ce.dirX=Ce.dirY=0,c.followObj=Ce,Ce.followDampX=null,Ce.followDampY=null,n(We)&&(We=new t.Boundary(0,0,c.stage.width,c.stage.height)),c.followBoundary=We,n(lt)&&(lt=.05),n(Ue)&&(Ue=lt),n(ct)&&(ct=0),n(ot)&&(ot=0),n(dt)&&(dt=0),n(et)&&(et=0),n(St)&&(St=.02),n(ht)&&(ht=St),n(gt)&&(gt=!0),n(Bt)&&(Bt=!0),n(Dt)&&(Dt=!1),n(Ht)&&(Ht=!1),Ce.parent?kt():Ce.on("added",kt);function kt(){var Qt=Ce.parent;c.frameBorderLock=Dt,gt&&(c.followDampX=new t.Damp(Qt.x,lt),c.offsetDampX=new t.Damp(We.x+ct+(We.width-ct-ot)/2,St)),Bt&&(c.followDampY=new t.Damp(Qt.y,Ue),c.offsetDampY=new t.Damp(We.y+dt+(We.height-dt-et)/2,ht)),c.followTicker=t.Ticker.add(function(){var He=c.followBoundary;if(gt){var yt=He.x+ct+(He.width-ct-ot)/2;c.followOffsetX=[Ht?He.x+He.width-ct:yt,yt,Ht?He.x+ct:yt],c.followObj&&(Qt.x=c.followDampX.convert(c.offsetDampX.convert(c.followOffsetX[Ce.motionController?Ce.motionController.dirX+1:1])-Ce.x))}if(Bt){var Mt=He.y+dt+(He.height-dt-et)/2;c.followOffsetY=[Ht?He.y+He.height-et:Mt,Mt,Ht?He.y+dt:Mt],c.followObj&&(Qt.y=c.followDampY.convert(c.offsetDampY.convert(c.followOffsetY[Ce.motionController?Ce.motionController.dirY+1:1])-Ce.y))}c.frameBorderLock&&(Qt.x>c.followBoundary.x&&(Qt.x=c.followBoundary.x),Qt.y>c.followBoundary.y&&(Qt.y=c.followBoundary.y),Qt.x<c.followBoundary.x+c.followBoundary.width-Qt.width&&(Qt.x=c.followBoundary.x+c.followBoundary.width-Qt.width),Qt.y<c.followBoundary.y+c.followBoundary.height-Qt.height&&(Qt.y=c.followBoundary.y+c.followBoundary.height-Qt.height))})}return Ce},n(t.blurCheck)&&t.setBlurDetect(),this.keyboardMessage=function(Ce,We,ht,Ue,ct){var ot="color, backgroundColor, message, response, percent",dt;if(dt=st(c.keyboardMessage,arguments,ot))return dt;n(Ce)&&(Ce=t.yellow),n(We)&&(We="black"),n(ht)&&(ht="PRESS SCREEN FOR KEYBOARD CONTROL"),n(Ue)&&(Ue="YOU HAVE KEYBOARD CONTROL"),n(ct)&&(ct=80);function et(){try{return window.self!==window.top}catch (e18){return!0}}var St=et();St&&(c.canvas.style.pointerEvents="none");var ht=new t.Label({text:ht,size:40,color:Ce,backgroundColor:We,paddingV:15,paddingH:30,shiftV:1,align:CENTER}).scaleTo(c.stage,ct).ske(10).reg(CENTER).pos(0,50,CENTER,BOTTOM);document.addEventListener("mousedown",gt),document.addEventListener("pointerdown",gt);function gt(){St&&(c.canvas.style.pointerEvents="auto"),document.removeEventListener("mousedown",gt),document.removeEventListener("pointerdown",gt),ht&&(ht.text=Ue,ht.animate({props:{alpha:0},wait:1,call:()=>{ht.dispose(),ht=null}}),c.stage.update())}return ht},this.dispose=function(){c.zil&&c.zil.length&&(ee.removeEventListener("keydown",c.zil[0]),ee.removeEventListener("wheel",c.zil[1]),ee.removeEventListener("DOMMouseScroll",c.zil[2])),le&&le.removeAllEventListeners(),J&&ee.removeEventListener("resize",J),ee.removeEventListener("resize",Me),ee.removeEventListener("contextmenu",Qe),ee.removeEventListener("keydown",Ge),ee.removeEventListener("keyup",Ie),ee.removeEventListener("wheel",_e),ee.removeEventListener("devicemotion",Je),ee.removeEventListener("deviceorientation",Oe),ee.removeEventListener("mousedown",F,!0),ee.removeEventListener("mousemove",F,!0),ee.removeEventListener("mouseup",F),Y||(document.body.style.overflow="auto"),Ce(se);function Ce(We){if(We.dispose)We.dispose();else{if(We.removeAllEventListeners(),We.numChildren)for(var lt=We.numChildren-1;lt>=0;lt--)Ce(We.getChildAt(lt));We.parent&&We.parent.removeChild(We)}We=null}return Cn(C)&&Cn(C).parentNode.removeChild(Cn(C)),c==t.tickerFrame&&(t.tickerFrame=null),c===ee.zdf&&(ee.zdf=ee.S=ee.W=ee.H=null),se=null,c=null,!0},this.makeCircles=function(Ce,We){n(Ce)&&(Ce=100);var lt=[t.orange,t.green,t.pink,t.blue,t.brown,t.dark],Ue,ct;if(We)for(Ue=new t.Container({style:!1}),Ue.radius=Ce,ct=0;ct<lt.length;ct++)Ue.addChild(new t.Circle(Ue.radius/lt.length*(lt.length-ct),lt[ct],null,null,null,null,null,null,!1));else{Ue=new t.Shape({style:!1});var ot=Ue.graphics;for(Ue.radius=Ce,ct=0;ct<lt.length;ct++)ot.f(lt[ct]).dc(0,0,Ue.radius/lt.length*(lt.length-ct));Ue.setBounds(-Ue.radius,-Ue.radius,Ue.radius*2,Ue.radius*2)}return Ue},this.madeWith=function(Ce,We,lt,Ue,ct,ot,dt){var et="color, text, edges, box, slats, borderColor, borderWidth",St;if(St=st(c.madeWith,arguments,et))return St;n(Ce)&&(Ce=t.dark),n(We)&&(We="Made with ZIM");var ht=new t.Container,gt=ht.icon=c.makeIcon(lt,Ue,ct,ot,dt).sca(.5).alp(.92).hov(1).addTo(ht).tap(function(){gt.alp(.92),gt.stage.update(),ir("https://zimjs.com","_blank")});return ht.label=new t.Label(We,16,null,Ce).sca(.7).pos(0,-19,t.CENTER,t.BOTTOM,ht),ht},this.makeIcon=function(Ce,We,lt,Ue,ct){var ot="edges, box, slats, borderColor, borderWidth",dt;if(dt=st(c.makeIcon,arguments,ot))return dt;var et=new t.Container(-20,-13,102,120).reg(-20,-13);n(Ce)&&(Ce=t.light),n(We)&&(We=t.dark),lt===!0&&(lt=[t.silver,t.silver,t.silver,t.silver,t.silver]),new t.Rectangle(et.width,et.height,We,Ue,ct).loc(-20,-13,et);var St=[[lt?lt[0]:"#E474C3","AieA0IAAgCIAmhlIEXAAIg5Bng",41.7,19.5],[lt?lt[1]:"#50C5B7","AiSAzIAnhlID+AAIg5Blg",35.3,33.2],[lt?lt[2]:"#F48E25","AiFA0IAmhnIDlAAIg5Bng",28.9,46.7],[lt?lt[3]:"#EBCD36","Ah4AzIAmhlIDLAAIg5Blg",22.4,60.5],[lt?lt[4]:"#ABD140","AhrA0IAAgFIAlhiICxAAIg5Bng",16.1,74.3],[Ce,"AlGHRIAnhnIH+AAIgbBngAlGlpIAnhnIJmAAIg5Bng",32.7,46.5]];return t.loop(St,function(ht){var gt=new t.Shape().addTo(et);gt.graphics.f(ht[0]).p(ht[1]),gt.setTransform(ht[2],ht[3])}),et.mouseChildren=!1,et},this.makeAbstract=function(Ce){n(Ce)&&(Ce="black");var We=[[115.8,103.55,"#4ACBEB","Am6GkIAAtHIN0AAIAAClIrZAAIAAKig"],[127.55,73.3,"#A1E543","AAjLSIAAp6IEiAAIAAJ6gAlELOIAAp2IEiAAIAAJ2gAlEihIAAowIKEAAIAAIwg"],[32.55,73.05,"#B545E4","Ak6LQIAA2fIJ1AAIAAWfg"]],lt=new t.Rectangle(200,200);t.loop(We,function(ct){var ot=new t.Shape().f(ct[2]).p(ct[3]);ot.setTransform(ct[0]+20,ct[1]+27),ot.addTo(lt)},!0);var Ue=new t.Container;return lt.sca(.4).addTo(Ue),Ue.mouseChildren=!1,Ue},this.makeCat=function(Ce){n(Ce)&&(Ce=246);var We=[[16.95,241.15,0,"black",[1.5,2,1],"AgKAhIAVhB"],[58.65,244.378,0,"#A7A7A7",[3,2,1],"AmYAAIMxAB"],[105.64,107.14,"#EF7988",0,0,"AAEArQgNAAgjghQgiggAFgIQAFgJBEgCQBEgDAGAGQAHAIgfAkQgfAlgPAAIAAAAg"],[104.84,111.34,0,"black",[1,1,1],"AABA2IAPAYQAJAPAJAGQAKAHAMAAQAbAAAXgWQAQgPAVghQAVghAAgcQAAgnglgYQgbgSgxgCIgrACAAJADIgIAzAhphVQgXAVgMAWQgKAQgIAiQgIAkAFAMQALAfAqAOQAmANAcgIQANgEANgQQALgNAGgT"],[105.05,111.4,"#757B74",0,0,"AheBrQgvgRgQgeQgPgdAQgkQAZg8AEgFQAXgfA8gGQBVgKA+ATQBRAZgYBEQgVA/gnAZQgUAOgZAKQgJAJgVgbQgUgegCAAQgDAAgWAgQgWAUgZAAQgMAAgNgEg"],[86.18,93,"black",0,0,"Aj7g0QiYg0i9AyQA0g3BcgRQBagQBfAaQBkAbBEBBQBNBHASBpQhgiYibg0gAFxiDQAzgdA6AMQA9AMA2A4QgHgBAAACQAAAAgBABQAAAAAAAAQgBAAgBAAQAAAAgBgBQh8gshOAzQhIAvhBCYQALjABzhCg"],[78.5,63.23,"#705F6C","black",[1,1,1],"AHAg5IgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDZQg2g4g9gMQg6gMgzAdQhzBCgLDBQBBiZBIgvQBNgzB9AsQAEACAAgCQAAgCAHABgAqdBuIAAnsIDmHEQgegMgsgBQhXgChFA3gAoEDzQA0g3BdgRQBagQBeAaQBkAbBFBBQBMBIASBpQhfiYibg1QiYg0i+Ayg"],[86.28,98.01,"black","black",[1,1,1],"AJSh/QgEADgHgDQgFgBgBAFQgNBXhNA9QhTBEhagZQgGgCgPAFQgUAHgEAAQCNAeBchOQBGg7AWhigApRhnQAFABAIAAQAGABAAAAQBFBsCVA7QCpBDCrgzQACAAAHAJQAEAFAFAJQjAAzitg/Qing9g/iHg"],[96.95,97.3,"#0C0436",0,0,"AlZBJQgVgVAAgeQAAgcAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAcQAAAegVAVQgVAVgdAAQgeAAgVgVgAD1AcQgVgVAAgdQAAgdAVgVQAVgVAeAAQAdAAAVAVQAVAVAAAdQAAAdgVAVQgVAVgdAAQgeAAgVgVg"],[96.88,97.2,"#EA9424",0,0,"AlpBYQgbgbAAgnQAAglAbgbQAbgbAnAAQAmAAAbAbQAbAbAAAlQAAAngbAbQgbAbgmAAQgnAAgbgbgADnArQgbgbAAgmQAAgmAbgbQAbgbAmAAQAnAAAbAbQAbAbAAAmQAAAmgbAbQgbAbgnAAQgmAAgbgbg"],[96.88,97.2,"#AFCE3A",0,0,"AlzBiQgggfAAgtQAAgrAggfQAfggAtAAQAsAAAgAgQAfAfAAArQAAAtgfAfQggAggsAAQgtAAgfgggADcA1QgfgfAAgsQAAgsAfgfQAgggAsAAQAtAAAfAgQAgAfAAAsQAAAsggAfQgfAggtAAQgsAAggggg"],[78.5,64.1,0,"black",[1,1,1],"AHAhCIgNmIIBfGpQgOgQgSgMQgjgXgPASgAKeDQQg2g4g9gMQg6gMgzAdQhzBCgLDBQCqAvBlhgQBJhFAGhagAoADiQAlgiBTgOQBYgOBaARQDrAsA0DTQjAAziog/Qihg+hAiIgAqdBlIAAnsIDmHEQgegMgsgBQhXgChFA3g"],[86.375,93.9,"#EACE35",0,0,"AltB+Qiig9g/iIQAkghBTgOQBZgPBaARQDrAtA0DRQhWAXhSAAQhkAAhcgjgADxB2QALjABzhBQAzgeA6AMQA9ANA2A4QgGBYhJBGQhEBAhiAAQgxAAg4gQg"],[73.45,154.83,"black","black",[2,1,1],"AkjjDIByAMQB/ANBEAFQB/AICXgSIgKFzQj4hflLiNQgDgBAFiag"],[79.42,123.62,"#A7A7A7","black",[2,1,1],"AEBpxIgBgBQAYiNAeiQQA8kgAfgMQAggNBLEqQAlCVAfCXIAXARQAbAXAZAcQBQBZAZBnQAZBngUB+QgKA/gPArQgeASgrAWQhYAuhFAXQg8AUh0AWIhoASIAAQzItygCQAvhKA1hoQBqjRAjiXQAri/AOjLIAFimQgegHhTgeQhEgZhgg/IhTg7QgekPgQkUQggonBEgWQBFgWCbEtQAkBGA3B9QAbA9AYA3QASAqAQAmIgjhQIABAAIJmgYIBUACIBQAK"]],lt=new t.Container(157.5,246);t.loop(We,function(ct){var ot=new t.Shape().f(ct[2]).s(ct[3]).ss(ct[4]?ct[4][0]:null,ct[4]?ct[4][1]:null,ct[4]?ct[4][2]:null).p(ct[5]);ot.setTransform(ct[0],ct[1]),ot.addTo(lt)},!0);var Ue=new t.Container;return lt.sca(Ce/246).addTo(Ue).mov(0,-.4),I&&Ue.cache(),Ue.mouseChildren=!1,Ue}},t.extend(t.Frame,Fe.EventDispatcher,null,"cjsEventDispatcher",!1),t.Queue=function(){this.cjsEventDispatcher_constructor(),this.type="Queue",this.isLoading=!0},t.extend(t.Queue,Fe.EventDispatcher,null,"cjsEventDispatcher"),t.Pic=function(e,r,i,l,a,s,f){var u="file, width, height, noCors, style, group, inherit",y;if(y=st(t.Pic,arguments,u,this))return y;De("83.03"),this.group=s;var k=a===!1?{}:t.getStyle("Pic",this.group,f);if(n(e)&&(e=k.file!=null?k.file:null),n(l)&&(l=k.noCors!=null?k.noCors:!1),n(e)){vt&&tt("ZIM Pic - needs a file");return}this.zimContainer_constructor(r,i);var g=this,O=e;e=g.file=t.Pick.choose(e),r&&i?this.type="ACWD":this.type="AC";var T=l?t.image(e):t.asset(e);g.mouseChildren=!1,T.type=="Bitmap"||T.type=="Image"?(T.type=="Bitmap"?g.bitmap=T.clone().addTo(g):g.bitmap=T.getChildAt(0).clone().addTo(g),g.id=T.id,g.image=g.bitmap.image,g.src=g.bitmap.src,g.item=g.bitmap.item,g.setBounds(null),g.type="Pic",setTimeout(function(){g.dispatchEvent("ready"),g.dispatchEvent("complete")},20)):T.on("complete",function(){if(g.bitmap=T.getChildAt(0).clone().addTo(g),g.id=T.id,g.setBounds(null),g.type="Pic",g.commands)for(var E=0;E<g.commands.length;E++)g.commands[E][2]?g[g.commands[E][0]].apply(g,g.commands[E][1]):t[g.commands[E][0]].apply(g,g.commands[E][1]);g.image=g.bitmap.image,g.src=g.bitmap.src,g.item=g.bitmap.item,g.commands=null,g.dispatchEvent("ready"),g.dispatchEvent("complete"),g.stage&&g.stage.update()}),g.keyOut=function(E,A,C){return g.type=="AC"&&ee.zdf?(ee.zdf.ac("keyOut",arguments,g),g):(g.bitmap&&g.bitmap.keyOut(E,A,C),g.stage&&g.stage.update(),g)},a!==!1&&t.styleTransforms(this,k),g.clone=function(E){return this.cloneProps(new t.Pic(E?e:O,r,i,l,a,this.group,f))}},t.extend(t.Pic,t.Container,["clone"],"zimContainer",!1),t.Aud=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="file, volume, loop, loopCount, pan, offset, delay, interrupt, maxNum, style, group, inherit",E;if(E=st(t.Aud,arguments,T,this))return E;De("83.05"),this.cjsEventDispatcher_constructor(),this.type="Aud",this.group=g;var A=k===!1?{}:t.getStyle(this.type,this.group,O);if(n(e)&&(e=A.file!=null?A.file:null),n(e)){vt&&tt("ZIM Sound - needs a file");return}n(r)&&(r=A.volume!=null?A.volume:1),n(i)&&(i=A.loop!=null?A.loop:!1),n(l)&&(l=A.loopCount!=null?A.loopCount:null),n(a)&&(a=A.pan!=null?A.pan:0),n(s)&&(s=A.offset!=null?A.offset:0),n(f)&&(f=A.delay!=null?A.delay:0),n(u)&&(u=A.interrupt!=null?A.interrupt:"none"),n(y)&&(y=A.maxNum!=null?A.maxNum:null);var C=this;e=C.file=t.Pick.choose(e);var d=C.sound=t.asset(e,null,null,y);d.type=="AC"?d.on("complete",function(){C.src=d.src,C.item=d.item,C.dispatchEvent("ready"),C.dispatchEvent("complete")}):setTimeout(function(){C.src=d.src,C.item=d.item,C.dispatchEvent("ready"),C.dispatchEvent("complete")},20),C.volume=r,C.loop=i,C.loopCount=l,C.pan=a,C.offset=s,C.delay=f,C.interrupt=u,C.maxNum=y,C.play=function(x,P,v,w,b,X,Y){var m="volume, loop, loopCount, pan, offset, delay, interrupt",j;return(j=st(C.play,arguments,m))?j:(n(x)&&(x=C.volume),n(P)&&(P=C.loop),n(v)&&(v=C.loopCount),n(w)&&(w=C.pan),n(b)&&(b=C.offset),n(X)&&(X=C.delay),n(Y)&&(Y=C.interrupt),C.sound.play(x,P,v,w,b,X,Y))},C.dispose=function(){return C.sound&&C.sound.dispose(),C.sound=null,!0}},t.extend(t.Aud,Fe.EventDispatcher,null,"cjsEventDispatcher"),t.Vid=function(e,r,i,l,a,s,f,u,y,k,g,O){var T="file, width, height, scaling, volume, loop, align, valign, type, style, group, inherit",E;if(E=st(t.Vid,arguments,T,this))return E;De("83.07"),this.group=g;var A=k===!1?{}:t.getStyle("Vid",this.group,O);if(n(e)&&(e=A.file!=null?A.file:null),n(e)){vt&&tt("ZIM Vid - needs a file");return}n(r)&&(r=A.width!=null?A.width:null),n(i)&&(i=A.height!=null?A.height:null),n(l)&&(l="fit"),n(s)&&(s=A.loop!=null?A.loop:!1),n(a)&&(a=A.volume!=null?A.volume:1),n(f)&&(f=A.align!=null?A.align:"center"),n(u)&&(u=A.valign!=null?A.valign:"center"),n(y)&&(y=A.type!=null?A.type:"video/mp4"),this.zimContainer_constructor(r,i),r&&i?this.type="ACWD":this.type="AC";var C=this,d,x=e;e=t.Pick.choose(e),C.file=e,ee.PATH!=null&&(t.PATH=ee.PATH);var P="";e.split("/").length==1&&t.PATH&&(P=t.PATH),this.mouseChildren=!1;var v=C.source=document.createElement("video");document.body.appendChild(v),v.style.display="none",v.setAttribute("autoplay","autoplay"),v.setAttribute("playsinline","playsinline"),v.setAttribute("crossorigin","anonymous"),s&&v.setAttribute("loop","loop");var w=C.innerSource=document.createElement("source");e.split("?").length==1&&(e+="?playsinline=1"),w.setAttribute("src",P+e),w.setAttribute("type",y),v.appendChild(w),X();var b=0;function X(){b++>5&&C.dispatchEvent("error"),v.addEventListener("stalled",X),v.addEventListener("error",X),v.addEventListener("canplay",Y)}function Y(){C.type="Vid",v.removeEventListener("stalled",X),v.removeEventListener("error",X),v.removeEventListener("canplay",Y),v.pause();var m=v.videoWidth,j=v.videoHeight;if(C.setBounds(0,0,r||m,i||j),d=C.bitmap=new t.Bitmap(v,m,j).addTo(C),d.setBounds(0,0,m,j),d.scaleTo(C,100,100,l).pos(0,0,f,u,C),C.commands)for(var S=0;S<C.commands.length;S++)C.commands[S][2]?C[C.commands[S][0]].apply(C,C.commands[S][1]):t[C.commands[S][0]].apply(C,C.commands[S][1]);C.commands=null,C.dispatchEvent("ready")}C.videoPaused=!0,C.play=function(){if(!d){vt&&tt("ZIM Vid - no file found");return}if(v.play(),v.volume=a,C.videoPaused=!1,!C.ticker)if(C.keyObj){var m=C.keyObj.color,j=C.keyObj.tolerance,S=C.keyObj.replacement;C.ticker=t.Ticker.add(function(){d.keyOut(m,j,S)})}else C.ticker=t.Ticker.add(function(){});return C},C.keyOut=function(m,j,S){return C.ticker?(t.Ticker.remove(C.ticker),C.ticker=t.Ticker.add(function(){d.keyOut(m,j,S)})):C.keyObj={color:m,tolerance:j,replacement:S},C},C.pause=function(m){return n(m)&&(m=!0),C.videoPaused=m,m?(v.pause(),C.ticker&&t.Ticker.remove(C.ticker)):(C.ticker&&t.Ticker.add(C.ticker),v.play()),C},Object.defineProperty(this,"duration",{get:function(){return v.duration},set:function(){}}),Object.defineProperty(this,"currentTime",{get:function(){return v.currentTime},set:function(m){v.currentTime=m}}),Object.defineProperty(this,"volume",{get:function(){return v.volume},set:function(m){a=m,v.volume=m}}),k!==!1&&t.styleTransforms(this,A),C.clone=function(m){return this.cloneProps(new t.Vid(m?e:x,r,i,l,a,s,f,u,y,k,this.group,O))},C.dispose=function(m,j,S){this.ticker&&t.Ticker.remove(this.ticker);var _=C.stage;return C.bitmap.dispose(),d=C.bitmap=null,v.pause(),v.removeAttribute("src"),v.load(),v.remove(),v=null,S||this.zimContainer_dispose(!0),_&&_.update(),!0}},t.extend(t.Vid,t.Container,["clone","dispose"],"zimContainer",!1),t.SVG=function(e,r,i,l,a,s,f,u,y,k,g){var O="svg, width, height, bitmap, splitTypes, geometric, showControls, interactive, style, group, inherit",T;if(T=st(t.SVG,arguments,O,this))return T;De("83.09"),this.group=k;var E=y===!1?{}:t.getStyle("SVG",this.group,g);if(n(e)&&(e=E.svg!=null?E.svg:null),n(e)){vt&&tt("ZIM SVG - needs a svg value");return}n(l)&&(l=E.bitmap!=null?E.bitmap:!0),n(a)&&(a=E.splitTypes!=null?E.splitTypes:!1),n(s)&&(s=E.geometric!=null?E.geometric:!0),n(f)&&(f=E.showControls!=null?E.showControls:!0),n(u)&&(u=E.interactive!=null?E.interactive:!0),this.zimContainer_constructor(r,i);var A=this;l&&(this.mouseChildren=!1);var C=e;e=t.Pick.choose(e),r&&i?this.type="ACWD":this.type="AC";var d=t.assets[e];if(d&&(A.src=d.src,A.file=d.file,A.item=d.item,A.svg=d.svg),d&&d.type=="Bitmap")A.type="SVG",A.bitmap=d.clone(),P();else if(d&&d.type=="AC")d.on("complete",function(){A.type="SVG",A.bitmap=d.bitmap.clone(),P(n(r)&&n(i))});else if(d&&d.type=="ACWB")n(r)&&n(i)&&A.setBounds(0,0,d.width,d.height),d.on("complete",function(){A.type="SVG",A.bitmap=d.bitmap.clone(),P()});else if(d&&d.type=="SVG")A.type="SVG",d.bitmap?A.bitmap=d.bitmap.clone():A.bitmap=d.clone(),P();else if(e&&e.match(/<svg/i)&&(A.svg=e),A.svg&&A.svg.match(/<svg/i))A.type="SVG",P();else{var x=t.asset(e);x.on("complete",function(){A.type="SVG",x.bitmap&&(A.src=x.bitmap.src,A.file=x.bitmap.file,A.item=x.bitmap.item,A.svg=x.bitmap.svg,A.bitmap=x.bitmap.clone()),P(n(r)&&n(i))})}function P(w){if(l)A.bitmap?(A.svg=A.bitmap.svg,A.bitmap.addTo(A),w&&v(),setTimeout(function(){A.dispatchEvent("ready"),A.dispatchEvent("complete")},20)):t.svgToBitmap(A.svg,function(Y){A.bitmap=Y,A.bitmap.addTo(A),v(),A.dispatchEvent("ready"),A.dispatchEvent("complete"),A.stage&&A.stage.update()});else if(A.bitmap&&(A.svg=A.bitmap.svg),e.match(/<svg/i)||d&&d.type=="SVG"||w){var b=new t.SVGContainer(A.svg);b.loop(function(Y){Y&&Y.addTo(A)},!0),w&&v(),setTimeout(function(){A.dispatchEvent("ready"),A.dispatchEvent("complete")},20)}else{var X=t.asset(e);X.on("complete",function(){var Y=new t.SVGContainer(X);Y.loop(function(m){m&&m.addTo(A)},!0),v(),A.dispatchEvent("ready"),A.dispatchEvent("complete"),A.stage&&A.stage.update()})}}function v(){if(n(r)&&n(i)&&A.setBounds(null),A.type="SVG",A.commands)for(var w=0;w<A.commands.length;w++)A.commands[w][2]?A[A.commands[w][0]].apply(A,A.commands[w][1]):t[A.commands[w][0]].apply(A,A.commands[w][1]);A.commands=null}A.keyOut=function(w,b,X){return A.type=="AC"&&ee.zdf?(ee.zdf.ac("keyOut",arguments,A),A):(A.bitmap&&A.bitmap.keyOut(w,b,X),A.stage&&A.stage.update(),A)},y!==!1&&t.styleTransforms(this,E),A.clone=function(w){return this.cloneProps(new t.SVG(w?e:C,r,i,l,a,s,f,u,y,this.group,g))}},t.extend(t.SVG,t.Container,["clone"],"zimContainer",!1),t.SensorAsk=function(e,r,i,l,a,s,f){var u="callback, sensorType, color, backgroundColor, style, group, inherit",y;if(y=st(t.SensorAsk,arguments,u,this))return y;De("83.01"),this.group=s;var k=a===!1?{}:t.getStyle("SensorAsk",this.group,f);if(n(r)&&(r=k.sensorType!=null?k.sensorType:"deviceorientation"),r!="devicemotion"&&(r="deviceorientation"),this.sensorType=r,!n(e)){n(i)&&(i=k.color!=null?k.color:t.dark),n(l)&&(l=k.backgroundColor!=null?k.backgroundColor:t.lighter),this.zimPane_constructor("",l,i,200,200,!1,null,!0,100,black.toAlpha(.3),null,null,null,!1,!1),this.type="SensorAsk";var g=this;if(Style.addGroup("sensorAsk",{width:100,color:i,rollColor:l,corner:10,backgroundColor:t.faint,rollBackgroundColor:i,borderColor:i,borderWidth:2}),g.yes=new t.Button({label:"YES",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,TOP,this).tap(function(){g.hide(!0);var T=DeviceMotionEvent;r!="devicemotion"&&(T=DeviceOrientationEvent),T.requestPermission().then(function(E){E!="denied"?e(!0):e(!1)})}),g.label=new t.Label("Use sensor?",null,null,i,null,null,null,"center").sca(.9).centerReg(this),g.no=new t.Button({label:"NO",group:"sensorAsk"}).sca(.65).pos(0,30,CENTER,BOTTOM,this).tap(function(){g.hide(!1),e(!1)}),new t.Circle(110,t.clear,i,1).center(this).alp(.8),new t.Circle(120,t.clear,i,1).center(this).alp(.5),new t.Circle(130,t.clear,i,1).center(this).alp(.2),a!==!1&&t.styleTransforms(this,k),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent&&typeof DeviceOrientationEvent.requestPermission=="function")g.show();else{let T=function(E){r=="deviceorientation"?E.alpha==null||E.alpha==0&&E.beta==0&&E.gamma==0?e(!1):e(!0):!E.acceleration||E.acceleration.x==null||E.acceleration.x==0&&E.acceleration.y==0&&E.acceleration.z==0?e(!1):e(!0),O=!0,ee.removeEventListener(r,T)};var O=!1;ee.addEventListener(r,T),setTimeout(function(){O||e(!1)},100)}}},t.extend(t.SensorAsk,t.Pane,null,"zimPane",!1),t.colorsHex=["#fb4758","#f58e25","#ebcb35","#acd241","#50c4b7","#993399","#e472c4","#d1a170","#112233","#000000","#111111","#222222","#333333","#444444","#555555","#555555","#666666","#777777","#888888","#999999","#aaaaaa","#bbbbbb","#cccccc","#dddddd","#eeeeee","#ffffff","rgba(0,0,0,.01)","rgba(0,0,0,0)"],t.colors=["red","orange","yellow","green","blue","purple","pink","brown","interstellar","black","darker","licorice","dark","charcoal","grey","gray","granite","tin","pewter","silver","fog","mist","light","moon","lighter","white","faint","clear"],dn=0;dn<t.colors.length;dn++)t[t.colors[dn]]=t.colorsHex[dn];return String.prototype.darken=function(e){return t.darken(this,e)},String.prototype.lighten=function(e){return t.lighten(this,e)},String.prototype.toColor=function(e,r){return t.toColor(this,e,r)},String.prototype.toAlpha=function(e){return t.toAlpha(this,e)},t.FIT="fit",t.FILL="fill",t.FULL="full",t.LEFT="left",t.RIGHT="right",t.CENTER="center",t.MIDDLE="middle",t.START="start",t.END="end",t.TOP="top",t.BOTTOM="bottom",t.OVER="over",t.UNDER="under",t.HORIZONTAL="horizontal",t.VERTICAL="vertical",t.BOTH="both",t.RADIAL="radial",t.UP="up",t.DOWN="down",t.NEXT="next",t.PREV="prev",t.AUTO="auto",t.AVE="ave",t.DEFAULT="default",t.ALL="all",t.NONE="none",t.GET="get",t.POST="post",t.LOCALSTORAGE="localStorage",t.SOCKET="socket",t.TO="to",t.FROM="from",t.SINE="sine",t.SQUARE="square",t.TRIANGLE="triangle",t.SAW="saw",t.SAWTOOTH="saw",t.ZAP="zap",t.DISTILL=!1,t.distillery=[],t.distill=function(){!ee.zns&&t&&(t.DISTILL||ee.DISTILL)&&t.distillery.push("83.3","83.35");function e(r,i,l){return l.indexOf(r)===i}t.distillery.length>0?(t.distillery=t.distillery.filter(e),tt("zim.distill() - go to https://zimjs.com/distill and enter the following:"),Wn(t.distillery.join(" "))):tt("must set zim.DISTILL = true;")},t.parseAudioSprite=function(e,r){if(De("83.25"),!(n(e)||n(e.resources)||n(e.spritemap))){var i=e,l=i.resources[0],a=i.spritemap,s=[],f,u={src:l,data:{}};for(var y in a)f=a[y],s.push({id:y,startTime:Math.round(f.start*1e3),duration:Math.round((f.end-f.start)*1e3)});return u.data.audioSprite=s,r&&tt(JSON.stringify(u)),u}},t.previewAudioSprite=function(e,r,i){if(De("83.26"),!n(e)){if(n(r)&&(r=3),typeof i>"u"){if(n(ee.zdf))return;var i=ee.zdf}var l=i.width,a=e,s=[],f=[];if(a.constructor=={}.constructor)a.resources&&(a=t.parseAudioSprite(a)),a.audioSprite?t.loop(a.audioSprite,function(y){s.push(y[0].substr(0,r)),f.push(y[0])}):a.data&&a.data.audioSprite&&t.loop(a.data.audioSprite,function(y){s.push(y.id.substr(0,r)),f.push(y.id)});else return;var u=new t.Tabs({tabs:s,width:l,currentEnabled:!0}).addTo();return u.on("change",function(){i.asset(f[u.selectedIndex]).play()}),u}},t.svgToBitmap=function(e,r,i,l,a){if(De("83.27"),!n(e.draggable)){var s=new DOMParser;e=e.innerHTML?s.parseFromString(e.innerHTML,"text/xml"):e;var f=e.getElementsByTagName("svg"),u=f?e.getElementsByTagName("svg")[0]:null;e=u}if(!XMLSerializer&&vt){tt("ZIM svgToBitmap() - sorry, not supported in Browser");return}var y=typeof e=="string"?e:new XMLSerializer().serializeToString(e);if(y){var k=y.split(">")[0];if(k.length>1){var g=k.split(/width/i);if(g.length==1){var O=100,T=100,E=k.split(/viewBox/i);if(E.length>1){var A=E[1].split('"')[1];if(A){var C=A.split(" ");C.length>1&&(O=C[C.length-2],T=C[C.length-1])}}y=y.replace(/svg /i,'svg  width="'+O+'" height="'+T+'" ')}}y.match(/xmlns/i)||(y=y.replace(/svg /i,"svg  xmlns='http://www.w3.org/2000/svg' "))}var d=self.URL||self.webkitURL||self,x=new Image;x.onload=function(){var v=new t.Bitmap(x,i,l);r(v,a),d.revokeObjectURL(P)};var P=d.createObjectURL(new document.Blob([y],{type:"image/svg+xml"}));x.src=P},t.makeContent=function(e,r,i){De("83.29");var l;if(n(i)&&(i=t.dark),typeof e=="string"||typeof e=="number")e=this.message=new t.Label(e,null,null,i);else if(e.constructor=={}.constructor){var a=e;a.buttonScale||(a.buttonScale=.5),n(a.spacingH)&&(a.spacingH=20*a.buttonScale),n(a.spacingV)&&(a.spacingV=20);var s=a.spacingH,f=a.spacingV;a.align||(a.align="center"),e=new t.Container;var u=new ei(10,f).addTo(e);if(a.header&&a.header.pos(0,f,"left","top",e),a.message)var y=new t.Label(a.message,null,null,n(a.color)?i:a.color).loc(0,e.height+(a.header?f:0),e);if(a.display&&a.display.pos(0,-a.display.height-(a.header||a.message?f:0),"left","bottom",e),a.buttons){Array.isArray(a.buttons)||(a.buttons=[a.buttons]);for(var k=a.length*100,g=new t.Container().loc(0,e.height+(a.header||a.message||a.display?f:0),e),O=0;O<a.buttons.length;O++){var T=a.buttons[O],E=T.call||function(){};T.button||(T.button=new t.Button({width:T.width,label:T.label,backgroundColor:T.backgroundColor||T.bgColor,color:T.color,rollBackgroundColor:T.rollBackgroundColor||T.rollBgColor,rollColor:T.rollColor})),T.button.call=E,T.button.sca(a.buttonScale).loc(O==0?0:g.width+s,0,g).tap(function(C){C.target.call(C.target)})}}for(l=0;l<e.numChildren;l++){var A=e.getChildAt(l);A.lastY=A.y,a.align=="center"?A.center(e).loc(null,A.lastY):a.align=="right"&&A.pos(0,null,"right")}if(r&&typeof r=="number"&&(e.width=Math.min(e.width,r-s*2-(a.scrollBar===!0?12:a.scrollBar>0?a.scrollBar:0))),new t.Container(10,f).pos(0,-u.height,"center","bottom",e).bot(),u.top(),e.config=a,e.header=a.header,e.message=y,e.text=a.message,e.display=a.display,a.buttons)for(e.buttons=[],l=0;l<g.numChildren;l++)e.buttons.push(g.getChildAt(l))}return e},t}(ye||{});function De(t){ye&&(ye.DISTILL||ee.DISTILL)&&ye.distillery.push(t)}function Un(t,Tt,Pt,It,Ot,mt){if(De("83.3"),t&&t.noDrag)return t;mt!==!0&&(mt=null);var Rt={drag:function(qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d){return hn(arguments)?(arguments[0].obj=this,ye.drag(arguments[0])):ye.drag(this,qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d)},noDrag:function(qe){return ye.noDrag(this,qe)},mouse:function(){return ye.mouse(this)},noMouse:function(){return ye.noMouse(this)},effect:function(qe,e,r,i,l){return ye.effect(this,qe,e,r,i,l)},noEffect:function(qe,e){return ye.noEffect(this,qe,e)},updateEffects:function(qe){return ye.updateEffects(this,qe)},wire:function(qe,e,r,i,l,a,s){return hn(arguments)?(arguments[0].source=this,ye.wire(arguments[0])):ye.wire(this,qe,e,r,i,l,a,s)},noWire:function(qe,e,r){return hn(arguments)?(arguments[0].source=this,ye.noWire(arguments[0])):ye.noWire(this,qe,e,r)},wired:function(qe,e,r,i,l,a,s){return hn(arguments)?(arguments[0].target=this,ye.wired(arguments[0])):ye.wired(this,qe,e,r,i,l,a,s)},noWired:function(qe,e,r){return hn(arguments)?(arguments[0].target=this,ye.noWired(arguments[0])):ye.noWired(this,qe,e,r)},bind:function(qe,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.bind(arguments[0])):ye.bind(this,qe,e,r,i,l)},noBind:function(qe,e,r,i){return hn(arguments)?(arguments[0].obj=this,ye.noBind(arguments[0])):ye.noBind(this,qe,e,r,i)},dragBoundary:function(qe){return ye.dragBoundary(this,qe)},dragRect:function(qe){return ye.dragBoundary(this,qe)},transform:function(qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_){return hn(arguments)?(arguments[0].obj=this,ye.transform(arguments[0])):ye.transform(this,qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_)},setSwipe:function(qe){return ye.setSwipe(this,qe)},gesture:function(qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E){return hn(arguments)?(arguments[0].obj=this,ye.gesture(arguments[0])):ye.gesture(this,qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E)},noGesture:function(qe,e,r){return hn(arguments)?(arguments[0].obj=this,ye.noGesture(arguments[0])):ye.noGesture(this,qe,e,r)},gestureBoundary:function(qe,e){return ye.gestureBoundary(this,qe,e)},gestureRect:function(qe,e){return ye.gestureBoundary(this,qe,e)},addPhysics:function(qe,e,r,i,l,a,s,f,u,y,k){return hn(arguments)?(arguments[0].obj=this,ye.addPhysics(arguments[0])):ye.addPhysics(this,qe,e,r,i,l,a,s,f,u,y,k)},removePhysics:function(){return ye.removePhysics(this)},hitTestPoint:function(qe,e,r){return ye.hitTestPoint(this,qe,e,r)},hitTestReg:function(qe,e){return ye.hitTestReg(this,qe,e)},hitTestRect:function(qe,e,r,i){return ye.hitTestRect(this,qe,e,r,i)},hitTestCircle:function(qe,e,r,i){return ye.hitTestCircle(this,qe,e,r,i)},hitTestCircleRect:function(qe,e){return ye.hitTestCircleRect(this,qe,e)},hitTestCircles:function(qe,e){return ye.hitTestCircles(this,qe,e)},hitTestBounds:function(qe,e,r){return ye.hitTestBounds(this,qe,e,r)},boundsToGlobal:function(qe,e,r,i){return ye.boundsToGlobal(this,qe,e,r,i)},resetBounds:function(qe,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.resetBounds(arguments[0])):ye.resetBounds(this,qe,e,r,i,l)},hitTestPath:function(qe,e,r,i,l){return ye.hitTestPath(this,qe,e,r,i,l)},hitTestGrid:function(qe,e,r,i,l,a,s,f,u,y,k,g){return ye.hitTestGrid(this,qe,e,r,i,l,a,s,f,u,y,k,g)},animate:function(qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue){return qe&&(qe.props||qe.obj)&&hn(arguments)?(arguments[0].target=this,ye.animate(arguments[0])):ye.animate(this,qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E,A,C,d,x,P,v,w,b,X,Y,m,j,S,_,R,U,Z,K,ne,V,D,c,h,o,I,N,p,L,we,B,F,fe,se,Q,te,le,Ae,J,Te,G,ce,q,ue)},pauseAnimate:function(){return this},stopAnimate:function(){return this},wiggle:function(qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E){return hn(arguments)?(arguments[0].target=this,ye.wiggle(arguments[0])):ye.wiggle(this,qe,e,r,i,l,a,s,f,u,y,k,g,O,T,E)},loop:function(qe,e,r,i,l,a,s,f,u,y){return hn(arguments)?(arguments[0].obj=this,ye.loop(arguments[0])):ye.loop(this,qe,e,r,i,l,a,s,f,u,y)},copyMatrix:function(qe){return ye.copyMatrix(this,qe)},duplicate:function(qe){return ye.duplicate(this,qe)},cur:function(qe){return ye.cur(this,qe)},sha:function(qe,e,r,i){return ye.sha(this,qe,e,r,i)},pos:function(qe,e,r,i,l,a,s,f,u,y){return hn(arguments)?(arguments[0].obj=this,ye.pos(arguments[0])):ye.pos(this,qe,e,r,i,l,a,s,f,u,y)},loc:function(qe,e,r,i,l,a,s){return hn(arguments)?(arguments[0].obj=this,ye.loc(arguments[0])):ye.loc(this,qe,e,r,i,l,a,s)},mov:function(qe,e){return hn(arguments)?(arguments[0].obj=this,ye.mov(arguments[0])):ye.mov(this,qe,e)},top:function(){return ye.top(this)},bot:function(){return ye.bot(this)},ord:function(qe){return ye.ord(this,qe)},dep:function(qe){return ye.dep(this,qe)},nam:function(qe){return ye.nam(this,qe)},alp:function(qe){return ye.alp(this,qe)},vis:function(qe){return ye.vis(this,qe)},ble:function(qe){return ye.ble(this,qe)},dye:function(qe){return ye.dye(this,qe)},hov:function(qe,e){return ye.hov(this,qe,e)},rot:function(qe,e,r){return ye.rot(this,qe,e,r)},siz:function(qe,e,r){return ye.siz(this,qe,e,r)},ske:function(qe,e){return ye.ske(this,qe,e)},reg:function(qe,e,r){return ye.reg(this,qe,e,r)},sca:function(qe,e){return ye.sca(this,qe,e)},scaleTo:function(qe,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.scaleTo(arguments[0])):ye.scaleTo(this,qe,e,r,i,l)},fit:function(qe,e,r,i,l){return hn(arguments)?(arguments[0].obj=this,ye.fit(arguments[0])):ye.fit(this,qe,e,r,i,l)},outline:function(qe,e,r){return hn(arguments)?(arguments[0].obj=this,ye.outline(arguments[0])):ye.outline(this,qe,e,r)},blendmodes:function(qe){return ye.blendmodes(this,qe)},addTo:function(qe,e,r){return hn(arguments)?(arguments[0].obj=this,ye.addTo(arguments[0])):ye.addTo(this,qe,e,r)},removeFrom:function(qe){return ye.removeFrom(this,qe)},added:function(qe,e,r){return ye.added(this,qe,e,r)},movement:function(qe,e){return ye.movement(this,qe,e)},noMovement:function(){return ye.noMovement(this)},tap:function(qe,e,r,i,l,a,s,f,u){return hn(arguments)?(arguments[0].obj=this,ye.tap(arguments[0])):ye.tap(this,qe,e,r,i,l,a,s,f,u)},noTap:function(){return ye.noTap(this)},hold:function(qe,e,r,i){return ye.hold(this,qe,e,r,i)},noHold:function(){return ye.noHold(this)},change:function(qe,e){return ye.change(this,qe,e)},noChange:function(){return ye.noChange(this)},centerReg:function(qe,e,r){return hn(arguments)?(arguments[0].obj=this,ye.centerReg(arguments[0])):ye.centerReg(this,qe,e,r)},center:function(qe,e,r){return hn(arguments)?(arguments[0].obj=this,ye.center(arguments[0])):ye.center(this,qe,e,r)},place:function(qe){return ye.place(this,qe)},placeReg:function(qe){return ye.placeReg(this,qe)},expand:function(qe,e,r,i){return hn(arguments)?(arguments[0].obj=this,ye.expand(arguments[0])):ye.expand(this,qe,e,r,i)},setMask:function(qe,e){return ye.setMask(this,qe,e)},cloneProps:function(qe){return qe.type=this.type,qe.group=this.group,qe.style=this.style,qe.alpha=this.alpha,qe.rotation=this.rotation,qe.mouseEnabled=this.mouseEnabled,qe.mouseChildren=this.mouseChildren,qe.tickEnabled=this.tickEnabled,qe.x=this.x,qe.y=this.y,qe.scaleX=this.scaleX,qe.scaleY=this.scaleY,qe.skewX=this.skewX,qe.skewY=this.skewY,qe.name&&(qe.name=this.name),qe.regX=this.regX*qe.width/(this.width||1),qe.regY=this.regY*qe.height/(this.height||1),qe.visible=this.visible,qe.shadow=this.shadow,(!this.type||this.type=="Shape")&&ye.copyMatrix(qe,this),qe.compositeOperation=this.compositeOperation,qe.snapToPixel=this.snapToPixel,this.filters&&this.filters.length>0&&(qe.filters=this.filters.slice(0),qe.cache()),qe.mask=this.mask,qe.hitArea=this.hitArea,(!this.type||this.type=="Shape"||this.type=="Blob"||this.type=="Squiggle")&&this._bounds&&qe.setBounds(this._bounds.x,this._bounds.y,this._bounds.width,this._bounds.height),qe},cloneChildren:function(qe,e){qe.children.length&&qe.removeAllChildren();for(var r=qe.children,i=0,l=this.children.length;i<l;i++){var a=this.children[i].clone(e);a.parent=qe,r.push(a)}return qe}};if(!n(mt)){mt=[];for(var Zt in Rt)mt.push(Zt);return mt}for(var At in Rt)Object.prototype.hasOwnProperty.call(Rt,At)&&(t[At]=Rt[At]);if(ye&&(t.cjsLocalToGlobal=t.localToGlobal,t.cjsGlobalToLocal=t.globalToLocal,t.cjsLocalToLocal=t.localToLocal,t.localToGlobal=function(qe,e){return ye.localToGlobal(qe,e,t,t.cjsLocalToGlobal)},t.globalToLocal=function(qe,e){return ye.globalToLocal(qe,e,t,t.cjsGlobalToLocal)},t.localToLocal=function(qe,e,r){return ye.localToLocal(qe,e,r,t)},t.hueBatch||ye.displayBase(t)),!n(Tt)&&!n(Pt)&&!n(It)&&!n(Ot)?Tt=Tt:!n(Tt)&&!n(Pt)&&(It=Tt,Ot=Pt,Tt=0,Pt=0),!n(Tt)&&!n(Pt)&&!n(It)&&!n(Ot))t.setBounds(Tt,Pt,It,Ot);else if(t.nominalBounds!=null&&t.getBounds&&t.getBounds()==null){var Nt=t.nominalBounds;t.setBounds(Nt.x,Nt.y,Nt.width,Nt.height)}return t.parent&&t.parent.actionFrames&&!t.parent.addPhysics&&Un(t.parent,zdf?zdf.width:null,zdf?zdf.height:null),t}var mi;function Ai(t){De("83.35"),document.Window=Window,document.Blob=Blob,mi="ignore",n(t)&&(t=[]),Array.isArray(t)||(t=[t]);var Tt=Un(null,null,null,null,null,!0),Pt=["loop","stopAnimate","pauseAnimate","animate","wiggle","wire","wired"];for(var It in ye)(Tt.indexOf(It)==-1||Pt.indexOf(It)>=0)&&t.indexOf(It)==-1&&(window[It]=ye[It])}ye.fastFrame=function(t,Tt){if(De("83.355"),Fe=t,n(ee.zdf))return Tt.frame=new ye.Frame({shim:{stage:Tt,canvas:Tt.canvas}}),ee.zimDefaultFrame=ee.zdf=Tt.frame,ye.scaX=Fe.stageTransformable?1:Tt.scaleX,ye.scaY=Fe.stageTransformable?1:Tt.scaleY,Tt.frame};ye.addWires=function(t){return De("83.365"),t.wire=function(){return Array.prototype.unshift.call(arguments,t),ye.wire.apply(null,arguments),t},t.noWire=function(){return Array.prototype.unshift.call(arguments,t),ye.noWire.apply(null,arguments),t},t.wired=function(){return Array.prototype.unshift.call(arguments,t),ye.wired.apply(null,arguments),t},t.noWired=function(){return Array.prototype.unshift.call(arguments,t),ye.noWired.apply(null,arguments),t},t};ye.setBlurDetect=function(){De("83.36"),ye.blurCheck=!0,ye.pauseAnimateOnBlur=!0,ye.pauseOnBlur=[],ye.blurDetect=function(){var t,Tt,Pt={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(t in Pt)if(t in document){Tt=Pt[t];break}return function(It){return It&&document.addEventListener(Tt,It),!document[t]}}(),ye.blurDetect(function(){var t,Tt,Pt;if(ye.blurDetect())setTimeout(function(){if(ye.pauseOnBlur)for(t=0;t<ye.pauseOnBlur.length;t++)Tt=ye.pauseOnBlur[t],Tt.pauseOnBlurPaused||Tt.pause(!1);if(ye.pauseAnimateOnBlur&&ye.animatedObjects){var It=[],Ot;for(t=0;t<ye.animatedObjects.objects.length;t++){Tt=ye.animatedObjects.objects[t];var mt=ye.copy(Tt.tweenStates);if(!Tt.tweenStates)Tt.pauseAnimate(!1);else if(n(mt.all)||mt.all){if(Tt.pauseAnimate(!1),!Tt.dynamicAnimation)for(Pt in mt)Pt!="all"&&mt[Pt]===!1&&Tt.pauseAnimate(!0,Pt)}else{Tt.pauseAnimate(!0);for(Pt in mt)Pt!="all"&&mt[Pt]&&Tt.pauseAnimate(!1,Pt)}Tt.type=="Sprite"&&(Tt.paused=!0),Tt.parent&&Tt.parent.type=="Particles"&&Tt.parent.emitter&&Tt.parent.emitter.focusWarm&&(Ot=Tt.parent.emitter,It.indexOf(Tt.parent.emitter)<0&&It.push(Tt.parent.emitter))}if(It.length>0)for(t=0;t<It.length;t++)It[t].doWarm(It[t].focusWarm)}},300),ee.zdf&&ee.zdf.dispatchEvent("tabfocus");else{if(ye.pauseOnBlur)for(t=0;t<ye.pauseOnBlur.length;t++)Tt=ye.pauseOnBlur[t],Tt.pauseOnBlurPaused=Tt.paused,Tt.pause(!0);ye.pauseAnimateOnBlur&&ye.animatedObjects&&ye.pauseAnimate(!0,"pauseOnBlur"),ee.zdf&&ee.zdf.dispatchEvent("tabblur")}})};var ai=!1;ye=function(t){t.ZIMON={stringify:function(Pt,It){if(De("83.39"),n(Pt))return;if(!ai){vt&&tt("ZIMON - set ZIMONON=true before using ZIMON.stringify()");return}return Pt=t.copy(Pt),Ot(Pt),JSON.stringify({obj:Pt,key:It,zimon:1,info:"https://zimjs.com/zimon/"});function Ot(mt,Rt,Zt){if(!n(mt))if(Array.isArray(mt))t.loop(mt,function(Nt,qe){Ot(Nt,mt,qe)});else if(mt.constructor=={}.constructor)t.loop(mt,function(Nt,qe){Ot(qe,mt,Nt)});else if(mt.type){var At={zimon:mt.type};mt.arguments&&(At.args=Array.prototype.slice.call(mt.arguments),Ot(At.args)),mt.type=="series"&&(At.args=Array.prototype.slice.call(mt.array),Ot(At.args)),It&&It[mt.type]&&It[mt.type].props&&(At.props=[],t.loop(It[mt.type].props,function(Nt){At.props.push(mt[Nt])})),Rt?Rt[Zt]=At:Pt=At}else typeof mt!="string"&&typeof mt!="number"&&typeof mt!="boolean"&&mt!==null&&vt&&tt("ZIMON - potentially bad JSON value"+mt)}},parse:function(Pt,It){if(De("83.39"),n(Pt))return;var Ot=JSON.parse(Pt),mt=Ot.obj;return It=Ot.key,Zt(mt),mt;function Rt(At){try{return Function("return("+At+")")()}catch (e19){return vt&&tt("ZIMON - bad function scope or name: "+At),null}}function Zt(At,Nt,qe){if(!n(At)){if(Array.isArray(At))t.loop(At,function(s,f){Zt(s,At,f)});else if(n(At.zimon)&&At.constructor=={}.constructor)t.loop(At,function(s,f){Zt(f,At,s)});else if(At.zimon){var e=At.zimon,r="";It&&(It[e]&&It[e].scope?r=It[e].scope+".":It.scope&&(r=It.scope+"."));var i=Rt(r+e),l=At.args;n(l)&&(l=[]),Zt(l);var a;At.type=="series"?a=t.series(l):a=i?new(i.bind.apply(i,[null].concat(Array.prototype.slice.call(l)))):null,Nt?Nt[qe]=a:mt=a,It&&It[e]&&It[e].props&&a&&t.loop(It[e].props,function(s,f){n(At.props[f])||(a[s]=At.props[f])})}}}}},t.Wonder=function(Pt,It,Ot,mt,Rt){var Zt="wid, client, app, notes, server",At;if(At=st(t.Wonder,arguments,Zt,this))return At;if(De("82"),n(Pt)){tt("zim.Wonder() - please provide Wonder ID (see https://zimjs.com/wonder/)");return}n(Rt)&&(Rt="https://wonder.zimjs.org/wonder");var Nt=this;n(t.wonderSession)&&(t.wonderSession="W"+t.rand(1e5,999999));var qe=[],e=setInterval(i,1e3),r=0;function i(){qe.length>0&&(t.async(Rt+"?wonder="+JSON.stringify(qe)),qe=[],r++)}var l,a=setInterval(function(){r>28&&(qe.push({id:Pt,c:It,a:Ot,n:mt,k:l,t:"e",v:"frequency max - terminated",s:t.wonderSession}),tt("zim.Wonder() - frequency max - terminated"),Nt.dispose()),r=0},30*1e3);this.countsOff={},this.timesOff={},this.ordersOff={};function s(y,k){return n(y)?(tt("zim.Wonder "+k+" - please provide a keyword"),!1):!Nt[k+"sOff"][y]}this.count=function(y){s(y,"count")&&(l=y,qe.push({id:Pt,c:It,a:Ot,n:mt,k:y,t:"c",v:1,s:t.wonderSession}))};var f={};this.timeStart=function(y){s(y,"time")&&(Nt.timeEnd(y),l=y,f[y]=new Date().getTime())};var u={};this.timePause=function(y){s(y,"time")&&(u[y]||(u[y]=new Date().getTime()))},this.timeUnpause=function(y){if(s(y,"time")&&u[y]){var k=new Date().getTime()-u[y];f[y]&&(f[y]+=k),delete u[y]}},this.timeEnd=function(y){if(s(y,"time")&&f[y]){var k=u[y]?u[y]:new Date().getTime(),g=Math.round((k-f[y])/1e3);delete u[y],delete f[y],qe.push({id:Pt,c:It,a:Ot,n:mt,k:y,t:"t",v:g,s:t.wonderSession})}},this.order=function(y,k){if(s(y,"order")){if(l=y,n(k)){tt("zim.Wonder order() - please provide an item");return}qe.push({id:Pt,c:It,a:Ot,n:mt,k:y,t:"o",v:k,s:t.wonderSession})}},this.countOff=function(y){Nt.countsOff[y]=1},this.countOn=function(y){delete Nt.countOff[y]},this.timeOff=function(y){Nt.timesOff[y]=1},this.timeOn=function(y){delete Nt.timesOff[y]},this.orderOff=function(y){Nt.ordersOff[y]=1},this.orderOn=function(y){delete Nt.ordersOff[y]},this.dispose=function(){return i(),clearInterval(e),clearInterval(a),!0}},t.VERSION="015/zim",t.getLatestVersions=function(Pt){De("82.2");var It="https://zimjs.com/live/getLatestVersions.php";function Ot(mt){Pt(JSON.parse(mt))}t.async(It,Ot,"returnLatestVersions")},typeof Fe<"u"&&(t.PWA=function(Pt,It,Ot,mt,Rt,Zt,At){var Nt="call, label, backgroundColor, color, backdropColor, pane, noScale",qe;if(qe=st(t.PWA,arguments,Nt,this))return qe;De("82.4"),this.cjsEventDispatcher_constructor(),this.type="PWA";var e,r=this,i=ee.M=="ios"?`In Safari, please add to
home screen as an app`:`Please add to
home screen as an app`;if(n(It)&&(It=new t.Label({text:i,align:t.LEFT,lineHeight:44,color:mt})),n(Ot)&&(Ot=t.yellow),n(Zt)){Zt=new t.Pane({width:1200,height:230,content:It,backgroundColor:Ot,backdropColor:Rt});var l=new t.Container;new t.Shape().s(t.dark).ss(3,1,0,3).p("AAAj0IAAFJAA8hoIBuAAIAAFdIlTAAIAAldIBuAA").sca(1.7).addTo(l),new t.Shape().s(t.dark).ss(3,1,0,3).p("AhGAlIBGhGIBHBG").sca(1.7).addTo(l).mov(0,-38);var a=new t.Tile([l,It],2,1,40,0,!0);a.width>zdf.stage.width*.7&&(a.width=zdf.stage.width*.7),a.setBounds(-70,-10,480,100),l.mov(-30,35),a.center(Zt)}M&&!(ee.matchMedia("(display-mode: standalone)").matches||ee.navigator.standalone||document.referrer.includes("android-app://"))?s():(Pt&&Pt.constructor===Function&&Pt(),setTimeout(function(){r.dispatchEvent("ready")},20));function s(){r.pane=e=Zt.show(),e.on("close",function(){Pt&&Pt.constructor===Function&&Pt(),r.scaleEvent&&f.off("resize",r.scaleEvent),r.dispatchEvent("ready"),ee.zdf.stage.update()});var f=f||ee.zdf;f&&!At&&(e.scaleTo(f.stage,105).center(),(f.scaling=="full"||f.scaling=="tag")&&(r.scaleEvent=f.on("resize",function(){e.scaleTo(f.stage,105).center()})),f.stage.update())}this.show=function(){return s(),this}},t.extend(t.PWA,Fe.EventDispatcher,null,"cjsEventDispatcher",!1)),t.QR=function(Pt,It,Ot,mt,Rt,Zt){var At="url, color, backgroundColor, size, clickable, correctLevel",Nt;if(Nt=st(t.QR,arguments,At,this))return Nt;De("82.5"),n(Pt)&&(Pt="https://zimjs.com"),n(mt)&&(mt=256),n(It)&&(It=t.black),n(Ot)&&(Ot=t.white),n(Rt)&&(Rt=!0),n(Zt)&&(Zt=2);var qe=document.createElement("div");if(typeof QRCode>"u"){tt("ZIM QR - needs qrcode.js library - see docs");return}var e=new QRCode(qe,{text:Pt,width:mt,height:mt,colorDark:It,colorLight:Ot,correctLevel:Zt});this.zimBitmap_constructor(e._oDrawing._oContext.canvas),Rt&&this.cur().on("click",function(){ir(Pt,"_blank")}),qe=null},t.extend(t.QR,t.Bitmap,null,"zimBitmap",!1),t.GIF=function(Pt,It,Ot,mt){var Rt="file, width, height, startPaused",Zt;if(Zt=st(t.GIF,arguments,Rt,this))return Zt;if(De("82.7"),typeof gifler>"u"){tt("ZIM GIF - needs gifler.js library - see docs");return}n(It)&&(It=100),n(Ot)&&(Ot=100);var At=this;At.paused=!1,this.zimBitmap_constructor(null,It,Ot),this.cache();var Nt,qe,e;if(ee.PATH!=null&&(t.PATH=ee.PATH),Pt.match(/http/)||Pt.match(/^\//)?e=Pt:e=(t.PATH?t.PATH:"")+Pt,At.gifler=gifler(e).animate(this.cacheCanvas).then(function(a){At.animator=a,mt&&(Nt=setInterval(function(){At.animator.running()&&(qe=setTimeout(function(){At.animator.stop(),At.paused=!0},.1),clearInterval(Nt))},.05))}),!At.ticker)if(At.keyObj){var r=At.keyObj.color,i=At.keyObj.tolerance,l=At.keyObj.replacement;At.ticker=t.Ticker.add(function(){At.keyOut(r,i,l)})}else At.ticker=t.Ticker.add(function(){});At.keyOut=function(a,s,f){return At.ticker?(t.Ticker.remove(At.ticker),At.ticker=t.Ticker.add(function(){At.keyOut(a,s,f)})):At.keyObj={color:a,tolerance:s,replacement:f},At},this.pause=function(a){return n(a)&&(a=!0),At.animator&&(Nt&&clearInterval(Nt),qe&&clearTimeout(qe),a&&At.animator.running()?(At.animator.stop(),t.Ticker.remove(At.ticker)):!a&&!At.animator.running()&&(At.animator.start(),t.Ticker.add(At.ticker))),At.paused=a,At},this.stop=function(){At.dispose()},this.reset=function(){return At.animator.reset(),At.paused&&(At.animator.start(),t.Ticker.add(At.ticker)),At},this.clone=function(){return this.cloneProps(new t.GIF(Pt,It,Ot,mt))},this.dispose=function(){At.animator.stop(),At.parent&&At.removeFrom(),t.Ticker.remove(At.ticker),t.gD(this)}},t.extend(t.GIF,t.Bitmap,["clone","dispose","keyOut"],"zimBitmap",!1),t.Theme={set:function(Pt,It,Ot,mt,Rt){var Zt="name, lightenRatio, tint, tintRatio, exclude",At;if(At=st(t.Theme.set,arguments,Zt))return At;De("82.8"),n(Pt)&&(Pt="zim");var Nt=Pt.toLowerCase();n(It)&&(It=0),Ot==-1&&(Ot=null),n(mt)&&(mt=0),Rt==-1&&(Rt=null),!n(Rt)&&!Array.isArray(Rt)&&(Rt=[Rt]),t.THEME=window.THEME={name:Nt,lightenRatio:It,tint:Ot,tintRatio:mt,exclude:Rt};var qe={},e,r=t.colors.slice(0,8),i=t.colors.slice(8,25);Nt=="zim"?t.loop(t.colors,function(l,a){l=="clear"||l=="faint"||(qe[l]=t.colorsHex[a])}):Nt=="html"?(t.loop(r,function(l){qe[l]=l}),t.loop(i,function(l,a){qe[l]=t.colorsHex[a+8]})):Nt=="future"?(e=["f25019","fd8918","ffc955","1dcfae","00a5ab","007175","00969b","d6b361"],t.loop(r,function(l,a){qe[l]="#"+e[a]}),t.loop(i,function(l,a){qe[l]=t.colorsHex[a+8].toColor("#1dcfae",.4-a*.025)})):Nt=="invert"?(qe={},t.loop(t.colorsHex,function(l,a,s){if(a==s-2)return 1;qe[t.colors[a]]=t.invertColor(l)})):Nt=="greyscale"?(e=["222222","aaaaaa","dddddd","888888","333333","111111","777777","bbbbbb"],t.loop(r,function(l,a){qe[l]="#"+e[a]})):Nt=="neon"?(e=["FF3624","ff6f00","e2f705","a3f307","05f9e2","ED0AF5","ff33c9","e16d00"],t.loop(r,function(l,a){qe[l]="#"+e[a]}),t.loop(i,function(l,a){qe[l]=t.colorsHex[a+8].toColor("#000",.9)}),qe.light=t.lighter,qe.moon=t.lighter,qe.lighter=t.white,qe.white=t.white):Nt=="seventies"?(e=["e5771e","f4a127","ffecb4","6F8212","75c8ae","5a3d2b","956e4e","4c3607"],t.loop(r,function(l,a){qe[l]="#"+e[a]}),t.loop(i,function(l,a){qe[l]=t.colorsHex[a+8].toColor(a<8?"#344f00":"#f4a127",.8-a*.04)})):Nt=="warm"?(e=["965746","c07768","ffecb4","8da279","6da0b1","745c58","9a7e79","be8858"],t.loop(r,function(l,a){qe[l]="#"+e[a]}),t.loop(i,function(l,a){qe[l]=t.colorsHex[a+8].toColor(a<8?"#4e352e":"#745c58",.8-a*.05)})):Nt.constructor=={}.constructor&&(qe=Nt,t.loop(qe,function(l){t.colors.indexOf(l)==-1&&delete qe[l]})),t.loop(Rt,function(l){l.toLowerCase()=="colors"?t.loop(t.colors,function(a,s){if(s>=8)return 1;Rt.push(a)}):(l.toLowerCase()=="greys"||l.toLowerCase()=="grays")&&t.loop(t.colors,function(a,s){s<8||Rt.push(a)})}),t.loop(qe,function(l,a){Rt&&Rt.indexOf(l)!=-1||(Ot&&(a=a.toColor(Ot,mt)),It!=0&&(a=a.lighten(It)),Et||(window[l]=a),t[l]=a)})},apply:function(Pt,It,Ot,mt,Rt){var Zt="name, lightenRatio, tint, tintRatio, exclude",At;if(At=st(t.Theme.apply,arguments,Zt))return At;try{if(localStorage){n(Pt)&&(Pt="zim");var Nt=Pt.toLowerCase();n(It)&&(It=0),n(Ot)&&(Ot=-1),n(mt)&&(mt=0),n(Rt)?Rt=-1:Array.isArray(Rt)||(Rt=[Rt]),localStorage.setItem(Tt,JSON.stringify({name:Nt,lightenRatio:It,tint:Ot,tintRatio:mt,exclude:Rt})),window.location.reload()}else tt("ZIM applyTheme() - needs localStorage")}catch (e20){tt("ZIM applyTheme() - needs localStorage")}},clear:function(){try{localStorage&&localStorage.getItem(Tt)&&localStorage.removeItem(Tt),window.location.reload()}catch (e21){}}};var Tt=window.location.href.replace(/[.\/:]/g,"");try{localStorage&&localStorage.getItem(Tt)?(t.THEME=window.THEME=JSON.parse(localStorage.getItem(Tt)),t.Theme.set(ur.name,ur.lightenRatio,ur.tint,ur.tintRatio,ur.exclude)):t.THEME=window.THEME=null}catch (e22){t.THEME=window.THEME=null}return t}(ye||{});var $r=[["zog",Wn],["zid",Cn],["zss",xi],["zgo",ir],["zum",Hn],["zot",n],["zop",wi],["zil",Xr],["zet",cr],["zob",st],["zik",nt],["zta",Ci],["zor",Ti],["zogg",ri],["zogp",yi],["zogb",Yr],["zogr",ii],["zogy",tt],["zogo",li],["zogl",Er],["zogd",Pr],["zimplify",Ai],["zimify",Un]];for(dn=0;dn<$r.length;dn++)Jn=$r[dn],ee[Jn[0]]=ye[Jn[0]]=Jn[1];var Jn,jr=[["FIT",ye.FIT],["FILL",ye.FILL],["FULL",ye.FULL],["LEFT",ye.LEFT],["RIGHT",ye.RIGHT],["CENTER",ye.CENTER],["MIDDLE",ye.MIDDLE],["START",ye.START],["END",ye.END],["TOP",ye.TOP],["BOTTOM",ye.BOTTOM],["OVER",ye.OVER],["UNDER",ye.UNDER],["HORIZONTAL",ye.HORIZONTAL],["VERTICAL",ye.VERTICAL],["BOTH",ye.BOTH],["RADIAL",ye.RADIAL],["UP",ye.UP],["DOWN",ye.DOWN],["NEXT",ye.NEXT],["PREV",ye.PREV],["AUTO",ye.AUTO],["AVE",ye.AVE],["DEFAULT",ye.DEFAULT],["ALL",ye.ALL],["NONE",ye.NONE],["GET",ye.GET],["POST",ye.POST],["LOCALSTORAGE",ye.LOCALSTORAGE],["SOCKET",ye.SOCKET],["TO",ye.TO],["FROM",ye.FROM],["SINE",ye.SINE],["SQUARE",ye.SQUARE],["TRIANGLE",ye.TRIANGLE],["SAW",ye.SAW],["SAWTOOTH",ye.SAWTOOTH],["ZAP",ye.ZAP],["TAU",ye.TAU],["DEG",ye.DEG],["RAD",ye.RAD],["PHI",ye.PHI]];for(dn=0;dn<jr.length;dn++)Jn=jr[dn],ee[Jn[0]]=Jn[1];var Jn;for(dn=0;dn<ye.colors.length;dn++)ee[ye.colors[dn]]=ye.colorsHex[dn];ee.zim=ye;var Mi=ye;var Ii=ye.chop,Oi= exports.shuffle =ye.shuffle,Si= exports.pluck =ye.pluck,bi= exports.rand =ye.rand,Li= exports.seedRandom =ye.seedRandom,Bi= exports.odds =ye.odds,Di= exports.rarity =ye.rarity,Ri= exports.repeats =ye.repeats,_i= exports.series =ye.series,Yi= exports.loop =ye.loop,Xi= exports.getTIME =ye.getTIME,zr= exports.timeout =ye.timeout,ki= exports.interval =ye.interval,Ni= exports.async =ye.async,Fi= exports.couple =ye.couple,Gi= exports.decouple =ye.decouple,Vi= exports.convertColor =ye.convertColor,Wi= exports.colorRange =ye.colorRange,Ui= exports.lighten =ye.lighten,Qi= exports.darken =ye.darken,qi= exports.toColor =ye.toColor,Zi= exports.toAlpha =ye.toAlpha,Ki= exports.toBW =ye.toBW,Hi= exports.invertColor =ye.invertColor,Ji= exports.zimEase =ye.zimEase,$i= exports.spline =ye.spline,ji= exports.pointAlongCurve =ye.pointAlongCurve,zi= exports.distanceAlongCurve =ye.distanceAlongCurve,el= exports.closestPointAlongCurve =ye.closestPointAlongCurve,tl= exports.transformPoints =ye.transformPoints,nl= exports.trimEndPoints =ye.trimEndPoints,rl= exports.reversePoints =ye.reversePoints,il= exports.appendPoints =ye.appendPoints,ll= exports.prependPoints =ye.prependPoints,al= exports.splitPoints =ye.splitPoints,sl= exports.makeID =ye.makeID,ol= exports.makeSyllable =ye.makeSyllable,fl= exports.makePrimitive =ye.makePrimitive,ul= exports.makeMath =ye.makeMath,cl= exports.swapProperties =ye.swapProperties,dl= exports.mobile =ye.mobile,hl= exports.vee =ye.vee,pl= exports.extend =ye.extend,gl= exports.copy =ye.copy,vl= exports.merge =ye.merge,yl= exports.sortObject =ye.sortObject,xl= exports.arraysEqual =ye.arraysEqual,wl= exports.arrayMinMax =ye.arrayMinMax,Cl= exports.isEmpty =ye.isEmpty,Tl= exports.isPick =ye.isPick,ml= exports.isJSON =ye.isJSON,Al= exports.parseJSON =ye.parseJSON,kl= exports.decimals =ye.decimals,El= exports.countDecimals =ye.countDecimals,Pl= exports.sign =ye.sign,Ml= exports.constrain =ye.constrain,Il= exports.dist =ye.dist,Ol= exports.rectIntersect =ye.rectIntersect,Sl= exports.boundsAroundPoints =ye.boundsAroundPoints,bl= exports.angle =ye.angle,Ll= exports.smoothStep =ye.smoothStep,Bl= exports.unicodeToUTF =ye.unicodeToUTF,Dl= exports.capitalizeFirst =ye.capitalizeFirst,Rl= exports.Ajax =ye.Ajax,_l= exports.Noise =ye.Noise,Yl= exports.Point =ye.Point,Xl= exports.Bezier =ye.Bezier,Nl= exports.Boundary =ye.Boundary,Fl= exports.GradientColor =ye.GradientColor,Gl= exports.RadialColor =ye.RadialColor,Vl= exports.BitmapColor =ye.BitmapColor,Wl= exports.Damp =ye.Damp,Ul= exports.Proportion =ye.Proportion,Ql= exports.ProportionDamp =ye.ProportionDamp,ql= exports.Dictionary =ye.Dictionary,Zl= exports.Hierarchy =ye.Hierarchy,Kl= exports.Pick =ye.Pick,Hl= exports.scrollX =ye.scrollX,Jl= exports.scrollY =ye.scrollY,$l= exports.windowWidth =ye.windowWidth,jl= exports.windowHeight =ye.windowHeight,zl= exports.browserZoom =ye.browserZoom,ea= exports.getQueryString =ye.getQueryString,ta= exports.swapHTML =ye.swapHTML,na= exports.urlEncode =ye.urlEncode,ra= exports.urlDecode =ye.urlDecode,ia= exports.setCookie =ye.setCookie,la= exports.getCookie =ye.getCookie,aa= exports.deleteCookie =ye.deleteCookie,sa= exports.Stage =ye.Stage,oa= exports.StageGL =ye.StageGL,ei= exports.Container =ye.Container,fa= exports.Shape =ye.Shape,ua= exports.Bitmap =ye.Bitmap,ca= exports.Sprite =ye.Sprite,da= exports.MovieClip =ye.MovieClip,ha= exports.SVGContainer =ye.SVGContainer,pa= exports.CustomShape =ye.CustomShape,ga= exports.Circle =ye.Circle,Mn= exports.Rectangle =ye.Rectangle,va= exports.Triangle =ye.Triangle,ya= exports.Poly =ye.Poly,xa= exports.Line =ye.Line,wa= exports.Squiggle =ye.Squiggle;var Ca=ye.Flare,Ta= exports.MultiFlare =ye.MultiFlare,ma= exports.FlareBox =ye.FlareBox,ti= exports.Label =ye.Label,Aa= exports.LabelOnPath =ye.LabelOnPath,ka= exports.LabelOnArc =ye.LabelOnArc,Ea= exports.LabelLetters =ye.LabelLetters,Pa= exports.Emoji =ye.Emoji,Ma= exports.Button =ye.Button,Ia= exports.CheckBox =ye.CheckBox,Oa= exports.RadioButtons =ye.RadioButtons,Sa= exports.Toggle =ye.Toggle,ba= exports.Tip =ye.Tip,La= exports.Pane =ye.Pane,Ba= exports.Panel =ye.Panel;var Da=ye.Page,Ra= exports.Central =ye.Central,_a= exports.Layer =ye.Layer,Ya= exports.Waiter =ye.Waiter,Xa= exports.ProgressBar =ye.ProgressBar,Na= exports.Indicator =ye.Indicator,Fa= exports.TextInput =ye.TextInput,Ga= exports.List =ye.List,Va= exports.Stepper =ye.Stepper,Wa= exports.Slider =ye.Slider,Ua= exports.Selector =ye.Selector,Qa= exports.Dial =ye.Dial,qa= exports.Tabs =ye.Tabs,Za= exports.Pad =ye.Pad,Ka= exports.NumPad =ye.NumPad,Ha= exports.DPad =ye.DPad,Ja= exports.Radial =ye.Radial,$a= exports.RadialMenu =ye.RadialMenu,ja= exports.ColorPicker =ye.ColorPicker,za= exports.EmojiPicker =ye.EmojiPicker,es= exports.TextEditor =ye.TextEditor,ts= exports.Keyboard =ye.Keyboard,ns= exports.Organizer =ye.Organizer,rs= exports.Connectors =ye.Connectors,is= exports.Marquee =ye.Marquee,ls= exports.Carousel =ye.Carousel,as= exports.Loader =ye.Loader,ss= exports.TextArea =ye.TextArea,os= exports.Tag =ye.Tag,fs= exports.localToGlobal =ye.localToGlobal,us= exports.globalToLocal =ye.globalToLocal,cs= exports.localToLocal =ye.localToLocal,ds= exports.addTo =ye.addTo,hs= exports.removeFrom =ye.removeFrom,ps= exports.added =ye.added,gs= exports.centerReg =ye.centerReg,vs= exports.center =ye.center,ys= exports.place =ye.place,xs= exports.placeReg =ye.placeReg,ws= exports.pos =ye.pos,Cs= exports.loc =ye.loc,Ts= exports.mov =ye.mov,ms= exports.sca =ye.sca,As= exports.alp =ye.alp,ks= exports.vis =ye.vis,Es= exports.ble =ye.ble,Ps= exports.dye =ye.dye,Ms= exports.hov =ye.hov,Is= exports.rot =ye.rot,Os= exports.siz =ye.siz,Ss= exports.ske =ye.ske,bs= exports.reg =ye.reg,Ls= exports.top =ye.top,Bs= exports.bot =ye.bot,Ds= exports.ord =ye.ord,Rs= exports.cur =ye.cur,_s= exports.sha =ye.sha,Ys= exports.dep =ye.dep,Xs= exports.nam =ye.nam,Ns= exports.movement =ye.movement,Fs= exports.noMovement =ye.noMovement,Gs= exports.tap =ye.tap,Vs= exports.noTap =ye.noTap,Ws= exports.hold =ye.hold,Us= exports.noHold =ye.noHold,Qs= exports.change =ye.change,qs= exports.noChange =ye.noChange,Zs= exports.drag =ye.drag,Ks= exports.noDrag =ye.noDrag,Hs= exports.dragBoundary =ye.dragBoundary,Js= exports.mouse =ye.mouse,$s= exports.noMouse =ye.noMouse,js= exports.wire =ye.wire,zs= exports.noWire =ye.noWire,eo= exports.wired =ye.wired,to= exports.noWired =ye.noWired,no= exports.bind =ye.bind,ro= exports.noBind =ye.noBind,io= exports.transform =ye.transform,lo= exports.gesture =ye.gesture,ao= exports.noGesture =ye.noGesture,so= exports.gestureBoundary =ye.gestureBoundary,oo= exports.effect =ye.effect,fo= exports.updateEffects =ye.updateEffects,uo= exports.noEffect =ye.noEffect,co= exports.addPhysics =ye.addPhysics,ho= exports.removePhysics =ye.removePhysics,po= exports.hitTestPoint =ye.hitTestPoint,go= exports.hitTestReg =ye.hitTestReg,vo= exports.hitTestRect =ye.hitTestRect,yo= exports.hitTestCircle =ye.hitTestCircle,xo= exports.hitTestCircleRect =ye.hitTestCircleRect,wo= exports.hitTestCircles =ye.hitTestCircles,Co= exports.hitTestBounds =ye.hitTestBounds,To= exports.hitTestPath =ye.hitTestPath,mo= exports.hitTestGrid =ye.hitTestGrid,Ao= exports.animate =ye.animate,ko= exports.stopAnimate =ye.stopAnimate,Eo= exports.pauseAnimate =ye.pauseAnimate,Po= exports.wiggle =ye.wiggle,Mo= exports.scaleTo =ye.scaleTo,Io= exports.fit =ye.fit,Oo= exports.boundsToGlobal =ye.boundsToGlobal,So= exports.resetBounds =ye.resetBounds,bo= exports.copyMatrix =ye.copyMatrix,Lo= exports.duplicate =ye.duplicate,Bo= exports.expand =ye.expand,Do= exports.setSwipe =ye.setSwipe,Ro= exports.setMask =ye.setMask,_o= exports.outline =ye.outline,Yo= exports.blendmodes =ye.blendmodes,Xo= exports.Pages =ye.Pages,No= exports.Arrow =ye.Arrow,Fo= exports.HotSpots =ye.HotSpots,Go= exports.HotSpot =ye.HotSpot,Vo= exports.Guide =ye.Guide,Wo= exports.Grid =ye.Grid,Uo= exports.Wrapper =ye.Wrapper,ni= exports.Tile =ye.Tile,Qo= exports.Pack =ye.Pack,qo= exports.Beads =ye.Beads,Zo= exports.Layout =ye.Layout,Ko= exports.Accessibility =ye.Accessibility,Ho= exports.TextureActive =ye.TextureActive,Jo= exports.TextureActives =ye.TextureActives,$o= exports.TextureActivesManager =ye.TextureActivesManager,jo= exports.Manager =ye.Manager,zo= exports.ResizeManager =ye.ResizeManager,ef= exports.TransformManager =ye.TransformManager,tf= exports.GuideManager =ye.GuideManager,nf= exports.GridManager =ye.GridManager,rf= exports.LayoutManager =ye.LayoutManager,lf= exports.SelectionSet =ye.SelectionSet,af= exports.SelectionManager =ye.SelectionManager,sf= exports.Bind =ye.Bind,of= exports.Swipe =ye.Swipe,ff= exports.Swiper =ye.Swiper,uf= exports.MotionController =ye.MotionController,cf= exports.GamePad =ye.GamePad,df= exports.Portal =ye.Portal,hf= exports.Physics =ye.Physics,pf= exports.TimeLine =ye.TimeLine,gf= exports.BlurEffect =ye.BlurEffect,vf= exports.GlowEffect =ye.GlowEffect,yf= exports.ShadowEffect =ye.ShadowEffect,xf= exports.ColorEffect =ye.ColorEffect,wf= exports.MultiEffect =ye.MultiEffect,Cf= exports.AlphaEffect =ye.AlphaEffect,Tf= exports.Pixel =ye.Pixel,mf= exports.Parallax =ye.Parallax,Af= exports.Flipper =ye.Flipper,kf= exports.Book =ye.Book,Ef= exports.Scrambler =ye.Scrambler,Pf= exports.Scroller =ye.Scroller,Mf= exports.Dynamo =ye.Dynamo,If= exports.Accelerator =ye.Accelerator,Of= exports.Emitter =ye.Emitter,Sf= exports.Generator =ye.Generator,bf= exports.Pen =ye.Pen,Lf= exports.SoundWave =ye.SoundWave,Bf= exports.Synth =ye.Synth,Df= exports.VR =ye.VR,Rf= exports.Frame =ye.Frame,_f= exports.Pic =ye.Pic,Yf= exports.Aud =ye.Aud,Xf= exports.Vid =ye.Vid,Nf= exports.SVG =ye.SVG,Ff= exports.SensorAsk =ye.SensorAsk,Gf= exports.distill =ye.distill,Vf= exports.parseAudioSprite =ye.parseAudioSprite,Wf= exports.previewAudioSprite =ye.previewAudioSprite,Uf= exports.svgToBitmap =ye.svgToBitmap,Qf= exports.makeContent =ye.makeContent,qf= exports.fastFrame =ye.fastFrame,Zf= exports.addWires =ye.addWires,Kf= exports.setBlurDetect =ye.setBlurDetect,Hf= exports.Wonder =ye.Wonder,Jf= exports.getLatestVersions =ye.getLatestVersions,$f= exports.PWA =ye.PWA,jf= exports.QR =ye.QR,zf= exports.GIF =ye.GIF,ur= exports.THEME =ye.THEME;exports.Accelerator = If; exports.Accessibility = Ko; exports.Ajax = Rl; exports.AlphaEffect = Cf; exports.Arrow = No; exports.Aud = Yf; exports.Beads = qo; exports.Bezier = Xl; exports.Bind = sf; exports.Bitmap = ua; exports.BitmapColor = Vl; exports.Blob = gi; exports.BlurEffect = gf; exports.Book = kf; exports.Boundary = Nl; exports.Button = Ma; exports.Carousel = ls; exports.Central = Ra; exports.CheckBox = Ia; exports.Circle = ga; exports.ColorEffect = xf; exports.ColorPicker = ja; exports.Connectors = rs; exports.Container = ei; exports.CustomShape = pa; exports.DPad = Ha; exports.Damp = Wl; exports.Dial = Qa; exports.Dictionary = ql; exports.Dynamo = Mf; exports.Emitter = Of; exports.Emoji = Pa; exports.EmojiPicker = za; exports.Flare = Ca; exports.FlareBox = ma; exports.Flipper = Af; exports.Frame = Rf; exports.GIF = zf; exports.GamePad = cf; exports.Generator = Sf; exports.GlowEffect = vf; exports.GradientColor = Fl; exports.Grid = Wo; exports.GridManager = nf; exports.Guide = Vo; exports.GuideManager = tf; exports.Hierarchy = Zl; exports.HotSpot = Go; exports.HotSpots = Fo; exports.Indicator = Na; exports.Keyboard = ts; exports.Label = ti; exports.LabelLetters = Ea; exports.LabelOnArc = ka; exports.LabelOnPath = Aa; exports.Layer = _a; exports.Layout = Zo; exports.LayoutManager = rf; exports.Line = xa; exports.List = Ga; exports.Loader = as; exports.Manager = jo; exports.Marquee = is; exports.MotionController = uf; exports.MovieClip = da; exports.MultiEffect = wf; exports.MultiFlare = Ta; exports.Noise = _l; exports.NumPad = Ka; exports.Organizer = ns; exports.PWA = $f; exports.Pack = Qo; exports.Pad = Za; exports.Page = Da; exports.Pages = Xo; exports.Pane = La; exports.Panel = Ba; exports.Parallax = mf; exports.Pen = bf; exports.Physics = hf; exports.Pic = _f; exports.Pick = Kl; exports.Pixel = Tf; exports.Point = Yl; exports.Poly = ya; exports.Portal = df; exports.ProgressBar = Xa; exports.Proportion = Ul; exports.ProportionDamp = Ql; exports.QR = jf; exports.Radial = Ja; exports.RadialColor = Gl; exports.RadialMenu = $a; exports.RadioButtons = Oa; exports.Rectangle = Mn; exports.ResizeManager = zo; exports.SVG = Nf; exports.SVGContainer = ha; exports.Scrambler = Ef; exports.Scroller = Pf; exports.SelectionManager = af; exports.SelectionSet = lf; exports.Selector = Ua; exports.SensorAsk = Ff; exports.ShadowEffect = yf; exports.Shape = fa; exports.Slider = Wa; exports.SoundWave = Lf; exports.Sprite = ca; exports.Squiggle = wa; exports.Stage = sa; exports.StageGL = oa; exports.Stepper = Va; exports.Swipe = of; exports.Swiper = ff; exports.Synth = Bf; exports.THEME = ur; exports.Tabs = qa; exports.Tag = os; exports.TextArea = ss; exports.TextEditor = es; exports.TextInput = Fa; exports.TextureActive = Ho; exports.TextureActives = Jo; exports.TextureActivesManager = $o; exports.Tile = ni; exports.TimeLine = pf; exports.Tip = ba; exports.Toggle = Sa; exports.TransformManager = ef; exports.Triangle = va; exports.VR = Df; exports.Vid = Xf; exports.Waiter = Ya; exports.Window = vi; exports.Wonder = Hf; exports.Wrapper = Uo; exports.addPhysics = co; exports.addTo = ds; exports.addWires = Zf; exports.added = ps; exports.alp = As; exports.angle = bl; exports.animate = Ao; exports.appendPoints = il; exports.arrayMinMax = wl; exports.arraysEqual = xl; exports.async = Ni; exports.bind = no; exports.ble = Es; exports.blendmodes = Yo; exports.bot = Bs; exports.boundsAroundPoints = Sl; exports.boundsToGlobal = Oo; exports.browserZoom = zl; exports.capitalizeFirst = Dl; exports.center = vs; exports.centerReg = gs; exports.change = Qs; exports.chop = Ii; exports.closestPointAlongCurve = el; exports.colorRange = Wi; exports.constrain = Ml; exports.convertColor = Vi; exports.copy = gl; exports.copyMatrix = bo; exports.countDecimals = El; exports.couple = Fi; exports.cur = Rs; exports.darken = Qi; exports.decimals = kl; exports.decouple = Gi; exports.default = Mi; exports.deleteCookie = aa; exports.dep = Ys; exports.dist = Il; exports.distanceAlongCurve = zi; exports.distill = Gf; exports.drag = Zs; exports.dragBoundary = Hs; exports.duplicate = Lo; exports.dye = Ps; exports.effect = oo; exports.expand = Bo; exports.extend = pl; exports.fastFrame = qf; exports.fit = Io; exports.gesture = lo; exports.gestureBoundary = so; exports.getCookie = la; exports.getLatestVersions = Jf; exports.getQueryString = ea; exports.getTIME = Xi; exports.globalToLocal = us; exports.hitTestBounds = Co; exports.hitTestCircle = yo; exports.hitTestCircleRect = xo; exports.hitTestCircles = wo; exports.hitTestGrid = mo; exports.hitTestPath = To; exports.hitTestPoint = po; exports.hitTestRect = vo; exports.hitTestReg = go; exports.hold = Ws; exports.hov = Ms; exports.interval = ki; exports.invertColor = Hi; exports.isEmpty = Cl; exports.isJSON = ml; exports.isPick = Tl; exports.lighten = Ui; exports.loc = Cs; exports.localToGlobal = fs; exports.localToLocal = cs; exports.loop = Yi; exports.makeContent = Qf; exports.makeID = sl; exports.makeMath = ul; exports.makePrimitive = fl; exports.makeSyllable = ol; exports.merge = vl; exports.mobile = dl; exports.mouse = Js; exports.mov = Ts; exports.movement = Ns; exports.nam = Xs; exports.noBind = ro; exports.noChange = qs; exports.noDrag = Ks; exports.noEffect = uo; exports.noGesture = ao; exports.noHold = Us; exports.noMouse = $s; exports.noMovement = Fs; exports.noTap = Vs; exports.noWire = zs; exports.noWired = to; exports.odds = Bi; exports.ord = Ds; exports.outline = _o; exports.parseAudioSprite = Vf; exports.parseJSON = Al; exports.pauseAnimate = Eo; exports.place = ys; exports.placeReg = xs; exports.pluck = Si; exports.pointAlongCurve = ji; exports.pos = ws; exports.prependPoints = ll; exports.previewAudioSprite = Wf; exports.rand = bi; exports.rarity = Di; exports.rectIntersect = Ol; exports.reg = bs; exports.removeFrom = hs; exports.removePhysics = ho; exports.repeats = Ri; exports.resetBounds = So; exports.reversePoints = rl; exports.rot = Is; exports.sca = ms; exports.scaleTo = Mo; exports.scrollX = Hl; exports.scrollY = Jl; exports.seedRandom = Li; exports.series = _i; exports.setBlurDetect = Kf; exports.setCookie = ia; exports.setMask = Ro; exports.setSwipe = Do; exports.sha = _s; exports.shuffle = Oi; exports.sign = Pl; exports.siz = Os; exports.ske = Ss; exports.smoothStep = Ll; exports.sortObject = yl; exports.spline = $i; exports.splitPoints = al; exports.stopAnimate = ko; exports.svgToBitmap = Uf; exports.swapHTML = ta; exports.swapProperties = cl; exports.tap = Gs; exports.timeout = zr; exports.toAlpha = Zi; exports.toBW = Ki; exports.toColor = qi; exports.top = Ls; exports.transform = io; exports.transformPoints = tl; exports.trimEndPoints = nl; exports.unicodeToUTF = Bl; exports.updateEffects = fo; exports.urlDecode = ra; exports.urlEncode = na; exports.vee = hl; exports.vis = ks; exports.wiggle = Po; exports.windowHeight = jl; exports.windowWidth = $l; exports.wire = js; exports.wired = eo; exports.zimEase = Ji; exports.zimify = Un; exports.zimplify = Ai;
/*! ZIM - JavaScript Canvas Framework - Code Creativity
https://zimjs.com (c) 2023 modified MIT License
Donations welcome https://zimjs.com/donate
Node module - also see ES6 modules at https://zimjs.com/cdn
*/
